window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.GroupsReadUnreadDiagnostics.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[91],{1207:function(e,t,o){"use strict";o.d(t,"a",function(){return u});var n=o(0),r=o(1),i=o(1843),a=o(1844),s=o(1825),c=o(1932),l=Object(i.a)(),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._link=Object(a.a)(),t._onClick=function(e){var o=t.props,n=o.onClick;o.disabled?e.preventDefault():n&&n(e)},t}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,o=t.disabled,i=t.children,a=t.className,s=t.href,u=t.theme,d=t.styles,p=t.keytipProps,h=l(d,{className:a,isButton:!s,isDisabled:o,theme:u}),m=this._getRootType(this.props);return r.createElement(c.a,{keytipProps:p,ariaDescribedBy:this.props["aria-describedby"],disabled:o},function(t){return r.createElement(m,n.__assign({},t,e._removeInvalidPropsForRootType(m,e.props),{className:h.root,onClick:e._onClick,ref:e._link,"aria-disabled":o}),i)})},t.prototype.focus=function(){var e=this._link.current;e&&e.focus&&e.focus()},t.prototype._removeInvalidPropsForRootType=function(e,t){t.children,t.as;var o=t.disabled,r=t.target,i=t.href,a=(t.theme,t.getStyles,t.styles,n.__rest(t,["children","as","disabled","target","href","theme","getStyles","styles"]));return"string"==typeof e?"a"===e?n.__assign({target:r,href:i},a):n.__assign({},a,{disabled:o}):n.__assign({target:r,href:i,disabled:o},a)},t.prototype._getRootType=function(e){return e.as?e.as:e.href?"a":"button"},t}(s.a)},1662:function(e,t,o){"use strict";var n=o(1842),r=o(0),i=o(1),a=o(1825),s=o(1826),c=o(510),l=o(1843),u=Object(l.a)(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.shouldComponentUpdate=function(e){return this.props.checked!==e.checked||this.props.theme!==e.theme||this.props.className!==e.className},t.prototype.render=function(){var e=this.props,t=e.checked,o=e.className,n=e.theme,r=u(c.a,{theme:n,className:o,checked:t});return i.createElement("div",{className:r.root},i.createElement(s.a,{iconName:"CircleRing",className:r.circle}),i.createElement(s.a,{iconName:"StatusCircleCheckmark",className:r.check}))},t.defaultProps={checked:!1},t}(a.a);o.d(t,"a",function(){return p});var p=Object(n.a)(d,c.a,void 0,{scope:"Check"})},1905:function(e,t,o){"use strict";o.r(t);var n=o(3),r=Object(n.action)("addDiagnosticsData",function(e,t,o){return{groupId:e,actionType:t,customData:o}}),i=o(21),a=Object(n.createStore)("groupsReadUnreadDiagnosticsStore",{diagnosticsMap:new i.a})(),s=(Object(n.mutator)(r,function(e){var t=e.groupId,o=e.actionType,n=e.customData,r={group:t,actionType:o,timestamp:new Date(Date.now()).toLocaleTimeString(),customData:n};if(a.diagnosticsMap.has(t)){var i=a.diagnosticsMap.get(t);i.push(r),i.length>20&&i.splice(0,1)}else a.diagnosticsMap.set(t,[r])}),o(0)),c=Object(n.action)("addMarkAsReadDiagnostics",function(e,t,o,n,r){return{tableQuery:e,isActingOnAllItemsInTable:t,isReadValueToSet:o,actionSource:n,itemsToUpdate:r}}),l=Object(n.action)("addUnreadCountNotificationDiagnostics",function(e,t){return{groupId:e,notification:t}}),u=Object(n.action)("addUnreadCountSubscriptionDiagnostics",function(e,t,o){return{groupId:e,subscription:t,isUnsubscribe:o}}),d=o(14),p=o(1),h=o.n(p),m=o(1894),f=o(523),g=o(531),b=o(4226),v=[{key:"timestamp",minWidth:80,name:"Time",fieldName:"timestamp",isResizable:!0},{key:"actionType",minWidth:150,name:"Action",fieldName:"actionType",isResizable:!0},{key:"customData",minWidth:650,name:"Details",fieldName:"customData",isResizable:!0}],k=Object(d.observer)(function(){if(0==a.diagnosticsMap.size)return null;var e=[];return a.diagnosticsMap.keys().slice().sort(function(e,t){return e.localeCompare(t)}).forEach(function(t){e.push(p.createElement("div",{className:b.groupSectionHeader},t)),e.push(p.createElement(m.a,{className:b.detailsList,items:a.diagnosticsMap.get(t),columns:v,layoutMode:f.e.fixedColumns,selectionMode:g.c.none,constrainMode:f.d.unconstrained,onRenderItemColumn:function(e,t,o){return p.createElement("span",null,e[o.key])}}))}),p.createElement("div",{className:"allowTextSelection"},e)}),y=o(321),_=!1,C={name:"Groups read/unread",datapoints:[],type:"Custom"},w=function(){return h.a.createElement(k)};function x(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){switch(e.label){case 0:return _?[3,2]:(_=!0,[4,y.d.import().then(function(e){y.e.importAndExecute(C,e(),w)})]);case 1:e.sent(),e.label=2;case 2:return[2]}})})}var A=o(146),S=o(5);Object(n.orchestrator)(c,function(e){return s.__awaiter(void 0,void 0,void 0,function(){var t,o,n,i,a,c,l;return s.__generator(this,function(s){switch(s.label){case 0:return t=e.tableQuery,o=e.isActingOnAllItemsInTable,n=e.isReadValueToSet,i=e.actionSource,a=e.itemsToUpdate,Object(A.d)(t)?(u=n,c=o?u?"MarkAllAsRead":"MarkAllAsUnread":u?"MarkAsRead":"MarkAsUnread",l="ListViewType: "+Object(S.r)(t.listViewType)+", ActionSource: "+i,a&&(l+=", Count: "+a.length),[4,x()]):[3,2];case 1:s.sent(),r(t.folderId,c,l),s.label=2;case 2:return[2]}var u})})});Object(n.orchestrator)(l,function(e){return s.__awaiter(void 0,void 0,void 0,function(){var t,o,n,i;return s.__generator(this,function(a){switch(a.label){case 0:return t=e.groupId,o=e.notification,n=o.EventType?o.EventType:"Unknown",i="UnreadCount: "+o.UnreadCount+", EventType: "+n+", NotificationId: "+o.NotificationId+", BrokerSubscriptionId: "+o.BrokerSubscriptionId,[4,x()];case 1:return a.sent(),r(t,"UnreadCountNotification",i),[2]}})})});Object(n.orchestrator)(u,function(e){return s.__awaiter(void 0,void 0,void 0,function(){var t,o,n,i,a;return s.__generator(this,function(s){switch(s.label){case 0:return t=e.groupId,o=e.subscription,n=e.isUnsubscribe,i=n?"Unsubscribe":"Subscribe",a="ChannelId: "+o.subscriptionParameters.ChannelId,[4,x()];case 1:return s.sent(),r(t,i,a),[2]}})})}),o.d(t,"addMarkAsReadDiagnostics",function(){return c}),o.d(t,"addUnreadCountNotificationDiagnostics",function(){return l}),o.d(t,"addUnreadCountSubscriptionDiagnostics",function(){return u})},4226:function(e,t,o){var n=o(4227),r=o(33);"string"==typeof n&&(n=[[e.i,n]]);for(var i=0;i<n.length;i++)r.loadStyles(n[i][1],!1);n.locals&&(e.exports=n.locals)},4227:function(e,t,o){(t=e.exports=o(35)(!1)).push([e.i,".kAmxAycQLEH1Y_hVwAlHb{font-weight:600;font-size:12px}html[dir=ltr] .kAmxAycQLEH1Y_hVwAlHb{padding:15px 0 10px 10px}html[dir=rtl] .kAmxAycQLEH1Y_hVwAlHb{padding:15px 10px 10px 0}html[dir=ltr] ._3t_wDjGPtO-pTPAcIVotND{padding-left:15px}html[dir=rtl] ._3t_wDjGPtO-pTPAcIVotND{padding-right:15px}",""]),t.locals={groupSectionHeader:"kAmxAycQLEH1Y_hVwAlHb",detailsList:"_3t_wDjGPtO-pTPAcIVotND"}},510:function(e,t,o){"use strict";o.d(t,"a",function(){return i});var n=o(41),r={root:"ms-Check",circle:"ms-Check-circle",check:"ms-Check-check"},i=function(e){var t,o,i,a,s=e.checkBoxHeight,c=void 0===s?"18px":s,l=e.checked,u=e.className,d=e.theme,p=d.palette,h=d.semanticColors,m=Object(n.getGlobalClassNames)(r,d),f={fontSize:c,position:"absolute",left:0,top:0,width:c,height:c,textAlign:"center",verticalAlign:"middle"};return{root:[m.root,{lineHeight:"1",width:c,height:c,verticalAlign:"top",position:"relative",userSelect:"none",selectors:{":before":{content:'""',position:"absolute",top:"1px",right:"1px",bottom:"1px",left:"1px",borderRadius:"50%",opacity:1,background:h.bodyBackground},"$checkHost:hover &, $checkHost:focus &, &:hover, &:focus":{opacity:1}}},l&&["is-checked",{selectors:{":before":{background:p.themePrimary,opacity:1,selectors:(t={},t[n.HighContrastSelector]={background:"Window"},t)}}}],u],circle:[m.circle,f,{color:p.neutralTertiaryAlt,selectors:(o={},o[n.HighContrastSelector]={color:"WindowText"},o)},l&&{color:p.white}],check:[m.check,f,{opacity:0,color:p.neutralTertiaryAlt,fontSize:"16px",left:".5px",selectors:(i={":hover":{opacity:1}},i[n.HighContrastSelector]={MsHighContrastAdjust:"none"},i)},l&&{opacity:1,color:p.white,fontWeight:900,selectors:(a={},a[n.HighContrastSelector]={border:"none",color:"WindowText"},a)}],checkHost:[{}]}}},532:function(e,t,o){"use strict";var n=o(1842),r=o(1207),i=o(41),a={root:"ms-Link"};o.d(t,"a",function(){return s});var s=Object(n.a)(r.a,function(e){var t,o,n=e.className,r=e.isButton,s=e.isDisabled,c=e.theme,l=c.semanticColors,u=Object(i.getGlobalClassNames)(a,c);return{root:[u.root,Object(i.getFocusStyle)(c,-2),{color:l.link},r&&{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",display:"inline",fontSize:"inherit",margin:0,overflow:"inherit",padding:0,textAlign:"left",textOverflow:"inherit",userSelect:"text",borderBottom:"1px solid transparent",selectors:(t={},t[i.HighContrastSelectorBlack]={color:"#FFFF00"},t[i.HighContrastSelectorWhite]={color:"#00009F"},t["@media screen and (-ms-high-contrast: active), (-ms-high-contrast: none)"]={borderBottom:"none"},t)},!r&&{textDecoration:"none"},s&&["is-disabled",{color:l.disabledText,cursor:"default"},{selectors:{"&:link, &:visited":{pointerEvents:"none"}}}],!s&&{selectors:{"&:active, &:hover, &:active:hover":{color:l.linkHovered,selectors:(o={},o[i.HighContrastSelector]={textDecoration:"underline"},o)},"&:focus":{color:l.link}}},u.root,n]}},void 0,{scope:"Link"})}},0,[0,1,2,8,46,218,225]]);
//# sourceMappingURL=owa.GroupsReadUnreadDiagnostics.js.map
window.scriptsLoaded['owa.GroupsReadUnreadDiagnostics.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.GroupsReadUnreadDiagnostics.js'] = (new Date()).getTime();