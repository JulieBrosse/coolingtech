window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.vendors~Diagnostics~FavoritesPicker~FileProviderStore~GroupAddMember~GroupCreate~GroupsReadUnreadDia~9eaaff52.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[2],{1898:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i(531),s=i(534),o=function(){function e(e){void 0===e&&(e={});var t=e.onSelectionChanged,i=e.getKey,s=e.canSelectItem,o=void 0===s?function(e){return!0}:s,c=e.selectionMode,l=void 0===c?n.c.multiple:c;this.mode=l,this._getKey=i||r,this._changeEventSuppressionCount=0,this._exemptedCount=0,this._anchoredIndex=0,this._unselectableCount=0,this._onSelectionChanged=t,this._canSelectItem=o,this._isModal=!1,this.setItems([],!0)}return e.prototype.canSelectItem=function(e,t){return!("number"==typeof t&&t<0)&&this._canSelectItem(e,t)},e.prototype.getKey=function(e,t){var i=this._getKey(e,t);return"number"==typeof i||i?""+i:""},e.prototype.setChangeEvents=function(e,t){this._changeEventSuppressionCount+=e?-1:1,0===this._changeEventSuppressionCount&&this._hasChanged&&(this._hasChanged=!1,t||this._change())},e.prototype.isModal=function(){return this._isModal},e.prototype.setModal=function(e){this._isModal!==e&&(this.setChangeEvents(!1),this._isModal=e,e||this.setAllSelected(!1),this._change(),this.setChangeEvents(!0))},e.prototype.setItems=function(e,t){void 0===t&&(t=!0);var i={},n={},s=!1;this.setChangeEvents(!1),this._unselectableCount=0;for(var o=0;o<e.length;o++){if(h=e[o]){var r=this.getKey(h,o);r&&(i[r]=o)}n[o]=h&&!this.canSelectItem(h),n[o]&&this._unselectableCount++}t&&this.setAllSelected(!1);var c={};for(var l in this._exemptedIndices)if(this._exemptedIndices.hasOwnProperty(l)){var h,u=Number(l),d=(h=this._items[u])?this.getKey(h,Number(u)):void 0,a=d?i[d]:u;if(void 0===a){this.setAllSelected(!1);break}c[a]=!0,s=s||a!==u}this._exemptedIndices=c,this._keyToIndexMap=i,this._unselectableIndices=n,this._items=e||[],this._selectedItems=null,s&&this._change(),this.setChangeEvents(!0)},e.prototype.getItems=function(){return this._items},e.prototype.getSelection=function(){if(!this._selectedItems){this._selectedItems=[];var e=this._items;if(e)for(var t=0;t<e.length;t++)this.isIndexSelected(t)&&this._selectedItems.push(e[t])}return this._selectedItems},e.prototype.getSelectedCount=function(){return this._isAllSelected?this._items.length-this._exemptedCount-this._unselectableCount:this._exemptedCount},e.prototype.getSelectedIndices=function(){if(!this._selectedIndices){this._selectedIndices=[];var e=this._items;if(e)for(var t=0;t<e.length;t++)this.isIndexSelected(t)&&this._selectedIndices.push(t)}return this._selectedIndices},e.prototype.isRangeSelected=function(e,t){if(0===t)return!1;for(var i=e+t,n=e;n<i;n++)if(!this.isIndexSelected(n))return!1;return!0},e.prototype.isAllSelected=function(){var e=this._items.length-this._unselectableCount;return this.mode===n.c.single&&(e=Math.min(e,1)),this.count>0&&this._isAllSelected&&0===this._exemptedCount||!this._isAllSelected&&this._exemptedCount===e&&e>0},e.prototype.isKeySelected=function(e){var t=this._keyToIndexMap[e];return this.isIndexSelected(t)},e.prototype.isIndexSelected=function(e){return!!(this.count>0&&this._isAllSelected&&!this._exemptedIndices[e]&&!this._unselectableIndices[e]||!this._isAllSelected&&this._exemptedIndices[e])},e.prototype.setAllSelected=function(e){if(!e||this.mode===n.c.multiple){var t=this._items?this._items.length-this._unselectableCount:0;this.setChangeEvents(!1),t>0&&(this._exemptedCount>0||e!==this._isAllSelected)&&(this._exemptedIndices={},(e!==this._isAllSelected||this._exemptedCount>0)&&(this._exemptedCount=0,this._isAllSelected=e,this._change()),this._updateCount()),this.setChangeEvents(!0)}},e.prototype.setKeySelected=function(e,t,i){var n=this._keyToIndexMap[e];n>=0&&this.setIndexSelected(n,t,i)},e.prototype.setIndexSelected=function(e,t,i){if(this.mode!==n.c.none&&!((e=Math.min(Math.max(0,e),this._items.length-1))<0||e>=this._items.length)){this.setChangeEvents(!1);var s=this._exemptedIndices[e];!this._unselectableIndices[e]&&(t&&this.mode===n.c.single&&this.setAllSelected(!1),s&&(t&&this._isAllSelected||!t&&!this._isAllSelected)&&(delete this._exemptedIndices[e],this._exemptedCount--),!s&&(t&&!this._isAllSelected||!t&&this._isAllSelected)&&(this._exemptedIndices[e]=!0,this._exemptedCount++),i&&(this._anchoredIndex=e)),this._updateCount(),this.setChangeEvents(!0)}},e.prototype.selectToKey=function(e,t){this.selectToIndex(this._keyToIndexMap[e],t)},e.prototype.selectToIndex=function(e,t){if(this.mode!==n.c.none)if(this.mode!==n.c.single){var i=this._anchoredIndex||0,s=Math.min(e,i),o=Math.max(e,i);for(this.setChangeEvents(!1),t&&this.setAllSelected(!1);s<=o;s++)this.setIndexSelected(s,!0,!1);this.setChangeEvents(!0)}else this.setIndexSelected(e,!0,!0)},e.prototype.toggleAllSelected=function(){this.setAllSelected(!this.isAllSelected())},e.prototype.toggleKeySelected=function(e){this.setKeySelected(e,!this.isKeySelected(e),!0)},e.prototype.toggleIndexSelected=function(e){this.setIndexSelected(e,!this.isIndexSelected(e),!0)},e.prototype.toggleRangeSelected=function(e,t){if(this.mode!==n.c.none){var i=this.isRangeSelected(e,t),s=e+t;if(!(this.mode===n.c.single&&t>1)){this.setChangeEvents(!1);for(var o=e;o<s;o++)this.setIndexSelected(o,!i,!1);this.setChangeEvents(!0)}}},e.prototype._updateCount=function(){var e=this.getSelectedCount();e!==this.count&&(this.count=e,this._change()),this.count||this.setModal(!1)},e.prototype._change=function(){0===this._changeEventSuppressionCount?(this._selectedItems=null,this._selectedIndices=void 0,s.EventGroup.raise(this,n.a),this._onSelectionChanged&&this._onSelectionChanged()):this._hasChanged=!0},e}();function r(e,t){return e&&e.key?e.key:""+t}},1899:function(e,t,i){"use strict";i.d(t,"a",function(){return f});var n=i(0),s=i(1),o=i(1844),r=i(372),c=i(1663),l=i(1846),h=i(1825),u=i(531),d="data-selection-index",a="data-selection-toggle",_="data-selection-invoke",p="data-selection-all-toggle",f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._root=Object(o.a)(),t.ignoreNextFocus=function(){t._handleNextFocus(!1)},t._onMouseDownCapture=function(e){if(document.activeElement===e.target||Object(r.a)(document.activeElement,e.target)){if(Object(r.a)(e.target,t._root.current))for(var i=e.target;i!==t._root.current;){if(t._hasAttribute(i,_)){t.ignoreNextFocus();break}i=Object(r.f)(i)}}else t.ignoreNextFocus()},t._onFocus=function(e){var i=e.target,n=t.props.selection,s=t._isCtrlPressed||t._isMetaPressed,o=t._getSelectionMode();if(t._shouldHandleFocus&&o!==u.c.none){var r=t._hasAttribute(i,a),c=t._findItemRoot(i);if(!r&&c){var l=t._getItemIndex(c);s?(n.setIndexSelected(l,n.isIndexSelected(l),!0),t.props.enterModalOnTouch&&t._isTouch&&n.setModal&&(n.setModal(!0),t._setIsTouch(!1))):t.props.isSelectedOnFocus&&t._onItemSurfaceClick(e,l)}}t._handleNextFocus(!1)},t._onMouseDown=function(e){t._updateModifiers(e);var i=e.target,n=t._findItemRoot(i);if(!t._isSelectionDisabled(i))for(;i!==t._root.current&&!t._hasAttribute(i,p);){if(n){if(t._hasAttribute(i,a))break;if(t._hasAttribute(i,_))break;if(!(i!==n&&!t._shouldAutoSelect(i)||t._isShiftPressed||t._isCtrlPressed)){t._onInvokeMouseDown(e,t._getItemIndex(n));break}if(t.props.disableAutoSelectOnInputElements&&("A"===i.tagName||"BUTTON"===i.tagName||"INPUT"===i.tagName))return}i=Object(r.f)(i)}},t._onTouchStartCapture=function(e){t._setIsTouch(!0)},t._onClick=function(e){t._updateModifiers(e);var i=e.target,n=t._findItemRoot(i);if(!t._isSelectionDisabled(i))for(;i!==t._root.current;){if(t._hasAttribute(i,p)){t._onToggleAllClick(e);break}if(n){var s=t._getItemIndex(n);if(t._hasAttribute(i,a)){t._isShiftPressed?t._onItemSurfaceClick(e,s):t._onToggleClick(e,s);break}if(t._hasAttribute(i,_)){t._onInvokeClick(e,s);break}if(i===n){t._onItemSurfaceClick(e,s);break}if("A"===i.tagName||"BUTTON"===i.tagName||"INPUT"===i.tagName)return}i=Object(r.f)(i)}},t._onContextMenu=function(e){var i=e.target,n=t.props,s=n.onItemContextMenu,o=n.selection;if(s){var r=t._findItemRoot(i);if(r){var c=t._getItemIndex(r);t._onInvokeMouseDown(e,c),s(o.getItems()[c],c,e.nativeEvent)||e.preventDefault()}}},t._onDoubleClick=function(e){var i=e.target;if(!t._isSelectionDisabled(i)){var n=t.props.onItemInvoked,s=t._findItemRoot(i),o=t._getSelectionMode();if(s&&n&&o!==u.c.none&&!t._isInputElement(i)){for(var c=t._getItemIndex(s);i!==t._root.current&&!t._hasAttribute(i,a)&&!t._hasAttribute(i,_);){if(i===s){t._onInvokeClick(e,c);break}i=Object(r.f)(i)}i=Object(r.f)(i)}}},t._onKeyDownCapture=function(e){t._updateModifiers(e),t._handleNextFocus(!0)},t._onKeyDown=function(e){t._updateModifiers(e);var i=e.target;if(!t._isSelectionDisabled(i)){var n=t.props.selection,s=65===e.which&&(t._isCtrlPressed||t._isMetaPressed),o=27===e.which;if(!t._isInputElement(i)){var c=t._getSelectionMode();if(s&&c===u.c.multiple&&!n.isAllSelected())return n.setAllSelected(!0),e.stopPropagation(),void e.preventDefault();if(o&&n.getSelectedCount()>0)return n.setAllSelected(!1),e.stopPropagation(),void e.preventDefault();var l=t._findItemRoot(i);if(l)for(var h=t._getItemIndex(l);i!==t._root.current&&!t._hasAttribute(i,a);){if(t._shouldAutoSelect(i)){t._onInvokeMouseDown(e,h);break}if(!(13!==e.which&&32!==e.which||"BUTTON"!==i.tagName&&"A"!==i.tagName&&"INPUT"!==i.tagName))return!1;if(i===l){if(13===e.which)return t._onInvokeClick(e,h),void e.preventDefault();if(32===e.which)return t._onToggleClick(e,h),void e.preventDefault();break}i=Object(r.f)(i)}}}},t}return n.__extends(t,e),t.prototype.componentDidMount=function(){var e=Object(r.i)(this._root.current),t=Object(c.e)(this._root.current);this._events.on(e,"keydown, keyup",this._updateModifiers,!0),this._events.on(t,"click",this._tryClearOnEmptyClick),this._events.on(document.body,"touchstart",this._onTouchStartCapture,!0),this._events.on(document.body,"touchend",this._onTouchStartCapture,!0)},t.prototype.render=function(){return s.createElement("div",n.__assign({className:"ms-SelectionZone",ref:this._root,onKeyDown:this._onKeyDown,onMouseDown:this._onMouseDown,onKeyDownCapture:this._onKeyDownCapture,onClick:this._onClick,role:"presentation",onDoubleClick:this._onDoubleClick,onContextMenu:this._onContextMenu},{onMouseDownCapture:this._onMouseDownCapture,onFocusCapture:this._onFocus}),this.props.children)},t.prototype._isSelectionDisabled=function(e){for(;e!==this._root.current;){if(this._hasAttribute(e,"data-selection-disabled"))return!0;e=Object(r.f)(e)}return!1},t.prototype._onToggleAllClick=function(e){var t=this.props.selection;this._getSelectionMode()===u.c.multiple&&(t.toggleAllSelected(),e.stopPropagation(),e.preventDefault())},t.prototype._onToggleClick=function(e,t){var i=this.props.selection,n=this._getSelectionMode();if(i.setChangeEvents(!1),this.props.enterModalOnTouch&&this._isTouch&&!i.isIndexSelected(t)&&i.setModal&&(i.setModal(!0),this._setIsTouch(!1)),n===u.c.multiple)i.toggleIndexSelected(t);else{if(n!==u.c.single)return void i.setChangeEvents(!0);var s=i.isIndexSelected(t);i.setAllSelected(!1),i.setIndexSelected(t,!s,!0)}i.setChangeEvents(!0),e.stopPropagation()},t.prototype._onInvokeClick=function(e,t){var i=this.props,n=i.selection,s=i.onItemInvoked;s&&(s(n.getItems()[t],t,e.nativeEvent),e.preventDefault(),e.stopPropagation())},t.prototype._onItemSurfaceClick=function(e,t){var i=this.props.selection,n=this._isCtrlPressed||this._isMetaPressed,s=this._getSelectionMode();s===u.c.multiple?this._isShiftPressed&&!this._isTabPressed?i.selectToIndex(t,!n):n?i.toggleIndexSelected(t):this._clearAndSelectIndex(t):s===u.c.single&&this._clearAndSelectIndex(t)},t.prototype._onInvokeMouseDown=function(e,t){this.props.selection.isIndexSelected(t)||this._clearAndSelectIndex(t)},t.prototype._tryClearOnEmptyClick=function(e){!this.props.selectionPreservedOnEmptyClick&&this._isNonHandledClick(e.target)&&this.props.selection.setAllSelected(!1)},t.prototype._clearAndSelectIndex=function(e){var t=this.props.selection;1===t.getSelectedCount()&&t.isIndexSelected(e)||(t.setChangeEvents(!1),t.setAllSelected(!1),t.setIndexSelected(e,!0,!0),this.props.enterModalOnTouch&&this._isTouch&&t.setModal&&(t.setModal(!0),this._setIsTouch(!1)),t.setChangeEvents(!0))},t.prototype._updateModifiers=function(e){this._isShiftPressed=e.shiftKey,this._isCtrlPressed=e.ctrlKey,this._isMetaPressed=e.metaKey;var t=e.keyCode;this._isTabPressed=!!t&&9===t},t.prototype._findItemRoot=function(e){for(var t=this.props.selection;e!==this._root.current;){var i=e.getAttribute(d),n=Number(i);if(null!==i&&n>=0&&n<t.getItems().length)break;e=Object(r.f)(e)}if(e!==this._root.current)return e},t.prototype._getItemIndex=function(e){return Number(e.getAttribute(d))},t.prototype._shouldAutoSelect=function(e){return this._hasAttribute(e,"data-selection-select")},t.prototype._hasAttribute=function(e,t){for(var i=!1;!i&&e!==this._root.current;)i="true"===e.getAttribute(t),e=Object(r.f)(e);return i},t.prototype._isInputElement=function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName},t.prototype._isNonHandledClick=function(e){var t=Object(r.e)();if(t&&e)for(;e&&e!==t.documentElement;){if(Object(l.l)(e))return!1;e=Object(r.f)(e)}return!0},t.prototype._handleNextFocus=function(e){var t=this;this._shouldHandleFocusTimeoutId&&(this._async.clearTimeout(this._shouldHandleFocusTimeoutId),this._shouldHandleFocusTimeoutId=void 0),this._shouldHandleFocus=e,e&&this._async.setTimeout(function(){t._shouldHandleFocus=!1},100)},t.prototype._setIsTouch=function(e){var t=this;this._isTouchTimeoutId&&(this._async.clearTimeout(this._isTouchTimeoutId),this._isTouchTimeoutId=void 0),this._isTouch=!0,e&&this._async.setTimeout(function(){t._isTouch=!1},300)},t.prototype._getSelectionMode=function(){var e=this.props.selection,t=this.props.selectionMode;return void 0===t?e?e.mode:u.c.none:t},t.defaultProps={isMultiSelectEnabled:!0,isSelectedOnFocus:!0,selectionMode:u.c.multiple},t}(h.a)},531:function(e,t,i){"use strict";i.d(t,"a",function(){return c}),i.d(t,"c",function(){return n}),i.d(t,"b",function(){return o});var n,s,o,r,c="change";(s=n||(n={}))[s.none=0]="none",s[s.single=1]="single",s[s.multiple=2]="multiple",(r=o||(o={}))[r.horizontal=0]="horizontal",r[r.vertical=1]="vertical"}}]);
//# sourceMappingURL=owa.vendors~Diagnostics~FavoritesPicker~FileProviderStore~GroupAddMember~GroupCreate~GroupsReadUnreadDia~9eaaff52.js.map
window.scriptsLoaded['owa.vendors~Diagnostics~FavoritesPicker~FileProviderStore~GroupAddMember~GroupCreate~GroupsReadUnreadDia~9eaaff52.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.vendors~Diagnostics~FavoritesPicker~FileProviderStore~GroupAddMember~GroupCreate~GroupsReadUnreadDia~9eaaff52.js'] = (new Date()).getTime();