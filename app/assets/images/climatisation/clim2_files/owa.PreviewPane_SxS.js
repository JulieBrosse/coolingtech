window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.PreviewPane~SxS.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[40],{1288:function(t,e,n){"use strict";var r=n(2),a=n(907),i=function(t){return!(!t||!a.a.trustedSendersAndDomains)&&(-1!=a.a.trustedSendersAndDomains.indexOf(t)||-1!=a.a.trustedSendersAndDomains.indexOf(t.split("@")[1]))};n.d(e,"b",function(){return o}),n.d(e,"a",function(){return i});var c=new r.c(function(){return n.e(102).then(n.bind(null,5689))}),o=new r.a(c,function(t){return t.getTrustedSendersAndDomains})},1331:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(2),a=new r.c(function(){return n.e(163).then(n.bind(null,1931))}),i=new r.a(a,function(t){return t.print})},1548:function(t,e,n){"use strict";n.d(e,"a",function(){return d});var r=n(1553),a=n.n(r),i=n(152),c=n.n(i),o=n(1554),s=n.n(o),u=n(30);function l(t,e){return a()({ItemIds:t.map(function(t){return e=t,c()({Id:e.Id,ChangeKey:e.ChangeKey});var e}),DeleteType:e,SuppressReadReceipts:!0,ReturnMovedItemIds:!0,SendMeetingCancellations:"SendToNone",AffectedTaskOccurrences:"AllOccurrences"})}function d(t,e,n){var r=l(t,e);return s()({Header:Object(u.getJsonRequestHeader)(),Body:r},n).then(function(t){return t.Body.ResponseMessages.Items})}},2234:function(t,e,n){"use strict";e.a={WacEditAndReply:{datapoint:{name:"WacEditAndReply",customData:function(t,e){return[t,e]}}},WacEdit:{datapoint:{name:"WacEdit",customData:function(t,e){return[t,e]}}},SetImageFromGalleryItem:{datapoint:{name:"SetImageFromGalleryItem",customData:function(t,e,n){return[t,e,n]}}},SxSSaveToCloud:{datapoint:{name:"SxSSaveToCloud",customData:function(t,e,n){return{size:t,result:e,actionSource:n}}}},SxSOpen:{datapoint:{name:"SxSOpen",customData:function(t,e){return{module:t,actionSource:e}}}},SxSClose:{datapoint:{name:"SxSClose",customData:function(t,e){return{module:t,closingSource:e}}}},SxSShowHideEmail:{datapoint:{name:"SxSShowHideEmail",customData:function(t,e){return{isShowEmail:t,module:e}}}},SxSImagePreviewLoadTime:{datapoint:{name:"SxSImagePreviewLoadTime"}},SxSPrint:{datapoint:{name:"SxSPrint",customData:function(t,e){return{doctype:t,module:e}}}}}},2397:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(2243),a=n.n(r),i=n(985),c=n.n(i);function o(t,e,n,r,i){if(i){var o="getWacAttachmentInfo"+i,s=new Headers;s.set("X-OWA-ActionName",o);var u={headers:s};r=r?c()(r,u):u}return a()({attachmentId:t,isEdit:e,draftId:n,appId:null},r)}},2400:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(11),a=n.n(r);function i(t){switch(t){case 2:return a.a.errorGetWacUrlNotFoundOrNoPermission;case 3:return a.a.errorGetWacUrlProtectedByUnsupportedIrm;case 5:return a.a.errorGetWacUrlInvalidRequest;case 6:return a.a.errorGetWacUrlAttachmentDataProviderError;case 7:return a.a.errorGetWacUrlUploadFailed;case 4:return a.a.errorGetWacUrlUnsupportedObjectType;case 10:return a.a.errorGetWacUrlEditIrmAttachmentNotSupported;case 11:return a.a.errorGetWacUrlEditMacAttachmentNotSupported;default:return a.a.errorGetWacUrl}}},2443:function(t,e,n){"use strict";var r=n(0),a=n(2397),i=n(4),c=n(9),o=n(2190),s={},u={};e.a=Object(i.action)("initializeWacUrl")(function(t,e,n){return r.__awaiter(this,void 0,void 0,function(){var i,l,d,m,f;return r.__generator(this,function(r){switch(r.label){case 0:if(i=new c.c("InitializeWacUrl"),n&&i.addCustomProperty("actionSource",n),d=(l=e?u:s)[t.Id]){if(d.expireTime>=(new Date).getTime())return i.addCustomProperty("ReturnFromCache",!0),i.end(),[2,d.value];delete l[t.Id]}i.addCustomProperty("ReturnFromCache",!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(a.a)(t.Id,e,null,t.mailboxInfo&&t.mailboxInfo.requestOptions,n)];case 2:return 0===(m=r.sent()).Status&&(l[t.Id]={expireTime:(new Date).getTime()+36e5,value:m}),m.WacUrl||i.addCustomProperty("WacUrlIsEmpty",!0),i.addCustomProperty("WacAttachmentResponseStatus",m.Status.toString()),i.end(),[3,4];case 3:throw f=r.sent(),Object(o.a)(f)&&Object(o.c)(i,f.response),Object(o.d)(i,f.toString()),i.endWithError(c.a.ServerError),f;case 4:return[2,m]}})})})},2444:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(0),a=n(2400),i=n(2443),c=n(11),o=n.n(c);function s(t,e,n){return r.__awaiter(this,void 0,void 0,function(){var c,s;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(i.a)(t,e,n)];case 1:return c=r.sent(),[3,3];case 2:throw s=r.sent(),{errorMessage:o.a.errorGetWacUrl,error:s};case 3:if(0===c.Status)return[2,[c.WacUrl,c.BootScriptUrl,c.WopiSrcUrl,c.AccessToken,c.Token]];throw{errorMessage:Object(a.a)(c.Status),error:new Error("GetWacAttachmentInfo failed with status: "+c.Status)}}})})}},2555:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(2556),a=n.n(r);function i(t,e){return a()({request:{Url:t,IsEdit:!1,ProviderType:e}})}},2620:function(t,e,n){"use strict";var r=n(0),a=n(3);var i=Object(a.action)("saveAttachmentsToCloud",function(t,e,n,r,a){return void 0===a&&(a=null),{attachmentId:t,itemId:e,notificationHandler:n,serviceCallFailureCallback:r,operationCreatedCallback:a}}),c=n(93),o=n(2953),s=n.n(o),u=n(3358),l=n.n(u);function d(t,e,n,r,a){var i,o,u,d,m,f=a.type===c.a.GroupMailbox?a.mailboxId:null,h=(i=t,o=e,u=n,d=r,m=f,s()({ewsAttachmentId:i,itemId:o,subscriptionId:u,groupSmtpAddress:m,channelId:d}));return l()({requestObject:h},a.requestOptions)}var m=n(2645),f=n(279),h=n(144),p={SaveToCloudProgressManager:{datapoint:{name:"SaveToCloudProgressManager",customData:function(t,e){return{operationId:t,counter:e}}}}},v=n(9),b=n(42),y={},P=5e3,S=12;function w(t,e,n,a,i){var c=new v.c(p.SaveToCloudProgressManager.datapoint.name),o=setInterval(function(){!function(t,e,n,a,i,c,o){r.__awaiter(this,void 0,void 0,function(){var s;return r.__generator(this,function(r){switch(r.label){case 0:return(s=o[t])?(s.counter++,s.counter>c?(g(t,o),s.datapoint.addCustomData(p.SaveToCloudProgressManager.datapoint.customData(t,s.counter)),s.datapoint.endWithError(b.a.Timeout),i&&i(),[2]):[4,h.d.import()]):[2];case 1:return r.sent()(e,n,t,0,function(t){a&&a(t.NotificationPayloads)}),[2]}})})}(n,t,e,a,i,S,y)},P);y[n]={timer:o,counter:0,datapoint:c}}function g(t,e){void 0===e&&(e=null),e||(e=y);var n=e[t];if(n){clearInterval(n.timer);var r=n.datapoint;r.addCustomData(p.SaveToCloudProgressManager.datapoint.customData(t,n.counter)),r.end(),delete e[t]}}Object(a.orchestrator)(i,function(t){return r.__awaiter(void 0,void 0,void 0,function(){var e,n,a,i,c,o,s,u;return r.__generator(this,function(l){switch(l.label){case 0:return e=!0,n=t.attachmentId||t.itemId,a=function(r){if(!r)return!1;if(23===r.ResultCode)return!1;var a=t.notificationHandler(r);return a&&(g(n.Id),e=!1),a},[4,Object(m.a)(a)];case 1:return i=l.sent(),c=i[0],o=i[1],s=i[2],u=i[3],function(t,e,n,a,i,c,o){r.__awaiter(this,void 0,void 0,function(){var s;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,d(t?t.Id:null,e?e.Id:null,n,c,e?e.mailboxInfo:t.mailboxInfo)];case 1:return[2,r.sent()];case 2:return s=r.sent(),o(s,1,v.a.ServerError),f.g.importAndExecute(a,i),[2,null];case 3:return[2]}})})}(t.attachmentId,t.itemId,c,o,s,u,t.serviceCallFailureCallback),e&&w(t.attachmentId,t.itemId,n.Id,function(t){t.forEach(function(t){a(t)})},function(){t.serviceCallFailureCallback("Progress manager timeout. OperationId = "+n,3,v.a.Timeout)}),t.operationCreatedCallback&&t.operationCreatedCallback(n.Id,o,s),[2]}})})});var A=Object(a.action)("cancelSaveAttachmentsToCloud",function(t){return{operationId:t}});Object(a.orchestrator)(A,function(t){return r.__awaiter(void 0,void 0,void 0,function(){return r.__generator(this,function(e){return g(t.operationId),[2]})})});n.d(e,"b",function(){return i}),n.d(e,"a",function(){return A})},2645:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n(0),a=n(104),i=n(279);function c(t){return r.__awaiter(this,void 0,void 0,function(){var e,n,c,o;return r.__generator(this,function(r){switch(r.label){case 0:return e=Object(a.getGuid)(),n={subscriptionId:e,requiresExplicitSubscribe:!1,subscriptionParameters:null},c=function(e){t(e)&&i.g.importAndExecute(n,c)},[4,i.f.import()];case 1:return r.sent()(n,c),[4,i.b.import()];case 2:return o=r.sent()(),[2,[e,n,c,o]]}})})}},2792:function(t,e,n){"use strict";var r=n(595),a=n(4);e.a=Object(a.action)("setAttachmentOriginalUrl")(function(t,e){Object(r.a)(t).model.AttachmentOriginalUrl=e})},2794:function(t,e,n){"use strict";var r=n(2400);n.d(e,"a",function(){return r.a});n(2444),n(2555)},2835:function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"b",function(){return u});var r,a,i=n(0),c=n(3454),o=n.n(c),s=n(7);function u(t,e){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,o()({AttachmentId:t},e)];case 1:switch(n.sent().Result){case 0:return[2,r.Success];case 1:return[2,r.Busy];default:return s.c.error("synchronizeWacAttachment: unexpected value of SynchronizeWacAttachmentResult"),[2,r.Failed]}return[3,3];case 2:return n.sent(),s.c.warn("synchronizeWacAttachment failed"),[2,r.Failed];case 3:return[2]}})})}(a=r||(r={}))[a.Success=0]="Success",a[a.Busy=1]="Busy",a[a.Failed=2]="Failed"},3095:function(t,e,n){"use strict";function r(t,e,n,r){var a=/([?&])access_token=([^&]+)/,i=/([?&])access_token_ttl=([^&]+)/,c=null,o=null;a.test(e)&&(c=decodeURIComponent(e.match(a)[2]),e=e.replace(a,"$1")),i.test(e)&&(o=decodeURIComponent(e.match(i)[2]),e=e.replace(i,"$1")),e+="&hh=1",e+="&mscc=1",t.onload=function(){t.onload=null;var a=t.contentDocument;a.body||a.write("<body><div></div></body>");var i=a.createElement("form");(i.action=e,i.method="POST",i.style.visibility="hidden",c)&&((l=a.createElement("input")).type="hidden",l.name="access_token",l.value=c,i.appendChild(l));o&&((l=a.createElement("input")).type="hidden",l.name="access_token_ttl",l.value=o,i.appendChild(l));if(n)for(var s=n.split("&"),u=0;u<s.length;u++){var l,d=s[u].split("=");if(2===d.length)(l=a.createElement("input")).type="hidden",l.name=d[0],l.value=decodeURIComponent(d[1]),i.appendChild(l)}a.body.appendChild(i),i.submit(),r&&r()},t.src="about:blank"}n.d(e,"a",function(){return r})},3455:function(t,e,n){"use strict";n.d(e,"a",function(){return d});var r,a,i,c=n(2234),o=n(9),s=n(595),u=n(191);(i=a||(a={}))[i.WacEdit=0]="WacEdit",i[i.WacEditAndReply=1]="WacEditAndReply";var l=Object.freeze(((r={})[0]=c.a.WacEdit,r[1]=c.a.WacEditAndReply,r));function d(t,e,n){var r=Object(s.a)(t);if(r){var a=Object(u.b)(r.model.Name||"")||r.model.ContentType||"",i=l[e].datapoint,c=i.name,d=i.customData;Object(o.n)(c,d(a,1===r.type?"cloudy":"classic",n))}}},595:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(489);function a(t){return Object(r.a)().attachments.get(t.Id)}},599:function(t,e,n){"use strict";var r=n(11),a=n.n(r),i=null;function c(t){var e;if(i||(i=Object.freeze(((e={})[0]=function(){return a.a.attachmentPolicyInformation},e))),!i[t])throw new Error("Issue message is not defined");return i[t]()}var o=n(82),s=n(335);function u(t){switch(t){case 0:return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,messageParts:[c(t),{text:Object(r.getOwaMailStrings)().attachmentPolicyHyperLinkText,action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}],color:s.a.Red};default:return Object(o.a)(t)}}var l=n(6);function d(){var t=Object(l.a)().AttachmentPolicy;return t.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked||t.ConditionalAccessPrintWithoutDownloadBlocked||t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked}function m(){var t=[];return d()&&t.push(0),t}function f(t){switch(t){case 0:return d();default:return Object(o.a)(t)}}var h,p,v=n(191);(p=h||(h={}))[p.Undefined=0]="Undefined",p[p.Block=1]="Block",p[p.ForceSave=2]="ForceSave",p[p.Allow=3]="Allow";var b=function(){function t(t,e){this.attachmentPolicy=t,this.shouldTreatAsPublicLogon=e,this.shouldTreatAsPublicLogon?this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=h[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes]}return t.prototype.getPolicyInfo=function(t,e,n,r){t&&(t=t.toLowerCase());var a=this.getFileAccessLevel(t,e),i=!1,c=!1,o=!1,s="ReferenceAttachment:#Exchange"===r;return a!==h.Block&&n&&(this.isWacViewingEnabled(t)&&(i=!0),!this.directFileAccessEnabled&&s&&(i=!1),c=this.isForceBrowserViewingFirst(i),i&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=t&&(o="FileAttachment:#Exchange"===r?this.attachmentPolicy.WacEditableFileTypes.indexOf(t)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(t)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(t)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(t)),i||this.directFileAccessEnabled||(a=h.Block)),{directFileAccessEnabled:this.directFileAccessEnabled,level:a,useWac:i,forceBrowserViewingFirst:c,wacEdit:o}},t.prototype.getFileAccessLevel=function(t,e){var n=this.fileTypeToPolicyMap[t];if(n||(n=h.Undefined),n==h.Block)return h.Block;var r=this.mimeTypeToPolicyMap[e];return r==h.Block?h.Block:n==h.ForceSave||r==h.ForceSave?h.ForceSave:n==h.Allow||r==h.Allow?h.Allow:this.policyForUnknownTypes},t.prototype.isWacViewingEnabled=function(t){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes.indexOf(t)>=0},t.prototype.isForceBrowserViewingFirst=function(t){return!!t&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},t.prototype.addPolicyIntoMap=function(t,e,n){e&&e.forEach(function(e){t[e]=n})},t.prototype.createPolicyMap=function(t,e,n){var r={};return this.addPolicyIntoMap(r,n,h.Allow),this.addPolicyIntoMap(r,e,h.ForceSave),this.addPolicyIntoMap(r,t,h.Block),r},t}(),y=null;function P(){if(!y){var t=Object(l.a)(),e=t.AttachmentPolicy,n=t.SessionSettings.IsPublicLogon||t.PublicComputersDetectionEnabled&&t.SessionSettings.IsPublicComputerSession;y=new b(e,n)}return y}function S(t,e){var n=Object(v.a)(t.Name),r=t.ContentType;return P().getPolicyInfo(n,r,e,t.__type)}function w(t,e,n){var r=S(t,!0),a=P();return r.level!==h.Block&&a.saveAttachmentsToCloudEnabled&&!e&&n}n.d(e,"d",function(){return u}),n.d(e,"b",function(){return m}),n.d(e,"g",function(){return f}),n.d(e,"e",function(){return w}),n.d(e,"a",function(){return h}),n.d(e,"c",function(){return S}),n.d(e,"f",function(){return P})},773:function(t,e,n){"use strict";var r=n(0),a=n(897);var i=n(2),c=n(1288),o=n(28);n.d(e,"a",function(){return ConversationReadingPane}),n.d(e,"c",function(){return ReadingPane}),n.d(e,"b",function(){return u}),n.d(e,"d",function(){return l});var s=new i.c(function(){return Promise.all([n.e(0),n.e(3),n.e(4),n.e(9),n.e(52)]).then(n.bind(null,5594))}),ConversationReadingPane=Object(i.d)(s,function(t){return t.ConversationReadingPane}),ReadingPane=Object(i.d)(s,function(t){return t.ReadingPane}),u=Object(i.d)(s,function(t){return t.ItemReadingPane}),l=Object(i.d)(s,function(t){return t.SecondaryReadingPaneTabCommandingBar});Object(o.c)(function(){c.b.importAndExecute,function(){r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,a.d.import()];case 1:return t.sent()(),[2]}})})}()})},907:function(t,e,n){"use strict";var r=n(3),a=Object(r.createStore)("TrustedSenders",{trustedSendersAndDomains:null})();e.a=a}}]);
//# sourceMappingURL=owa.PreviewPane~SxS.js.map
window.scriptsLoaded['owa.PreviewPane~SxS.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.PreviewPane~SxS.js'] = (new Date()).getTime();