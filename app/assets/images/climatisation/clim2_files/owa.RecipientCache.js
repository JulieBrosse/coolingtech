window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.RecipientCache.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[78],{2192:function(e,r,a){"use strict";a.d(r,"d",function(){return t}),a.d(r,"b",function(){return d}),a.d(r,"a",function(){return c}),a.d(r,"c",function(){return u});var n=a(2204),t=new Map,d=new Map,c=function(){return function(e){this.id=Object(n.a)(e),this.originalSuggestion=e}}();function u(e,r,a,n){var c=r.slice();return function(e,r,a,n){var c=t[n];if(c)for(var u=0;u<r.length;u++){var f=r[u].id?d.get(r[u].id):{},i=c.rank(f);r[u].rankingScore=i,r[u].featureStore=f}r.sort(function(e,r){return r.rankingScore-e.rankingScore})}(0,c,0,n),c}},2204:function(e,r,a){"use strict";function n(e){return e?e.EmailAddress&&e.EmailAddress.EmailAddress||e.PersonaId&&e.PersonaId.Id:null}a.d(r,"a",function(){return n})},2306:function(e,r,a){"use strict";var n,t;a.d(r,"a",function(){return n}),(t=n||(n={}))[t.AdvancedPreferFeature_1=1]="AdvancedPreferFeature_1",t[t.AdvancedPreferFeature_2=2]="AdvancedPreferFeature_2",t[t.AdvancedPreferFeature_3=3]="AdvancedPreferFeature_3",t[t.AdvancedPreferFeature_4=4]="AdvancedPreferFeature_4",t[t.AdvancedPreferFeature_5=5]="AdvancedPreferFeature_5",t[t.AdvancedPreferFeature_6=6]="AdvancedPreferFeature_6",t[t.AdvancedPreferFeature_7=7]="AdvancedPreferFeature_7",t[t.AdvancedPreferFeature_8=8]="AdvancedPreferFeature_8",t[t.AdvancedPreferFeature_9=9]="AdvancedPreferFeature_9",t[t.AdvancedPreferFeature_10=10]="AdvancedPreferFeature_10",t[t.AdvancedPreferFeature_11=11]="AdvancedPreferFeature_11",t[t.AdvancedPreferFeature_12=12]="AdvancedPreferFeature_12",t[t.AdvancedPreferFeature_13=13]="AdvancedPreferFeature_13",t[t.AdvancedPreferFeature_14=14]="AdvancedPreferFeature_14",t[t.AdvancedPreferFeature_15=15]="AdvancedPreferFeature_15",t[t.AdvancedPreferFeature_16=16]="AdvancedPreferFeature_16",t[t.AdvancedPreferFeature_17=17]="AdvancedPreferFeature_17",t[t.AdvancedPreferFeature_18=18]="AdvancedPreferFeature_18",t[t.AdvancedPreferFeature_19=19]="AdvancedPreferFeature_19",t[t.AdvancedPreferFeature_20=20]="AdvancedPreferFeature_20",t[t.AdvancedPreferFeature_21=21]="AdvancedPreferFeature_21",t[t.AdvancedPreferFeature_22=22]="AdvancedPreferFeature_22",t[t.AdvancedPreferFeature_23=23]="AdvancedPreferFeature_23",t[t.AdvancedPreferFeature_24=24]="AdvancedPreferFeature_24",t[t.AdvancedPreferFeature_25=25]="AdvancedPreferFeature_25",t[t.AdvancedPreferFeature_26=26]="AdvancedPreferFeature_26",t[t.AdvancedPreferFeature_27=27]="AdvancedPreferFeature_27",t[t.AdvancedPreferFeature_77=77]="AdvancedPreferFeature_77",t[t.AdvancedPreferFeature_78=78]="AdvancedPreferFeature_78",t[t.AdvancedPreferFeature_79=79]="AdvancedPreferFeature_79",t[t.AdvancedPreferFeature_80=80]="AdvancedPreferFeature_80",t[t.AdvancedPreferFeature_83=83]="AdvancedPreferFeature_83",t[t.AdvancedPreferFeature_84=84]="AdvancedPreferFeature_84",t[t.AdvancedPreferFeature_85=85]="AdvancedPreferFeature_85",t[t.AdvancedPreferFeature_86=86]="AdvancedPreferFeature_86",t[t.AdvancedPreferFeature_87=87]="AdvancedPreferFeature_87",t[t.AdvancedPreferFeature_88=88]="AdvancedPreferFeature_88"},2498:function(e,r,a){"use strict";a.d(r,"a",function(){return c});var n=a(2306),t=a(2192),d=a(2204);function c(e){e&&0!=e.length&&e.forEach(function(e){var r=Object(d.a)(e);if(r){var a={};if(e.FeatureData){var c=JSON.parse(e.FeatureData);Object.keys(c).forEach(function(e,r){var t="AdvancedPreferFeature_"+e;t in n.a&&(a[n.a[t]]=c[e])})}t.b.set(r,a)}})}},5686:function(e,r,a){"use strict";a.r(r);var n=a(8),t=a(945),d=a.n(t),c=a(668),u=a.n(c),f=a(891),i=a.n(f),o=a(257),v=a.n(o),s=a(870),P=a.n(s),_=a(29),F=a.n(_),A=a(889),l=a.n(A),p=a(30),h=500,S="owa.react.compose";function g(){return i()({IndexedPageItemView:v()({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:h}),PersonaShape:function(){if(Object(n.c)("rp-requestPersonaResponseShape")){var e=P()({BaseShape:"IdOnly",AdditionalProperties:[F()({FieldURI:"PersonaEmailAddress"}),F()({FieldURI:"EmailAddresses"}),F()({FieldURI:"PersonaDisplayName"}),F()({FieldURI:"PersonaDisplayNames"}),F()({FieldURI:"PersonaId"}),F()({FieldURI:"PersonaType"})]});return(Object(n.c)("rp-3SLocalSearchRanking")||Object(n.c)("rp-findPeopleCacheFirst")||Object(n.c)("rp-findPeopleCacheFirstInternal"))&&e.AdditionalProperties.push(F()({FieldURI:"FeatureData"})),e}return P()({BaseShape:"Default"})}(),QuerySources:["Mailbox"],QueryString:"",SearchPeopleSuggestionIndex:!0,ShouldResolveOneOffEmailAddress:!1,Context:[d()({Key:"AppName",Value:"OWA"}),d()({Key:"AppScenario",Value:S})]})}var O=a(937),y=a(4),b=a(2498),j=a(2204),R=Object(y.action)("initializeCache")(function(){var e;(e=g(),l()(u()({Header:Object(p.getJsonRequestHeader)(),Body:e})).then(function(e){return e.Body})).then(function(e){e.ResultSet?((Object(n.c)("rp-3SLocalSearchRanking")||Object(n.c)("rp-findPeopleCacheFirst")||Object(n.c)("rp-findPeopleCacheFirstInternal"))&&Object(b.a)(e.ResultSet),e.ResultSet.forEach(function(e){var r=Object(j.a)(e);r&&(O.a.allKeys[r]=!0)}),O.a.recipientCache=e.ResultSet):O.a.recipientCache=[]})});a.d(r,"initializeCache",function(){return R})},668:function(e,r,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=a(0);r.default=function(e){return n.__assign({__type:"FindPeopleJsonRequest:#Exchange"},e)}},870:function(e,r,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=a(0);r.default=function(e){return n.__assign({__type:"PersonaResponseShape:#Exchange"},e)}},889:function(e,r,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=a(38),t=a(668);r.default=function(e,r){return void 0===e||e.__type||(e=t.default(e)),n.makeServiceRequest("FindPeople",e,r)}},891:function(e,r,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=a(0);r.default=function(e){return n.__assign({__type:"FindPeopleRequest:#Exchange"},e)}},937:function(e,r,a){"use strict";var n=a(3),t=Object(n.createStore)("recipientcache",{recipientCache:null,allKeys:{}})();r.a=t},945:function(e,r,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=a(0);r.default=function(e){return n.__assign({__type:"ContextProperty:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.RecipientCache.js.map
window.scriptsLoaded['owa.RecipientCache.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.RecipientCache.js'] = (new Date()).getTime();