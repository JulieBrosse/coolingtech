window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.OutlookServiceOptions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[101],{5643:function(t,e,o){"use strict";o.r(e);var n=o(0),r=o(4),a=Object(r.action)("setFeatureSettings")(function(t,e,o){t.options[e]=o}),i=o(72),s=o(940),c=o(598);function u(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}var d,f,p=o(81),l=o(18),O=o(7);(f=d||(d={}))[f.POST=0]="POST",f[f.PATCH=1]="PATCH";var b=Object(r.select)({store:function(){return c.a}})(function(t,e,o){var r=Object(l.format)("ows/v1.0/OutlookOptions/{0}",i.a[t]);if(o.store.loadState===s.a.OptionsLoaded){if(o.store[t]&&o.store[t].lastModifiedDateTime){if(e&&0!==Object.keys(e).length){var a=e;a["feature@is.Queryable"],a["feature@odata.type"],a.createdDateTime,a.lastModifiedDateTime;return v(1,r,n.__rest(a,["feature@is.Queryable","feature@odata.type","createdDateTime","lastModifiedDateTime"]),o)}return O.c.info("createOrUpdateOptionsForFeature called with no changes to options"),Promise.resolve()}return v(0,r,e,o)}return Promise.reject("Options are not loaded. Cannot update options.")});function v(t,e,o,n){var r={correlationId:u()+u()+"-"+u()+"-"+u()+"-"+u()+"-"+u()+u()+u(),options:o};return(1==t?p.d:p.e)(e,r,r.correlationId).then(function(t){if(!function(t,e){if(t&&t.options&&1==t.options.length){var o=t.options[0];return a(e.store,o.feature,o),!0}return!1}(t,n))throw new Error("Error processing options response")})}var j=o(596),S=o(20),h=Object(r.select)({store:function(){return c.a}})(Object(r.action)("applyDefaultOptions")(function(t,e){void 0===t&&(t=Object(j.a)());var o=e.store;Object.keys(o.options).forEach(function(e){o.options[e].lastModifiedDateTime||t[e]&&Object(S.extendObservable)(o.options[e],t[e])})})),w=o(941),m=null,g=Object(r.select)({store:function(){return c.a}})(Object(r.action)("loadOptions")(function(t){switch(t.store.loadState){case s.a.OptionsNotLoaded:return t.store.loadState=s.a.OptionsLoading,m=Object(p.b)("ows/v1.0/OutlookOptions").then(function(e){var o,n;o=t,(n=e)?(n.options&&n.options.forEach(function(t){null!=t&&(o.store[t.feature]=t,a(o.store,t.feature,t))}),h(),o.store.loadState=s.a.OptionsLoaded):(O.c.info("Error loading options"),Object(w.a)(),o.store.loadState=s.a.OptionsNotLoaded),m=null});case s.a.OptionsLoading:return m;case s.a.OptionsLoaded:return Promise.resolve()}}));var A=o(935);function T(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,g()];case 1:return e.sent(),[2,Object(A.a)(t)]}})})}var M=Object(r.action)("updateAddinPinStatus")(function(t,e,o){var n=Object(A.a)(i.a.SurfaceActions),r=Object(A.a)(i.a.CalendarSurfaceAddins),a=!!o.readMode&&P(n.readSurfaceAddins,t,e);a=o.composeMode?P(n.composeSurfaceAddins,t,e)||a:a;var s=!!o.calendarMode&&P(r.calendarSurfaceAddins,t,e);a&&b(i.a.SurfaceActions,n),s&&b(i.a.CalendarSurfaceAddins,r)}),P=function(t,e,o){var n=!1;return o?-1===t.indexOf(e)&&(t.push(e),n=!0):-1!==t.indexOf(e)&&(t.splice(t.indexOf(e),1),n=!0),n};o.d(e,"createOrUpdateOptionsForFeature",function(){return b}),o.d(e,"loadOptions",function(){return g}),o.d(e,"getServerOptionsForFeature",function(){return T}),o.d(e,"updateAddinPinStatus",function(){return M})}}]);
//# sourceMappingURL=owa.OutlookServiceOptions.js.map
window.scriptsLoaded['owa.OutlookServiceOptions.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.OutlookServiceOptions.js'] = (new Date()).getTime();