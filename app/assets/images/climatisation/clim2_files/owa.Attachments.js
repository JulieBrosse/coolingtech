window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.Attachments.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[57],{114:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a={FavoriteNode:"favoritenode",InboxRule:"inboxrule",LocalFile:"Files",MailFolderNode:"mailfoldernode",MailListItemPart:"maillistitempart",MailListRow:"maillistrow",MultiMailListConversationRows:"multimaillistconversationrows",MultiMailListMessageRows:"multimaillistmessagerows",ReadWriteRecipient:"recipient",Todo:"todo",Attachment:"attachment"}},1190:function(e,t,n){"use strict";var a=n(0),r=n(1),i=n(4),o=Object(i.action)("setDragState")(function(e,t){e.isBeingDragged=t}),c=n(602),s=n(874),l=n(139);n.d(t,"a",function(){return u});var u=function(){function e(e){var t=this;this.props=e,this.initialPageX=0,this.initialPageY=0,this.dragHelperElement=null,this.isPotentialDrag=!1,this.isDragging=!1,this.onDragStart=function(e){e.dataTransfer.clearData(),t.isDragAllowed()?(e.stopPropagation(),t.setDragStateAndData(e),e.dataTransfer.effectAllowed="copyMove",t.onDragStartInternal(e.pageX,e.pageY),t.overrideDefaultDragPreviewImage(e.dataTransfer)):t.props.showDefaultNoDragImage&&(t.overrideDefaultNoDragImage(e.dataTransfer),e.dataTransfer.setData("text","nodrop"),e.dataTransfer.effectAllowed="none")},this.onDragEnd=function(e){if(t.isDragging){t.isDragging=!1;var n=t.props.onDragEnd,a=e?e.dataTransfer.dropEffect:null;(Object(l.b)()||Object(l.d)())&&(a=Object(c.b)()),n&&n(t.props.getDragData(),a)}t.resetDragStateAndData(),t.removeDragHelperElement()},this.onMouseDown=function(e){!s.a&&0==e.button&&t.isDragAllowed()&&(t.initialPageX=e.pageX,t.initialPageY=e.pageY,t.isPotentialDrag=!0,document.body.addEventListener("mousemove",t.onMouseMove),document.body.addEventListener("mouseup",t.onMouseUp)),t.props.onMouseDown&&t.props.onMouseDown(e)},this.refCallback=function(e){t.div=e,t.div&&t.div.addEventListener("mousedown",t.onMouseDown)},this.onMouseMove=function(e){var n=e.pageX,a=e.pageY;(Math.abs(t.initialPageX-n)>=s.b||Math.abs(t.initialPageY-a)>=s.b)&&(t.removeMouseMoveAndUpEventListeners(),t.isPotentialDrag&&(t.isPotentialDrag=!1,(Object(l.b)()||Object(l.d)())&&window.getSelection().removeAllRanges(),t.isDragAllowed()&&(t.dragHelperElement=t.getDragHelperElement(),document.body.appendChild(t.dragHelperElement))),t.dragHelperElement&&(t.dragHelperElement.addEventListener("dragstart",function(e){t.onDragStartHelperElement(e)}),t.dragHelperElement.addEventListener("dragend",function(e){t.onDragEnd(e)}),t.dragHelperElement.dragDrop(),setTimeout(t.onDragEnd,0)))},this.onMouseUp=function(e){t.removeMouseMoveAndUpEventListeners()},this.onDragStartHelperElement=function(e){var n=e;n.stopPropagation(),n.dataTransfer.effectAllowed="copyMove",t.setDragStateAndData(n),t.onDragStartInternal(n.pageX,n.pageY)},this.removeMouseMoveAndUpEventListeners=function(){document.body.removeEventListener("mousemove",t.onMouseMove),document.body.removeEventListener("mouseup",t.onMouseUp)},this.removeDragHelperElement=function(){document.body.contains(t.dragHelperElement)&&(document.body.removeChild(t.dragHelperElement),t.dragHelperElement=null)}}return e.prototype.onUnmount=function(){this.onDragEnd(null),s.a||this.removeMouseMoveAndUpEventListeners(),this.div.removeEventListener("mousedown",this.onMouseDown)},e.prototype.getDiv=function(){return this.div},e.prototype.onDragStartInternal=function(e,t){this.isDragging=!0;var n=this.props.onDragStart;n&&n(this.props.getDragData(),e,t)},e.prototype.setDragStateAndData=function(e){this.props.dragViewState&&o(this.props.dragViewState,!0);var t=this.props.getDragData();try{e.dataTransfer.setData(t.itemType,JSON.stringify(t))}catch(n){e.dataTransfer.setData("text",JSON.stringify(t))}Object(c.c)(t.itemType)},e.prototype.resetDragStateAndData=function(){this.props.dragViewState&&o(this.props.dragViewState,!1),Object(c.c)(null),Object(c.d)(null)},e.prototype.overrideDefaultDragPreviewImage=function(e){if(s.a){this.dragHelperElement=this.getDragHelperElement(),document.body.appendChild(this.dragHelperElement);var t=this.props.xOffset?this.props.xOffset:0,n=this.props.yOffset?this.props.yOffset:0;e.setDragImage(this.dragHelperElement,t,n)}},e.prototype.overrideDefaultNoDragImage=function(e){s.a&&(this.dragHelperElement=document.createElement("div"),this.dragHelperElement.style.display="none",document.body.appendChild(this.dragHelperElement),e.setDragImage(this.dragHelperElement,0,0))},e.prototype.getDragHelperElement=function(){var e=this.props.getDragPreview(this.props.getDragData());return e.style.top="0px",e.style.left="0px",e.style.zIndex="-1000",e.style.position="fixed",e},e.prototype.isDragAllowed=function(){return!this.props.canDrag||this.props.canDrag()},e}(),d=function(e){function t(t){var n=e.call(this,t)||this;return n.core=new u(t),n}return a.__extends(t,e),t.prototype.render=function(){return s.a?r.createElement("div",{draggable:!0,className:this.props.classNames,ref:this.core.refCallback,onDragStart:this.core.onDragStart,onDragEnd:this.core.onDragEnd},this.props.children):r.createElement("div",{className:this.props.classNames,ref:this.core.refCallback},this.props.children)},t.prototype.componentWillUnmount=function(){this.core.onUnmount()},t.prototype.getDiv=function(){return this.core.getDiv()},t}(r.Component);t.b=d},1210:function(e,t,n){"use strict";var a,r;n.d(t,"a",function(){return a}),(r=a||(a={}))[r.NoOp=0]="NoOp",r[r.AlwaysHidden=1]="AlwaysHidden",r[r.CopyMailReadingPaneContainer=2]="CopyMailReadingPaneContainer",r[r.LoadConversationReadingPane=3]="LoadConversationReadingPane",r[r.LoadItemReadingPane=4]="LoadItemReadingPane"},1215:function(e,t,n){"use strict";t.a={AttachmentCreation:{datapoint:{name:"AttachmentCreation",customData:function(e,t,n,a){return[e,t,n,a]}}},AttachmentDeletion:{datapoint:{name:"AttachmentDeletion",customData:function(e,t,n){return[t,n]}}},AttachmentCreationFailure:{datapoint:{name:"AttachmentCreationFailure",customData:function(e){return[null]}}},AttachmentDeletionFailure:{datapoint:{name:"AttachmentDeletionFailure",customData:function(e){return[e]}}},AttachmentCreationClassicFromAttachmentDataProvider:{datapoint:{name:"AttachmentCreationClassicFromAttachmentDataProvider",customData:function(e){return[e]}}},AttachmentCreationClassicFromLocalFile:{datapoint:{name:"AttachmentCreationClassicFromLocalFile",customData:function(e,t,n,a){return a?[a.size]:[0]}}},AttachmentCreationFromRecentAttachment:{datapoint:{name:"AttachmentCreationFromRecentAttachment",customData:function(e,t,n,a){return a?[a.size]:[0]}}},AttachmentCreationClassicFromLocalFileSliced:{datapoint:{name:"AttachmentCreationClassicFromLocalFileSliced",customData:function(e){return[e]}}},AttachmentCreationCloudyFromAttachmentDataProvider:{datapoint:{name:"AttachmentCreationCloudyFromAttachmentDataProvider",customData:function(e,t,n,a){return[n.providerType]}}},AttachmentCreationCloudyFromLocalFile:{datapoint:{name:"AttachmentCreationCloudyFromLocalFile"}},AttachmentSaveAllToCloud:{datapoint:{name:"AttachmentSaveAllToCloud",customData:function(e,t,n){return[e,t,n]}}},AttachmentDeletionAction:{datapoint:{name:"AttachmentDeletionAction"}},AttachmentWellInitialization:{datapoint:{name:"AttachmentWellInitialization",isVerbose:!0}},AttachmentsCanNotShareInternally:{datapoint:{name:"AttachmentsCanNotShareInternally"}},AttachmentCreationFromUri:{datapoint:{name:"AttachmentCreationFromUri",customData:function(e){return{size:e?e.size:0}}}},AttachmentIncludeMostRecentAttachments:{datapoint:{name:"AttachmentIncludeMostRecentAttachments"}},AttachmentDoNotIncludeMostRecentAttachments:{datapoint:{name:"AttachmentDoNotIncludeMostRecentAttachments"}},AttachmentShowIncludeMostRecentAttachmentsMessage:{datapoint:{name:"AttachmentShowIncludeMostRecentAttachmentsMessage"}},SharingTipsConvertToClassic:{datapoint:{name:"SharingTipsConvertToClassic"}}}},1229:function(e,t,n){"use strict";var a=n(1278),r=n(984),i=n(1266),o=n(4);t.a=Object(o.action)("setOngoingActionAndActionMessage")(function(e,t,n){Object(a.a)(e,t),e.actionMessage=n,Object(i.a)(e)?Object(r.a)(e,!0):Object(r.a)(e,!1)})},1234:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(18),r=n(276);function i(e){switch(e.__type){case r.e:return 0;case r.m:return 1;case r.g:return 2;case r.h:var t=e;return Object(a.isStringNullOrWhiteSpace)(t.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+e.__type)}}},1243:function(e,t,n){"use strict";n.d(t,"a",function(){return x});var a=n(50),r=n(568),i={classicFileIcon:"attachment-icon-accdb_32x32",smallFileIcon:Object(a.b)("accdb").small,extraSmallFileIcon:Object(a.b)("accdb").extraSmall},o={classicFileIcon:"attachment-icon-xlsx_32x32",smallFileIcon:Object(a.b)("xlsx").small,extraSmallFileIcon:Object(a.b)("xlsx").extraSmall},c={classicFileIcon:"attachment-icon-pptx_32x32",smallFileIcon:Object(a.b)("pptx").small,extraSmallFileIcon:Object(a.b)("pptx").extraSmall},s={classicFileIcon:"attachment-icon-docx_32x32",smallFileIcon:Object(a.b)("docx").small,extraSmallFileIcon:Object(a.b)("docx").extraSmall},l={classicFileIcon:"attachment-icon-audio_32x32",smallFileIcon:Object(a.b)("audio").small,extraSmallFileIcon:Object(a.b)("audio").extraSmall},u={classicFileIcon:"attachment-icon-video_32x32",smallFileIcon:Object(a.b)("video").small,extraSmallFileIcon:Object(a.b)("video").extraSmall},d={classicFileIcon:"attachment-icon-txt_32x32",smallFileIcon:Object(a.b)("txt").small,extraSmallFileIcon:Object(a.b)("txt").extraSmall},m={classicFileIcon:"attachment-icon-photo_32x32",smallFileIcon:Object(a.b)("photo").small,extraSmallFileIcon:Object(a.b)("photo").extraSmall},h={classicFileIcon:"attachment-icon-vsdx_32x32",smallFileIcon:Object(a.b)("vsdx").small,extraSmallFileIcon:Object(a.b)("vsdx").extraSmall},p={classicFileIcon:"attachment-icon-calendar_32x32",smallFileIcon:Object(a.b)("calendar").small,extraSmallFileIcon:Object(a.b)("calendar").extraSmall},f={classicFileIcon:"attachment-icon-email_32x32",smallFileIcon:Object(a.b)("email").small,extraSmallFileIcon:Object(a.b)("email").extraSmall},v={classicFileIcon:"attachment-icon-pdf_32x32",smallFileIcon:Object(a.b)("pdf").small,extraSmallFileIcon:Object(a.b)("pdf").extraSmall},g={classicFileIcon:"attachment-icon-code_32x32",smallFileIcon:Object(a.b)("code").small,extraSmallFileIcon:Object(a.b)("code").extraSmall},b={classicFileIcon:"attachment-icon-one_32x32",smallFileIcon:Object(a.b)("one").small,extraSmallFileIcon:Object(a.b)("one").extraSmall},w={classicFileIcon:"attachment-icon-onetoc_32x32",smallFileIcon:Object(a.b)("onetoc").small,extraSmallFileIcon:Object(a.b)("onetoc").extraSmall},I={classicFileIcon:"attachment-icon-sharedfolder_32x32",smallFileIcon:Object(a.b)("sharedfolder").small,extraSmallFileIcon:Object(a.b)("sharedfolder").extraSmall},S={classicFileIcon:r.a,smallFileIcon:Object(a.b)("generic").small,extraSmallFileIcon:Object(a.b)("generic").extraSmall},O={classicFileIcon:r.b,smallFileIcon:Object(a.b)("generic").small,extraSmallFileIcon:Object(a.b)("generic").extraSmall},A={".accdb":i,".accdc":i,".accde":i,".accdr":i,".accdt":i,".acs":i,".mdb":i,".csv":o,".xcl":o,".xlsx":o,".xlsm":o,".xlsb":o,".xls":o,".xltx":o,".xltm":o,".xlt":o,".xlam":o,".xla":o,".ods":o,".pptx":c,".pptm":c,".ppt":c,".potx":c,".potm":c,".pot":c,".ppsx":c,".ppsm":c,".pps":c,".ppam":c,".ppa":c,".odp":c,".docx":s,".docm":s,".doc":s,".dot":s,".dotx":s,".dotm":s,".wps":s,".wri":s,".odt":s,".one":b,".onepkg":w,".onetoc2":w,".pdf":v,".wav":l,".aiff":l,".mp2":l,".mp3":l,".mpa":l,".aac":l,".wm":l,".wma":l,".m4a":l,".ogg":l,".flac":l,".ape":l,".mp4":u,".mpe":u,".mpeg":u,".mpg":u,".mpv2":u,".avi":u,".m1v":u,".mov":u,".wmd":u,".wms":u,".wmv":u,".wmz":u,".3g2":u,".3gp":u,".asf":u,".asx":u,".flv":u,".srt":u,".swf":u,".vob":u,".zip":{classicFileIcon:"attachment-icon-zip_32x32",smallFileIcon:Object(a.b)("zip").small,extraSmallFileIcon:Object(a.b)("zip").extraSmall},".rpmsg":{classicFileIcon:"attachment-icon-rpmsg_32x32",smallFileIcon:Object(a.b)("rpmsg").small,extraSmallFileIcon:Object(a.b)("rpmsg").extraSmall},".log":d,".txt":d,".rtf":d,".dib":m,".jpg":m,".jpeg":m,".jpe":m,".jfif":m,".ico":m,".gif":m,".png":m,".bmp":m,".psd":m,".tif":m,".tiff":m,".vdx":h,".vsd":h,".vsdx":h,".vsl":h,".vss":h,".vst":h,".mpp":{classicFileIcon:"attachment-icon-project_32x32",smallFileIcon:Object(a.b)("generic").small,extraSmallFileIcon:Object(a.b)("generic").extraSmall},".pub":{classicFileIcon:"attachment-icon-pblsh_32x32",smallFileIcon:Object(a.b)("pblsh").small,extraSmallFileIcon:Object(a.b)("pblsh").extraSmall},".xsn":{classicFileIcon:"attachment-icon-infopath_32x32",smallFileIcon:Object(a.b)("infopath").small,extraSmallFileIcon:Object(a.b)("infopath").extraSmall},".msg":f,".email":f,".eml":f,".exe":{classicFileIcon:"attachment-icon-exe_32x32",smallFileIcon:Object(a.b)("exe").small,extraSmallFileIcon:Object(a.b)("exe").extraSmall},".ics":p,".ical":p,".icalendar":p,".vcs":p,".aspx":g,".htm":g,".html":g,".xml":g},C=Object.freeze({"application/vnd.google-apps.document":{classicFileIcon:r.b,smallFileIcon:Object(a.b)("gdoc").small,extraSmallFileIcon:Object(a.b)("gdoc").extraSmall},"application/vnd.google-apps.spreadsheet":{classicFileIcon:r.b,smallFileIcon:Object(a.b)("gsheet").small,extraSmallFileIcon:Object(a.b)("gsheet").extraSmall},"application/vnd.google-apps.presentation":{classicFileIcon:r.b,smallFileIcon:Object(a.b)("gslide").small,extraSmallFileIcon:Object(a.b)("gslide").extraSmall},"application/vnd.google-apps.form":{classicFileIcon:r.b,smallFileIcon:Object(a.b)("gform").small,extraSmallFileIcon:Object(a.b)("gform").extraSmall},"application/onenote":b,"application/pdf":v});function x(e,t,n,a,r){if(n)return S;if(r)return f;if(a)return I;var i=A[e&&e.toLowerCase()];return!i&&t&&t in C?C[t]:i||O}},1252:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(276),r=n(597),i=[0,1,3,2,6,5,7,8,4];function o(e){var t=null,n=function(n){var a=Object(r.b)(n);return null===a?null:function(){if(!t){t={};for(var n=0,a=i;n<a.length;n++){var r=a[n];t[r]=e(r)}}return t}()[a]};return{getDataProviderInfo:n,getDefaultDataProviderInfo:function(e){return n(e?a.k:a.l)}}}},1253:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return c}),n.d(t,"a",function(){return s});var a=n(1243);n.d(t,"d",function(){return a.a});var r=n(2),i=new r.c(function(){return Promise.all([n.e(6),n.e(7),n.e(25),n.e(34),n.e(57)]).then(n.bind(null,1836))}),o=Object(r.d)(i,function(e){return e.AttachmentThumbnailView}),c=Object(r.d)(i,function(e){return e.AttachmentIconView}),s=Object(r.d)(i,function(e){return e.AttachmentDocInfoView})},1254:function(e,t,n){"use strict";var a=n(1279),r=n(1265),i=n(1229),o=n(18);var c=n(150),s=n(599),l=n(617);n.d(t,"b",function(){return d}),n.d(t,"a",function(){return m});var u=null;function d(){return u||(u=Object.keys(c.a).reduce(function(e,t){var n=c.a[t];return Number.isInteger(n)&&e.push(n),e},[])),u}function m(e,t,n){n&&0!==n.length||(n=d());var c,u,m=Object(s.c)(t.model,!0),h=Object(s.f)(),p=Object(l.a)(t),f=p&&t.isFolder,v=Object(a.a)(h,m,t.attachmentClass,t.model,p?t.model.ProviderType:null,t.model.AttachmentOriginalUrl,t.info.allowDownload,f,n,e.isReadOnly);e.strategy=v,c=e,u=t,e.strategy.isSaveToCloudSupported&&!Object(o.isStringNullOrWhiteSpace)(u.model.AttachmentOriginalUrl)&&(Object(r.a)(c,2),Object(i.a)(c,0,2))}},1265:function(e,t,n){"use strict";var a=n(4);t.a=Object(a.action)("addCompletedAction")(function(e,t){e.completedActions.push(t)})},1266:function(e,t,n){"use strict";function a(e){return 0!==e.actionMessage}n.d(t,"a",function(){return a})},1267:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(896);function r(e,t,n){if(t)Object(a.a)(e);else{var r=document.createElement("a");r.style.display="none",r.href=e,r.download="",n||(n=document.body),n.appendChild(r),r.click(),n.removeChild(r)}}},1278:function(e,t,n){"use strict";var a=n(4);t.a=Object(a.action)("setOngoingAction")(function(e,t){e.ongoingAction=t})},1279:function(e,t,n){"use strict";var a=n(0),r=n(599),i=n(150),o=n(82),c=n(149);function s(e){switch(e){case i.a.Download:return c.a.Download;case i.a.OpenInNewTab:return c.a.OpenInNewTab;case i.a.Preview:return c.a.Preview;case i.a.ImportCalendarEventAttachment:case i.a.ChangePermissions:case i.a.CopyLink:case i.a.SaveToCloud:case i.a.ViewInProvider:case i.a.ConvertClassicToCloudy:case i.a.ConvertCloudyToClassic:case i.a.MoveAttachmentToInline:case i.a.RefreshLink:case i.a.IgnoreExpiration:return null;default:return Object(o.a)(e)}}function l(e){switch(e){case c.a.Download:return i.a.Download;case c.a.OpenInNewTab:return i.a.OpenInNewTab;case c.a.Preview:return i.a.Preview;case c.a.NoAction:return null;default:return Object(o.a)(e)}}var u=n(1252),d=n(8);var m=Object(u.a)(function(e){switch(e){case 0:return n={supportViewInProvider:!1,supportConvertCloudyToClassic:!1},a.__assign({},n,{supportViewInProvider:!0,supportConvertCloudyToClassic:!0});case 1:return t={supportViewInProvider:!1,supportConvertCloudyToClassic:!1},a.__assign({},t,{supportConvertCloudyToClassic:Object(d.c)("doc-consumerUrl")});case 3:case 2:case 6:case 5:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};case 7:case 8:case 9:case 4:case 10:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};default:return Object(o.a)(e)}var t,n}),h=m.getDataProviderInfo,p=m.getDefaultDataProviderInfo,f=h;var v=n(144),g=n(18);function b(e,t,n,i,o,u,d,m,h,p){var g,b,I,S=Object(c.d)(t,n,i);b=h,I=function(e,t,n){void 0===n&&(n=!1);var a=e.filter(function(e){return-1!==t.indexOf(e)});return n&&(a=a.filter(function(e,t,n){return n.indexOf(e)===t})),a}((g=S).supportedOpenActions.map(l).filter(function(e){return!!e}),b),g.supportedOpenActions=I.map(s);var O,A,C,x,y,_,T,P,j,D,k,E,F,V,M,L,R,N,B,W,U=i.__type===v.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE,z=Object(r.e)(i,U,p),H=U,G=w(U,o,u),q=(O=U,A=p,e.convertClassicToCloudyEnabled&&!O&&!A),Q=function(e,t,n,a,r){if(e.convertCloudyToClassicEnabled&&t&&!n&&a){var i=f(r);return i&&i.supportConvertCloudyToClassic||!1}return!1}(e,U,p,d,o),J=2===n&&!U&&!p;switch(n){case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:case 13:F=S,V=z,M=U,L=H,R=G,N=q,B=Q,W=J,C=a.__assign({},F,{isSaveToCloudSupported:V,isOpeningByLinkSupported:M,isOpeningInProviderSupported:L,isViewingInProviderSupported:R,isConvertClassicToCloudySupported:N,isConvertCloudyToClassicSupported:B,isMoveAttachmentToInlineSupported:W,showActionsMenu:!0,supportedMenuActions:[]});break;case 1:E=S,C=a.__assign({},E,{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!1,isOpeningInProviderSupported:!1,isViewingInProviderSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]});break;default:U?(P=S,j=H,D=G,k=Q,C=a.__assign({},P,{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!0,isOpeningInProviderSupported:j,isViewingInProviderSupported:D,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:k,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})):(x=S,y=z,_=G,T=q,C=a.__assign({},x,{isSaveToCloudSupported:y,isViewingInProviderSupported:_,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:T,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]}))}return C.supportedMenuActions=h,C}function w(e,t,n){if(e)return(r=f(t))&&r.supportViewInProvider||!1;var a=Object(d.c)("doc-consumerUrl"),r=p(a);return!Object(g.isStringNullOrWhiteSpace)(n)&&(a||r&&r.supportViewInProvider)}n.d(t,"a",function(){return b}),n.d(t,"b",function(){return w})},1493:function(e,t,n){"use strict";n.r(t);var a=n(2478),r=n(3);Object(r.mutator)(a.a,function(e){e.linkId&&!e.sharingLinkIds.includes(e.linkId)&&e.sharingLinkIds.push(e.linkId)}),Object(r.mutator)(a.f,function(e){var t=e.sharingLinkIds.indexOf(e.linkId);-1!==t&&e.sharingLinkIds.splice(t,1)});var i=n(2642),o=n(1215),c=n(3745),s=n(595),l=n(3361);function u(e){var t=e.docViewAttachments.concat(e.imageViewAttachments),n=t.filter(function(e){return e.isCloudy}).map(function(e){var t=Object(s.a)(e.attachmentId);return Object(l.a)(t,e.strategy.isConvertCloudyToClassicSupported)}),r=e.sharingLinkIds.map(function(e){return Object(a.d)(e)});return n.concat(r)}var d=n(9),m=n(136),h=n(2093),p=n(93);var f,v=n(18),g=n(11),b=n.n(g),w=n(2272),I=n(335),S=[{infoBarMessageId:"WarningNoPermissionToShare",infoBarMessageCreator:function(e,t){var n=Object(w.c)(e);if(0===n.length)return null;if(1===n.length&&n[0].supportsDownsell){var a=Object(v.format)(b.a.NoPermissionToShareText,n[0].name),r={key:t,source:I.c.Compose,rank:I.b.Info,messageParts:[a]},i=f(n[0].id);return r.messageParts.push(i),function(e){return r}}var o=n.map(function(e){return e.name}).join(", ");return[Object(v.format)(b.a.NoPermissionToShareText,o,n.length>1?b.a.SuggestActionForMultipleFilesCannotShareText:b.a.SuggestActionForSingleFileCannotShareText)]}},{infoBarMessageId:"WarningGetSharingInfoFailed",infoBarMessageCreator:function(e,t){if(!Object(m.b)("doc-attachment-sharingInfoFailureTip"))return null;return Object(w.d)(e).length>0&&[b.a.NoSharingInfoText]}},{infoBarMessageId:"WarningLinksHasExpired",infoBarMessageCreator:function(e,t){if(!Object(m.b)("doc-attachment-expiringLinkImprovements"))return null;var n=Object(w.a)(e),a=n.map(function(e){return e.name}).join(", ");if(1===n.length)return[Object(v.format)(b.a.SingleLinkIsExpiredText,a)];if(n.length>1)return[Object(v.format)(b.a.MultipleLinksAreExpiredText,a)];return null}},{infoBarMessageId:"WarningLinksWillExpire",infoBarMessageCreator:function(e,t){if(!Object(m.b)("doc-attachment-expiringLinkImprovements"))return null;var n=Object(w.b)(e),a=n.map(function(e){return e.name}).join(", ");if(1===n.length)return[Object(v.format)(b.a.SingleLinkWillExpireText,a)];if(n.length>1)return[Object(v.format)(b.a.MultipleLinksWillExpireText,a)];return null}}];Object(r.orchestrator)(i.a,function(e){var t=e.attachmentWellViewState,n=e.parentItemId,a=e.infoBarAddHandler,r=e.infoBarRemoveHandler,i=u(t);f=function(e){var i,l,u,m=(l=e,0===(u=(i=t).docViewAttachments.filter(function(e){return Object(p.c)(e.attachmentId,l)})).length&&(u=i.imageViewAttachments.filter(function(e){return Object(p.c)(e.attachmentId,l)})),0===u.length?null:u[0]);if(m){var f=Object(s.a)(m.attachmentId);return{text:b.a.SuggestAttachingACopySingleText,action:function(){var e=f.model;Object(d.n)(o.a.SharingTipsConvertToClassic.datapoint.name),Object(h.e)(m,n.Id,e.AttachLongPathName,e.PermissionType,function(e,i,o,s){Object(c.a)(t,e,i,o,s,n,a,r)})}}}return null},S.forEach(function(e){return n=i,o=a,c=r,s=(t=e).infoBarMessageCreator(n,t.infoBarMessageId),c([t.infoBarMessageId]),void(s&&o(t.infoBarMessageId,s));var t,n,o,c,s})});var O=n(2954),A=n(3308),C=n(0),x=n(603),y=n(3750),_=n(2789),T=n(2922),P=n(4),j=Object(P.action)("setAttachmentInfo")(function(e,t){Object(s.a)(e).info=t}),D=n(617),k=n(2442),E=n(599);var F=Object(P.action)("initializeAttachments",o.a.AttachmentWellInitialization)(function(e,t,n,a,r,i,o,c){if(e){var l,u=(l=r)?Object(h.l)().filter(function(e){return!l.includes(e)}):null;n.isInitialized||e.forEach(function(e){!function(e,t,n,a,r,i,o,c){if((!e.IsInline||e.__type===x.c)&&"application/x-sharing-metadata-xml"!==e.ContentType){var l=Object(h.g)(C.__assign({},e.AttachmentId,{mailboxInfo:t}),e,n.isReadOnly,!0,a,null,r,!0),u=!!n.parentItemIdMap;if(Object(k.a)(e)&&!u?n.imageViewAttachments.push(l):n.docViewAttachments.push(l),l.isCloudy){var d=Object(s.a)(l.attachmentId);d.requiresFetchingSharingInformation&&i&&o&&Object(w.e)(d.model.AttachLongPathName).then(function(e){if(Object(w.g)(e)){var t=Object(E.c)(d.model,!0),a=Object(D.a)(d),r=Object(T.a)(t,d.attachmentClass,d.model,a,a?d.model.ProviderType:null,e);j(d.id,r),Object(y.a)(l,d.model,e,{attachmentWellViewState:n,parentItemId:i,infoBarAddHandler:o,infoBarRemoveHandler:c})}})}else Object(_.a)(n,e.Size)}}(e,t,n,a,u,i,o,c)}),n.supportedMenuActions=u,n.isInitialized=!0}});var V=Object(P.action)("reinitializeAttachments")(function(e,t,n,a,r){e&&(n.docViewAttachments=[],n.imageViewAttachments=[],n.inlineAttachments=[],n.isInitialized=!1,F(e,t,n,a,r))}),M=n(1626);function L(e){var t=Object(M.a)(!1,void 0===e);if(e){var n=e.attachments,a=e.mailboxInfo,r=e.parentItemId,i=e.infoBarAddHandler,o=e.infoBarRemoveHandler;F(n,a,t,!0,null,r,i,o)}return t}var R=n(2956);function N(e,t){var n=Object(M.a)(!0,!1);return C.__assign({},n,{parentItemIdMap:e,itemReceivedTimeMap:t,isVisible:!1,maxHeight:0})}function B(e,t){var n=new FileReader;n.onload=function(){var e=new Image;e.onload=function(){t(e.width,e.height)},e.onerror=function(){t(0,0)},e.src=n.result},n.readAsDataURL(e)}var W=n(950);function U(e){return z(e.docViewAttachments)||z(e.imageViewAttachments)||e.inlineAttachments.some(function(e){return 0===e.status})}function z(e){return e.some(function(e){return 0!==e.ongoingAction})}var H=n(2926),G=n(2646),q=n(2644),Q=n(2916),J=n(2957),Y=Object(r.mutatorAction)("mergeToConversationAttachmentWell",function(e,t,n,a){e&&(e.docViewAttachments.forEach(function(e){Z(e,t,n,a)}),e.imageViewAttachments.forEach(function(e){Z(e,t,n,a)}))});function Z(e,t,n,a){t.parentItemIdMap[e.attachmentId.Id]||(t.docViewAttachments.push(C.__assign({},e)),t.parentItemIdMap[e.attachmentId.Id]=n,t.itemReceivedTimeMap[e.attachmentId.Id]=a)}var X=Object(r.mutatorAction)("sortConversationAttachmentWell",function(e,t){e.docViewAttachments=e.docViewAttachments.sort(function(n,a){return(t?1:-1)*(new Date(e.itemReceivedTimeMap[n.attachmentId.Id]).getTime()-new Date(e.itemReceivedTimeMap[a.attachmentId.Id]).getTime())})});function K(e,t){var n=!1;return e.sharingLinkIds.forEach(function(r){t[r]||(Object(a.f)(r,e.sharingLinkIds),n=!0)}),n}var $=n(657),ee=Object(r.mutatorAction)("convertImageViewAttachmentToInlineAttachment",function(e,t,n){var a=Object(s.a)(t.attachmentId);if(a){var r=e.imageViewAttachments,i=e.inlineAttachments,o=r.indexOf(t);if(o>=0){r.splice(o,1),a.model.ContentId=n,a.model.IsInline=!0,a.model.AttachmentOriginalUrl=Object($.c)(t.attachmentId,1);var c=Object(h.h)(t.attachmentId,t.attachmentId.Id,!1);c.status=3,i.push(c)}}}),te=n(2793);n.d(t,"refreshSharingTips",function(){return i.a}),n.d(t,"addAttachmentIntoWellBeforeUpload",function(){return O.a}),n.d(t,"createAttachment",function(){return A.a}),n.d(t,"initializeAttachments",function(){return F}),n.d(t,"reinitializeAttachments",function(){return V}),n.d(t,"getAttachmentWellForCompose",function(){return L}),n.d(t,"getAttachmentWellInitialValue",function(){return M.a}),n.d(t,"getAvailableLocalAttachmentSize",function(){return R.a}),n.d(t,"getConversationAttachmentWellInitialValue",function(){return N}),n.d(t,"getImageDimensionsFromFile",function(){return B}),n.d(t,"getMaxClassicAttachmentsSize",function(){return W.a}),n.d(t,"hasPendingAttachments",function(){return U}),n.d(t,"createAttachmentFullViewStateAndStoreBackingModel",function(){return H.a}),n.d(t,"setInlineAttachmentStatus",function(){return G.a}),n.d(t,"createAttachmentFullViewState",function(){return q.a}),n.d(t,"createAttachmentsViaQueueManager",function(){return Q.a}),n.d(t,"deleteAttachmentViaQueueManager",function(){return Q.b}),n.d(t,"createAttachmentFileFromExistingMailboxAttachment",function(){return J.a}),n.d(t,"mergeToConversationAttachmentWell",function(){return Y}),n.d(t,"sortConversationAttachmentWell",function(){return X}),n.d(t,"wasAnyLinkRemoved",function(){return K}),n.d(t,"convertImageViewAttachmentToInlineAttachment",function(){return ee}),n.d(t,"getAttachmentViewStateFromAttachmentWell",function(){return te.a})},1626:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a,r=n(950);function i(e,t){return a||(a=Object(r.a)()),{allowShowMultipleRows:!e,didViewOverflowOneRow:!1,canOverrideAllowShowMultipleRows:!0,docViewAttachments:[],imageViewAttachments:[],inlineAttachments:[],isInitialized:t,isReadOnly:e,groupId:null,maxTotalClassicAttachmentSize:a,totalClassicAttachmentSize:0,saveAllToCloudStatus:0,supportedMenuActions:null,sharingLinkIds:[]}}},1739:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(82),i=n(3),o=Object(i.action)("initializeReadingPaneInSxS",function(e,t,n,a){return{readingPaneStrategy:e,previewPaneSelectionSource:t,parentItemId:n,instrumentationContext:a}}),c=Object(i.action)("initializeConversationReadingPaneInSxS",function(e,t,n,a){return{readingPaneStrategy:e,previewPaneSelectionSource:t,parentItemId:n,instrumentationContext:a}}),s=Object(i.action)("initializeItemReadingPaneInSxS",function(e,t){return{readingPaneStrategy:e,instrumentationContext:t}}),l=Object(i.action)("initializeReadingPaneInSxSByCopyingMailReadingPane",function(e,t,n){return{previewPaneSelectionSource:e,parentItemId:t,instrumentationContext:n}}),u=n(173),d=n(34),m=n(73);Object(i.orchestrator)(c,function(e){return a.__awaiter(void 0,void 0,void 0,function(){var t,n,i,o;return a.__generator(this,function(a){switch(a.label){case 0:return t=e.readingPaneStrategy,n=e.previewPaneSelectionSource,i=e.parentItemId,o=e.instrumentationContext,t&&t.conversationId?u.z.readingPaneState&&u.z.readingPaneState.mode===u.e.ConversationReadingPane&&u.z.readingPaneState.conversationId&&u.z.readingPaneState.conversationId.Id===t.conversationId.Id?(i&&function(e){switch(e){case d.h.MailList:case d.h.ConversationAttachmentWell:return!0;case d.h.ReadingPane:case d.h.FilesHub:case d.h.PhotoHub:case d.h.GroupFilesHub:case d.h.Deeplink:return!1;default:return Object(r.a)(e)}}(n)&&m.n.importAndExecute(i.Id),[2]):[4,m.g.importAndExecute(t.conversationId,o,t.conversationSubject,t.conversationCategories,t.itemIdToScrollTo)]:[2];case 1:return a.sent(),[4,u.u.import()];case 2:return a.sent()({mode:u.e.ConversationReadingPane,conversationId:t.conversationId,conversationCategories:t.conversationCategories,conversationSubject:t.conversationSubject}),i&&m.n.importAndExecute(i.Id),[2]}})})});Object(i.orchestrator)(s,function(e){return a.__awaiter(void 0,void 0,void 0,function(){var t,n,r;return a.__generator(this,function(a){switch(a.label){case 0:return t=e.readingPaneStrategy,n=e.instrumentationContext,t&&t.itemId?u.z.readingPaneState&&u.z.readingPaneState.mode===u.e.ItemReadingPane&&u.z.readingPaneState.itemId&&u.z.readingPaneState.itemId.Id===t.itemId.Id?[2]:[4,u.u.import()]:[2];case 1:return r=a.sent(),[4,m.i.import()];case 2:return[4,a.sent()(t.itemId,n,function(e){r({mode:u.e.ItemReadingPane,itemId:t.itemId,itemReadingPaneViewState:e})})];case 3:return a.sent(),[2]}})})});var h=n(1210),p=n(20),f=n(75),v=n(5),g=n(48),b=n(111),w=n(43),I=n(113);Object(i.orchestrator)(l,function(e){return a.__awaiter(void 0,void 0,void 0,function(){var t,n,r,i,o,l,d,m,S,O,A,C,x,y,_,T,P,j,D,k;return a.__generator(this,function(a){switch(a.label){case 0:return u.z.shouldShow&&(u.z.readingPaneState||u.z.composeState)?[2]:(t=e.previewPaneSelectionSource,n=e.parentItemId,r=e.instrumentationContext,i=v.F.tableViews.get(v.F.selectedTableViewId).tableQuery,o=Object(v.C)(i)||Object(w.m)(i),l=Object(I.c)(),(d=l&&l.type===I.a.Compose?l.data:f.b.defaultViewState&&!f.b.defaultViewState.isInlineCompose?f.b.defaultViewState:null)?[4,f.l.import()]:[3,2]);case 1:return m=a.sent(),(S=Object(p.toJS)(d)).composeId=m(),f.q.importAndExecute(S,f.a.SxS),[2];case 2:if(O=b.a.conversationReadingPaneViewState,A=b.a.deeplinkId,C=Object(g.a)(),A)s({method:h.a.LoadItemReadingPane,itemId:{mailboxInfo:C,Id:A.id}},r);else if(l&&l.type===I.a.SecondaryReadingPane)switch((x=l.data).listViewType){case 0:c({method:h.a.LoadConversationReadingPane,conversationId:x.id,conversationSubject:x.subject,conversationCategories:x.categories},t,n,r);break;case 1:s({method:h.a.LoadItemReadingPane,itemId:x.id},r)}else if(O&&Object(f.c)(O.conversationId.Id))c({method:h.a.LoadConversationReadingPane,conversationId:O.conversationId,conversationSubject:O.conversationSubject,conversationCategories:O.conversationCategories},t,n,r);else if(y=Object(v.v)(),_=y&&y.selectedRowKeys.keys().slice(),T=y&&y.isInVirtualSelectAllMode,P=v.F.expandedConversationViewState.selectedNodeIds.length,1==_.length&&P<=1&&!T&&!o)switch(j=v.b.getRowClientItemId(_[0],y),y&&y.tableQuery.listViewType){case 0:D=v.b.getSubject(_[0],y),k=v.b.getCategories(_[0],y),c({method:h.a.LoadConversationReadingPane,conversationId:j,conversationSubject:D,conversationCategories:k},t,n,r);break;case 1:s({method:h.a.LoadItemReadingPane,itemId:j},r)}return[2]}})})});Object(i.orchestrator)(o,function(e){return a.__awaiter(void 0,void 0,void 0,function(){var t,n,r,i;return a.__generator(this,function(a){switch(a.label){case 0:if(t=e.readingPaneStrategy,n=e.previewPaneSelectionSource,r=e.parentItemId,i=e.instrumentationContext,!t)return[2];switch(t.method){case h.a.NoOp:return[3,1];case h.a.AlwaysHidden:return[3,2];case h.a.CopyMailReadingPaneContainer:return[3,4];case h.a.LoadConversationReadingPane:return[3,5];case h.a.LoadItemReadingPane:return[3,6]}return[3,7];case 1:return[2];case 2:return[4,u.u.import()];case 3:return a.sent()(null),[2];case 4:return l(n,r,i),[2];case 5:return c(t,n,r,i),[2];case 6:return s(t,i),[2];case 7:return[2]}})})});var S=n(666),O=n.n(S),A=n(3330),C=n(2986),x=n(11),y=n.n(x),_=n(782),T=n(149),P=n(9),j=n(657),D=n(599),k=n(869),E=n(617),F=n(18),V=n(2),M=new V.c(function(){return Promise.all([n.e(7),n.e(20),n.e(25),n.e(40),n.e(69)]).then(n.bind(null,5687))}),L=new V.a(M,function(e){return e.loadItemAttachment}),R={ClickAttachment:{datapoint:{name:"ClickAttachment",customData:function(e,t){return{actionPerformed:T.a[Object(T.e)(e.strategy)],actionSource:d.h[t]}}}},PreviewAttachmentInSxSE2E:{datapoint:{name:"PreviewAttachmentInSxSE2E",options:{isQos:!0},customData:function(e,t,n,a,r,i,o,c){return{previewMethod:t,fileType:n,fileSize:a,isCloudy:r,isChangingFromEditing:i,officeFileType:o,module:e,actionSource:d.h[c]}}}}};var N=n(595),B=n(93),W=n(191),U=n(2302),z=n(379),H=n(4),G=Object(H.select)({previewPaneStore:function(){return d.y}})(Object(H.action)("previewAttachmentInSxS")(function(e,t,n,i,o,c){return a.__awaiter(this,void 0,void 0,function(){var s,l,u,h;return a.__generator(this,function(p){switch(p.label){case 0:return[4,d.w.import()];case 1:return s=p.sent(),(c=c).previewPaneStore.state&&Object(B.c)(c.previewPaneStore.state.attachmentId,e.attachmentId)?[2]:(c.previewPaneStore.previewSelectionSource=t,l=function(e,t,n,r,i){var o=Object(N.a)(e.attachmentId),c=o.download.url,s=o.info.allowDownload,l=e.strategy,u=Object(D.e)(o.model,e.isCloudy,e.isReadOnly)&&Object(F.isStringNullOrWhiteSpace)(o.model.AttachmentOriginalUrl)?d.l.available:d.l.disabled,m=q(o,l.previewMethod,e.isCloudy,r.previewPaneStore.state&&r.previewPaneStore.state.mode===d.g.Edit,i),h=o.model,p={downloadUrl:c,isDownloadDisabled:!s,name:h.Name,size:h.Size,attachmentId:e.attachmentId,itemId:t,isDraft:n,savingAttachmentId:null,mode:d.g.View,editAllowed:l.allowEdit,saveToCloudStatus:u,addToCalendarStatus:0,isCloudy:e.isCloudy,type:l.previewMethod,errorMessage:null,perfDatapoint:m};switch(l.previewMethod){case T.b.Image:var f=r.previewPaneStore.state,v=!(!f||o.previewImage.url!==f.previewUrl||!f.imageLoaded),g=a.__assign({},p,{previewUrl:o.previewImage.url,imageLoaded:v,isImageLoading:!v});return g;case T.b.Wac:var b=a.__assign({},p,{clickTime:(new Date).getTime(),mode:d.g.NoUrl,wacUrl:null,wacEditUrl:null});return b;case T.b.GoogleDoc:var w=a.__assign({},p,{contentType:h.ContentType,previewUrl:h.AttachLongPathName});return w;case T.b.NativeView:var I=a.__assign({},p,{previewUrl:null,printUrl:null,mediaType:"application/pdf",mode:d.g.NoUrl});return I;case T.b.PdfJs:var S=a.__assign({},p,{previewUrl:c+"&isDocumentPreview=True"});return S;case T.b.Audio:case T.b.Video:return p;case T.b.Text:var O=a.__assign({},p,{textContent:null});return O;case T.b.ItemAttachment:return L.importAndExecute(e.attachmentId,m),p;case T.b.CalendarEvent:var A=a.__assign({},p,{calendarItem:null,icsCalendarEventType:d.b.UNKNOWN,dialogMessage:null,isIcsAttachmentLoading:!1,addToCalendarStatus:1});return A;default:throw new Error("Unsupported preview method")}}(e,n,i,c,t),(b=c.previewPaneStore).state&&b.state.mode===d.g.Edit&&(b.state.mode=d.g.Saving,b.state.savingAttachmentId=b.state.attachmentId),f=c.previewPaneStore,v=o,g=f.state&&f.readingPaneDisplay?f.readingPaneDisplay:d.k.Initial,u=v||g,h=function(e,t,n){if(!n)return!1;switch(t){case d.h.MailList:return!0;case d.h.ReadingPane:return!e.state;case d.h.FilesHub:case d.h.PhotoHub:return!1;case d.h.GroupFilesHub:return!e.state;case d.h.ConversationAttachmentWell:return!0;case d.h.Deeplink:return!1;default:return Object(r.a)(t)}}(c.previewPaneStore,t,n),s(l),Object(U.a)(u),h&&m.n.importAndExecute(n.Id),[2])}var f,v,g,b})})}));function q(e,t,n,a,i){var o=Object(W.b)(e.model.Name||"")||e.model.ContentType||"",c=new P.c(R.PreviewAttachmentInSxSE2E.datapoint.name,R.PreviewAttachmentInSxSE2E.datapoint.options);return c.addCustomData(R.PreviewAttachmentInSxSE2E.datapoint.customData(Object(z.a)(),function(e){switch(e){case T.b.Unsupported:return"Unsupported";case T.b.Image:return"Image";case T.b.MailItem:return"MailItem";case T.b.CalendarEvent:return"CalendarEvent";case T.b.Wac:return"Wac";case T.b.SuiteExtensions:return"SuiteExtensions";case T.b.Audio:return"Audio";case T.b.Text:return"Text";case T.b.NativeView:return"NativeView";case T.b.GoogleDoc:return"GoogleDoc";case T.b.PdfJs:return"PdfJs";case T.b.ItemAttachment:return"ItemAttachment";case T.b.Video:return"Video";default:return Object(r.a)(e)}}(t),o,e.model.Size,n?"cloudy":"classic",a?"changingFromEdit":"",function(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}(o),i)),c}var Q=n(7),J=n(144),Y=n(2444),Z=n(678),X=n(2987),K=[".odp",".pot",".potm",".potx",".pps",".ppsm",".ppsx",".ppt",".pptm",".pptx"];function $(e,t,n,r,i,c,s,l){return void 0===l&&(l=u.c.Mail),a.__awaiter(this,void 0,void 0,function(){function m(){return a.__awaiter(this,void 0,void 0,function(){var t;return a.__generator(this,function(n){switch(n.label){case 0:return Object(E.b)(S.model)&&S.model.ProviderType===J.a.providers.GDRIVE?[4,function(){return a.__awaiter(this,void 0,void 0,function(){var e,t,n;return a.__generator(this,function(a){switch(a.label){case 0:e=null,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Object(C.a)(S.model)];case 2:return(t=a.sent())?(h(),v.setNativePdfPreviewState(w,t,null,"application/pdf",R),[2]):[3,4];case 3:return n=a.sent(),e=n,[3,4];case 4:throw h(),v.setPreviewError(w,y.a.errorGetWacUrlAttachmentDataProviderError),e||new Error("Unexpected error in handleNativeViewPreviewForGDrive")}})})}()]:[3,2];case 1:return n.sent(),[3,3];case 2:t=Object(j.b)(e.attachmentId,S.model,3,Object(E.b)(S.model),e.isReadOnly),v.setNativePdfPreviewState(w,S.download.url+"&isDocumentPreview=True#toolbar=0",t,"application/pdf",R),n.label=3;case 3:return[2]}})})}function h(){if(!u.z.pendingPreviewOperation||B.id!==u.z.pendingPreviewOperation.id)throw new Error("Preview changed before loading finished")}var p,f,v,g,b,w,I,S,x,V,M,R,N,B,W;return a.__generator(this,function(C){switch(C.label){case 0:return p=new Date,[4,u.x.import()];case 1:return f=C.sent(),_.a.available()?(_.a.run(),[4,k.p.import()]):(f.openSxSInANewWindow(t.Id,e.attachmentId.Id),[2]);case 2:return v=C.sent(),g=f.onPreviewOperationStart,b=f.onPreviewOperationFinished,w=u.z.viewState,[4,J.e.import()];case 3:I=C.sent(),S=I(e.attachmentId),x=e.strategy,V=Object(D.e)(S.model,e.isCloudy,e.isReadOnly)&&Object(F.isStringNullOrWhiteSpace)(S.model.AttachmentOriginalUrl),M=V?u.b.available:u.b.disabled,R={downloadUrl:S.download.url,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:e.attachmentId},N=q(S,x.previewMethod,e.isCloudy,u.z.editState.mode!==u.a.View,r),B={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:e.attachmentId},g(B),C.label=4;case 4:return C.trys.push([4,26,,27]),[4,f.canCloseSxS()];case 5:switch(C.sent()||N.addCustomData({exitEditMode:"notSaved"}),h(),o(c,r,t,s),v.setPreviewLoading(w,"",R),f.showSxS(u.z.shouldShow?null:l,{previewMode:x.previewMethod,attachmentId:e.attachmentId,selectionSource:r,isCloudy:e.isCloudy,saveToCloudStatus:M},{editAllowed:x.allowEdit,itemId:t,isDraft:n}),x.previewMethod){case T.b.Image:return[3,6];case T.b.Wac:return[3,8];case T.b.GoogleDoc:return[3,10];case T.b.NativeView:return[3,11];case T.b.PdfJs:return[3,13];case T.b.Audio:return[3,15];case T.b.Video:return[3,16];case T.b.Text:return[3,17];case T.b.ItemAttachment:return[3,19];case T.b.CalendarEvent:return[3,21]}return[3,23];case 6:return[4,function(){return a.__awaiter(this,void 0,void 0,function(){var t,n;return a.__generator(this,function(a){switch(a.label){case 0:return i?[3,1]:(n=null,[3,3]);case 1:return[4,i()];case 2:n=a.sent(),a.label=3;case 3:return t=n,h(),v.setImagePreviewState(w,S.previewImage.url,t,R),[4,J.g.import()];case 4:return[4,a.sent()(e.attachmentId,e.isReadOnly)];case 5:return a.sent(),h(),v.setImagePreviewState(w,I(e.attachmentId).previewImage.url,t,R),[2]}})})}()];case 7:return C.sent(),[3,24];case 8:return[4,function(){return a.__awaiter(this,void 0,void 0,function(){var t,n,i,o,c;return a.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Object(Y.a)(e.attachmentId,!1,d.h[r])];case 1:return t=a.sent(),S.model.Name&&(n=S.model.Name.lastIndexOf("."))>=0&&(i=S.model.Name.substr(n).toLowerCase(),R.useHighContrastCommandBar=K.indexOf(i)>=0),h(),v.setWacPreviewState(w,t[0],t[4],p.getTime(),t[1],t[2],t[3],S.model.Name,S.model.Size,R),[3,3];case 2:if(o=a.sent(),(c=o)&&c.errorMessage)throw Q.c.warn("Something went wrong while getting the attachment state: "+c),v.setPreviewError(w,c.errorMessage),c.error;throw o;case 3:return[2]}})})}()];case 9:return C.sent(),[3,24];case 10:return v.setIframePreviewState(w,S.model.AttachLongPathName,R),[3,24];case 11:return[4,m()];case 12:return C.sent(),[3,24];case 13:return[4,function(){return a.__awaiter(this,void 0,void 0,function(){var t;return a.__generator(this,function(n){switch(n.label){case 0:return S.info.allowDownload?(v.setPdfJsPreviewState(w,S.download.url+"&isDocumentPreview=True",!1,R),[3,3]):[3,1];case 1:return[4,Object(A.a)(e.attachmentId)];case 2:t=n.sent(),h(),v.setPdfJsPreviewStateByData(w,t,!0,R),n.label=3;case 3:return[2]}})})}()];case 14:return C.sent(),[3,24];case 15:return v.setAudioPreviewState(w,S.download.url,R),[3,24];case 16:return v.setVideoPreviewState(w,S.download.url,R),[3,24];case 17:return[4,function(){return a.__awaiter(this,void 0,void 0,function(){var t,n,i;return a.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Object(X.a)(e.attachmentId.Id,e.attachmentId.mailboxInfo&&e.attachmentId.mailboxInfo.requestOptions,d.h[r])];case 1:return t=a.sent(),h(),v.setTextPreviewState(w,t,R),[3,3];case 2:if(n=a.sent(),(i=n)&&i.errorMessage)throw h(),v.setPreviewError(w,i.errorMessage),i.error;throw n;case 3:return[2]}})})}()];case 18:return C.sent(),[3,24];case 19:return[4,function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return[4,L.import()];case 1:return[4,t.sent()(e.attachmentId,null)];case 2:return t.sent(),h(),v.setCustomPreviewState(w,R),[2]}})})}()];case 20:return C.sent(),[3,24];case 21:return[4,function(){return a.__awaiter(this,void 0,void 0,function(){var t,n,r;return a.__generator(this,function(a){switch(a.label){case 0:return t={calendarItem:null,isIcsAttachmentLoading:!0,icsCalendarEventType:Z.a.UNKNOWN,attachmentId:e.attachmentId,addToCalendarStatus:1,errorMessage:null},[4,Z.e.import()];case 1:return n=a.sent(),r=null,[4,n({attachmentId:e.attachmentId,size:S.model.Size,showSizeLimitExceedsError:function(){r=y.a.AddToCalendarSizeLimitExceedsError},errorCallback:function(){r=O.a.ICSFileErrorText},state:t})];case 2:if(a.sent(),h(),r)throw v.setPreviewError(w,r),new Error(r);return f.onShowCustomPreview(t),v.setCustomPreviewState(w,R),[2]}})})}()];case 22:return C.sent(),[3,24];case 23:throw new Error("Unsupported preview method");case 24:return[4,f.waitForPreviewLoadOrThrowError()];case 25:return C.sent(),h(),b(),N.end(),[3,27];case 26:return W=C.sent(),N.endWithError(P.a.ServerError,W),[3,27];case 27:return[2]}})})}var ee=n(136);function te(e){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return e.onBeforePreview&&e.onBeforePreview(),Object(ee.b)("doc-SxS-refactor")?[4,$(e.viewState,e.parentItemId,e.isDraft,e.previewPaneSelectionSource,e.createImageGallery,{method:h.a.CopyMailReadingPaneContainer},e.instrumentationContext)]:[3,2];case 1:return t.sent(),[3,4];case 2:return[4,G(e.viewState,e.previewPaneSelectionSource,e.parentItemId,e.isDraft)];case 3:t.sent(),t.label=4;case 4:return e.onAfterPreview&&e.onAfterPreview(),[2]}})})}var ne=n(1267),ae=n(896),re=n(47),ie=Object(H.action)("clickAttachment",R.ClickAttachment)(function(e,t,n,r,i,o,c,s,l){return void 0===r&&(r=null),void 0===i&&(i=!1),a.__awaiter(this,void 0,void 0,function(){var u,d;return a.__generator(this,function(a){if(u=Object(N.a)(e.attachmentId),!e.strategy)return[2];switch(Object(T.e)(e.strategy)){case T.a.Preview:te({viewState:e,previewPaneSelectionSource:t,parentItemId:r,isDraft:i,onBeforePreview:o,onAfterPreview:c,createImageGallery:s,instrumentationContext:n}),Object(re.l)("PreviewOfAttachmentStarted",[n]);break;case T.a.Download:u.download.url&&Object(ne.a)(u.download.url,e.isCloudy,l);break;case T.a.OpenInNewTab:(d=u).openUrl&&(Object(ae.a)(d.openUrl),Object(re.l)("OpenedAnAttachment",[n]))}return[2]})})}),oe=n(2719);function ce(e,t,n){return a.__awaiter(this,void 0,void 0,function(){var r,i,c,s,l,m,p,f;return a.__generator(this,function(a){switch(a.label){case 0:return _.a.run(),[4,u.t.import()];case 1:return r=a.sent(),[4,u.s.import()];case 2:return i=a.sent(),c=null,n instanceof HTMLElement?[4,oe.b.import()]:[3,4];case 3:return s=a.sent(),c=s(n),[3,5];case 4:c=n,a.label=5;case 5:c||(c=u.z.viewState),l={downloadUrl:e.downloadUrl,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:e.id},m={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:e.id},r(m),a.label=6;case 6:return a.trys.push([6,9,,10]),[4,u.w.import()];case 7:return p=a.sent(),[4,k.h.import()];case 8:if(f=a.sent(),!u.z.pendingPreviewOperation||m.id!==u.z.pendingPreviewOperation.id)throw new Error("Preview changed before loading finished");return o({method:h.a.CopyMailReadingPaneContainer},d.h.ReadingPane,null,null),f(c,e.previewUrl,t,l),p(u.c.Mail,{previewMode:T.b.Image,attachmentId:e.id,selectionSource:d.h.ReadingPane,isCloudy:!1,saveToCloudStatus:u.b.disabled},{editAllowed:!1,itemId:null,isDraft:!1}),i(),[3,10];case 9:return a.sent(),[3,10];case 10:return[2]}})})}var se=Object(H.select)({previewPaneStore:function(){return d.y}})(Object(H.action)("previewImageInSxS")(function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var i,o,c,s;return a.__generator(this,function(l){switch(l.label){case 0:return(i=r.previewPaneStore).state&&Object(B.c)(i.state.attachmentId,e.attachmentId)?[2]:((g=i).state&&g.state.mode===d.g.Edit&&(g.state.mode=d.g.Saving,g.state.savingAttachmentId=g.state.attachmentId),h=i,p={downloadUrl:(m=e).downloadUrl,isDownloadDisabled:!1,name:m.name,size:m.size,attachmentId:m.attachmentId,itemId:null,isDraft:!1,savingAttachmentId:null,mode:d.g.View,editAllowed:!1,saveToCloudStatus:d.l.disabled,addToCalendarStatus:0,isCloudy:!1,type:T.b.Image,errorMessage:null,perfDatapoint:null},f=h.state,v=!(!f||m.previewUrl!==f.previewUrl||!f.imageLoaded),o=a.__assign({},p,{previewUrl:m.previewUrl,imageLoaded:v,isImageLoading:!v}),c=n||((u=i).state&&u.readingPaneDisplay?u.readingPaneDisplay:d.k.Initial),[4,d.w.import()]);case 1:return s=l.sent(),i.previewSelectionSource=t,s(o),Object(U.a)(c),[2]}var u,m,h,p,f,v,g})})}));function le(e,t,n,r,i,c){return void 0===c&&(c=u.c.Mail),a.__awaiter(this,void 0,void 0,function(){function s(){if(!u.z.pendingPreviewOperation||g.id!==u.z.pendingPreviewOperation.id)throw new Error("Preview changed before loading finished")}var l,d,m,h,p,f,v,g,b,w;return a.__generator(this,function(a){switch(a.label){case 0:return _.a.run(),l=e(),[4,k.p.import()];case 1:return d=a.sent(),[4,u.x.import()];case 2:return m=a.sent(),h=m.onPreviewOperationStart,p=m.onPreviewOperationFinished,f=u.z.viewState,v={downloadUrl:null,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:null},g={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:null},h(g),[4,m.canCloseSxS()];case 3:a.sent(),s(),o(r,n,t,i),d.setPreviewLoading(f,"",v),m.showSxS(u.z.shouldShow?null:c,{previewMode:T.b.Wac,attachmentId:null,selectionSource:n,isCloudy:!0,saveToCloudStatus:u.b.disabled},{editAllowed:!1,itemId:t,isDraft:!1}),a.label=4;case 4:return a.trys.push([4,6,,7]),[4,l];case 5:return b=a.sent(),s(),d.setWacPreviewState(f,b[0],b[1],(new Date).getTime(),"","","","",0,v),[3,7];case 6:return w=a.sent(),d.setPreviewError(f,w.message||w),[3,7];case 7:return s(),p(),[2]}})})}n.d(t,"clickAttachment",function(){return ie}),n.d(t,"previewAttachment",function(){return te}),n.d(t,"previewAttachmentInNewSxS",function(){return $}),n.d(t,"previewAttachmentInSxS",function(){return G}),n.d(t,"previewImageInNewSxS",function(){return ce}),n.d(t,"previewImageInSxS",function(){return se}),n.d(t,"previewLinkInNewSxS",function(){return le}),n.d(t,"downloadAttachment",function(){return ne.a})},1836:function(e,t,n){"use strict";n.r(t);var a,r,i=n(0),o=n(1243),c=n(14),s=n(1826),l=n(595),u=n(191),d=n(18),m=n(1),h=n(4877),p=n(90).bind(h),f=n(4879);(r=a||(a={}))[r.extraSmall=0]="extraSmall",r[r.small=1]="small";var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.render=function(){var e=Object(l.a)(this.props.attachmentId),t=Object(u.a)(e.model.Name),n=1===e.type,a=null,r=!1,i=!1,c=0===this.props.iconSize;if(n){var v=e.model;if(r=v.AttachmentIsFolder,1===this.props.iconSize)a=Object(o.a)(t,e.model.ContentType,1===e.attachmentClass,r,i).smallFileIcon;else if(this.props.useCloudIcon)return"OneDriveConsumer"===v.ProviderType||"OneDrivePro"===v.ProviderType?m.createElement(s.a,{iconName:"OneDrive",className:p(h.icon,h.iconDefault,h.oneDriveIcon)}):m.createElement(s.a,{iconName:"Cloud",className:p(h.icon,h.iconDefault,h.cloudIcon)})}else 2===e.type&&(i=!0);return a||(a=c?Object(o.a)(t,e.model.ContentType,1===e.attachmentClass,r,i).extraSmallFileIcon:f[Object(o.a)(t,e.model.ContentType,1===e.attachmentClass,r,i).classicFileIcon]),m.createElement("div",{className:p(c?h.extraSmallIcon:h.icon,Object(d.isStringNullOrWhiteSpace)(this.props.className)?h.iconDefault:this.props.className,a)})},t=i.__decorate([c.observer],t)}(m.Component),g=n(2773),b=n(4881),w=n(90).bind(b),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.render=function(){var e=Object(g.a)(this.props.attachmentViewState,this.props.attachment);if(this.props.isShortDocView)return m.createElement("div",{className:w(b.firstLineCommonStyle,this.props.firstLineStyle,b.textOverFlow),title:e},this.props.attachment.model.Name);var t=Object(g.b)(this.props.attachmentViewState,this.props.attachment);return m.createElement(m.Fragment,null,m.createElement("div",{className:w(b.firstLineCommonStyle,this.props.firstLineStyle,b.textOverFlow),title:e},this.props.attachment.model.Name),m.createElement("div",{title:t.title?t.title:e,className:w(b.secondLineCommonStyle,this.props.secondLineStyle,b.textOverFlow)},t.text))},t=i.__decorate([c.observer],t)}(m.Component),S=n(1823),O=n(1587),A=n(4),C=Object(A.action)("setThumbnailLoadState")(function(e,t){e.thumbnailLoadState=t}),x=n(2396),y=n(136),_=n(7),T=[],P=5,j=0,D=5e3,k=null,E=0,F=0;function V(){return Object(y.b)("doc-attachment-throttleThumbnails")}function M(){(E++,0===T.length)?(j>0&&j--,R("Queue is empty.")):(T.shift()(!1),R("Display next."))}function L(){T.length>0?E===F?(j=0,R("Watch dog is processing the queue."),M()):(R("Watch dog is watching."),F=E):(window.clearInterval(k),k=null,R("Stop watch dog."))}function R(e){_.c.info("Attachment:throttleThumbnails:active="+j+";throttled="+T.length+";processed="+E+";lastProcessed="+F+";info="+e)}var N=n(90),B=n(4883),W=function(e){function t(t){var n=e.call(this,t)||this;return n.tryRefreshThumbnailImageUrl=function(){return i.__awaiter(n,void 0,void 0,function(){var e,t,n,a;return i.__generator(this,function(r){switch(r.label){case 0:return e=this.props.attachmentViewState,t=e.attachmentId,n=e.isReadOnly,e.isPlaceholderAttachment?[3,2]:[4,Object(x.a)(t,n)];case 1:r.sent(),a=Object(l.a)(t).thumbnailImage.url,this.setState(i.__assign({},this.state,{thumbnailUrl:a})),r.label=2;case 2:return[2]}})})},n.handleImageError=function(e){n.state.isThrottled||(V()&&M(),C(n.props.attachmentViewState,2),n.props.onImageLoadError&&n.props.onImageLoadError())},n.onImageLoad=function(e){n.state.isThrottled||(V()&&M(),C(n.props.attachmentViewState,1))},n.setIsThrottledState=function(e){n.setState(i.__assign({},n.state,{isThrottled:e}))},n.state={thumbnailUrl:n.props.thumbnailUrl,isThrottled:V()},n.state.thumbnailUrl||n.tryRefreshThumbnailImageUrl(),n}return i.__extends(t,e),t.prototype.shouldComponentUpdate=function(e,t){return this.props.attachmentViewState.thumbnailLoadState!==e.attachmentViewState.thumbnailLoadState||(this.props.thumbnailWidth!==e.thumbnailWidth||this.props.thumbnailHeight!==e.thumbnailHeight||(!!(!this.props.thumbnailUrl&&e.thumbnailUrl||!this.state.thumbnailUrl&&t.thumbnailUrl)||this.state.isThrottled!==t.isThrottled))},t.prototype.componentWillReceiveProps=function(e){this.props.thumbnailUrl!==e.thumbnailUrl&&this.setState(i.__assign({},this.state,{thumbnailUrl:e.thumbnailUrl}))},t.prototype.componentDidMount=function(){V()&&function(e){if(null==e)throw new Error("A null callback is registered to Throttle Thumbnails queue.");j<P?(e(!1),j++,E++,R("Display now.")):(e(!0),T.push(e),R("Pushs to queue."),k||(k=window.setInterval(L,D),R("Start watch dog.")))}(this.setIsThrottledState)},t.prototype.componentWillUnmount=function(){var e,t;this.state.isThrottled&&V()&&(e=this.setIsThrottledState,t=T.indexOf(e),T.splice(t,1),j=0,R("unregisterComponent:"+t))},t.prototype.render=function(){var e=this.props.attachmentViewState.thumbnailLoadState,t=this.props.imageLoadErrorCSSClass?this.props.imageLoadErrorCSSClass:this.props.placeHolderCSSClass,n=this.props.fileIconCssClass?this.props.imageLoadErrorCSSClass:this.props.placeHolderCSSClass;return m.createElement("span",{className:B.spanContainer},(this.state.isThrottled||0===e)&&m.createElement("div",{className:B.notLoadedContainer,style:{height:this.props.thumbnailHeight,width:this.props.thumbnailWidth}},m.createElement("span",{className:n})),2===e&&m.createElement("div",{className:B.errorLoadingContainer,style:{height:this.props.thumbnailHeight,width:this.props.thumbnailWidth}},m.createElement("span",{className:t})),2!==e&&m.createElement(S.a,{src:this.state.isThrottled?"":this.state.thumbnailUrl,onError:this.handleImageError,onLoad:this.onImageLoad,width:this.props.thumbnailWidth,height:this.props.thumbnailHeight,className:this.props.customThumbnailCssClass?this.props.customThumbnailCssClass:B.thumbnail,imageFit:this.props.fileIconCssClass?O.b.contain:O.b.cover}),1===e&&this.props.fileIconCssClass&&m.createElement("span",{style:this.props.customFileIconCssClass?null:{position:"absolute",top:5-this.props.thumbnailHeight,left:5},className:N(this.props.fileIconCssClass,this.props.customFileIconCssClass)}))},t=i.__decorate([c.observer],t)}(m.Component);n.d(t,"AttachmentIconView",function(){return v}),n.d(t,"AttachmentDocInfoView",function(){return I}),n.d(t,"AttachmentThumbnailView",function(){return W})},2093:function(e,t,n){"use strict";var a=n(150),r=n(0),i=n(3),o=n(1229),c=n(2791),s={},l=function(){function e(e,t,n){var a=this;this.estimatedTimeToCompleteInMS=e,this.updateIntervalInPercent=t,this.updatePropertyHandler=n,this.start=function(){a.currentTimePercent+=a.updateIntervalInPercent;var e=a.getActionCompletePercent();e<=a.maxPercent?(a.updatePropertyHandler(e),a.nextUpdateTimer=setTimeout(a.start,a.estimatedTimeToCompleteInMS*a.updateIntervalInPercent)):a.nextUpdateTimer=null},this.currentTimePercent=0,this.maxPercent=1-this.updateIntervalInPercent,this.updatePropertyHandler=this.updatePropertyHandler.bind(this)}return e.prototype.complete=function(){var e=this;this.clearUpdateTimer(),this.updatePropertyHandler(1),setTimeout(function(){return e.updatePropertyHandler(1.1)},500)},e.prototype.abort=function(){this.clearUpdateTimer(),this.updatePropertyHandler(0)},e.prototype.clearUpdateTimer=function(){this.nextUpdateTimer&&(clearTimeout(this.nextUpdateTimer),this.nextUpdateTimer=null)},e.prototype.getActionCompletePercent=function(){return Math.sqrt(2*this.currentTimePercent-this.currentTimePercent*this.currentTimePercent)},e}();function u(e,t){var n=s[e.Id];n&&(t?n.complete():n.abort(),delete s[e.Id])}function d(e,t,n,a){var r=new l(e,t,n);s[a.Id]=r,r.start()}var m=n(1265),h=n(2948);Object(i.orchestrator)(c.a,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n;return r.__generator(this,function(a){switch(a.label){case 0:return d=e.attachment,Object(o.a)(d,7,13),[4,Object(h.a)(e.attachment.attachmentId.Id,null,null)];case 1:return t=a.sent(),n=t&&"Success"===t.ResponseClass?14:15,r=e.attachment.attachmentId,i=n,c=e.attachment,s=0,l=7,u(r,!0),Object(m.a)(c,l),Object(o.a)(c,s,i),[2]}var r,i,c,s,l,d})})});var p=n(2926),f=n(2554),v=n(3356),g=n.n(v),b=n(3784),w=n.n(b);function I(e,t,n,a,r){var i,o,c,s,l,u=(i=e,o=t,c=n,s=a,l=r,g()({ewsAttachmentId:{RootItemChangeKey:o.ChangeKey,RootItemId:o.Id,Id:i},itemId:i,subscriptionId:c,channelId:s,cancellationId:l}));return w()({requestObject:u})}var S=n(9),O=n(595),A=n(2645),C=n(279),x=n(4),y={},_=Object(x.action)("convertClassicToCloudy")(function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var a,i,c;return r.__generator(this,function(s){switch(s.label){case 0:return a=new S.c(f.a.AttachmentConvertClassicToCloudy.datapoint.name),l=e,Object(o.a)(l,5,8),i=function(t){if(T(e,t.ResultCode),P(a,e.attachmentId,t.ResultCode,t.Exception),0===t.ResultCode&&t.Response&&t.Response.ResponseMessages&&t.Response.ResponseMessages.Items&&t.Response.ResponseMessages.Items.length>0&&"NoError"===t.Response.ResponseMessages.Items[0].ResponseCode){var r=t.Response.ResponseMessages.Items[0];n(!0,r.Attachments[0])}else n(!1,null);return!0},c=function(t){T(e,1),n(!1,null),P(a,e.attachmentId,1,t)},[4,function(e,t,n,a){return r.__awaiter(this,void 0,void 0,function(){var i,o,c,s,l,u;return r.__generator(this,function(r){switch(r.label){case 0:return[4,Object(A.a)(n)];case 1:i=r.sent(),o=i[0],c=i[1],s=i[2],l=i[3],y[e.Id]=o,r.label=2;case 2:return r.trys.push([2,4,,5]),[4,I(e.Id,t,o,l,o)];case 3:return r.sent(),[3,5];case 4:return u=r.sent(),a(u.message),C.g.importAndExecute(c,s),[3,5];case 5:return[2]}})})}(e.attachmentId,t,i,c)];case 1:return s.sent(),[2]}var l})})});function T(e,t){switch(t){case 0:break;case 11:Object(o.a)(e,0,0);break;default:Object(o.a)(e,0,9)}delete y[e.attachmentId.Id]}function P(e,t,n,a){var r=Object(O.a)(t);e.addCustomData(f.a.AttachmentConvertClassicToCloudy.datapoint.customData(r.model.Size,n)),0===n||11===n?e.end():e.endWithError(S.a.ServerError,new Error(a))}var j=n(3357),D=n.n(j),k=n(3785),E=n.n(k);function F(e){var t,n=(t=e,D()({cancellationId:t}));return E()(n)}var V=Object(x.action)("cancelConvertClassicToCloudy",f.a.CancelConvertClassicToCloudy)(function(e){var t,n=(t=e.attachmentId.Id,y[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertClassicToCloudy");Object(o.a)(e,5,10),F(n)}),M=n(1279),L=Object(x.action)("updateIsViewingInProviderSupported")(function(e,t){e.strategy.isViewingInProviderSupported=t}),R=n(2620),N=n(2792),B=Object(x.action)("saveToCloud")(function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,i;return r.__generator(this,function(r){switch(r.label){case 0:return n=new S.c(f.a.AttachmentSaveToCloud.datapoint.name),U(e),a=function(a){var r=0===a.ResultCode;return z(e,r,r?a.Item.Location:null),t(r),W(n,e.attachmentId,a.ResultCode,S.a.ServerError,a.Exception),!0},i=function(a,r,i){z(e,!1,null),t(!1),W(n,e.attachmentId,r,i,a)},[4,Object(R.b)(e.attachmentId,null,a,i)];case 1:return r.sent(),[2]}})})});function W(e,t,n,a,r){var i=Object(O.a)(t);e.addCustomData(f.a.AttachmentSaveToCloud.datapoint.customData(i.model.Size,n)),0===n?e.end():e.endWithError(a,new Error(r))}function U(e){Object(o.a)(e,2,1)}function z(e,t,n){if(t){Object(m.a)(e,2),Object(N.a)(e.attachmentId,n);var a=Object(M.b)(!1,null,n);L(e,a)}Object(o.a)(e,0,t?3:4)}var H=Object(x.action)("setActionCompletePercent")(function(e,t){e.actionCompletePercent=t}),G=n(2646),q=(n(984),n(1254)),Q=n(1278);function J(e){return 1===e.attachmentType}var Y=n(149),Z=n(2619),X=n(3355),K=n(2788),$=n(617),ee=Object(x.action)("updateAttachment")(function(e,t,n,a,i){Object(X.a)(e.attachmentId);var o=r.__assign({},a.AttachmentId,{mailboxInfo:t.mailboxInfo});if(n.AttachmentId=o,a.Name&&(n.Name=a.Name),a.Size&&(n.Size=a.Size),a.ContentType&&(n.ContentType=a.ContentType),a.__type&&(n.__type=a.__type),n.IsInline&&(n.ContentId=a.ContentId),Object($.b)(a)){var c=n;c.AttachLongPathName=a.AttachLongPathName,c.PermissionType=a.PermissionType,c.ProviderType=a.ProviderType,c.AttachmentThumbnailUrl=a.AttachmentThumbnailUrl,c.AttachmentPreviewUrl=a.AttachmentPreviewUrl}if(Object(Z.a)([{attachmentId:o,attachment:n,permissionInfo:i}],!1),e.attachmentId=o,J(e))Object(G.a)(e,1);else{Object(Y.g)(e,!1),setTimeout(function(){H(e,1.1)},500),Object(Q.a)(e,0);var s=Object(O.a)(o);Object(q.a)(e,s,e.strategy.supportedMenuActions),s.download.url||Object(K.a)(o,e.isReadOnly,!1,!0)}}),te=n(3359),ne=n.n(te),ae=n(3786),re=n.n(ae);function ie(e,t,n,a,r,i,o,c){var s,l,u,d,m,h,p,f,v=(s=e,l=t,u=n,d=a,m=r,h=i,p=o,f=c,ne()({ewsAttachmentId:s,emailId:l,subscriptionId:u,channelId:d,cancellationId:m,fullPathLocation:h,attachmentDataProviderId:f,PermissionLevel:p}));return re()({requestObject:v})}function oe(e){return de(Object(O.a)(e).model.Size)}function ce(e){return 2856+.00145*e}function se(e){return 4*de(e)}function le(e){return 4*de(e)}function ue(e){return 2*de(e)}function de(e){return Math.round(e/256)}var me=n(2782),he=n.n(me),pe={},fe=Object(i.orchestratorAction)("convertCloudyToClassic",function(e,t,n,a,i){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(c){return function(e,t,n,a,i){r.__awaiter(this,void 0,void 0,function(){var c,s,l;return r.__generator(this,function(u){switch(u.label){case 0:return c=new S.c(f.a.AttachmentConvertCloudyToClassic.datapoint.name),d=e,Object(o.a)(d,6,11),s=function(t){if(ve(e,t.ResultCode),ge(c,e.attachmentId,t.ResultCode,t.Exception),0===t.ResultCode){var n=he()({Name:t.Item.Name,Size:t.Item.Size,AttachmentId:t.NewAttachmentId});i(!0,n)}else i(!1,null);return!0},l=function(t){ve(e,1),i(!1,null),ge(c,e.attachmentId,1,t)},[4,function(e,t,n,a,i,o){return r.__awaiter(this,void 0,void 0,function(){var c,s,l,u,d,m;return r.__generator(this,function(r){switch(r.label){case 0:return[4,Object(A.a)(i)];case 1:c=r.sent(),s=c[0],l=c[1],u=c[2],d=c[3],pe[e.Id]=s,r.label=2;case 2:return r.trys.push([2,4,,5]),[4,ie(e.Id,t,s,d,s,n,a)];case 3:return r.sent(),[3,5];case 4:return m=r.sent(),o(m.message),C.g.importAndExecute(l,u),[3,5];case 5:return[2]}})})}(e.attachmentId,t,n,a,s,l)];case 1:return u.sent(),[2]}var d})})}(e,t,n,a,function(t,n){t?i(e,n,!1,!0):u(e.attachmentId,t)}),d(oe(e.attachmentId),.1,function(t){H(e,t)},e.attachmentId),[2]})})});function ve(e,t){switch(t){case 0:break;case 11:Object(o.a)(e,0,0);break;default:Object(o.a)(e,0,12)}delete pe[e.attachmentId.Id]}function ge(e,t,n,a){var r=Object(O.a)(t);e.addCustomData(f.a.AttachmentConvertCloudyToClassic.datapoint.customData(r.model.Size,n)),0===n||11===n?e.end():e.endWithError(S.a.ServerError,new Error(a))}var be=n(3360),we=n.n(be),Ie=n(3787),Se=n.n(Ie);function Oe(e){var t,n=(t=e,we()({cancellationId:t}));return Se()(n)}var Ae=Object(i.action)("cancel_ConvertCloudyToClassic",function(e){return{attachmentViewState:e,datapointConfig:{name:f.a.CancelConvertCloudyToClassic}}}),Ce=Ae;Object(i.orchestrator)(Ae,function(e){var t,n=(t=e.attachmentViewState.attachmentId.Id,pe[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertCloudyToClassic");Object(o.a)(e.attachmentViewState,6,10),Oe(n)});var xe=n(2644);function ye(e,t,n){return void 0===n&&(n=!1),{attachmentType:1,attachmentId:e,isInline:!0,isHiddenInline:n,placeholderId:t,status:0}}function _e(e){return!!e.strategy.isSaveToCloudSupported&&-1===e.completedActions.indexOf(2)}n.d(t,"g",function(){return p.a}),n.d(t,"b",function(){return V}),n.d(t,"d",function(){return _}),n.d(t,"q",function(){return B}),n.d(t,"s",function(){return U}),n.d(t,"r",function(){return z}),n.d(t,"t",function(){return H}),n.d(t,"u",function(){return G.a}),n.d(t,"v",function(){return o.a}),n.d(t,"y",function(){return ee}),n.d(t,"l",function(){return q.b}),n.d(t,"c",function(){return Ce}),n.d(t,"e",function(){return fe}),n.d(t,"w",function(){return d}),n.d(t,"x",function(){return u}),n.d(t,"j",function(){return ce}),n.d(t,"k",function(){return le}),n.d(t,"n",function(){return se}),n.d(t,"i",function(){return ue}),n.d(t,"f",function(){return xe.a}),n.d(t,"h",function(){return ye}),n.d(t,"m",function(){return oe}),n.d(t,"p",function(){return _e}),n.d(t,"o",function(){return J}),n.d(t,"a",function(){return a.a})},2171:function(e,t,n){e.exports=n.p+"../resources/images/attachment_sprite-72f33ea71cce5aef5316acc2c6a4ea50.png"},2234:function(e,t,n){"use strict";t.a={WacEditAndReply:{datapoint:{name:"WacEditAndReply",customData:function(e,t){return[e,t]}}},WacEdit:{datapoint:{name:"WacEdit",customData:function(e,t){return[e,t]}}},SetImageFromGalleryItem:{datapoint:{name:"SetImageFromGalleryItem",customData:function(e,t,n){return[e,t,n]}}},SxSSaveToCloud:{datapoint:{name:"SxSSaveToCloud",customData:function(e,t,n){return{size:e,result:t,actionSource:n}}}},SxSOpen:{datapoint:{name:"SxSOpen",customData:function(e,t){return{module:e,actionSource:t}}}},SxSClose:{datapoint:{name:"SxSClose",customData:function(e,t){return{module:e,closingSource:t}}}},SxSShowHideEmail:{datapoint:{name:"SxSShowHideEmail",customData:function(e,t){return{isShowEmail:e,module:t}}}},SxSImagePreviewLoadTime:{datapoint:{name:"SxSImagePreviewLoadTime"}},SxSPrint:{datapoint:{name:"SxSPrint",customData:function(e,t){return{doctype:e,module:t}}}}}},2254:function(e,t,n){"use strict";t.a={Download:{datapoint:{name:"AttachmentContextMenuItemDownload",customData:function(e,t,n){return[e,t,n]}}},ChangePermission:{datapoint:{name:"AttachmentContextMenuItemChangePermission",customData:function(e){return[e]}}},CopyLink:{datapoint:{name:"AttachmentContextMenuItemCopyLink",customData:function(e){return[e]}}},OpenInNewTab:{datapoint:{name:"AttachmentContextMenuItemOpenInNewTab",customData:function(e){return[e]}}},Preview:{datapoint:{name:"AttachmentContextMenuItemPreview",customData:function(e,t,n){return[e,t,n]}}},SaveToCloud:{datapoint:{name:"AttachmentContextMenuItemSaveToCloud",customData:function(e,t){return[e,t]}}},ViewInProvider:{datapoint:{name:"AttachmentContextMenuItemViewInProvider",customData:function(e){return[e]}}},OnClick:{datapoint:{name:"AttachmentOnClick",customData:function(e){return[e]}}},AddToCalendar:{datapoint:{name:"AttachmentContextMenuItemAddToCalendar",customData:function(e,t){return[e,t]}}},RefreshLink:{datapoint:{name:"AttachmentContextMenuItemRefreshLink"}},IgnoreLinkExpiration:{datapoint:{name:"AttachmentContextMenuItemIgnoreExpiration"}}}},2272:function(e,t,n){"use strict";var a=n(2394),r=n(2395);function i(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}function o(e){return e.filter(function(e){return(t=e).sharingInfo&&t.sharingInfo.getSharingInfoSucceeded&&!t.sharingInfo.canShareInternally&&!i(t.currentPermissionLevel);var t})}function c(e){return e.filter(function(e){return(t=e).sharingInfo&&!t.sharingInfo.getSharingInfoSucceeded;var t})}function s(e){return e&&1!==e.ResultCode&&24!==e.ResultCode}var l=n(0),u=n(81),d="ows/api/beta/sharinglink/info";var m,h,p,f=n(82),v=n(136),g=n(337),b=n(2441),w=n.n(b),I=n(2638),S=n.n(I),O=n(2639),A=n.n(O),C=n(7);function x(e){return Object(v.b)("doc-attachment-sharingLinkInfoOWSPrimeService")?function(e){return l.__awaiter(this,void 0,void 0,function(){var t,n,a,r,i,o,c,s;return l.__generator(this,function(p){switch(p.label){case 0:return[4,function(e,t){return void 0===t&&(t=!1),l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(n){switch(n.label){case 0:return[4,Object(u.e)(d,{url:e},void 0,t)];case 1:return[2,n.sent()]}})})}(e,!0)];case 1:return t=p.sent(),Object(g.a)(t.status)?(r=(a=JSON).parse,[4,t.text()]):[3,3];case 2:if(n=r.apply(a,[p.sent()]),n.providerType===m.OneDrivePro)return i=n.sharingLinks.filter(function(e){return e.type===h.AnonymousEdit})[0],o=n.sharingLinks.filter(function(e){return e.type===h.AnonymousView})[0],c=n.sharingLinks.filter(function(e){return e.type===h.OrganizationEdit})[0],s=n.sharingLinks.filter(function(e){return e.type===h.OrganizationView})[0],[2,S()({AccessRequestMode:n.accessRequestMode,AnonymousEditLink:i?i.url:void 0,AnonymousViewLink:o?o.url:void 0,CanCreateAnonymousEditLink:n.canCreateAnonymousEditLink,CanCreateAnonymousViewLink:n.canCreateAnonymousViewLink,CanCreateOrganizationEditLink:n.canCreateOrganizationEditLink,CanCreateOrganizationViewLink:n.canCreateOrganizationViewLink,CanShareExternally:n.canShareExternally,CanShareInternally:n.canShareInternally,CanonicalUrl:n.canonicalUrl,ExpirationDate:n.expirationTime,FileName:n.name,IsAnonymousEditLinkAvailable:!!i,IsAnonymousViewLinkAvailable:!!o,IsOrganizationEditLinkAvailable:!!c,IsOrganizationViewLinkAvailable:!!s,MimeType:void 0,OrganizationEditLink:c?c.url:void 0,OrganizationViewLink:s?s.url:void 0,ResultCode:0,SharingLinkKind:function(e){switch(e){case h.None:return 0;case h.View:case h.Edit:return 1;case h.AnonymousView:return 4;case h.AnonymousEdit:return 5;case h.OrganizationView:return 2;case h.OrganizationEdit:return 3;default:return Object(f.a)(e)}}(n.linkType)})];throw new Error("Invalid response from OWS` from sharing link info");case 3:return 404===t.status?[2,S()({ResultCode:4})]:400===t.status?[2,S()({ResultCode:24})]:(C.c.warn("Invalid response for OWS' get share info. Status code: "+t.status),[2,S()({ResultCode:1})]);case 4:return[2]}})})}(e):A()((t=e,w()({attachmentUrl:t})));var t}(m||(m={})).OneDrivePro="OneDrivePro",(p=h||(h={})).None="None",p.View="View",p.Edit="Edit",p.AnonymousView="AnonymousView",p.AnonymousEdit="AnonymousEdit",p.OrganizationView="OrganizationView",p.OrganizationEdit="OrganizationEdit",n.d(t,"a",function(){return a.a}),n.d(t,"b",function(){return r.a}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return c}),n.d(t,"e",function(){return x}),n.d(t,"f",function(){return i}),n.d(t,"g",function(){return s})},2278:function(e,t,n){"use strict";var a=n(0),r=n(1252),i=n(2636),o=n(82);var c=Object(r.a)(function(e){switch(e){case 0:return a.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportedPermissionLevels:[2,1],requiresFetchingSharingInformation:!0});case 1:return a.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportImageThumbnail:!0,supportPreview:function(e,t){return t},supportedPermissionLevels:[2,1]});case 3:return a.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportDownload:!1,supportPreview:function(e,t){return!1}});case 2:return a.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportPreview:function(e,t){return!1}});case 6:return{supportDownload:!1,supportImageThumbnail:!0,supportPreview:function(e,t){return!1},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};case 5:return a.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportDownload:!1,supportImageThumbnail:!1,supportPreview:function(e){return Object(i.a)(e)},supportedPermissionLevels:[4,3]});case 7:case 8:case 9:return a.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportDownload:!1,supportPreview:function(e,t){return!1}});case 4:case 10:return{supportDownload:!1,supportImageThumbnail:!1,supportPreview:function(e,t){return!1},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};default:return Object(o.a)(e)}}),s=c.getDataProviderInfo;c.getDefaultDataProviderInfo;t.a=s},2279:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(0),r=n(2095),i=n(2393);function o(e){return a.__awaiter(this,void 0,void 0,function(){var t,n;return a.__generator(this,function(a){switch(a.label){case 0:return t=Object(i.a)(e.AttachLongPathName),[4,Object(r.h)(t)];case 1:return[2,(n=a.sent()).result&&n.result.thumbnailLink||null]}})})}},2302:function(e,t,n){"use strict";var a=n(2398),r=n(2234),i=n(278),o=n(256),c=n(379),s=n(9),l=n(4);t.a=Object(l.select)({previewPaneStore:function(){return o.a}})(Object(l.action)("setReadingPaneDisplay")(function(e,t,n){if(n.previewPaneStore.readingPaneDisplay=e,Object(a.a)(),t){var o=r.a.SxSShowHideEmail.datapoint,l=o.name,u=o.customData;Object(s.n)(l,u(e===i.a.Show,Object(c.a)()))}}))},2393:function(e,t,n){"use strict";function a(e){var t=e.indexOf("/d/");return e.substring(t+3,e.indexOf("/",t+3))}n.d(t,"a",function(){return a})},2394:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var a=n(513);function r(e){return e.filter(function(e){return i(e)})}function i(e){return e&&e.sharingInfo&&!!e.sharingInfo.expirationDate&&!e.sharingInfo.ignoreExpirationDate&&new Date(e.sharingInfo.expirationDate)<Object(a.v)()}},2395:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var a=n(513);function r(e){return e.filter(function(e){return i(e)})}function i(e){return e&&e.sharingInfo&&!!e.sharingInfo.expirationDate&&!e.sharingInfo.ignoreExpirationDate&&new Date(e.sharingInfo.expirationDate)<Object(a.a)(Object(a.v)(),7)&&new Date(e.sharingInfo.expirationDate)>Object(a.v)()}},2396:function(e,t,n){"use strict";var a=n(0),r=n(595),i=n(276),o=n(2279),c=n(617),s=n(657),l=n(8),u=n(4);t.a=Object(u.action)("refreshThumbnailImageUrl")(function(e,t,n,u){return void 0===n&&(n=!1),void 0===u&&(u=Object(l.c)("doc-consumerUrl")),a.__awaiter(this,void 0,void 0,function(){var l,d;return a.__generator(this,function(a){switch(a.label){case 0:if(l=Object(r.a)(e),!Object(c.b)(l.model))return[3,7];switch(l.model.ProviderType){case i.f:return[3,1]}return[3,5];case 1:return a.trys.push([1,3,,4]),[4,Object(o.a)(l.model)];case 2:return d=a.sent(),l.thumbnailImage.url=d,[3,4];case 3:return a.sent(),l.thumbnailImage.url=null,[3,4];case 4:case 5:return[3,6];case 6:return[3,8];case 7:d=Object(s.b)(e,l.model,2,Object(c.b)(l.model),t,n,u),l.thumbnailImage.url=d,a.label=8;case 8:return[2]}})})})},2397:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(2243),r=n.n(a),i=n(985),o=n.n(i);function c(e,t,n,a,i){if(i){var c="getWacAttachmentInfo"+i,s=new Headers;s.set("X-OWA-ActionName",c);var l={headers:s};a=a?o()(a,l):l}return r()({attachmentId:e,isEdit:t,draftId:n,appId:null},a)}},2398:function(e,t,n){"use strict";var a=n(2399),r=n(278),i=n(256),o=n(34),c=n(4);t.a=Object(c.select)({previewPaneStore:function(){return i.a},documentWidth:function(){return Math.max(document.documentElement.clientWidth,o.e)}})(Object(c.action)("updateReadingPaneSize")(function(e){var t=e.previewPaneStore.readingPaneSize&&e.previewPaneStore.readingPaneDisplay!==r.a.Initial?e.previewPaneStore.readingPaneSize/100:o.i/100;e.previewPaneStore.readingPaneDisplay===r.a.Initial&&(e.previewPaneStore.readingPaneDisplay=r.a.Default),Object(a.a)(e.documentWidth*(1-t),e.documentWidth*t,{previewPaneStore:e.previewPaneStore})}))},2399:function(e,t,n){"use strict";var a=n(278),r=n(256),i=n(82),o=n(4),c=n(34);t.a=Object(o.select)({previewPaneStore:function(){return r.a}})(Object(o.action)("setReadingPaneSize")(function(e,t,n){if(n.previewPaneStore.state){var r=e+t,o=c.f+c.j;switch(n.previewPaneStore.haveSpaceForReadingPane=r>=o,n.previewPaneStore.readingPaneDisplay===a.a.Initial&&(n.previewPaneStore.readingPaneDisplay=a.a.Default),n.previewPaneStore.readingPaneDisplay){case a.a.Default:n.previewPaneStore.haveSpaceForReadingPane?u():l();break;case a.a.AlwaysHide:case a.a.Hide:l();break;case a.a.Show:if(e>c.c&&Math.round(t)<c.d){var s=e-c.c;e-=s,t+=s}u();break;default:Object(i.a)(n.previewPaneStore.readingPaneDisplay)}}function l(){n.previewPaneStore.hideReadingPane=!0,n.previewPaneStore.readingPaneSize=0,n.previewPaneStore.previewPaneSizePixels=r,n.previewPaneStore.readingPaneSizePixels=0}function u(){n.previewPaneStore.hideReadingPane=!1;var a=100*t/(t+e);n.previewPaneStore.readingPaneSize=a,n.previewPaneStore.previewPaneSizePixels=e,n.previewPaneStore.readingPaneSizePixels=t}}))},2400:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(11),r=n.n(a);function i(e){switch(e){case 2:return r.a.errorGetWacUrlNotFoundOrNoPermission;case 3:return r.a.errorGetWacUrlProtectedByUnsupportedIrm;case 5:return r.a.errorGetWacUrlInvalidRequest;case 6:return r.a.errorGetWacUrlAttachmentDataProviderError;case 7:return r.a.errorGetWacUrlUploadFailed;case 4:return r.a.errorGetWacUrlUnsupportedObjectType;case 10:return r.a.errorGetWacUrlEditIrmAttachmentNotSupported;case 11:return r.a.errorGetWacUrlEditMacAttachmentNotSupported;default:return r.a.errorGetWacUrl}}},2441:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"GetSharingInfoRequest:#Exchange"},e)}},2442:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(276),r=n(2278),i=n(599),o=n(191);function c(e){if(!Object(i.c)(e,!0).directFileAccessEnabled)return!1;if(e.Thumbnail)return!0;var t=Object(o.c)(e.Name),n=Object(o.d)(e.Name);if((e.__type===a.e||e.__type===a.h)&&(t||n))return!0;if(e.__type===a.m){var c=e,s=Object(r.a)(c.ProviderType);if(c.AttachmentThumbnailUrl||t&&s&&s.supportImageThumbnail)return!0}return!1}},2443:function(e,t,n){"use strict";var a=n(0),r=n(2397),i=n(4),o=n(9),c=n(2190),s={},l={};t.a=Object(i.action)("initializeWacUrl")(function(e,t,n){return a.__awaiter(this,void 0,void 0,function(){var i,u,d,m,h;return a.__generator(this,function(a){switch(a.label){case 0:if(i=new o.c("InitializeWacUrl"),n&&i.addCustomProperty("actionSource",n),d=(u=t?l:s)[e.Id]){if(d.expireTime>=(new Date).getTime())return i.addCustomProperty("ReturnFromCache",!0),i.end(),[2,d.value];delete u[e.Id]}i.addCustomProperty("ReturnFromCache",!1),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Object(r.a)(e.Id,t,null,e.mailboxInfo&&e.mailboxInfo.requestOptions,n)];case 2:return 0===(m=a.sent()).Status&&(u[e.Id]={expireTime:(new Date).getTime()+36e5,value:m}),m.WacUrl||i.addCustomProperty("WacUrlIsEmpty",!0),i.addCustomProperty("WacAttachmentResponseStatus",m.Status.toString()),i.end(),[3,4];case 3:throw h=a.sent(),Object(c.a)(h)&&Object(c.c)(i,h.response),Object(c.d)(i,h.toString()),i.endWithError(o.a.ServerError),h;case 4:return[2,m]}})})})},2444:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(0),r=n(2400),i=n(2443),o=n(11),c=n.n(o);function s(e,t,n){return a.__awaiter(this,void 0,void 0,function(){var o,s;return a.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Object(i.a)(e,t,n)];case 1:return o=a.sent(),[3,3];case 2:throw s=a.sent(),{errorMessage:c.a.errorGetWacUrl,error:s};case 3:if(0===o.Status)return[2,[o.WacUrl,o.BootScriptUrl,o.WopiSrcUrl,o.AccessToken,o.Token]];throw{errorMessage:Object(r.a)(o.Status),error:new Error("GetWacAttachmentInfo failed with status: "+o.Status)}}})})}},2478:function(e,t,n){"use strict";var a=n(3),r=Object(a.action)("ADD_SHAREPOINT_LINK",function(e,t,n){return{linkId:e,sharingLinkIds:t,response:n}}),i=Object(a.action)("REMOVE_SHARING_LINK",function(e,t){return{linkId:e,sharingLinkIds:t}});function o(e){switch(e){case 5:return 4;case 4:return 3;case 3:return 6;case 2:return 5;default:return 0}}var c={sharingLinks:new(n(21).a)({})},s=Object(a.createStore)("sharingLinkStore",c);function l(){return s().sharingLinks.size}function u(e){return s().sharingLinks.get(e)}function d(e){var t=u(e);return{id:t.linkId,name:t.fileName,supportsDownsell:!1,currentPermissionLevel:t.permissionLevel,sharingInfo:t.sharingInfo}}Object(a.mutator)(r,function(e){var t=s(),n=function(e,t){if(!t||0!==t.ResultCode)return{linkId:e,fileName:null,permissionLevel:0,sharingInfo:{getSharingInfoSucceeded:!1,canShareInternally:!1,canShareExternally:!1,expirationDate:null,ignoreExpirationDate:!1,canRefreshExpiration:!1}};var n=o(t.SharingLinkKind);return{linkId:e,fileName:t.FileName,permissionLevel:n,sharingInfo:{getSharingInfoSucceeded:!0,canShareInternally:t.CanShareInternally,canShareExternally:t.CanShareExternally,expirationDate:t.ExpirationDate,ignoreExpirationDate:!1,canRefreshExpiration:!1}}}(e.linkId,e.response);t.sharingLinks.set(e.linkId,n)}),Object(a.mutator)(i,function(e){s().sharingLinks.delete(e.linkId)}),n.d(t,"a",function(){return r}),n.d(t,"f",function(){return i}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return d}),n.d(t,"e",function(){return u}),n.d(t,"b",function(){return o})},2529:function(e,t,n){"use strict";var a=n(4);t.a=Object(a.action)("setAttachmentShouldShowContextMenu")(function(e,t){e.shouldShowContextMenu=t})},2554:function(e,t,n){"use strict";t.a={AttachmentSaveToCloud:{datapoint:{name:"AttachmentSaveToCloud",customData:function(e,t){return[e,t]}}},AttachmentConvertClassicToCloudy:{datapoint:{name:"AttachmentConvertClassicToCloudy",customData:function(e,t){return[e,t]}}},CancelConvertClassicToCloudy:{datapoint:{name:"CancelConvertClassicToCloudy"}},AttachmentConvertCloudyToClassic:{datapoint:{name:"AttachmentConvertCloudyToClassic",customData:function(e,t){return[e,t]}}},CancelConvertCloudyToClassic:{datapoint:{name:"CancelConvertCloudyToClassic"}},AttachmentAddCalendarEvent:{datapoint:{name:"AttachmentAddCalendarEvent",customData:function(e){return{addToCalendarSource:e}}}}}},2619:function(e,t,n){"use strict";var a=n(2922),r=n(276),i=n(2278),o=n(191),c=[".mp3"];var s=n(136),l=[".eml",".msg"];var u=n(2636),d=["image/jpeg","image/png","image/gif","image/bmp"];function m(e){return Object(o.c)(e.Name)||e.__type!==r.m&&function(e){if(e)return d.indexOf(e.toLowerCase())>=0;return!1}(e.ContentType)}function h(e,t,n){var a,r=e||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""),i=-1!==r.indexOf("MSIE")||-1!==r.indexOf("rv:")&&-1!==r.indexOf("Trident"),o=-1===r.indexOf("Edge")&&-1!==r.indexOf("Chrome"),c=-1!==r.indexOf("Firefox");return o?(a=(a=n)||navigator&&navigator.plugins)&&null!==a.namedItem("Chrome PDF Viewer"):i?function(e){try{return null!==e("AcroPDF.PDF")}catch(e){return!1}}(t||function(e){return new ActiveXObject(e)}):!c||!(Object(s.b)("doc-SxS-pdfJsPreview")&&Object(s.b)("doc-SxS-pdfJsPreviewDefaultInFirefox"))}function p(e){var t=Object(o.a)(e.Name);return t&&".pdf"==t.toLowerCase()&&h()}var f=[".txt",".xml",".log"];var v=[".mp4"],g=[".mov"];var b=[".ics",".ical",".ifb",".icalendar"];var w=n(599),I=n(8);function S(e,t){var n,a,d,h,S,O,A,C,x;t.__type===r.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE?(C=t,n=(x=Object(i.a)(C.ProviderType))&&x.supportPreview(C,Object(I.c)("doc-consumerUrl"))?m(t)?e.directFileAccessEnabled?2:0:Object(u.a)(t)?6:p(t)?e.directFileAccessEnabled?3:0:e.useWac?4:0:0):t.__type===r.a.attachmentTypes.FILE_ATTACHMENT_TYPE?e.level===w.a.Block?n=1:m(t)?n=2:p(t)?n=e.directFileAccessEnabled?3:1:!function(e){if(!Object(s.b)("doc-SxS-pdfJsPreview"))return!1;var t=Object(o.a)(e.Name);return!!t&&".pdf"===t.toLowerCase()}(t)?e.useWac?n=4:(O=t,(A=Object(o.a)(O.Name))&&c.indexOf(A.toLowerCase())>=0?n=5:!function(e){if(!Object(s.b)("doc-SxS-itemAttachment"))return!1;var t=Object(o.a)(e.Name);return!!t&&l.indexOf(t.toLowerCase())>=0}(t)?(h=t,(S=Object(o.a)(h.Name))&&f.indexOf(S.toLowerCase())>=0?n=11:!function(e,t){var n=Object(o.a)(e.Name);if(n){var a=t||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""),r=-1!==a.indexOf("Safari")&&-1===a.indexOf("Chrome");return v.indexOf(n.toLowerCase())>=0||r&&g.indexOf(n.toLowerCase())>=0}return!1}(t)?(a=t,n=(d=Object(o.a)(a.Name))&&-1!==b.indexOf(d.toLowerCase())?13:0):n=12):n=10):n=e.directFileAccessEnabled?7:1:n=t.__type===r.a.attachmentTypes.ITEM_ATTACHMENT_TYPE&&Object(s.b)("doc-SxS-itemAttachment")?8:t.__type===r.a.attachmentTypes.ITEM_ID_ATTACHMENT_TYPE&&Object(s.b)("doc-SxS-itemAttachment")?9:0;return n}var O=n(0),A=n(2279),C=n(657);var x=n(2637),y=n(2787),_=n(617),T=n(2442),P=n(6),j=n(18),D=n(7),k=n(4);function E(e,t,n){var o=Object(_.a)(e),c=Object(w.c)(e.model,!0),l=S(c,e.model);if(e.attachmentClass=l,e.info=Object(a.a)(c,l,e.model,o,o?e.model.ProviderType:null,t),e.info.allowDownload&&(e.download.url=Object(x.a)(e.id,e.model,!0,!0)),o&&(e.openUrl=Object(y.a)(e.model,Object(P.a)()),Object(s.b)("doc-attachment-sharingTips")&&!n)){var u=e.model,d=Object(i.a)(u.ProviderType);d&&d.requiresFetchingSharingInformation&&!Object(j.isStringNullOrWhiteSpace)(u.AttachLongPathName)&&(e.requiresFetchingSharingInformation=!0)}Object(T.a)(e.model)&&function(e,t,n){return O.__awaiter(this,void 0,void 0,function(){var a;return O.__generator(this,function(i){switch(i.label){case 0:return n?(a=t).ProviderType===r.f&&a.AttachLongPathName?[4,Object(A.a)(a)]:[3,2]:[2,Object(C.b)(e,t,2,n,!0)];case 1:return[2,i.sent()];case 2:return[2,a.AttachmentThumbnailUrl||null]}})})}(e.id,e.model,o).then(Object(k.action)("updateAttachmentThumbnailUrl")(function(t){e.thumbnailImage.url=t}),function(e){D.c.warn(e)})}var F=n(489),V=n(1234);t.a=Object(k.action)("addAndInitializeAttachments")(function(e,t,n,a){void 0===n&&(n=!1),void 0===a&&(a=!1);var r=Object(F.a)();n||(e=e.filter(function(e){return!r.attachments.has(e.attachment.AttachmentId.Id)})),e.map(function(e){var n,r,i,o,c=e.attachmentId,s=e.attachment,l=e.permissionInfo,u=e.modelInitializationValues,d=(n=s,1===(r={id:c,type:Object(V.a)(n),download:{url:null},attachmentClass:0,previewImage:{url:null},thumbnailImage:{url:null},info:{allowDownload:!1,supportedPermissionLevels:[],sharingInfo:null},model:n}).type?O.__assign({},r,{type:1,openUrl:null,isFolder:n.AttachmentIsFolder,requiresFetchingSharingInformation:!1}):r);return a||E(d,l,t),i=d,o=(o=u||{})||{},Object.keys(o).forEach(function(e){o[e]&&(i[e]=o[e])}),d}).forEach(function(e){r.attachments.set(e.id.Id,e)})})},2620:function(e,t,n){"use strict";var a=n(0),r=n(3);var i=Object(r.action)("saveAttachmentsToCloud",function(e,t,n,a,r){return void 0===r&&(r=null),{attachmentId:e,itemId:t,notificationHandler:n,serviceCallFailureCallback:a,operationCreatedCallback:r}}),o=n(93),c=n(2953),s=n.n(c),l=n(3358),u=n.n(l);function d(e,t,n,a,r){var i,c,l,d,m,h=r.type===o.a.GroupMailbox?r.mailboxId:null,p=(i=e,c=t,l=n,d=a,m=h,s()({ewsAttachmentId:i,itemId:c,subscriptionId:l,groupSmtpAddress:m,channelId:d}));return u()({requestObject:p},r.requestOptions)}var m=n(2645),h=n(279),p=n(144),f={SaveToCloudProgressManager:{datapoint:{name:"SaveToCloudProgressManager",customData:function(e,t){return{operationId:e,counter:t}}}}},v=n(9),g=n(42),b={},w=5e3,I=12;function S(e,t,n,r,i){var o=new v.c(f.SaveToCloudProgressManager.datapoint.name),c=setInterval(function(){!function(e,t,n,r,i,o,c){a.__awaiter(this,void 0,void 0,function(){var s;return a.__generator(this,function(a){switch(a.label){case 0:return(s=c[e])?(s.counter++,s.counter>o?(O(e,c),s.datapoint.addCustomData(f.SaveToCloudProgressManager.datapoint.customData(e,s.counter)),s.datapoint.endWithError(g.a.Timeout),i&&i(),[2]):[4,p.d.import()]):[2];case 1:return a.sent()(t,n,e,0,function(e){r&&r(e.NotificationPayloads)}),[2]}})})}(n,e,t,r,i,I,b)},w);b[n]={timer:c,counter:0,datapoint:o}}function O(e,t){void 0===t&&(t=null),t||(t=b);var n=t[e];if(n){clearInterval(n.timer);var a=n.datapoint;a.addCustomData(f.SaveToCloudProgressManager.datapoint.customData(e,n.counter)),a.end(),delete t[e]}}Object(r.orchestrator)(i,function(e){return a.__awaiter(void 0,void 0,void 0,function(){var t,n,r,i,o,c,s,l;return a.__generator(this,function(u){switch(u.label){case 0:return t=!0,n=e.attachmentId||e.itemId,r=function(a){if(!a)return!1;if(23===a.ResultCode)return!1;var r=e.notificationHandler(a);return r&&(O(n.Id),t=!1),r},[4,Object(m.a)(r)];case 1:return i=u.sent(),o=i[0],c=i[1],s=i[2],l=i[3],function(e,t,n,r,i,o,c){a.__awaiter(this,void 0,void 0,function(){var s;return a.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,d(e?e.Id:null,t?t.Id:null,n,o,t?t.mailboxInfo:e.mailboxInfo)];case 1:return[2,a.sent()];case 2:return s=a.sent(),c(s,1,v.a.ServerError),h.g.importAndExecute(r,i),[2,null];case 3:return[2]}})})}(e.attachmentId,e.itemId,o,c,s,l,e.serviceCallFailureCallback),t&&S(e.attachmentId,e.itemId,n.Id,function(e){e.forEach(function(e){r(e)})},function(){e.serviceCallFailureCallback("Progress manager timeout. OperationId = "+n,3,v.a.Timeout)}),e.operationCreatedCallback&&e.operationCreatedCallback(n.Id,c,s),[2]}})})});var A=Object(r.action)("cancelSaveAttachmentsToCloud",function(e){return{operationId:e}});Object(r.orchestrator)(A,function(e){return a.__awaiter(void 0,void 0,void 0,function(){return a.__generator(this,function(t){return O(e.operationId),[2]})})});n.d(t,"b",function(){return i}),n.d(t,"a",function(){return A})},2624:function(e,t,n){"use strict";var a=n(11),r=n.n(a);function i(e,t){return{name:r.a.OpenInNewTabText,key:"OpenInNewTab",onClick:function(){window.open(e,"_blank")}}}var o="owa-attachment-remove-on-send-start",c="owa-attachment-remove-on-send-end",s=new RegExp("\x3c!--"+o+"--\x3e.*?\x3c!--"+c+"--\x3e","gim");function l(e){return e?e.replace(s,""):e}n.d(t,"a",function(){return c}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"d",function(){return l})},2636:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation"];function r(e){return!!e.ContentType&&a.indexOf(e.ContentType.toLowerCase())>-1}},2637:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(276),r=n(617),i=n(657),o=n(8);function c(e,t,n,c,s){if(void 0===c&&(c=!1),void 0===s&&(s=Object(o.c)("doc-consumerUrl")),Object(r.b)(t))switch(t.ProviderType){case a.c:return l=t.AttachLongPathName,u=l.lastIndexOf("?"),l.substring(0,u)+"?dl=1"}var l,u;return Object(i.b)(e,t,0,Object(r.b)(t),n,c,s)}},2638:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"GetSharingInfoResponse:#Exchange"},e)}},2639:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),r=n(2441);t.default=function(e,t){return void 0===e||e.__type||(e=r.default(e)),a.makeServiceRequest("GetSharingInformation",e,t)}},2642:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(3),r=Object(a.action)("REFRESH_SHARING_TIPS",function(e,t,n,a){return{attachmentWellViewState:e,parentItemId:t,infoBarAddHandler:n,infoBarRemoveHandler:a}})},2643:function(e,t,n){"use strict";t.a={AddToCalendarServiceResult:{datapoint:{name:"AddToCalendarServiceResult",customData:function(e,t){return{status:e,numberOfEventsImported:t}}}},SaveIcsToCalendarFromMultipleDialog:{datapoint:{name:"SaveIcsToCalendarFromMultipleDialog",customData:function(e){return{status:e}}}},SxSAddToCalendar:{datapoint:{name:"SxSAddToCalendar",customData:function(e,t){return{icsCalendarEventType:e,responseClass:t}}}}}},2644:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(0),r=n(149);function i(e,t,n,i,o,c){void 0===o&&(o=!1),void 0===c&&(c=null);var s=Object(r.c)(e,t,i,o,c),l=s.strategy;return a.__assign({},s,{attachmentType:0,strategy:a.__assign({},l,{isSaveToCloudSupported:!1,isViewingInProviderSupported:!1,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]}),isSelected:!1,shouldShowContextMenu:!1,shouldShowImageOverlay:!1,ongoingAction:n?0:1,completedActions:[],actionMessage:0,actionCompletePercent:n?1.1:.01})}},2645:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(0),r=n(104),i=n(279);function o(e){return a.__awaiter(this,void 0,void 0,function(){var t,n,o,c;return a.__generator(this,function(a){switch(a.label){case 0:return t=Object(r.getGuid)(),n={subscriptionId:t,requiresExplicitSubscribe:!1,subscriptionParameters:null},o=function(t){e(t)&&i.g.importAndExecute(n,o)},[4,i.f.import()];case 1:return a.sent()(n,o),[4,i.b.import()];case 2:return c=a.sent()(),[2,[t,n,o,c]]}})})}},2646:function(e,t,n){"use strict";var a=n(4);t.a=Object(a.action)("setInlineAttachmentStatus")(function(e,t){e.status=t})},2647:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"ReferenceAttachment:#Exchange"},e)}},2658:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),r=n(2659);t.default=function(e,t){return void 0===e||e.__type||(e=r.default(e)),a.makeServiceRequest("GetAttachmentTextPreview",e,t)}},2659:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"GetAttachmentTextPreviewRequest:#Exchange"},e)}},2719:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var a=n(2),r=new a.c(function(){return Promise.all([n.e(20),n.e(25),n.e(205),n.e(40),n.e(111)]).then(n.bind(null,3307))}),i=new a.b(r,function(e){return e.getSxSViewStateFromElement}),o=Object(a.d)(r,function(e){return e.SxSLayerView});Object(a.d)(r,function(e){return e.SxSView})},2773:function(e,t,n){"use strict";function a(e,t){var n,a,r=(n=e,null!=(a=new RegExp("^https?\\:\\/\\/([\\w\\.-]+)(?:\\:[0-9]{1,4})?.*$","i").exec(n))&&a.length>1?a[1].toLowerCase():null);return null!=r?r:t}var r=n(2863),i=n(191),o=n(18),c=n(7);function s(e,t){var n=t.model.Name;if(e.isCloudy){var a=t;if(a.openUrl)n+="\n \n"+a.openUrl;else{var r=t.model;r.AttachLongPathName&&(n+="\n \n"+r.AttachLongPathName)}}return n}function l(e,t){if(e.isCloudy){var n=t.model;if(e.isReadOnly)return{text:a(t.openUrl,n.AttachLongPathName||null),title:null};var s=t.info&&t.info.sharingInfo&&t.info.sharingInfo.expirationDate,l=Object(r.a)(n.PermissionType,n.ProviderType,s,e.isPlaceholderAttachment);return{text:l,title:l}}var u=t.model.Size>0?Object(i.e)(t.model.Size):null;return isNaN(t.model.Size)&&c.c.error(Object(o.format)("Size for Attachment {0} is not a Number.",t.model.AttachmentId)),{text:u,title:u}}n.d(t,"a",function(){return s}),n.d(t,"b",function(){return l})},2782:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"FileAttachment:#Exchange"},e)}},2787:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(276),r=n(2272),i=n(18);function o(e){return Object(i.isStringNullOrWhiteSpace)(e)?null:("/"!=(e=e.trim())[e.length-1]&&(e+="/"),e)}function c(e,t){var n=e.AttachLongPathName;if(Object(r.f)(e.PermissionType)||e.ProviderType!==a.l)return n;var i,c,s,l,u,d,m,h,p=t.ApplicationSettings;if(null!==n&&null!==p){var f=void 0;null!==(f=o(p.VDirIsPublicProperty||t.PublicComputersDetectionEnabled&&t.SessionSettings.IsPublicComputerSession?p.ExternalSPMySiteHostURL:p.InternalSPMySiteHostURL))&&(i=n,c=f,d=new RegExp("^(https?)\\:[\\/\\\\]{2}([\\w\\.-]+)(\\:[0-9]{1,4})?(.*)$","i"),m=d.exec(i),h=d.exec(c),m&&h&&m.length>=5&&h.length>=5&&(h[1]&&h[2]&&(u=h[1]+"://"+h[2],s=!0),h[3]&&(u+=h[3]),m[4]&&(l=!0,u+=m[4])),n=s&&l?u:null)}return null!=n?n:e.AttachLongPathName}},2788:function(e,t,n){"use strict";var a=n(595),r=n(2637),i=n(8),o=n(4);t.a=Object(o.action)("refreshDownloadUrl")(function(e,t,n,o){void 0===n&&(n=!1),void 0===o&&(o=Object(i.c)("doc-consumerUrl"));var c=Object(a.a)(e),s=Object(r.a)(e,c.model,t,n,o);c.download.url=s})},2789:function(e,t,n){"use strict";var a=n(4);t.a=Object(a.action)("changeTotalClassicAttachmentSize")(function(e,t){e.totalClassicAttachmentSize+=t})},2790:function(e,t,n){"use strict";var a=n(2789),r=n(2642),i=n(3355),o=n(595),c=n(2442),s=n(4);t.a=Object(s.action)("removeAttachmentFromWell")(function(e,t,n,s,l){var u=Object(o.a)(t.attachmentId);if(u){var d,m;1===t.attachmentType?(d=e.inlineAttachments,m=!0):d=Object(c.a)(u.model)?e.imageViewAttachments:e.docViewAttachments;var h=d.indexOf(t);h>=0&&(d.splice(h,1),!m&&t.isCloudy||Object(a.a)(e,-1*u.model.Size),Object(i.a)(t.attachmentId),Object(r.a)(e,n,s,l))}})},2791:function(e,t,n){"use strict";var a=n(3),r=n(2554),i=Object(a.action)("addCalendarEventsAttachment",function(e,t){return{attachment:e,datapointConfig:{name:r.a.AttachmentAddCalendarEvent.datapoint.name,customData:r.a.AttachmentAddCalendarEvent.datapoint.customData(t)}}});t.a=i},2792:function(e,t,n){"use strict";var a=n(595),r=n(4);t.a=Object(r.action)("setAttachmentOriginalUrl")(function(e,t){Object(a.a)(e).model.AttachmentOriginalUrl=t})},2793:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(93);function r(e,t){return i(e.docViewAttachments,t)||i(e.imageViewAttachments,t)}function i(e,t){return e.filter(function(e){return Object(a.c)(e.attachmentId,t)})[0]}},2862:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return r}),n.d(t,"c",function(){return i});var a="/owa/{0}/service.svc/s/GetAttachmentPdfPreview?id={1}",r=96/72,i=150/72},2863:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n(568),r=n(82),i=n(136),o=n(2914),c=n(18),s=n(11),l=n.n(s);function u(e,t,n,s){if(void 0===n&&(n=null),void 0===s&&(s=!1),null===e||void 0===e||s)return null;if(Object(i.b)("doc-attachment-expiringLinkImprovements")&&n&&new Date(n)<Object(o.a)())return Object(c.format)(l.a.AttachPerms_ExpiredLink,n);switch(e){case 3:return l.a.AttachPerms_AnyoneCanView;case 4:return l.a.AttachPerms_AnyoneCanEdit;case 6:return l.a.AttachPerms_OrganizationEdit;case 5:return l.a.AttachPerms_OrganizationView;case 1:return t===a.c?l.a.AttachPerms_RecipientsCanView:l.a.AttachPerms_AnyoneCanView;case 2:return t===a.c?l.a.AttachPerms_RecipientsCanEdit:l.a.AttachPerms_AnyoneCanEdit;case 0:return l.a.AttachPerms_NoPermissionToShare;default:return Object(r.a)(e)}}},2866:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(2914);function r(e){return e&&e.info&&e.info.sharingInfo&&e.info.sharingInfo.expirationDate&&new Date(e.info.sharingInfo.expirationDate)<Object(a.a)()}},2916:function(e,t,n){"use strict";var a=n(716),r=n(717),i=n(1215),o=["ErrorTooLargeForLocalAttachmentSingle","ErrorTooLargeForLocalAttachmentMultiple","WarningFilesCanNotBeAttachedGenericError","WarningEmptyFilesCanNotBeAttached","WarningFilesCanNotBeAttachedWithNamesGenericError","WarningSeveralFilesCanNotBeAttachedGenericError","WarningInlineImageTypeNotSupported","WarningAttachmentsCanNotBeDeleted","InfoIncludeMostRecentAttachmentsMessage"];function c(e){e&&e(o)}var s=n(9),l=n(82),u=n(595),d=n(11),m=n.n(d),h=n(0),p=n(597),f=n(191),v=n(18);function g(e,t,n,a){var r=[],i=[];if(e.forEach(function(e){n(e)?r.push(e):i.push(e)}),i.length>0){var o=a(i.map(function(e){return e.name}).join(", "));t(o.messageId,[o.message])}return r}function b(e,t,n,a){c(a);for(var r=[],i=0;i<e.length;i++)r.push(e[i]);return r=g(r,n,function(e){return!(e.fileType===p.a.Local&&0===e.size)},function(e){return{messageId:"WarningEmptyFilesCanNotBeAttached",message:Object(v.format)(m.a.WarningEmptyFilesCanNotBeAttached,e)}}),t&&(r=g(r,n,function(e){return Object(f.c)(e.name)},function(e){return{messageId:"WarningInlineImageTypeNotSupported",message:Object(v.format)(m.a.WarningInlineImageTypeNotSupported,e)}})),r}var w=n(2954),I=n(3308),S=n(2790),O=n(3362),A=n(3792),C=n.n(A),x=n(30),y=n(3793),_=n.n(y);function T(e){var t,n=(t=e,C()({ClientSupportsIrm:!0,AttachmentIds:[t]}));return _()({Header:Object(x.getJsonRequestHeader)(),Body:n}).then(function(e){return e.Body})}var P=n(7),j=n(4),D=Object(j.action)("deleteAttachment",i.a.AttachmentDeletionAction)(function(e,t,n,a,r){return T(t.attachmentId).then(function(i){var o=i.ResponseMessages.Items[0];"Success"===o.ResponseClass?(Object(S.a)(e,t,n,a,r),Object(O.a)(n,o.RootItemId.RootItemChangeKey)):P.c.warn("Attachment: Failed to delete attachment with ResponseClass= "+o.ResponseClass+", ResponseCode="+o.ResponseCode)}).catch(function(e){throw P.c.warn("Attachment: deleteAttachment got error: "+e.message),e})}),k=n(3795),E=n.n(k);var F=n(603),V=n(276);function M(e){if(null==e)return null;switch(e){case 0:return V.l;case 5:return V.f;case 1:return V.k;case 2:return V.c;case 3:return V.b;case 7:return V.n;case 9:return V.o;case 8:return V.p;case 4:return V.i;case 6:return V.d;case 10:return V.j;default:return Object(l.a)(e)}}var L,R,N=n(2956),B=n(104),W=n(2782),U=n.n(W),z=n(152),H=n.n(z),G=n(3363),q=n.n(G),Q=n(2647),J=n.n(Q);function Y(e,t,n){c(n),function(e,t){var n=Object(u.a)(e.item.attachmentId);if(n){var a=Object(v.format)(m.a.WarningAttachmentsCanNotBeDeleted,n.model.Name);t("WarningAttachmentsCanNotBeDeleted",[a])}}(e,t)}(R=L||(L={}))[R.GenericError=0]="GenericError";var Z,X,K=4;function $(e,t){var n,a=(n=function(e){return e.reason},e.reduce(function(e,t){var a=n(t);return e[a]?e[a].push(t):e[a]=[t],e},{}));Object.keys(a).forEach(function(e){var n=a[e];switch(parseInt(e)){case 0:!function(e,t){var n=null,a=null;if(e.length<K){var r=e.map(function(e){return e.item.file.name}).join(", ");a="WarningFilesCanNotBeAttachedWithNamesGenericError",n=Object(v.format)(m.a.WarningFilesCanNotBeAttachedWithNamesGenericError,r)}else a="WarningSeveralFilesCanNotBeAttachedGenericError",n=Object(v.format)(m.a.WarningSeveralFilesCanNotBeAttachedGenericError,e.length);t(a,[n])}(n,t)}})}(X=Z||(Z={}))[X.GenericError=0]="GenericError";var ee=n(2093);var te=function(){function e(e,t,n,a,r,i){void 0===r&&(r=null),void 0===i&&(i=null);var o=this;this.attachmentWellViewState=e,this.parentItemId=t,this.infoBarAddHandler=n,this.infoBarRemoveHandler=a,this.onAnyAttachmentCreatedInParentItemCallback=r,this.onAnyAttachmentDeletedInParentItemCallback=i,this.uploadQueue=[],this.deleteQueue=[],this.uploadFailures=[],this.onFinishPromise=new Promise(function(e,t){o.onFinish=function(t){e(t)}}),this.infoBarAddHandler=this.infoBarAddHandler||function(){},this.infoBarRemoveHandler=this.infoBarRemoveHandler||function(){}}return e.prototype.enqueueAttachmentCreation=function(e,t,n,a,r){if(void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===a&&(a=!1),void 0===r&&(r=null),c(this.infoBarRemoveHandler),!n&&this.ifIsUnderSizeLimitShowErrorMessage(e,this.infoBarAddHandler))return[];e=b(e,t,this.infoBarAddHandler,this.infoBarRemoveHandler);for(var i=0,o=void 0;o=e[i];i++){var s=void 0;if(n){var l=o;s=J()({Name:l.name,Size:l.size,ContentType:l.type,ProviderType:M(l.providerType),AttachmentIsFolder:l.isFolder,IsInline:!1,PermissionType:0})}else if(o.fileType===p.a.Base64InlineImage){var u=o;s=U()({Name:u.name,Size:u.size,ContentType:u.type,IsInline:!0,Content:u.dataUri})}else if(o.fileType===p.a.MailItem){var d=o,m=H()({Id:d.itemId});s=q()({Name:o.name,IsInline:!1,ItemId:m,Size:o.size})}else if(o.fileType===p.a.AttachmentItem){var h=o;s=q()({Name:h.name,AttachmentIdToAttach:h.attachmentItemId,__type:h.type,Size:o.size})}else s=o.fileType===p.a.Uri?U()({Name:o.name,AttachmentOriginalUrl:o.uri,Size:o.size,ContentType:o.type,IsInline:t,Content:""}):U()({Name:o.name,Size:o.size,ContentType:o.type,IsInline:t,Content:""});var f={Id:Object(B.getGuid)(),mailboxInfo:this.parentItemId.mailboxInfo},v=void 0;t?v=Object(ee.h)(f,f.Id,a):(v=Object(ee.f)(f,!1,!1,n,!0),this.attachmentWellViewState.supportedMenuActions&&(v.strategy.supportedMenuActions=this.attachmentWellViewState.supportedMenuActions)),Object(w.a)(v,this.attachmentWellViewState,s,f);var g={attachmentState:v,file:o,attachment:s,shouldShare:n,cancelPendingUpload:function(){},onAttachmentCreatedCallback:r};P.c.info("Attachment: UploadQueue enqueue attachment: Name="+o.name),this.uploadQueue.push(g)}return this.startProcessIfNotStarted(),e},e.prototype.deleteAttachment=function(e,t){var n=this;void 0===t&&(t=null),c(this.infoBarRemoveHandler);var a,r=1===e.attachmentType;if(r||Object(ee.v)(e,3,6),(r?0===e.status:e.actionCompletePercent<=1)&&this.currentUploadItem)if(this.currentUploadItem.attachmentState===e)if(P.c.info("Attachment: Cancelling attachment: TempId="+e.attachmentId),this.currentUploadItem.cancelPendingUpload(),0===e.attachmentType&&e.isCloudy){if(P.c.info("Attachment: Put attachment: Id= "+e.attachmentId+" into deleteQueue"),0===this.deleteQueue.filter(function(t){return t.attachmentState===e}).length){var i={attachmentState:e,onAttachmentDeletedCallback:t};this.deleteQueue.push(i)}this.startProcessIfNotStarted()}else this.isCancelling||(this.isCancelling=!0,(a=e.attachmentId.Id,E()({cancellationId:a})).then(function(t){n.isCancelling=!1,t?Object(S.a)(n.attachmentWellViewState,e,n.parentItemId,n.infoBarAddHandler,n.infoBarRemoveHandler):n.onAttachmentDeleteFailure(e)}));else P.c.info("Attachment: Removing attachment: TempId= "+e.attachmentId+" from queue"),function(e,t){for(var n=0;n<t.length;n++)t[n].attachmentState==e&&t.splice(n,1)}(e,this.uploadQueue),Object(S.a)(this.attachmentWellViewState,e,this.parentItemId,this.infoBarAddHandler,this.infoBarRemoveHandler);else{if(P.c.info("Attachment: Put attachment: Id= "+e.attachmentId+" into deleteQueue"),0===this.deleteQueue.filter(function(t){return t.attachmentState===e}).length){i={attachmentState:e,onAttachmentDeletedCallback:t};this.deleteQueue.push(i)}this.startProcessIfNotStarted()}},e.prototype.onAttachmentDeleteFailure=function(e){Y({item:e,reason:0},this.infoBarAddHandler,this.infoBarRemoveHandler),1!==e.attachmentType&&Object(ee.v)(e,0,0),P.c.warn("Attachment: Failed to cancel attachment: TempId="+e.attachmentId)},e.prototype.startProcessIfNotStarted=function(){this.isInProgress||(this.datapoint=new s.c("AttachmentQueueManager"),this.isInProgress=!0,this.processNextAttachment("NewProcess"))},e.prototype.processNextAttachment=function(e){var t=this;if(P.c.info("Attachment: Invoking processNextAttachment from: "+e),0!==this.deleteQueue.length){var n=this.deleteQueue[0],a=n.attachmentState,r=n.onAttachmentDeletedCallback,i=Object(u.a)(a.attachmentId);P.c.info("Attachment: Deleting attachment: Id= "+a.attachmentId),D(this.attachmentWellViewState,a,this.parentItemId,this.infoBarAddHandler,this.infoBarRemoveHandler).then(function(){t.deleteQueue.shift(),ne(r,t.parentItemId,a.attachmentId,i.model),ne(t.onAnyAttachmentDeletedInParentItemCallback,t.parentItemId,a.attachmentId,i.model),t.processNextAttachment("DeleteAttachmentFinish")}).catch(function(e){t.deleteQueue.shift(),t.onAttachmentDeleteFailure(a),t.logDeletionFailure(e),t.processNextAttachment("DeleteAttachmentFinish")})}else if(0!==this.uploadQueue.length){this.currentUploadItem=this.uploadQueue.shift();var o=this.currentUploadItem.onAttachmentCreatedCallback,c={attachmentWellViewState:this.attachmentWellViewState,parentItemId:this.parentItemId,infoBarAddHandler:this.infoBarAddHandler,infoBarRemoveHandler:this.infoBarRemoveHandler},s=Object(I.a)(this.parentItemId,this.currentUploadItem.attachment,this.currentUploadItem.attachmentState.attachmentId.Id,this.currentUploadItem.file,this.currentUploadItem.attachmentState,c,this.currentUploadItem.shouldShare),l=s.createAttachmentPromise,d=s.cancelCreateAttachment;this.currentUploadItem.cancelPendingUpload=d,l.then(function(e){if(e){var n=h.__assign({},e.AttachmentId,{mailboxInfo:t.parentItemId.mailboxInfo});ne(o,t.parentItemId,n,e),ne(t.onAnyAttachmentCreatedInParentItemCallback,t.parentItemId,n,e)}t.processNextAttachment("CreateAttachmentFinish")}).catch(function(e){t.uploadFailures.push({item:t.currentUploadItem,reason:0}),t.logCreationFailure(e),t.processNextAttachment("CreateAttachmentFinish")})}else this.finishProcess()},e.prototype.finishProcess=function(){P.c.info("Attachment: AttachmentQueueManager: finishProcess"),this.isInProgress=!1;var e=this.currentUploadItem&&this.currentUploadItem.attachmentState?this.currentUploadItem.attachmentState.attachmentId:null;this.currentUploadItem=null,this.onFinish(e),this.datapoint.end(),this.datapoint=null,$(this.uploadFailures,this.infoBarAddHandler),this.uploadFailures=[]},e.prototype.ifIsUnderSizeLimitShowErrorMessage=function(e,t){for(var n=0,a=0,r=void 0;r=e[a];a++)n+=r.size;var i=Object(N.a)(this.attachmentWellViewState);if(n>i){var o=Math.floor(i/F.b),c=void 0,s=void 0;return e.length>1?(s="ErrorTooLargeForLocalAttachmentMultiple",c=Object(v.format)(m.a.TooLargeForLocalAttachmentMultiple,o)):(s="ErrorTooLargeForLocalAttachmentSingle",c=Object(v.format)(m.a.TooLargeForLocalAttachmentSingle,o)),t(s,[c]),!0}return P.c.info("Attachment: TotalSize = "+Math.floor(this.attachmentWellViewState.totalClassicAttachmentSize/1048576)),!1},e.prototype.logCreationFailure=function(e){var t=i.a.AttachmentCreationFailure.datapoint,n=t.name,a=t.customData;Object(s.n)(n,a(e))},e.prototype.logDeletionFailure=function(e){var t=i.a.AttachmentDeletionFailure.datapoint,n=t.name,a=t.customData;Object(s.n)(n,a(e))},e}();function ne(e,t,n,a){e&&e(t,n,a)}n.d(t,"a",function(){return re}),n.d(t,"b",function(){return ie});var ae={};function re(e,t,n,a,r,o,l,u,d,h){if(void 0===o&&(o=!1),void 0===l&&(l=!1),void 0===u&&(u=!1),!t)return c(r),a("WarningFilesCanNotBeAttachedGenericError",[m.a.WarningFilesCanNotBeAttachedGenericError]),[];var p=oe(e,t,a,r,d);return function(e,t,n){for(var a=i.a.AttachmentCreation.datapoint,r=a.name,o=a.customData,c=0;c<e.length;c++){var l=e[c];Object(s.n)(r,o(t,n,l.fileType,l.size))}}(n,o,l),p.enqueueAttachmentCreation(n,o,l,u,h)}function ie(e,t,n,a,r,o){var c=oe(e,n,a,r);!function(e){var t=i.a.AttachmentDeletion.datapoint,n=t.name,a=t.customData,r=e.attachmentType;switch(r){case 1:Object(s.n)(n,a(!0,!1,0));break;case 0:var o=Object(u.a)(e.attachmentId);Object(s.n)(n,a(!1,e.isCloudy,o.model.Size));break;default:Object(l.a)(r)}}(t),c.deleteAttachment(t,o)}function oe(e,t,n,i,o){var c,s,l,u,d,m,h=ae[t.Id];return h||(c=e,s=t,l=n,u=i,d=a.a,m=r.a,void 0===d&&(d=null),void 0===m&&(m=null),h=new te(c,s,l,u,d,m),ae[t.Id]=h,h.onFinishPromise.then(function(e){delete ae[t.Id],o&&o(e)})),h}},2922:function(e,t,n){"use strict";var a=n(276),r=n(2278),i=n(599);function o(e,t,n){var o=e.level!==i.a.Block&&e.directFileAccessEnabled;return o&&t.__type===a.m&&(o=function(e,t){if(e.AttachLongPathName){var n=document.createElement("a");if(n.href=e.AttachLongPathName,n.host.indexOf(c,0)>0||n.search.indexOf(s,0)>0)return!1}if(o=e.ProviderType,l=Object(r.a)(o),l&&l.supportDownload&&!e.AttachmentIsFolder)return a=t,i=e.ContentType,!!(a||i&&"application/onenote"!==i&&"image/png"!==i);var a,i;var o,l;return!1}(t,n)),o}var c="safelinks.protection.outlook.com",s="b7780972f918485c8cfc32b1ba7438eb";var l=n(191);function u(e,t,n,a,i,c){void 0===c&&(c=null);var s,u=o(e,n,Object(l.a)(n.Name)),d=function(e,t,n){if(!e)return null;if(n&&n.length>0)return n;var a=Object(r.a)(t);return a&&a.supportedPermissionLevels}(a,i,function(e){if(null==e)return null;var t=[];return e.CanShareInternally&&(t.push(2),t.push(1)),e.CanCreateOrganizationEditLink&&t.push(6),e.CanCreateOrganizationViewLink&&t.push(5),e.CanCreateAnonymousEditLink&&t.push(4),e.CanCreateAnonymousViewLink&&t.push(3),t.length>0?t:null}(c)),m=(s=c)&&0===s.ResultCode?{getSharingInfoSucceeded:!0,canShareInternally:s.CanShareInternally,canShareExternally:s.CanShareExternally,expirationDate:s.ExpirationDate,ignoreExpirationDate:!1,canRefreshExpiration:!0}:null;return 1===t?{allowDownload:!1,supportedPermissionLevels:null,sharingInfo:null}:a?{allowDownload:u,supportedPermissionLevels:d,sharingInfo:m}:{allowDownload:u,supportedPermissionLevels:null,sharingInfo:null}}n.d(t,"a",function(){return u})},2926:function(e,t,n){"use strict";var a=n(1254),r=n(0),i=n(65),o=n(85);var c=n(2443);function s(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return e.strategy.previewMethod!==o.a.Wac?[3,2]:[4,Object(c.a)(e.attachmentId,!1)];case 1:9!==(t=n.sent()).Status&&6!==t.Status||(a=e.strategy).previewMethod===o.a.Wac&&(a.previewMethod=o.a.Unsupported,a.supportedOpenActions=a.supportedOpenActions.filter(function(e){return e!==i.a.Preview})),n.label=2;case 2:return[2]}var a})})}var l=n(2644),u=n(2619),d=n(595);function m(e,t,n,r,i,o,c,m){void 0===o&&(o=null),void 0===m&&(m=!1),Object(u.a)([{attachmentId:e,attachment:t}],n,i);var h=Object(d.a)(e),p=Object(l.a)(e,n,r,1===h.type,!1,o);return Object(a.a)(p,h,c),m&&s(p),p}n.d(t,"a",function(){return m})},2943:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"CreateAttachmentJsonRequest:#Exchange"},e)}},2944:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"CreateAttachmentRequest:#Exchange"},e)}},2948:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(0),r=n(2949),i=n(2643),o=n(166),c=n(42);function s(e,t,n){return a.__awaiter(this,void 0,void 0,function(){var s,l,u;return a.__generator(this,function(a){switch(a.label){case 0:s=new o.a(i.a.AddToCalendarServiceResult.datapoint.name),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Object(r.a)(t,n,e)];case 2:return l=a.sent(),s.addCustomData(i.a.AddToCalendarServiceResult.datapoint.customData(l.ResponseClass,l.NumberOfEventsImported)),s.end(),[2,l];case 3:return u=a.sent(),s.endWithError(c.a.ServerError,u),[2,null];case 4:return[2]}})})}},2949:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var a=n(71),r=n.n(a),i=n(2950),o=n.n(i),c=n(2952),s=n.n(c),l=n(178),u=n.n(l),d=n(30);function m(e,t,n){return o()({Header:Object(d.getJsonRequestHeader)(),Body:s()({Content:e,ImportedItemFolderId:u()({BaseFolderId:r()({Id:t})}),AttachmentId:n})}).then(function(e){if(null!=e&&null!=e.Body)return e.Body;throw new Error("[importCalendarOperation failed]")})}},2950:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),r=n(2951);t.default=function(e,t){return void 0===e||e.__type||(e=r.default(e)),a.makeServiceRequest("ImportCalendarEvent",e,t)}},2951:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"ImportCalendarEventJsonRequest:#Exchange"},e)}},2952:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"ImportCalendarEventRequest:#Exchange"},e)}},2954:function(e,t,n){"use strict";var a=n(0),r=n(2789),i=n(2619),o=n(2442),c=n(4),s=n(2093);t.a=Object(c.action)("addAttachmentIntoWellBeforeUpload")(function(e,t,n,c,l){var u;void 0===l&&(l=null),n.AttachmentId=c,Object(i.a)([{attachmentId:a.__assign({},n.AttachmentId,{mailboxInfo:c.mailboxInfo}),attachment:n,modelInitializationValues:l}],!1,!0,!0),Object(s.o)(e)?(t.inlineAttachments.push(e),u=!0):(e.isPlaceholderAttachment=!0,Object(o.a)(n)?t.imageViewAttachments.push(e):t.docViewAttachments.push(e)),!u&&e.isCloudy||Object(r.a)(t,n.Size)})},2955:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38);t.default=function(e,t){return a.makeServiceRequest("GetAttachmentDataProviderUploadFolderProps",e,t)}},2956:function(e,t,n){"use strict";function a(e){return e.maxTotalClassicAttachmentSize-e.totalClassicAttachmentSize}n.d(t,"a",function(){return a})},2957:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(597),r=n(276);function i(e){if(e.__type===r.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE){var t=e;return{fileType:a.a.Cloud,name:t.Name,size:t.Size,providerId:"",providerType:4,location:t.AttachLongPathName,providerEndpointUrl:"",isFolder:!1,thumbnailUrl:t.AttachmentThumbnailUrl,previewUrl:t.AttachmentPreviewUrl,fileId:t.AttachmentId.Id,fileParentId:"",type:t.__type}}return{attachmentItemId:e.AttachmentId.Id,name:e.Name,size:e.Size,fileType:a.a.AttachmentItem,type:r.a.attachmentTypes.ITEM_ID_ATTACHMENT_TYPE}}},2986:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(0),r=n(2095),i=n(2393),o="download",c="open";function s(e){return a.__awaiter(this,void 0,void 0,function(){var t,n;return a.__generator(this,function(a){switch(a.label){case 0:return t=Object(i.a)(e.AttachLongPathName),[4,Object(r.h)(t)];case 1:return[2,(n=a.sent()).result&&n.result.webContentLink&&(l=n.result.webContentLink,l.lastIndexOf(o,l.length-o.length)>-1)?(s=n.result.webContentLink,s.slice(0,-o.length)+c):null]}var s,l})})}},2987:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var a=n(0),r=n(2658),i=n.n(r),o=n(985),c=n.n(o),s=n(7);function l(e,t,n){return a.__awaiter(this,void 0,void 0,function(){var r,o,l,u,d,m,h;return a.__generator(this,function(a){switch(a.label){case 0:r={error:null,errorMessage:"Something went wrong while the document preview was being created. Please try again later."},a.label=1;case 1:return a.trys.push([1,3,,4]),n&&(o="getAttachmentTextPreview"+n,(l=new Headers).set("X-OWA-ActionName",o),u={headers:l},t=t?c()(t,u):u),[4,i()({AttachmentId:e},t)];case 2:if((d=a.sent())&&0===d.Status)return[2,d.Content];switch(m=d&&d.Status||1){case 2:r.errorMessage="The attachment has been moved or deleted.";break;case 3:r.errorMessage="Something went wrong while the document preview was being created. Please try again later.";break;case 1:default:r.errorMessage="Something went wrong while the document preview was being created. Please try again later."}return r.error=new Error("getAttachmentTextPreview failed with status: "+m),[3,4];case 3:return h=a.sent(),s.c.warn("getAttachmentTextPreview failed with error: "+h),r.error=h,[3,4];case 4:throw r}})})}},3086:function(e,t,n){var a=n(3087),r=n(33);"string"==typeof a&&(a=[[e.i,a]]);for(var i=0;i<a.length;i++)r.loadStyles(a[i][1],!1);a.locals&&(e.exports=a.locals)},3087:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'._3YR2KFTmg6ffWsdkA8qgsf{font-size:12px;font-weight:400}html[dir] ._3YR2KFTmg6ffWsdkA8qgsf{margin-top:20px;margin-bottom:20px}._1CVm2wtNSSVcZebvg_d2By{vertical-align:middle}._2hyWYjDEKDEZhJaRwB4oWE{color:"[theme:neutralSecondary, default:#666666]";vertical-align:middle}html[dir=ltr] ._2hyWYjDEKDEZhJaRwB4oWE{margin-left:7px}html[dir=rtl] ._2hyWYjDEKDEZhJaRwB4oWE{margin-right:7px}html[dir] .NaGwFoQd23TbcXC0rXaR-{margin-top:5px}._3bOpvVQGD8LjtV0a-26IPc{color:"[theme:neutralPrimary, default:#333333]"}',""]),t.locals={panel:"_3YR2KFTmg6ffWsdkA8qgsf",attachIcon:"_1CVm2wtNSSVcZebvg_d2By",attachmentCountLabel:"_2hyWYjDEKDEZhJaRwB4oWE",attachmentCollectionContainer:"NaGwFoQd23TbcXC0rXaR-",attachmentCollectionLabel:"_3bOpvVQGD8LjtV0a-26IPc"}},314:function(e,t,n){"use strict";n.d(t,"d",function(){return a}),n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"e",function(){return c}),n.d(t,"f",function(){return s});var a=600,r=600,i=650,o=1/2.89*100,c=420,s=420/1300*100},3204:function(e,t,n){var a=n(5003),r=n(33);"string"==typeof a&&(a=[[e.i,a]]);for(var i=0;i<a.length;i++)r.loadStyles(a[i][1],!1);a.locals&&(e.exports=a.locals)},3205:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o});var a=n(2),r=new a.c(function(){return Promise.all([n.e(6),n.e(7),n.e(25),n.e(34),n.e(57)]).then(n.bind(null,3729))}),i=Object(a.d)(r,function(e){return e.AttachmentView}),o=new a.b(r,function(e){return e.getContextMenus})},3213:function(e,t,n){"use strict";n.d(t,"a",function(){return v});var a=n(2866),r=n(82),i=n(149),o=n(136),c=n(93),s=n(8),l=n(18),u=n(666),d=n.n(u),m=n(11),h=n.n(m),p=n(2773);function f(e,t){return t?h.a.SavedOneFileToGroupFilesText:Object(l.format)(h.a.SavedOneFileToOneDriveText,e?h.a.ConsumerDefaultSaveToCloudLocationText:h.a.OneDriveText)}function v(e,t){var n,u,m,v,g=Object(s.c)("doc-consumerUrl"),b=void 0!==t.id.mailboxInfo&&t.id.mailboxInfo.type==c.a.GroupMailbox;if(0===e.actionMessage)return n=e,u=t,{text:(m=Object(p.b)(n,u)).text,title:m.title,shouldDisplaySuccessIcon:!1,shouldDisplayFailureIcon:!1,useExpiredAttachmentStyling:Object(o.b)("doc-attachment-expiringLinkImprovements")&&Object(a.a)(u)&&!u.info.sharingInfo.ignoreExpirationDate};var w,I=!1,S=!1;switch(e.actionMessage){case 1:v=function(e,t){if(t)return h.a.SavingOneFileToGroupFilesText;var n=Object(i.f)();return e?Object(l.format)(h.a.SavingOneFileToOneDriveConsumerText,h.a.ConsumerDefaultSaveToCloudLocationText):Object(l.format)(h.a.SavingOneFileToOneDriveText,n)}(g,b);break;case 5:v=h.a.CanceledSaveOneFileToOneDriveText;break;case 2:v=f(g,b);break;case 3:v=f(g,b),I=!0;break;case 4:case 9:w=g,v=b?h.a.FailedToSaveFileToGroupFilesText:Object(l.format)(h.a.FailedToSaveFileToOneDriveText,w?h.a.ConsumerDefaultSaveToCloudLocationText:h.a.OneDriveText),S=!0;break;case 7:v=h.a.UpdatingAttachmentText;break;case 6:v=h.a.DeletingAttachmentText;break;case 8:v=function(e,t){if(t)return h.a.UploadingToGroupFilesText;var n=Object(i.f)();return e?Object(l.format)(h.a.UploadingToOneDriveConsumerText,n,h.a.ConsumerDefaultSaveToCloudLocationText):Object(l.format)(h.a.UploadingToOneDriveText,n)}(g,b);break;case 10:v=h.a.CancelingText;break;case 11:v=h.a.AttachingACopyText;break;case 12:v=h.a.FailedToAttachAsACopyText,S=!0;break;case 16:v=h.a.CancelingText;break;case 14:v=h.a.AddToCalendarSuccessMessgaeWithIcon,I=!0;break;case 15:v=d.a.ICSFileErrorText,S=!0;break;case 13:v=d.a.ImportingText;break;case 17:v=h.a.UpdatingAttachmentText;break;default:Object(r.a)(e.actionMessage)}return{text:v,title:v,shouldDisplaySuccessIcon:I,shouldDisplayFailureIcon:S,useExpiredAttachmentStyling:!1}}},3214:function(e,t,n){"use strict";function a(e){return e.actionCompletePercent>0&&e.actionCompletePercent<=1}n.d(t,"a",function(){return a})},3308:function(e,t,n){"use strict";var a=n(0),r=n(2093),i=n(7),o=n(4),c=n(3750),s=n(2790),l=n(3362),u=n(279);function d(e,t,n,a,i,o,s){Object(r.y)(e,t,n,a,o),Object(l.a)(i,a.AttachmentId.RootItemChangeKey),Object(c.a)(e,n,o,s)}function m(e,t,n,a,i,o,c){1===e.attachmentType&&Object(r.u)(e,2),t&&Object(s.a)(t,e,i,o,c),n&&a&&u.g.importAndExecute(n,a)}var h=Object(o.action)("handleCreateAttachmentNotification")(function(e,t,n,a,o,c,s,l){var u=e;try{if(0===u.ResultCode){var h=u.Response.ResponseMessages.Items[0];if(h&&h.Attachments.length>0)return Object(r.x)(o.attachmentId,!0),c(h.Attachments[0]),void d(o,n,a,h.Attachments[0],t,u.Response.SharingInformation,l)}}catch(e){i.c.error("Error handling the create attachment notification: "+e)}Object(r.x)(o.attachmentId,!1),s(new Error(u.Exception)),m(o,l.attachmentWellViewState,null,null,l.parentItemId,l.infoBarAddHandler,l.infoBarRemoveHandler)}),p=n(104);function f(e,t){return a.__awaiter(this,void 0,void 0,function(){var n,r,i,o;return a.__generator(this,function(a){switch(a.label){case 0:return n=Object(p.getGuid)(),r={subscriptionId:n,requiresExplicitSubscribe:!1,subscriptionParameters:null},i=function(e){t(e),u.g.importAndExecute(r,i)},[4,u.f.import()];case 1:return a.sent()(r,i),[4,u.b.import()];case 2:return o=a.sent()(),e(n,r,o,i),[2]}})})}var v=n(1215),g=n(3788),b=n.n(g);var w=n(9),I=Object(o.action)("createAttachmentFromAttachmentDataProvider")(function(e,t,n,i,o,c,s,l,u){return a.__awaiter(this,void 0,void 0,function(){var d,p,g,I,S,O,A=this;return a.__generator(this,function(C){return d=v.a.AttachmentCreationClassicFromAttachmentDataProvider.datapoint,p=d.name,g=d.customData,(I=new w.c(p)).addCustomData(g(o.providerType)),S=function(e){s(e),I.end()},O=function(e){l(),I.endWithError(w.a.ServerError,e)},f(function(t,n,s,d){return a.__awaiter(A,void 0,void 0,function(){return a.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),0===c.attachmentType&&Object(r.w)(Object(r.j)(o.size),.05,function(e){Object(r.t)(c,e)},c.attachmentId),[4,(h=e,p=i,f=o,v=t,g=s,w=!1,b()({itemId:h,attachmentDataProviderId:f.providerId,location:f.location,attachmentId:f.fileId||"",subscriptionId:v,channelId:g,dataProviderParentItemId:f.fileParentId||"",providerEndpointUrl:f.providerEndpointUrl,cancellationId:p,isInline:w}))];case 1:if(!a.sent())throw new Error("Empty response for createAttachmentFromAttachmentDataProvider request");return[3,3];case 2:return a.sent(),Object(r.x)(c.attachmentId,!1),l(),m(c,u.attachmentWellViewState,n,d,u.parentItemId,u.infoBarAddHandler,u.infoBarRemoveHandler),[2];case 3:return[2]}var h,p,f,v,g,w})})},function(a){h(a,e,t,n,c,S,O,u)}),[2]})})}),S=n(192);function O(e,t,n,a,r){return new Promise(function(o,c){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===s.readyState)if(200===s.status){var e=void 0;try{e=JSON.parse(s.responseText)}catch(e){i.c.error("Attachment: Deserialize response failed with error: "+e.Message),i.c.error("Attachment: Deserialize response Failure Stack Trace: "+e.stack),c(e)}o(e)}else c(new Error("Request failed with status "+s.status+". Message: "+s.responseText))},s.ontimeout=function(){c(new Error("Request timed out"))},r&&(s.upload.onprogress=r),s.open("POST",e,!0),s.setRequestHeader("X-OWA-Action",n),s.setRequestHeader("X-OWA-CANARY",Object(S.getOwaCanaryCookie)());var l=JSON.stringify(t);a?(s.setRequestHeader("X-OWA-UrlPostData",encodeURIComponent(l)),s.send(a)):s.send(l)})}var A=n(107);function C(e){var t=Object(A.getConfig)();return t.baseUrl?""+t.baseUrl+e:"/owa"+e}var x=n(2943),y=n.n(x),_=n(2944),T=n.n(_),P=n(30),j=C("/service.svc/CreateAttachmentFromLocalFile");function D(e,t,n,r,o,c){return a.__awaiter(this,void 0,void 0,function(){var s,l,u;return a.__generator(this,function(a){switch(a.label){case 0:return s=T()({ParentItemId:e,Attachments:[t],RequireImageType:t.IsInline,IncludeContentIdInResponse:t.IsInline,ClientSupportsIrm:!0,CancellationId:n}),c&&(s.SliceNumber=c.sliceNumber,s.TotalSlices=c.totalSlices),l=y()({Header:Object(P.getJsonRequestHeader)(),Body:s}),u=t,i.c.info("Attachment: createAttachment Id: "+e.Id+", ChangeKey: "+e.ChangeKey),[4,O(j,l,"CreateAttachmentFromLocalFile",u&&r?r:null,o)];case 1:return[2,a.sent().Body]}})})}var k=Object(o.action)("createAttachmentFromLocalFile",v.a.AttachmentCreationClassicFromLocalFile)(function(e,t,n,o,c){return a.__awaiter(this,void 0,void 0,function(){var s,l,u,d;return a.__generator(this,function(a){switch(a.label){case 0:return s=null,0===c.attachmentType&&(s=function(e){var t=e.loaded/e.total;Object(r.t)(c,t)}),[4,D(e,t,n,o,s)];case 1:if(l=a.sent(),(u=l.ResponseMessages.Items[0])&&u.Attachments.length>0&&u.Attachments[0])return[2,{attachment:u.Attachments[0],sharingInfo:null}];throw d="Attachment: createAttachment failed",u&&u.MessageText&&(d+=" with MessageText: "+u.MessageText),i.c.warn(d),new Error(d)}})})}),E=n(3363),F=n.n(E),V=Object(o.action)("createAttachmentFromMailboxFile",v.a.AttachmentCreationFromRecentAttachment)(function(e,t,n,o,c,s){return a.__awaiter(this,void 0,void 0,function(){var l,u,d,m,h;return a.__generator(this,function(a){switch(a.label){case 0:return l=null,0===c.attachmentType&&(l=function(e){var t=e.loaded/e.total;Object(r.t)(c,t)}),u=t,s&&(p=t,f=o.fileId,u=F()({AttachmentId:p.AttachmentId,AttachmentIdToAttach:f,ContentType:p.ContentType,Name:p.Name,Size:p.Size,Thumbnail:p.Thumbnail,ThumbnailMimeType:p.ThumbnailMimeType,CreateAttachmentInlineType:2})),[4,D(e,u,n,null,l)];case 1:if(d=a.sent(),(m=d.ResponseMessages.Items[0])&&m.Attachments.length>0&&m.Attachments[0])return[2,{attachment:m.Attachments[0],sharingInfo:d.SharingInformation}];throw h="Attachment: createAttachment failed",m&&m.MessageText&&(h+=" with MessageText: "+m.MessageText),i.c.warn(h),new Error(h)}var p,f})})});var M=n(3789),L=n.n(M);var R=Object(o.action)("createAttachmentFromUri")(function(e,t,n,i,o,c,s,l,u){var d=this,p=v.a.AttachmentCreationFromUri.datapoint,g=p.name,b=p.customData,I=new w.c(g);I.addCustomData(b(o));var S=function(e){s(e),I.end()},O=function(e){l(),I.endWithError(w.a.ServerError,e)};f(function(t,i,s,h){return a.__awaiter(d,void 0,void 0,function(){return a.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),0===c.attachmentType&&Object(r.w)(Object(r.k)(o.size),.05,function(e){Object(r.t)(c,e)},c.attachmentId),[4,(s=e,d=o.uri,p=o.name,f=t,v=n.IsInline,g=null,L()({itemId:s,uri:d,name:p,subscriptionId:f,isInline:v,contentId:g}))];case 1:if(!a.sent())throw new Error("Empty response for createAttachmentFromUriProvider request");return[3,3];case 2:return a.sent(),Object(r.x)(c.attachmentId,!1),l(),m(c,u.attachmentWellViewState,i,h,u.parentItemId,u.infoBarAddHandler,u.infoBarRemoveHandler),[3,3];case 3:return[2]}var s,d,p,f,v,g})})},function(a){h(a,e,t,n,c,S,O,u)})}),N=n(3790),B=n.n(N);var W=Object(o.action)("createReferenceAttachmentFromAttachmentDataProvider",v.a.AttachmentCreationCloudyFromAttachmentDataProvider)(function(e,t,n,i){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(a){return 0===i.attachmentType&&Object(r.w)(4e3,.05,function(e){Object(r.t)(i,e)},i.attachmentId),[2,(o=e,c=t,s=n,B()({itemId:o,attachmentDataProviderId:s.providerId,location:s.location,attachmentId:s.fileId||"",dataProviderParentItemId:s.fileParentId||"",providerEndpointUrl:s.providerEndpointUrl,cancellationId:c,thumbnailUrl:s.thumbnailUrl,previewUrl:s.previewUrl,isFolder:s.isFolder,mimeType:s.type})).then(function(e){var t=e.ResponseMessages.Items[0];if(t&&t.Attachments.length>0)return Object(r.x)(i.attachmentId,!0),{attachment:t.Attachments[0],sharingInfo:e.SharingInformation};throw Object(r.x)(i.attachmentId,!1),t.MessageText})];var o,c,s})})}),U=n(3791),z=n.n(U),H=C("/service.svc/CreateReferenceAttachmentFromLocalFile");var G=n(2955),q=n.n(G),Q=new Map;var J=Object(o.action)("createReferenceAttachmentFromLocalFile",v.a.AttachmentCreationCloudyFromLocalFile)(function(e,t,n,i,o,c,s,l,u){return a.__awaiter(this,void 0,void 0,function(){var d=this;return a.__generator(this,function(p){return f(function(t,s,h,p){return a.__awaiter(d,void 0,void 0,function(){return a.__generator(this,function(d){return function(e,t,n,i,o,c,s,l,u,d,h,p){a.__awaiter(this,void 0,void 0,function(){var f,v,g,b,w,I,S,A;return a.__generator(this,function(C){switch(C.label){case 0:return f=Math.ceil(i.size/d),Object(r.w)(Object(r.n)(i.size),.05,function(e){Object(r.t)(o,e)},o.attachmentId),v=null,(g=p&&p.attachmentWellViewState&&p.attachmentWellViewState.groupId)?(x=g,y=Q.get(x),(v=y&&y.FolderId)?[3,2]:[4,function(e){return a.__awaiter(this,void 0,void 0,function(){var t;return a.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,q()({},{headers:{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":e}})];case 1:return t=n.sent(),Q.set(e,t),[2,a.__assign({},t)];case 2:return n.sent(),[2,null];case 3:return[2]}})})}(g)]):[3,2];case 1:(A=C.sent())&&(v=A.FolderId),C.label=2;case 2:b=0,C.label=3;case 3:if(!(b<f))return[3,8];w=0+b*d,I=Math.min(w+d,i.size),S=i.slice(w,I),C.label=4;case 4:return C.trys.push([4,6,,7]),[4,function(e,t,n,r,i,o,c,s,l,u){return a.__awaiter(this,void 0,void 0,function(){var d;return a.__generator(this,function(a){switch(a.label){case 0:return d=z()({ParentItemId:e,FileName:t.Name,SubscriptionId:i,ChannelId:o,FileSizeInBytes:t.Size,SliceNumber:c,TotalSlices:s,CancellationId:n,FileContentToUpload:"",GroupSmtpAddress:l,UploadFolderId:u}),[4,O(H,{requestObject:d},"CreateReferenceAttachmentFromLocalFile",r)];case 1:return[2,a.sent()]}})})}(e,t,n,S,c,l,b,f,g,v)];case 5:if(!(A=C.sent()))throw new Error("Empty response for createReferenceAttachmentFromLocalFile request");return[3,7];case 6:return C.sent(),Object(r.x)(o.attachmentId,!1),h(),m(o,p.attachmentWellViewState,s,u,p.parentItemId,p.infoBarAddHandler,p.infoBarRemoveHandler),[2];case 7:return b++,[3,3];case 8:return[2]}var x,y})})}(e,n,i,o,c,t,s,h,p,10485760,l,u),[2]})})},function(a){h(a,e,t,n,c,s,l,u)}),[2]})})});var Y,Z,X=n(82),K=n(597),$=n(136);(Z=Y||(Y={}))[Z.Completed=0]="Completed",Z[Z.Cancelled=1]="Cancelled";var ee=Object.freeze({sliceSize:14680064,numberOfSlicesToParallelize:2});function te(e,t,n){var a;void 0===n&&(n=ee),(a=n).sliceSize=a.sliceSize||ee.sliceSize,a.numberOfSlicesToParallelize=a.numberOfSlicesToParallelize||ee.numberOfSlicesToParallelize;var r=n.sliceSize,i=n.numberOfSlicesToParallelize,o=Math.ceil(e.size/r),c=function(e,t,n){for(var a=[],r=0,i=0;i<e;i++){var o=Math.min(r+t,n);a.push({start:r,end:o}),r=o}return a}(o,r,e.size),s=re(e,[c[0]],1,t,o,function(){return 0}),l=c.length>2?re(e,c.slice(1,c.length-1),i,t,o,function(e){return e+1}):ae(),u=c.length>1?re(e,[c[c.length-1]],1,t,o,function(){return c.length-1}):ae();return{onCompletePromise:s.task().then(ne(l.task)).then(ne(u.task)),cancel:function(){s.cancelTask(),l.cancelTask(),u.cancelTask()}}}function ne(e){return function(t){return 0===t?e():Promise.resolve(t)}}function ae(){var e=!1;return{task:function(){return e?Promise.resolve(1):Promise.resolve(0)},cancelTask:function(){return e=!0}}}function re(e,t,n,a,r,i){var o=!1;return{task:function(){return new Promise(function(c,s){for(var l=0,u=0,d=0,m=function(){var h,p,f,v,g;o&&c(1),l<n&&d<t.length&&((h=d,p=t[h],f=p.start,v=p.end,g=e.slice(f,v),a(g,i(h),r)).then(function(){return l-=1,(u+=1)===t.length&&c(0),void m()}).catch(s),d+=1,l+=1)},h=0;h<n;h++)m()})},cancelTask:function(){return o=!0}}}var ie,oe,ce=14680064;function se(e,t,n,o,c){var s=this,l=null,u=!1,d=null;return{action:function(m,h,p){return a.__awaiter(s,void 0,void 0,function(){var s,f;return a.__generator(this,function(v){switch(v.label){case 0:return d||(d=function(e){for(var t=[],n=0;n<e;n++)t[n]=0;return t}(p)),s=null,0===c.attachmentType&&(s=function(e){d[h]=e.loaded;var t=d.reduce(function(e,t){return e+t},0)/o.size;Object(r.t)(c,t)}),[4,D(e,t,n,m,s,{sliceNumber:h,totalSlices:p})];case 1:return f=v.sent(),l=f.ResponseMessages.Items[0],(g=l)&&g.Attachments.length>0&&g.Attachments[0]?u||(t=a.__assign({},t,{AttachmentId:l.Attachments[0].AttachmentId}),u=!0):function(e){var t="Attachment: createAttachment failed";throw e&&e.MessageText&&(t+=" with MessageText: "+e.MessageText),i.c.warn(t),new Error(t)}(l),[2]}var g})})},getLastResponseMessage:function(){return l}}}function le(e,t,n,a){e.addCustomData(v.a.AttachmentCreationClassicFromLocalFileSliced.datapoint.customData(t)),n?e.end():e.endWithError(w.a.ServerError,a)}function ue(e,t,n,r,i,o,c){void 0===c&&(c=!1);var s,l,u,h,p,f,g,b=r&&r.fileType===K.a.Cloud,S=null,O=a.__assign({},t.AttachmentId,{mailboxInfo:e.mailboxInfo}),A=function(){};if((s=r).fileType===K.a.AttachmentItem||s.fileType===K.a.Cloud&&4===s.providerType)S=V(e,t,n,r,i,b).then(function(e){return e});else if(c||b){if(!c&&b)return{createAttachmentPromise:new Promise(function(a,c){I(e,O,t,n,r,i,a,c,o)}),cancelCreateAttachment:A};if(!c||!b)return{createAttachmentPromise:new Promise(function(a,c){return J(e,O,t,n,r.fileObject,i,a,c,o),t}),cancelCreateAttachment:A};S=W(e,n,r,i)}else if(Object($.b)("doc-attachment-slicedClassicAttachmentUpload")&&r&&r.fileType===K.a.Local&&r.fileObject){var C=function(e,t,n,a,r,i){void 0===i&&(i={}),i.sliceSizeInBytes=i.sliceSizeInBytes||ce;var o=new w.c(v.a.AttachmentCreationClassicFromLocalFileSliced.datapoint.name),c=se(e,t,n,a,r),s=c.action,l=c.getLastResponseMessage,u=te(a,s,{sliceSize:i.sliceSizeInBytes,numberOfSlicesToParallelize:1}),d=u.onCompletePromise,m=u.cancel,h=!1;return{onCompletePromise:d.then(function(e){switch(e){case 0:return le(o,a.size,!0),{status:0,attachment:l().Attachments[0]};case 1:return{status:1};default:return Object(X.a)(e)}}).catch(function(e){if(h)return{status:1};throw le(o,a.size,!1,e),e}),cancel:function(){h=!0,m()}}}(e,t,n,r.fileObject,i),x=C.onCompletePromise;A=C.cancel,S=x.then(function(e){switch(e.status){case 0:return{attachment:e.attachment,sharingInfo:null};case 1:return null;default:return Object(X.a)(e)}})}else{if(r&&r.fileType===K.a.Uri)return{createAttachmentPromise:new Promise(function(a,c){R(e,O,t,n,r,i,a,c,o)}),cancelCreateAttachment:A};S=k(e,t,n,r&&r.fileType===K.a.Local?r.fileObject:null,i)}return l=e,u=O,h=t,p=i,f=o,g=A,{createAttachmentPromise:S.then(function(e){return e?(d(p,u,h,e.attachment,l,e.sharingInfo,f),e.attachment):null}).catch(function(e){throw m(p,f.attachmentWellViewState,null,null,f.parentItemId,f.infoBarAddHandler,f.infoBarRemoveHandler),e}),cancelCreateAttachment:g}}(oe=ie||(ie={}))[oe.Completed=0]="Completed",oe[oe.Cancelled=1]="Cancelled",n.d(t,"a",function(){return ue})},3324:function(e,t,n){"use strict";var a=n(149),r=n(2396),i=n(595),o=n(657),c=n(18),s=n(7),l=n(4),u=n(34),d=n(93),m=Object(l.select)({previewPaneStore:function(){return u.y}})(Object(l.action)("createImageGalleryFromAttachmentWell")(function(e,t,n){var l=n.previewPaneStore.state;if(l&&l.type===a.b.Image&&e.imageViewAttachments.some(function(e){return Object(d.c)(e.attachmentId,l.attachmentId)})){var u=[];e.imageViewAttachments.forEach(function(n){var a=Object(i.a)(n.attachmentId),l=a.model,d=Object(o.b)(a.id,a.model,2,1===a.type,n.isReadOnly),m=n.strategy.isSaveToCloudSupported&&Object(c.isStringNullOrWhiteSpace)(a.model.AttachmentOriginalUrl),h={attachmentId:n.attachmentId,name:l.Name,size:l.Size,downloadUrl:a.download.url,isDownloadDisabled:!a.info||!a.info.allowDownload,isSaveToCloudEnabled:m,previewUrl:a.previewImage.url,thumbnailUrl:d,isCloudy:n.isCloudy,parentItemId:t};u.push(h),Object(r.a)(n.attachmentId,e.isReadOnly).then(function(){var e=Object(i.a)(n.attachmentId).thumbnailImage.url;h.thumbnailUrl=e},function(e){return s.c.warn("Unable to refresh thumbnail image for "+n.attachmentId+". Got error "+e)})}),n.previewPaneStore.imageGallery=u}})),h=n(0),p=n(144);function f(e,t){return void 0===t&&(t=!1),h.__awaiter(this,void 0,void 0,function(){var n,a,r,i,o,c,l,u,d,m,f;return h.__generator(this,function(h){switch(h.label){case 0:return n=[],[4,p.e.import()];case 1:return a=h.sent(),[4,p.h.import()];case 2:return r=h.sent(),t?[4,p.j.import()]:[3,4];case 3:return o=h.sent(),[3,5];case 4:o=null,h.label=5;case 5:i=o,c=t?e.docViewAttachments:e.imageViewAttachments,l=0,h.label=6;case 6:if(!(l<c.length))return[3,12];if(u=c[l],d=a(u.attachmentId),t&&!i(d.model))return[3,11];h.label=7;case 7:return h.trys.push([7,9,,10]),[4,r(u.attachmentId,e.isReadOnly)];case 8:return h.sent(),[3,10];case 9:return m=h.sent(),s.c.warn("Unable to refresh thumbnail image for "+u.attachmentId+". Got error "+m),[3,10];case 10:f={downloadUrl:d.download.url,id:u.attachmentId,previewUrl:d.previewImage.url,thumbnailUrl:d.thumbnailImage.url},n.push(f),h.label=11;case 11:return l++,[3,6];case 12:return[2,n]}})})}n.d(t,"b",function(){return m}),n.d(t,"a",function(){return f})},3330:function(e,t,n){"use strict";var a=n(0),r=n(2862),i=n(18);function o(e){return a.__awaiter(this,void 0,void 0,function(){var t,n,o,c,s,l,u;return a.__generator(this,function(d){switch(d.label){case 0:return[4,function(e,t){return a.__awaiter(this,void 0,void 0,function(){var n;return a.__generator(this,function(a){switch(a.label){case 0:return n=Object(i.format)(r.b,e,encodeURIComponent(t)),[4,fetch(n,{credentials:"same-origin"})];case 1:return[2,a.sent()]}})})}(e.mailboxInfo&&e.mailboxInfo.mailboxId,e.Id)];case 1:return(t=d.sent()).ok?[4,t.text()]:[3,3];case 2:for(n=d.sent(),o=n.replace(/\s/gi,""),c=atob(o),s=c.length,l=new Uint8Array(new ArrayBuffer(s)),u=0;u<s;u++)l[u]=c.charCodeAt(u);return[2,l];case 3:throw t.statusText}})})}n.d(t,"a",function(){return o})},3355:function(e,t,n){"use strict";var a=n(489),r=n(4);t.a=Object(r.action)("deleteAttachment")(function(e){Object(a.a)().attachments.delete(e.Id)})},3356:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"ConvertLocalToRefAttachmentRequest:#Exchange"},e)}},3357:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"CancelConvertLocalToRefAttachmentRequest:#Exchange"},e)}},3359:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"ConvertRefToLocalAttachmentRequest:#Exchange"},e)}},3360:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"CancelConvertRefToLocalAttachmentRequest:#Exchange"},e)}},3361:function(e,t,n){"use strict";function a(e,t){if(1!=e.type)return null;var n=e.model;return{id:n.AttachmentId,name:n.Name,supportsDownsell:t,currentPermissionLevel:n.PermissionType,sharingInfo:e.info.sharingInfo}}n.d(t,"a",function(){return a})},3362:function(e,t,n){"use strict";var a=n(4);t.a=Object(a.action)("updateChangeKeyOnItemId")(function(e,t){e.ChangeKey=t})},3363:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"ItemIdAttachment:#Exchange"},e)}},3561:function(e,t,n){var a=n(5201),r=n(33);"string"==typeof a&&(a=[[e.i,a]]);for(var i=0;i<a.length;i++)r.loadStyles(a[i][1],!1);a.locals&&(e.exports=a.locals)},3562:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"SetAttachmentPermissionsRequest:#Exchange"},e)}},3729:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(984),i=n(1266),o=null;function c(e){o&&(clearTimeout(o),o=null),Object(i.a)(e)||Object(r.a)(e,!0)}function s(e){o&&clearTimeout(o),o=setTimeout(function(){Object(i.a)(e)||Object(r.a)(e,!1),o=null},40)}var l=n(14),u=n(524),d=n(2529),m=n(34),h=n(11),p=n.n(h),f=n(1),v=n(614),g=n(5193),b=function(e){function t(t){var n=e.call(this,t)||this;return n.handleOnFocus=function(){c(n.props.attachmentViewState)},n.handleOnBlur=function(){s(n.props.attachmentViewState)},n.onClickContextMenuButton=n.onClickContextMenuButton.bind(n),n}return a.__extends(t,e),t.prototype.render=function(){if(this.getShouldHideContextMenuButton())return null;var e=void 0,t=this.getAttachmentStyle(this.props.previewState);return e=this.props.isForImageView?v([g.button,g.contextMenuButton,g.contextMenuButtonForImageView]):this.props.attachmentViewState.isReadOnly?v([g.button,g.contextMenuButton,t]):v([g.button,g.contextMenuButton,t,g.contextMenuButtonForDocViewInCompose]),f.createElement(u.IconButton,{onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,ariaLabel:p.a.MoreActionsButton,title:p.a.MoreActionsButton,onClick:this.onClickContextMenuButton,className:e,iconProps:{iconName:"ChevronDownMed"}})},t.prototype.onClickContextMenuButton=function(e){e.stopPropagation(),Object(d.a)(this.props.attachmentViewState,!0)},t.prototype.getShouldHideContextMenuButton=function(){return 0!==this.props.attachmentViewState.ongoingAction||!this.props.attachmentViewState.strategy.showActionsMenu},t.prototype.getAttachmentStyle=function(e){switch(e){case m.a.Edit:return g.edit;case m.a.NotSelectedAndSaving:return g.notSelectedAndSaving;case m.a.OtherSaving:return g.attachmentView;case m.a.Selected:return g.selected;case m.a.SelectedAndPending:return g.selectedAndPending;case m.a.SelectedAndSaving:return g.selectedAndSaving;default:return g.none}},t=a.__decorate([l.observer],t)}(f.Component),w=n(614),I=n(5195),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleOnFocus=function(){c(t.props.attachmentViewState)},t.handleOnBlur=function(){s(t.props.attachmentViewState)},t.onClickDeleteButton=function(e){e.stopPropagation(),t.props.onDeleteButtonClicked(t.props.attachmentViewState)},t}return a.__extends(t,e),t.prototype.render=function(){var e;return e=this.props.isForImageView?w([I.deleteButton,I.deleteButtonForImageView]):w(I.deleteButton,this.getAttachmentStyle(this.props.previewState)),f.createElement("div",{className:I.actionContainer},this.props.attachmentViewState.isReadOnly?null:f.createElement(u.IconButton,{onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,ariaLabel:p.a.DeleteAttachmentButton,className:e,onClick:this.onClickDeleteButton,iconProps:{iconName:"Cancel"}}),f.createElement(b,{attachmentViewState:this.props.attachmentViewState,isForImageView:this.props.isForImageView,previewState:this.props.previewState}))},t.prototype.getAttachmentStyle=function(e){switch(e){case m.a.Edit:return I.edit;case m.a.NotSelectedAndSaving:return I.notSelectedAndSaving;case m.a.OtherSaving:return I.attachmentView;case m.a.Selected:return I.selected;case m.a.SelectedAndPending:return I.selectedAndPending;case m.a.SelectedAndSaving:return I.selectedAndSaving;default:return I.none}},t=a.__decorate([l.observer],t)}(f.Component),O=n(1826),A=n(1253),C=n(2773),x=n(3213),y=n(2866),_=n(5197),T=n(90).bind(_),P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderFirstLine=function(e,n,a){return n&&!t.props.isForImageView?f.createElement("div",{className:T(_.firstLineCommonStyle,_.firstLineReference,_.textOverflow,a),title:e},f.createElement(A.b,{attachmentId:t.props.attachmentViewState.attachmentId,iconSize:1,className:_.smallFileIcon}),f.createElement("div",{className:T(_.firstLineReferenceAttachmentText)},t.props.attachment.model.Name)):f.createElement("div",{className:T(_.firstLineCommonStyle,_.firstLine,_.textOverFlow,a),title:e},t.props.attachment.model.Name)},t}return a.__extends(t,e),t.prototype.render=function(){var e=Object(C.a)(this.props.attachmentViewState,this.props.attachment),t={attachmentInfoForImageView:this.props.isForImageView,attachmentInfoForDocView:!this.props.isForImageView},n={firstLineForImageView:this.props.isForImageView,expiredAttachment:!this.props.attachmentViewState.isReadOnly&&Object(y.a)(this.props.attachment)},a={secondLineForImageView:this.props.isForImageView,expiredAttachment:!this.props.attachmentViewState.isReadOnly&&Object(y.a)(this.props.attachment)},r={colorGreen:!this.props.isForImageView},i={colorRed:!this.props.isForImageView},o=Object(x.a)(this.props.attachmentViewState,this.props.attachment),c=1===this.props.attachment.type;return f.createElement("div",{className:T(_.attachmentInfo,t)},this.renderFirstLine(e,c,n),f.createElement("div",{title:o.title?o.title:e},o.shouldDisplaySuccessIcon&&f.createElement(O.a,{iconName:"Accept",className:T(_.actionComplete,r)}),o.shouldDisplayFailureIcon&&f.createElement(O.a,{iconName:"Cancel",className:T(_.actionComplete,i)}),f.createElement("span",{className:T(_.secondLineCommonStyle,_.secondLine,_.textOverFlow,a)},o.text)))},t=a.__decorate([l.observer],t)}(f.Component),j=n(9),D=n(5199),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return[f.createElement(A.b,{attachmentId:this.props.attachmentViewState.attachmentId,useCloudIcon:!0}),f.createElement("div",{className:D.attachmentInfoContainer},f.createElement(P,{attachmentViewState:this.props.attachmentViewState,attachment:this.props.attachment,isForImageView:!1})),f.createElement(S,{attachmentViewState:this.props.attachmentViewState,onDeleteButtonClicked:this.props.onDeleteButtonClicked,isForImageView:!1,previewState:this.props.previewState})]},t=a.__decorate([l.observer,Object(j.j)("AttachmentDocView")],t)}(f.Component),E=n(3561),F=n(90).bind(E),V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e={infoContainerForReadingPane:this.props.attachmentViewState.isReadOnly};return this.props.attachmentViewState.shouldShowImageOverlay?f.createElement("div",{className:F(E.infoContainer,e)},f.createElement(P,{attachmentViewState:this.props.attachmentViewState,attachment:this.props.attachment,isForImageView:!0}),f.createElement(S,{attachmentViewState:this.props.attachmentViewState,onDeleteButtonClicked:this.props.onDeleteButtonClicked,isForImageView:!0,previewState:m.a.None})):null},t=a.__decorate([l.observer],t)}(f.Component),M=n(41),L=n(191),R=n(872),N=n(614),B=n(3561),W=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleOnFocus=function(){c(t.props.attachmentViewState)},t.handleOnBlur=function(){s(t.props.attachmentViewState)},t.handleMainContainerMouseOver=function(){Object(i.a)(t.props.attachmentViewState)||Object(r.a)(t.props.attachmentViewState,!0)},t.handleMainContainerMouseLeave=function(){Object(i.a)(t.props.attachmentViewState)||Object(r.a)(t.props.attachmentViewState,!1)},t}return a.__extends(t,e),t.prototype.render=function(){var e=this.props.attachment.model.Name,t=Object(R.b)(e),n=null,a=Object(M.getIconClassName)("Photo2");return Object(L.d)(e)&&(n=t.small,a=t.large),f.createElement("span",{tabIndex:0,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,onMouseEnter:this.handleMainContainerMouseOver,onMouseOver:this.handleMainContainerMouseOver,onMouseLeave:this.handleMainContainerMouseLeave},f.createElement(A.c,{attachmentViewState:this.props.attachmentViewState,placeHolderCSSClass:N(a,B.placeholder),fileIconCssClass:n,imageLoadErrorCSSClass:t.large,thumbnailWidth:160,thumbnailHeight:120}),f.createElement(V,{attachment:this.props.attachment,attachmentViewState:this.props.attachmentViewState,onDeleteButtonClicked:this.props.onDeleteButtonClicked}))},t=a.__decorate([l.observer,Object(j.j)("AttachmentImageView")],t)}(f.Component),U=n(3214),z=n(1893),H=n(5202),G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return Object(U.a)(this.props.attachmentViewState)&&f.createElement("span",{className:H.progressIndicator},f.createElement(z.a,{percentComplete:this.props.attachmentViewState.actionCompletePercent}))},t=a.__decorate([l.observer],t)}(f.Component);function q(e,t){return-1!==t.strategy.supportedMenuActions.indexOf(e)}var Q=n(2093),J=n(595),Y=n(2791),Z=n(1229),X=n(16);function K(e){var t="";return e&&e.model&&(t=Object(L.b)(e.model.Name||"")||e.model.ContentType||""),t}var $=n(2254);function ee(e){var t=Object(J.a)(e.attachmentId);if(!q(Q.a.ImportCalendarEventAttachment,e)||!t||13!==t.attachmentClass||!Object(X.b)("cal-ics-preview"))return null;var n=K(t);return{name:p.a.AddToCalendarText,key:"AddToCalendar",onClick:function(){var a=$.a.AddToCalendar.datapoint,r=a.name,i=a.customData;Object(j.n)(r,i(t.model.Size,n)),t.model.Size>10485760||!e.attachmentId||!e.attachmentId.Id?Object(Z.a)(e,0,15):(Object(Y.a)(e,0),Object(Q.w)(Object(Q.i)(t.model.Size),.1,function(t){Object(Q.t)(e,t)},e.attachmentId))}}}var te=n(3562),ne=n.n(te),ae=n(5204),re=n.n(ae);function ie(e,t,n,a){void 0===n&&(n=null),void 0===a&&(a=!1);var r,i,o,c,s=(r=e,i=t,c=a,void 0===(o=n)&&(o=null),void 0===c&&(c=!1),ne()({AttachmentIds:r,PermissionLevel:i,NewAttachLongPathNames:o,SetToOriginalPermissionLevel:c}));return re()({request:s})}var oe=n(2787),ce=n(6),se=n(4),le=Object(se.action)("changeAttachmentPermission")(function(e,t,n,r){return void 0===n&&(n=null),void 0===r&&(r=!1),a.__awaiter(this,void 0,void 0,function(){var i;return a.__generator(this,function(a){switch(a.label){case 0:return[4,ie(e.map(function(e){return e.Id}),t,n,r)];case 1:if(!(i=a.sent()).OperationSucceeded||!i.NewAttachLongPathNames||i.NewAttachLongPathNames.length!==e.length)throw new Error("Error setting attachment permissions");return e.forEach(function(e,n){var a=Object(J.a)(e),r=a.model;r.AttachLongPathName=i.NewAttachLongPathNames[n],r.PermissionType=t,a.openUrl=Object(oe.a)(r,Object(ce.a)()),i.ExpirationDates&&a.info.sharingInfo&&(a.info.sharingInfo.expirationDate=i.ExpirationDates[n])}),[2]}})})}),ue=n(2863),de=n(141);function me(e,t){if(!q(Q.a.ChangePermissions,e)||e.isReadOnly)return null;var n=Object(J.a)(e.attachmentId);if(!n||!n.info||!n.info.supportedPermissionLevels||n.info.supportedPermissionLevels.length<=1)return null;var r,i,o,c,s=n.model;return 0===s.PermissionType?null:{name:p.a.ChangePermissionsText,key:"ChangePermissions",items:(r=n.info,i=t,o=e,c=s.PermissionType,r.supportedPermissionLevels.map(function(e){return n=i,r=o,s=c,0===(t=e)?null:{name:Object(ue.a)(t,n),key:t.toString(),onClick:function(){!function(e,t,n,r){a.__awaiter(this,void 0,void 0,function(){var i,o,c;return a.__generator(this,function(a){switch(a.label){case 0:if(i=$.a.ChangePermission.datapoint,o=i.name,c=i.customData,Object(j.n)(o,c(r)),e===n)return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),Object(Q.v)(t,4,7),[4,le([t.attachmentId],e)];case 2:return a.sent(),[3,4];case 3:return a.sent(),Object(de.b)("",p.a.AttachPerms_ChangePermissionsFailed,!1,{hideCancelButton:!0}),[3,4];case 4:return Object(Q.v)(t,0,0),[2]}})})}(t,r,s,n)}};var t,n,r,s}))}}var he=n(149),pe=n(136),fe=n(144),ve=n(8),ge=n(18),be=n(173);function we(e,t,n,r,i,o,c,s){if(!Object(pe.b)("doc-attachment-convertClassicToCloudy")||!q(Q.a.ConvertClassicToCloudy,e)||!e.strategy.isConvertClassicToCloudySupported)return null;var l,u=Object(J.a)(e.attachmentId);return u&&u.model.__type!==fe.a.attachmentTypes.ITEM_ATTACHMENT_TYPE?{name:(l=Object(ve.c)("doc-consumerUrl"),Object(ge.format)(p.a.UploadToOneDriveText,l?p.a.OneDrivePersonalText:Object(he.f)())),key:"ConvertClassicToCloudy",onClick:function(){!function(e,t,n){a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(a){switch(a.label){case 0:return Object(m.n)(e.attachmentId.Id)?[4,m.o.import()]:[3,3];case 1:return[4,a.sent()()];case 2:a.sent(),m.q.importAndExecute("convertClassicToCloudy"),a.label=3;case 3:return Object(be.i)(e.attachmentId)?[4,be.j.import()]:[3,9];case 4:return[4,a.sent()()];case 5:return a.sent()?[3,8]:[4,be.o.import()];case 6:return[4,a.sent()("convertClassicToCloudy")];case 7:a.sent(),a.label=8;case 8:a.label=9;case 9:return[4,Object(Q.d)(e,t,function(t,a){t?n(e,a,!1,!0):Object(Q.x)(e.attachmentId,t)})];case 10:return a.sent(),Object(Q.w)(Object(Q.m)(e.attachmentId),.1,function(t){Object(Q.t)(e,t)},e.attachmentId),[2]}})})}(e,c,s)}}:null}function Ie(e,t,n,r,i,o,c,s,l){return Object(pe.b)("doc-attachment-convertCloudyToClassic")&&q(Q.a.ConvertCloudyToClassic,e)&&e.strategy.isConvertCloudyToClassicSupported?{name:Object(ge.format)(p.a.AttachAsACopyText),key:"ConvertCloudyToClassic",onClick:function(){!function(e,t,n,r,i){a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(a){switch(a.label){case 0:return Object(m.n)(e.attachmentId.Id)?[4,m.o.import()]:[3,3];case 1:return[4,a.sent()()];case 2:a.sent(),m.q.importAndExecute("convertCloudyToClassic"),a.label=3;case 3:return Object(be.i)(e.attachmentId)?[4,be.j.import()]:[3,9];case 4:return[4,a.sent()()];case 5:return a.sent()?[3,8]:[4,be.o.import()];case 6:return[4,a.sent()("convertCloudyToClassic")];case 7:a.sent(),a.label=8;case 8:a.label=9;case 9:return Object(Q.e)(e,t.Id,n,r,i),[2]}})})}(e,c,l,i,s)}}:null}var Se=n(139);function Oe(e,t){var n=Object(J.a)(e.attachmentId);return q(Q.a.CopyLink,e)&&e.strategy&&e.strategy.isOpeningByLinkSupported&&n&&!Object(ge.isStringNullOrWhiteSpace)(n.openUrl)?{name:p.a.CopyLinkText,key:"CopyLink",onClick:function(){!function(e,t){var n=$.a.CopyLink.datapoint,a=n.name,r=n.customData;Object(j.n)(a,r(t));var i=Object(Se.g)()?p.a.CopyToClipboardMacPromptText:p.a.CopyToClipboardPromptText;window.prompt(i,e)}(n.openUrl,t)}}:null}var Ae=n(1267);function Ce(e,t,n,a,r,i,o,c,s,l){var u,d,m=Object(J.a)(e.attachmentId);if(!(q(Q.a.Download,e)&&m&&(u=e,d=Object(J.a)(u.attachmentId),d.download.url&&d.info&&d.info.allowDownload)))return null;var h=K(m);return{name:p.a.downloadText,key:"download",onClick:function(){var t=$.a.Download.datapoint,n=t.name,a=t.customData;Object(j.n)(n,a(e.isCloudy,m.model.Size,h)),Object(Ae.a)(m.download.url,e.isCloudy,l)}}}var xe=Object(se.action)("setIgnoreExpirationDate")(function(e,t){Object(J.a)(e).info.sharingInfo.ignoreExpirationDate=t}),ye=n(3361),_e=n(2394),Te=n(2395);function Pe(e){var t,n,a,r,i=Object(J.a)(e.attachmentId);return Object(pe.b)("doc-attachment-expiringLinkImprovements")&&q(Q.a.IgnoreExpiration,e)&&(t=i,n=e.strategy.isConvertCloudyToClassicSupported,a=e.isReadOnly,r=Object(ye.a)(t,n),!a&&(Object(_e.b)(r)||Object(Te.b)(r)))?{name:p.a.SuggestActionIgnoreExpiration,key:"Ignore",onClick:function(){var t,n;t=e,n=$.a.IgnoreLinkExpiration.datapoint.name,Object(j.n)(n),xe(t.attachmentId,!0)}}:null}var je=n(5205),De=n.n(je),ke=n(7);function Ee(e,t,n,r,i,o,c,s,l,u,d){return Object(pe.b)("mc-moveAttachmentToInline")&&q(Q.a.MoveAttachmentToInline,e)&&e.strategy.isMoveAttachmentToInlineSupported?{name:p.a.MoveAttachmentToInlineText,key:"MoveAttachmentToInline",onClick:function(){!function(e,t,n){a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(r){return function(e,t){return a.__awaiter(this,void 0,void 0,function(){var n,r,i;return a.__generator(this,function(a){switch(a.label){case 0:n={ewsAttachmentId:e.attachmentId,itemId:t.Id},a.label=1;case 1:return a.trys.push([1,3,,4]),[4,De()({requestObject:n})];case 2:return(r=a.sent()).ErrorMessage?(ke.c.warn("Failed to convert image attachment to inline, error message: "+r.ErrorMessage),[3,4]):[2,r.ContentId];case 3:return i=a.sent(),ke.c.warn("Failed to move image attachment to the message body, error message: "+i.message),[3,4];case 4:return[2,null]}})})}(e,t).then(function(t){n(e,t)}),[2]})})}(e,c,d)}}:null}var Fe=n(2624);function Ve(e,t){var n=Object(J.a)(e.attachmentId);return q(Q.a.OpenInNewTab,e)&&e.strategy.isOpeningInProviderSupported&&n&&!Object(ge.isStringNullOrWhiteSpace)(n.openUrl)?Object(Fe.c)(n.openUrl,function(){var e=$.a.OpenInNewTab.datapoint,n=e.name,a=e.customData;Object(j.n)(n,a(t))}):null}var Me=n(520);function Le(e,t,n,a,r,i){var o=Object(J.a)(e.attachmentId),c=K(o);return q(Q.a.Preview,e)&&Object(he.e)(e.strategy)===he.a.Preview&&o?{name:p.a.PreviewText,key:"Preview",onClick:function(){var t=$.a.Preview.datapoint,n=t.name,a=t.customData;Object(j.n)(n,a(e.isCloudy,o.attachmentClass,c)),Me.e.importAndExecute(i)}}:null}function Re(e){var t,n,r=Object(J.a)(e.attachmentId),i=r.model;return Object(pe.b)("doc-attachment-expiringLinkImprovements")&&q(Q.a.RefreshLink,e)&&(t=r,n=i.PermissionType,!e.isReadOnly&&t&&t.info&&t.info.sharingInfo&&t.info.sharingInfo.expirationDate&&!t.info.sharingInfo.ignoreExpirationDate&&t.info.supportedPermissionLevels.indexOf(n)>-1)?{name:p.a.SuggestActionRefreshTheLink,key:"Refresh",onClick:function(){!function(e,t){a.__awaiter(this,void 0,void 0,function(){var n,r;return a.__generator(this,function(a){switch(a.label){case 0:return n=$.a.RefreshLink.datapoint.name,Object(j.n)(n),r=t.model,Object(Q.v)(e,8,17),[4,le([t.id],r.PermissionType)];case 1:return a.sent(),Object(Q.v)(e,0,0),[2]}})})}(e,r)}}:null}var Ne=n(93);function Be(e){var t=Object(J.a)(e.attachmentId);if(!t||!q(Q.a.SaveToCloud,e)||!Object(Q.p)(e))return null;var n=K(t);return{name:function(e){if(e)return p.a.SaveOneFileToGroupFilesText;return Object(ve.c)("doc-consumerUrl")?p.a.SaveOneFileToOneDriveConsumerText:Object(ge.format)(p.a.SaveOneFileToOneDriveText,Object(he.f)())}(e.attachmentId.mailboxInfo.type===Ne.a.GroupMailbox),key:"Save to OneDrive",onClick:function(){var a=$.a.SaveToCloud.datapoint,r=a.name,i=a.customData;Object(j.n)(r,i(t.model.Size,n)),Object(Q.q)(e,function(t){Object(Q.x)(e.attachmentId,t)}),Object(Q.w)(Object(Q.m)(e.attachmentId),.1,function(t){Object(Q.t)(e,t)},e.attachmentId)}}}var We=n(896),Ue=n(2272);var ze=n(82),He=n(1252);function Ge(){return Object(ge.format)(p.a.ViewInText,p.a.OneDriveText)}function qe(){var e={viewInProviderOptionText:null,GetUrlForViewInProviderAction:function(e){return e}};return a.__assign({},e,{viewInProviderOptionText:Ge(),GetUrlForViewInProviderAction:function(e){return function(e){if(Object(ge.isStringNullOrWhiteSpace)(e))return e;var t=e.lastIndexOf("/");return t>=1?e.substr(0,t):e}(e)}})}var Qe,Je,Ye=Object(He.a)(function(e){switch(e){case 0:return qe();case 1:return t={viewInProviderOptionText:null,GetUrlForViewInProviderAction:function(e){return e}},a.__assign({},t,{viewInProviderOptionText:Ge()});case 2:case 3:case 5:case 7:case 8:case 9:return{viewInProviderOptionText:null,GetUrlForViewInProviderAction:function(e){return e}};case 6:case 4:case 10:return null;default:return Object(ze.a)(e)}var t}),Ze=Ye.getDataProviderInfo,Xe=(Ye.getDefaultDataProviderInfo,Ze);function Ke(e,t,n,a,r){var i,o,c=Object(J.a)(e.attachmentId);return q(Q.a.ViewInProvider,e)&&e.strategy.isViewingInProviderSupported&&c&&!Object(Ue.f)(r)&&e.isCloudy?(i=Xe(t),o=i.GetUrlForViewInProviderAction(c.openUrl),{name:i.viewInProviderOptionText,key:"ViewInProvider",onClick:function(){var e=$.a.ViewInProvider.datapoint,n=e.name,a=e.customData;Object(j.n)(n,a(t)),Object(We.a)(o)}}):null}function $e(e,t,n,a,r,i,o){var c,s,l=[];return(c=o,s=[],[8,0,4,1,2,7,3,9,10,5,6,11,12].forEach(function(e){switch(e){case 0:s.push(me);break;case 4:s.push(Ce);break;case 9:s.push(Be);break;case 3:s.push(Oe);break;case 7:s.push(Ve);break;case 10:s.push(Ke);break;case 8:s.push(Le);break;case 1:s.push(we);break;case 2:s.push(Ie);break;case 5:s.push(ee);break;case 6:c&&s.push(Ee);break;case 11:s.push(Re);break;case 12:s.push(Pe);break;default:Object(ze.a)(e)}}),s).forEach(function(c){var s=null,u=null,d=null;if(e.isCloudy){var m=t.model;d=m.AttachLongPathName,u=m.ProviderType,s=e.isReadOnly?m.OriginalPermissionType:m.PermissionType}var h=c(e,u,Object(ve.c)("doc-consumerUrl"),t.model.AttachmentOriginalUrl,s,n,a,r,d,i,o);h&&l.push(h)}),l}(Je=Qe||(Qe={}))[Je.ChangePermission=0]="ChangePermission",Je[Je.ConvertClassicToCloudy=1]="ConvertClassicToCloudy",Je[Je.ConvertCloudyToClassic=2]="ConvertCloudyToClassic",Je[Je.CopyLinkToClipboard=3]="CopyLinkToClipboard",Je[Je.Download=4]="Download",Je[Je.ImportIcsAttachment=5]="ImportIcsAttachment",Je[Je.MoveAttachmentToInline=6]="MoveAttachmentToInline",Je[Je.OpenInNewTab=7]="OpenInNewTab",Je[Je.Preview=8]="Preview",Je[Je.SaveToCloud=9]="SaveToCloud",Je[Je.ViewInProvider=10]="ViewInProvider",Je[Je.RefreshLink=11]="RefreshLink",Je[Je.IgnoreExpiration=12]="IgnoreExpiration";var et=n(1647),tt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onDismissContextMenu=function(e){Object(d.a)(t.props.attachmentViewState,!1)},t}return a.__extends(t,e),t.prototype.render=function(){return this.props.attachmentViewState.shouldShowContextMenu?f.createElement(et.a,{shouldFocusOnMount:!0,directionalHint:6,target:this.props.targetElementGetter(),onDismiss:this.onDismissContextMenu,items:$e(this.props.attachmentViewState,this.props.attachment,this.props.previewContext,this.props.parentItemId,this.props.onReplaceAttachment,null,this.props.moveAttachmentToInlineHandler)}):null},t=a.__decorate([l.observer],t)}(f.Component),nt=n(1190),at=n(1378),rt=n(5207),it=n(90).bind(rt),ot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attachmentDivGetter=function(){return t.attachmentDiv},t.keyPressEnter=function(e){13===e.keyCode&&t.performOpenAction()},t.performOpenAction=function(){if((t.props.previewMode===m.a.None||t.props.previewMode===m.a.PendingNavigation)&&t.defaultOpenAction!==he.a.NoAction){var e=$.a.OnClick.datapoint,n=e.name,a=e.customData;Object(j.n)(n,a(t.defaultOpenAction)),Object(Me.c)(t.props.attachmentViewState,Me.a.ReadingPane,t.props.instrumentationContext,t.props.parentItemId,t.props.isDraft,t.props.onBeforePreview,t.props.onAfterPreview,t.props.createImageGallery)}},t.onContextMenu=function(e){e.preventDefault(),Object(d.a)(t.props.attachmentViewState,!0)},t.onDeleteButtonClicked=function(e){switch(e.ongoingAction){case 5:try{Object(Q.b)(e)}catch(e){}break;case 6:try{Object(Q.c)(e)}catch(e){}break;default:t.props.onDeleteButtonClicked(e)}},t.canDrag=function(){return!!t.props.attachment},t.getDragData=function(){return t.props.onDragStart(t.props.attachment.model)},t.getDragPreview=function(){var e=document.createElement("div");return e.className=rt.dragPreview,e.innerText=t.props.attachment.model.Name,e},t}return a.__extends(t,e),t.prototype.render=function(){var e,t=this;if(!this.props.attachment&&this.props.isDraft)return null;switch(this.props.previewMode){case m.a.Edit:e=p.a.EditingLabel;break;case m.a.SelectedAndSaving:case m.a.NotSelectedAndSaving:e=p.a.SavingLabel;break;default:e=""}var n=""!==e;this.defaultOpenAction=Object(he.e)(this.props.attachmentViewState.strategy);var a={attachmentImageView:this.props.isImage,attachmentDocView:!this.props.isImage,handCursor:this.defaultOpenAction!==he.a.NoAction,defaultCursor:this.defaultOpenAction===he.a.NoAction,regularTopBorderRadius:n};return a[this.getAttachmentStyle(this.props.previewMode)]=!0,f.createElement("div",{tabIndex:0,"aria-label":this.props.attachment.model.Name,onKeyDown:this.keyPressEnter,className:rt.attachmentContainer},f.createElement("div",{className:it(rt.attachmentLabelHidden,{attachmentLabel:n})},f.createElement("div",{className:rt.attachmentLabelWrapper},f.createElement(O.a,{className:rt.attachmentLabelIcon,iconName:"Edit"}),f.createElement("span",{className:rt.attachmentLabelText},e))),f.createElement("div",{className:it(rt.attachmentView,a),ref:function(e){return t.attachmentDiv=e},onClick:this.performOpenAction,onContextMenu:this.onContextMenu},Object(pe.b)("doc-attachment-dragDropAttachments")?f.createElement(nt.b,{canDrag:this.canDrag,getDragData:this.getDragData,getDragPreview:this.getDragPreview,xOffset:-12,yOffset:5},this.renderAttachmentView()):this.renderAttachmentView()))},t.prototype.renderAttachmentView=function(){var e={viewState:this.props.attachmentViewState,previewPaneSelectionSource:Me.a.ReadingPane,parentItemId:this.props.parentItemId,isDraft:this.props.isDraft,onBeforePreview:this.props.onBeforePreview,onAfterPreview:this.props.onAfterPreview,createImageGallery:this.props.createImageGallery,instrumentationContext:this.props.instrumentationContext};return[this.props.isImage?f.createElement(W,{attachmentViewState:this.props.attachmentViewState,attachment:this.props.attachment,onDeleteButtonClicked:this.onDeleteButtonClicked}):f.createElement(k,{attachmentViewState:this.props.attachmentViewState,attachment:this.props.attachment,onDeleteButtonClicked:this.onDeleteButtonClicked,previewState:this.props.previewMode}),f.createElement(G,{attachmentViewState:this.props.attachmentViewState}),f.createElement(tt,{attachment:this.props.attachment,attachmentViewState:this.props.attachmentViewState,targetElementGetter:this.attachmentDivGetter,previewContext:e,parentItemId:this.props.parentItemId,onReplaceAttachment:this.props.onReplaceAttachment,moveAttachmentToInlineHandler:this.props.moveAttachmentToInlineHandler})]},t.prototype.componentDidMount=function(){this.props.previewMode===m.a.PendingNavigation&&this.performOpenAction()},t.prototype.componentWillReceiveProps=function(e){this.props.previewMode!==m.a.PendingNavigation&&e.previewMode===m.a.PendingNavigation&&this.performOpenAction()},t.prototype.getAttachmentStyle=function(e){switch(e){case m.a.Edit:return"edit";case m.a.NotSelectedAndSaving:return"notSelectedAndSaving";case m.a.OtherSaving:return"attachmentView";case m.a.Selected:return"selected";case m.a.SelectedAndPending:return"selectedAndPending";case m.a.SelectedAndSaving:return"selectedAndSaving";default:return"none"}},t=a.__decorate([Object(at.reactive)({attachment:function(e){return Object(J.a)(e.attachmentViewState.attachmentId)}}),Object(j.j)("AttachmentView")],t)}(f.Component);n.d(t,"AttachmentView",function(){return ot}),n.d(t,"getContextMenus",function(){return $e})},3731:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(93);function i(e,t){return e.some(function(e){return Object(r.c)(e.attachmentId,t)})}function o(e,t){return e.canOverrideAllowShowMultipleRows?e.allowShowMultipleRows||(n=e,!!(a=t)&&(i(n.docViewAttachments,a)||i(n.imageViewAttachments,a))):e.allowShowMultipleRows;var n,a}var c=n(191),s=n(18),l=n(11),u=n.n(l);function d(e,t,n){var a=e.docViewAttachments.length+e.imageViewAttachments.length,r=e.totalClassicAttachmentSize,i=t&&!n;if(r>0){var o=i?u.a.ShowAllNAttachmentsWithSize:u.a.NAttachmentsWithSize,l=Object(c.e)(r);return Object(s.format)(o,a,l)}o=i?u.a.ShowAllNAttachments:u.a.NAttachments;return Object(s.format)(o,a)}var m=n(14),h=n(541),p=n(4),f=Object(p.action)("setAllowShowMultipleRows")(function(e,t){e.allowShowMultipleRows=t}),v=Object(p.action)("setCanOverrideAllowShowMultipleRows")(function(e,t){e.canOverrideAllowShowMultipleRows=t}),g=n(1),b=n(5001),w=n(3204),I=n(90),S=function(e){function t(t){var n=e.call(this,t)||this;return n.onClickShowAllButton=n.onClickShowAllButton.bind(n),n.onClickShowOneRowButton=n.onClickShowOneRowButton.bind(n),n}return a.__extends(t,e),t.prototype.render=function(){var e,t=this.props.attachmentWellViewState.didViewOverflowOneRow,n=o(this.props.attachmentWellViewState,this.props.previewPaneAttachmentId),a=d(this.props.attachmentWellViewState,t,n),r={iconProps:{}};return t?(n?(r.onClick=this.onClickShowOneRowButton,r.iconProps.iconName="DoubleChevronUp"):(r.onClick=this.onClickShowAllButton,r.iconProps.iconName="DoubleChevronDown"),r.disabled=!1,e=I(w.barButton,w.barButtonHover)):(r.disabled=!0,e=w.barButton),g.createElement("span",null,g.createElement(h.a,{className:e,disabled:r.disabled,iconProps:{iconName:r.iconProps.iconName,styles:{root:b.chevronButton}},onClick:r.onClick},a))},t.prototype.onClickShowAllButton=function(e){f(this.props.attachmentWellViewState,!0)},t.prototype.onClickShowOneRowButton=function(e){f(this.props.attachmentWellViewState,!1),v(this.props.attachmentWellViewState,!1)},t=a.__decorate([m.observer],t)}(g.Component),O={DownloadAll:{datapoint:{name:"AttachmentWellDownloadAll",customData:function(e,t){return[e,t]}}},Download:{datapoint:{name:"AttachmentWellDownload",customData:function(e){return[e]}}},SaveAllToCloud:{datapoint:{name:"AttachmentWellSaveAllToCloud",customData:function(e,t){return[e,t]}}},CancelSaveAllToCloud:{datapoint:{name:"AttachmentWellCancelSaveAllToCloud",customData:function(e,t){return[e,t]}}},OpenPhotoHub:{datapoint:{name:"AttachmentWellOpenPhotoHub"}},OpenFilesHub:{datapoint:{name:"AttachmentWellOpenFilesHub"}}},A=n(82),C=n(149),x=n(8);var y=n(9),_=n(2093),T=n(2620),P=n(1215),j=n(2793);function D(e,t,n){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(a){return[2,new Promise(function(a,r){var i,o,c,s,l=[],u=!1,d=new y.c(P.a.AttachmentSaveAllToCloud.datapoint.name);c=l,s=(o=e).totalClassicAttachmentSize/256,k(o.docViewAttachments,c,s),k(o.imageViewAttachments,c,s);Object(T.b)(null,t,function(t){var a=t.AttachmentId,r=-1,o=l.filter(function(e,t){return e.Id===a&&(r=t,!0)});if(o.length>0){l.splice(r,1);var c=Object(j.a)(e,o[0]),s=0===t.ResultCode;Object(_.r)(c,s,s?t.Item.Location:null),Object(_.x)(o[0],s),0!==t.ResultCode&&(u=!0,t.Exception&&(i=t.Exception))}return 0===l.length&&(n(u),d.addCustomData(P.a.AttachmentSaveAllToCloud.datapoint.customData(e.totalClassicAttachmentSize,!u,t.ResultCode)),i?d.endWithError(y.a.ServerError,new Error(i)):d.end(),!0)},function(t,a,r){l.forEach(function(t){var n=Object(j.a)(e,t);Object(_.r)(n,!1,null),Object(_.x)(t,!1)}),n(!0),d.addCustomData(P.a.AttachmentSaveAllToCloud.datapoint.customData(e.totalClassicAttachmentSize,!1,a)),d.endWithError(r,new Error(t))},function(e,t,n){a([e,t,n,l])})})]})})}function k(e,t,n){e.forEach(function(e){t.push(e.attachmentId),Object(_.s)(e),Object(_.w)(n,.1,function(t){Object(_.t)(e,t)},e.attachmentId)})}var E=Object(p.action)("setSaveAllToCloudStatus")(function(e,t){e.saveAllToCloudStatus=t}),F=n(5004),V=n.n(F);var M=n(279),L=n(3204),R=n(90),N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickSaveToCloudButton=function(e){return a.__awaiter(t,void 0,void 0,function(){var e,t,n,r;return a.__generator(this,function(a){switch(a.label){case 0:return E(this.props.attachmentWellViewState,1),t=O.SaveAllToCloud.datapoint,n=t.name,r=t.customData,Object(y.n)(n,r(this.props.attachmentWellViewState.docViewAttachments.length+this.props.attachmentWellViewState.imageViewAttachments.length,this.props.attachmentWellViewState.totalClassicAttachmentSize)),[4,D(this.props.attachmentWellViewState,this.props.parentItemId,this.onSaveAllToCloudComplete)];case 1:return e=a.sent(),this.operationId=e[0],this.subscription=e[1],this.notificationCallback=e[2],this.attachmentsToSaveToCloud=e[3],[2]}})})},t.onSaveAllToCloudComplete=function(e){E(t.props.attachmentWellViewState,e?3:2)},t.onClickCancelButton=function(e){var n,a;(n=t.props.parentItemId.Id,a=t.props.parentItemId.mailboxInfo.requestOptions,V()({itemId:n},a)).then(function(e){e&&(M.g.importAndExecute(t.subscription,t.notificationCallback),Object(T.a)(t.operationId),t.attachmentsToSaveToCloud.forEach(function(e){var n=Object(j.a)(t.props.attachmentWellViewState,e);Object(_.v)(n,0,5),Object(_.x)(e,!1)}),E(t.props.attachmentWellViewState,4))});var r=O.CancelSaveAllToCloud.datapoint,i=r.name,o=r.customData;Object(y.n)(i,o(t.props.attachmentWellViewState.docViewAttachments.length+t.props.attachmentWellViewState.imageViewAttachments.length,t.props.attachmentWellViewState.totalClassicAttachmentSize))},t}return a.__extends(t,e),t.prototype.render=function(){var e=this.checkIsSaveAllToCloudApplicable(this.props.attachmentWellViewState.imageViewAttachments)&&this.checkIsSaveAllToCloudApplicable(this.props.attachmentWellViewState.docViewAttachments),t=this.props.attachmentWellViewState.imageViewAttachments.length+this.props.attachmentWellViewState.docViewAttachments.length>1,n=R(L.barButton,L.barButtonHover);return g.createElement("span",null,this.shouldDisplaySaveAllToCloudButton(e)&&g.createElement(h.a,{className:n,onClick:this.onClickSaveToCloudButton},this.getSaveAllToCloudLabel(t)),this.shouldDisplayStatusLabel()&&g.createElement(h.a,{className:n,disabled:!0},this.getSaveAllToCloudStatusLabel(t)),this.shouldDisplayCancelButton()&&g.createElement(h.a,{className:n,onClick:this.onClickCancelButton},u.a.CancelText))},t.prototype.shouldDisplaySaveAllToCloudButton=function(e){return e&&0===this.props.attachmentWellViewState.saveAllToCloudStatus},t.prototype.getSaveAllToCloudLabel=function(e){var t=Object(x.c)("doc-consumerUrl"),n=this.props.parentItemId.mailboxInfo.type===r.a.GroupMailbox;if(t)return e?u.a.SaveAllFilesToOneDriveConsumerText:u.a.SaveOneFileToOneDriveConsumerText;if(n)return e?u.a.SaveAllFilesToGroupFilesText:u.a.SaveOneFileToGroupFilesText;var a=e?u.a.SaveAllFilesToOneDriveText:u.a.SaveOneFileToOneDriveText;return Object(s.format)(a,Object(C.f)())},t.prototype.checkIsSaveAllToCloudApplicable=function(e){return e.every(_.p)},t.prototype.shouldDisplayStatusLabel=function(){var e=this.props.attachmentWellViewState.saveAllToCloudStatus;return 1===e||3===e||2===e||4===e},t.prototype.getSaveAllToCloudStatusLabel=function(e){return function(e,t,n){var a=Object(x.c)("doc-consumerUrl"),r=u.a.ConsumerDefaultSaveToCloudLocationText;switch(n){case 1:return a?Object(s.format)(e?u.a.SavingAllFilesToOneDriveConsumerPrefixText:u.a.SavingOneFileToOneDriveConsumerText,Object(C.f)(),r):t?e?u.a.SavingAllFilesToGroupFilesText:u.a.SavingOneFileToGroupFilesText:Object(s.format)(e?u.a.SavingAllFilesToOneDrivePrefixText:u.a.SavingOneFileToOneDriveText,u.a.OneDriveText);case 3:return t?e?u.a.FailedToSaveMultipleFilesToGroupFilesText:u.a.FailedToSaveFileToGroupFilesText:Object(s.format)(e?u.a.FailedToSaveMultipleFilesToOneDriveText:u.a.FailedToSaveFileToOneDriveText,a?r:u.a.OneDriveText);case 2:return t?e?u.a.SavedAllFilesToGroupFilesText:u.a.SavedOneFileToGroupFilesText:Object(s.format)(e?u.a.SavedAllFilesToOneDrivePrefixText:u.a.SavedOneFileToOneDriveText,a?r:u.a.OneDriveText);case 4:return u.a.CanceledSaveToOneDriveText;case 0:throw new Error("Unsupported SaveAllToCloudStatus: "+n);default:return Object(A.a)(n),""}}(e,this.props.parentItemId.mailboxInfo.type===r.a.GroupMailbox,this.props.attachmentWellViewState.saveAllToCloudStatus)},t.prototype.shouldDisplayCancelButton=function(){return 1===this.props.attachmentWellViewState.saveAllToCloudStatus},t=a.__decorate([m.observer],t)}(g.Component),B="service.svc/s/GetAllAttachmentsAsZip?id=",W=n(595),U=n(1267),z=n(657),H=n(192),G=n(7),q=n(3204),Q=n(90).bind(q),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickDownloadButton=function(e){var n=t.props.attachmentWellViewState.docViewAttachments.length>0?t.props.attachmentWellViewState.docViewAttachments[0]:t.props.attachmentWellViewState.imageViewAttachments[0],a=Object(W.a)(n.attachmentId);Object(U.a)(a.download.url,n.isCloudy);var r=O.Download.datapoint,i=r.name,o=r.customData;Object(y.n)(i,o(n.isCloudy))},t.onClickDownloadAllButton=function(e){var n=B+encodeURIComponent(t.props.parentItemId.Id),a=""+z.a+n+"&X-OWA-CANARY="+Object(H.getOwaCanaryCookie)();Object(U.a)(a,!1);var r=O.DownloadAll.datapoint,i=r.name,o=r.customData;Object(y.n)(i,o(t.props.attachmentWellViewState.docViewAttachments.length+t.props.attachmentWellViewState.imageViewAttachments.length,t.props.attachmentWellViewState.totalClassicAttachmentSize))},t}return a.__extends(t,e),t.prototype.render=function(){var e=this.props.attachmentWellViewState.imageViewAttachments.length+this.props.attachmentWellViewState.docViewAttachments.length>1;this.referentAttachmentsCount=0,this.classicAttachmentCount=0,this.downloadAllowed=!0,this.getDownloadInfo(this.props.attachmentWellViewState.imageViewAttachments),this.getDownloadInfo(this.props.attachmentWellViewState.docViewAttachments);var t=this.downloadAllowed&&(1===this.classicAttachmentCount&&0===this.referentAttachmentsCount||0===this.classicAttachmentCount&&1===this.referentAttachmentsCount),n=this.downloadAllowed&&this.classicAttachmentCount>1&&0===this.referentAttachmentsCount;return g.createElement("span",{className:q.attachmentWellBar},e&&g.createElement(S,{attachmentWellViewState:this.props.attachmentWellViewState,previewPaneAttachmentId:this.props.previewPaneAttachmentId}),t&&g.createElement(h.a,{className:Q(q.barButton,q.barButtonHover),onClick:this.onClickDownloadButton},u.a.downloadText),n&&g.createElement(h.a,{className:Q(q.barButton,q.barButtonHover),onClick:this.onClickDownloadAllButton},u.a.downloadAllText),g.createElement(N,{attachmentWellViewState:this.props.attachmentWellViewState,parentItemId:this.props.parentItemId}))},t.prototype.getDownloadInfo=function(e){for(var t,n=0;n<e.length;n++){t=e[n];var a=Object(W.a)(t.attachmentId);if(a&&a.info&&a.info.allowDownload||(this.downloadAllowed=!1,a||this.props.isDraft||G.c.error("The model for attachment "+t.attachmentId.Id+" could not be found")),!this.downloadAllowed)break;t.isCloudy?this.referentAttachmentsCount++:this.classicAttachmentCount++}},t=a.__decorate([m.observer],t)}(g.Component),Y=n(3205),Z=n(520),X=n(2916),K=Object(p.action)("setDidViewOverflowOneRow")(function(e,t){e.didViewOverflowOneRow=t}),$=n(2957),ee=n(3745),te=n(3324),ne=n(114),ae=n(34),re=n(688),ie=n(519),oe=n(256),ce=500;function se(){return oe.a.state&&oe.a.state.attachmentId}var le=n(246),ue=n(173),de=n(348),me=re.a,he=n(679),pe=n(339),fe=500;var ve=n(1378),ge=n(5005),be=n(90).bind(ge),we=function(e){function t(t){var n=e.call(this,t)||this;return n.onDeleteAttachment=function(e){var t=n.props.attachmentWellViewState.imageViewAttachments.slice(0),a=n.props.attachmentWellViewState.docViewAttachments.slice(0);Object(X.b)(n.props.attachmentWellViewState,e,n.props.parentItemId,n.props.infoBarAddHandler,n.props.infoBarRemoveHandler,n.props.onAttachmentDeletedCallback),n.previewNextAttachmentOrClosePreview(e,t,a)},n.replaceAttachmentHandler=function(e,t,a,r){Object(ee.a)(n.props.attachmentWellViewState,e,t,a,r,n.props.parentItemId,n.props.infoBarAddHandler,n.props.infoBarRemoveHandler)},n.onClickAttachmentWell=function(e){e.stopPropagation()},n.getImageAttachmentWellDiv=function(e){n.imageAttachmentWellDiv=e},n.getDocAttachmentWellDiv=function(e){n.docAttachmentWellDiv=e},n.onBeforePreviewAttachment=function(){v(n.props.attachmentWellViewState,!0)},n.onAfterPreviewAttachment=function(){Object(te.b)(n.props.attachmentWellViewState,n.props.parentItemId)},n.createImageGallery=function(){return a.__awaiter(n,void 0,void 0,function(){return a.__generator(this,function(e){return[2,Object(te.a)(this.props.attachmentWellViewState)]})})},n.InternalCheckWhetherViewOverFlowOneRow=function(){K(n.props.attachmentWellViewState,n.didViewOverflowOneRow(n.imageAttachmentWellDiv)||n.didViewOverflowOneRow(n.docAttachmentWellDiv))},n.getAttachmentDragData=function(e){var t=Object($.a)(e);return{itemType:ne.a.Attachment,attachmentFile:t}},n}return a.__extends(t,e),t.prototype.componentDidUpdate=function(){this.checkWhetherViewOverFlowOneRow(),!this.props.attachmentWellViewState.isReadOnly&&this.props.parentItemId&&Object(te.b)(this.props.attachmentWellViewState,this.props.parentItemId)},t.prototype.componentDidMount=function(){this.checkWhetherViewOverFlowOneRow(),le.b.importAndExecute(this.InternalCheckWhetherViewOverFlowOneRow)},t.prototype.componentWillUnmount=function(){le.d.importAndExecute(this.InternalCheckWhetherViewOverFlowOneRow)},t.prototype.render=function(){var e=this,t={attachmentWellInCompose:!this.props.attachmentWellViewState.isReadOnly};if(this.props.attachmentWellViewState.imageViewAttachments.length+this.props.attachmentWellViewState.docViewAttachments.length===0)return null;var n={allowShowMultipleRows:this.getAllowShowMultipleRows()};return g.createElement("div",{tabIndex:0,"aria-label":this.getAriaLabel(),className:be([ge.attachmentWell,t,"disableTextSelection"]),onClick:this.onClickAttachmentWell},this.props.attachmentWellViewState.imageViewAttachments.length>0?g.createElement("div",{className:be(ge.oneRowImageViews,n),ref:this.getImageAttachmentWellDiv},this.props.attachmentWellViewState.imageViewAttachments.map(function(t){return g.createElement(Y.a,{key:t.attachmentId.Id,attachmentViewState:t,onDeleteButtonClicked:e.onDeleteAttachment,onReplaceAttachment:e.replaceAttachmentHandler,onDragStart:e.getAttachmentDragData,instrumentationContext:e.props.instrumentationContext,onAfterPreview:e.onAfterPreviewAttachment,onBeforePreview:e.onBeforePreviewAttachment,isImage:!0,parentItemId:e.props.parentItemId,isDraft:e.props.isDraft,previewMode:e.getAttachmentPreviewMode(t.attachmentId),moveAttachmentToInlineHandler:e.props.moveAttachmentToInlineHandler,createImageGallery:e.createImageGallery})})):null,this.props.attachmentWellViewState.docViewAttachments.length>0?g.createElement("div",{className:be(ge.oneRowDocViews,n),ref:this.getDocAttachmentWellDiv},this.props.attachmentWellViewState.docViewAttachments.map(function(t){return g.createElement(Y.a,{key:t.attachmentId.Id,attachmentViewState:t,onDeleteButtonClicked:e.onDeleteAttachment,onReplaceAttachment:e.replaceAttachmentHandler,onDragStart:e.getAttachmentDragData,instrumentationContext:e.props.instrumentationContext,onAfterPreview:e.onAfterPreviewAttachment,onBeforePreview:e.onBeforePreviewAttachment,isImage:!1,parentItemId:e.props.parentItemId,isDraft:e.props.isDraft,previewMode:e.getAttachmentPreviewMode(t.attachmentId),createImageGallery:e.createImageGallery})})):null,this.props.attachmentWellViewState.isReadOnly&&this.props.attachmentWellViewState.imageViewAttachments.length+this.props.attachmentWellViewState.docViewAttachments.length>0?g.createElement(J,{attachmentWellViewState:this.props.attachmentWellViewState,parentItemId:this.props.parentItemId,previewPaneAttachmentId:this.props.previewPaneAttachmentId,isDraft:this.props.isDraft}):null)},t.prototype.previewNextAttachmentOrClosePreview=function(e,t,n){return a.__awaiter(this,void 0,void 0,function(){var r,i;return a.__generator(this,function(a){switch(a.label){case 0:return this.getAttachmentPreviewMode(e.attachmentId)!==re.a.None&&se()===e.attachmentId&&(r=t.indexOf(e),i=n.indexOf(e),r>-1?t.splice(r,1):n.splice(i,1),t.length+n.length===0?ae.q.importAndExecute("deleteAttachment"):(e=this.getNextAttachmentViewState(t,n,r,i),Object(Z.c)(e,Z.a.ReadingPane,this.props.instrumentationContext,this.props.parentItemId,this.props.isDraft,this.onBeforePreviewAttachment,this.onAfterPreviewAttachment,this.createImageGallery))),Object(ue.i)(e.attachmentId)?[4,ue.o.import()]:[3,2];case 1:a.sent()("deleteAttachment"),a.label=2;case 2:return[2]}})})},t.prototype.getNextAttachmentViewState=function(e,t,n,a){return n>-1?0===e.length?t[0]:n<e.length?e[n]:e[n-1]:0===t.length?e[e.length-1]:a<t.length?t[a]:t[a-1]},t.prototype.getAllowShowMultipleRows=function(){return o(this.props.attachmentWellViewState,this.props.previewPaneAttachmentId)},t.prototype.checkWhetherViewOverFlowOneRow=function(){setTimeout(this.InternalCheckWhetherViewOverFlowOneRow,0)},t.prototype.didViewOverflowOneRow=function(e){return!!e&&e.children.length>0&&e.scrollHeight>2*e.children[0].clientHeight},t.prototype.getAriaLabel=function(){var e=this.props.attachmentWellViewState.imageViewAttachments.length+this.props.attachmentWellViewState.docViewAttachments.length;return e>1?Object(s.format)(u.a.NAttachments,e):Object(s.format)(u.a.OneAttachment,e)},t.prototype.getAttachmentPreviewMode=function(e){return function(e){if(Object(r.c)(oe.a.pendingNavigationAttachmentId,e)&&oe.a.pendingNavigationTime+ce>=(new Date).getTime())return re.a.PendingNavigation;if(!oe.a.state)return re.a.None;var t=oe.a.state.mode===ie.a.Saving&&oe.a.pendingState&&oe.a.pendingState.attachmentId||oe.a.state.attachmentId,n=oe.a.state.savingAttachmentId;return oe.a.state.mode===ie.a.Edit&&Object(r.c)(t,e)?re.a.Edit:oe.a.state.mode===ie.a.Saving?Object(r.c)(t,e)&&Object(r.c)(n,e)?re.a.SelectedAndSaving:Object(r.c)(t,e)&&!Object(r.c)(n,e)?re.a.SelectedAndPending:!Object(r.c)(t,e)&&Object(r.c)(n,e)?re.a.NotSelectedAndSaving:re.a.OtherSaving:Object(r.c)(t,e)?re.a.Selected:re.a.None}(e)||function(e){if(pe.a.pendingNavigation&&Object(r.c)(pe.a.pendingNavigation.toAttachmentId,e)&&pe.a.pendingNavigation.triggerTime+fe>=(new Date).getTime())return me.PendingNavigation;if(!Object(de.a)())return me.None;var t=pe.a.extendedViewState.attachmentId,n=pe.a.pendingPreviewOperation&&pe.a.pendingPreviewOperation.attachmentId;return Object(r.c)(t,e)?pe.a.editState.mode===he.a.View||pe.a.editState.mode===he.a.EnteringEdit?me.Selected:pe.a.editState.mode===he.a.Saving?Object(r.c)(n,e)?me.SelectedAndSaving:me.NotSelectedAndSaving:me.Edit:Object(r.c)(n,e)?me.SelectedAndPending:me.None}(e)},t=a.__decorate([Object(ve.reactive)({previewPaneAttachmentId:function(){return se()}}),Object(y.j)("AttachmentWellView")],t)}(g.Component),Ie="{0}; ";var Se=n(3086),Oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=this.props.attachmentWellViewState;if(e.imageViewAttachments.length+e.docViewAttachments.length===0)return null;var t,a,r=n(5007);return g.createElement("div",{className:Se.panel},g.createElement("div",null,g.createElement("img",{src:r,className:Se.attachIcon}),g.createElement("span",{className:Se.attachmentCountLabel},d(e,!1,!1))),g.createElement("div",{className:Se.attachmentCollectionContainer},g.createElement("span",{className:Se.attachmentCollectionLabel},(a="",(t=e).docViewAttachments.concat(t.imageViewAttachments).forEach(function(e){var t=Object(W.a)(e.attachmentId);t&&(a+=Object(s.format)(Ie,t.model.Name))}),a))))},t}(g.Component);n.d(t,"AttachmentWellView",function(){return we}),n.d(t,"AttachmentWellPrintView",function(){return Oe})},3745:function(e,t,n){"use strict";var a=n(0),r=n(2789),i=n(2790),o=n(7),c=n(4),s=Object(c.action)("replaceAttachmentInWell")(function(e,t,n,a,c,s,l){var u=e.docViewAttachments.indexOf(t);u>-1?(Object(i.a)(e,t,c,s,l),e.docViewAttachments.splice(u,0,n)):(u=e.imageViewAttachments.indexOf(t))>-1?(Object(i.a)(e,t,c,s,l),e.imageViewAttachments.splice(u,0,n)):o.c.error("Can't find the oldAttachment when invoking replaceAttachmentInWell"),n.isCloudy||Object(r.a)(e,a)}),l=n(2093);function u(e,t,n,r,i,o,c,u){var d=Object(l.g)(a.__assign({},n.AttachmentId,{mailboxInfo:t.attachmentId.mailboxInfo}),n,r,i,!0);s(e,t,d,n.Size,o,c,u)}n.d(t,"a",function(){return u})},3750:function(e,t,n){"use strict";var a=n(2642),r=n(1215),i=n(9),o=n(136),c=n(595),s=n(4),l=Object(s.action)("setAttachmentPermissionLevel")(function(e,t){Object(c.a)(e).model.PermissionType=t}),u=n(2272);function d(e,t,n,c){Object(o.b)("doc-attachment-sharingTips")&&n&&Object(u.g)(n)&&0===e.attachmentType&&(n.CanShareInternally||Object(u.f)(t.PermissionType)||(Object(i.n)(r.a.AttachmentsCanNotShareInternally.datapoint.name),l(e.attachmentId,0)),Object(a.a)(c.attachmentWellViewState,c.parentItemId,c.infoBarAddHandler,c.infoBarRemoveHandler))}n.d(t,"a",function(){return d})},3784:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),r=n(3356);t.default=function(e,t){return void 0===e.requestObject||e.requestObject.__type||(e.requestObject=r.default(e.requestObject)),a.makeServiceRequest("ConvertLocalToRefAttachment",e,t)}},3785:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),r=n(3357);t.default=function(e,t){return void 0===e||e.__type||(e=r.default(e)),a.makeServiceRequest("CancelConvertLocalToRefAttachment",e,t)}},3786:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),r=n(3359);t.default=function(e,t){return void 0===e.requestObject||e.requestObject.__type||(e.requestObject=r.default(e.requestObject)),a.makeServiceRequest("ConvertRefToLocalAttachment",e,t)}},3787:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),r=n(3360);t.default=function(e,t){return void 0===e||e.__type||(e=r.default(e)),a.makeServiceRequest("CancelConvertRefToLocalAttachment",e,t)}},3788:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),r=n(152);t.default=function(e,t){return void 0===e.itemId||e.itemId.__type||(e.itemId=r.default(e.itemId)),a.makeServiceRequest("CreateAttachmentFromAttachmentDataProvider",e,t)}},3789:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),r=n(152);t.default=function(e,t){return void 0===e.itemId||e.itemId.__type||(e.itemId=r.default(e.itemId)),a.makeServiceRequest("CreateAttachmentFromUri",e,t)}},379:function(e,t,n){"use strict";function a(){var e=window.location.pathname;"/"===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1));var t=e.lastIndexOf("/");return-1===t?e:e.substr(t+1)}n.d(t,"a",function(){return a})},3790:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),r=n(152);t.default=function(e,t){return void 0===e.itemId||e.itemId.__type||(e.itemId=r.default(e.itemId)),a.makeServiceRequest("CreateReferenceAttachmentFromAttachmentDataProvider",e,t)}},3791:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"CreateReferenceAttachmentFromLocalFileRequest:#Exchange"},e)}},3792:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"DeleteAttachmentRequest:#Exchange"},e)}},3793:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),r=n(3794);t.default=function(e,t){return void 0===e||e.__type||(e=r.default(e)),a.makeServiceRequest("DeleteAttachment",e,t)}},3794:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"DeleteAttachmentJsonRequest:#Exchange"},e)}},3795:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38);t.default=function(e,t){return a.makeServiceRequest("CancelAttachment",e,t)}},389:function(e,t,n){"use strict";var a=n(0);var r={AttachmentRefreshDownloadToken:{datapoint:{name:"AttachmentRefreshDownloadToken",customData:function(e){return[e]}}}},i=n(943),o=n.n(i),c=n(6),s=n(9),l=n(93),u=n(8),d=n(18),m=n(7);n.d(t,"a",function(){return f}),n.d(t,"c",function(){return v}),n.d(t,"b",function(){return g});var h=function(e){var t;void 0===e&&(e={}),(t=e).timeBetweenRetryInMS=t.timeBetweenRetryInMS||function(){return 6e4};var n=e.maximumAttempts,a=e.timeBetweenRetryInMS;return function(e){var t=0,r=!1,i=function(o,c){r?c(new Error("The function retry was cancelled")):(t++,e().then(o).catch(function(e){n&&t>=n?c(e):setTimeout(function(){return i(o,c)},a(t))}))};return{retriableFunc:function(){return new Promise(function(e,t){return i(e,t)})},cancel:function(){return r=!0}}}}({timeBetweenRetryInMS:function(){return 3e4}}),p=function(){function e(e,t,n,i){var c=this;this.downloadTokenRefreshMinutes=e,this.downloadUrlBase=t,this.mailboxAddress=n,this.refreshDownloadTokenAndRetryInCaseOfFailure=function(){return a.__awaiter(c,void 0,void 0,function(){var e,t,n,i,c=this;return a.__generator(this,function(l){switch(l.label){case 0:if(this.isRefreshingDownloadToken)return[3,4];this.isRefreshingDownloadToken=!0,e=0,t=h(function(){return a.__awaiter(c,void 0,void 0,function(){var t;return a.__generator(this,function(n){switch(n.label){case 0:return e++,t=this,[4,function(){return a.__awaiter(this,void 0,void 0,function(){var e;return a.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,o()()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),m.c.warn("Unable to get the download token "+e),e;case 3:return[2]}})})}()];case 1:return t.downloadToken=n.sent(),this.isRefreshingDownloadToken=!1,[2]}})})}).retriableFunc,n=new s.d(r.AttachmentRefreshDownloadToken.datapoint.name),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,t()];case 2:return l.sent(),n.addCustomData(r.AttachmentRefreshDownloadToken.datapoint.customData(e)),n.end(),[3,4];case 3:return i=l.sent(),m.c.warn("Retry to refresh token failed: "+i),n.addCustomData(r.AttachmentRefreshDownloadToken.datapoint.customData(e)),n.endWithError(s.a.ServerError,i),this.isRefreshingDownloadToken=!1,[3,4];case 4:return[2]}})})},this.useDownloadUrlBase=!Object(d.isStringNullOrWhiteSpace)(this.downloadUrlBase)&&!Object(d.isStringNullOrWhiteSpace)(this.mailboxAddress)&&Object(u.c)("doc-attachment-downloadDomain"),this.downloadToken=i,this.downloadTokenRefreshMinutes<1&&(this.downloadTokenRefreshMinutes=1),this.useDownloadUrlBase&&setInterval(this.refreshDownloadTokenAndRetryInCaseOfFailure,6e4*this.downloadTokenRefreshMinutes)}return e.getInstance=function(){if(!e.instance){var t=Object(c.a)(),n=Object(l.b)().mailboxId,a=t.ApplicationSettings;e.instance=new e(a.DownloadTokenRefreshMinutes,a.DownloadUrlBase,n,a.FirstDownloadToken)}return e.instance},e.resetInstanceForTesting=function(){e.instance=null},e.prototype.getDownloadToken=function(){return this.downloadToken},e.prototype.getUseDownloadUrlBase=function(){return this.useDownloadUrlBase},e.prototype.getDownloadUrlBase=function(){return this.downloadUrlBase},e}();function f(){return p.getInstance().getDownloadToken()}function v(){return p.getInstance().getUseDownloadUrlBase()}function g(){return p.getInstance().getDownloadUrlBase()}},390:function(e,t,n){"use strict";var a=n(939);n.d(t,"a",function(){return a.a}),n.d(t,"b",function(){return a.b});var r=n(389);n.d(t,"c",function(){return r.a})},4877:function(e,t,n){var a=n(4878),r=n(33);"string"==typeof a&&(a=[[e.i,a]]);for(var i=0;i<a.length;i++)r.loadStyles(a[i][1],!1);a.locals&&(e.exports=a.locals)},4878:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'._2-8rlQ6CJlrwqI3Ou8QsXl,.V4gpD9ZLeKbtsa5_NZ_c0{width:32px;height:32px;display:inline-block}html[dir] ._2-8rlQ6CJlrwqI3Ou8QsXl,html[dir] .V4gpD9ZLeKbtsa5_NZ_c0{background-color:transparent}.V4gpD9ZLeKbtsa5_NZ_c0{width:16px;height:16px}html[dir] ._2bipkeIVe-p0gWUWncbxXz{margin:10px 8px}._3H7Q0RVTz0HQPHzgKmmWqd{color:#094ab2;font-size:24pt}._3b8Bd-OFVlLdXwE-yIdspe{font-size:24pt;color:"[theme:themePrimary, default:#0078D7]"}',""]),t.locals={icon:"_2-8rlQ6CJlrwqI3Ou8QsXl",extraSmallIcon:"V4gpD9ZLeKbtsa5_NZ_c0",iconDefault:"_2bipkeIVe-p0gWUWncbxXz",oneDriveIcon:"_3H7Q0RVTz0HQPHzgKmmWqd",cloudIcon:"_3b8Bd-OFVlLdXwE-yIdspe"}},4879:function(e,t,n){var a=n(4880),r=n(33);"string"==typeof a&&(a=[[e.i,a]]);for(var i=0;i<a.length;i++)r.loadStyles(a[i][1],!1);a.locals&&(e.exports=a.locals)},4880:function(e,t,n){var a=n(871);(t=e.exports=n(35)(!1)).push([e.i,"html[dir] ._3VQ6HMjQG7Ti6QnRycJ9t2{background-image:url("+a(n(2171))+");background-position:-33px 0;width:32px;height:32px}html[dir] .j4gRRarv6B_KdCECzqs-Y{background-image:url("+a(n(2171))+");background-position:0 -99px;width:32px;height:32px}html[dir] ._1KlpBWistjgkehdUPa1t2A{background-image:url("+a(n(2171))+");background-position:0 -33px;width:32px;height:32px}html[dir] .FLgA15AuTAOXzH9vZP4Ay{background-image:url("+a(n(2171))+");background-position:-33px -33px;width:32px;height:32px}html[dir] ._22PsSgNdHqaTH2A5CWtMT6{background-position:-66px 0}html[dir] ._22PsSgNdHqaTH2A5CWtMT6,html[dir] ._32z8gkA_jrpKtmsXQPJkdr{background-image:url("+a(n(2171))+");width:32px;height:32px}html[dir] ._32z8gkA_jrpKtmsXQPJkdr{background-position:-66px -33px}html[dir] ._3ixi7qZEiPsuWLoKEM0qi9{background-position:0 -66px}html[dir] ._1xku_YiOsPPA2d9qpJ-V6v,html[dir] ._3ixi7qZEiPsuWLoKEM0qi9{background-image:url("+a(n(2171))+");width:32px;height:32px}html[dir] ._1xku_YiOsPPA2d9qpJ-V6v{background-position:-33px -66px}html[dir] ._3vNfS3i5ylenFgYHLjvhaR{background-image:url("+a(n(2171))+");background-position:-66px -66px;width:32px;height:32px}html[dir] ._2uYOK1nA1MVGoJ3CTDhsu4{background-image:url("+a(n(2171))+");background-position:-99px 0;width:32px;height:32px}html[dir] ._2etj2o59VBb5VoWVHQj9BD{background-image:url("+a(n(2171))+");background-position:-99px -66px;width:32px;height:32px}html[dir] .P0i45FrgbgcxxVjq1bHUz{background-image:url("+a(n(2171))+");background-position:-99px -33px;width:32px;height:32px}html[dir] .iiEoJaQy8sKxwaebmW4Tg{background-position:0 0}html[dir] .IB9CH94AtmU7Ku0AdgHeT,html[dir] .iiEoJaQy8sKxwaebmW4Tg{background-image:url("+a(n(2171))+");width:32px;height:32px}html[dir] .IB9CH94AtmU7Ku0AdgHeT{background-position:-33px -99px}html[dir] .hNANL9LSspmkpxWGNTi5S{background-image:url("+a(n(2171))+");background-position:-66px -99px;width:32px;height:32px}html[dir] ._1RJ2MjeVZ25Mnv6oOS6OP9{background-image:url("+a(n(2171))+");background-position:-99px -99px;width:32px;height:32px}html[dir] ._3Z-JZO7qhANJ_R_zqmSEQx{background-image:url("+a(n(2171))+");background-position:-132px 0;width:32px;height:32px}html[dir] ._1_3_PjiMDmq7uVOaJT5Xl8{background-image:url("+a(n(2171))+");background-position:-132px -33px;width:32px;height:32px}html[dir] ._3H60k6xOkGBfogrW7uWtDD{background-image:url("+a(n(2171))+");background-position:-132px -66px;width:32px;height:32px}html[dir] ._2S0pGOUJLdcEPIi1mGM42G{background-position:-132px -99px}html[dir] ._2S0pGOUJLdcEPIi1mGM42G,html[dir] ._2wnm6ccMKlpkxnKVyVqDl6{background-image:url("+a(n(2171))+");width:32px;height:32px}html[dir] ._2wnm6ccMKlpkxnKVyVqDl6{background-position:0 -132px}html[dir] .jjYr5iKH2DPANg8OOsNXw{background-position:-33px -132px}html[dir] ._2qwjxn3aIZT5O6MYxb6nbc,html[dir] .jjYr5iKH2DPANg8OOsNXw{background-image:url("+a(n(2171))+");width:32px;height:32px}html[dir] ._2qwjxn3aIZT5O6MYxb6nbc{background-position:-66px -132px}html[dir] ._1pRDKlXEblT-YWQEggZuXO{background-image:url("+a(n(2171))+");background-position:-99px -132px;width:32px;height:32px}",""]),t.locals={"attachment-icon-accdb_32x32":"_3VQ6HMjQG7Ti6QnRycJ9t2","attachment-icon-audio_32x32":"j4gRRarv6B_KdCECzqs-Y","attachment-icon-blockedfile_32x32":"_1KlpBWistjgkehdUPa1t2A","attachment-icon-calendar_32x32":"FLgA15AuTAOXzH9vZP4Ay","attachment-icon-code_32x32":"_22PsSgNdHqaTH2A5CWtMT6","attachment-icon-docx_32x32":"_32z8gkA_jrpKtmsXQPJkdr","attachment-icon-email_32x32":"_3ixi7qZEiPsuWLoKEM0qi9","attachment-icon-exe_32x32":"_1xku_YiOsPPA2d9qpJ-V6v","attachment-icon-generic_32x32":"_3vNfS3i5ylenFgYHLjvhaR","attachment-icon-infopath_32x32":"_2uYOK1nA1MVGoJ3CTDhsu4","attachment-icon-one_32x32":"_2etj2o59VBb5VoWVHQj9BD","attachment-icon-onetoc_32x32":"P0i45FrgbgcxxVjq1bHUz","attachment-icon-pblsh_32x32":"iiEoJaQy8sKxwaebmW4Tg","attachment-icon-pdf_32x32":"IB9CH94AtmU7Ku0AdgHeT","attachment-icon-photo_32x32":"hNANL9LSspmkpxWGNTi5S","attachment-icon-pptx_32x32":"_1RJ2MjeVZ25Mnv6oOS6OP9","attachment-icon-project_32x32":"_3Z-JZO7qhANJ_R_zqmSEQx","attachment-icon-rpmsg_32x32":"_1_3_PjiMDmq7uVOaJT5Xl8","attachment-icon-sharedfolder_32x32":"_3H60k6xOkGBfogrW7uWtDD","attachment-icon-txt_32x32":"_2S0pGOUJLdcEPIi1mGM42G","attachment-icon-video_32x32":"_2wnm6ccMKlpkxnKVyVqDl6","attachment-icon-vsdx_32x32":"jjYr5iKH2DPANg8OOsNXw","attachment-icon-xlsx_32x32":"_2qwjxn3aIZT5O6MYxb6nbc","attachment-icon-zip_32x32":"_1pRDKlXEblT-YWQEggZuXO"}},4881:function(e,t,n){var a=n(4882),r=n(33);"string"==typeof a&&(a=[[e.i,a]]);for(var i=0;i<a.length;i++)r.loadStyles(a[i][1],!1);a.locals&&(e.exports=a.locals)},4882:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'._1UYtUXHqml5LbZvFZJDD3O{overflow:hidden;text-overflow:ellipsis}.UVPNAPBbD1ncSbsdu1Uk1{color:"[theme:neutralPrimary, default:#333333]"}._2ApV9Y4la0QNF8Mlox0gM8{color:"[theme:neutralSecondary, default:#666666]"}',""]),t.locals={textOverFlow:"_1UYtUXHqml5LbZvFZJDD3O",firstLineCommonStyle:"UVPNAPBbD1ncSbsdu1Uk1",secondLineCommonStyle:"_2ApV9Y4la0QNF8Mlox0gM8"}},4883:function(e,t,n){var a=n(4884),r=n(33);"string"==typeof a&&(a=[[e.i,a]]);for(var i=0;i<a.length;i++)r.loadStyles(a[i][1],!1);a.locals&&(e.exports=a.locals)},4884:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,".CMv6-KDYqpKI2peJ2DGPA{-o-object-fit:cover;object-fit:cover}html[dir] .CMv6-KDYqpKI2peJ2DGPA{border-radius:2px}.oyVoDb0ugtYY4wnX-0Mev{position:relative}._2gfW_daOxT2IOx-huPwrIK{position:absolute}._2gfW_daOxT2IOx-huPwrIK,._2IZ5LtER1t-SQoMRKBzbZb{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={thumbnail:"CMv6-KDYqpKI2peJ2DGPA",spanContainer:"oyVoDb0ugtYY4wnX-0Mev",notLoadedContainer:"_2gfW_daOxT2IOx-huPwrIK",errorLoadingContainer:"_2IZ5LtER1t-SQoMRKBzbZb"}},5001:function(e,t,n){var a=n(5002),r=n(33);"string"==typeof a&&(a=[[e.i,a]]);for(var i=0;i<a.length;i++)r.loadStyles(a[i][1],!1);a.locals&&(e.exports=a.locals)},5002:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'.T-Zsw6L-3X5szUp8jwmD8{font-size:14px;color:"[theme:themePrimary, default:#0078D7]"}html[dir=ltr] .T-Zsw6L-3X5szUp8jwmD8{margin-left:2px}html[dir=rtl] .T-Zsw6L-3X5szUp8jwmD8{margin-right:2px}',""]),t.locals={chevronButton:"T-Zsw6L-3X5szUp8jwmD8"}},5003:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'._2PL31YmvsghnW3Tbhhp2t2{top:-11px;position:relative}._2evssWbmjz7AcMyhaGahVG{font-size:11px;font-weight:400;color:"[theme:neutralSecondary, default:#666666]"}html[dir] ._2evssWbmjz7AcMyhaGahVG{padding:0}html[dir=ltr] ._2evssWbmjz7AcMyhaGahVG{margin-right:6px}html[dir=rtl] ._2evssWbmjz7AcMyhaGahVG{margin-left:6px}.f7E2uJiJ4087XNokXYbxv:hover{color:"[theme:themePrimary, default:#0078D7]"}',""]),t.locals={attachmentWellBar:"_2PL31YmvsghnW3Tbhhp2t2",barButton:"_2evssWbmjz7AcMyhaGahVG",barButtonHover:"f7E2uJiJ4087XNokXYbxv"}},5004:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38);t.default=function(e,t){return a.makeServiceRequest("CancelSaveAttachmentsToCloud",e,t)}},5005:function(e,t,n){var a=n(5006),r=n(33);"string"==typeof a&&(a=[[e.i,a]]);for(var i=0;i<a.length;i++)r.loadStyles(a[i][1],!1);a.locals&&(e.exports=a.locals)},5006:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'html[dir] ._1ETkH52yULsphm-ntd40Oj{margin-top:10px}html[dir] ._1n1rdzUnwtYIviHfyLQAJM{margin-bottom:10px;border-bottom:1px solid "[theme:neutralLight, default:#eaeaea]"}.nwTfzYyYNdP5IQGAlhyuL{width:100%;height:133px;overflow:hidden}._2jilAFTYamk4d4eN4g2zHo{width:100%;height:65px;overflow:hidden}._1Gp8V3SnK4KP6jlGtpR4h0{height:auto}',""]),t.locals={attachmentWell:"_1ETkH52yULsphm-ntd40Oj",attachmentWellInCompose:"_1n1rdzUnwtYIviHfyLQAJM",oneRowImageViews:"nwTfzYyYNdP5IQGAlhyuL",oneRowDocViews:"_2jilAFTYamk4d4eN4g2zHo",allowShowMultipleRows:"_1Gp8V3SnK4KP6jlGtpR4h0"}},5007:function(e,t,n){e.exports=n.p+"../resources/images/attach-a96fefa7d0b2c6dd99bb7bc513cb2b71.svg"},5193:function(e,t,n){var a=n(5194),r=n(33);"string"==typeof a&&(a=[[e.i,a]]);for(var i=0;i<a.length;i++)r.loadStyles(a[i][1],!1);a.locals&&(e.exports=a.locals)},5194:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'._1zJZ2p4utBt3eqI2CFNS6J{width:33px}.GzoChqHSckTY5bKnNBSDi{font-size:14px;color:"[theme:neutralSecondary, default:#666666]";height:53px}html[dir] .GzoChqHSckTY5bKnNBSDi{text-align:center}._3UtvUFlElNPQwKWXaHhfkW,.GzoChqHSckTY5bKnNBSDi:hover{color:"[theme:neutralSecondary, default:#666666]"}._3UtvUFlElNPQwKWXaHhfkW{display:block;height:26px}._2vNZTTuXlZSHSlbiATLr7M{bottom:0;position:absolute;color:"[theme:white, default:#ffffff]";height:50px}html[dir=ltr] ._2vNZTTuXlZSHSlbiATLr7M{right:0}html[dir=rtl] ._2vNZTTuXlZSHSlbiATLr7M{left:0}._2vNZTTuXlZSHSlbiATLr7M:hover{color:"[theme:white, default:#ffffff]"}html[dir] ._2vNZTTuXlZSHSlbiATLr7M:hover{background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] ._2vNZTTuXlZSHSlbiATLr7M:hover{border-bottom-right-radius:2px}html[dir=rtl] ._2vNZTTuXlZSHSlbiATLr7M:hover{border-bottom-left-radius:2px}html[dir] .SYbQRiBTikbtGnmfOFlu3:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir=ltr] .SYbQRiBTikbtGnmfOFlu3:hover{border-bottom-right-radius:2px}html[dir=rtl] .SYbQRiBTikbtGnmfOFlu3:hover{border-bottom-left-radius:2px}html[dir] ._1bAILnx2GFUQlW5jOooSLU:hover,html[dir] ._2ekdWt-f4mqSY_8zVnRxS0:hover,html[dir] ._3vLT1kIzYd890RAORb9GxB:hover,html[dir] ._3wvITzUmFaNLV_oHxxi_Is:hover,html[dir] ._9p8U6VtJwbvNb3x-naA-r:hover,html[dir] .XeYpe1N-jiMQd2RkMGDM0:hover{background:"[theme:themeTertiary, default:#71AFE5]"}html[dir=ltr] ._1bAILnx2GFUQlW5jOooSLU:hover,html[dir=ltr] ._2ekdWt-f4mqSY_8zVnRxS0:hover,html[dir=ltr] ._3vLT1kIzYd890RAORb9GxB:hover,html[dir=ltr] ._3wvITzUmFaNLV_oHxxi_Is:hover,html[dir=ltr] ._9p8U6VtJwbvNb3x-naA-r:hover,html[dir=ltr] .XeYpe1N-jiMQd2RkMGDM0:hover{border-bottom-right-radius:2px}html[dir=rtl] ._1bAILnx2GFUQlW5jOooSLU:hover,html[dir=rtl] ._2ekdWt-f4mqSY_8zVnRxS0:hover,html[dir=rtl] ._3vLT1kIzYd890RAORb9GxB:hover,html[dir=rtl] ._3wvITzUmFaNLV_oHxxi_Is:hover,html[dir=rtl] ._9p8U6VtJwbvNb3x-naA-r:hover,html[dir=rtl] .XeYpe1N-jiMQd2RkMGDM0:hover{border-bottom-left-radius:2px}',""]),t.locals={button:"_1zJZ2p4utBt3eqI2CFNS6J",contextMenuButton:"GzoChqHSckTY5bKnNBSDi",contextMenuButtonForDocViewInCompose:"_3UtvUFlElNPQwKWXaHhfkW",contextMenuButtonForImageView:"_2vNZTTuXlZSHSlbiATLr7M",none:"SYbQRiBTikbtGnmfOFlu3",withBorder:"XeYpe1N-jiMQd2RkMGDM0",edit:"_3vLT1kIzYd890RAORb9GxB",selected:"_1bAILnx2GFUQlW5jOooSLU",selectedAndPending:"_9p8U6VtJwbvNb3x-naA-r",selectedAndSaving:"_2ekdWt-f4mqSY_8zVnRxS0",notSelectedAndSaving:"_3wvITzUmFaNLV_oHxxi_Is"}},5195:function(e,t,n){var a=n(5196),r=n(33);"string"==typeof a&&(a=[[e.i,a]]);for(var i=0;i<a.length;i++)r.loadStyles(a[i][1],!1);a.locals&&(e.exports=a.locals)},5196:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'._3MBhxLp2OiM0Y21PPmFC8N{width:32px;height:100%;position:absolute;top:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}html[dir=ltr] ._3MBhxLp2OiM0Y21PPmFC8N{right:0}html[dir=rtl] ._3MBhxLp2OiM0Y21PPmFC8N{left:0}.m0Fz5fnM6nwx8USzV9prQ{width:33px;color:"[theme:neutralSecondary, default:#666666]";font-size:17px;height:26px}html[dir] .m0Fz5fnM6nwx8USzV9prQ{text-align:center}.m0Fz5fnM6nwx8USzV9prQ:hover{width:32px;color:"[theme:neutralSecondary, default:#666666]"}._2bbVvIsFeHMVeGsLZN6i-U{width:32px}._2bbVvIsFeHMVeGsLZN6i-U,._2bbVvIsFeHMVeGsLZN6i-U:hover{color:"[theme:white, default:#ffffff]"}html[dir] ._2bbVvIsFeHMVeGsLZN6i-U:hover{background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir] ._2goKIZ4hcxVfTIdL39mNae:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._1JZFDfyFIcLBxIZZQWxBQE:hover,html[dir] ._1ZviSa0_whGgfPGOOOOxnp:hover,html[dir] ._2cneFsBMG5bvkgDb15KPlJ:hover,html[dir] ._3kyTqDO61OJMeGFnIRHrYb:hover,html[dir] ._37NbqmdNEcGt_QTJ8xsXHS:hover,html[dir] .io3xBaopMNRq_SXGlsevf:hover{background:"[theme:themeTertiary, default:#71AFE5]"}',""]),t.locals={actionContainer:"_3MBhxLp2OiM0Y21PPmFC8N",deleteButton:"m0Fz5fnM6nwx8USzV9prQ",deleteButtonForImageView:"_2bbVvIsFeHMVeGsLZN6i-U",none:"_2goKIZ4hcxVfTIdL39mNae",withBorder:"io3xBaopMNRq_SXGlsevf",edit:"_3kyTqDO61OJMeGFnIRHrYb",selected:"_1ZviSa0_whGgfPGOOOOxnp",selectedAndPending:"_37NbqmdNEcGt_QTJ8xsXHS",selectedAndSaving:"_1JZFDfyFIcLBxIZZQWxBQE",notSelectedAndSaving:"_2cneFsBMG5bvkgDb15KPlJ"}},5197:function(e,t,n){var a=n(5198),r=n(33);"string"==typeof a&&(a=[[e.i,a]]);for(var i=0;i<a.length;i++)r.loadStyles(a[i][1],!1);a.locals&&(e.exports=a.locals)},5198:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'.nRf3vpA8Avo23mt1LHfeh{overflow:hidden;text-overflow:ellipsis}.ULlvubdd8OZTk3CQc9y8x{color:"[theme:neutralPrimary, default:#333333]"}._1FRuwMjN0KHWvDnUBM4xdi{color:"[theme:neutralSecondary, default:#666666]"}._27M-mkGg9Z3HgV6it_Uu9v{color:"[theme:white, default:#ffffff]";bottom:6px;position:absolute}html[dir=ltr] ._27M-mkGg9Z3HgV6it_Uu9v,html[dir=rtl] ._27M-mkGg9Z3HgV6it_Uu9v{padding-left:4px;padding-right:4px}._1iflzx_ZQx36dOEjtmuCm9{width:20px;height:20px}html[dir=ltr] ._1iflzx_ZQx36dOEjtmuCm9{margin-right:4px}html[dir=rtl] ._1iflzx_ZQx36dOEjtmuCm9{margin-left:4px}.RlkajXluVIAfLilePy3qC{font-size:14px;font-weight:400;max-width:145px;overflow:hidden;text-overflow:ellipsis}._2nW5KMmz8Jv9XJbt1Lgsa8,.LGoqgw6DsSow0VQs_z2y9{font-size:14px;font-weight:400;max-width:169px}._2nW5KMmz8Jv9XJbt1Lgsa8{display:-webkit-box;display:-ms-flexbox;display:flex}._1jr-3ncwYTltByxGILge6y{font-size:11px;font-weight:400;max-width:151px;display:inline-block}html[dir] ._1jr-3ncwYTltByxGILge6y{padding-top:3px}._1xUc-VjcuY63tFdNlzmBtg{max-width:120px;color:"[theme:white, default:#ffffff]"}._2iB4qvT1Up4__ljQZX5JGU{max-width:102px;color:"[theme:white, default:#ffffff]"}._2Cbztrgkoxc8lXQ4SXWHRJ{font-size:12px;font-weight:400;font-weight:600;position:relative;top:-1px}html[dir=ltr] ._2Cbztrgkoxc8lXQ4SXWHRJ{padding-right:4px}html[dir=rtl] ._2Cbztrgkoxc8lXQ4SXWHRJ{padding-left:4px}.zo7r1_v-IlIJSi29icti0{color:#107c10}._2MU5sbIhmkGjxrb6lgzQvR,._3mYVC6XWqhqVZCq5ARQBCh{color:#e81123}',""]),t.locals={textOverFlow:"nRf3vpA8Avo23mt1LHfeh",firstLineCommonStyle:"ULlvubdd8OZTk3CQc9y8x",secondLineCommonStyle:"_1FRuwMjN0KHWvDnUBM4xdi",attachmentInfoForImageView:"_27M-mkGg9Z3HgV6it_Uu9v",smallFileIcon:"_1iflzx_ZQx36dOEjtmuCm9",firstLineReferenceAttachmentText:"RlkajXluVIAfLilePy3qC",firstLine:"LGoqgw6DsSow0VQs_z2y9",firstLineReference:"_2nW5KMmz8Jv9XJbt1Lgsa8",secondLine:"_1jr-3ncwYTltByxGILge6y",firstLineForImageView:"_1xUc-VjcuY63tFdNlzmBtg",secondLineForImageView:"_2iB4qvT1Up4__ljQZX5JGU",actionComplete:"_2Cbztrgkoxc8lXQ4SXWHRJ",colorGreen:"zo7r1_v-IlIJSi29icti0",colorRed:"_2MU5sbIhmkGjxrb6lgzQvR",expiredAttachment:"_3mYVC6XWqhqVZCq5ARQBCh"}},5199:function(e,t,n){var a=n(5200),r=n(33);"string"==typeof a&&(a=[[e.i,a]]);for(var i=0;i<a.length;i++)r.loadStyles(a[i][1],!1);a.locals&&(e.exports=a.locals)},520:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"e",function(){return s}),n.d(t,"f",function(){return l}),n.d(t,"g",function(){return u}),n.d(t,"h",function(){return d}),n.d(t,"i",function(){return m}),n.d(t,"j",function(){return h}),n.d(t,"d",function(){return p});var a=n(1210);n.d(t,"b",function(){return a.a});var r=n(2),i=n(34);n.d(t,"a",function(){return i.h});var o=new r.c(function(){return Promise.all([n.e(6),n.e(7),n.e(25),n.e(34),n.e(57)]).then(n.bind(null,1739))}),c=new r.a(o,function(e){return e.clickAttachment}).importAndExecute,s=new r.a(o,function(e){return e.previewAttachment}),l=new r.a(o,function(e){return e.previewAttachmentInNewSxS}),u=new r.a(o,function(e){return e.previewAttachmentInSxS}),d=new r.a(o,function(e){return e.previewImageInNewSxS}),m=new r.a(o,function(e){return e.previewImageInSxS}),h=new r.a(o,function(e){return e.previewLinkInNewSxS}),p=new r.b(o,function(e){return e.downloadAttachment})},5200:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'._27qJexwmfCJF41htalgo5S{display:inline-block;width:180px;height:40px;vertical-align:top;font-weight:400;color:"[theme:neutralPrimary, default:#333333]"}html[dir] ._27qJexwmfCJF41htalgo5S{padding:6px 4px}html[dir=ltr] ._27qJexwmfCJF41htalgo5S{text-align:left}html[dir=rtl] ._27qJexwmfCJF41htalgo5S{text-align:right}',""]),t.locals={attachmentInfoContainer:"_27qJexwmfCJF41htalgo5S"}},5201:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'._22LmwcEvooUcWf7KqfgUEn{-o-object-fit:cover;object-fit:cover;position:absolute}._1s4kVdE1PLh2RibPzH3XC1{font-size:70px;color:"[theme:neutralTertiaryAlt, default:#c8c8c8]";position:absolute;top:25px}html[dir] ._1s4kVdE1PLh2RibPzH3XC1{background:transparent}html[dir=ltr] ._1s4kVdE1PLh2RibPzH3XC1{left:45px}html[dir=rtl] ._1s4kVdE1PLh2RibPzH3XC1{right:45px}._31Hjdyd0HEioRh9FJdyfGK{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);height:100%;width:100%;bottom:0;position:absolute;font-weight:400}html[dir] ._31Hjdyd0HEioRh9FJdyfGK{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white);background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]";border-radius:2px}._3PmLIc3_q4RAighmzyR_TT{height:50px}html[dir=ltr] ._3PmLIc3_q4RAighmzyR_TT,html[dir=rtl] ._3PmLIc3_q4RAighmzyR_TT{border-bottom-left-radius:2px;border-bottom-right-radius:2px}',""]),t.locals={thumbnail:"_22LmwcEvooUcWf7KqfgUEn",placeholder:"_1s4kVdE1PLh2RibPzH3XC1",infoContainer:"_31Hjdyd0HEioRh9FJdyfGK",infoContainerForReadingPane:"_3PmLIc3_q4RAighmzyR_TT"}},5202:function(e,t,n){var a=n(5203),r=n(33);"string"==typeof a&&(a=[[e.i,a]]);for(var i=0;i<a.length;i++)r.loadStyles(a[i][1],!1);a.locals&&(e.exports=a.locals)},5203:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,"._37NIDoLwUwv2EhQNUbqAI{position:absolute;bottom:-6px;width:100%}html[dir=ltr] ._37NIDoLwUwv2EhQNUbqAI{left:0}html[dir=rtl] ._37NIDoLwUwv2EhQNUbqAI{right:0}._37NIDoLwUwv2EhQNUbqAI .ms-ProgressIndicator .ms-ProgressIndicator-progressBar,._37NIDoLwUwv2EhQNUbqAI .ms-ProgressIndicator .ms-ProgressIndicator-progressTrack{height:4px}",""]),t.locals={progressIndicator:"_37NIDoLwUwv2EhQNUbqAI"}},5204:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),r=n(3562);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=r.default(e.request)),a.makeServiceRequest("SetAttachmentPermissionsV2",e,t)}},5205:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),r=n(5206);t.default=function(e,t){return void 0===e.requestObject||e.requestObject.__type||(e.requestObject=r.default(e.requestObject)),a.makeServiceRequest("ConvertAttachmentToInline",e,t)}},5206:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"ConvertAttachmentToInlineRequest:#Exchange"},e)}},5207:function(e,t,n){var a=n(5208),r=n(33);"string"==typeof a&&(a=[[e.i,a]]);for(var i=0;i<a.length;i++)r.loadStyles(a[i][1],!1);a.locals&&(e.exports=a.locals)},5208:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'.LftZ192mCmN4bpBw4yBLm{display:inline-block;overflow:hidden;white-space:nowrap;vertical-align:top}html[dir=ltr] .LftZ192mCmN4bpBw4yBLm{margin:1px 10px 10px 1px}html[dir=rtl] .LftZ192mCmN4bpBw4yBLm{margin:1px 1px 10px 10px}.OP3nl1RWy0-0A0-YQU_Dd{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:20px;width:262px}html[dir] .OP3nl1RWy0-0A0-YQU_Dd{background-color:"[theme:themePrimary, default:#0078D7]"}html[dir=ltr] .OP3nl1RWy0-0A0-YQU_Dd,html[dir=rtl] .OP3nl1RWy0-0A0-YQU_Dd{border-top-left-radius:2px;border-top-right-radius:2px}._1sYFN4wRpDyQyBN6ye6mDx{font-size:11px;color:"[theme:white, default:#ffffff]"}html[dir=ltr] ._1sYFN4wRpDyQyBN6ye6mDx{padding-left:8px;padding-right:4px}html[dir=rtl] ._1sYFN4wRpDyQyBN6ye6mDx{padding-right:8px;padding-left:4px}._1u9ZYPBlaRTt9S0qqJzRvQ{max-width:220px}html[dir=ltr] ._1u9ZYPBlaRTt9S0qqJzRvQ{padding-left:4px;padding-right:8px}html[dir=rtl] ._1u9ZYPBlaRTt9S0qqJzRvQ{padding-right:4px;padding-left:8px}._26yTEyHLgoZBoVI51tubkp{display:none}._ssrSpmtOpOfcMm_7gNdP{color:"[theme:white, default:#ffffff]";font-size:11px;font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex}.Q8sdZg-gAvAG77cjjkKRR{display:inline-block;position:relative}html[dir] .Q8sdZg-gAvAG77cjjkKRR{border-style:solid}._2jZEe6miYTcU_Fse5nLeVE{height:52px;width:260px}html[dir] ._2jZEe6miYTcU_Fse5nLeVE{border-width:1px;border-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1zhsLPyw09TOTeh8hvI-Dg{height:120px;width:160px}html[dir] ._1zhsLPyw09TOTeh8hvI-Dg{background:"[theme:neutralLighter, default:#f4f4f4]";border-width:1px;border-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._2yHS_1agekFJPGRJU1Pc-o{cursor:default}._3ZAtM3P5T7VbUmpnGvSp0e{cursor:pointer}html[dir=ltr] ._37knO6l2BIdaqKEWGCxEl6,html[dir=rtl] ._37knO6l2BIdaqKEWGCxEl6{border-top-right-radius:0;border-top-left-radius:0}html[dir] .VneoH-ZTIj8B3oyFOQxtv{border-radius:2px;background:"[theme:white, default:#ffffff]"}html[dir] .VneoH-ZTIj8B3oyFOQxtv:hover{background:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._2dPDrwVCGkL-RTzdELhxlB,html[dir] ._2qlMhdoEJQ48Zl9MhVPiB5,html[dir] ._3kkBmc0b21UZ-1y7j4nkH5,html[dir] ._18Uw35VkuMGDP6sG99JsBC,html[dir] .BkMogymLRRdzof5viZbSe,html[dir] .pU09saAax2I-i9ACscGg-{margin:0;border-width:1px;background-color:"[theme:themeLight, default:#C7E0F4]";border-color:"[theme:themePrimary, default:#0078D7]";border-radius:2px}html[dir] .pU09saAax2I-i9ACscGg-{background:"[theme:neutralLighter, default:#f4f4f4]"}.q0skG5_Pylwv8dqTvuMvh{position:fixed;pointer-events:"none";z-index:1000;top:0;font-size:12px;font-weight:400}html[dir] .q0skG5_Pylwv8dqTvuMvh{border-width:1px;border-style:solid;padding:0 4px;background:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir=ltr] .q0skG5_Pylwv8dqTvuMvh{left:0}html[dir=rtl] .q0skG5_Pylwv8dqTvuMvh{right:0}',""]),t.locals={attachmentContainer:"LftZ192mCmN4bpBw4yBLm",attachmentLabelWrapper:"OP3nl1RWy0-0A0-YQU_Dd",attachmentLabelIcon:"_1sYFN4wRpDyQyBN6ye6mDx",attachmentLabelText:"_1u9ZYPBlaRTt9S0qqJzRvQ",attachmentLabelHidden:"_26yTEyHLgoZBoVI51tubkp",attachmentLabel:"_ssrSpmtOpOfcMm_7gNdP",attachmentView:"Q8sdZg-gAvAG77cjjkKRR",attachmentDocView:"_2jZEe6miYTcU_Fse5nLeVE",attachmentImageView:"_1zhsLPyw09TOTeh8hvI-Dg",defaultCursor:"_2yHS_1agekFJPGRJU1Pc-o",handCursor:"_3ZAtM3P5T7VbUmpnGvSp0e",regularTopBorderRadius:"_37knO6l2BIdaqKEWGCxEl6",none:"VneoH-ZTIj8B3oyFOQxtv",withBorder:"BkMogymLRRdzof5viZbSe",edit:"_2qlMhdoEJQ48Zl9MhVPiB5",selected:"_18Uw35VkuMGDP6sG99JsBC",selectedAndPending:"_2dPDrwVCGkL-RTzdELhxlB",selectedAndSaving:"_3kkBmc0b21UZ-1y7j4nkH5",notSelectedAndSaving:"pU09saAax2I-i9ACscGg-",dragPreview:"q0skG5_Pylwv8dqTvuMvh"}},568:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var a="OneDrivePro",r="attachment-icon-blockedfile_32x32",i="attachment-icon-generic_32x32"},595:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(489);function r(e){return Object(a.a)().attachments.get(e.Id)}},597:function(e,t,n){"use strict";var a,r;(r=a||(a={}))[r.Base64InlineImage=0]="Base64InlineImage",r[r.Cloud=1]="Cloud",r[r.Local=2]="Local",r[r.MailItem=3]="MailItem",r[r.Uri=4]="Uri",r[r.AttachmentItem=5]="AttachmentItem";var i={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function o(e){switch(e?e.toLowerCase():null){case i.ONE_DRIVE_PRO.toLowerCase():return 0;case i.GDRIVE.toLowerCase():return 5;case i.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case i.DROPBOX.toLowerCase():return 2;case i.BOX.toLowerCase():return 3;case i.WOPI_BOX.toLowerCase():return 7;case i.WOPI_EGNYTE.toLowerCase():return 8;case i.MAILBOX.toLowerCase():return 4;case i.FACEBOOK.toLowerCase():return 6;default:return null}}function c(e){return null==e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}function s(e){return null==e?null:{fileType:a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:e.Thumbnail?e.Thumbnail.Url:"",previewUrl:e.Preview?e.Preview.Url:"",type:e.MimeType}}function l(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],i={fileType:a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};t.push(i)}return t}var u=n(7);function d(e,t){if(e.length!=t.length)return u.c.error("The sizes of subjects and latestItemIds are different"),null;for(var n=[],r=0;r<e.length;r++){var i={fileType:a.MailItem,name:e[r],size:0,itemId:t[r]};n.push(i)}return n}var m=n(191);function h(e){return e.map(function(e){return{fileType:a.Uri,name:e.name,type:Object(m.a)(e.url),size:0,uri:e.url}})}n.d(t,"b",function(){return o}),n.d(t,"e",function(){return l}),n.d(t,"f",function(){return d}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return s}),n.d(t,"g",function(){return h}),n.d(t,"a",function(){return a})},599:function(e,t,n){"use strict";var a=n(11),r=n.n(a),i=null;function o(e){var t;if(i||(i=Object.freeze(((t={})[0]=function(){return r.a.attachmentPolicyInformation},t))),!i[e])throw new Error("Issue message is not defined");return i[e]()}var c=n(82),s=n(335);function l(e){switch(e){case 0:return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,messageParts:[o(e),{text:Object(a.getOwaMailStrings)().attachmentPolicyHyperLinkText,action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}],color:s.a.Red};default:return Object(c.a)(e)}}var u=n(6);function d(){var e=Object(u.a)().AttachmentPolicy;return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked||e.ConditionalAccessPrintWithoutDownloadBlocked||e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked}function m(){var e=[];return d()&&e.push(0),e}function h(e){switch(e){case 0:return d();default:return Object(c.a)(e)}}var p,f,v=n(191);(f=p||(p={}))[f.Undefined=0]="Undefined",f[f.Block=1]="Block",f[f.ForceSave=2]="ForceSave",f[f.Allow=3]="Allow";var g=function(){function e(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=p[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes]}return e.prototype.getPolicyInfo=function(e,t,n,a){e&&(e=e.toLowerCase());var r=this.getFileAccessLevel(e,t),i=!1,o=!1,c=!1,s="ReferenceAttachment:#Exchange"===a;return r!==p.Block&&n&&(this.isWacViewingEnabled(e)&&(i=!0),!this.directFileAccessEnabled&&s&&(i=!1),o=this.isForceBrowserViewingFirst(i),i&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(c="FileAttachment:#Exchange"===a?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),i||this.directFileAccessEnabled||(r=p.Block)),{directFileAccessEnabled:this.directFileAccessEnabled,level:r,useWac:i,forceBrowserViewingFirst:o,wacEdit:c}},e.prototype.getFileAccessLevel=function(e,t){var n=this.fileTypeToPolicyMap[e];if(n||(n=p.Undefined),n==p.Block)return p.Block;var a=this.mimeTypeToPolicyMap[t];return a==p.Block?p.Block:n==p.ForceSave||a==p.ForceSave?p.ForceSave:n==p.Allow||a==p.Allow?p.Allow:this.policyForUnknownTypes},e.prototype.isWacViewingEnabled=function(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0},e.prototype.isForceBrowserViewingFirst=function(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},e.prototype.addPolicyIntoMap=function(e,t,n){t&&t.forEach(function(t){e[t]=n})},e.prototype.createPolicyMap=function(e,t,n){var a={};return this.addPolicyIntoMap(a,n,p.Allow),this.addPolicyIntoMap(a,t,p.ForceSave),this.addPolicyIntoMap(a,e,p.Block),a},e}(),b=null;function w(){if(!b){var e=Object(u.a)(),t=e.AttachmentPolicy,n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;b=new g(t,n)}return b}function I(e,t){var n=Object(v.a)(e.Name),a=e.ContentType;return w().getPolicyInfo(n,a,t,e.__type)}function S(e,t,n){var a=I(e,!0),r=w();return a.level!==p.Block&&r.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"d",function(){return l}),n.d(t,"b",function(){return m}),n.d(t,"g",function(){return h}),n.d(t,"e",function(){return S}),n.d(t,"a",function(){return p}),n.d(t,"c",function(){return I}),n.d(t,"f",function(){return w})},602:function(e,t,n){"use strict";var a,r;function i(e){a=e}function o(){return a}function c(e){r=e}function s(){return r}n.d(t,"c",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return s})},603:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var a="ReferenceAttachment:#Exchange",r=1024,i=1048576},617:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var a=n(1234);function r(e){return o(e.type)}function i(e){return o(Object(a.a)(e))}function o(e){return 1===e}},657:function(e,t,n){"use strict";var a=n(82),r=n(8),i=n(390),o=n(192);function c(e,t,n,r){void 0===r&&(r=!0);var o=e,c=o.AttachmentId,s=o.Name,l=o.OriginalPermissionType,u=o.PermissionType,d=o.AttachLongPathName;switch(t){case 0:case 3:return i.b(c,d,t,n,u,l,r,s);case 1:return e.AttachmentPreviewUrl?e.AttachmentPreviewUrl:i.b(c,d,1,n,u,l,r,s);case 2:return e.AttachmentThumbnailUrl;default:return Object(a.a)(t)}}function s(e,t,n,a,o){return void 0===n&&(n=!1),void 0===a&&(a=Object(r.c)("doc-consumerUrl")),void 0===o&&(o=!0),i.a(e.mailboxInfo&&e.mailboxInfo.mailboxId,e,t,n,a,o)}function l(e,t,n,a,l,u){void 0===l&&(l=!1),void 0===u&&(u=Object(r.c)("doc-consumerUrl"));var d=n?c(t,1,a,!1):s(e,1,l,u,!1);if(n)return{url:d,init:{credentials:"include"}};var m=Object(i.c)(),h=new Headers;return h.set("X-Token",m),h.set("X-OWA-CANARY",Object(o.getOwaCanaryCookie)()),{url:d,init:{headers:h}}}function u(e,t,n,a,i,o,l){return void 0===o&&(o=!1),void 0===l&&(l=Object(r.c)("doc-consumerUrl")),a?c(t,n,i):s(e,n,o,l)}n.d(t,"b",function(){return u}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return l}),n.d(t,"a",function(){return"/owa/"})},869:function(e,t,n){"use strict";n.d(t,"p",function(){return s}),n.d(t,"e",function(){return l}),n.d(t,"f",function(){return u}),n.d(t,"g",function(){return d}),n.d(t,"h",function(){return m}),n.d(t,"i",function(){return h}),n.d(t,"j",function(){return p}),n.d(t,"k",function(){return f}),n.d(t,"l",function(){return v}),n.d(t,"m",function(){return g}),n.d(t,"n",function(){return b}),n.d(t,"o",function(){return w}),n.d(t,"q",function(){return I});var a=n(499);n.d(t,"b",function(){return a.a});var r=n(498);n.d(t,"d",function(){return r.a});var i=n(2),o=n(314);n.d(t,"a",function(){return o.a}),n.d(t,"c",function(){return o.d});var c=new i.c(function(){return Promise.all([n.e(20),n.e(25),n.e(205),n.e(40),n.e(111)]).then(n.bind(null,1689))}),s=new i.b(c,function(e){return e}),l=new i.b(c,function(e){return e.resetPreviewPane}),u=(new i.b(c,function(e){return e.setAudioPreviewState}),new i.b(c,function(e){return e.setBlankPreviewState}),new i.b(c,function(e){return e.setCustomPreviewState}),new i.b(c,function(e){return e.setIframePreviewState})),d=(new i.b(c,function(e){return e.setImageGalleryItems}),new i.b(c,function(e){return e.setImagePreviewLoaded})),m=new i.b(c,function(e){return e.setImagePreviewState}),h=new i.b(c,function(e){return e.setImagePreviewStateFromImageGalleryItem}),p=(new i.b(c,function(e){return e.setNativePdfPreviewState}),new i.b(c,function(e){return e.setPanesSize})),f=(new i.b(c,function(e){return e.setPdfJsPreviewState}),new i.b(c,function(e){return e.setPdfJsPreviewStateByData}),new i.b(c,function(e){return e.setPreviewError})),v=new i.b(c,function(e){return e.setPreviewLoading}),g=new i.b(c,function(e){return e.setRightPaneDisplayAndUpdateSize}),b=new i.b(c,function(e){return e.setTextPreviewState}),w=(new i.b(c,function(e){return e.setVideoPreviewState}),new i.b(c,function(e){return e.setWacPreviewState})),I=new i.b(c,function(e){return e.updatePanesSize})},874:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return r});var a=5,r="undefined"!=typeof window&&window.hasOwnProperty("DataTransfer")&&DataTransfer.prototype.setDragImage},896:function(e,t,n){"use strict";function a(e){window.open(e,"_blank")}n.d(t,"a",function(){return a})},939:function(e,t,n){"use strict";var a=n(389),r=n(18),i=n(192),o="/owa/",c="service.svc/s/GetFileAttachment?id={0}",s="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",l="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",d="service.svc/s/GetAttachmentThumbnail?id={0}",m="pdfprint.aspx?id={0}",h="pdfprint.aspx?id={0}&location={1}";var p=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var f=n(82),v=n(8);function g(e,t,n,a,c,l,d,m){var v;switch(void 0===c&&(c=0),void 0===l&&(l=0),void 0===d&&(d=!0),void 0===m&&(m=null),n){case 0:v=s;break;case 3:v=h;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&p.indexOf(t.toLowerCase())>=0}(m))return null;v=u;break;default:Object(f.a)(n)}var g=a?l:c;!g&&c&&(g=c);var b=Object(r.format)("{0}{1}&permissionLevel={2}",o,Object(r.format)(v,encodeURIComponent(e.Id),encodeURIComponent(t)),g);d&&(b=b+"&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)());return b}function b(e,t,n,s,u,h){var p;switch(void 0===s&&(s=!1),void 0===u&&(u=Object(v.c)("doc-consumerUrl")),void 0===h&&(h=!0),n){case 0:p=c;break;case 1:p=l;break;case 2:p=d;break;case 3:p=m;break;default:return Object(f.a)(n)}return Object(r.isStringNullOrWhiteSpace)(p)?null:Object(r.format)("{0}{1}{2}",function(e,t,n,c,s,l){if(void 0===l&&(l=!1),!t||!t.Id)return null;var u=Object(r.format)(n,encodeURIComponent(t.Id));if(!Object(a.c)()||l)return o+u+"&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)();var d="{0}{1}/{2}&owa={3}&scriptVer={4}";c&&(d+="&isc=1");var m="unofficial";window.bootstrapDiagnostics&&!Object(r.isStringNullOrWhiteSpace)(window.bootstrapDiagnostics.scriptVer)&&(m=window.bootstrapDiagnostics.scriptVer);var h=Object(r.format)(d,Object(a.b)(),e,u,window.location.hostname,m);return s&&(h+="&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)(),h+="&token="+Object(a.a)()),h}(e,t,p,u,h,3===n),s?"&isDownload=true":"","&animation=true")}n.d(t,"b",function(){return g}),n.d(t,"a",function(){return b})},943:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38);t.default=function(e){return a.makeServiceRequest("GetAttachmentDownloadToken",{},e)}},950:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var a,r=n(6),i=n(603),o=n(136),c=25*i.b,s=2048;function l(){if(a)return a;var e=Object(r.a)();return e&&e.SessionSettings&&e.ApplicationSettings?((Object(o.b)("doc-attachment-slicedClassicAttachmentUpload")?e.SessionSettings.MaxMessageSizeInKb:Math.min(e.SessionSettings.MaxMessageSizeInKb,e.ApplicationSettings.MaxRequestLength))-s)*i.a:c}},984:function(e,t,n){"use strict";var a=n(4);t.a=Object(a.action)("setShouldShowImageOverlay")(function(e,t){e.shouldShowImageOverlay=t})}},0,[0,3,4,9,52,2,75,7,223,56,218,225,232,79,76]]);
//# sourceMappingURL=owa.Attachments.js.map
window.scriptsLoaded['owa.Attachments.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.Attachments.js'] = (new Date()).getTime();