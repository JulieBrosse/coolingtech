!function(e){function t(t){for(var r,s,a=t[0],c=t[1],u=t[2],p=0,d=[];p<a.length;p++)s=a[p],i[s]&&d.push(i[s][0]),i[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(l&&l(t);d.length;)d.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,a=1;a<n.length;a++){var c=n[a];0!==i[c]&&(r=!1)}r&&(o.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},i={6:0},o=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var a=window.swcJsonp=window.swcJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=c;o.push([244,0]),n()}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(91),i=window;t.swcWindow=i,i.swc=i.swc||i.SkypeWebControl||{},i.swc.shared=i.swc.shared||{},i.swc.scriptLoader=i.swc.scriptLoader||r.default,i.SKYPE=i.SKYPE||{},i.SkypeWebControl=i.swc;var o=i.swc;t.swc=o,t.SKYPE=i.SKYPE||{}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(124),s=n(18),a=n(33),c=n(0),u=n(38),l=n(21),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isFocused=!0,t.restart=function(){t.dispose(),t._initManagers&&t._initManagers(),t._signInManager.getSkypeToken().then(null,function(){}),t.MePersonManager.fetch(),t.restoreLastConversation()},t}return i(t,e),Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.initServices=function(e){t._initParams=e,t.instance.SignInManager,t.instance.WebApi},t.prototype.dispose=function(){var e;e=this._mePersonManager,c.swc.MePersonManager,e&&(e.dispose(),e=null),this._amsManager&&this._amsManager.dispose(),this._persons&&this._persons.dispose(),this._isReady=!1,this._isCleared=!1},Object.defineProperty(t,"performanceData",{get:function(){return t._performanceData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MePersonManager",{get:function(){return this._mePersonManager||(this._mePersonManager=c.swc.MePersonManager),this._mePersonManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AgentsManager",{get:function(){return this._agentsManager||(this._agentsManager=new o.default),this._agentsManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AmsManager",{get:function(){return this._amsManager||(this._amsManager=l.getServices().amsManager),this._amsManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ContactsManager",{get:function(){return this._contactsManager||(this._contactsManager=l.getServices().contactsManager),this._contactsManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SignInManager",{get:function(){if(!this._signInManager&&(this._signInManager=l.getServices().signInManager,!this._signInManager)){var e=t._initParams;l.getServices().initManagers(u.default.locale,{tokenProvider:e.skypeTokenProvider,initialToken:e.initialSkypeTokenData,externalLogin:e.externalLogin,tokenType:e.tokenType}),this._signInManager=l.getServices().signInManager,this._signInManager&&this._signInManager.subscribe("resurrect",this.restart)}return this._signInManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Persons",{get:function(){return this._persons||(this._persons=l.getServices().persons),this._persons},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TelemetryService",{get:function(){return this._telemetryService||(this._telemetryService=l.getServices().telemetryManager),this._telemetryService},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PesManager",{get:function(){return this._pesManager||(this._pesManager=l.getServices().pesManager),this._pesManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SearchManager",{get:function(){return this._searchManager||(this._searchManager=l.getServices().searchManager),this._searchManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Storage",{get:function(){return a.default.get()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"WebApi",{get:function(){return this._webApi||(this._webApi=l.getServices().webApi),this._webApi},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NotificationsManager",{get:function(){return l.getServices().notificationsManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wx",{get:function(){return l.getServices().wx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"i18n",{get:function(){return l.getServices().i18n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AvatarService",{get:function(){return l.getServices().avatarService},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCleared",{get:function(){return this._isCleared},set:function(e){e!==this._isCleared&&(this._isCleared=e,this.publish("isCleared",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFocused",{get:function(){return this._isFocused},set:function(e){e!==this._isFocused&&(this._isFocused=e,this.publish("isFocused",e))},enumerable:!0,configurable:!0}),t.prototype.setRestoreOfLastConversation=function(e){this._lastConversationCallback=e},t.prototype.restoreLastConversation=function(){this._lastConversationCallback&&this._lastConversationCallback()},t.prototype.setManagersInit=function(e){this._initManagers||(this._initManagers=e)},t._performanceData={},t.initPesManager=function(){l.getServices().initPesManager()},t}(s.default);t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(24),o=n(24),s=n(19),a=n(66),c=function(){function e(){}return Object.defineProperty(e,"ECS",{get:function(){return r.swc.EcsConfig},set:function(e){r.swc.EcsConfig=e},enumerable:!0,configurable:!0}),e.getPlatformId=function(){if(e._platformID)return e._platformID;var t=s.default.getHost(),n={"outlook.live.com":915,"outlook-sdf.live.com":915,"interviews.skype.com":916,"interviews-df.skype.com":916,"interviews-int.skype.com":916,"www.bing.com":917,"www.staging-bing-int.com":917,"www.bing-int.com":917,"www.msn.com":918,"int.msn.com":918,"int1.msn.com":918,"wtskype2.azurewebsites.net":919,"azuresupportextension-ms.hosting.portal.azure.net":919,"portal.azure.com":919,"rc.portal.azure.com":919,"ms.portal.azure.com":919,"onedrive.live.com":920,"www.skype.com":921};for(var r in n)if(n.hasOwnProperty(r)&&t.indexOf(r)>-1)return n[r];return 912},e.getPlatformName=function(){switch(this.getPlatformId()){case 915:return"outlook";case 916:return"interviews";case 917:return"bing";case 918:return"msn";case 919:return"azureportal";case 920:return"onedrive";case 921:return"scom";default:return"other"}},e.getClientVersion=function(){if(e.CLIENT_VERSION!==e.DEFAULT_CLIENT_VERSION)return e.CLIENT_VERSION;for(var t=e.ECS.version.split("."),n=t.length,r=0;r<4-n;r++)t.splice(t.length-1,0,"0");return e.CLIENT_VERSION=e.getPlatformId()+"/"+t.join("."),e.CLIENT_VERSION},e.getChatClientInfo=function(){return this.CHAT_CLIENT_INFO?this.CHAT_CLIENT_INFO:(this.CHAT_CLIENT_INFO="os=Windows; osVer=10; proc=Win32; lcid=en-us; deviceType=1; country=n/a; clientName=swc; clientVer="+e.getUiVersion(),this.CHAT_CLIENT_INFO)},e.getUiVersion=function(){return this.UI_VERSION?this.UI_VERSION:(this.UI_VERSION=e.getClientVersion()+"//swc",this.UI_VERSION)},e.getClientInfo=function(){if(this.SYSTEM_INFO)return this.SYSTEM_INFO;var t=o.UNKNOWN_VERSION;try{t=window.navigator.platform}catch(e){}return this.SYSTEM_INFO=e.getUiVersion()+"os="+i.default.getOsName()+"; osVer="+i.default.getOsVersion()+"; proc="+t+"; deviceType="+i.default.getDeviceType()+"; browser="+i.default.getBrowserName()+"; browserVer="+i.default.getBrowserVersion(),this.SYSTEM_INFO},e.APPNAME="SWC",e.LOCALE="en-us",e.PES_LOCALE="en",e.ORIGIN="SkypeLWC",e.ORIGIN_CALLING="SkypeCalling",e.MSG_MAX_LENGTH=2e3,e.SKYPE_TOKEN_KEY=a.SKYPE_TOKEN_KEY,e.SKYPE_REGTOKEN_KEY=a.SKYPE_REGTOKEN_KEY,e.PLATFORM_ID=912,e.BUTTON_MARKER_CLASS=".skype-button",e.CHAT_MARKER_CLASS=".skype-chat",e.RECENTS_MARKER_CLASS=".skype-recents",e.CHAT_FRAME_MARKER_CLASS=".lwc-chat-frame",e.CALL_FRAME_MARKER_CLASS=".swc-call-frame",e.LOGIN_CLIENT_ID="919866",e.LOGIN_PAGE_URL="https://login.skype.com/login",e.LOGIN_THEME="skype-white",e.LOGOUT_PAGE_URL="https://login.skype.com/logout",e.LOGIN_POPUP_URL="https://demoplayground.skype.com/joinlwc?t=",e.LOGIN_POPUP_FEATURES="width=600, height=620, menubar=no, status=no, titlebar=no, toolbar=no",e.LOGOUT_POPUP_FEATURES="width=1, height=1, menubar=no, status=no, titlebar=no, toolbar=no",e.TEAMS_URL="https://api.teams.skype.com/",e.TEAMS_AUTH_URL="https://authsvc-server.teams.microsoft.com",e.TEAMS_PROFILE_URL="https://teams.microsoft.com/",e.SHAREPOINT_URL="https://microsoft-my.sharepoint.com/",e.AMS_HOST_URL="https://api.asm.skype.com/v1/",e.APS_HOST_URL="https://api.aps.skype.com/v1/",e.CDN_SERVICE_HOST="secure.skypeassets.com",e.OA_URL="https://pro.skype.com/v1/onboarding",e.OA_URL_INT="https://havana-latest.skype.com/v1/onboarding",e.URLP_SERVICE_URL="https://urlp.asm.skype.com",e.ECS_GRAPH_URL="https://skypegraph.skype.com/",e.MS_GRAPH_URL="https://graph.microsoft.com/v1.0/me/",e.MS_APP_CLIENT_ID="b8d5facb-2aee-4653-98cb-4acc8f0d0e97",e.MS_APP_SECRET="sYUC331musgrjOBHJ45$%_}",e.MS_APP_REDIRECT_URL_DEMO="https://latest-swc.cdn.skype.com/demo/connect.html",e.MS_APP_REDIRECT_URL_OUTLOOK="https://latest-swc.cdn.skype.com/demo/msauth.html",e.MS_AUTHORIZE_URL="https://login.microsoftonline.com/common/oauth2/v2.0/authorize",e.ECS_GRAPH_ETAG=null,e.ECS_GRAPH_SERVICE_SETTINGS=null,e.INVITE_HOST_URL_INT="https://latest-join.skype.com/api/v1/",e.INVITE_HOST_URL="https://join.skype.com/api/v1/",e.CHAT_CLIENT_INFO="",e.CHAT_GUEST_HOST_URL="https://client-s.gateway.messenger.live.com/v1/",e.CHAT_HOST_URL="https://client-s.gateway.messenger.live.com/v1/",e.CHAT_JOIN_URL="https://latest-join.skype.com/api/v2/conversation",e.SKYPE_CALLER_ID="lwc",e.CONTACTS_HOST_URL="https://edge.skype.com/pcs-df/contacts/v2/",e.CONTACTS_SCD_HOST_URL="https://scd.skype.com/contacts/v3/",e.AGENTS_HOST_URL="https://join.skype.com/",e.AVATAR_SERVICE_URL="https://avatar.skype.com/v1/",e.STRATUS_DOMAIN_HOST_URL="https://profile.skype.com/profile/v1/",e.WX_HOST_URL="https://wx.skype.com/api/v1/scom/",e.ECS_CLIENT_NAME="skype",e.ECS_TEAM_NAME="lwc",e.ECS_CLIENT_VERSION="1.00",e.GET_HELP_URL="https://support.skype.com/en/faq/FA34704/what-is-skype-web-control",e.CONCIERGE_BOT_MRI="28:concierge",e.CONCIERGE_BOT_DF_MRI="28:concierge_df",e.DEFAULT_CLIENT_VERSION=e.getPlatformId()+"/0.0.0.0",e.CLIENT_VERSION=e.DEFAULT_CLIENT_VERSION,e.DEFAULT_AVATAR_URI="https://swc.cdn.skype.com/assets/img/defaultAvatar.png",e.WELCOME_IMG_URI="https://swc.cdn.skype.com/assets/img/welcome_add_2x.png",e.MSG_DELETED_CLASSIC_SKYPE="Edited previous message: ",e.UI_VERSION="",e.SYSTEM_INFO="",e.MESSAGE_PROPERTIES={GLOBAL:{ACTIVITY_DATA:"activityData",PINNED:"pinned",PROTOTYPE_SKYPEX:"prototype_skypex"},PER_USER:{EMOTIONS:"emotions",POLL:"poll",TRANSLATIONS:"translations",ACTIVITY_DATA:"activityData",SMS_REPORT:"smsdeliveryreports"}},e.CHAT_SERVICE_COMMANDS={SET_MESSAGE_PROPERTY:"setMessageProperty",REMOVE_MESSAGE_PROPERTY:"removeMessageProperty",REMOVE_ALL_MESSAGES:"removeAllMessage",SET_IS_FAVORITE:"setIsFavorite",SMS_PRICE:"getSmsPrice"},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(6),o=n(23),s=n(135),a=n(248),c=n(17),u=n(13);n(152);var l=n(0),p=n(38),d=n(249),f=n(254),h=n(257),g=n(136),m=n(277),_=n(280),y=n(143),v=n(282),b=n(285),P=n(144),T=n(286),w=n(287),E=n(49),S=n(33),C=n(289),k=n(292),O=n(293),A=n(294),M=n(297),I=n(304),R=n(146),N=n(316),L=n(317),x=n(320),D=n(323),U=n(326),j=n(327),F=n(329),H=n(330),B=n(331),G=n(338),z=n(55),V=n(339),W=function(){function e(){this.activeEndpoints=[]}return e.setExternalLogin=function(t){e._externalLogin||(e._externalLogin=t)},Object.defineProperty(e,"initPromise",{get:function(){return e._initPromise.promise},enumerable:!0,configurable:!0}),Object.defineProperty(e,"signInManager",{get:function(){return e._skypeSignInManager?e._skypeSignInManager:null},enumerable:!0,configurable:!0}),Object.defineProperty(e,"storage",{get:function(){return S.default.get()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"localStorage",{get:function(){return S.LocalStorage.get()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"telemetryManager",{get:function(){return e._telemetryManager||(e._telemetryManager=new V.default),e._telemetryManager},enumerable:!0,configurable:!0}),Object.defineProperty(e,"conversations",{get:function(){return e._conversationsManager||(e._conversationsManager=new B.default),e._conversationsManager},enumerable:!0,configurable:!0}),Object.defineProperty(e,"teamsGraphService",{get:function(){return new j.default},enumerable:!0,configurable:!0}),Object.defineProperty(e,"skypeGraphService",{get:function(){return new x.default},enumerable:!0,configurable:!0}),Object.defineProperty(e,"microsoftGraphService",{get:function(){return new A.default},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stratusService",{get:function(){if(!e._stratusService){var t=i.default.get.backend===u.MessagingBackend.TEAMS;e._stratusService=t?new U.default:new D.default}return e._stratusService},enumerable:!0,configurable:!0}),Object.defineProperty(e,"amsService",{get:function(){return new d.default},enumerable:!0,configurable:!0}),Object.defineProperty(e,"amsManager",{get:function(){if(i.default.get.isTeams()){var t=!(!e._options||!e._options.fileSharing)&&!!e._options.fileSharing.forceEnterpriseAms;e._amsManager=new a.TeamsAmsManager(t)}else e._amsManager=new s.default;return e._amsManager},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sharepointService",{get:function(){return new L.default},enumerable:!0,configurable:!0}),Object.defineProperty(e,"webApi",{get:function(){return this._webApi},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pesManager",{get:function(){return e._pesManager||(i.default.get.backend===u.MessagingBackend.TEAMS?e._pesManager=new N.default:e._pesManager=new R.default),e._pesManager},enumerable:!0,configurable:!0}),Object.defineProperty(e,"contactsManager",{get:function(){return e._contactsManager||(e._contactsManager=new b.SkypeContactsManager),e._contactsManager},enumerable:!0,configurable:!0}),Object.defineProperty(e,"searchManager",{get:function(){return e._searchManager||(i.default.get.backend===u.MessagingBackend.TEAMS?e._searchManager=new T.TeamsSearchManager:e._searchManager=new P.default),e._searchManager},enumerable:!0,configurable:!0}),Object.defineProperty(e,"persons",{get:function(){return e._persons||(e._persons=new G.default),e._persons},enumerable:!0,configurable:!0}),Object.defineProperty(e,"botsService",{get:function(){return new C.default},enumerable:!0,configurable:!0}),Object.defineProperty(e,"agentsService",{get:function(){return e._agentsService},enumerable:!0,configurable:!0}),Object.defineProperty(e,"contactsService",{get:function(){if(!e._contactsService){var t=i.default.get.backend===u.MessagingBackend.TEAMS;e._contactsService=t?new y.default:new v.default}return e._contactsService},enumerable:!0,configurable:!0}),Object.defineProperty(e,"outlookContactsService",{get:function(){return e._outlookContactsService||(e._outlookContactsService=new _.default),e._outlookContactsService},enumerable:!0,configurable:!0}),Object.defineProperty(e,"translatorService",{get:function(){return H.default},enumerable:!0,configurable:!0}),e.createDirectLineService=function(e,t){return new w.DirectLineV3(e,t)},Object.defineProperty(e,"oa",{get:function(){return I},enumerable:!0,configurable:!0}),Object.defineProperty(e,"wx",{get:function(){return k.default},enumerable:!0,configurable:!0}),Object.defineProperty(e,"mePerson",{get:function(){return e._mePerson},enumerable:!0,configurable:!0}),Object.defineProperty(e,"notificationsManager",{get:function(){return e._notificationsManager||(e._notificationsManager=new M.default),e._notificationsManager},enumerable:!0,configurable:!0}),Object.defineProperty(e,"avatarService",{get:function(){return e._avatarService||(e._avatarService=new h.default),e._avatarService},enumerable:!0,configurable:!0}),e.setEverOpenedChats=function(t){e._everOpenedChats=t},e.signinStateHandler=function(){switch(this.signInManager.state){case o.SigninState.SignedOut:this.webApi.reset(),this.persons.dispose(),this._mePerson=null;break;case o.SigninState.SignedIn:this._mePerson||(this._mePerson=new O.default("8:"+this.signInManager.currentUserName))}},e.recetVisibilityHandler=function(t){if(e._isRecentsVisible=t,t){var n=Date.now().toString();S.LocalStorage.setItem("swc-recentslastseen",n),this._webApi.startEndpointActivation()}else e.isActive()||this._webApi.stopEndpointActivation()},e.chatShownHandler=function(t,n){if(n&&n.currentConversationId){if(t)return e._isChatShown=!0,void this.webApi.startEndpointActivation();e._isChatShown=!1;for(var r=Object.getOwnPropertyNames(e._everOpenedChats),i=0;i<r.length;i++){if(e._everOpenedChats[r[i]].onStage){e._isChatShown=!0;break}}e._isChatShown?this.webApi.startEndpointActivation():e.isActive()||this.webApi.stopEndpointActivation()}},e.focusHandler=function(t){e._isFocused=t,e._isFocused?this.webApi.startEndpointActivation():e.isActive()||this.webApi.stopEndpointActivation()},e.callingStateHandler=function(t){var n=!1;if(t)switch(t.status){case 2:case 3:case 4:case 9:n=!0}e._isInCall=n,n?this.webApi.startEndpointActivation():e.isActive()||this.webApi.stopEndpointActivation()},e.updateListOfActiveEndpoints=function(e){},e.isActive=function(){return(e._isInCall||e._isFocused)&&(e._isRecentsVisible||e._isChatShown)},e._initPromise=new c.CancelablePromise,e._everOpenedChats={},e._agentsService=new f.default,e._pesInitialized=!1,e.isZombie=!0,e.initManagers=function(t,n,o){e._options=o,e._skypeSignInManager||(e._skypeSignInManager=new z.default(n.tokenProvider,n.initialToken,n.externalLogin||e._externalLogin,n.tokenType),e.signInManager.subscribe("state",e.signinStateHandler.bind(e))),e._webApi||(i.default.get.backend===u.MessagingBackend.TEAMS?e._webApi=new m.ConversationTeamsWebApi:e._webApi=new g.ConversationConsumerWebApi);var s=e._initPromise.resolve.bind(e._initPromise),a=e._initPromise.cancel.bind(e._initPromise);E.default.init(t||p.default.locale).then(s,a),l.swc.API.registerEvent(r.ApiEvents.InappActivityStarted,F.default.send),l.swc.API.registerEvent(r.ApiEvents.recentsShown,e.recetVisibilityHandler.bind(e,!0)),l.swc.API.registerEvent(r.ApiEvents.recentsHidden,e.recetVisibilityHandler.bind(e,!1)),l.swc.API.registerEvent(r.ApiEvents.onControlShow,e.chatShownHandler.bind(e,!0)),l.swc.API.registerEvent(r.ApiEvents.onControlHide,e.chatShownHandler.bind(e,!1)),l.swc.API.registerEvent(r.ApiEvents.onControlClose,e.chatShownHandler.bind(e,!1)),l.swc.API.registerEvent(r.ApiEvents.onFocused,e.focusHandler.bind(e)),l.swc.API.registerEvent(r.ApiEvents.CallStatusChanged,e.callingStateHandler.bind(e)),l.swc.API.registerEvent(r.ApiEvents.CallStatusChanged,e.notificationsManager.callStateHandler.bind(e.notificationsManager))},e.initPesManager=function(){e._pesInitialized||(e.signInManager.onceSignedIn().then(function(){e.pesManager.init()}),e._pesInitialized=!0)},e._isRecentsVisible=!1,e._isChatShown=!1,e._isFocused=!1,e._isInCall=!1,e}();t.default=W},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.CreateControl="createControl",e.IncomingCall="incomingCall",e.CallingReady="callingReady",e.RecentsReady="recentsReady",e.InChatCallingReady="inChatCallingReady",e.BotAddedToThread="botAddedToThread",e.RecentDataLoaded="recentDataLoaded",e.StartChat="startChat",e.StartCall="startCall",e.AcceptCall="acceptCall",e.RejectCall="rejectCall",e.UpdateCallingScreen="updateCallingScreen",e.ForceExpandChat="forceExpandChat",e.ToggleExpressionPicker="toggleExpressionPicker",e.HideExpressionPicker="hideExpressionPicker",e.PesConfigInitialized="pesConfigInitialized",e.Ready="ready",e.ChatOpen="chat-open",e.Click="click",e.Fullscreenchange="fullscreenchange",e.UpdateUnreadMessageCounter="updateUnreadMessageCounter",e.InappActivityStarted="inappActivityStarted",e.ClientOpened="clientOpened",e.ClientFocused="clientFocused",e.ChatServiceUnavailable="chatServiceUnavailable",e.RemoveAllMessagesFromUi="removeAllMessagesFromUi",e.RequestEditingMessage="requestEditingMessage",e.OnVisibilityChange="onVisibilityChange",e.OnMessageSent="onMessageSent",e.OnMessageReceived="onMessageReceived",e.onFocused="onFocused",e.OnConversationReady="onConversationReady",e.onControlShow="onControlShow",e.onControlHide="onControlHide",e.onControlClose="onControlClose",e.OnCallStart="onCallStart",e.OnCallConnect="onCallConnect",e.OnCallEnd="onCallEnd",e.CallingLayoutChanged="callingLayoutChanged",e.CallLayoutChanged="callLayoutChanged",e.CallStatusChanged="callStatusChanged",e.DevicesPermissions="devicesPermissions",e.DominantSpeakerChanged="dominantSpeakerChanged",e.EndpointRegistered="endpointRegistered",e.RecentConversationsFetched="recentConversationsFetched",e.UnreadConversationsUpdate="unreadConversationsUpdate",e.ReceivedNotification="receivedNotification",e.HideNotification="hideNotification",e.OpenRecentList="openRecentList",e.recentsShown="recentsShown",e.recentsHidden="recentsHidden",e.RecentItemSelected="onRecentItemSelected",e.recentsUIReady="recentsUIReady",e.recentItemsLoaded="recentItemsLoaded",e.onMessageExpand="onMessageExpand",e.onMessageCollapse="onMessageCollapse",e.OnConversationDelete="onConversationDelete",e.scrollToBottom="scrollToBottom",e.hideBubbleWindow="hideBubbleWindow",e.errorCode="errorCode",e.invoke={sendMessageToBotResponse:"invoke:sendMessageToBot:response",sendMessageToBot:"invoke:sendMessageToBot",signOut:"invoke:signOut",startCall:"invoke:startCall",stopCall:"invoke:stopCall",setAad:"invoke:setAad",getTokenExpirationTime:"invoke:getTokenExpirationTime",registerMask:"registerMask",unregisterMask:"unregisterMask"},e.cmd={reg:"cmd:register",unreg:"cmd:unregister",exec:"cmd:execute"},e.threadNotificationsProxy={reg:"proxy:threadNotifications:register",unreg:"proxy:threadNotifications:unregister",notify:"proxy:threadNotifications:notify"},e.messagingProxy={disconnect:"proxy:messaging:disconnect",disconnected:"proxy:messaging:disconnected"},e.conversationProxy={disableInput:"proxy:conversation:disableInput",expand:"proxy:conversation:expand",connected:"proxy:conversation:connected",focusInput:"proxy:conversation:focusInput",openFilePicker:"proxy:conversation:filepicker",setInputPlaceholder:"proxy:conversation:placeholder",setMessageProperties:"proxy:conversation:setMessageProperties",setInputText:"proxy:conversation:inputtext",toggleEmoticonPicker:"proxy:conversation:emoticonpicker",showConfirmationDialog:"proxy:conversation:showConfirmationDialog",resShowConfirmationDialog:"proxy:conversation:resShowConfirmationDialog",regMessageReceived:"proxy:conversation:regMessageReceived",messageReceived:"proxy:conversation:messageReceived",regUnreadCount:"proxy:conversation:regUnreadCount",unreadCount:"proxy:conversation:unreadCount",setActionBar:"proxy:conversation:setActionBar",resActionBar:"proxy:conversation:resActionBar",regDownload:"proxy:conversation:regDownload",resDownload:"proxy:conversation:resDownload"},e.proxy={resolve:"proxy:resolve",request:"proxy:request"},e.bridge={theme:{request:"bridge:request:theme",return:"bridge:request:return"}},e}();t.ApiEvents=r;var i=function(){function e(){}return e.SELECTED_PARTICIPANTS_CHANGE="selectedParticipants:change",e}();t.ParticipantEvents=i;var o=function(){function e(){}return e.SCROLL_RECOUNT="scroll:recount",e}();t.ScrollEvents=o;var s=function(){function e(){}return e.ITEM_SELECT_REQUEST="pes:picker:selectRequest",e.ITEM_SEND_REQUEST="pes:picker:sendRequest",e.ITEM_CANCEL_REQUEST="pes:picker:cancelRequest",e.OPEN_PICKER="pes:picker:open",e.SEARCH_QUERY_CHANGED="pes:picker:searchQueryChanged",e.CLEAR_SEARCH_RESULTS="pes:picker:clearSearchResults",e}();t.ExpressionPickerEvents=s;var a=function(){function e(){}return e.SEARCH_START="search:start",e.SHOW_CONTACTS="show:contacts",e.UPDATE_SEARCH_RESULTS="search:updateResults",e.TOGGLE_RESULTS_COMPONENT="search:toggleResultsComponent",e.SEARCH_CREATE_CONTACTLIST="create:contactlist",e.EMPTY_QUERY="search:EmptyQuery",e.FOCUS_SEARCH_INPUT="search:FocusInput",e.EMPTY_RESULTS="search:emptyResults",e}();t.SearchEvents=a;var c=function(){function e(){}return e.SHOW="campaign:show",e.DISMISS="campaign:dismiss",e}();t.CampaignEvents=c,function(e){e.TokenProviderRequest="swc:auth:request:tokenprovider",e.TokenProviderResponse="swc:auth:response:tokenprovider",e.RegionGtmsRequest="swc:auth:request:regiongtms",e.RegionGtmsResponse="swc:auth:response:regiongtms"}(t.AuthEvents||(t.AuthEvents={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(30),i=function(){function e(){}return e.Create=function(t,n,i){void 0===i&&(i=r.PIIType.NotSet);var o=new e;return o.key=t,o.value=n,o.type=i,o},e}();t.TelemetryPropertyValue=i},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s=n(18),a=n(13),c=n(0),u=n(38),l=function(e){function t(){var t=e.call(this)||this;return t.sessionId="",t.backend=a.MessagingBackend.UNDETERMINED,t.style="",t.translatorEnabled=!1,t.frameless=!1,t.callingReady=!1,t.standaloneCalling=!1,t.largeEmoticonClass=!1,t.isParallelView=!1,t.parentProtocol="n/a",t.bridge(),t}return i(t,e),Object.defineProperty(t,"get",{get:function(){return c.swc.shared.app||(c.swc.shared.app=new t),c.swc.shared.app},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentLocale",{get:function(){return u.default.locale},enumerable:!0,configurable:!0}),t.prototype.copy=function(e){e&&Object.getOwnPropertyNames(e).forEach(function(n){var r=Object.getOwnPropertyDescriptor(e,n);r&&r.writable&&(t[n]=r.value||t[n])})},t.prototype.isTeams=function(){return this.backend===a.MessagingBackend.TEAMS},Object.defineProperty(t.prototype,"theme",{get:function(){return this._theme},set:function(e){e!==this._theme&&(this._theme=e,this.publish("theme",e))},enumerable:!0,configurable:!0}),t.prototype.bridge=function(){var e=this;c.swc.API.registerEvent(o.ApiEvents.bridge.theme.return,function(t){return e.theme=t}),c.swc.API.triggerEvent(o.ApiEvents.bridge.theme.request)},t}(s.default);t.default=l},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(29)),r(n(94)),r(n(95)),r(n(96)),r(n(41)),r(n(97))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(2),o=n(19),s=n(5);t.NA="n/a";var a=function(){function e(e){this.name=e,this.timestamp=Date.now(),this.type="general"}return e.prototype.getEventProperties=function(){return this.version=s.TelemetryPropertyValue.Create("version",i.default.ECS.version),this.host=s.TelemetryPropertyValue.Create("host",this.gethost()),this.isFirstPartyIntegration=s.TelemetryPropertyValue.Create("isFirstParty",this.isFirstParty()),this.lang=s.TelemetryPropertyValue.Create("locale",r.default.get.currentLocale),this.correlationId||(this.correlationId=s.TelemetryPropertyValue.Create("correlationId",r.default.get.correlationId)),this.identityType=this.identityType||s.TelemetryPropertyValue.Create("identitytype",t.NA),this.getCustomProperties()},e.prototype.getProperty=function(e){return void 0===e||null===e?t.NA:"string"!=typeof e?e+"":e},e.prototype.gethost=function(){return r.default.get.host&&r.default.get.host.toLowerCase()!==t.NA.toLowerCase()?r.default.get.host:o.default.getHost()||t.NA},e.prototype.isFirstParty=function(){var e=this.gethost();return[".skype.com",".bing.com",".live.com",".office.com",".office365.com",".msn.com",".linkedin.com",".azure.com",".microsoft.com"].some(function(t){return e.indexOf(t)>-1})},e}();t.TelemetryEvent=a},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.HTTP_ERROR_RANGE=1e3]="HTTP_ERROR_RANGE",e[e.ERR_FAIL_INIT=1]="ERR_FAIL_INIT",e[e.ERR_PARSE_RESPONSE=111]="ERR_PARSE_RESPONSE",e[e.ERR_PARSE_RESPONSE2=112]="ERR_PARSE_RESPONSE2",e[e.INFO_CONVERSATION_ALREADY_SUBSCRIBED=1e4]="INFO_CONVERSATION_ALREADY_SUBSCRIBED",e[e.INFO_REQUESTED_ECS=10001]="INFO_REQUESTED_ECS",e[e.ERR_UNSUPPORTED_CONVERSATION_ID=10002]="ERR_UNSUPPORTED_CONVERSATION_ID",e[e.ERR_UNSUPPORTED_CONVERSATION_ID_TYPE=10003]="ERR_UNSUPPORTED_CONVERSATION_ID_TYPE",e[e.ERR_RESOURCE_ALREADY_HANDLED=10004]="ERR_RESOURCE_ALREADY_HANDLED",e[e.ERR_UPDATE_SUBSCRIPTION=10005]="ERR_UPDATE_SUBSCRIPTION",e[e.ERR_ME_PERSON_ALREADY_FETCHED=10006]="ERR_ME_PERSON_ALREADY_FETCHED",e[e.ERR_FETCH_ME_PERSON=10007]="ERR_FETCH_ME_PERSON",e[e.INFO_CONTACT_ALREADY_SUBSCRIBED=10008]="INFO_CONTACT_ALREADY_SUBSCRIBED",e[e.ERR_DESTINATION_NOT_REACHABLE=10009]="ERR_DESTINATION_NOT_REACHABLE",e[e.DBG_DL_REQUIRES_TOKEN=10011]="DBG_DL_REQUIRES_TOKEN",e[e.ERR_GET_CONVERSATION_ID=10021]="ERR_GET_CONVERSATION_ID",e[e.DL_SERVICE_CREATE_CONVERSATION=10024]="DL_SERVICE_CREATE_CONVERSATION",e[e.ERR_CREATE_CONVERSATION=10025]="ERR_CREATE_CONVERSATION",e[e.DL_SERVICE_SEND_MESSAGE=10023]="DL_SERVICE_SEND_MESSAGE",e[e.ERR_SEND_MESSAGE=10026]="ERR_SEND_MESSAGE",e[e.ERR_RESET_TOKEN=10027]="ERR_RESET_TOKEN",e[e.ERR_SET_TOKEN_REFRESH_TIMEOUT=10028]="ERR_SET_TOKEN_REFRESH_TIMEOUT",e[e.ERR_UNDEFINED_IDENTITY_TYPE=10029]="ERR_UNDEFINED_IDENTITY_TYPE",e[e.ERR_PARSE_JSON=10030]="ERR_PARSE_JSON",e[e.ERR_UNKNOWN_BACKEND=10033]="ERR_UNKNOWN_BACKEND",e[e.ERR_INVALID_TIMEOUT=10040]="ERR_INVALID_TIMEOUT",e[e.INFO_JSON_EMPTY=10041]="INFO_JSON_EMPTY",e[e.INFO_ASYNC_FLAG_NOT_BOOLEAN=10042]="INFO_ASYNC_FLAG_NOT_BOOLEAN",e[e.ERR_UNSUPPORTED_LANGUAGE=10050]="ERR_UNSUPPORTED_LANGUAGE",e[e.ERR_NOT_SUPPORTED_YET=10051]="ERR_NOT_SUPPORTED_YET",e[e.ERR_NAME_ALREADY_EXISTS=10060]="ERR_NAME_ALREADY_EXISTS",e[e.ERR_CALLBACK_NAMESPACE_ALREADY_EXISTS=10061]="ERR_CALLBACK_NAMESPACE_ALREADY_EXISTS",e[e.ERR_INIT_POLLING=10070]="ERR_INIT_POLLING",e[e.ERR_PARSE_POLLING=10071]="ERR_PARSE_POLLING",e[e.DL_SERVICE_INIT_POLLING=10072]="DL_SERVICE_INIT_POLLING",e[e.ERR_PES_CONFIG_LOAD=10080]="ERR_PES_CONFIG_LOAD",e[e.ERR_LOAD_IMG=10110]="ERR_LOAD_IMG",e[e.ERR_UNKNOWN_MESSAGE_TYPE=10250]="ERR_UNKNOWN_MESSAGE_TYPE",e[e.ERR_I18N_NOT_INITIALIZED=10500]="ERR_I18N_NOT_INITIALIZED",e[e.ERR_CONVERSATION_MISSING=10501]="ERR_CONVERSATION_MISSING",e[e.ERR_DEFINE_CONVERSATION_PREFIX=10502]="ERR_DEFINE_CONVERSATION_PREFIX",e[e.ERR_FETCH_ME_PERSON_AND_LOAD_PES=10503]="ERR_FETCH_ME_PERSON_AND_LOAD_PES",e[e.ERR_CREATE_GROUP_WITH_GUEST=10504]="ERR_CREATE_GROUP_WITH_GUEST",e[e.DBG_EMPTY_CHAT_SHOWN=10505]="DBG_EMPTY_CHAT_SHOWN",e[e.INFO_JOIN_GROUP_DISABLED=10506]="INFO_JOIN_GROUP_DISABLED",e[e.ERR_JOIN_CONVERSATION=10507]="ERR_JOIN_CONVERSATION",e[e.ERR_SENDING_MESSAGE_TO_BOT=10508]="ERR_SENDING_MESSAGE_TO_BOT",e[e.ERR_FETCH_THREAD=10509]="ERR_FETCH_THREAD",e[e.ERR_ADD_BOT_TO_CONVERSATION=10510]="ERR_ADD_BOT_TO_CONVERSATION",e[e.ERR_ADD_PERSON_TO_CONVERESATION=10511]="ERR_ADD_PERSON_TO_CONVERESATION",e[e.ERR_REMOVE_PERSON_FROM_CONVERSATION=10512]="ERR_REMOVE_PERSON_FROM_CONVERSATION",e[e.ERR_RESOLVE_USER_DETAILS=10801]="ERR_RESOLVE_USER_DETAILS",e[e.ERR_UPDATE_CALLING_SCREEN=10901]="ERR_UPDATE_CALLING_SCREEN",e[e.ERR_HIDE_CALLING_SCREEN=10902]="ERR_HIDE_CALLING_SCREEN",e[e.ERR_FETCH_CONTACTS_MAIN=11001]="ERR_FETCH_CONTACTS_MAIN",e[e.ERR_FETCH_CONTACT_MAIN=11002]="ERR_FETCH_CONTACT_MAIN",e[e.ERR_FETCH_CONTACTS_TEAMS=11010]="ERR_FETCH_CONTACTS_TEAMS",e[e.ERR_GET_ECS_CONFIG=12001]="ERR_GET_ECS_CONFIG",e[e.ERR_GET_ADVANCED_SEARCH_PARAMS=12002]="ERR_GET_ADVANCED_SEARCH_PARAMS",e[e.ERR_START_CONVERSATION=100001]="ERR_START_CONVERSATION",e[e.ERR_FETCH_ME_PERSON_IN_LIST=101010]="ERR_FETCH_ME_PERSON_IN_LIST",e[e.ERR_START_CONVERSATION_WITH_BOT=105001]="ERR_START_CONVERSATION_WITH_BOT",e[e.ERR_CHECK_CONVERSATION_STATUS=105002]="ERR_CHECK_CONVERSATION_STATUS",e[e.ERR_CREATE_SUMMARY_NOTIFICATION=200001]="ERR_CREATE_SUMMARY_NOTIFICATION",e[e.ERR_CREATE_CALL_NOTIFICATION=200003]="ERR_CREATE_CALL_NOTIFICATION",e[e.ERR_UNIFIED_PRESENCE_FAILED=103501]="ERR_UNIFIED_PRESENCE_FAILED",e[e.ERR_UNIFIED_PRESENCE_NO_AAD=103502]="ERR_UNIFIED_PRESENCE_NO_AAD"}(t.ErrorCodes||(t.ErrorCodes={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(10),o=n(86),s=n(0),a=function(){function e(){}return e.throwError=function(e,t,n,i){var a=new Error(function(){if(!n||0===Object.getOwnPropertyNames(n).length)return e+(t?": "+t:"");if("string"==typeof n)return n;var r="";return Object.getOwnPropertyNames(n).forEach(function(e){r+=e+": "+n[e]+";"}),r}()),c=new o.ErrorEvent;c.code=e+"",c.message=a.message,c.shortMessage=e+(t?": "+t:""),c.stack=a.stack,c.conversationId=i,s.swc.API.triggerEvent(r.ApiEvents.errorCode,e);try{s.swc.services.telemetryManager.sendEvent(c)}catch(e){}},e.throwHttpErrorCode=function(e,t){e+=i.ErrorCodes.HTTP_ERROR_RANGE,s.swc.API.triggerEvent(r.ApiEvents.errorCode,e)},e}();t.default=a},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.UNDETERMINED=10]="UNDETERMINED",e[e.SKYPE=100]="SKYPE",e[e.DIRECT_LINE=200]="DIRECT_LINE",e[e.TEAMS=300]="TEAMS"}(t.MessagingBackend||(t.MessagingBackend={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(2),o=n(13),s=n(25),a=n(99),c=n(57),u={"<":"&lt;",">":"&gt;","&lt;":"<","&gt;":">","&LT;":"<","&GT;":">","&":"&amp;",'"':"&quot;","'":"&apos;","&amp;":"&","&quot;":'"',"&apos;":"'","&#39;":"'","&#96;":"`","&AMP;":"&","&QUOT;":'"',"&APOS;":"'"},l='(?:(?:\\s*title="[^"]+?"\\s*)|(?:\\s*tabindex="-1"\\s*)|(?:\\s*target="_blank"\\s*)){0,3}',p=a.default.multilineRegExp(["(&lt;a ",l,'href="((?:https?://|mailto:)[^"]+?)"',l,"&gt;)","((?:(?!&lt;/a&gt;)[\\s\\S])*)","(&lt;/a&gt;)"],"gi"),d={ALLOWED_TAGS:["span","canvas"],ALLOWED_ATTR:["id","type","data-item-id","class","data-is-animated"]},f={ALLOWED_TAGS:["b","i","s","br","at","ss","h1","h2","h3","h4","h5","h6","span","div","quote","ul","li","ol","em","strong","br","canvas","p","title","description"],ALLOWED_ATTR:["tabindex","title","target","id","type","data-item-id","class","data-is-animated"]},h=function(){function e(){}return e.map=function(e){return u[e]},e.multilineRegExp=function(e,t){return new RegExp(e.join(""),t)},e.modifyLinkAnchorOpening=function(e,t){return e.search(a.default.escapeSpecialChars(t))>-1?e:e.replace(/(<a|&lt;a)/,function(e){return e+" "+t})},e.escapeBrackets=function(e){return e.replace(/([<>])/gi,this.map)},e.unescapeBrackets=function(e){return e.replace(/(&lt;|&gt;)/gi,this.map)},e.unescape=function(e){return e.replace(/(&lt;|&gt;|&amp;|&quot;|&apos;|&#39;|&#96;)/gi,this.map)},e.validateUnescapedLink=function(e){return this.escapeBrackets(e).replace(p,this.validateAnchor)},e.parseTopic=function(t){return t?(t?e.unescape(t):"").replace(/<[^a\/].*?>(.*?)<\/[^a].*?>/gi,"$1").replace(/(<.*?\.{3,})$/,"").trim():t},e.getMessageSanitizedContent=function(e,t){var n={ALLOWED_TAGS:[],ALLOWED_ATTR:[]};return t&&t.noLinks?n=f:t&&t.noFormatting?n=d:(n={ALLOWED_TAGS:f.ALLOWED_TAGS.concat(["a"]),ALLOWED_ATTR:f.ALLOWED_ATTR.concat(["href"])},r.default.get.backend===o.MessagingBackend.TEAMS&&(n.ALLOWED_TAGS.push("img"),n.ALLOWED_ATTR.push("src","style","alt"))),s.default.dompurify.sanitize(e,n)},e.validateAnchor=function(t,n,r,i,o){var s=e.unescapeBrackets(n),a=e.unescapeBrackets(o);return 0!==r.indexOf("mailto:")&&(s=e.modifyLinkAnchorOpening(s,'target="_blank"')),s=e.modifyLinkAnchorOpening(s,'tabindex="-1"'),(s=e.modifyLinkAnchorOpening(s,'title="'+r+'"'))+i+a},e.webify=function(e){return e.replace(/(\r?\n)|(&lt;br\s?\/&gt;)/gm,"<br/>")},e.attachActionToLinks=function(e,t,n,r){if(1===e.nodeType&&e.matches(t))for(var i=e.querySelectorAll("a"),o=0;o<i.length;o++){var s=i[o];if(s.href.indexOf(n)>1){var a=c.default.getQueryParameter(s.href,n);a&&(s.setAttribute("data-swc-payload",a),s.addEventListener("click",r))}}},e.getSenderIdFromUrl=function(e){if(!e)return e;var t=e.match(/\/(\d+:[^?/]*)/);return t&&t[1]?t[1]:(e.match(/(\d+:[^?/]*)/),e)},e.extractMsgContent=function(e){return 0!==e.indexOf(i.default.MSG_DELETED_CLASSIC_SKYPE)?e:e.slice(i.default.MSG_DELETED_CLASSIC_SKYPE.length,e.length)},e}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(50),i=n(1),o=n(7),s=n(75),a=n(14),c=n(43),u=function(){function e(){var e=this;this.encoder=new r.default,this.decodeContent=function(t){return e.encoder.decode(t)}}return e.prototype.generate=function(e){return null},e.prototype._createMessageModel=function(e,t,n){void 0===n&&(n=!1);var r=new s.default(n),u=void 0!==t?t:e.content;n?e.customType&&(r.customType=e.customType):(r.senderId=a.default.getSenderIdFromUrl(e.from),r.sender=i.default.instance.Persons.getPerson(r.senderId,!0));var l=i.default.instance.MePersonManager.isMe(c.default.normalizePersonId(r.senderId));r.id=e.id,r.content=u?this.decodeContent(u):"",r.timestamp=new Date(e.originalarrivaltime),r.originalTimestamp=r.timestamp,r.composeTime=new Date(e.composetime),r.skypeEditedId=e.skypeeditedid,r.key=e.skypeeditedid||e.clientmessageid||e.id||"0",r.direction=n||!l?o.Direction.Incoming:o.Direction.Outgoing,r.rawMessageType=e.messagetype,r.clientMessageId=e.clientmessageid,r.editedTimestamp=e.properties&&e.properties.edittime?new Date(parseInt(e.properties.edittime,10)):null,r.deletedTimestamp=e.properties&&e.properties.deletetime?new Date(parseInt(e.properties.deletetime,10)):null;var p,d=!!e.skypeeditedid||!!r.editedTimestamp,f=!u&&!!e.skypeeditedid||!!r.deletedTimestamp;if(r.isEdited=d,r.isDeleted=f,r.version=Number(e.version),e.properties&&e.properties.files)try{var h=JSON.parse(e.properties.files);(p=r.files).push.apply(p,h)}catch(e){}return r},e.prototype._generateOutgoingModel=function(e){var t=new s.default(!1,e);return t.id=e.clientmessageid,t.timestamp=new Date(e.composetime),t.originalTimestamp=t.timestamp,t.key=e.clientmessageid,t.senderId=i.default.instance.MePersonManager.mePerson.mri,t.direction=o.Direction.Outgoing,t.content=this.decodeContent(e.content),t.processedContent=e.processedcontent,t.rawMessageType=e.messagetype,t.clientMessageId=e.clientmessageid,t},e.prototype.parseContentFor=function(e,t){var n=new RegExp("<"+t+">(.+?)</"+t+">","i"),r=e.match(n);return r?r[1]:""},e}();t.default=u},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),i=n(17),o=n(70),s=n(103),a=n(252),c=500;t.default=function(e,t,n,r){var i=this;return 0,new Promise(function(o,s){var a=function(l){u(e,t.timeout,n,r).then(function(e){e.callCount=l,o(e)}).catch(function(e){0===e.status&&l<t.retryCount?setTimeout(a.bind(i,l+1),c):s(e)})};a(1)})};var u=function(t,n,c,u){var p=Date.now(),d=u?u.method:null,f=function(e){var n=Date.now()-p;return e.ok||(a.ServiceFaultEvent.report(t,e,n,c+""),r.default.throwHttpErrorCode(e.status,e.statusText)),s.default().register(t,c+"",n,e,d),Promise.resolve(e)},h=function(e){var n=Date.now()-p;return a.ServiceFaultEvent.report(t,e,n,c+""),s.default().register(t,c+"",n,e,d),Promise.reject(e)};return o.get().onceOnline().then(function(){var t=e(c,u),r=new i.CancelablePromise(t);return l(r,n).then(f,h)},function(e){return Promise.reject(e)})},l=function(e,t){var n=setTimeout(function(){n=null,e.cancel({ok:!1,status:0,statusText:"Timeout"})},t),r=function(){n&&clearTimeout(n)};return e.promise.then(r,r),e.promise}}).call(this,n(61))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e){var t=this;this._isCanceled=!1,this._status=r.Pending,this.cancel=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t._isCanceled||(t._isCanceled=!0,e[0]=e[0]||{},e[0].isCanceled=!0,t._status=r.Rejected,t._reject.apply(t._promise,e))},this._promise=new Promise(function(n,i){t._resolve=n,t._reject=i,e&&(e.then(function(e){t._isCanceled||(t._status=r.Resolved,n(e))},function(e){t._status=r.Rejected,i(e)}),e.catch(function(e){t._status=r.Rejected,t._isCanceled?i({isCanceled:!0}):i(e)}))})}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCanceled",{get:function(){return this._isCanceled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),e.prototype.resolve=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._status!==r.Resolved&&(this._status=r.Resolved,this._resolve.apply(this._promise,e))},e.prototype.cancelQuitely=function(){this.status===r.Pending&&(this.promise.then(function(){},function(){}),this.cancel())},e}();t.CancelablePromise=i,function(e){e[e.Pending=0]="Pending",e[e.Resolved=1]="Resolved",e[e.Rejected=2]="Rejected"}(r=t.PromiseStatus||(t.PromiseStatus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;this.callbacks={},this.subscribe=function(t,n){void 0===e.callbacks[t]&&(e.callbacks[t]=new Array),e.callbacks[t].push(n)},this.unsubscribe=function(t,n){if(void 0!==e.callbacks[t]){var r=e.callbacks[t].indexOf(n);r>-1&&e.callbacks[t].splice(r,1)}},this.publish=function(t,n){void 0!==e.callbacks[t]&&e.callbacks[t].map(function(e){return e}).forEach(function(e){e(n)})}}return e.prototype.dispose=function(){for(var e in this.callbacks)this.callbacks.hasOwnProperty(e)&&(this.callbacks[e]=null);this.callbacks={}},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(39),i=n(0),o=n(92),s={allowedDomains:["swc.cdn.skype.com","latest-swc.cdn.skype.com"]},a=function(){function e(){}return e.combine=function(e,t){return e.lastIndexOf("/")!==e.length-1&&"/"!==t.substring(0,1)?e+"/"+t:this.getAppPath()+e+t},e.getAbsoluteUrl=function(e,t){var n=this.getCompletePath(e,t),o="css"===t?"css/":"";return e===r.PackageName.SDK_LOADER_CHAT?this.combine(i.swc.EcsConfig.loaderUrl,n):e===r.PackageName.CONNECT?this.combine(i.swc.EcsConfig.loaderUrl,n):this.combine(o,n)},e.getCompletePath=function(e,t){var n="";switch(i.swc.EcsConfig.environment){case"df":case"ppe":case"prod":n=".min"}return""+e+n+"."+t},e.setQueryParameters=function(e,t){return e+"?"+this.buildQueryParameters(t)},e.buildQueryParameters=function(e){var t=[];return Object.keys(e).forEach(function(n){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]))}),t.join("&")},e.getHost=function(){try{var e=window.location.hostname;return!e&&e.length>0?e:("file:"===window.location.protocol.toLowerCase()&&(e="local"),e)}catch(e){return null}},e.getVendorPath=function(){return e.getCDNPath()+"/vendors"},e.getConnectPagePath=function(){return e.getAppPath()+"connect.html"},e.getAppPath=function(){var t=0===i.swc.EcsConfig.version.indexOf("fb-")?"fb":"v";return e.getCDNPath()+"/"+t+"/"+i.swc.EcsConfig.version+"/"},e.getCDNPath=function(){var t=i.swc.EcsConfig.domain;return e.validateUriOrDie(t,s),t},e.validateUriOrDie=function(e,t){if(!o.UrlValidator.instance.validate(e,t))throw new Error("Invalid URI!")},e.appendQueryParam=function(e,t,n){return e+(-1===e.indexOf("?")?"?":"&")+encodeURIComponent(t)+"="+encodeURIComponent(n)},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.guid={generate:function(){var e=new Uint16Array(8);(window.crypto||window.msCrypto).getRandomValues(e);var t=0,n=function(){return(4369|e[t++]).toString(16)};return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()},isGuid:function(e){return/^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$/.test(e)}}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(17),a=n(18),c=n(39),u=n(0),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getServices=function(){if(!u.swc||!u.swc.services)throw new Error("Unable to find services");return u.swc.services},t}(a.default);t.default=l,t.loadServices=function(){return o?o.promise:(o=new s.CancelablePromise,u.swc.services?(o.resolve(u.swc.services),o.promise):(u.swc.scriptLoader.addScript(c.PackageName.SERVICES,!0,function(){var e=u.swc.services;o.resolve(e)}),o.promise))},t.getServices=function(){var e=u.swc.services;if(!e)throw new Error("Services are not found");return e}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.SignedOut=0]="SignedOut",e[e.SigningIn=1]="SigningIn",e[e.SignedIn=2]="SignedIn",e[e.SigningOut=3]="SigningOut"}(t.SigninState||(t.SigninState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,o,s=n(33),a=n(28),c=n(20),u={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"};!function(e){e.Desktop="Desktop",e.Mobile="Mobile",e.Tablet="Tablet"}(r=t.DeviceType||(t.DeviceType={})),function(e){e.MSIE="MSIE",e.CHROME="Chrome",e.FIREFOX="Firefox",e.SAFARI="Safari",e.EDGE="Edge",e.ELECTRON="Electron",e.SKYPE_SHELL="SkypeShell",e.PHANTOMJS="PhantomJS",e.UNKNOWN="Unknown"}(i=t.BrowserVendor||(t.BrowserVendor={})),function(e){e.WINDOWS="Windows",e.MACOSX="Mac OS X",e.WINDOWS_PHONE="Windows Phone",e.WINDOWS_RT="Windows RT",e.IOS="iOS",e.ANDROID="Android",e.LINUX="Linux",e.UNKNOWN="Unknown"}(o=t.OperatingSystem||(t.OperatingSystem={})),t.UNKNOWN_VERSION="U";var l=function(){function e(){}return e.getDeviceType=function(){return window.navigator.userAgent.match(/(android|ipod|windows phone|wpdesktop|windows ce|blackberry\w*|meego|webos|palm|symbian|pda|\w*?mobile\w*?|\w*?phone\w*?)/i)?r.Mobile:window.navigator.userAgent.match(/tablet|ipad/i)?r.Tablet:r.Desktop},e.getUserAgent=function(){return a.default.getWindow().navigator.userAgent},e.userAgentContainsString=function(e){return this.getUserAgent().indexOf(e)>-1},e.isChrome=function(){return this.userAgentContainsString(i.CHROME)&&!this.userAgentContainsString(i.EDGE)},e.isIe=function(){return this.userAgentContainsString("Trident")},e.isEdge=function(){return this.userAgentContainsString(i.EDGE)},e.isOpera=function(){return this.userAgentContainsString("OPR/")},e.testSupporedList=function(t){if(!t)return!1;t.constructor!==Array&&"string"==typeof t&&(t=[t]);for(var n=e.getBrowserName().toLocaleLowerCase(),r=0;r<t.length;r++)if(t[r].toLowerCase().indexOf(n)>-1)return!0;return!1},e.getBrowserName=function(){return this.isOpera()?i.UNKNOWN:this.userAgentContainsString(i.PHANTOMJS)?i.PHANTOMJS:this.isEdge()?i.EDGE:this.userAgentContainsString(i.ELECTRON)?i.ELECTRON:this.userAgentContainsString(i.CHROME)?i.CHROME:this.userAgentContainsString(i.FIREFOX)?i.FIREFOX:this.userAgentContainsString(i.SAFARI)?i.SAFARI:this.userAgentContainsString(i.SKYPE_SHELL)?i.SKYPE_SHELL:this.isIe()?i.MSIE:i.UNKNOWN},e.getBrowserVersion=function(){var e,n,r,o,s,a=this;return this.isIe()?(o=a.getUserAgent(),(s=o.match(new RegExp(i.MSIE+" ([\\d,.]+)")))?s[1]:(r=o.match(new RegExp("rv:([\\d,.]+)")))?r[1]:void 0):((e=this.getBrowserName())===i.SAFARI&&(e="Version"),(n=a.getUserAgent().match(new RegExp(e+"/([\\d,.]+)")))?n[1]:t.UNKNOWN_VERSION)},e.getScreenInfo=function(){var e=a.default.getWindow(),t=a.default.getWindow().navigator;return{width:a.default.getWindow().screen&&a.default.getWindow().screen.width||0,height:a.default.getWindow().screen&&a.default.getWindow().screen.height||0,pixelRatio:a.default.getWindow().devicePixelRatio||0,colorDepth:a.default.getWindow().screen&&a.default.getWindow().screen.colorDepth||0,isTouchEnabled:Object.prototype.hasOwnProperty.call(e,"ontouchstart")||t.MaxTouchPoints>0}},e.getOsName=function(){var e=this.getUserAgent();return e.match(/windows\sphone\s\d+\.\d+/i)?o.WINDOWS_PHONE:e.match(/ arm;/i)?o.WINDOWS_RT:e.match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?o.IOS:e.match(/android/i)?o.ANDROID:e.match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|cros)/i)?o.LINUX:e.match(/(macintosh|mac os x)/i)?o.MACOSX:e.match(/(windows|win32)/i)?o.WINDOWS:o.UNKNOWN},e.getOsVersion=function(e){var n=this;void 0===e&&(e=!1);var r;return this.getOsName()===o.WINDOWS?function(e){var r=n.getUserAgent().match(new RegExp("Windows NT ([\\d,.]+)"));if(r){if(e)return r[1];if(u[r[1]])return u[r[1]]}return t.UNKNOWN_VERSION}(e):this.getOsName()===o.MACOSX&&(r=n.getUserAgent().match(new RegExp(o.MACOSX+" ([\\d,_,.]+)")))?r[1].replace(/_/g,"."):t.UNKNOWN_VERSION},e.getDeviceId=function(){var e=s.LocalStorage,t=e.getItem("swc-deviceId");return t||(t=c.guid.generate(),e.setItem("swc-deviceId",t)),t},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return Object.defineProperty(e,"dompurify",{get:function(){var e=window;return e.DOMPurify||(e.DOMPurify=n(68)),e.DOMPurify},enumerable:!0,configurable:!0}),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.PERSON=1]="PERSON",e[e.THREAD=2]="THREAD",e[e.BOT=3]="BOT",e[e.JOIN_URL=4]="JOIN_URL",e[e.DIRECT_LINE_TOKEN=5]="DIRECT_LINE_TOKEN",e[e.PHONE=6]="PHONE"}(t.SDKMode||(t.SDKMode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(1),o=n(13),s=function(){function e(e,t,n){var r=this;this._createMessageModel=e,this._generateContent=t,this._subscribedCallbacks={},this._subscribeOnceToPersonsName=function(e){r._subscribedCallbacks[e.id]||(r._subscribedCallbacks[e.id]=r._onDisplayNameChanged.bind(r,e.id),e.subscribe("displayName",r._subscribedCallbacks[e.id]))},this._onDisplayNameChanged=function(e){r._messageModel.content=r._generateContent(r),r._initiator.unsubscribe("displayName",r._subscribedCallbacks[e])},this._getInitiatorFromContent(n.content),this._getTargetsFromContent(n.content),this._messageModel=this._createMessageModel(n,this._generateContent(this),!0)}return e.prototype._isSelfAction=function(){return 1===this._targets.length&&this._targets[0].id===this._initiator.id},e.prototype._getInitiatorFromContent=function(e){var t=e.match(/<initiator>(\d+:.+)<\/initiator>/i);t&&(this._initiator=i.default.instance.Persons.getPerson(t[1]))},e.prototype._getTargetsFromContent=function(e){var t=this,n=/(?:<target>|<id>)(\d+:.+?)(?:<\/id>|<\/target>)/i,s=[];(e.match(/<target>.+?<\/target>/gi)||[]).forEach(function(e){var t=e.match(n);t&&s.push(t[1])}),this._targets=s.map(function(e){return i.default.instance.Persons.getPerson(e)}),r.default.get.backend===o.MessagingBackend.TEAMS&&(this._targets=this._targets.filter(function(e){return e.mri!==t._initiator.mri}))},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.getWindow=function(){return window},e.getDocument=function(){return window.document},e.getParentWithClass=function(e,t){for(;e&&!this.hasClass(e,t);)e=e.parentNode;return e},e.isInViewport=function(e){var t=this.getWindow();return e.bottom>0&&e.right>0&&e.top<t.innerHeight&&e.left<t.innerWidth},e.readDataset=function(e,t,n){return e.dataset?e.dataset[t]:e.getAttribute("data-"+n)},e.writeDataset=function(e,t,n,r){e.dataset?e.dataset[t]=r:e.setAttribute("data-"+n,r)},e.hasClass=function(e,t){if(e.classList)return e.classList.contains(t);for(var n=0,r=e.className?e.className.split(" "):[];n<r.length;n++){if(r[n]===t)return!0}return!1},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Skype=8]="Skype",e[e.Agent=28]="Agent",e[e.Pstn=4]="Pstn",e[e.MSA=1]="MSA",e[e.Undefined=0]="Undefined"}(t.ContactType||(t.ContactType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NotSet=0]="NotSet",e[e.Identity=10]="Identity"}(t.PIIType||(t.PIIType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(41),i=n(11),o=n(26),s=n(10),a=function(){function e(){}return e.strip=function(e){var t=e.match(this.idRegExp);return t?t[2]:e},e.detectConversationType=function(e){if(!e)return r.ConversationType.UNDEFINED;if(this.typeMapppings[e])return this.typeMapppings[e];var t,n=e.match(this.idRegExp);if(n&&(t=this.getTypeByPrefix(n[1])),t)return this.typeMapppings[e]=t,t;if(0===e.indexOf("https://join.skype.com/"))return this.typeMapppings[e]=r.ConversationType.JOIN,r.ConversationType.JOIN;if(/^(28:)?[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i.test(e))return this.typeMapppings[e]=r.ConversationType.AGENT,r.ConversationType.AGENT;if(/^(19:)?[\S]+[@]([\S].)?[\S]*thread\.skype/i.test(e))return this.typeMapppings[e]=r.ConversationType.GROUP,r.ConversationType.GROUP;if(/(?:00|\+)?(^[^a-z][^A-Z])(\d+$)/i.test(e.replace(/\s+|[()\-\+]/gi,"")))return this.typeMapppings[e]=r.ConversationType.PHONE,r.ConversationType.PHONE;return/^(99:)?([A-Z]|[a-z][^\.])+([\S])*\.(cwA|dAA)/i.test(e)?(this.typeMapppings[e]=r.ConversationType.DIRECT_LINE,r.ConversationType.DIRECT_LINE):(this.typeMapppings[e]=r.ConversationType.PERSON,r.ConversationType.PERSON)},e.getSdkModeFromId=function(e){switch(this.detectConversationType(e)){case r.ConversationType.PERSON:return o.SDKMode.PERSON;case r.ConversationType.AGENT:return o.SDKMode.BOT;case r.ConversationType.JOIN:return o.SDKMode.JOIN_URL;case r.ConversationType.DIRECT_LINE:return o.SDKMode.DIRECT_LINE_TOKEN;case r.ConversationType.PHONE:return o.SDKMode.PHONE;case r.ConversationType.GROUP:return o.SDKMode.THREAD}return o.SDKMode.UNDEFINED},e.toFullIdentifier=function(e){var t=this.getPrefixForId(e);return 0===e.indexOf(t+":")?e:t?t+":"+e:e},e.addPrefix=function(e,t){return 0===t.indexOf(e+this.SPLITTER)?t:0===t.indexOf(this.SPLITTER)?e+t:e+this.SPLITTER+t},e.getNormalizeId=function(e){return e.match(this.idRegExp)?e.replace(/\d{1,2}:/,""):e},e.isEqual=function(e,t){return this.toFullIdentifier(e).toLowerCase()===this.toFullIdentifier(t).toLowerCase()},e.getPrefixForId=function(e){if(this.hasAlreadyPrefix(e))return"";var t=this.getSdkModeFromId(e);switch(t){case o.SDKMode.PERSON:return"8";case o.SDKMode.BOT:return"28";case o.SDKMode.THREAD:return"19";case o.SDKMode.DIRECT_LINE_TOKEN:return"99";case o.SDKMode.PHONE:return"4";default:i.default.throwError(s.ErrorCodes.ERR_DEFINE_CONVERSATION_PREFIX,"Unable to define conversation prefix",{id:e,sdkMode:t})}return""},e.getTypeByPrefix=function(e){if(!e)return r.ConversationType.UNDEFINED;switch(e.indexOf(":")>-1&&(e=e.replace(":","")),e){case"4":return r.ConversationType.PHONE;case"8":return r.ConversationType.PERSON;case"19":return r.ConversationType.GROUP;case"28":return r.ConversationType.AGENT;case"99":return r.ConversationType.DIRECT_LINE;default:return r.ConversationType.UNDEFINED}},e.hasAlreadyPrefix=function(e){var t=/^\d+:/.exec(e);return!!t&&!!t[0]},e.SPLITTER=":",e.idRegExp=/(\d{1,2}:)([\S]*)/,e.typeMapppings={},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.UNDETERMINED=10]="UNDETERMINED",e[e.GUEST=100]="GUEST",e[e.SKYPE=200]="SKYPE",e[e.DL_TOKEN=300]="DL_TOKEN",e[e.TEAMS=400]="TEAMS"}(t.IdentityType||(t.IdentityType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.getItem=function(e){return this.get().getItem(e)},e.setItem=function(e,t){this.get().setItem(e,t)},e.removeItem=function(e){this.get().removeItem(e)},e.get=function(){if(this._storage)return this._storage;try{"object"==typeof sessionStorage&&(localStorage.setItem("ls","0"),localStorage.removeItem("ls"),this._storage=window.sessionStorage)}catch(e){this._storage=new o}return this._storage},e}();t.default=r;var i=function(){function e(){}return e.getItem=function(e){var t=this.get();return t?t.getItem(e):""},e.setItem=function(e,t){this.get().setItem(e,t)},e.removeItem=function(e){this.get().removeItem(e)},e.get=function(){if(this._storage)return this._storage;try{"object"==typeof localStorage&&(localStorage.setItem("ls","0"),localStorage.removeItem("ls"),this._storage=window.localStorage)}catch(e){this._storage=new o}return this._storage},e}();t.LocalStorage=i;var o=function(){function e(){this._items={}}return Object.defineProperty(e.prototype,"length",{get:function(){return this._items.length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._items.length=0},e.prototype.getItem=function(e){return this._items[e]},e.prototype.key=function(e){return null},e.prototype.removeItem=function(e){delete this._items[e]},e.prototype.setItem=function(e,t){this._items[e]=t},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(24),i={id:"flik",ariaLabelLocKey:"expressionPicker_mruMojiPack_ariaLabel",titleLocKey:"expressionPicker_mruMojiPack_title",mruLimit:10},o=function(){function e(){var e=this;this.CACHE_KEY="swx|pes",this.SAVED_DATA_VERSION="v1.0",this.FEATURED_IN_PREFIX="FeaturedIn-",this.pesCDNAuthentication={skypeServiceHost:"static.asm.skype.com",tokenSourceEndpoint:"/pes/v1/petoken",cdnServiceHost:"static-asm.secure.skypeassets.com",cookieSourceEndpoint:"/token/token_to_cookies",securedPathsPatter:"static[.]asm[.]skype[.]com",cdnTokenTtlMs:3e5,rewriteRules:[{from:"static.asm.skype.com",to:"static-asm.secure.skypeassets.com"},{from:"api.asm.skype.com",to:"static-asm.secure.skypeassets.com"}]},this.itemTypes={typeKeyName:"type",tab:{id:"tab",ariaLabelLocKey:"expressionPicker_mruTab_ariaLabel",titleLocKey:"expressionPicker_mruTab_title"},emoticon:{id:"emoticon",ariaLabelLocKey:"expressionPicker_mruEmoticonPack_ariaLabel",titleLocKey:"expressionPicker_mruEmoticonPack_title",mruLimit:27},moji:i,image:{id:"image"},message:{id:"message"},sticker:{id:"sticker"},flik:i},this.mru={TAB_ID:"mru",PACK_PREFIX:"mru:"},this.bingSearch={TAB_ID:"bing",PACK_PREFIX:"bing:"},this.giphyImageSearch={TAB_ID:"giphyImages",PACK_PREFIX:"giphy-imh:"},this.localSearch={TAB_ID:"localSearch",PACK_PREFIX:"local:",titleLocKey:"expressionPicker_localSearchPack_title",ariaLabelLocKey:"expressionPicker_localSearchPack_ariaLabel"},this.frameHeights={emoticons:{SMALL:20,LARGE:40,EXTRA_LARGE:60,SUPER_LARGE:120},moji:{THUMBNAIL:40,KEYFRAME:80},packs:{TAB:19}},this.profiles={emoticons:{getSmall:function(){return e.highDpi?"default_40_f":"default_20_f"},getLarge:function(){return e.highDpi?"default_80_f":"default_40_f"},getExtraLarge:function(){return e.highDpi?"default_120_f":"default_60_f"},getSuperLarge:function(){return e.highDpi?"default_240_f":"default_120_f"},getSmallAnimated:function(){return e.highDpi?"default_40_anim_f":"default_20_anim_f"},getLargeAnimated:function(){return e.highDpi?"default_80_anim_f":"default_40_anim_f"},getExtraLargeAnimated:function(){return e.highDpi?"default_120_anim_f":"default_60_anim_f"},getSuperLargeAnimated:function(){return e.highDpi?"default_240_anim_f":"default_120_anim_f"}},moji:{thumbnail:"thumbnail",content:"default"}}}return Object.defineProperty(e.prototype,"highDpi",{get:function(){return this._highDpi||(this._highDpi=r.default.getScreenInfo().pixelRatio>1),this._highDpi},enumerable:!0,configurable:!0}),e}();t.default=new o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={"":"a","":"o","":"a","":"a","":"a","":"a","":"a","":"a","":"c","":"e","":"e","":"e","":"e","":"i","":"i","":"i","":"i","":"n","":"o","":"o","":"o","":"o","":"o","":"u","":"u","":"u","":"u","":"y","":"y","":"a","":"a","":"a","":"c","":"c","":"c","":"c","":"d","":"e","":"e","":"e","":"e","":"e","":"g","":"g","":"g","":"g","":"h","":"i","":"i","":"i","":"i","":"ij","":"j","":"k","":"l","":"l","":"l","":"l","":"n","":"n","":"n","":"n","":"o","":"o","":"o","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"t","":"t","":"u","":"u","":"u","":"u","":"u","":"u","":"w","":"y","":"z","":"z","":"z","":"s","":"o","":"u","":"dz","":"Lj","":"lj","":"Nj","":"nj","":"a","":"i","":"o","":"u","":"u","":"u","":"u","":"u","":"a","":"a","":"g","":"k","":"o","":"o","":"j","":"dz","":"g","":"n","":"a","":"a","":"a","":"e","":"e","":"i","":"i","":"o","":"o","":"r","":"r","":"u","":"u","":"s","":"t","":"h","":"a","":"e","":"o","":"o","":"o","":"o","":"y","":"h","":"j","":"r","":"w","":"y","":"l","":"s","":"x"},i=function(){function e(){}return e.toBoolean=function(e){return e?"true"===e.toLowerCase():null},e.wordAt=function(e,t){var n=this.wordBoundariesAt(e,t);return e.substring(n.start,n.end)},e.inject=function(e,t,n,r){return void 0===r&&(r=n),e.substr(0,n)+t+e.substr(r,e.length)},e.wordBoundariesAt=function(e,t){var n=e.substring(0,t).search(/\S+$/),r=e.substring(t).search(/\s/);return-1===n&&(n=t),-1===r?r=e.length:r+=t,{start:n,end:r}},e.b64DecodeUnicode=function(e){return decodeURIComponent(Array.prototype.map.call(atob(e),function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},e.zipString=function(e,t){return 0===e.length?t:0===t.length?e:e[0]+t[0]+this.zipString(e.substr(1),t.substr(1))},e.normalizeString=function(e){if(e=e.toLowerCase(),String.prototype.normalize)return e.normalize("NFKD").replace(/[\u0300-\u036f]/g,"");var t=parseInt("0xD800",16),n=parseInt("0xDBFF",16),i=0,o="",s="",a=void 0;if(!e)return e;for(;i<e.length;)o+=e.charAt(i),((a=e.charCodeAt(i))<t||a>n)&&(s+=r.hasOwnProperty(o)?r[o]:o,o=""),i++;return s},e}();t.default=i},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),s=n(30),a=n(13),c=n(26),u=n(11),l=n(31),p=n(5),d=n(8),f=n(10),h=function(e){function t(t,n){var r=e.call(this,t)||this;r.conversation=n,r._topic=d.NA,r._topic=n.topic;return r._topicUpdateHandler=function(e){r._topic=e}.bind(r),n.subscribe("topic",r._topicUpdateHandler),r}return i(t,e),t.prototype.getCustomProperties=function(){this.conversation.unsubscribe("topic",this._topicUpdateHandler);var e=new Array;return e.push(this.getConversationId()),e.push(p.TelemetryPropertyValue.Create("conversationType",this.conversation.getConversationType())),e.push(this.getSDKMode()),e.push(this.getBackend()),e.push(this.getConversationTopic()),e.push(this.getTrafficProvider()),e.push(this.getTrafficSource()),e},t.prototype.getConversationId=function(){switch(this.conversation.getConversationType()){case o.ConversationType.AGENT:case o.ConversationType.DIRECT_LINE:return p.TelemetryPropertyValue.Create("conversationId",l.default.getNormalizeId(this.conversation.id));default:return p.TelemetryPropertyValue.Create("conversationId",l.default.getNormalizeId(this.conversation.id),s.PIIType.Identity)}},t.prototype.getConversationTopic=function(){var e=d.NA;return this.conversation.getConversationType()!==o.ConversationType.AGENT&&this.conversation.getConversationType()!==o.ConversationType.DIRECT_LINE||(e=this._topic&&""!==this._topic?this._topic:d.NA),p.TelemetryPropertyValue.Create("conversationTopic",e)},t.prototype.getBackend=function(){var e="",t=this.conversation.getBackend();switch(t){case a.MessagingBackend.UNDETERMINED:e=d.NA;break;case a.MessagingBackend.SKYPE:e="Skype";break;case a.MessagingBackend.DIRECT_LINE:e="DirectLine";break;case a.MessagingBackend.UNDEFINED:e=d.NA;break;default:u.default.throwError(f.ErrorCodes.ERR_UNKNOWN_BACKEND,"Unknown backend:"+t)}return p.TelemetryPropertyValue.Create("backend",e)},t.prototype.getSDKMode=function(){var e="",t=l.default.getSdkModeFromId(this.conversation.id);switch(t){case c.SDKMode.BOT:e="bot";break;case c.SDKMode.DIRECT_LINE_TOKEN:e="DirectLine";break;case c.SDKMode.JOIN_URL:e="url";break;case c.SDKMode.PERSON:e="person";break;case c.SDKMode.THREAD:e="thread";break;case c.SDKMode.PHONE:e="phone";break;case c.SDKMode.UNDEFINED:e=d.NA;break;default:u.default.throwError(f.ErrorCodes.ERR_UNDEFINED_IDENTITY_TYPE,"Unknown identityType:"+t)}return p.TelemetryPropertyValue.Create("sdkMode",e)},t.prototype.getTrafficProvider=function(){var e=this.conversation.definition?this.conversation.definition.TrafficProvider:d.NA;return p.TelemetryPropertyValue.Create("provider",e)},t.prototype.getTrafficSource=function(){var e=this.conversation.definition?this.conversation.definition.TrafficSource:d.NA;return p.TelemetryPropertyValue.Create("source",e)},t}(d.TelemetryEvent);t.ConversationDataEvent=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.transformRawToXml=function(e,t,n,r){var i=[];for(i.push(t);0!==i.length;){var o=i.pop();o.nodeType===Node.TEXT_NODE?this.encodeTextNodeToXml(e,o,n,r):this.isElementAllowed(o)&&this.pushChildNodes(i,o)}},e.prototype.wordMatcher=function(){return/[\w()#:\-=<>;'\|\$"\]\*\^&\+@\{\?\/\\!~]+/g},e.prototype.getAllWords=function(e){for(var t,n=this.wordMatcher(),r=new Array;null!==(t=n.exec(e));)r.push(t);return r},e.prototype.encodeTextNodeToXml=function(e,t,n,r){var i=t.parentNode,o=this.encodeWords(e,t,n,r);o&&o.length&&(o.forEach(function(e){i.insertBefore(e,t)}),i.removeChild(t))},e.prototype.encodeWords=function(e,t,n,r){var i=this,o=t.nodeValue,s=0,a=[];return this.getAllWords(o).forEach(function(t){var c=i.wordRawToXml(e,t[0],n,r);0!==c.length&&(s!==t.index&&a.push(e.createTextNode(o.substring(s,t.index))),s=t.index+t[0].length,a=a.concat(c))}),0!==s&&s<o.length&&a.push(e.createTextNode(o.substring(s))),a},e.prototype.pushChildNodes=function(e,t){for(var n=0;n<t.childNodes.length;n++)e.push(t.childNodes[n])},e}();t.WordDomTransformer=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return Object.defineProperty(e,"locale",{get:function(){return this._locale?this._locale:document.documentElement.lang?document.documentElement.lang.toLowerCase():window.navigator.languages&&0!==window.navigator.languages.length?window.navigator.languages[0].toLowerCase():navigator.language.toLowerCase()},set:function(e){e=e||"",this._locale=e.toLowerCase()},enumerable:!0,configurable:!0}),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.DIRECTLINE_CHAT="directline-bundle",e.SDK_LOADER_CHAT="sdk-loader",e.SDK_CORE="sdk-core",e.ASSETS="assets-bundle",e.BUILDER="builder-bundle",e.BUILDER_CORE="builder-core",e.CALLING="calling-bundle",e.CALLING_STANDALONE="callingStandalone-bundle",e.SERVICES="services-bundle",e.CHAT_BUNDLE="chat-bundle",e.RECENTS_BUNDLE="recents-bundle",e.UICOMPONENT_BUNDLE="uicomponent-bundle",e.INDEX_BUILDER="index-builder",e.INDEX_CHAT="lwc-chat-index",e.INDEX_CALLING="calling-index",e.INDEX_RECENTS="recents-index",e.CONNECT="connect",e.HOST_CHAT_PAGE="host-chat",e.HOST_BING_PAGE="host-button",e.HOST_BUILDER_PAGE="host-builder",e.STYLE_BUILDER="swc-builder",e.STYLE_SDK="swc-sdk",e.STYLE_CHAT_SKYPE="swc-chat",e.STYLE_RECENTS_SKYPE="swc-recents",e.STYLE_CHAT_BING="swc-bing",e.STYLE_CHAT_THEME_DARK="swc-dark",e.STYLE_CALLING="swc-calling",e}();t.PackageName=r},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.callbacks=new Array,t.pushObservable=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];e.prototype.push.apply(t,n);var i=new s;return i.newItems=n,t.publish(i),t.length},t.popObservable=function(){var n=e.prototype.pop.call(t);return t.publish(),n},t.shiftObservable=function(){var n=e.prototype.shift.call(t);return t.publish(),n},t.unshiftObservable=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];e.prototype.unshift.apply(t,n);var i=new s;return i.newItems=n,t.publish(i),t.length},t.sortObservable=function(n){var r=e.prototype.sort.call(t,n);return t.publish(),r},t.spliceObservable=function(n,r){for(var i,o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];i=r?o?e.prototype.splice.apply(t,[n,r].concat(o)):e.prototype.splice.call(t,n,r):e.prototype.splice.call(t,n);var c=new s;return c.oldItems=i,t.publish(c),i},t.subscribe=function(e){t.callbacks.push(e)},t.unsubscribe=function(e){var n=t.callbacks.indexOf(e);n>-1&&t.callbacks.splice(n,1)},t.dispose=function(){t.callbacks.forEach(function(e,n){t.callbacks[n]=null}),t.callbacks=[]},t.publish=function(e){e||((e=new s).newItems=new Array),t.callbacks.forEach(function(n){n(t,e)})},t}return i(t,e),t}(Array);t.ObservableCollection=o;var s=function(){function e(){}return Object.defineProperty(e.prototype,"newItems",{get:function(){return this._newItems},set:function(e){this._newItems=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oldItems",{get:function(){return this._oldItems},set:function(e){this._oldItems=e},enumerable:!0,configurable:!0}),e}();t.CollectionChangedEventArgs=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.UNDEFINED="",e.PERSON="person",e.PHONE="phone",e.AGENT="agent",e.JOIN="join",e.GROUP="group",e.DIRECT_LINE="dl"}(t.ConversationType||(t.ConversationType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(29),i=function(){function e(){}return e._personIdRegExp=/(\d+:)([\S]*)/,e.normalizePersonId=function(t){var n=t.match(e._personIdRegExp);return n?n[2]:t},e.parsePersonId=function(t){var n=t.match(e._personIdRegExp);return n?{id:n[2],type:parseInt(n[1],0)}:{id:t,type:null}},e.getContactType=function(e){var t=/\d{0,}[^:]/g.exec(e.mri);return t&&t[0]?parseInt(t[0],0):r.ContactType.Undefined},e.replaceAvatarPath=function(e){return e.indexOf("data:image/jpeg;base64")>-1?e:e=(e=e.replace("URL@","")).indexOf("/views/avatar_fullsize")<0?e+"/views/avatar_fullsize":e},e.resolveConversationAvatar=function(t,n){return n?t?e.replaceAvatarPath(n):n:""},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(29),i=function(){function e(){}return e._personIdRegExp=/(\d+:)([\S]*)/,e.normalizePersonId=function(t){var n=t&&t.match(e._personIdRegExp);return n?n[2]:t},e.parsePersonId=function(t){var n=t.match(e._personIdRegExp);return n?{id:n[2],type:parseInt(n[1],0)}:{id:t,type:null}},e.getContactType=function(e){var t=/\d{0,}[^:]/g.exec(e.mri);return t&&t[0]?parseInt(t[0],0):r.ContactType.Undefined},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.BUTTON_SEND_CLICK=1]="BUTTON_SEND_CLICK",e[e.KEYPRESS_ENTER=2]="KEYPRESS_ENTER",e[e.WELCOME_MESSAGE=3]="WELCOME_MESSAGE",e[e.TYPING=4]="TYPING",e[e.SUGGESTED_ACTION=5]="SUGGESTED_ACTION",e[e.BUTTON_SWIFT_CLICKED=6]="BUTTON_SWIFT_CLICKED",e[e.INVITE=7]="INVITE",e[e.ADDON=8]="ADDON"}(t.ActionTrigger||(t.ActionTrigger={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(0),o=n(59),s=function(){function e(){this.requests={}}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!0,configurable:!0}),e.prototype.async=function(e,t,n){var o=this,s=i.swc.API;return this.requests[t]=this.requests[t]||new Promise(function(i,a){var c=n&&setTimeout(a,n),u=function(n){n&&n.refId&&n.refId===t&&(c&&clearTimeout(c),s.unregisterEvent(r.ApiEvents.proxy.resolve,u),i(o.create(e,n)))};s.registerEvent(r.ApiEvents.proxy.resolve,u)}),setTimeout(function(){s.triggerEvent(r.ApiEvents.proxy.request,t)},0),this.requests[t]},e.prototype.create=function(e,t){return new e(t)},e}();t.ProxyFactory=s;var a=function(){return function(e){var t=this;this.data={},this.callCount=0,this.exec=function(e,t){return i.swc.API.triggerEvent(e,t)},this.reg=function(e,t){return i.swc.API.registerEvent(e,t)},this.createCID=function(){return o.hashCode((t.callCount++).toString()+t.refId)},this.refId=e.refId,this.data=e,this.init()}}();t.Proxy=a;var c=function(){function e(){var e=this;this.connections={},this.answer=function(t){var n=e.connections[t];n&&e.events.triggerEvent(r.ApiEvents.proxy.resolve,Object.assign(n,{refId:t}))},this.events=i.swc.API,this.events.registerEvent(r.ApiEvents.proxy.request,this.answer)}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!0,configurable:!0}),e.prototype.connect=function(e,t,n){this.connections[e]||(this.connections[e]=t||{},n&&n(),this.answer(e))},e.prototype.disconnect=function(e){delete this.connections[e]},e}();t.ProxyConnector=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(29),i={caseFirst:"upper"},o=function(){function e(){}return e.mapSearchProfileInfo=function(e){return e&&e.results?e.results.map(function(e){var t=e.nodeProfileData.skypeId,n={skypeid:-1===t.indexOf("8:")?"8:"+t:t,name:e.nodeProfileData.name,avatar:e.nodeProfileData.avatarUrl,type:r.ContactType.Skype,contactType:e.nodeProfileData.contactType,annotation:e.nodeAnnotation,jobTitle:e.nodeProfileData.jobTitle,department:e.nodeProfileData.department,location:e.nodeProfileData.location};return e.nodeConnectionData&&(n.distance=e.nodeConnectionData.distance,n.mutualFriendCount=e.nodeConnectionData.mutualFriendCount),n}):[]},e.getWrappedIdWithMri=function(e){var t=/^\d+:/.exec(e.id);if(t&&t[0])return e.id;var n=e.isAgent?/^28:/:/^8:/;return(e.isAgent?"28:":"8:")+e.id.replace(n,"")},e.sortByName=function(e,t){var n=e.vm.person.displayName.localeCompare(t.vm.person.displayName,void 0,i);return 0===n?e.vm.person.id.localeCompare(t.vm.person.id):n},e.getSortedByRelevance=function(t){var n=t.filter(function(e){return e.vm.mutualFriendCount}).sort(function(e,t){return t.vm.mutualFriendCount-e.vm.mutualFriendCount}),r=t.filter(function(e){return!e.vm.mutualFriendCount}).sort(e.sortByName);return n.concat(r)},e.mapContactVMItems=function(e,t){for(var n=0;n<e.length;n++){var r=e[n].person;e[n]&&(t[r.id]=e[n])}},e.handleParticipantsChanges=function(t,n){Object.keys(t).length&&(n.newItems?e.markAddedParticipants(t,n.newItems):n.oldItems&&e.markRemovedParticipants(t,n.oldItems))},e.markAddedParticipants=function(e,t){for(var n=0;n<t.length;n++){var r=e[t[n].person.id];r&&!r.alreadyParticipant&&(r.alreadyParticipant=!0)}},e.markRemovedParticipants=function(e,t){for(var n=0;n<t.length;n++){var r=e[t[n].person.id];r&&r.alreadyParticipant&&(r.alreadyParticipant=!1)}},e.preloadImage=function(e,t,n){if(e.indexOf("data:image/jpeg;base64")>-1)t&&"function"==typeof t&&t(e);else{var r=new Image,i=encodeURI(decodeURI(e));r.onload=function(){t&&"function"==typeof t&&t(i)},r.onerror=function(e){n&&"function"==typeof n&&n()},r.src=i}},e.replaceAvatarPath=function(e){return e.indexOf("data:image/jpeg;base64")>-1?e:e=(e=e.replace("URL@","")).indexOf("/views/avatar_fullsize")<0?e+"/views/avatar_fullsize":e},e.resolveConversationAvatar=function(t,n){return n?t?e.replaceAvatarPath(n):n:""},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(6),o=n(2),s=n(13),a=n(32),c=n(103),u=n(3),l=function(e){void 0===e&&(e="");var t=e.match((r||(r=i.default.get.backend===s.MessagingBackend.TEAMS?/^(https?:.+?\.microsoft\.com\/V\d+\/)/i:/^(https?:.+?\.live\.com\/V\d+\/)/i),r));return t?t[1]:null};t.handle404Redirect=function(e,t){var n=e.headers.get("location");return 404===e.status&&n&&l(n)?(o.default.CHAT_HOST_URL=l(n),t()):Promise.resolve(e)},t.getDomain=function(){return u.default.signInManager.userIdentityType===a.IdentityType.GUEST&&o.default.CHAT_GUEST_HOST_URL!==o.default.CHAT_HOST_URL&&c.default().register("webapi-guestInDogfood","",0,null,""),o.default.CHAT_HOST_URL},t.getConversationIdFromUrl=function(e){var t=e&&e.match(/\/(\d+:[^?/]*)/);return t&&t[1]?t[1]:void 0},t.reset=function(){o.default.CHAT_HOST_URL=o.default.CHAT_GUEST_HOST_URL},t.normalizePersonId=function(e){var t=e.match(/(\d+:)([\S]*)/);return t?t[2]:e}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(216),i=n(2),o=n(11),s=n(19),a=n(116),c=n(217),u=n(218),l=n(108),p=n(10),d=function(){try{return window.swc.services.i18n}catch(e){}return null},f=function(){function e(){this._initialized=!1,l.default.set(r),u.default.init(i.default.LOCALE)}return e.prototype.init=function(e){var t=this;e||(e=i.default.LOCALE),this.lang=a.default.getLocale(e.toLowerCase()),this._initialized=!0;try{window.swc.services.i18n=this}catch(e){}return this.lang===i.default.LOCALE?Promise.resolve():c.default.load(s.default.getAppPath()+"resources/i18n",this.lang).then(function(){return u.default.init(t.lang),{}},function(){return t.lang=i.default.LOCALE,u.default.init(i.default.LOCALE),{}})},e.prototype.fetch=function(e,t){if(!this._initialized){if(d())return d().fetch(e,t);o.default.throwError(p.ErrorCodes.ERR_I18N_NOT_INITIALIZED,"You need to initialize I18N before using it")}void 0!==t&&void 0!==t.count&&(e+=u.default.getPluralSuffix(t.count));var n=this._getKeyValueText(e);return this._replaceParams(n,t)},e.prototype._replaceParams=function(e,t){for(var n in void 0===t&&(t={}),t)if(t.hasOwnProperty(n)){var r=t[n].toString(),i="{"+n+"}";e=e.replace(i,r)}return e},e.prototype._getKeyValueText=function(e){var t=l.default.get();return t&&t[e]?t[e]:e},e}(),h=d();h||(h=new f),t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(69),i=n(1),o=n(13),s=n(0),a=n(6),c=n(25),u=n(125),l=n(117),p=n(126),d=n(83),f=n(128),h=n(88),g={LARGE:"large",EXTRA_LARGE:"extraLarge"},m=3,_=function(e){var t;return(i.default.instance.PesManager.config?i.default.instance.PesManager.config.items:[]).forEach(function(n){t||n.id!==e||(t=n)}),t},y=function(){function e(e,t){var n=this;this.outgoingDomTransformers=[],this.incomingDomTransformers=[],this.encode=function(e,t,i){var o=new DOMParser,s=r(e),a=u.default.addFormatting(s),c=o.parseFromString(a,"text/html");if(0!==c.getElementsByTagName("parsererror").length)return s;try{return n.outgoingDomTransformers.forEach(function(e){try{e.transformRawToXml(c,c.body,t,i)}catch(e){}}),n.convertHtmlDomToXmlString(c)}catch(e){return s}},this.decode=function(e){var t,r,s,c=n;a.default.get.backend===o.MessagingBackend.TEAMS&&(e=(e=e.replace(/^<div><div>(.*)<\/div>[\s]?<\/div>$/,"$1")).replace(/<span[^>/]+type="(\([a-z]+\))"[^>]+><img[^>]+itemid="(\w+)"[^>]+><\/span>/g,'<ss type="$2">$1</ss>'));try{var u=n._private.parseXML(n._private.encapsulateInRootElement(e));if(u)return r=u.documentElement,i.default.instance.PesManager.canRenderConfigItems()&&function(e){var n=a.default.get.largeEmoticonClass?g.EXTRA_LARGE:g.LARGE,i=r.getElementsByTagName("ss"),o=[],s=i.length<=m&&i.length>0;if(s)for(t=0;t<r.childNodes.length;++t){var u=0===r.childNodes[t].textContent.replace(" ","").length;s=s&&("ss"===r.childNodes[t].tagName||u)}var l,p,d=i.length>20;for(t=0;t<i.length;++t){var f=c.emoticonEncoder.createHtmlElement(e,i[t].getAttribute("type"),i[t].textContent,s,d,n);f&&o.push([f,i[t]])}for(t=0;t<o.length;++t)l=o[t][0],(p=o[t][1]).parentNode&&p.parentNode.replaceChild(l,p)}(u),(s=r.getElementsByTagName("e_m"))&&0!==s.length&&s[0].parentNode.removeChild(s[0]),n.incomingDomTransformers.forEach(function(e){try{e.transformRawToXml(u,r)}catch(e){}}),c.emoticonEncoder.fixInvalidHtml(n._private.decapsulateFromRootElement(n._private.xmlToString(u)))}catch(e){}return e},this.convertHtmlDomToXmlString=function(e){for(var t=e.implementation.createDocument(e.body.namespaceURI,"message",null);0!==e.body.childNodes.length;)t.childNodes[0].appendChild(e.body.childNodes[0]);var r=t.childNodes[0].outerHTML;return a.default.get.backend===o.MessagingBackend.TEAMS&&(r=n._translateToTeamsEmoticons(r,e,t)),r.replace(/(?:^<message.*?>|<\/message>$)/g,"")},this._translateToTeamsEmoticons=function(e,t,n){var r=e.match(/<ss[^>]+>[^<]+<\/ss>/g),o=r.length===n.firstChild.childNodes.length&&r.length<=m&&r.length>0,s=i.default.instance.PesManager.map;for(var a in r){var c=r[a],u=c.match(/<ss type="([^"]+)">([^<]+)<\/ss>/),l=(u[0],u[1]),p=s[u[2]];p.match(/^\(.*\)$/)||(p="("+p+")");var d=_(l),f=t.implementation.createDocument(t.body.namespaceURI,"emoticon",null),h=f.createElement("span"),g=o?50:20;h.setAttribute("class","animated-emoticon-"+g+"-"+l+" animated-emoticon-flat-"+g+"-"+l),h.setAttribute("title",l),h.setAttribute("type",p),h.setAttribute("style","height:"+g+"px; width:"+g+"px; max-height:"+g+"px; max-width:"+g+"px");var y=f.createElement("img");y.setAttribute("alt",d.description),y.setAttribute("itemid",l),y.setAttribute("itemscope",""),y.setAttribute("itemtype","https://schema.skype.com/Emoji"),y.setAttribute("src","https://statics.teams.microsoft.com/evergreen-assets/funstuff/skype-emoticons-f/"+l+"/default_"+g+".png"),y.setAttribute("style","width:"+g+"px; height:"+g+"px"),h.appendChild(y),f.childNodes[0].appendChild(h);var v=f.childNodes[0].outerHTML.replace(/(?:^<emoticon.*?>|<\/emoticon>$)/g,"");e=e.replace(c,v)}return e},this.addLinkElementTarget=function(e,t,n){return e&&e.tagName&&"a"===e.tagName.toLowerCase()&&(e.hasAttribute("target")||e.setAttribute("target","_blank")),e},this._private={separators:{"   ":!0,"\n":!0,"\r":!0," ":!0,"":!0,"":!0,"":!0,"":!0,"":!0,"":!0,"":!0,"":!0,"":!0,"":!0,"":!0,"":!0,"":!0,"":!0,"":!0,"":!0},createFlagElement:function(e,t,n){var r=e.createElement("span");return r.textContent=n,r.setAttribute("class","flag "+t),r.textContent="(flag:"+t+")",r},encapsulateInRootElement:function(e){for(var t;t!==e;)t=e,e=e.replace(/<\s*?root[\s\S]*?>.*?(<\s*?\/\s*?root\s*?>)?/gi,"");return"<root>"+e+"</root>"},decapsulateFromRootElement:function(e){return e.match(/<root ?\/>/)?"":e.length==="</root>".length?"":e.substring("<root>".length,e.length-"</root>".length)},parseXML:function(e){var t;try{if(s.swcWindow.DOMParser){var n=new DOMParser;n.async=!1,t=n.parseFromString(e,"text/xml")}else{var r=new ActiveXObject("Microsoft.XMLDOM");if(r.async=!1,r.loadXML(e))return r}}catch(e){return null}var i=t.parseError;return i&&0!==i.errorCode?null:t.getElementsByTagName("parsererror").length>0?null:t},xmlToString:function(e){var t;try{t=(new XMLSerializer).serializeToString(e)}catch(n){t=e.xml}return t},xmlEscapeMap:{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;"},escapeXml:function(e){var t=this.xmlEscapeMap;return e.replace(/[<>&"']/g,function(e){return t[e]})},unescapeXml:function(e){var t={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};return e.replace(/&lt;|&gt;|&amp;|&quot;|&apos/g,function(e){return t[e]})}},this.emoticonEncoder=new l.default,e?e.forEach(function(e){n.incomingDomTransformers.push(e)}):this.incomingDomTransformers=[new f.NewLineDomTransformer,new p.MentionDomDecoder],t?t.forEach(function(e){n.outgoingDomTransformers.push(e)}):this.outgoingDomTransformers=[new h.URLDomTransformer,new f.NewLineDomTransformer,new d.MentionDomEncoder,this.emoticonEncoder],this.dompurifyConfig={ALLOWED_TAGS:["a","b","i","s","br","at","ss","h1","h2","h3","h4","h5","h6","span","div","quote","ul","li","ol","em","strong","br"],ALLOWED_ATTR:["tabindex","title","href","target","id","type"]},c.default.dompurify.addHook("beforeSanitizeAttributes",this.addLinkElementTarget)}return e.prototype.getDomPurify=function(){return window.DOMPurify},e}();t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),i=function(){function e(){}return e.parse=function(e,t){return r.setOptions({renderer:this.renderer,gfm:!0,tables:!1,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1,xhtml:!1}),e=e.replace(/<br\s*\/?><br\s*\/?>/g,"\n\n").replace(/<br\s*\/?>/g,"  \n"),(e=r(e).trim()).replace(/^<p>/,"").replace(/<\/p>$/,"")},e.renderer=new r.Renderer,e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(46),i=n(14),o=["rgb(153, 180, 51)","rgb(107, 165, 231)","rgb(231, 115, 189)","rgb(0, 163, 0)","rgb(30, 113, 69)","rgb(255, 0, 151)","rgb(126, 56, 120)","rgb(96, 60, 186)","rgb(29, 29, 29)","rgb(0, 171, 169)","rgb(45, 137, 239)","rgb(43, 87, 151)","rgb(218, 83, 44)","rgb(185, 29, 71)","rgb(238, 17, 17)"],s=function(){function e(){}return e.isDefaultPublicUrl=function(e){return e.indexOf("/profile/avatar")>-1||e.indexOf("/public")>-1},e._replaceDefaultImage=function(t){var n=t.split("?")[0],r=t.split("?")[1],i=e.isDefaultPublicUrl(t);return r?(t=n+"?"+r,t+=i?"&returnDefaultImage=false":""):t+=i?"?returnDefaultImage=false":"",t},e.getBackgroundColor=function(e){for(var t=0,n=e.length-1;n>=0;n--){var r=e.charCodeAt(n),i=n%8;t^=(r<<i)+(r>>8-i)}return o[t%o.length]},e._filterDisplayName=function(e){return i.default.getMessageSanitizedContent(e).replace(/\s+/gi," ").trim()},e.loadAvatarUri=function(t,n,i){t&&(t.indexOf("?auth_key=")<0&&(t=t.indexOf("?returnDefaultImage")<0?e._replaceDefaultImage(t):t.replace("returnDefaultImage=true","returnDefaultImage=false")),r.default.preloadImage(t,n,i))},e.getInitials=function(t){var n="",r=(t=e._filterDisplayName(t)).split(" ");return r.length>1?(n+=r[0][0]?r[0][0]:"",n+=r[1][0]?r[1][0]:""):r.length&&(n+=r[0][0]?r[0][0]:"",n+=r[0][1]?r[0][1]:""),n.toUpperCase()},e}();t.default=s},function(e,t,n){"use strict";var r=this;Object.defineProperty(t,"__esModule",{value:!0}),n(79);var i=n(2),o=n(20),s=n(16),a=n(23),c=n(3),u=n(260),l=n(47),p={retryCount:3,timeout:5e4,policy:""},d=function(e,t){void 0===t&&(t={});var n=Object.assign({},t);return u.getHeaders().then(function(t){return n.method=e,n.headers=n.headers||{},Object.assign(n.headers,{ClientInfo:i.default.getChatClientInfo(),Pragma:"no-cache",Expires:0,ContextId:"tcid="+o.guid.generate(),BehaviorOverride:"redirectAs404"},t),n})},f=function(e,t,n,r,i){return void 0===i&&(i=3),429===t.status||500===t.status||503===t.status?0===i?Promise.reject(t):s.default("webapi-"+e,p,n,r).then(function(t){return new Promise(function(o){setTimeout(function(){o(f(e,t,n,r,i-1))},2e3*(3-i+1))})}):Promise.resolve(t)},h=function(e,t,n,i,o){return d(t,i).then(function(g){if(!l.getDomain())return c.default.signInManager.logout("services:domain is undefined"),Promise.reject({message:"Domain is undefined"});var m=o?n:l.getDomain()+n;return s.default("webapi-"+e,p,m,g).then(u.handleRegTokenExpiry).catch(function(n){return c.default.signInManager.state===a.SigninState.SignedOut?Promise.reject(n):d(t,i).then(function(t){return s.default("webapi-"+e,p,m,t)})}).then(u.handleRegTokenExpiry).catch(function(e){return Promise.reject(e)}).then(function(r){return c.default.signInManager.state===a.SigninState.SignedOut?Promise.reject(r):d(t,i).then(function(t){return f(e,r,l.getDomain()+n,t)})}).then(u.processHeaders).then(function(o){return l.handle404Redirect(o,h.bind(r,e,t,n,i))})})};t.get=function(e,t,n){return h(e,"GET",t,n)},t.getWithDomain=function(e,t,n){return h(e,"GET",t,n,!0)},t.put=function(e,t,n,r){return h(e,"PUT",t,n,r)},t.del=function(e,t,n){return h(e,"DELETE",t,n)},t.post=function(e,t,n){return h(e,"POST",t,n)},t.parseJson=function(e){return e.json().then(function(t){return e.ok?Promise.resolve(t):Promise.reject(t)})},t.reset=function(){u.reset(),l.reset()};var g=n(104);t.addGetParamsToUrl=g.addGetParamsToUrl},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.callback=e,this.timeout=t}return e.prototype.start=function(){this.reset(),this.retryTimeout=setTimeout(this.callback,this.timeout)},e.prototype.reset=function(){this.retryTimeout&&clearTimeout(this.retryTimeout)},e}();t.FixedTimeout=r,t.build=function(e,t){return new r(e,t)}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s=n(6),a=n(2),c=n(267),u=n(18),l=n(33),p=n(268),d=n(269),f=n(270),h=n(271),g=n(0),m=n(156),_=n(54),y=n(154),v=n(272),b=n(23),P=n(17),T=n(32),w=n(13),E=n(26),S=n(3),C=n(273),k=n(19);n(274);var O,A="Please disable your popup blocker as it affects sign in/out process. Repeat the operation again after disabling the blocker.",M=2e4;t.SKYPE_AAD_AUD="https://api.spaces.skype.com",t.SHAREPOINT_AAD_AUD="https://microsoft-my.sharepoint.com",function(e){e.SpacesApi="https://api.spaces.skype.com",e.Sharepoint="https://microsoft-my.sharepoint.com",e.Presence="https://presence.teams.microsoft.com/"}(O=t.AadAudience||(t.AadAudience={}));var I=function(){function e(){var e=this;this.init=function(){var t=function(e,t){return new Promise(function(n){var r=function(e){n(e),g.swc.API.unregisterEvent(t,r)};g.swc.API.registerEvent(t,r),g.swc.API.triggerEvent(e)})};e.tokenProvider=function(){return t(o.AuthEvents.TokenProviderRequest,o.AuthEvents.TokenProviderResponse)},e.regionGtmsProvider=function(){return t(o.AuthEvents.RegionGtmsRequest,o.AuthEvents.RegionGtmsResponse)}},this.tokenProviderCallback=function(){return Promise.all([e.tokenProvider(),e.regionGtmsProvider()]).then(function(t){var n=t[0],r=t[1];return{tokens:{skypeToken:n,expiresIn:e.getExiresIn(n)},regionGtms:r}})},this.init()}return e.prototype.getExiresIn=function(e){return(new m.default).getTokenData(e).exp-Math.floor(Date.now()/1e3)},e}(),R=function(e){function t(n,r,i,o){var u=e.call(this)||this;u.outerTokenProvider=n,u._signOutContext=new C.default,u._reloginContext=new c.default(!1),u._tokenParser=new m.default,u._userIdentityType=T.IdentityType.UNDETERMINED,u.login=function(e){if(u._externalLogin&&"function"==typeof u._externalLogin)return u._externalLogin(),void u.sendSignedInTelemetry("","externalLogin");var t=a.default.LOGIN_PAGE_URL;if(t+="?client_id="+a.default.LOGIN_CLIENT_ID,t+="&redirect_uri="+encodeURI(k.default.getConnectPagePath()),t+="&lang="+a.default.LOCALE,t+="&response_type=token",u._getTokenPromise&&u._getTokenPromise.status===P.PromiseStatus.Pending){var n=u.showLoginPopup.bind(u,t,e);u._getTokenPromise.promise.then(null,n)}else u.showLoginPopup(t,e)},u.logout=function(e){if(u.outerTokenProvider)return Promise.resolve();if(u._signOutContext.signoutPromise)return u._signOutContext.signoutPromise;if(u.state===b.SigninState.SigningOut)return Promise.resolve();if(u.prelogoutActions.length>0){var t=u._logout.bind(u,e);return u._signOutContext.signoutPromise=u.execPrelogoutAction(u.prelogoutActions.pop()).then(t,t),u._signOutContext.signoutPromise}return u._signOutContext.signoutPromise=u._logout(e),u._signOutContext.signoutPromise},u._logout=function(e){if(u.state===b.SigninState.SigningOut)return Promise.resolve();var t=Date.now();u._reloginContext.canRelogin||u._reloginContext.setContext(u.activeConversationSdkMode===E.SDKMode.BOT,function(){return u.getGuestToken()});var n=a.default.LOGOUT_PAGE_URL;n+="?",n+="&client_id="+a.default.LOGIN_CLIENT_ID,n+="&redirect_uri="+k.default.getConnectPagePath(),n+="&redirect=true",n+="&response_type=token";var r=window.open(n,"_blank",a.default.LOGOUT_POPUP_FEATURES),i=null===r||void 0===r;return i&&u._userIdentityType===T.IdentityType.SKYPE?(u.sendSignedOutTelemetry(e,t,!0),alert(A),Promise.resolve()):(!i&&window.focus&&r.focus(),u.state=b.SigninState.SigningOut,u.state=b.SigninState.SignedOut,u.reset(),u.sendSignedOutTelemetry(e,t),u._lastAuthSource=v.AuthSource.UserLogout,s.default.get.meId="",Promise.resolve())},u.execPrelogoutAction=function(e){var t=function(){if(u.prelogoutActions.length>0){var e=u.prelogoutActions.pop();return u.execPrelogoutAction(e)}return Promise.resolve()};e&&"function"==typeof e||t();var n=e();return n&&"function"==typeof n.then?n.then(t.bind(u),t.bind(u)):t()},u.getGuestToken=function(){if(u._guestUserPromise)return u._guestUserPromise;var e=Date.now();return u._guestUserPromise=p.default.getGuestToken("Guest").then(function(t){return u._userIdentityType=T.IdentityType.GUEST,u.setTokenDataToCache(t.SkypeToken,86400,!0),u.sendSignedInTelemetry(t.SkypeToken,"guest",e),u._signOutContext.reset(),t},function(t){u.sendSignedInTelemetry(void 0,"guest",e,t.message),u.clearUserDataFromCache(),u._guestUserPromise=null}),u._guestUserPromise},u.showLoginPopup=function(e,t){var n,r,i=Date.now(),o=u.state===b.SigninState.SignedOut,s=function(e){var a=/(?:access_token=)([\S]*)(?:&)(?:expires_in=)([\d*]*)/g.exec(e.data);if(a&&(n=a[1],r=a[2]),a||(n=e.data.token,r=Date.now()+864e5+""),!n)return u.state=b.SigninState.SignedOut,void window.removeEventListener("message",s);o&&(u.currentUsername=n?u._tokenParser.retrieveMeName(n):"",u.setTokenDataToCache(n,parseInt(r,10),!1),u.publish("resurrect",!0),u._signOutContext.reset()),o?t&&t(n):(u._reloginContext.setContext(!0,function(){return u._userIdentityType=T.IdentityType.SKYPE,u.setTokenDataToCache(n,parseInt(r,10),!1),u.sendSignedInTelemetry(n,"popup",i),t&&t(n),Promise.resolve()}),u._signOutContext.reset(),u._signOutContext.isRelogin=!0,u.logout()),u._lastAuthSource=v.AuthSource.Popup,window.removeEventListener("message",s)};window.addEventListener("message",s,!1);var c=window.open(e,"_blank",a.default.LOGIN_POPUP_FEATURES);c&&window.focus&&c.focus()};var l=!s.default.get.frameless&&window!==window.top&&!!window.parent,d=!o||o!==y.TokenType.Aad,f=!d&&l;return u._onceSingedInPromise=new P.CancelablePromise,u._state=b.SigninState.SignedOut,f||(u.getSkypeToken=n||u._getSkypeToken),u._externalLogin=i,s.default.get.backend=o&&"aad"===o?w.MessagingBackend.TEAMS:w.MessagingBackend.SKYPE,f&&(u.teamsRemoteTokenExchange=new I,u.getSkypeToken=function(){return u._getSkypeTokenFromAad()}),u.outerTokenProvider?d?(u.clearUserDataFromCache(),u._getInfoFromExternalToken()):u._getSkypeTokenFromAad():r&&(u.clearUserDataFromCache(),u.setTokenDataToCache(r.skypeToken,r.expiresAt,r.isGuest),d?(u._userIdentityType=t._getUserIdentityType(r),u._lastAuthSource=v.AuthSource.WX):(u.teamsTokenPromise=Promise.resolve(r.skypeToken),u.currentUsername=u._tokenParser.retrieveMeName(r.skypeToken),u.state=b.SigninState.SignedIn,u._lastAuthSource=v.AuthSource.AAD,u._userIdentityType=T.IdentityType.SKYPE)),u.prelogoutActions=[],u}return i(t,e),t._getUserIdentityType=function(e){return e.isGuest?T.IdentityType.GUEST:"aad"===e.tokenType?T.IdentityType.TEAMS:T.IdentityType.SKYPE},t.prototype._getInfoFromExternalToken=function(){var e=this;s.default.get.backend=w.MessagingBackend.SKYPE,this.outerTokenProvider().then(function(t){e.currentUsername=t?e._tokenParser.retrieveMeName(t):"";var n=e._userId.indexOf("guest:")>-1;e.state=t?b.SigninState.SignedIn:b.SigninState.SignedOut,e._lastAuthSource=n?v.AuthSource.Guest:v.AuthSource.External,e._userIdentityType=n?T.IdentityType.GUEST:T.IdentityType.SKYPE,e.sendSignedInTelemetry(t,"external",Date.now())},function(){e.state=b.SigninState.SignedOut,e._lastAuthSource=v.AuthSource.External,e.sendSignedInTelemetry(null,"external",Date.now())})},t.prototype._getSkypeToken=function(){var e=this;if(s.default.get.backend=w.MessagingBackend.SKYPE,this._getTokenPromise&&this._getTokenPromise.status===P.PromiseStatus.Pending)return this._getTokenPromise.promise;this._lastAuthSource=v.AuthSource.UNDEFINED;var t=this.getTokenDataFromCache();if(t&&t.isGuest&&s.default.get.isSkypeOnly&&(t=null),s.default.get.isGuestOnlyMode&&t&&!t.isGuest&&(this.clearUserDataFromCache(),t=null),this._signedIn||!t||t.isGuest||(t=null),t)return this.currentUsername=this._tokenParser.retrieveMeName(t.token),this._userIdentityType=t.isGuest?T.IdentityType.GUEST:T.IdentityType.SKYPE,void 0===this._signedIn&&(this.sendSignedInTelemetry(t.token,"cache",Date.now()),this.callExternalHandler(this.externalSuccessCallback)),this._lastAuthSource=v.AuthSource.Cache,this.state=b.SigninState.SignedIn,Promise.resolve(t.token);this.state=b.SigninState.SigningIn,this.clearUserDataFromCache();var n=new Promise(function(t,n){var r=e;function i(e){r.activeConversationSdkMode===E.SDKMode.BOT?(r.state!==b.SigninState.SignedIn&&(r.state=b.SigninState.SigningIn),r.getGuestToken().then(function(e){r.currentUsername=r._tokenParser.retrieveMeName(e.SkypeToken),r.state=b.SigninState.SignedIn,t(e.SkypeToken),r.callExternalHandler(r.externalSuccessCallback),r._lastAuthSource=v.AuthSource.Guest}).catch(function(e){r.clearUserDataFromCache(),r.callExternalHandler(r.externalFailureCallback,r.formatError(e)),r._guestTokenRetryInterval||(r._guestTokenRetryInterval=new _.FixedTimeout(i.bind(r),M)),r._guestTokenRetryInterval.start()})):(r.state=b.SigninState.SignedOut,n(),r.callExternalHandler(r.externalFailureCallback,r.formatError(e)))}e.state!==b.SigninState.SignedIn&&(e.state=b.SigninState.SigningIn),s.default.get.isGuestOnlyMode?i():e.silentLogin().then(function(e){this.state=b.SigninState.SignedIn,this.currentUsername=this._tokenParser.retrieveMeName(e),t(e),this.callExternalHandler(this.externalSuccessCallback),this._lastAuthSource=v.AuthSource.SilentLogin}.bind(e),function(e){return s.default.get.isSkypeOnly?(r.state=b.SigninState.SignedOut,r.callExternalHandler(r.externalFailureCallback),n()):i(e)}.bind(e))});return this._getTokenPromise=new P.CancelablePromise(n),this._getTokenPromise.promise},t.prototype.onceSignedIn=function(){return this.getSkypeToken().then(null,function(){}),this._onceSingedInPromise.promise},t.prototype.getLastAuthSource=function(){return this._lastAuthSource},Object.defineProperty(t.prototype,"lastAuthSource",{get:function(){return this._lastAuthSource},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){if(e===b.SigninState.SignedIn&&(this._lastSignedInTimestamp=Date.now()),e!==this._state){this._state=e,this._signedIn=this._state===b.SigninState.SignedIn,this.publish("state",e),this.publish("isSignedIn",this._signedIn);var t=this._onceSingedInPromise.status===P.PromiseStatus.Pending;this._signedIn&&t?this._onceSingedInPromise.resolve():this._state!==b.SigninState.SignedOut||t||(this._onceSingedInPromise=new P.CancelablePromise)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userIdentityType",{get:function(){return this._userIdentityType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentUsername",{set:function(e){this._userId=e,s.default.get.meId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentUserName",{get:function(){return this._userId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSignedIn",{get:function(){return this._signedIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reloginContext",{get:function(){return this._reloginContext},enumerable:!0,configurable:!0}),t.prototype.checkAuthFailuresCount=function(e){e>=3&&this.clearUserDataFromCache()},t.prototype.setExternalCallbacks=function(e,t){this.externalSuccessCallback=e,this.externalFailureCallback=t,this._state===b.SigninState.SignedIn&&this.callExternalHandler(this.externalSuccessCallback)},t.prototype.getTokenExpirationTime=function(){var e=this.getTokenDataFromCache();return e&&e.expiresAt},t.prototype.sendSignedInTelemetry=function(e,t,n,r){this.currentUsername=e?this._tokenParser.retrieveMeName(e):"";var i=new f.SignInEvent;i.authOrigin=t,i.status=e?"200":"500",i.ttc=n?Date.now()-n:-1,i.errorMessage=r,S.default.telemetryManager.sendEvent(i)},t.prototype.sendSignedOutTelemetry=function(e,t,n){var r=new h.SignOutEvent;r.origin=e,r.status=n?500:200,r.ttc=t?Date.now()-t:-1,n&&(r.errorMessage="Popup is blocked"),S.default.telemetryManager.sendEvent(r)},t.prototype.getRegistrationToken=function(){var e,t=l.default.get().getItem("skype|registrationtoken");if(t)try{e=JSON.parse(t)}catch(e){}return e},t.prototype.getTokenDataFromCache=function(){if(!this._tokenData)try{this._tokenData=JSON.parse(l.default.get().getItem(a.default.SKYPE_TOKEN_KEY))}catch(e){return this.clearUserDataFromCache(),null}return this._tokenData&&(this._tokenData=this.isTokenValid(this._tokenData)?this._tokenData:null),this._tokenData},t.prototype.isTokenValid=function(e){var t=this.getRegistrationToken();return!(t&&!t.value&&t.failureCount>=3)&&(!(e.expiresAt<Date.now())&&(this._userIdentityType===T.IdentityType.SKYPE&&this.activeConversationSdkMode===E.SDKMode.PERSON&&e.isGuest?(this._tokenData=null,this.clearUserDataFromCache(),!1):!(this._userIdentityType===T.IdentityType.GUEST&&this.activeConversationSdkMode===E.SDKMode.BOT&&!e.isGuest)||(this._tokenData=null,this.clearUserDataFromCache(),!1)))},t.prototype.setTokenDataToCache=function(e,t,n){var r=this,i=0;t&&(i=Date.now()+1e3*t,this._tokenRenovationTimeout&&this._tokenRenovationTimeout.reset(),this._tokenRenovationTimeout=new _.FixedTimeout(function(){s.default.get.backend===w.MessagingBackend.TEAMS?(r.teamsTokenPromise=null,r._getSkypeTokenFromAad()):n?r.getGuestToken():r.silentLogin()},1e3*Math.abs(t-60)),this._tokenRenovationTimeout.start()),l.default.get().setItem(a.default.SKYPE_TOKEN_KEY,JSON.stringify({token:e,expiresAt:i,isGuest:n}))},t.prototype.clearUserDataFromCache=function(){this._tokenData=null,l.default.get().removeItem(a.default.SKYPE_TOKEN_KEY),l.default.get().removeItem(a.default.SKYPE_REGTOKEN_KEY),l.default.get().removeItem("skype|epid"),l.default.get().removeItem("skype|hasHistory")},t.prototype.silentLogin=function(){var e=this;if(this._silentLoginPromise)return this._silentLoginPromise;var t=Date.now();return this._silentLoginPromise=new Promise(function(n,r){var i={client_id:a.default.LOGIN_CLIENT_ID,env:"live",callback:function(i){var o,s=function(r){e.sendSignedInTelemetry(r,"silent",t),e._silentLoginPromise=null,n(r)};try{o=JSON.parse(i.data)}catch(e){o=i.data?i.data:i}o.error?(o.error,"invalid_grant"===o.error&&e.clearUserDataFromCache(),e.sendSignedInTelemetry(void 0,"silent",t,o.error),e._silentLoginPromise=null,r(o.error)):o.token?(e.setTokenDataToCache(o.token,o.expires_in,!1),s(o.token)):o.skypetoken&&(e.setTokenDataToCache(o.skypetoken,o.expires_in,!1),s(o.skypetoken)),r(new Error("Neither token nor skypeToken in the response"))}};g.SKYPE.login.Silent.init(i).load()}),this._silentLoginPromise},t.prototype.callExternalHandler=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e&&"function"==typeof e)try{e.apply(null,[].slice.call(arguments,1))}catch(e){}},t.prototype.formatError=function(e){var t;return e instanceof Error?t=Object.create(e):"string"==typeof e?t=new Error(e):(t=new Error("Unknown: please check *data* property for more info")).data=e,t.name="SWCApi:signin:"+t.name,t},t.prototype.reset=function(){this.clearUserDataFromCache(),this._signOutContext.reset(),this._guestUserPromise=null,this._silentLoginPromise=null,this._signedIn=!1,this._tokenData=null,this.currentUsername="",this._getTokenPromise&&this._getTokenPromise.status===P.PromiseStatus.Pending&&this._getTokenPromise.cancel(),this._getTokenPromise=null,this._aad=null,this._tokenRenovationTimeout&&(this._tokenRenovationTimeout.reset(),this._tokenRenovationTimeout=null)},t.prototype.aad=function(e){return e||(e=O.SpacesApi),this.outerTokenProvider?this.outerTokenProvider(e).then(function(e){return-1===e.indexOf("Bearer")?"Bearer "+e:e}):Promise.reject("outerTokenProvider is not defined")},t.prototype.isAadSupported=function(){return!!this.outerTokenProvider},t.prototype._signInWithAadSkypetokens=function(e,t){void 0===t&&(t=!1),e.regionGtms&&(a.default.CHAT_HOST_URL=e.regionGtms.chatService+"/v1/",a.default.CHAT_GUEST_HOST_URL=e.regionGtms.chatService+"/v1/",a.default.AMS_HOST_URL=e.regionGtms.ams+"/v1/",a.default.AVATAR_SERVICE_URL=e.regionGtms.mtImageService),s.default.get.backend=w.MessagingBackend.TEAMS,this.setTokenDataToCache(e.tokens.skypeToken,e.tokens.expiresIn,t),this.currentUsername=this._tokenParser.retrieveMeName(e.tokens.skypeToken),this.state=e.tokens.skypeToken?b.SigninState.SignedIn:b.SigninState.SignedOut,this._lastAuthSource=v.AuthSource.AAD,this._userIdentityType=T.IdentityType.SKYPE,this.sendSignedInTelemetry(e.tokens.skypeToken,"aad",Date.now())},t.prototype._getSkypeTokenFromAad=function(){var e=this;return this.teamsTokenPromise?this.teamsTokenPromise:this.teamsRemoteTokenExchange?(this.teamsTokenPromise=this.teamsRemoteTokenExchange.tokenProviderCallback().then(function(t){return e._signInWithAadSkypetokens(t),t.tokens.skypeToken}),this.teamsTokenPromise):(this.teamsTokenPromise=new Promise(function(t,n){var r=function(t){e.clearUserDataFromCache(),e.state=b.SigninState.SignedOut,e.sendSignedInTelemetry(null,"aad",Date.now()),n()};e.outerTokenProvider(O.SpacesApi).then(function(n){-1===n.indexOf("Bearer")&&(n="Bearer "+n),d.default.exchangeForSkypeToken(n).then(function(n){n.json?n.json().then(function(n){n.tokens?(n.regionGtms&&(a.default.CHAT_HOST_URL=n.regionGtms.chatService+"/v1/",a.default.CHAT_GUEST_HOST_URL=n.regionGtms.chatService+"/v1/",a.default.AMS_HOST_URL=n.regionGtms.ams+"/v1/",a.default.AVATAR_SERVICE_URL=n.regionGtms.mtImageService),e.setTokenDataToCache(n.tokens.skypeToken,n.tokens.expiresIn,!1),e.currentUsername=e._tokenParser.retrieveMeName(n.tokens.skypeToken),e.state=n.tokens.skypeToken?b.SigninState.SignedIn:b.SigninState.SignedOut,e._lastAuthSource=v.AuthSource.AAD,e._userIdentityType=T.IdentityType.SKYPE,e.sendSignedInTelemetry(n.tokens.skypeToken,"aad",Date.now()),t(n.tokens.skypeToken)):r()},r):r()},r)},function(e){})}),this.getSkypeToken=this._skypeTokenBasedOnAad.bind(this),this.teamsTokenPromise)},t.prototype._skypeTokenBasedOnAad=function(){return this.teamsTokenPromise},t}(u.default);t.default=R},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(50),i=n(51),o=n(7),s=n(14),a=n(119),c=function(){function e(){}return e._encoder=new r.default,e.INVALID_VALUE="invalidValue",e.urlPrefixBlacklist=["http","file","smb"],e.filterOutNotValidItems=function(t,n){for(var r=e.mapArray(t,n),i=[],o=0;o<r.length;o++){var s=r[o];s.isValid&&!s.isValid()||i.push(s)}return i},e.filterOutDisabledItems=function(t,n){for(var r=e.mapArray(t,n),i=[],o=0;o<r.length;o++){var s=r[o];s.isDisabled&&s.isDisabled()||i.push(s)}return i},e.getItemIfNotDisabled=function(e){return e.isDisabled&&e.isDisabled()?null:e},e.mapArray=function(e,t){var n=[];if(!e)return n;for(var r=0;r<e.length;r++){var i=e[r];i&&n.push(t(i))}return n},e.mapImages=function(e,t,n,r){var i=[];return e.forEach(function(e){e.url&&i.push(new a.default(e,t,n,r))}),i},e.normalizeText=function(e){return e?s.default.getMessageSanitizedContent(e):null},e.normalizeUrl=function(t,n,r){var i,a=t?s.default.getMessageSanitizedContent(t):e.INVALID_VALUE,c=e.urlPrefixBlacklist;if(!n)switch(r){case o.SwiftCardActionType.openUrl:case o.SwiftCardActionType.showImage:a=function(t){try{var n=document.createElement("a");return n.href=t,["https:"].indexOf(n.protocol)>-1?t:e.INVALID_VALUE}catch(t){return e.INVALID_VALUE}}(a),a=function(t){for(var n=0;n<c.length;n++)if(new RegExp("^"+c[n]+":","i").test(t))return e.INVALID_VALUE;return t}(a=(i=a).match(/^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)?i:e.INVALID_VALUE);break;case o.SwiftCardActionType.signin:a=/^https/i.test(a)?a:e.INVALID_VALUE}return a=function(t){return t===e.INVALID_VALUE?e.INVALID_VALUE:t.match(/^[\s\S]*javascript:/gim)?e.INVALID_VALUE:t}(a)},e.normalizeDestination=function(t){return/^(skype|tel):/i.test(t)?s.default.getMessageSanitizedContent(t):e.INVALID_VALUE},e.normalizeRichText=function(t,n){if(!t)return"";t=n?t:e._encoder.decode(e._encoder.encode(t)),t=s.default.unescapeBrackets(t);var r=i.default.parse(t);return s.default.getMessageSanitizedContent(r)},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.getQueryParameters=function(){var e=window.location.search.substring(1);return this.extractQueryParameters(e)},e.extractQuery=function(e){var t="";return e.indexOf("?")>-1&&(t=e.split("?")[1]),t},e.getQueryParameter=function(e,t){var n=this.extractQuery(e);return n?this.extractQueryParameters(n)[t]:null},e.extractQueryParameters=function(e){var t={};return e.split("&").forEach(function(e){var n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])||""}),t},e.extractProtocol=function(e){var t=null;return e.indexOf("://")>-1&&(t=e.split("://")[0]),t},e.extractHostname=function(e){return(e.indexOf("//")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0]},e.extractPath=function(e){var t="";e.indexOf("//")>-1&&(e=e.split("//")[1]);var n=e.indexOf("/");return n>-1&&(t=e.substring(n)),t=t.split("?")[0]},e}();t.default=r},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(18),s=n(7),a=function(e){function t(t,n){var r=e.call(this)||this;return r._isTyping=!1,r._person=t,r._role=n&&n.role?n.role:s.ParticipantRole.User,r._capabilities=n&&n.capabilities?n.capabilities:[],r}return i(t,e),Object.defineProperty(t.prototype,"person",{get:function(){return this._person},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"role",{get:function(){return this._role},set:function(e){e!==this._role&&(this._role=e,this.publish("role",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"capabilities",{get:function(){return this._capabilities},set:function(e){e!==this._capabilities&&(this._capabilities=e,this.publish("capabilities",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isTyping",{get:function(){return this._isTyping},set:function(e){if(this._isTyping=e,this.publish("isTyping",e),this._typingIndicatorTimoutId&&clearTimeout(this._typingIndicatorTimoutId),e){var t=this;this._typingIndicatorTimoutId=setTimeout(function(){t.isTyping=!1,t._typingIndicatorTimoutId=void 0},5e3)}},enumerable:!0,configurable:!0}),t}(o.default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hashCode=function(e){var t=0,n=e.length,r=0;if(n>0)for(;r<n;)t=(t<<5)-t+e.charCodeAt(r++)|0;return t}},,function(e,t,n){(function(t){(function(){!function(e){"use strict";if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=function(e){return e&&DataView.prototype.isPrototypeOf(e)},i=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1};l.prototype.append=function(e,t){e=a(e),t=c(t);var n=this.map[e];n||(n=[],this.map[e]=n),n.push(t)},l.prototype.delete=function(e){delete this.map[a(e)]},l.prototype.get=function(e){var t=this.map[a(e)];return t?t[0]:null},l.prototype.getAll=function(e){return this.map[a(e)]||[]},l.prototype.has=function(e){return this.map.hasOwnProperty(a(e))},l.prototype.set=function(e,t){this.map[a(e)]=[c(t)]},l.prototype.forEach=function(e,t){Object.getOwnPropertyNames(this.map).forEach(function(n){this.map[n].forEach(function(r){e.call(t,r,n,this)},this)},this)},l.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),u(e)},l.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),u(e)},l.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),u(e)},t.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);var o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},g.call(m.prototype),g.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},y.error=function(){var e=new y(null,{status:0,statusText:""});return e.type="error",e};var s=[301,302,303,307,308];y.redirect=function(e,t){if(-1===s.indexOf(t))throw new RangeError("Invalid status code");return new y(null,{status:t,headers:{location:e}})},e.Headers=l,e.Request=m,e.Response=y,e.fetch=function(e,n){return new Promise(function(r,i){var o=new m(e,n),s=new XMLHttpRequest;s.onload=function(){var e,t,n={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new l,e.split("\r\n").forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}}),t)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var i="response"in s?s.response:s.responseText;r(new y(i,n))},s.onerror=function(){i(new TypeError("Network request failed"))},s.ontimeout=function(){i(new TypeError("Network request failed"))},s.open(o.method,o.url,!0),"include"===o.credentials&&(s.withCredentials=!0),"responseType"in s&&t.blob&&(s.responseType="blob"),o.headers.forEach(function(e,t){s.setRequestHeader(t,e)}),s.send(void 0===o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}function a(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function u(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(n[Symbol.iterator]=function(){return n}),n}function l(e){this.map={},e instanceof l?e.forEach(function(e,t){this.append(t,e)},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function p(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function d(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function f(e){var t=new FileReader,n=d(t);return t.readAsArrayBuffer(e),n}function h(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&r(e))this._bodyArrayBuffer=h(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!i(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=h(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(f)}),this.text=function(){var e,t,n,r=p(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=d(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}function m(e,t){var n,r,i=(t=t||{}).body;if("string"==typeof e)this.url=e;else{if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new l(e.headers)),this.method=e.method,this.mode=e.mode,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new l(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),o.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function _(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}}),t}function y(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new l(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this),e.exports=t.fetch}).call(t)}).call(this,n(22))},function(e,t,n){(function(t){var n="Expected a function",r=NaN,i="[object Symbol]",o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt,l="object"==typeof t&&t&&t.Object===Object&&t,p="object"==typeof self&&self&&self.Object===Object&&self,d=l||p||Function("return this")(),f=Object.prototype.toString,h=Math.max,g=Math.min,m=function(){return d.Date.now()};function _(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function y(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&f.call(e)==i}(e))return r;if(_(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=_(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var n=a.test(e);return n||c.test(e)?u(e.slice(2),n?2:8):s.test(e)?r:+e}e.exports=function(e,t,r){var i,o,s,a,c,u,l=0,p=!1,d=!1,f=!0;if("function"!=typeof e)throw new TypeError(n);function v(t){var n=i,r=o;return i=o=void 0,l=t,a=e.apply(r,n)}function b(e){var n=e-u;return void 0===u||n>=t||n<0||d&&e-l>=s}function P(){var e=m();if(b(e))return T(e);c=setTimeout(P,function(e){var n=t-(e-u);return d?g(n,s-(e-l)):n}(e))}function T(e){return c=void 0,f&&i?v(e):(i=o=void 0,a)}function w(){var e=m(),n=b(e);if(i=arguments,o=this,u=e,n){if(void 0===c)return function(e){return l=e,c=setTimeout(P,t),p?v(e):a}(u);if(d)return c=setTimeout(P,t),v(u)}return void 0===c&&(c=setTimeout(P,t)),a}return t=y(t)||0,_(r)&&(p=!!r.leading,s=(d="maxWait"in r)?h(y(r.maxWait)||0,t):s,f="trailing"in r?!!r.trailing:f),w.cancel=function(){void 0!==c&&clearTimeout(c),l=0,i=u=o=c=void 0},w.flush=function(){return void 0===c?a:T(m())},w}}).call(this,n(22))},,function(e,t,n){var r=window;r.ES6Promise=r.ES6Promise||n(90),!r.Promise&&r.ES6Promise&&r.ES6Promise.polyfill()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.alias=function(t,n,r,i){var o=e.pathToArray(n),s=o.pop(),a=e.build(o,r);return a[s]=i?t:a[s]||t},e.build=function(t,n){var r=n||window;return e.pathToArray(t).forEach(function(e){return r=r[e]=r[e]||{}}),r},e.pathToArray=function(e){return e instanceof Array?e:e.split(".")},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SKYPE_TOKEN_KEY="skype|token",t.SKYPE_REGTOKEN_KEY="skype|registrationtoken",function(e){e.SkypeToken="skype|token",e.RegistrationToken="skype|registrationtoken",e.Endpoint="skype|endpoint",e.EndpointOwner="skype|endpointowner"}(t.SessionStorageKeys||(t.SessionStorageKeys={}))},,function(e,t,n){var r;!function(i){"use strict";var o="undefined"==typeof window?null:window;void 0===(r=function(){return function e(t){var n=function(t){return e(t)};if(n.version="0.8.3",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var r=t.document,i=r,o=t.DocumentFragment,s=t.HTMLTemplateElement,a=t.NodeFilter,c=t.NamedNodeMap||t.MozNamedAttrMap,u=t.Text,l=t.Comment,p=t.DOMParser;if("function"==typeof s){var d=r.createElement("template");d.content&&d.content.ownerDocument&&(r=d.content.ownerDocument)}var f=r.implementation,h=r.createNodeIterator,g=r.getElementsByTagName,m=r.createDocumentFragment,_=i.importNode,y={};n.isSupported=void 0!==f.createHTMLDocument&&9!==r.documentMode;var v=function(e,t){for(var n=t.length;n--;)"string"==typeof t[n]&&(t[n]=t[n].toLowerCase()),e[t[n]]=!0;return e},b=function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n},P=null,T=v({},["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr","svg","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","switch","symbol","text","textpath","title","tref","tspan","view","vkern","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmuliscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mpspace","msqrt","mystyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","#text"]),w=null,E=v({},["accept","action","align","alt","autocomplete","background","bgcolor","border","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","coords","datetime","default","dir","disabled","download","enctype","face","for","headers","height","hidden","high","href","hreflang","id","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","multiple","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","rows","rowspan","spellcheck","scope","selected","shape","size","span","srclang","start","src","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns","accent-height","accumulate","additivive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mode","min","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","surfacescale","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","u1","u2","unicode","values","viewbox","visibility","vert-adv-y","vert-origin-x","vert-origin-y","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","y","y1","y2","z","zoomandpan","accent","accentunder","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","display","displaystyle","fence","frame","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),S=null,C=null,k=!0,O=!1,A=!1,M=!1,I=/\{\{[\s\S]*|[\s\S]*\}\}/gm,R=/<%[\s\S]*|[\s\S]*%>/gm,N=!1,L=!1,x=!1,D=!1,U=!0,j=!0,F=v({},["audio","head","math","script","style","svg","video"]),H=v({},["audio","video","img","source"]),B=v({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),G=null,z=r.createElement("form"),V=function(e){n.removed.push({element:e});try{e.parentNode.removeChild(e)}catch(t){e.outerHTML=""}},W=function(e,t){n.removed.push({attribute:t.getAttributeNode(e),from:t}),t.removeAttribute(e)},K=function(e){return h.call(e.ownerDocument||e,e,a.SHOW_ELEMENT|a.SHOW_COMMENT|a.SHOW_TEXT,function(){return a.FILTER_ACCEPT},!1)},q=function(e){var t,r;if(ee("beforeSanitizeElements",e,null),function(e){if(e instanceof u||e instanceof l)return!1;if("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof c)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute)return!0;return!1}(e))return V(e),!0;if(t=e.nodeName.toLowerCase(),ee("uponSanitizeElement",e,{tagName:t}),!P[t]||S[t]){if(j&&!F[t]&&"function"==typeof e.insertAdjacentHTML)try{e.insertAdjacentHTML("AfterEnd",e.innerHTML)}catch(e){}return V(e),!0}return!A||e.firstElementChild||e.content&&e.content.firstElementChild||!/</g.test(e.textContent)||(n.removed.push({element:e.cloneNode()}),e.innerHTML=e.textContent.replace(/</g,"&lt;")),M&&3===e.nodeType&&(r=(r=(r=e.textContent).replace(I," ")).replace(R," "),e.textContent!==r&&(n.removed.push({element:e.cloneNode()}),e.textContent=r)),ee("afterSanitizeElements",e,null),!1},Y=/^data-[\-\w.\u00B7-\uFFFF]/,X=/^(?:(?:(?:f|ht)tps?|mailto|tel|skype):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,J=/^(?:\w+script|data):/i,$=/[\x00-\x20\xA0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Q=function(e){var i,o,s,a,c,u,l,p;if(ee("beforeSanitizeAttributes",e,null),u=e.attributes){for(l={attrName:"",attrValue:"",keepAttr:!0},p=u.length;p--;)if(i=u[p],o=i.name,s=i.value,a=o.toLowerCase(),l.attrName=a,l.attrValue=s,l.keepAttr=!0,ee("uponSanitizeAttribute",e,l),s=l.attrValue,"name"===a&&"IMG"===e.nodeName&&u.id?(c=u.id,u=Array.prototype.slice.apply(u),W("id",e),W(o,e),u.indexOf(c)>p&&e.setAttribute("id",c.value)):("id"===o&&e.setAttribute(o,""),W(o,e)),l.keepAttr&&(!U||"id"!==a&&"name"!==a||!(s in t||s in r||s in z))){if(M&&(s=(s=s.replace(I," ")).replace(R," ")),k&&Y.test(a));else{if(!w[a]||C[a])continue;if(B[a]);else if(X.test(s.replace($,"")));else if("src"===a&&0===s.indexOf("data:")&&H[e.nodeName.toLowerCase()]);else if(O&&!J.test(s.replace($,"")));else if(s)continue}try{e.setAttribute(o,s),n.removed.pop()}catch(e){}}ee("afterSanitizeAttributes",e,null)}},Z=function(e){var t,n=K(e);for(ee("beforeSanitizeShadowDOM",e,null);t=n.nextNode();)ee("uponSanitizeShadowNode",t,null),q(t)||(t.content instanceof o&&Z(t.content),Q(t));ee("afterSanitizeShadowDOM",e,null)},ee=function(e,t,r){y[e]&&y[e].forEach(function(e){e.call(n,t,r,G)})};return n.sanitize=function(e,r){var s,a,c,u,l;if(e||(e=""),"string"!=typeof e){if("function"!=typeof e.toString)throw new TypeError("toString is not a function");e=e.toString()}if(!n.isSupported)return"object"==typeof t.toStaticHTML||"function"==typeof t.toStaticHTML?t.toStaticHTML(e):e;if(function(e){"object"!=typeof e&&(e={}),P="ALLOWED_TAGS"in e?v({},e.ALLOWED_TAGS):T,w="ALLOWED_ATTR"in e?v({},e.ALLOWED_ATTR):E,S="FORBID_TAGS"in e?v({},e.FORBID_TAGS):{},C="FORBID_ATTR"in e?v({},e.FORBID_ATTR):{},k=!1!==e.ALLOW_DATA_ATTR,O=e.ALLOW_UNKNOWN_PROTOCOLS||!1,A=e.SAFE_FOR_JQUERY||!1,M=e.SAFE_FOR_TEMPLATES||!1,N=e.WHOLE_DOCUMENT||!1,L=e.RETURN_DOM||!1,x=e.RETURN_DOM_FRAGMENT||!1,D=e.RETURN_DOM_IMPORT||!1,U=!1!==e.SANITIZE_DOM,j=!1!==e.KEEP_CONTENT,M&&(k=!1),x&&(L=!0),e.ADD_TAGS&&(P===T&&(P=b(P)),v(P,e.ADD_TAGS)),e.ADD_ATTR&&(w===E&&(w=b(w)),v(w,e.ADD_ATTR)),j&&(P["#text"]=!0),Object&&"freeze"in Object&&Object.freeze(e),G=e}(r),n.removed=[],!L&&!N&&-1===e.indexOf("<"))return e;if(!(s=function(e){var t,n;try{t=(new p).parseFromString(e,"text/html")}catch(e){}return t&&t.documentElement||(t=f.createHTMLDocument(""),(n=t.body).parentNode.removeChild(n.parentNode.firstElementChild),n.outerHTML=e),"function"==typeof t.getElementsByTagName?t.getElementsByTagName(N?"html":"body")[0]:g.call(t,N?"html":"body")[0]}(e)))return L?null:"";for(u=K(s);a=u.nextNode();)3===a.nodeType&&a===c||q(a)||(a.content instanceof o&&Z(a.content),Q(a),c=a);if(L){if(x)for(l=m.call(s.ownerDocument);s.firstChild;)l.appendChild(s.firstChild);else l=s;return D&&(l=_.call(i,l,!0)),l}return N?s.outerHTML:s.innerHTML},n.addHook=function(e,t){"function"==typeof t&&(y[e]=y[e]||[],y[e].push(t))},n.removeHook=function(e){y[e]&&y[e].pop()},n.removeHooks=function(e){y[e]&&(y[e]=[])},n.removeAllHooks=function(){y={}},n}(o)}.call(t,n,t,e))||(e.exports=r)}()},function(e,t,n){(function(t){var n=1/0,r="[object Symbol]",i=/[&<>"'`]/g,o=RegExp(i.source),s="object"==typeof t&&t&&t.Object===Object&&t,a="object"==typeof self&&self&&self.Object===Object&&self,c=s||a||Function("return this")();var u,l=(u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},function(e){return null==u?void 0:u[e]}),p=Object.prototype.toString,d=c.Symbol,f=d?d.prototype:void 0,h=f?f.toString:void 0;function g(e){if("string"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&p.call(e)==r}(e))return h?h.call(e):"";var t=e+"";return"0"==t&&1/e==-n?"-0":t}e.exports=function(e){var t;return(e=null==(t=e)?"":g(t))&&o.test(e)?e.replace(i,l):e}}).call(this,n(22))},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(18),a=n(17),c=function(e){function t(){var t=e.call(this)||this;return t._isOnline=navigator.onLine,t.subscribeOnlineHandlers(),t}return i(t,e),Object.defineProperty(t.prototype,"isOnline",{get:function(){return this._isOnline},set:function(e){e!==this._isOnline&&(this._isOnline=e,this.publish("isOnline",e),e&&this._onlinePromise&&this._onlinePromise.status===a.PromiseStatus.Pending&&this._onlinePromise.resolve())},enumerable:!0,configurable:!0}),t.prototype.onceOnline=function(){return this.isOnline?Promise.resolve():(this._onlinePromise&&this._onlinePromise.status===a.PromiseStatus.Pending||(this._onlinePromise=new a.CancelablePromise),this._onlinePromise.promise)},t.prototype.subscribeOnlineHandlers=function(){window.addEventListener("online",this.onlineStatusHandler.bind(this)),window.addEventListener("offline",this.onlineStatusHandler.bind(this))},t.prototype.unsubscribeOnlineHandlers=function(){window.removeEventListener("online",this.onlineStatusHandler),window.removeEventListener("offline",this.onlineStatusHandler)},t.prototype.onlineStatusHandler=function(){this.isOnline=navigator.onLine},t}(s.default);t.get=function(){return o||(o=new c),o}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=function(e){function t(t,n){var r=e.call(this,"notification_action")||this;return r.notificationType=t,r.notificationAction=n,r}return i(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(o.TelemetryPropertyValue.Create("type",this.notificationType)),e.push(o.TelemetryPropertyValue.Create("action",this.notificationAction)),e},t}(n(8).TelemetryEvent);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(20),o=function(){function e(){this.id=i.guid.generate(),this.title="",this.description="",this.sender="",this.avatarUrl="",this.actions=[]}return e.prototype.hide=function(){window.swc.API.triggerEvent(r.ApiEvents.HideNotification,this.id)},e}();t.Notification=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.UNDETERMINED=10]="UNDETERMINED",e[e.TEXT=100]="TEXT",e[e.IMAGE=200]="IMAGE",e[e.FILE=300]="FILE",e[e.SWIFT=400]="SWIFT",e[e.TYPING=500]="TYPING",e[e.EMOTICON=600]="EMOTICON",e[e.QUICK_REPLY=700]="QUICK_REPLY"}(t.MessageType||(t.MessageType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(83),i=n(1),o=n(44),s=n(7),a=n(56),c="https://www.skype.com/",u="width=600, height=620, menubar=no, status=no, titlebar=no, toolbar=no, rel=noopener noreferrer",l=function(){function e(e,t,n){var l=this;switch(this.type=s.SwiftCardActionType.unknown,this.actions={},this.isValid=function(){return!!l.title||!!l.value||!!l.fallbackUri},this.isDisabled=function(){return!1},this.isSupported=function(){return null!==l.type&&l.type!==s.SwiftCardActionType.unknown},this.action=function(){return l.isValid()&&!l.isCalling()?l.actions[s.SwiftCardActionType[l.type]]().then(function(){}).catch(function(){}):Promise.resolve()},this.openUrl=function(){return l.value.match(/^skype:\?payments/)||l.value.match(/^skype:/),window.open(l.value,"_blank").opener=null,Promise.resolve()},this.imBack=function(){Date.now();return l.conversation.sendSwift({title:l.title,value:l.value}).then(function(){Date.now();return Promise.resolve()}).catch(function(){Date.now()})},this.showImage=function(){var e=l.value||"";return l.conversation.sendMessage(e,o.ActionTrigger.SUGGESTED_ACTION),Promise.resolve()},this.postBack=function(){return l.conversation.sendSwift({title:l.title,value:l.value,image:l.image}),Promise.resolve()},this.payment=function(){var e=l.fallbackUri?l.fallbackUri:l.value;if(e){var t=window.open(e,"_blank",u);return t&&window.focus&&t.focus(),t.opener=null,Promise.resolve()}},this.convertToActionType=function(e){if(!e)return null;try{switch(e.toLowerCase()){case"unsupported":return s.SwiftCardActionType.unsupported;case"openurl":return s.SwiftCardActionType.openUrl;case"imback":return s.SwiftCardActionType.imBack;case"signin":return s.SwiftCardActionType.signin;case"call":return s.SwiftCardActionType.call;case"showimage":return s.SwiftCardActionType.showImage;case"payment":case"anypayment":return s.SwiftCardActionType.payment;case"postback":return s.SwiftCardActionType.postBack;default:return s.SwiftCardActionType.unknown}}catch(e){return s.SwiftCardActionType.unknown}},this.type=this.convertToActionType(e.type),this.isCallActionType=this.type===s.SwiftCardActionType.call,this.title=a.default.normalizeText(e.title),this.value=e.value?a.default.normalizeUrl(e.value,t.isDirectLineBackend()):null,this.isCalling=ko.observable(!1),this.senderId=n,this.tooltip=this.title,this.image=e.image?e.image:null,this.fallbackUri=e.fallback&&e.fallback.uri?a.default.normalizeUrl(e.fallback.uri,t.isDirectLineBackend()):null,this.actions[s.SwiftCardActionType[s.SwiftCardActionType.call]]=this.call,this.actions[s.SwiftCardActionType[s.SwiftCardActionType.imBack]]=this.imBack,this.actions[s.SwiftCardActionType[s.SwiftCardActionType.postBack]]=this.postBack,this.actions[s.SwiftCardActionType[s.SwiftCardActionType.openUrl]]=this.openUrl,this.actions[s.SwiftCardActionType[s.SwiftCardActionType.showImage]]=this.showImage,this.actions[s.SwiftCardActionType[s.SwiftCardActionType.signin]]=this.openUrl,this.actions[s.SwiftCardActionType[s.SwiftCardActionType.payment]]=this.payment,this.type){case s.SwiftCardActionType.call:this.value=a.default.normalizeDestination(this.value);break;case s.SwiftCardActionType.imBack:if(t.isGroup()){var p=this.value,d=n.substring(3),f=function(){var e=new r.MentionDomEncoder,n=e.getMentionUserData(d,t);if(n){var i=e.createXmlElement(document,n).outerHTML;l.value=i+" "+p}};t.participants.filter(function(e){return e.person.id.toLowerCase()===d}).forEach(function(e){e.person.subscribe("displayName",f)}),f()}break;case s.SwiftCardActionType.showImage:this.value&&(this.value=a.default.normalizeUrl(e.value,t.isDirectLineBackend())),this.title||(this.title=i.default.instance.i18n.fetch("s_showImageTitle"));break;case s.SwiftCardActionType.payment:this.value&&(this.value.match(/^skype:\?payments/)?this.value=a.default.normalizeDestination(this.value):this.value=a.default.normalizeUrl(e.value,t.isDirectLineBackend()));break;case s.SwiftCardActionType.openUrl:this.value&&(this.value.match(/^skype:/)?this.value=a.default.normalizeDestination(this.value):this.value=a.default.normalizeUrl(e.value,t.isDirectLineBackend(),s.SwiftCardActionType.openUrl),this.tooltip?this.tooltip+="\n\n"+this.value:this.tooltip=this.value);break;case s.SwiftCardActionType.signin:this.value=a.default.normalizeUrl(e.value,t.isDirectLineBackend(),s.SwiftCardActionType.signin),this.title||(this.title=i.default.instance.i18n.fetch("s_signInTitle"));break;case s.SwiftCardActionType.unsupported:this.type=s.SwiftCardActionType.openUrl,this.title||(this.title=i.default.instance.i18n.fetch("s_unsupported_button")),this.value||(this.value=c);break;case s.SwiftCardActionType.postBack:this.title=a.default.normalizeText(this.title),this.value=a.default.normalizeText(this.value),this.tooltip||(this.tooltip=this.title)}this.conversation=t}return e.prototype.call=function(){return Promise.reject("Calling is not supported")},e}();t.default=l},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),s=n(18),a=n(40),c=n(7),u=function(e){function t(t,n){var r=e.call(this)||this;return r.customType=c.CustomMessageType.Custom,r.supportedAnnotations=[],r.type=c.MessageType.UserMessage,r._isDeleted=!1,r._isEdited=!1,r.timestamp=new Date,r.originalTimestamp=r.timestamp,r._payload=n,r._status=c.DeliveryStatus.Pending,r.suggestedActions=new a.ObservableCollection,t&&(r.type=c.MessageType.SystemMessage),r.supportedAnnotations.push(o.default.MESSAGE_PROPERTIES.PER_USER.EMOTIONS),r.emotions=new a.ObservableCollection,r.files=new a.ObservableCollection,r}return i(t,e),Object.defineProperty(t.prototype,"clientMessageId",{get:function(){return this._clientMessageId},set:function(e){this._clientMessageId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"composeTime",{get:function(){return this._composeTime},set:function(e){e!==this._composeTime&&(this._composeTime=e,this.publish("composeTime",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return this._content},set:function(e){e!==this._content&&(this._content=e,this.publish("content",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this._direction},set:function(e){e!==this._direction&&(this._direction=e,this.publish("direction",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(e){e!==this._id&&(this._id=e,this.publish("id",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageContent",{get:function(){return this._imageContent},set:function(e){e!==this._imageContent&&(this._imageContent=e,this.publish("imageContent",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDeleted",{get:function(){return this._isDeleted},set:function(e){e!==this._isDeleted&&(this._isDeleted=e,this.publish("isDeleted",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEdited",{get:function(){return this._isEdited},set:function(e){e!==this._isEdited&&(this._isEdited=e,this.publish("isEdited",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFirst",{get:function(){return this._isFirst},set:function(e){e!==this._isFirst&&(this._isFirst=e,this.publish("isFirst",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isTranslated",{get:function(){return this._isTranslated},set:function(e){e!==this._isTranslated&&(this._isTranslated=e,this.publish("isTranslated",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this._key},set:function(e){e!==this._key&&(this._key=e,this.publish("key",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"originalTimestamp",{get:function(){return this._originalTimestamp},set:function(e){e!==this._originalTimestamp&&(this._originalTimestamp=e,this.publish("originalTimestamp",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"payload",{get:function(){return this._payload},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"processedContent",{get:function(){return this._processedContent},set:function(e){e!==this._processedContent&&(this._processedContent=e,this.publish("processedContent",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rawMessageType",{get:function(){return this._rawMessageType},set:function(e){this._rawMessageType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sender",{get:function(){return this._sender},set:function(e){e!==this._sender&&(this._sender=e,this.publish("sender",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"senderId",{get:function(){return this._senderId},set:function(e){e!==this._senderId&&(this._senderId=e,this.publish("senderId",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skypeEditedId",{get:function(){return this._skypeEditedId},set:function(e){e!==this._skypeEditedId&&(this._skypeEditedId=e,this.publish("skypeEditedId",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this._status},set:function(e){e!==this._status&&(this._status=e,this.publish("status",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timestamp",{get:function(){return this._timestamp},set:function(e){e!==this._timestamp&&(this._timestamp=e,this.publish("timestamp",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"translation",{get:function(){return this._content},set:function(e){e!==this._translation&&(this._translation=e,this.publish("translation",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},set:function(e){e!==this._version&&(this._version=e)},enumerable:!0,configurable:!0}),t}(s.default);t.default=u},,,function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,u=[],l=!1,p=-1;function d(){l&&c&&(l=!1,c.length?u=c.concat(u):p=-1,u.length&&f())}function f(){if(!l){var e=a(d);l=!0;for(var t=u.length;t;){for(c=u,u=[];++p<t;)c&&c[p].run();p=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new h(e,t)),1!==u.length||l||a(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){"function"!=typeof Object.assign&&(Object.assign=function(e){"use strict";if(null==e)throw new TypeError;e=Object(e);for(var t=1;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.testOrigin=function(t){return e.origin!==t},e.post=function(t,n){try{e.targets[t].target.postMessage(n,"*")}catch(e){}},e.cast=function(t,n,r,i){var o={name:t,origin:e.origin,payload:n};r?Array.isArray(r)?r.forEach(function(t){return e.post(t,o)}):e.post(r,o):Object.keys(e.targets).forEach(function(t){return i!==e.targets[t].origin&&e.post(t,o)})},e.exists=function(t){return!!e.registry[t]},e.copy=function(t){t&&t.registry&&Object.getOwnPropertyNames(t.registry).forEach(function(n){var r=Object.getOwnPropertyDescriptor(t.registry,n);r&&r.writable&&(e.registry[n]=r.value||e.registry[n])})},e.addTarget=function(t,n,r,i){e.targets[t]=e.targets[t]||{target:i,origin:n,targetDomain:r}},e.removeTarget=function(t){delete e.targets[t]},e.connect=function(t){e.origin=t,e.connected||(window.addEventListener("message",e.receiver),e.connected=!0)},e.disconnect=function(){window.removeEventListener("message",e.receiver),e.connected=!1},e.registerEvent=function(t,n){if(t&&n){var r=e.registry;if(r[t]){if(-1!==r[t].indexOf(n))return}else r[t]=[];r[t].push(n)}},e.unregisterEvent=function(t,n){if(t&&n){var r=e.registry;if(r[t]&&r[t].length){var i=r[t].indexOf(n);-1!==i&&r[t].splice(i,1)}}},e.triggerEvent=function(t,n,r,i,o){void 0===r&&(r=!0),e.connected&&r&&e.cast(t,n,i,o);var s=!1,a=e.registry;return a[t]&&a[t].forEach(function(e){try{e(n),s=!0}catch(e){}}),s},e.dispose=function(){for(var t in e.registry)delete e.registry[t];e.disconnect()},e.targets={},e.receiver=function(t){var n=t.data;n&&n.origin&&e.testOrigin(n.origin)&&n.name&&e.triggerEvent(n.name,n.payload,!0,null,n.origin)},e.registry={},e}();t.default=r},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=n(36),a=n(8),c=function(e){function t(t){var n=e.call(this,"kpi_conversation_load",t)||this;return n.status=200,n.cached=!1,n}return i(t,e),t.prototype.getCustomProperties=function(){var t=e.prototype.getCustomProperties.call(this);return t.push(o.TelemetryPropertyValue.Create("status",this.getProperty(this.status))),t.push(o.TelemetryPropertyValue.Create("timeLoad",this.timeToLoad||0)),t.push(o.TelemetryPropertyValue.Create("timeRender",this.timeToRender||0)),t.push(o.TelemetryPropertyValue.Create("messages",this.messagesCount||a.NA)),t.push(o.TelemetryPropertyValue.Create("cached",this.cached)),t},t.isAvailable=!0,t}(s.ConversationDataEvent);t.ConversationLoadEvent=c},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n(12),a=n(9),c=n(1),u=n(20),l=function(e){function t(t){var n=e.call(this,t)||this;return n._id=u.guid.generate(),n.state=o({isAnimated:!1,textOnly:!1},n._getNewState(t)),t.setUpdateCallback&&t.setUpdateCallback(function(e){n.setState(function(){return n._getNewState(e)})}),n}return i(t,e),t.prototype._getNewState=function(e){var t=c.default.instance.PesManager.emoticonMap,n=e.emoticonId||this.props.emoticonId,r=e.textContent||this.props.textContent,i=e.title||this.props.title;if(!n||!t.hasOwnProperty(n))return{textOnly:!0,textContent:r};var o={textOnly:!1,textContent:r,title:i,emoticonId:n};return!0===e.isAnimated?o.isAnimated=!0:!1===e.isAnimated&&(o.isAnimated=!1),o},t.prototype.componentDidMount=function(){var e=this;this.setState(function(t,n){return e._getNewState(n)})},t.prototype.componentWillReceiveProps=function(e){var t=this;this.setState(function(){return t._getNewState(e)})},t.prototype.render=function(){if(this.state.textOnly)return a.createElement("span",null,this.state.textContent);var e=["emoticon"],t={"data-item-id":this.state.emoticonId,"data-is-animated":this.state.isAnimated,textContent:this.state.textContent,title:this.state.title};return this.props.large&&e.push(this.props.largeEmoticonClass),a.createElement("span",{className:e.join(" ")},a.createElement("canvas",o({},t,{id:this._id})))},t}(s.Component);t.SwcEmoticon=l},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=/(\(|\))/g,s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.isElementAllowed=function(e){return"i"!==e.nodeName.toLowerCase()||-1===e.className.toLowerCase().indexOf("mention")},t.prototype.wordRawToXml=function(e,t,n,r){for(var i,o=[],s=/[\.,_:\-;?]$/,a=t.substring(1),c=this.getMentionUserData(a,n,r);!c&&a.match(s);)i=a.charAt(a.length-1),a=a.substring(0,a.length-1),c=this.getMentionUserData(a,n,r);return c&&(o.push(this.createXmlElement(e,c)),i&&o.push(e.createTextNode(i))),o},t.prototype.getMentionUserData=function(e,t,n){var r,i={defaultDisplayName:"",displayName:"",skypeId:"",type:"",isMePerson:!1};if(!e)return null;var s=0===(e=e.toLowerCase()).indexOf("("),a=s?e.substring(1,e.length-1):"",c=t?t.participants:[];if(i.isMePerson=!!n&&(e===n.id.toLowerCase()||s&&n.displayName.replace(o,"").toLowerCase()===a),i.isMePerson)r=n;else{var u=c.filter(function(t){return t.person.id.toLowerCase()===e||s&&t.person.displayName.replace(o,"").toLowerCase()===a});u.length&&(r=u[0].person)}return r?(i.skypeId=r.id,i.type="28",i.displayName=r.displayName,i.defaultDisplayName||(i.defaultDisplayName=i.displayName),i):null},t.prototype.wordMatcher=function(){return/@([a-z0-9\.,\-_:]+|\(.+?\))/gi},t.prototype.createXmlElement=function(e,t){var n=e.createElement("at");return n.setAttribute("id",t.type+":"+t.skypeId),n.innerText=t.defaultDisplayName,n},t}(n(37).WordDomTransformer);t.MentionDomEncoder=s},,,function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(30),s=n(5),a=n(8),c=function(e){function t(){return e.call(this,"runtimeError")||this}return i(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(s.TelemetryPropertyValue.Create("message",this.message)),e.push(s.TelemetryPropertyValue.Create("shortMessage",this.shortMessage)),e.push(s.TelemetryPropertyValue.Create("stack",this.stack)),e.push(s.TelemetryPropertyValue.Create("code",this.code)),e.push(this.getConversationId()),e},t.prototype.getConversationId=function(){return this.conversationId?0===this.conversationId.indexOf("8:")?s.TelemetryPropertyValue.Create("conversationId",this.conversationId,o.PIIType.Identity):s.TelemetryPropertyValue.Create("conversationId",this.conversationId):s.TelemetryPropertyValue.Create("conversationId",a.NA)},t}(a.TelemetryEvent);t.ErrorEvent=c},function(e,t){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1})},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.isElementAllowed=function(e){return"a"!==e.nodeName.toLowerCase()},t.prototype.wordRawToXml=function(e,t){var n,r=t.match(/^(?:https?:\/\/|mailto:)(.+)$/i),i=r&&r[0],o=i;return i||(i=(r=t.match(/^[^@]+@(?:\w+(?:\.\w+)+)$/i))&&"mailto:"+r[0],o=r&&r[0]),i||(r=t.match(/^(?:www(?:\.\w+){1,}\.(?:com|org|net|edu|gov|mil|aero|arpa|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|pro|tel|travel|[a-z]{2,3}))$/i))&&r[0]&&(n=r.input?r.input.split("?")[1]:"",i="https://"+r[0],o=i=n?i+"?"+n:i),i?[this.createXmlElement(e,i,o)]:[]},t.prototype.wordMatcher=function(){return/\S+/g},t.prototype.createXmlElement=function(e,t,n){var r=e.createElement("a");return r.setAttribute("href",t),r.setAttribute("title",t),r.setAttribute("target","_blank"),r.setAttribute("tabindex","-1"),r.innerText=n,r},t}(n(37).WordDomTransformer);t.URLDomTransformer=o},,function(e,t,n){(function(t,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.4+314e4831
 */var r;r=function(){"use strict";function e(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=0,o=void 0,s=void 0,a=function(e,t){h[i]=e,h[i+1]=t,2===(i+=2)&&(s?s(g):b())};var c="undefined"!=typeof window?window:void 0,u=c||{},l=u.MutationObserver||u.WebKitMutationObserver,p="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var e=setTimeout;return function(){return e(g,1)}}var h=new Array(1e3);function g(){for(var e=0;e<i;e+=2){(0,h[e])(h[e+1]),h[e]=void 0,h[e+1]=void 0}i=0}var m,_,y,v,b=void 0;function P(e,t){var n=this,r=new this.constructor(E);void 0===r[w]&&F(r);var i=n._state;if(i){var o=arguments[i-1];a(function(){return U(i,r,o,n._result)})}else x(n,r,e,t);return r}function T(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(E);return I(t,e),t}p?b=function(){return t.nextTick(g)}:l?(_=0,y=new l(g),v=document.createTextNode(""),y.observe(v,{characterData:!0}),b=function(){v.data=_=++_%2}):d?((m=new MessageChannel).port1.onmessage=g,b=function(){return m.port2.postMessage(0)}):b=void 0===c?function(){try{var e=Function("return this")().require("vertx");return void 0!==(o=e.runOnLoop||e.runOnContext)?function(){o(g)}:f()}catch(e){return f()}}():f();var w=Math.random().toString(36).substring(2);function E(){}var S=void 0,C=1,k=2,O={error:null};function A(e){try{return e.then}catch(e){return O.error=e,O}}function M(t,n,r){n.constructor===t.constructor&&r===P&&n.constructor.resolve===T?function(e,t){t._state===C?N(e,t._result):t._state===k?L(e,t._result):x(t,void 0,function(t){return I(e,t)},function(t){return L(e,t)})}(t,n):r===O?(L(t,O.error),O.error=null):void 0===r?N(t,n):e(r)?function(e,t,n){a(function(e){var r=!1,i=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(n,t,function(n){r||(r=!0,t!==n?I(e,n):N(e,n))},function(t){r||(r=!0,L(e,t))},e._label);!r&&i&&(r=!0,L(e,i))},e)}(t,n,r):N(t,n)}function I(e,t){var n,r;e===t?L(e,new TypeError("You cannot resolve a promise with itself")):(r=typeof(n=t),null===n||"object"!==r&&"function"!==r?N(e,t):M(e,t,A(t)))}function R(e){e._onerror&&e._onerror(e._result),D(e)}function N(e,t){e._state===S&&(e._result=t,e._state=C,0!==e._subscribers.length&&a(D,e))}function L(e,t){e._state===S&&(e._state=k,e._result=t,a(R,e))}function x(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+C]=n,i[o+k]=r,0===o&&e._state&&a(D,e)}function D(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,o=e._result,s=0;s<t.length;s+=3)r=t[s],i=t[s+n],r?U(n,r,i,o):i(o);e._subscribers.length=0}}function U(t,n,r,i){var o=e(r),s=void 0,a=void 0,c=void 0,u=void 0;if(o){if((s=function(e,t){try{return e(t)}catch(e){return O.error=e,O}}(r,i))===O?(u=!0,a=s.error,s.error=null):c=!0,n===s)return void L(n,new TypeError("A promises callback cannot return that same promise."))}else s=i,c=!0;n._state!==S||(o&&c?I(n,s):u?L(n,a):t===C?N(n,s):t===k&&L(n,s))}var j=0;function F(e){e[w]=j++,e._state=void 0,e._result=void 0,e._subscribers=[]}var H=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(E),this.promise[w]||F(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?N(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&N(this.promise,this._result))):L(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===S&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===T){var i=A(e);if(i===P&&e._state!==S)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===B){var o=new n(E);M(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===S&&(this._remaining--,e===k?L(r,n):this._result[t]=n),0===this._remaining&&N(r,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;x(e,void 0,function(e){return n._settledAt(C,t,e)},function(e){return n._settledAt(k,t,e)})},e}();var B=function(){function e(t){this[w]=j++,this._result=this._state=void 0,this._subscribers=[],E!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){I(e,t)},function(t){L(e,t)})}catch(t){L(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},e}();return B.prototype.then=P,B.all=function(e){return new H(this,e).promise},B.race=function(e){var t=this;return r(e)?new t(function(n,r){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(n,r)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},B.resolve=T,B.reject=function(e){var t=new this(E);return L(t,e),t},B._setScheduler=function(e){s=e},B._setAsap=function(e){a=e},B._asap=a,B.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=B},B.Promise=B,B},e.exports=r()}).call(this,n(78),n(22))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(28),i=n(19),o=function(){function e(){}return e.addScript=function(t,n,o,s){var a=n?i.default.getAbsoluteUrl(t,"js"):t;if(-1==e.loaded.indexOf(a)){var c=e.progress;if(c[a])return o&&-1==c[a].success.indexOf(o)&&c[a].success.push(o),void(s&&-1==c[a].failure.indexOf(s)&&c[a].failure.push(s));c[a]={success:[],failure:[]},o&&c[a].success.push(o),s&&c[a].failure.push(s);var u=r.default.getDocument(),l=u.createElement("script");l.type="text/javascript",l.src=a,o&&(l.onload=function(){e.progress[a].success.forEach(function(e){try{e()}catch(e){}}),delete e.progress[a],e.loaded.push(a)}),s&&(l.onerror=function(){e.progress[a].failure.forEach(function(e){try{e()}catch(e){}}),delete e.progress[a]}),u.getElementsByTagName("body")[0].appendChild(l)}else o&&o()},e.hasScript=function(e){for(var t=0;t<document.scripts.length;t++){if(document.scripts[t].src===e)return!0}return!1},e.loaded=[],e.progress={},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={allowedProtocols:["https:"]},i=function(){function e(){this.probe=document.createElement("a")}return Object.defineProperty(e,"instance",{get:function(){return e.init()},enumerable:!0,configurable:!0}),e.init=function(){return e._instance||(e._instance=new e)},e.prototype.validate=function(e,t){if(!e)return!1;var n=Object.assign(r,t||{}),i=function(e,t){if(!t)return!0;for(var n,r=0,i=t;r<i.length;r++){if(n=i[r]===e)break}return n};this.probe.href=e;var o=i(this.probe.protocol,n.allowedProtocols)&&i(this.probe.hostname,n.allowedDomains)&&i(this.probe.port,n.allowedPorts);return this.probe.href="",o},e}();t.UrlValidator=i},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.unknown=0]="unknown",e[e.card=1]="card",e[e.carousel=2]="carousel",e[e.signin=3]="signin",e[e.receipt=4]="receipt",e[e.multiline=5]="multiline",e[e.adaptive=6]="adaptive"}(t.SwiftCardType||(t.SwiftCardType={})),function(e){e[e.unknown=0]="unknown",e[e.hero=1]="hero",e[e.thumb=2]="thumb",e[e.receipt=3]="receipt",e[e.signin=4]="signin",e[e.video=5]="video",e[e.audio=6]="audio",e[e.animation=7]="animation",e[e.actionImage=8]="actionImage",e[e.flex=9]="flex",e[e.adaptive=10]="adaptive"}(t.SwiftCardContentType||(t.SwiftCardContentType={})),function(e){e[e.unknown=0]="unknown",e[e.unsupported=1]="unsupported",e[e.openUrl=2]="openUrl",e[e.imBack=3]="imBack",e[e.signin=4]="signin",e[e.call=5]="call",e[e.showImage=6]="showImage",e[e.payment=7]="payment",e[e.postBack=8]="postBack"}(t.SwiftCardActionType||(t.SwiftCardActionType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.UserMessage="UserMessage",e.SwiftCard="SwiftCard",e.SystemMessage="SystemMessage",e.Unsupported="Unsupported",e.SkypeLogo="SkypeLogo",e.Welcome="Welcome",e.Translate="Translate",e.LwcImage="LwcImage",e.LwcFile="LwcFile",e.UnreadSplitter="UnreadSplitter"}(t.MessageType||(t.MessageType={})),function(e){e.CallEnd="CallEndMsg",e.MissedCall="MissedCallMsg",e.MissedGroupCall="MissedGroupCallMsg",e.Call="CallMsg",e.Custom="CustomMsg",e.MeLeftGroup="MeLeftGroupConversation"}(t.CustomMessageType||(t.CustomMessageType={})),function(e){e[e.Incoming=0]="Incoming",e[e.Outgoing=1]="Outgoing"}(t.Direction||(t.Direction={})),function(e){e[e.Pending=0]="Pending",e[e.Sent=1]="Sent",e[e.Failed=2]="Failed"}(t.DeliveryStatus||(t.DeliveryStatus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.addMember="addMember",e.changeTopic="changeTopic",e.changePicture="changePicture",e.kickMember="kickMember",e.editMsg="editMsg",e.callP2P="callP2P",e.sendText="sendText",e.sendSms="sendSms",e.sendFileP2P="sendFileP2P",e.sendContacts="sendContacts",e.sendVideoMsg="sendVideoMsg",e.sendMediaMsg="sendMediaMsg",e.changeModerated="changeModerated"}(t.ParticipantCapabilities||(t.ParticipantCapabilities={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Admin="Admin",e.User="User"}(t.ParticipantRole||(t.ParticipantRole={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e){var t=this;this.getLogger=function(e){if(t.loggerPromise)return t.loggerPromise;var n=new r.swcWindow.ariaTelemetry.LogConfiguration;return n.disableCookies=!0,r.swcWindow.ariaTelemetry.LogManager.initialize(t.tenantId,n),t.loggerPromise=new Promise(function(n,i){t.logger?n(t.logger):(t.logger=new r.swcWindow.ariaTelemetry.Logger(e),n(t.logger))}),t.loggerPromise},this.tenantId=e,this.getLogger(e)}return e.prototype.sendEvent=function(e){this.getLogger(this.tenantId).then(function(t){t.logEvent(e)})},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.multilineRegExp=function(e,t){return new RegExp(e.join(""),t)},e.escapeSpecialChars=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},e}();t.default=r},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(16),o=n(253),s={retryCount:3,timeout:12e4,policy:""};t.request=function(e,t,n){var o=0===t.indexOf("http")?t:r.default.AMS_HOST_URL+t;return i.default("ams-"+e,s,o,n)},t.putData=function(e,n,r){return o.getHeaders().then(function(i){var o={method:"PUT"};return o.body=r,o.headers=i,t.request(e,n,o)})},t.getData=function(e,n){return o.getHeaders().then(function(r){r.append("Accept","image/webp,image/*,*/*;q=0.8"),r.append("Accept-Encoding","gzip, deflate, sdch, br");var i={method:"GET"};return i.headers=r,t.request(e,n,i).then(function(e){return e.blob()})})},t.getJson=function(e,n){return o.getHeaders().then(function(r){r.append("Accept","image/webp,image/*,*/*;q=0.8"),r.append("Accept-Encoding","gzip, deflate, sdch, br");var i={method:"GET"};return i.headers=r,t.request(e,n,i).then(function(e){return e.json()})})},t.post=function(e,n,r){return o.getHeaders().then(function(i){i.append("Content-Type","application/json");var o={method:"POST"};return o.body=r,o.headers=i,t.request(e,n,o)})},t.postForm=function(e,n,r){return o.getHeaders().then(function(i){i.append("Content-Type","application/x-www-form-urlencoded");var o={method:"POST"};return o.headers=i,o.credentials="include",r&&(o.body=r),t.request(e,n,o)})},t.get=function(e,n){return o.getHeaders().then(function(r){r.append("Content-Type","application/json");var i={method:"GET"};return i.headers=r,t.request(e,n,i)})},t.parseJson=function(e){return e.json().then(function(t){return e.ok?Promise.resolve(t):Promise.reject(t)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(251),o=n(3),s=function(){function e(){this.services={},this.threshold=10}return e.prototype.register=function(e,t,n,r,o){if(!this.services[e]){r&&r.status;this.services[e]=new i.default(e,t,n,r.status,o)}r&&r.ok?(this.services[e].successCount++,this.services[e].ttsSuccess+=n):this.services[e].ttsFailure+=n,this.services[e].totalCount++,this.services[e].totalCount>=this.threshold&&this.publishEvent(e)},e.prototype.flushAll=function(){for(var e in this.services)this.publishEvent(e)},e.prototype.publishEvent=function(e){var t=this.services[e];t.successCount>0&&(t.ttsSuccess=t.ttsSuccess/t.successCount),t.ttsFailure>0&&(t.ttsFailure=t.ttsFailure/(t.totalCount-t.successCount)),o.default.telemetryManager.sendEvent(t),delete this.services[e]},e}();t.default=function(){return r||(r=new s),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addGetParamsToUrl=function(e,t){var n=[],r=function(e){if(void 0!==t[e]){var r=encodeURIComponent(e);if(Array.isArray(t[e]))t[e].forEach(function(e){var t=encodeURIComponent(e);n.push(r+"="+t)});else{var i=encodeURIComponent(t[e].toString());n.push(r+"="+i)}}};for(var i in t)r(i);return e+"?"+n.join("&")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(6),o=n(23),s=n(13),a=n(70),c=n(32),u=n(3),l=n(138),p=n(53),d=function(){l.getPolling().authorization.then(function(){f()?t.activationRequest().then(function(e){t.stopActivation(),e&&e.ok&&(r=setTimeout(d,12e3))},function(){t.stopActivation()}):t.stopActivation()})};function f(){return u.default.signInManager.userIdentityType===c.IdentityType.SKYPE&&u.default.signInManager.state===o.SigninState.SignedIn&&a.get().isOnline&&i.default.get.backend!==s.MessagingBackend.TEAMS}t.activationRequest=function(){var e=u.default.storage.getItem("skype|epid"),t="users/ME/endpoints/"+e+"/active",n={body:JSON.stringify({timeout:15})};return!e&&f()?Promise.reject({}):p.post("active",t,n)},t.startActivation=function(){r||f()&&d()},t.stopActivation=function(){r&&(clearTimeout(r),r=null)},a.get().subscribe("isOnline",function(e){e||t.stopActivation()})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Chat="chat",e.Space="space",e.Topic="topic",e.SfbInterop="sfbinterop"}(t.ThreadType||(t.ThreadType={})),function(e){e.Text="Text",e.RichText="RichText",e.RichTextUriObject="RichText/UriObject",e.RichTextMedia_GenericFile="RichText/Media_GenericFile",e.ControlClearTyping="Control/ClearTyping",e.ControlTyping="Control/Typing",e.ControlLiveState="Control/LiveState",e.SystemMessage="SystemMessage",e.InviteFreeRelationshipChangedInitialized="InviteFreeRelationshipChanged/Initialized",e.SignalFlamingo="Signal/Flamingo",e.RichTextHtml="RichText/Html"}(t.MessagePayloadType||(t.MessagePayloadType={})),function(e){e.Audio="Audio",e.Video="Video"}(t.PresenceCapabilities||(t.PresenceCapabilities={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HOST_URL="https://directline.botframework.com/api/",t.V3_HOST_URL="https://directline.botframework.com/v3/directline/",t.V3_BING_HOST_URL="https://bing.botframework.com/v3/directline/",t.POLLING_INTERVAL=1500,t.CONTINUOUS_POLLING_INTERVAL=5e3,t.MAX_RETRY_ATTEMPTS=5,t.MAX_POLLING_RETRIES=10},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(79);var r=n(11),i=n(10),o=function(){function e(){}return e.prototype.set=function(e){this._throwIfFalsy(e),this._resourcesLocation=e},e.prototype.merge=function(e){this._throwIfFalsy(e),Object.assign(this._resourcesLocation,e)},e.prototype.get=function(){return this._resourcesLocation},e.prototype._throwIfFalsy=function(e){e||r.default.throwError(i.ErrorCodes.ERR_DESTINATION_NOT_REACHABLE,"[i18n / resources] Specified destination for localizations resources is not reachable")},e}();t.default=new o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maxLength=16,t.minLength=2,t.firstLetters="8:(B;|I]>+xX<*\\",t.firstLettersMap={8:"8",":":":","(":"(",B:"B",";":";","|":"|",I:"I","]":"]",">":">","+":"+",x:"x",X:"X","<":"<","*":"*","\\":"\\"},t.clearShortcutMap=function(){t.shortcutIdMap={}},t.idEmoticonMap={},t.shortcutIdMap={":)":"smile",":-)":"smile",":=)":"smile","(smile)":"smile",":(":"sad",":-(":"sad",":=(":"sad","(sad)":"sad",":<":"sad",":-<":"sad",":D":"laugh",":-D":"laugh",":=D":"laugh",":d":"laugh",":-d":"laugh",":=d":"laugh","(laugh)":"laugh",":>":"laugh",":->":"laugh","(lol)":"laugh","(LOL)":"laugh","(cool)":"cool","8-)":"cool","8=)":"cool","B-)":"cool","B=)":"cool",":O":"surprised",":-O":"surprised",":=O":"surprised",":o":"surprised",":-o":"surprised",":=o":"surprised","(surprised)":"surprised",";)":"wink",";-)":"wink",";=)":"wink","(wink)":"wink",";(":"cry",";-(":"cry",";=(":"cry","(cry)":"cry",":'(":"cry","(:|":"sweat","(sweat)":"sweat",":|":"speechless",":-|":"speechless",":=|":"speechless","(speechless)":"speechless","(kiss)":"kiss",":*":"kiss",":-*":"kiss",":=*":"kiss","(xo)":"kiss","(K)":"kiss","(k)":"kiss",":P":"tongueout",":-P":"tongueout",":=P":"tongueout",":p":"tongueout",":-p":"tongueout",":=p":"tongueout","(tongueout)":"tongueout",":$":"blush",":-$":"blush",":=$":"blush",':">':"blush","(blush)":"blush",":^)":"wonder","(wonder)":"wonder","|-)":"sleepy","I-)":"sleepy","I=)":"sleepy","(snooze)":"sleepy","|-(":"dull","|(":"dull","|=(":"dull","(dull)":"dull","(inlove)":"inlove","(love)":"inlove",":]":"inlove",":-]":"inlove","]:)":"eg",">:)":"eg","(grin)":"eg","(yn)":"fingerscrossed","(fingers)":"fingerscrossed","(fingerscrossed)":"fingerscrossed","(crossedfingers)":"fingerscrossed","(yawn)":"yawn","(puke)":"puke",":&":"puke",":-&":"puke",":=&":"puke","+o(":"puke","(doh)":"doh","(angry)":"angry",":@":"angry",":-@":"angry",":=@":"angry","x(":"angry","x-(":"angry","X(":"angry","X-(":"angry","x=(":"angry","X=(":"angry",";@":"angry",";-@":"angry","(wasntme)":"wasntme","(wm)":"wasntme","(party)":"party","<O)":"party","<o)":"party","<:o)":"party","(worry)":"worry",":S":"worry",":s":"worry",":-s":"worry",":-S":"worry",":=s":"worry",":=S":"worry","(mm)":"mmm","(mmm)":"mmm","(mmmm)":"mmm","(nerd)":"nerdy","8-|":"nerdy","B-|":"nerdy","8|":"nerdy","B|":"nerdy","8=|":"nerdy","B=|":"nerdy",":x":"lipssealed",":-x":"lipssealed",":X":"lipssealed",":-X":"lipssealed",":#":"lipssealed",":-#":"lipssealed",":=x":"lipssealed",":=X":"lipssealed",":=#":"lipssealed","(wave)":"hi","(hi)":"hi","(bye)":"hi","(BYE)":"hi","(Bye)":"hi","(Hi)":"hi","(HI)":"hi","(facepalm)":"facepalm","(fail)":"facepalm","(devil)":"devil","(6)":"devil","(angel)":"angel","(A)":"angel","(a)":"angel","(envy)":"envy","(V)":"envy","(v)":"envy","(wait)":"wait","(hug)":"hug","(bear)":"hug","(makeup)":"makeup","(kate)":"makeup","(chuckle)":"giggle","(giggle)":"giggle","(clap)":"clap","(think)":"think",":-?":"think",":?":"think",":=?":"think","*-)":"think","(bow)":"bow","(rofl)":"rofl","(rotfl)":"rofl","(whew)":"whew","(phew)":"whew","(happy)":"happy","(smirk)":"smirk","(nod)":"nod","(shake)":"shake","(waiting)":"waiting","(forever)":"waiting","(impatience)":"waiting","(emo)":"emo","(y)":"yes","(Y)":"yes","(ok)":"yes","(yes)":"yes","(OK)":"yes","(oK)":"yes","(Ok)":"yes","(n)":"no","(N)":"no","(no)":"no","(handshake)":"handshake","(highfive)":"highfive","(hifive)":"highfive","(h5)":"highfive","(heart)":"heart","(h)":"heart","(H)":"heart","(l)":"heart","(L)":"heart","<3":"heart","(lalala)":"lalala","(lalalala)":"lalala","(lala)":"lalala","(notlistening)":"lalala","(heidy)":"heidy","(squirrel)":"heidy","(F)":"flower","(f)":"flower","(flower)":"flower","(rain)":"rain","(london)":"rain","(st)":"rain","(ST)":"rain","(St)":"rain","(sun)":"sun","(#)":"sun","(tumbleweed)":"tumbleweed","(music)":"music","(8)":"music","(bandit)":"bandit","(tmi)":"tmi","(coffee)":"coffee","(c)":"coffee","(C)":"coffee","(pi)":"pizza","(pizza)":"pizza","(cash)":"cash","(mo)":"cash","($)":"cash","(flex)":"muscle","(muscle)":"muscle","(^)":"cake","(cake)":"cake","(beer)":"beer","(bricklayers)":"beer","(B)":"beer","(b)":"beer","(d)":"drink","(D)":"drink","(drink)":"drink","\\o/":"dance","\\:D/":"dance","\\:d/":"dance","(dance)":"dance","(ninja)":"ninja","(J)":"ninja","(j)":"ninja","(*)":"star","(star)":"star","(headbang)":"headbang","(banghead)":"headbang","(swear)":"swear","(drunk)":"drunk","(finger)":"finger","(poolparty)":"poolparty","(hrv)":"poolparty","(rock)":"rock","(smoking)":"smoke","(smoke)":"smoke","(ci)":"smoke","(bug)":"bug","(toivo)":"toivo","(wfh)":"wfh","(@h)":"wfh","(@H)":"wfh","(hollest)":"hollest","(zilmer)":"priidu","(e)":"mail","(m)":"mail","(mail)":"mail","(E)":"mail","(o)":"time","(O)":"time","(time)":"time","(clock)":"time","(0)":"time","(~)":"movie","(film)":"movie","(movie)":"movie","(mp)":"phone","(ph)":"phone","(phone)":"phone","(talk)":"talk","(call)":"call","(T)":"call","(t)":"call","(punch)":"punch","*|":"punch","*-|":"punch","(skype)":"skype","(ss)":"skype","(u)":"brokenheart","(U)":"brokenheart","(brokenheart)":"brokenheart","(mooning)":"mooning","(oliver)":"oliver","(bartlett)":"bertlett","(football)":"bertlett","(soccer)":"bertlett","(so)":"bertlett","(talktothehand)":"talktothehand","(idea)":"idea",":i":"idea",":I":"idea","*-:)":"idea","(sheep)":"sheep","(bah)":"sheep","(cat)":"cat",":3":"cat","(@)":"cat","(meow)":"cat","(bike)":"bike","(bicycle)":"bike","(sander)":"bike","(dog)":"dog",":o3":"dog","(&)":"dog"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),i=n(34),o={small:"getSmall",large:"getLarge",extraLarge:"getExtraLarge",superLarge:"getSuperLarge"};t.buildEmoticonUrl=function(e,n,s,a){var c=e+"/"+n.id+"/views/";c=t.rewriteUrls(c,i.default.pesCDNAuthentication.rewriteRules);var u=o[s]+(a?"Animated":"");return r.default.setQueryParameters(c+i.default.profiles.emoticons[u](),{etag:n.etag})},t.rewriteUrls=function(e,t){if("string"!=typeof e)return e;var n,r=e;for(n in t)if(-1!==n.search(n.from)){r=r.replace(n.from,n.to);break}return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(73),i=function(){function e(){}return e.getSentMessageType=function(t){switch(t){case r.MessageType.FILE:case r.MessageType.IMAGE:return e.File;case r.MessageType.SWIFT:return e.Card;default:return e.Text}},e.getReceivedMessageType=function(t){switch(t){case"":return e.File;case"":return e.Card;default:return e.Text}},e.Text="text",e.File="file",e.Card="card",e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(226);t.Duration=r.Duration;var i=n(227);t.getCallMessage=i.getCallMessage},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Online="Online",e.Busy="Busy",e.Offline="Offline",e.Undefined="Undefined",e.OnThePhone="OnThePhone",e.Away="Away",e.Idle="Idle",e.OutToLunch="OutToLunch",e.BeRightBack="BeRightBack"}(t.PresenceStatus||(t.PresenceStatus={}))},function(e,t){if("function"!=typeof window.CustomEvent){var n=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n};n.prototype=window.Event.prototype,window.CustomEvent=n}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=[{language:"ar",defaultLocale:"ar-sa"},{language:"bg",defaultLocale:"bg-bg"},{language:"ca",defaultLocale:"ca-es"},{language:"cs",defaultLocale:"cs-cz"},{language:"da",defaultLocale:"da-dk"},{language:"de",defaultLocale:"de-de"},{language:"el",defaultLocale:"el-gr"},{language:"en-ca",defaultLocale:"en-gb"},{language:"en-au",defaultLocale:"en-gb"},{language:"en-in",defaultLocale:"en-gb"},{language:"en-hk",defaultLocale:"en-gb"},{language:"en-ie",defaultLocale:"en-gb"},{language:"en-pk",defaultLocale:"en-gb"},{language:"en-sg",defaultLocale:"en-gb"},{language:"en-gb",defaultLocale:"en-gb"},{language:"en",defaultLocale:"en-us"},{language:"es-ar",defaultLocale:"es-mx"},{language:"es-uy",defaultLocale:"es-mx"},{language:"es-py",defaultLocale:"es-mx"},{language:"es-co",defaultLocale:"es-mx"},{language:"es-cl",defaultLocale:"es-mx"},{language:"es-pe",defaultLocale:"es-mx"},{language:"es-ec",defaultLocale:"es-mx"},{language:"es-ve",defaultLocale:"es-mx"},{language:"es-cr",defaultLocale:"es-mx"},{language:"es-do",defaultLocale:"es-mx"},{language:"es-pa",defaultLocale:"es-mx"},{language:"es-gt",defaultLocale:"es-mx"},{language:"es-bo",defaultLocale:"es-mx"},{language:"es-ev",defaultLocale:"es-mx"},{language:"es-hn",defaultLocale:"es-mx"},{language:"es-ni",defaultLocale:"es-mx"},{language:"es-pu",defaultLocale:"es-mx"},{language:"es-br",defaultLocale:"es-mx"},{language:"es-419",defaultLocale:"es-mx"},{language:"es-us",defaultLocale:"es-us"},{language:"gl",defaultLocale:"es-es"},{language:"eu",defaultLocale:"es-es"},{language:"es",defaultLocale:"es-es"},{language:"et",defaultLocale:"et-ee"},{language:"fi",defaultLocale:"fi-fi"},{language:"fr",defaultLocale:"fr-fr"},{language:"iw",defaultLocale:"he-il"},{language:"he",defaultLocale:"he-il"},{language:"hi",defaultLocale:"hi-in"},{language:"hr",defaultLocale:"hr-hr"},{language:"hu",defaultLocale:"hu-hu"},{language:"in",defaultLocale:"id-id"},{language:"id",defaultLocale:"id-id"},{language:"it",defaultLocale:"it-it"},{language:"ja",defaultLocale:"ja-jp"},{language:"ko",defaultLocale:"ko-kr"},{language:"lt",defaultLocale:"lt-lt"},{language:"lv",defaultLocale:"lv-lv"},{language:"ms",defaultLocale:"ms-my"},{language:"no",defaultLocale:"nb-no"},{language:"nb",defaultLocale:"nb-no"},{language:"nn",defaultLocale:"nb-no"},{language:"nl",defaultLocale:"nl-nl"},{language:"pl",defaultLocale:"pl-pl"},{language:"pt-pt",defaultLocale:"pt-pt"},{language:"pt-br",defaultLocale:"pt-br"},{language:"pt",defaultLocale:"pt-br"},{language:"ro",defaultLocale:"ro-ro"},{language:"ru",defaultLocale:"ru-ru"},{language:"sk",defaultLocale:"sk-sk"},{language:"sl",defaultLocale:"sl-si"},{language:"sr",defaultLocale:"sr-latn-rs"},{language:"sr-latn",defaultLocale:"sr-latn-rs"},{language:"sv",defaultLocale:"sv-se"},{language:"th",defaultLocale:"th-th"},{language:"tr",defaultLocale:"tr-tr"},{language:"uk",defaultLocale:"uk-ua"},{language:"vi",defaultLocale:"vi-vn"},{language:"zh",defaultLocale:"zh-cn"},{language:"zh-tw",defaultLocale:"zh-tw"},{language:"zh-hant",defaultLocale:"zh-tw"},{language:"zh-cht",defaultLocale:"zh-tw"},{language:"zh-hk",defaultLocale:"zh-tw"},{language:"zh-mo",defaultLocale:"zh-tw"}],i=[{locale:"am-et",pesLocale:"am"},{locale:"ar-sa",pesLocale:"ar"},{locale:"az-latn-az",pesLocale:"az"},{locale:"be-by",pesLocale:"be-BY"},{locale:"bg-bg",pesLocale:"bg"},{locale:"bn-bd",pesLocale:"bn"},{locale:"bn-in",pesLocale:"bn"},{locale:"bs-latn-ba",pesLocale:"bs-Latn-BA"},{locale:"ca-es",pesLocale:"ca"},{locale:"ca-es-valencia",pesLocale:"ca"},{locale:"cs-cz",pesLocale:"cs"},{locale:"cy-gb",pesLocale:"cy-GB"},{locale:"da-dk",pesLocale:"da"},{locale:"de-de",pesLocale:"de"},{locale:"el-gr",pesLocale:"el"},{locale:"en-gb",pesLocale:"en"},{locale:"en-us",pesLocale:"en"},{locale:"es-es",pesLocale:"es"},{locale:"et-ee",pesLocale:"et"},{locale:"eu-es",pesLocale:"eu"},{locale:"fa-ir",pesLocale:"fa"},{locale:"fi-fl",pesLocale:"fi"},{locale:"fil-ph",pesLocale:"fil_PH"},{locale:"fr-fr",pesLocale:"fr"},{locale:"gd-gb",pesLocale:"gd-GB"},{locale:"gl-es",pesLocale:"gl"},{locale:"gu-in",pesLocale:"gu-IN"},{locale:"he-il",pesLocale:"he"},{locale:"hi-in",pesLocale:"hi"},{locale:"hr-hr",pesLocale:"hr"},{locale:"hu-hu",pesLocale:"hu"},{locale:"id-id",pesLocale:"id"},{locale:"is-is",pesLocale:"is"},{locale:"it-it",pesLocale:"it"},{locale:"ja-jp",pesLocale:"ja"},{locale:"ka-ge",pesLocale:"ka-GE"},{locale:"kk-kz",pesLocale:"kk"},{locale:"kn-in",pesLocale:"kn"},{locale:"ko-kr",pesLocale:"ko"},{locale:"ku-arab-iq",pesLocale:"ku-Arab-IQ"},{locale:"lb-lu",pesLocale:"lb-LU"},{locale:"lt-lt",pesLocale:"lt"},{locale:"lv-lv",pesLocale:"lv"},{locale:"mk-mk",pesLocale:"mk"},{locale:"ml-in",pesLocale:"ml"},{locale:"mr-in",pesLocale:"mr-IN"},{locale:"ms-my",pesLocale:"ms"},{locale:"nb-no",pesLocale:"no"},{locale:"nl-nl",pesLocale:"nl"},{locale:"nn-no",pesLocale:"no"},{locale:"or-in",pesLocale:"or-IN"},{locale:"pl-pl",pesLocale:"pl"},{locale:"pt-pt",pesLocale:"pt-PT"},{locale:"pt-br",pesLocale:"pt-BR"},{locale:"ro-ro",pesLocale:"ro"},{locale:"ru-ru",pesLocale:"ru"},{locale:"sk-sk",pesLocale:"sk"},{locale:"sl-sl",pesLocale:"sl"},{locale:"sq-al",pesLocale:"sq"},{locale:"sr-cyrl-ba",pesLocale:"sr"},{locale:"sr-cyrl-rs",pesLocale:"sr"},{locale:"sr-latn-rs",pesLocale:"sr"},{locale:"sv-se",pesLocale:"sv"},{locale:"sw-ke",pesLocale:"sw"},{locale:"ta-in",pesLocale:"ta"},{locale:"te-in",pesLocale:"te"},{locale:"th-th",pesLocale:"th"},{locale:"tr-tr",pesLocale:"tr"},{locale:"uk-ua",pesLocale:"uk"},{locale:"ur-pk",pesLocale:"ur-PK"},{locale:"uz-latn-uz",pesLocale:"uz"},{locale:"vi-vn",pesLocale:"vi"},{locale:"zh-cn",pesLocale:"zh_Hans"},{locale:"zh-tw",pesLocale:"zh_Hant"}],o=function(){function e(){}return e.prototype.getLocale=function(e){var t=this.getMappingByLanguage(e);if(t)return t.defaultLocale;var n=e.lastIndexOf("-");return n>-1?this.getLocale(e.substring(0,n)):e},e.prototype.getPesLocale=function(e){var t,n;return e?(t=this.getPESMapping(e))&&t.pesLocale?t.pesLocale:(n=this.getLocale(e))!==e&&(t=this.getPESMapping(n))?t.pesLocale:"default":"default"},e.prototype.getPESMapping=function(e){for(var t=0;t<i.length;t++)if(i[t].locale.toLowerCase()===e.toLowerCase())return i[t];return null},e.prototype.getMappingByLanguage=function(e){for(var t=0;t<r.length;t++)if(r[t].language.toLowerCase()===e.toLowerCase())return r[t];return null},e}();t.default=new o},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),s=n(9),a=n(1),c=n(82),u=/^\w$/,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.hasLargeEmoticon=function(e){return/<span(\sxmlns=".*")? class="emoticon\s?\w*\s?(animated)?\s+\w*large"><canvas(\s?(data-[-a-z]*|height|width|id|textcontent)=".*")*?>.*<\/canvas><\/span>/i.test(e)},t.prototype.fixInvalidHtml=function(e){return e.replace(/<canvas((?:\s?(?:data-[-a-z]*|height|width)="[a-z0-9]*")*)\s*\/>/g,"<canvas$1></canvas>")},t.prototype.createHtmlElement=function(e,t,n,r,i,a){var u={large:r,largeEmoticonClass:a,textContent:n,emoticonId:t,isAnimated:!i},l=s.createElement(c.SwcEmoticon,u),p=document.createDocumentFragment();return o.render(l,p),p},t.prototype.isElementAllowed=function(e){return"span"!==e.nodeName.toLowerCase()||-1===e.className.toLowerCase().indexOf("emoticon")},t.prototype.wordRawToXml=function(e,t){var n=[],r=0,i=a.default.instance.PesManager.map;if(!a.default.instance.PesManager.canRenderConfigItems())return n;for(var o=0;o<t.length;o++){for(var s="",c=-1,u=o+1;u<t.length+1;u++){var l=t.substring(o,u),p=i.hasOwnProperty(l)&&i[l];p&&!this.isWordChar(t[u])&&(s=p,c=u)}s&&(r!==o&&n.push(e.createTextNode(t.substring(r,o))),r=c,n.push(this.createXmlElement(e,s,t.substring(o,c))),o=c-1)}return 0!==r&&r<t.length&&n.push(e.createTextNode(t.substring(r))),n},t.prototype.createXmlElement=function(e,t,n){var r=e.createElement("ss");return r.setAttribute("type",t),r.innerText=n,r},t.prototype.isWordChar=function(e){return u.test(e)},t}(n(37).WordDomTransformer);t.default=l},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),s=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.actionType=o.SwiftCardActionType.unknown,i.originalPayload=t,i.actionType=t.type,i.image=t.image||t.image_url||null,i}return i(t,e),t}(n(74).default);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(1),o=n(7),s=n(11),a=n(130),c=n(74),u=n(56),l=n(10),p=function(){return function(e,t,n,p){var d=this;this.url=ko.observable(),this.destinationSize={narrow:{},default:{},carouselDefault:{},carouselNarrow:{}},this.trustedDomains=[r.default.AMS_HOST_URL,r.default.CDN_SERVICE_HOST],this.shouldProcessThroughAMS=function(e){return d._conversation.isSkypeBackend()&&!d.isTrustedUrl(e)},this.processImage=function(e){d.shouldProcessThroughAMS(e)?d.processViaAMS(e).then(function(e){var t=e.url||e.thumbnail,n=e.thumbnail_meta?e.thumbnail_meta:null;n?(d.url(t),d.naturalSize({height:n.height,width:n.width})):d.loadImageSize(u.default.normalizeUrl(t,d._isDl))},function(e){}):d.loadImageSize(d._conversation.isSkypeBackend()?u.default.normalizeUrl(e,d._isDl):e)},this.hasProcessedUrl=function(){return!!d.url()},this.isTrustedUrl=function(e){var t=!1;return d.trustedDomains.forEach(function(n){t=e.indexOf(n)>-1}),t},this.processViaAMS=function(e){var t=r.default.URLP_SERVICE_URL+"/v1/url/info?url=",n=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),o=new RegExp(n,"g"),s=e.indexOf(t)>0?e.replace(o,""):e;return new Promise(function(e){return i.default.instance.AmsManager.getPictureThumbnail(t+encodeURIComponent(s)).then(e)})},this.loadImageSize=function(e){var t=new Image;t.onload=function(){d.url(e),d.naturalSize({height:t.naturalHeight,width:t.naturalWidth})},t.onerror=function(e){s.default.throwError(l.ErrorCodes.ERR_LOAD_IMG,"Unable to load an image, is dl="+d._isDl,e)},t.src=e},this.getUiSize=function(){var e=a.default.instance.CurrentStyle,t=d.getDestinationSize(d.contentType,e,d.isImageInCarousel()),n=d.naturalSize(),r={height:0,width:0};if(0===n.height||0===n.width||0===t.height)return r;var i=t.width/t.height,s=n.width/n.height;switch(d.contentType){case o.SwiftCardContentType.hero:s<i?(r.width=t.width,r.height=n.height*t.width/n.width,d.bottomAlignment((r.height-t.height)/2)):(r.height=t.height,r.width=n.width*t.height/n.height),d.leftAlignment(r.width/-2);break;case o.SwiftCardContentType.animation:case o.SwiftCardContentType.audio:s<i?(r.width=n.width*t.height/n.height,r.height=n.height*t.height/n.height):(r.height=t.height,r.width=n.width*t.height/n.height);break;case o.SwiftCardContentType.thumb:case o.SwiftCardContentType.actionImage:s<i?(r.height=t.height,r.width=r.height*s):s===i?(r.height=t.height,r.width=n.width*t.height/n.height):(r.width=t.width,r.height=r.width/s),d.bottomAlignment((r.height-t.height)/2),d.leftAlignment(r.width/-2);break;case o.SwiftCardContentType.receipt:s<i?(r.height=t.height,r.width=r.height*s):s===i?(r.height=t.height,r.width=n.width*t.height/n.height):(r.width=t.width,r.height=r.width/s,d.bottomAlignment((r.height-t.height)/2)),d.leftAlignment(r.width/-2);break;case o.SwiftCardContentType.flex:s<=i?(1===s?(r.height=t.height,r.width=t.height):(r.width=n.width*t.height/n.height,r.height=t.height),d.leftAlignment((r.width-t.width)/-2)):(r.height=t.height,r.width=n.width*t.height/n.height,d.leftAlignment((r.width-t.width)/-2))}return r},this.getTitleByType=function(){switch(d.tap.type){case o.SwiftCardActionType.call:case o.SwiftCardActionType.imBack:return d.createImageTitle();case o.SwiftCardActionType.openUrl:return d.createImageTitle()+"\n\n"+d.tap.value;case o.SwiftCardActionType.showImage:return(d.alt?d.alt+" ":"")+d.lowerFirstLetter(d.tap.title)}return""},this.createImageTitle=function(){var e=d.tap.title||"",t=i.default.instance.i18n.fetch("accessibility_swift_action_prefix",{swiftAction:d.lowerFirstLetter(e)});return(d.alt?d.alt+" ":"")+t},this.lowerFirstLetter=function(e){return e?e[0].toLowerCase()+e.substring(1):""},this.getDestinationSize=function(e,t,n){return(t===a.StyleModes.NORMAL?n?d.destinationSize.carouselDefault:d.destinationSize.default:n?d.destinationSize.carouselNarrow:d.destinationSize.narrow)[e]},this._conversation=t,this._isDl=this._conversation.isDirectLineBackend(),this.destinationSize.narrow[o.SwiftCardContentType.hero]={height:105,width:188},this.destinationSize.default[o.SwiftCardContentType.hero]={height:153,width:272},this.destinationSize.carouselDefault[o.SwiftCardContentType.hero]={height:145,width:270},this.destinationSize.carouselNarrow[o.SwiftCardContentType.hero]={height:105,width:188},this.destinationSize.narrow[o.SwiftCardContentType.thumb]={height:76,width:76},this.destinationSize.default[o.SwiftCardContentType.thumb]={height:112,width:112},this.destinationSize.carouselDefault[o.SwiftCardContentType.thumb]={height:112,width:112},this.destinationSize.carouselNarrow[o.SwiftCardContentType.thumb]={height:76,width:76},this.destinationSize.narrow[o.SwiftCardContentType.receipt]={height:76,width:76},this.destinationSize.default[o.SwiftCardContentType.receipt]={height:112,width:112},this.destinationSize.narrow[o.SwiftCardContentType.animation]={height:105,width:172},this.destinationSize.default[o.SwiftCardContentType.animation]={height:153,width:256},this.destinationSize.carouselDefault[o.SwiftCardContentType.animation]={height:145,width:256},this.destinationSize.carouselNarrow[o.SwiftCardContentType.animation]={height:105,width:172},this.destinationSize.narrow[o.SwiftCardContentType.audio]={height:105,width:172},this.destinationSize.default[o.SwiftCardContentType.audio]={height:145,width:256},this.destinationSize.carouselDefault[o.SwiftCardContentType.audio]={height:145,width:256},this.destinationSize.carouselNarrow[o.SwiftCardContentType.audio]={height:105,width:172},this.destinationSize.default[o.SwiftCardContentType.actionImage]={height:20,width:20},this.destinationSize.narrow[o.SwiftCardContentType.actionImage]={height:16,width:16},this.destinationSize.narrow[o.SwiftCardContentType.flex]={height:105,width:188},this.destinationSize.default[o.SwiftCardContentType.flex]={height:153,width:272},this.destinationSize.carouselDefault[o.SwiftCardContentType.flex]={height:145,width:256},this.destinationSize.carouselNarrow[o.SwiftCardContentType.flex]={height:105,width:188},this.contentType=p,this.alt=u.default.normalizeRichText(e.alt,this._isDl),e.url&&this.processImage(e.url),this.tap=null,e.tap&&(this.tap=u.default.getItemIfNotDisabled(new c.default(e.tap,t,n)),this.tap&&this.tap.type===o.SwiftCardActionType.showImage&&!this.tap.value&&(this.tap.value=this.url())),this.naturalSize=ko.observable({height:0,width:0}),this.uiSize=ko.pureComputed(this.getUiSize.bind(this)),this.isValid=ko.pureComputed(this.hasProcessedUrl),this.bottomAlignment=ko.observable(),this.leftAlignment=ko.observable(),this.isImageInCarousel=ko.observable(!1)}}();t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(14),o=n(42),s=function(){function e(){}return e._processUsers=function(e,t){for(var n=r.default.instance.MePersonManager.mePerson,s=0;s<e.users.length;s++){var a=null,c=e.users[s],u=o.default.normalizePersonId(c.mri);c.person=n.id===u?n:r.default.instance.Persons.getPerson(c.mri,!0),c.value=c.value?i.default.getMessageSanitizedContent(c.value):"";for(var l=0;l<t.users.length;l++){var p=t.users[l];if(c.mri===p.mri){a=p;break}}a||t.users.push(c)}},e.parseMessageProperties=function(t,n){n.properties&&t.supportedAnnotations.forEach(function(r){var i=n.properties?n.properties[r]:[],o=t[r];if(i)for(var s=function(t){var n=null,r=i[t];r&&"reactionsConsumptionHorizon"!==r.key&&function(){for(var t=0;t<o.length;t++){var i=o[t];r.key===i.key&&(n=i)}n||(n={key:r.key,users:[]},o.pushObservable(n)),e._processUsers(r,n)}()},a=0;a<i.length;a++)s(a)})},e.updateMessageProperties=function(e,t){t&&e.supportedAnnotations.forEach(function(n){var r=e[n],i=t[n];r&&i&&(r.spliceObservable(0,r.length),i&&i.forEach(function(e){r.pushObservable(e)}))})},e}();t.default=s},,,,function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=e.call(this)||this;return t.addAgent=function(e){return t._botsService.addAgentToContacts(e)},t.getAgent=function(e){return t._agentsService.getAgentDetails(e)},t._agentsService=t.getServices().agentsService,t._botsService=t.getServices().botsService,t}return i(t,e),t}(n(21).default);t.SkypeAgentsManager=o,t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.addFormatting=function(t){return t=e.addFormattingTags(t,"s",/(\s|^|_|\*|i>|b>|s>)~((?!~\s).)*~(\s|$|_|\*|<)/gi,"~")},e.addFormattingTags=function(t,n,r,i){for(var o=t.match(r);o&&o.length>0&&2!=o[0].trim().length;)o.forEach(function(r){var o=r.trim(),s=(o=o.substring(o.indexOf(i),o.lastIndexOf(i)+1)).substr(1,o.length-2);s=e.createStartTag(n,i)+s+e.createEndTag(n),t=t.replace(o,s)}),o=t.match(r);return t},e.createStartTag=function(e,t){return"<"+e+' raw_pre="'+t+'" raw_post="'+t+'">'},e.createEndTag=function(e){return"</"+e+">"},e}();t.default=r},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.isElementAllowed=function(e){return"i"!==e.nodeName.toLowerCase()||-1===e.className.toLowerCase().indexOf("mention")},t.prototype.xmlNodeToHtml=function(e,t){if("at"===t.nodeName.toLowerCase()&&t.attributes.getNamedItem("id")){var n=e.createElement("i");return n.setAttribute("class","mention"),n.setAttribute("title",t.attributes.getNamedItem("id").value),n.textContent=t.textContent,[n]}return[]},t}(n(127).DomTransformerBase);t.MentionDomDecoder=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.transformRawToXml=function(e,t,n,r){var i=[];for(i.push(t);0!==i.length;){var o=i.pop();this.encodeTextNodeToXml(e,o,n,r)&&o.nodeType!==Node.TEXT_NODE&&this.isElementAllowed(o)&&this.pushChildNodes(i,o)}},e.prototype.encodeTextNodeToXml=function(e,t,n,r){var i=t.parentNode,o=this.xmlNodeToHtml(e,t,n,r);if(!o||!o.length)return!0;for(var s=0;s<o.length;s++)i.insertBefore(o[s],t);return i.removeChild(t),!1},e.prototype.pushChildNodes=function(e,t){for(var n=0;n<t.childNodes.length;n++)e.push(t.childNodes[n])},e}();t.DomTransformerBase=r},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.isElementAllowed=function(e){return"pre"!==e.nodeName.toLowerCase()},t.prototype.wordRawToXml=function(e,t){return[this.createXmlElement(e)]},t.prototype.getAllWords=function(e){for(var t,n=/\r?\n/g,r=new Array;null!==(t=n.exec(e));)r.push(t);return r},t.prototype.createXmlElement=function(e){return e.createElement("br")},t}(n(37).WordDomTransformer);t.NewLineDomTransformer=o},function(e,t,n){(function(t){(function(){"use strict";var t={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:d,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:d,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:d,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};function n(e){this.tokens=[],this.tokens.links={},this.options=e||h.defaults,this.rules=t.normal,this.options.gfm&&(this.options.tables?this.rules=t.tables:this.rules=t.gfm)}t.bullet=/(?:[*+-]|\d+\.)/,t.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,t.item=c(t.item,"gm")(/bull/g,t.bullet)(),t.list=c(t.list)(/bull/g,t.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+t.def.source+")")(),t.blockquote=c(t.blockquote)("def",t.def)(),t._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",t.html=c(t.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,t._tag)(),t.paragraph=c(t.paragraph)("hr",t.hr)("heading",t.heading)("lheading",t.lheading)("blockquote",t.blockquote)("tag","<"+t._tag)("def",t.def)(),t.normal=f({},t),t.gfm=f({},t.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),t.gfm.paragraph=c(t.paragraph)("(?!","(?!"+t.gfm.fences.source.replace("\\1","\\2")+"|"+t.list.source.replace("\\1","\\3")+"|")(),t.tables=f({},t.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),n.rules=t,n.lex=function(e,t){return new n(t).lex(e)},n.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},n.prototype.token=function(e,n,r){var i,o,s,a,c,u,l,p,d;for(e=e.replace(/^ +$/gm,"");e;)if((s=this.rules.newline.exec(e))&&(e=e.substring(s[0].length),s[0].length>1&&this.tokens.push({type:"space"})),s=this.rules.code.exec(e))e=e.substring(s[0].length),s=s[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?s:s.replace(/\n+$/,"")});else if(s=this.rules.fences.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"code",lang:s[2],text:s[3]||""});else if(s=this.rules.heading.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"heading",depth:s[1].length,text:s[2]});else if(n&&(s=this.rules.nptable.exec(e))){for(e=e.substring(s[0].length),u={type:"table",header:s[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:s[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:s[3].replace(/\n$/,"").split("\n")},p=0;p<u.align.length;p++)/^ *-+: *$/.test(u.align[p])?u.align[p]="right":/^ *:-+: *$/.test(u.align[p])?u.align[p]="center":/^ *:-+ *$/.test(u.align[p])?u.align[p]="left":u.align[p]=null;for(p=0;p<u.cells.length;p++)u.cells[p]=u.cells[p].split(/ *\| */);this.tokens.push(u)}else if(s=this.rules.lheading.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"heading",depth:"="===s[2]?1:2,text:s[1]});else if(s=this.rules.hr.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"hr"});else if(s=this.rules.blockquote.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"blockquote_start"}),s=s[0].replace(/^ *> ?/gm,""),this.token(s,n,!0),this.tokens.push({type:"blockquote_end"});else if(s=this.rules.list.exec(e)){for(e=e.substring(s[0].length),a=s[2],this.tokens.push({type:"list_start",ordered:a.length>1}),i=!1,d=(s=s[0].match(this.rules.item)).length,p=0;p<d;p++)l=(u=s[p]).length,~(u=u.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(l-=u.length,u=this.options.pedantic?u.replace(/^ {1,4}/gm,""):u.replace(new RegExp("^ {1,"+l+"}","gm"),"")),this.options.smartLists&&p!==d-1&&(a===(c=t.bullet.exec(s[p+1])[0])||a.length>1&&c.length>1||(e=s.slice(p+1).join("\n")+e,p=d-1)),o=i||/\n\n(?!\s*$)/.test(u),p!==d-1&&(i="\n"===u.charAt(u.length-1),o||(o=i)),this.tokens.push({type:o?"loose_item_start":"list_item_start"}),this.token(u,!1,r),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(s=this.rules.html.exec(e))e=e.substring(s[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===s[1]||"script"===s[1]||"style"===s[1]),text:s[0]});else if(!r&&n&&(s=this.rules.def.exec(e)))e=e.substring(s[0].length),this.tokens.links[s[1].toLowerCase()]={href:s[2],title:s[3]};else if(n&&(s=this.rules.table.exec(e))){for(e=e.substring(s[0].length),u={type:"table",header:s[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:s[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:s[3].replace(/(?: *\| *)?\n$/,"").split("\n")},p=0;p<u.align.length;p++)/^ *-+: *$/.test(u.align[p])?u.align[p]="right":/^ *:-+: *$/.test(u.align[p])?u.align[p]="center":/^ *:-+ *$/.test(u.align[p])?u.align[p]="left":u.align[p]=null;for(p=0;p<u.cells.length;p++)u.cells[p]=u.cells[p].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(u)}else if(n&&(s=this.rules.paragraph.exec(e)))e=e.substring(s[0].length),this.tokens.push({type:"paragraph",text:"\n"===s[1].charAt(s[1].length-1)?s[1].slice(0,-1):s[1]});else if(s=this.rules.text.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"text",text:s[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var r={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ <>]+(@|:\/)[^ <>]+)>/,url:d,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^<'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)([\s\S]*?[^`])\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:d,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};function i(e,t){if(this.options=t||h.defaults,this.links=e,this.rules=r.normal,this.renderer=this.options.renderer||new o,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=r.breaks:this.rules=r.gfm:this.options.pedantic&&(this.rules=r.pedantic)}function o(e){this.options=e||{}}function s(e){this.tokens=[],this.token=null,this.options=e||h.defaults,this.options.renderer=this.options.renderer||new o,this.renderer=this.options.renderer,this.renderer.options=this.options}function a(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function c(e,t){return e=e.source,t=t||"",function n(r,i){return r?(i=(i=i.source||i).replace(/(^|[^\[])\^/g,"$1"),e=e.replace(r,i),n):new RegExp(e,t)}}function u(e,t){return l[" "+e]||(/^[^:]+:\/*[^/]*$/.test(e)?l[" "+e]=e+"/":l[" "+e]=e.replace(/[^/]*$/,"")),e=l[" "+e],"//"===t.slice(0,2)?e.replace(/:[\s\S]*/,":")+t:"/"===t.charAt(0)?e.replace(/(:\/*[^/]*)[\s\S]*/,"$1")+t:e+t}r._inside=/(?:\[[^\]]*\]|\\[\[\]]|[^\[\]]|\](?=[^\[]*\]))*/,r._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,r.link=c(r.link)("inside",r._inside)("href",r._href)(),r.reflink=c(r.reflink)("inside",r._inside)(),r.normal=f({},r),r.pedantic=f({},r.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),r.gfm=f({},r.normal,{escape:c(r.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:c(r.text)("]|","~]|")("|","|https?://|")()}),r.breaks=f({},r.gfm,{br:c(r.br)("{2,}","*")(),text:c(r.gfm.text)("{2,}","*")()}),i.rules=r,i.output=function(e,t,n){return new i(t,n).output(e)},i.prototype.output=function(e){for(var t,n,r,i,o="";e;)if(i=this.rules.escape.exec(e))e=e.substring(i[0].length),o+=i[1];else if(i=this.rules.autolink.exec(e))e=e.substring(i[0].length),"@"===i[2]?(n=a(":"===i[1].charAt(6)?this.mangle(i[1].substring(7)):this.mangle(i[1])),r=this.mangle("mailto:")+n):r=n=a(i[1]),o+=this.renderer.link(r,null,n);else if(this.inLink||!(i=this.rules.url.exec(e))){if(i=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(i[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(i[0])&&(this.inLink=!1),e=e.substring(i[0].length),o+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):a(i[0]):i[0];else if(i=this.rules.link.exec(e))e=e.substring(i[0].length),this.inLink=!0,o+=this.outputLink(i,{href:i[2],title:i[3]}),this.inLink=!1;else if((i=this.rules.reflink.exec(e))||(i=this.rules.nolink.exec(e))){if(e=e.substring(i[0].length),t=(i[2]||i[1]).replace(/\s+/g," "),!(t=this.links[t.toLowerCase()])||!t.href){o+=i[0].charAt(0),e=i[0].substring(1)+e;continue}this.inLink=!0,o+=this.outputLink(i,t),this.inLink=!1}else if(i=this.rules.strong.exec(e))e=e.substring(i[0].length),o+=this.renderer.strong(this.output(i[2]||i[1]));else if(i=this.rules.em.exec(e))e=e.substring(i[0].length),o+=this.renderer.em(this.output(i[2]||i[1]));else if(i=this.rules.code.exec(e))e=e.substring(i[0].length),o+=this.renderer.codespan(a(i[2].trim(),!0));else if(i=this.rules.br.exec(e))e=e.substring(i[0].length),o+=this.renderer.br();else if(i=this.rules.del.exec(e))e=e.substring(i[0].length),o+=this.renderer.del(this.output(i[1]));else if(i=this.rules.text.exec(e))e=e.substring(i[0].length),o+=this.renderer.text(a(this.smartypants(i[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else e=e.substring(i[0].length),r=n=a(i[1]),o+=this.renderer.link(r,null,n);return o},i.prototype.outputLink=function(e,t){var n=a(t.href),r=t.title?a(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,r,this.output(e[1])):this.renderer.image(n,r,a(e[1]))},i.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,""):e},i.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,n="",r=e.length,i=0;i<r;i++)t=e.charCodeAt(i),Math.random()>.5&&(t="x"+t.toString(16)),n+="&#"+t+";";return n},o.prototype.code=function(e,t,n){if(this.options.highlight){var r=this.options.highlight(e,t);null!=r&&r!==e&&(n=!0,e=r)}return t?'<pre><code class="'+this.options.langPrefix+a(t,!0)+'">'+(n?e:a(e,!0))+"\n</code></pre>\n":"<pre><code>"+(n?e:a(e,!0))+"\n</code></pre>"},o.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},o.prototype.html=function(e){return e},o.prototype.heading=function(e,t,n){return"<h"+t+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},o.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},o.prototype.list=function(e,t){var n=t?"ol":"ul";return"<"+n+">\n"+e+"</"+n+">\n"},o.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},o.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},o.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},o.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},o.prototype.tablecell=function(e,t){var n=t.header?"th":"td";return(t.align?"<"+n+' style="text-align:'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"},o.prototype.strong=function(e){return"<strong>"+e+"</strong>"},o.prototype.em=function(e){return"<em>"+e+"</em>"},o.prototype.codespan=function(e){return"<code>"+e+"</code>"},o.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},o.prototype.del=function(e){return"<del>"+e+"</del>"},o.prototype.link=function(e,t,n){if(this.options.sanitize){try{var r=decodeURIComponent((i=e,i.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""}))).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return n}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:")||0===r.indexOf("data:"))return n}var i;this.options.baseUrl&&!p.test(e)&&(e=u(this.options.baseUrl,e));var o='<a href="'+e+'"';return t&&(o+=' title="'+t+'"'),o+=">"+n+"</a>"},o.prototype.image=function(e,t,n){this.options.baseUrl&&!p.test(e)&&(e=u(this.options.baseUrl,e));var r='<img src="'+e+'" alt="'+n+'"';return t&&(r+=' title="'+t+'"'),r+=this.options.xhtml?"/>":">"},o.prototype.text=function(e){return e},s.parse=function(e,t,n){return new s(t,n).parse(e)},s.prototype.parse=function(e){this.inline=new i(e.links,this.options,this.renderer),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},s.prototype.next=function(){return this.token=this.tokens.pop()},s.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},s.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},s.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,n,r,i="",o="";for(n="",e=0;e<this.token.header.length;e++)({header:!0,align:this.token.align[e]}),n+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(i+=this.renderer.tablerow(n),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],n="",r=0;r<t.length;r++)n+=this.renderer.tablecell(this.inline.output(t[r]),{header:!1,align:this.token.align[r]});o+=this.renderer.tablerow(n)}return this.renderer.table(i,o);case"blockquote_start":for(o="";"blockquote_end"!==this.next().type;)o+=this.tok();return this.renderer.blockquote(o);case"list_start":o="";for(var s=this.token.ordered;"list_end"!==this.next().type;)o+=this.tok();return this.renderer.list(o,s);case"list_item_start":for(o="";"list_item_end"!==this.next().type;)o+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(o);case"loose_item_start":for(o="";"list_item_end"!==this.next().type;)o+=this.tok();return this.renderer.listitem(o);case"html":var a=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(a);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}};var l={},p=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function d(){}function f(e){for(var t,n,r=1;r<arguments.length;r++)for(n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function h(e,t,r){if(r||"function"==typeof t){r||(r=t,t=null);var i,o,c=(t=f({},h.defaults,t||{})).highlight,u=0;try{i=n.lex(e,t)}catch(e){return r(e)}o=i.length;var l=function(e){if(e)return t.highlight=c,r(e);var n;try{n=s.parse(i,t)}catch(t){e=t}return t.highlight=c,e?r(e):r(null,n)};if(!c||c.length<3)return l();if(delete t.highlight,!o)return l();for(;u<i.length;u++)!function(e){"code"!==e.type?--o||l():c(e.text,e.lang,function(t,n){return t?l(t):null==n||n===e.text?--o||l():(e.text=n,e.escaped=!0,void(--o||l()))})}(i[u])}else try{return t&&(t=f({},h.defaults,t)),s.parse(n.lex(e,t),t)}catch(e){if(e.message+="\nPlease report this to https://github.com/chjj/marked.",(t||h.defaults).silent)return"<p>An error occurred:</p><pre>"+a(e.message+"",!0)+"</pre>";throw e}}d.exec=d,h.options=h.setOptions=function(e){return f(h.defaults,e),h},h.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new o,xhtml:!1,baseUrl:null},h.Parser=s,h.parser=s.parse,h.Renderer=o,h.Lexer=n,h.lexer=n.lex,h.InlineLexer=i,h.inlineLexer=i.output,h.parse=h,e.exports=h}).call(function(){return this||("undefined"!=typeof window?window:t)}())}).call(this,n(22))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(62),o=n(28),s=function(){function e(){var e=this;this.handlers=[],this.dispose=function(){o.default.getWindow().removeEventListener("resize",e.windowResizeHandler)},this.getCurrentStyle=function(){return(e.forcedWidth||o.default.getWindow().innerWidth)<356?r.NARROW:r.NORMAL},this.onResize=function(){e._currentStyle=e.getCurrentStyle();for(var t=0,n=e.handlers;t<n.length;t++){var r=n[t];try{r()}catch(e){}}};this.windowResizeHandler=i(this.onResize,500),o.default.getWindow().addEventListener("resize",this.windowResizeHandler)}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurrentStyle",{get:function(){return this._currentStyle},enumerable:!0,configurable:!0}),e.prototype.forceWidth=function(e){this.forcedWidth=e,this._currentStyle=this.getCurrentStyle()},e.prototype.addResizeHandler=function(e){-1==this.handlers.indexOf(e)&&this.handlers.push(e)},e.prototype.removeResizeHandler=function(e){var t=this.handlers.indexOf(e);-1!=t&&this.handlers.splice(t,1)},e}();t.default=s,function(e){e[e.NARROW=0]="NARROW",e[e.NORMAL=1]="NORMAL"}(r=t.StyleModes||(t.StyleModes={}))},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(6),o=n(2),s=n(8),a=n(30),c=n(98),u=n(5),l=function(){function e(){}return e.init=function(){r.swc.TelemetryService=r.swc.TelemetryService||new e},e.prototype.sendEvent=function(e){var t=this;if(e){this.logger||(this.logger=new c.default(o.default.ECS.ariaTenantId));var n=new window.ariaTelemetry.EventProperties;n.name=e.name,n.eventType=e.type,n.timestamp=e.timestamp;var r=e.getEventProperties();r.forEach(function(e){t.addProperty(n,e)}),this.addProperty(n,e.version),this.addProperty(n,e.identityType),this.addProperty(n,e.host),this.addProperty(n,e.lang),this.addProperty(n,e.isFirstPartyIntegration),this.addProperty(n,e.correlationId),this.addProperty(n,u.TelemetryPropertyValue.Create("sessionId",i.default.get.sessionId?i.default.get.sessionId:s.NA)),this.addProperty(n,u.TelemetryPropertyValue.Create("user",i.default.get.meId||s.NA,a.PIIType.Identity)),r.forEach(function(e){void 0!==e.value&&""!==e.value||(e.value=s.NA),void 0===e.type&&(e.type=a.PIIType.NotSet)}),this.logger.sendEvent(n)}},e.prototype.addProperty=function(e,t){e.setProperty(t.key,t.value+"",t.type)},e}();t.AriaTelemetryService=l},,function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),s=n(1),a=n(247),c=function(e){function t(){var t=e.call(this)||this;return t.downloadFile=function(e){return t.authenticate().then(function(){return t._amsService.downloadFile(e)})},t.authenticate=function(){return t._authenticated?Promise.resolve():(t._authenticated=!0,t._authenticate())},t.createImageMessage=function(e,t){var n=o.default.AMS_HOST_URL+"objects/"+t.id,r=o.default.AMS_HOST_URL+"objects/"+t.id+"/views/imgt1",i="https://login.skype.com/login/sso?go=webclient.xmm&amp;pic="+t.id,s=e.name,a='<URIObject type="Picture.1" ';return a+='uri="'+n+'" ',a+='url_thumbnail="'+r+'">',a+='To view this shared photo, go to: <a href="'+i+'">'+i+"</a>",a+='<OriginalName v="'+s+'"/><meta type="photo" originalName="'+s+'"/>',a+="</URIObject>"},t.createFileMessage=function(e,t){var n=o.default.AMS_HOST_URL+"objects/"+t.id,r=o.default.AMS_HOST_URL+"objects/"+t.id+"/views/thumbnail",i="https://login.skype.com/login/sso?go=webclient.xmm&amp;docid="+t.id,s=e.name,a='<URIObject type="File.1" ';return a+='uri="'+n+'" ',a+='url_thumbnail="'+r+'">',a+="<Title>Title: "+s+"</Title>",a+="<Description> Description: "+s+"</Description> ",a+='<a href="'+i+'">'+i+"</a>",a+='<OriginalName v="'+s+'"/>',a+='<FileSize v="'+e.size+'"/>',a+="</URIObject>"},t._authenticate=function(){new Headers;return t._amsService.authenticate()},t._amsService=t.getServices().amsService,t._authenticated=!1,t}return i(t,e),t.prototype.sendFile=function(e,t){var n=this;return this.authenticate().then(function(){return n._amsService.createNewDocument(e.id,t).then(function(r){var i=Date.now();return n._amsService.sendFile(r.id,t).then(function(o){var c=new a.default(e,t);return c.status=o.status,c.ttc=Date.now()-i,s.default.instance.TelemetryService.sendEvent(c),n._amsService.isDocumentTypeImage(t.type)?e.sendImage(n.createImageMessage(t,r)):e.sendFile(n.createFileMessage(t,r))})})})},t.prototype.downloadPictureThumbnail=function(e){var t=this;return this.authenticate().then(function(){return t._amsService.downloadPictureThumbnail(e)})},t.prototype.getPictureThumbnail=function(e){var t=this;return this.authenticate().then(function(){return t._amsService.getPictureThumbnail(e)})},t.prototype.downloadPicture=function(e){var t=this;return this.authenticate().then(function(){return t._amsService.downloadPicture(e)})},t.prototype.dispose=function(){this._authenticated=!1},t}(n(21).default);t.default=c},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(137),s=n(2),a=n(17),c=n(10),u=n(11),l=n(3),p=n(53),d=n(47),f={"8:echo123":!0},h=["Online","Busy","Away","Hidden"],g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.updateConsumptionHorizonToLastMessage=function(e){if(null!==e.lastMessage){var n=e.lastMessage,r=n.skypeeditedid||n.clientmessageid||n.id||"0",i=new Date(n.originalarrivaltime).getTime()+";"+(new Date).getTime()+";"+r;t.updateConsumptionHorizon(e.id,i).then(function(){e.setConsumptionHorizon(i),e.isUnread=!1})}},t.markAllConversationsAsRead=function(){var e=t.recents().getAllConversations();Object.keys(e).forEach(function(n){e[n].isUnread&&t.updateConsumptionHorizonToLastMessage(e[n])})},t.fetchMessagesByLink=function(e){return e=e.substring(e.indexOf("users/ME/conversations/")),o.getPolling().authorization.then(function(){return p.get("fetchMessagesByLink",e).then(function(e){return p.parseJson(e)})},console.warn)},t.sendDataToBot=function(e,t){var n="agents/"+e+"/invoke";return p.post("invoke",n,{body:JSON.stringify(t)}).then(function(e){return p.parseJson(e).then(void 0,console.warn).catch(function(e){})})},t.sendLocalSystemMessage=function(e,t,n){var r=new Date,i=d.getDomain()+"users/ME/conversations/"+e+"/messages/"+r.getTime(),s={id:r.getTime()+"",from:"",messagetype:"SystemMessage",originalarrivaltime:r.toISOString(),content:t};n&&(s.customType=n);var a={resource:s,resourceLink:i,resourceType:"NewMessage"};o.getPolling().sendLocalMessage(a)},t.getMyPresence=function(){return o.getPolling().authorization.then(function(){return p.get("getPresence","users/ME/presenceDocs/messagingService?view=expanded").then(function(e){return e.ok||e.json?e.json():null})})},t}return i(t,e),t.prototype.fetchRecentConversations=function(e,t){var n=this,r=this._fetchRecentsPromise?this._fetchRecentsPromise.status:void 0;if(r===a.PromiseStatus.Pending)return this._fetchRecentsPromise.promise;var i;return this._fetchRecentsPromise&&this._fetchRecentsPromise.status===a.PromiseStatus.Pending||(this._fetchRecentsPromise=new a.CancelablePromise),i=e,o.getPolling().authorization.then(function(){var e={pageSize:t,view:"supportsExtendedHistory|msnp24Equivalent"};i&&Object.assign(e,{startTime:i}),n.syncState?Object.assign(e,{syncState:n.syncState}):Object.assign(e,{targetType:"All|InviteFree|Agent"});var r=p.addGetParamsToUrl("users/ME/conversations",e);p.get("fetchRecents",r).then(function(e){e.ok?n._fetchRecentsPromise.isCanceled||p.parseJson(e).then(function(e){n.syncState=n.getSyncState(e._metadata.syncState),n.allConversations=n.allConversations.concat(e.conversations),n._fetchRecentsPromise.resolve({conversations:n.allConversations,hasMoreConversations:!!e._metadata.backwardLink})}).catch(function(t){u.default.throwError(c.ErrorCodes.ERR_PARSE_RESPONSE,"fetchRecentConversations::getConversationsPage unable to parse response",t),n._fetchRecentsPromise.cancel(e,n.allConversations)}):n._fetchRecentsPromise.cancel(e,n.allConversations)},function(e){n._fetchRecentsPromise.cancel(e,n.allConversations)})}),this._fetchRecentsPromise.promise},t.prototype.fetchMeProperties=function(){return o.getPolling().authorization.then(function(){return p.get("fetchMeProperties","users/ME/properties").then(function(e){return p.parseJson(e)})})},t.prototype.fetchMessages=function(e,t,n){void 0===t&&(t=20),void 0===n&&(n=0);var r={pageSize:t,view:"supportsExtendedHistory|msnp24Equivalent|supportsMessageProperties",startTime:n},i=p.addGetParamsToUrl("users/ME/conversations/"+e+"/messages",r);return o.getPolling().authorization.then(function(){return p.get("fetchMessages",i).then(function(e){return p.parseJson(e).then(function(e){return e})})})},t.prototype.fetchConversation=function(e){var t=p.addGetParamsToUrl("users/ME/conversations/"+e,{view:"msnp24Equivalent",targetType:"All"});return p.get("fetchConversation",t).then(function(e){return p.parseJson(e).catch(function(e){return e})})},t.prototype.deleteConversation=function(e){var t="users/ME/conversations/"+e+"/messages";return p.del("deleteConversation",t)},t.prototype.sendMessage=function(e,t){var n="users/ME/conversations/"+e+"/messages";return o.getPolling().authorization.then(function(){return p.post("sendMessage",n,{body:JSON.stringify(t)}).then(function(e){return p.parseJson(e)})})},t.prototype.editMessage=function(e,t,n,r){var i="users/ME/conversations/"+e+"/messages/"+t,o={messagetype:n,content:r};return p.put("edit",i,{body:JSON.stringify(o)})},t.prototype.deleteMessage=function(e,t){var n="users/ME/conversations/"+e+"/messages/"+t;return p.del("deleteMessage",n)},t.prototype.enableJoining=function(e,t){void 0===t&&(t=!0);var n=p.addGetParamsToUrl("threads/"+e+"/properties",{name:"joiningenabled"}),r={body:JSON.stringify({joiningenabled:t})};return p.put("enableJoining",n,r)},t.prototype.discloseHistory=function(e,t){void 0===t&&(t=!0);var n=p.addGetParamsToUrl("threads/"+e+"/properties",{name:"historydisclosed"}),r={body:JSON.stringify({historydisclosed:t})};return p.put("historyDisclosed",n,r)},t.prototype.fetchThread=function(e){var t=p.addGetParamsToUrl("threads/"+e,{view:"msnp24Equivalent"});return p.get("fetchThread",t).then(function(e){return p.parseJson(e)})},t.prototype.createThread=function(e){var t={headers:{"Content-Type":"application/json",Accept:"application/json, text/javascript"},body:JSON.stringify({members:e})};return p.post("thread","threads",t)},t.prototype.setConversationTopic=function(e,t){var n=p.addGetParamsToUrl("threads/"+e+"/properties",{name:"topic"});return o.getPolling().authorization.then(function(){return p.put("setTopic",n,{body:JSON.stringify({topic:t})})})},t.prototype.addParticipant=function(e,t,n){var r="threads/"+e+"/members/"+t,i=n?"Admin":"User";return o.getPolling().authorization.then(function(){return p.put("addParticipant",r,{body:JSON.stringify({role:i})})})},t.prototype.removeParticipant=function(e,t){var n="threads/"+e+"/members/"+t;return o.getPolling().authorization.then(function(){return p.del("removeParticipant",n,{body:""})})},t.prototype.acceptConversation=function(e){var t=p.addGetParamsToUrl("users/ME/conversations/"+e+"/properties",{name:"conversationstatus"});return p.put("acceptConversation",t,{body:JSON.stringify({conversationstatus:"Accepted"})})},t.prototype.blockConversation=function(e){var t=p.addGetParamsToUrl("users/ME/conversations/"+e+"/properties",{name:"conversationblocked"});return p.put("blockConversation",t,{body:JSON.stringify({conversationblocked:"true"})})},t.prototype.updateConsumptionHorizon=function(e,t){var n=p.addGetParamsToUrl("users/ME/conversations/"+e+"/properties",{name:"consumptionhorizon"});return p.put("consumptionHorizon",n,{body:JSON.stringify({consumptionhorizon:t})})},t.prototype.getUsersPresence=function(e){e.length>10&&e.splice(10);var t=p.addGetParamsToUrl("users/ME/contacts/ALL/presenceDocs/messagingService",{cMri:e});return o.getPolling().authorization.then(function(){return p.get("getUsersPresence",t).then(function(e){return e.json().then(function(e){return e.Responses})})})},t.prototype.setMessageProperty=function(e,t,n,r){var i=this.messageProperties(e,t,n),o={};return o[n]=JSON.stringify(r),p.put(s.default.CHAT_SERVICE_COMMANDS.SET_MESSAGE_PROPERTY,i,{body:JSON.stringify(o),headers:{"Content-Type":"application/json"}})},t.prototype.messageProperties=function(e,t,n){return"users/ME"+("/conversations"+("/"+e+"/messages")+("/"+t+"/properties"))+"?name="+n},t.prototype.removeMessageProperty=function(e,t,n,r){var i=this.messageProperties(e,t,n),o={};return o[n]=JSON.stringify(r),p.del(s.default.CHAT_SERVICE_COMMANDS.REMOVE_MESSAGE_PROPERTY,i,{body:JSON.stringify(o),headers:{"Content-Type":"application/json"}})},t.prototype.subscribeContactPresence=function(e){var t=this;return s.default.ECS.contactPresenceEnabled?(-1===e.indexOf("8:")&&(e="8:"+e),f[e]?Promise.resolve():o.getPolling().authorization.then(function(){return o.getPolling().subscribeContactPresence(e).then(function(){return t.getUsersPresence([e]).then(function(t){l.default.persons.handlePresenceData(e,t[0].Payload)})})})):Promise.resolve()},t.prototype.unsubscribeContactPresence=function(e){return o.getPolling().unsubscribeContactPresence(e)},t.prototype.setMyPresence=function(e){return h.some(function(t){return t===e})?o.getPolling().authorization.then(function(){return p.put("setPresence","users/ME/presenceDocs/messagingService",{body:JSON.stringify({status:e})})}):Promise.reject("Unsupported presence")},t.prototype.setEndpointPresence=function(){return o.getPolling().authorization.then(function(){return o.getPolling().setEndpointPresence()})},t}(o.ConversationWebApi);t.ConversationConsumerWebApi=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(138));var r=n(105);t.startEndpointActivation=r.startActivation,t.stopEndpointActivation=r.stopActivation;var i=n(140);t.recents=i.recents},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(6),o=n(13),s=n(3),a=n(105),c=n(139),u=n(264),l=n(140);t.PAGE_SIZE=100,t.SYNC_STATE_LINK_REGEX=/syncState=([^&]+)/,t.getPolling=function(){if(!r){var e=i.default.get.backend===o.MessagingBackend.TEAMS;r=e?new u.PollingTeams:new c.Polling}return r};var p=function(){function e(){this.resetCallbacks=[],this.allConversations=[],this.syncState="",this.updateConsumptionHorizonToLastMessage=function(e){}}return e.prototype.recents=function(){return l.recents()},e.prototype.subscribeConversation=function(e,n,r,i){var o=this;return t.getPolling().subscribeConversation(e,n,r).then(function(){return i?o.fetchConversation(e):Promise.reject("No fetch conversation properties")})},e.prototype.unsubscribeConversation=function(e){t.getPolling().unsubscribeConversation(e)},e.prototype.subscribeResource=function(e,n){return t.getPolling().subscribeResource(e,n)},e.prototype.unsubscribeResource=function(e){t.getPolling().unsubscribeResource(e)},e.prototype.startEndpointActivation=function(){a.startActivation()},e.prototype.stopEndpointActivation=function(){a.stopActivation()},e.prototype.addResetSubscriber=function(e){e&&this.resetCallbacks.push(e)},e.prototype.reset=function(){return this.allConversations=[],this.syncState="",this.resetCallbacks.forEach(function(e){e()}),s.default.telemetryManager.flushAll(),t.getPolling().reset().then(null,function(){})},e.prototype.getSyncState=function(e){if(!e||!t.SYNC_STATE_LINK_REGEX.test(e))return"";var n=e.match(t.SYNC_STATE_LINK_REGEX);return n?n[1]:""},e}();t.ConversationWebApi=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(62),i=n(4),o=n(244),s=n(2),a=n(17),c=n(10),u=n(66),l=n(0),p=n(11),d=n(261),f=n(262),h=n(263),g=n(54),m=n(7),_=n(3),y=n(105),v=n(53),b=n(47),P="supportsMessageProperties",T=5e3,w=3,E=1,S=2,C=2e3,k={get:function(e){if(e)try{var t=JSON.parse(sessionStorage.getItem(u.SessionStorageKeys.Endpoint)||"");if(t&&t.validUntil>Date.now()&&e===t.username)return t.value}catch(e){}return k.invalidate(),""},set:function(e,t){var n={username:e,value:t,validUntil:Date.now()+6e5};sessionStorage.setItem(u.SessionStorageKeys.Endpoint,JSON.stringify(n))},invalidate:function(){sessionStorage.removeItem(u.SessionStorageKeys.Endpoint)}},O=function(){function e(){var t=this;this._handledConversations={},this._handledResourceTypes={},this._isPolling=!1,this._followedContacts={},this.reset=function(){return y.stopActivation(),t._waitingForRetry=!1,t._handledConversations={},t._handledResourceTypes={},t._followedContacts={},t._stopPolling(),t._authPromise.promise.then(null,function(){}).catch(),t._authPromise.cancel(),k.invalidate(),t._removeEndpoint()},this.subscribeConversation=function(e,n,r){return t._handledConversations[e]?p.default.throwError(c.ErrorCodes.INFO_CONVERSATION_ALREADY_SUBSCRIBED,"Conversation is already subscribed",null,e):t._handledConversations[e]={eventHandler:n,backfillCallback:r},t._endpointCreationPromise&&!t._endpointCreationPromise.isCanceled||t._startPollingSequence(),t._endpointCreationPromise.promise},this.unsubscribeConversation=function(e){t._handledConversations[e]&&delete t._handledConversations[e]},this.subscribeContactPresence=function(e){return t._followedContacts[e]?Promise.resolve():(t._followedContacts[e]=!0,!t._endpointCreationPromise||t._endpointCreationPromise.isCanceled?t._startPollingSequence():t._subscriptionId&&t._updateSubscription(),t._endpointCreationPromise.promise)},this.unsubscribeContactPresence=function(e){t._followedContacts[e]&&(delete t._followedContacts[e],t._endpointCreationPromise.status===a.PromiseStatus.Resolved&&t._updateSubscription())},this.subscribeResource=function(e,n){return t._handledResourceTypes[e]&&p.default.throwError(c.ErrorCodes.ERR_RESOURCE_ALREADY_HANDLED,"Resource with that name was already handled",e),t._handledResourceTypes[e]=n,Promise.resolve()},this.unsubscribeResource=function(e){t._handledResourceTypes[e]&&delete t._handledResourceTypes[e]},this.sendLocalMessage=function(e){var n={eventMessages:[e]};t._handlePollData(n)},this._poll=function(e){t._isPolling||(t._pollingRetryInterval&&t._pollingRetryInterval.reset(),t._pollingRetryInterval=new g.FixedTimeout(t._poll.bind(t,e),T),t._isPolling=!0,t._waitingForRetry=!1,t._pollingPromise=new a.CancelablePromise(v.post("polling","users/ME/endpoints/SELF/subscriptions/"+e+"/poll",{body:JSON.stringify({})})),t._pollingPromise.promise.then(function(n){t._isPolling=!1,n.ok||404===n.status?(t._pollingFailedCount=0,n.json().then(function(n){t._pollingPromise.isCanceled||(t._handlePollData(n),729===n.errorCode?(k.invalidate(),t._startPollingSequence()):450===n.errorCode?(t._subscribeToEndpoint(),t.triggerBackfilling()):t._endpointCreationPromise&&t._endpointCreationPromise.status===a.PromiseStatus.Resolved&&t._poll(e))}).catch(function(n){t._poll(e)})):t.retryPollingIfNeeded(n,e)},function(e){t._isPolling=!1,t.retryPollingIfNeeded()}))},this._handlePollData=function(e){if(e&&e.eventMessages){e.eventMessages.forEach(function(e){!function(e){var n=e.resourceType,r=t._handledResourceTypes[n];r&&r(b.getConversationIdFromUrl(e.resourceLink),e.resource)}(e),"NewMessage"===e.resourceType||"MessageUpdate"===e.resourceType||"ConversationUpdate"===e.resourceType?function(e){var n=b.getConversationIdFromUrl(e.resourceLink),r=t._handledConversations[n],i=r&&r.eventHandler,o=e.resource,s=b.getConversationIdFromUrl(o.from),a=f.ThreadNotifications.instance;s&&!a.empty&&d.default.detectConversationType(s)===m.ConversationType.AGENT&&a.notify(d.default.getNormalizeId(s),n,o.content);i&&i(e.resourceType,o)}(e):"UserPresence"===e.resourceType&&function(e){var n=b.getConversationIdFromUrl(e.resourceLink);if(!n&&e.resource&&e.resource.selfLink&&(n=b.getConversationIdFromUrl(e.resource.selfLink)),n){var r=_.default.mePerson.mri===n;(t._followedContacts[n]||r)&&_.default.persons.handlePresenceData(n,e.resource)}}(e)})}},this.retryPollingIfNeeded=function(e,n){if(!t._pollingPromise.isCanceled){if(t._pollingFailedCount>=w)return t._startPollingSequence(),void t.triggerBackfilling();t._pollingFailedCount++,e&&"Timeout"===e.statusText?t._poll(n):(t._pollingRetryInterval.start(),t.triggerBackfilling())}},this.triggerBackfilling=function(){for(var e in t._handledConversations){if(t._handledConversations.hasOwnProperty(e))t._handledConversations[e].backfillCallback()}},this._startPollingSequence=function(e){if(t._endpointCreationPromise&&t._endpointCreationPromise.status===a.PromiseStatus.Pending)return t._endpointCreationPromise.promise;if(t._isPolling)return Promise.resolve();if(t._waitingForRetry&&!e)return Promise.resolve();t._endpointRetryInterval.reset(),h.stop(),t._pollingFailedCount=0,t._pollingRetryInterval&&t._pollingRetryInterval.reset(),t._pollingRemoved=!1,t._authPromise.status!==a.PromiseStatus.Pending&&(t._authPromise=new a.CancelablePromise);return t._endpointCreationPromise=new a.CancelablePromise(t._createEndpoint().then(function(e){h.reset(),e.json().then(function(e){if(!t._endpointCreationPromise.isCanceled){if(!(e.subscriptions&&e.subscriptions.length>0))return t._subscribeToEndpoint();t._poll(e.subscriptions[0].id)}})},function(){t._endpointCreationPromise.isCanceled||(t._endpointFailedCount++,t._waitingForRetry=!0,t._endpointFailedCount>=E?(h.execute(t._startPollingSequence.bind(t,!0)),t._endpointFailedCount>=S&&window.swc.API.triggerEvent(i.ApiEvents.ChatServiceUnavailable)):t._endpointRetryInterval.start())})),t._endpointCreationPromise.promise},this._storeEpid=function(t){var n=(t=t||"").match(/endpoints\/(%7B[\da-z\-]+%7D)/),r=n&&n[1]||e._epid;r&&(e._epid=r,_.default.storage.setItem("skype|epid",e._epid))},this._createEndpoint=function(){var e={endpointFeatures:"Agent,InviteFree"},n=function(e){t._storeEpid(e.headers.get("location"));var n=t._authPromise.resolve.bind(t._authPromise);return setTimeout(n,1),_.default.isActive()&&y.startActivation(),t._setEndpointProperty(P,!0),t.setEndpointPresence(),l.swc.API.triggerEvent(i.ApiEvents.EndpointRegistered),e},r=o.default.mePerson?o.default.mePerson.id:"",s=k.get(r);if(s){return v.put("endpointCreation",s,{body:JSON.stringify(e),headers:{"Content-Type":"application/json"}},!0).then(n).catch(function(e){return k.invalidate(),t._createEndpoint()})}return v.post("endpointCreation","users/ME/endpoints",{body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(function(e){var t=e.headers.get("location");return k.set(r,t),e}).then(n)},this._requestSubscription=function(){var e={channeltype:"httpLongPoll",interestedResources:t._getInterestedResources()};return v.post("endpointSubscription","users/ME/endpoints/SELF/subscriptions",{body:JSON.stringify(e)})},this.setEndpointPresence=function(){var t={id:"messagingService",privateInfo:{epname:"skype"},epname:"skype",publicInfo:{capabilities:"video|audio",nodeInfo:"",skypeNameVersion:"skype.com",type:1},version:s.default.getClientVersion(),selfLink:"uri",type:"EndpointPresenceDoc"};return v.put("setEndpointPresence","users/ME/endpoints/"+e._epid+"/presenceDocs/messagingService",{body:JSON.stringify(t)})},this.modifySubscription=function(){var e={interestedResources:t._getInterestedResources()};if(void 0===t._subscriptionId)return Promise.resolve();var n="users/ME/endpoints/SELF/subscriptions/"+t._subscriptionId+"?name=interestedResources",r=e.interestedResources.length;return v.put("endpointSubscription",n,{body:JSON.stringify(e)}).then(function(e){e&&!e.ok&&p.default.throwError(c.ErrorCodes.ERR_UPDATE_SUBSCRIPTION,"Unable to update subscription. Number of followed contacts: "+r,e)},function(e){p.default.throwError(c.ErrorCodes.ERR_UPDATE_SUBSCRIPTION,"Unable to update subscription. Number of followed contacts: "+r,e)})},e._epid=_.default.storage.getItem("skype|epid"),this._authPromise=new a.CancelablePromise,this._endpointRetryInterval=new g.FixedTimeout(this._startPollingSequence.bind(this,!0),T),this._pollingFailedCount=0,this._endpointFailedCount=0,this._updateSubscription=r(this.modifySubscription.bind(this),C,{leading:!0}),f.ThreadNotifications.init()}return Object.defineProperty(e.prototype,"authorization",{get:function(){return this._startPollingSequence(),this._authPromise.promise},enumerable:!0,configurable:!0}),e.prototype._setEndpointProperty=function(e,t){var n={};return n[e]=t,v.put("endpointProperties","users/ME/endpoints/SELF/properties?name="+P,{body:JSON.stringify(n),headers:{"Content-Type":"application/json"}})},e.prototype._getInterestedResources=function(){var e=["/v1/users/ME/conversations/ALL/messages","/v1/users/ME/conversations/ALL/properties"];return Object.getOwnPropertyNames(this._followedContacts).forEach(function(t){e.push("/v1/users/ME/contacts/"+t)}),e},e.prototype._subscribeToEndpoint=function(){var e=this;return this._requestSubscription().then(function(t){if(!e._endpointCreationPromise.isCanceled){var n=(t.headers.get("location")||"").match(/\/(\d+)$/);n?(e._subscriptionId=n[1],e._poll(n[1])):e._startPollingSequence()}},function(t){if(!t||!t.json)return e._waitingForRetry=!0,void e._endpointRetryInterval.start();t.json().then(function(t){!t||729!==t.errorCode&&201!==t.errorCode||(729===t.errorCode&&k.invalidate(),e._startPollingSequence())},function(){})})},e.prototype._removeEndpoint=function(){if(this._pollingRemoved)return Promise.resolve();function t(){v.reset(),e._epid=null}return this._pollingRemoved=!0,e._epid||(e._epid=_.default.storage.getItem("skype|epid")),e._epid?v.del("deleteEndpoint","users/ME/endpoints/"+e._epid).then(t,t):(v.reset(),Promise.resolve())},e.prototype._stopPolling=function(){this._endpointRetryInterval.reset(),this._pollingRetryInterval&&this._pollingRetryInterval.reset(),this._pollingFailedCount=0,this._endpointFailedCount=0,this._endpointCreationPromise&&this._endpointCreationPromise.cancel(),this._pollingPromise&&(this._pollingPromise.cancel(),this._isPolling=!1)},e}();t.Polling=O},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(6),o=n(17),s=n(40),a=n(13),c=n(0),u=n(42),l=n(3),p=n(3),d=n(275),f=100,h=15,g=3,m=2592e6,_=function(){function e(){var e=this;this.allConversationsMap={},this.viewPort=[],this.unseen=[],this.unreadConversationsCountPromise=new o.CancelablePromise,this.unreadConversationsPromise=new o.CancelablePromise,this.unreadConversations=new s.ObservableCollection,this.boundNewMessageUpdate=this.newMessageHandler.bind(this),this.boundConversationUpdate=this.conversationUpdateHandler.bind(this),this._lastRequestedRecentsNumber=0,this._failedFetchCount=0,this._pageNumber=0,this.getConversations=function(t){if(e._lastRequestedRecentsNumber=e._lastRequestedRecentsNumber>t?e._lastRequestedRecentsNumber:t,e.fetchPagePromise&&e.fetchPagePromise.status===o.PromiseStatus.Pending)return e.fetchPagePromise.promise;if(e.fetchPagePromise&&t<=e.unseen.length){var n={conversations:e.moveToRead(t),hasMoreConversations:!!e.unseen.length};return Promise.resolve(n)}if(e.fetchPagePromise)return e._lastRequestedRecentsNumber=t,e.syncRecents.status===o.PromiseStatus.Pending?(e.fetchPagePromise=new o.CancelablePromise,e.fetchPagePromise.promise):Promise.resolve({conversations:e.moveToRead(t),hasMoreConversations:!1});var r=function(t){if(function(t,n){if(e.fetchPagePromise&&(e.processRecentConversations(t),e.fetchPagePromise.status===o.PromiseStatus.Pending)){if(n&&e.unseen.length<e._lastRequestedRecentsNumber)return;var r={conversations:e.moveToRead(e._lastRequestedRecentsNumber),hasMoreConversations:n};e.fetchPagePromise.resolve(r)}}(t.conversations,t.hasMoreConversations),e.fetchPagePromise)return t.hasMoreConversations?void setTimeout(function(){p.default.webApi.fetchRecentConversations(0,f).then(r,i)},e.getTimeoutInterval(e._pageNumber++)):(e.syncRecents.resolve(t),void e.resolveUnreadConversationsCount())},i=function(t){e.fetchPagePromise&&(e._failedFetchCount++,e.fetchPagePromise.status===o.PromiseStatus.Pending&&e.fetchPagePromise.cancel(t),e._failedFetchCount>=g?(e._failedFetchCount=0,e.syncRecents.cancel()):p.default.webApi.fetchRecentConversations(0,f).then(r,i))};e._lastRequestedRecentsNumber=t;p.default.webApi.fetchRecentConversations(0,h).then(r,i);return e.fetchPagePromise=new o.CancelablePromise,e.syncRecents=new o.CancelablePromise,e.unreadConversationsCountPromise.status!==o.PromiseStatus.Pending&&(e.unreadConversationsCountPromise=new o.CancelablePromise,e._pageNumber=0),e.fetchPagePromise.promise},this.isCurrentIdentity=function(e){return u.default.normalizePersonId(e)===p.default.signInManager.currentUserName},this.isLeftGroupConversation=function(t){var n=!1,r=!1;if(t.threadProperties&&t.threadProperties.members)try{JSON.parse(t.threadProperties.members).forEach(function(t){"string"==typeof t&&e.isCurrentIdentity(t)&&(r=!0),t&&t.MemberMri&&e.isCurrentIdentity(t.MemberMri)&&(r=!0)}),n=!r}catch(e){}return n},this._isLastMsgOlderThenMonth=function(e){return Date.now()-m>new Date(e.originalarrivaltime).getTime()},this._shouldRegisterAsUnread=function(t){return t.isUnread&&!t.alertsOff&&!e._isLastMsgOlderThenMonth(t.lastMessage)},this.unreadConversationsPromise.promise.then(function(){l.default.notificationsManager.registerUnreadConversationsSummary(e.unreadConversations)},function(e){}),p.default.webApi.addResetSubscriber(this.reset.bind(this))}return e.prototype.getAllConversations=function(){return this.allConversationsMap},e.prototype.getTimeoutInterval=function(e){return e<1?1:(this.resolveUnreadConversationsCount(),1e3)},e.prototype.moveToRead=function(e){e>this.unseen.length&&(e=this.unseen.length);var t=this.unseen.splice(0,e);return this.viewPort=this.viewPort.concat(t),t},e.prototype.moveToReadByIndex=function(e){var t=this.unseen.splice(e,1);return this.viewPort=this.viewPort.concat(t),t},e.prototype.addConversationToMap=function(e,t){if(void 0===t&&(t=!1),!e||!e.lastMessage.originalarrivaltime)return null;var n=new d.default(e);return n.isGroup&&this.isLeftGroupConversation(n)?null:(n.subscribe("isUnread",this.conversationUnreadHandler.bind(this,n)),this._shouldRegisterAsUnread(n)&&this.conversationUnreadHandler(n),this.allConversationsMap[e.id]=n,t?this.viewPort.length>0?this.viewPort.splice(0,0,n):this.unseen.splice(0,0,n):this.unseen=this.unseen.concat(n),n)},e.prototype.processRecentConversations=function(e){var t=this;e&&e.length&&(e.forEach(function(e){e.lastMessage&&(e.properties.conversationblocked&&"true"===e.properties.conversationblocked.toLocaleLowerCase()||t.allConversationsMap[e.id]||t.addConversationToMap(e))}),this.unseen.sort(function(e,t){return t.lastMessage.originalarrivaltime>e.lastMessage.originalarrivaltime?1:-1}))},e.prototype.resolveUnreadConversationsCount=function(){this.unreadConversationsCountPromise.status===o.PromiseStatus.Pending&&(this.unreadConversationsCountPromise.resolve(this.unreadConversations.length),this.unreadConversationsPromise.resolve(this.unreadConversations),c.swc.API.triggerEvent(r.ApiEvents.UnreadConversationsUpdate,this.unreadConversations.length))},e.prototype.conversationUnreadHandler=function(e){for(var t=-1,n=0;n<this.unreadConversations.length;n++){this.unreadConversations[n].id===e.id&&(t=n)}this._shouldRegisterAsUnread(e)&&-1===t?this.unreadConversations.pushObservable(e):!e.isUnread&&t>-1&&this.unreadConversations.spliceObservable(t,1),this.unreadConversationsCountPromise.status!==o.PromiseStatus.Pending&&c.swc.API.triggerEvent(r.ApiEvents.UnreadConversationsUpdate,this.unreadConversations.length)},e.prototype.getUnreadConversationsCount=function(){return this.unreadConversationsCountPromise.promise},e.prototype.getUnreadConversations=function(){return this.unreadConversationsPromise.promise},e.prototype.subscribeUpdates=function(e){return this.externalResourceCallback=e,p.default.isZombie=!this.externalResourceCallback,this.updatesSubscriptionPromise?this.updatesSubscriptionPromise:(p.default.webApi.subscribeResource("ConversationUpdate",this.boundConversationUpdate),this.updatesSubscriptionPromise=p.default.webApi.subscribeResource("NewMessage",this.boundNewMessageUpdate),this.updatesSubscriptionPromise)},e.prototype.unsubscribeUpdates=function(){return this.externalResourceCallback=null,p.default.webApi.unsubscribeResource("NewMessage")},e.prototype.newMessageHandler=function(e,t){if(!this.isIgnoredType(t.messagetype)&&(i.default.get.backend!==a.MessagingBackend.TEAMS||"chat"===t.threadtype)){var n=this.allConversationsMap[e];if(n){for(var r=-1,o=0;o<this.unseen.length;o++)if(this.unseen[o].id===n.id){r=o;break}r>-1&&this.viewPort.length>0?this.moveToReadByIndex(r):0===this.viewPort.length&&(this.unseen.splice(r,1),this.unseen.splice(0,0,n)),n.updateFromMessage(t)}else{var s={id:e,targetLink:new URL(t.conversationLink),properties:{consumptionhorizon:"",picture:"",lastimreceivedtime:""},version:parseInt(t.version,10),lastMessage:t};n=this.addConversationToMap(s,!0),p.default.webApi.fetchConversation(e).then(this.conversationPropertiesHandler.bind(this)),n.isGroup&&p.default.webApi.fetchThread(e).then(this.threadPropertiesHandler.bind(this))}this.externalResourceCallback&&this.externalResourceCallback(e,n)}},e.prototype.conversationPropertiesHandler=function(e){this.allConversationsMap[e.id].update(e)},e.prototype.threadPropertiesHandler=function(e){this.allConversationsMap[e.id].updateThread(e)},e.prototype.conversationUpdateHandler=function(e,t){var n=this.allConversationsMap[e];n&&n.update(t)},e.prototype.isIgnoredType=function(e){return"Control/ClearTyping"===e||"Control/Typing"===e},e.prototype.getConversation=function(e){return this.allConversationsMap[e]},e.prototype.reset=function(){this.fetchPagePromise&&this.fetchPagePromise.cancelQuitely(),this.fetchPagePromise=null,this.unreadConversationsCountPromise.cancelQuitely(),this.unreadConversationsPromise.cancelQuitely(),this.unseen.forEach(function(e){return e.dispose()}),this.unseen=[],this.viewPort.forEach(function(e){return e.dispose()}),this.viewPort=[],this.allConversationsMap={},this._lastRequestedRecentsNumber=0},e}();t.RecentsManager=_;var y=null;t.recents=function(){return y||(y=new _),y}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.lastReadMessageTimestamp=-1,this.modificationTime=-1,this.lastReadMessageId="",this.value="",e&&this.set(e)}return e.prototype.set=function(e){if(e){var t=e.split(";");this.lastReadMessageTimestamp=Number(t[0]),this.modificationTime=Number(t[1]),this.lastReadMessageId=t[2],this.value=e}},e}();t.ConsumptionHorizon=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(16),o=n(281),s={retryCount:3,timeout:12e4,policy:""},a=function(e,t,n,o){var a;return a=o?o+t:r.default.CONTACTS_HOST_URL+t,i.default("contacts-"+e,s,a,n)};t.get=function(e,t){return o.getHeaders().then(function(n){var r={method:"GET"};return r.headers=n,r.cache="no-cache",a(e,t,r).then(function(e){return e.json()})})},t.getRaw=function(e,t,n){return o.getHeaders().then(function(r){n&&Object.getOwnPropertyNames(n).forEach(function(e){r.append(e,n[e])});var i={method:"GET"};return i.headers=r,i.cache="no-cache",a(e,t,i)})},t.post=function(e,t,n,r){return o.getHeaders().then(function(i){i.append("Content-Type","application/json");var o={method:"POST"};return o.body=n,o.headers=i,a(e,t,o,r)})},t.put=function(e,t,n){return o.getHeaders().then(function(r){r.append("Content-Type","application/json");var i={method:"PUT"};return i.body=n,i.headers=r,a(e,t,i)})},t.deleteMethod=function(e,t){return o.getHeaders().then(function(n){var r={method:"DELETE"};return r.headers=n,a(e,t,r)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),i=n(10),o=n(11),s=n(3),a=function(){function e(){var e=this;this._rawContacts=[],this._rawContactIds={},this.fetchMyContacts=function(t,n){if(e._fetchContactsPromise)return e._fetchContactsPromise.promise;var a=s.default.webApi.fetchRecentConversations().then(function(t){var n=t;if(!n)return o.default.throwError(i.ErrorCodes.ERR_FETCH_CONTACTS_TEAMS,"Unable to fetch contacts"),{};if(!n.users)return{contacts:[],count:0,scope:"",duration:0};var r=s.default.mePerson;return n.users.forEach(function(t){if(t.mri===r.mri)return r.displayName=t.displayName,void(r.email=t.userPrincipalName);e._rawContacts.push({id:t.mri,person_id:t.mri,type:t.type,display_name:t.displayName,authorized:!0,blocked:!1,avatar_url:"",mood:"",name:{first:t.givenName,surname:t.surname,nickname:"",company:""},mri:t.mri,email:t.userPrincipalName,objectId:t.objectId}),e._rawContactIds[t.mri]=!0}),{contacts:e._rawContacts,count:n.users.length,scope:"",duration:0}},function(t){e._fetchContactsPromise=null,o.default.throwError(i.ErrorCodes.ERR_FETCH_CONTACTS_TEAMS,"Unable to fetch contacts",t)});return e._fetchContactsPromise=new r.CancelablePromise(a),e._fetchContactsPromise.promise},this.getContact=function(t,n){var r=e._rawContacts.filter(function(e){return e.mri.indexOf(n)>-1});return Promise.resolve(r.length?r[0]:void 0)},this.addContact=function(t,n,r){return r&&!e._rawContactIds[r.mri]&&e._rawContacts.push(r),Promise.resolve()},this.blockContact=function(e,t,n){return Promise.resolve()},this.unblockContact=function(e){return Promise.resolve()},this.dispose=function(){},this.getContactByObjectId=function(t){var n;return e._rawContacts.some(function(e){return t===e.objectId&&(n=e,!0)}),n?Promise.resolve(n):e.fetchContactById(t)}}return e.prototype.getContactByMri=function(e){var t=this._rawContacts.filter(function(t){return t.mri===e});return t.length?t[0]:void 0},Object.defineProperty(e.prototype,"contactsList",{get:function(){return this._rawContacts},enumerable:!0,configurable:!0}),e.prototype.getBlockedList=function(){return Promise.resolve([])},e.prototype.getContactByMriIfPresent=function(e){return""},e.prototype.fetchContactById=function(t){var n=this;return s.default.stratusService.fetchShortProfile([t]).then(function(t){return e.createContactFromShortProfile(t[0])}).then(function(e){return n.addContact(e.mri,"",e),e})},e.createContactFromShortProfile=function(e){return{id:e.mri,person_id:e.mri,type:e.type,display_name:e.displayName,authorized:!0,blocked:!1,avatar_url:"",mood:"",mri:e.mri,email:e.email,objectId:e.objectId}},e}();t.default=a},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(21),s=n(17),a=n(29),c=n(35),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.searchSkypeDirectory=function(e){return this._searchPromise&&this._searchPromise.status===s.PromiseStatus.Pending&&(this._searchPromise.cancel(),this._searchPromise=null),this._searchKey=e,this._searchPromise=new s.CancelablePromise(this.getServices().skypeGraphService.fetchProfiles(e)),this._searchPromise.promise},t.prototype.searchInContacts=function(e){var t=this,n=e?c.default.normalizeString(e.toLowerCase()):"",r=function(e){return e&&e.contacts?e.contacts.filter(function(e){var t=c.default.normalizeString(e.name).toLowerCase(),r=e.skypeid.toLowerCase();return t.indexOf(n)>-1||r.indexOf(n)>-1}):[]};return this.getServices().signInManager.onceSignedIn().then(function(){return t.getServices().contactsManager.fetchMyContacts().then(r,function(e){return[]})})},t.prototype.searchAgents=function(e){var t=this;return new Promise(function(n,r){return t.getServices().agentsService.searchAgents(e).then(function(e){if(e&&e.agentDescriptions){var t=e.agentDescriptions.map(function(e){return{skypeid:"28:"+e.agentId,name:e.displayName,avatar:e.userTileSmallUrl||e.userTileStaticUrl||"",type:a.ContactType.Agent}});n(t)}else n([])})})},t}(o.default);t.default=u},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),s=n(18),a=n(52),c=n(11),u=n(14),l=n(43),p=n(3),d=n(10),f="guest:",h=function(e){function t(t,n,r){void 0===n&&(n=!1),void 0===r&&(r=!0);var i=e.call(this)||this;i._id=t,i._displayName="",i._isAgent=!1,i._isGuest=!1,i._isPstn=!1,i._isBlocked=!1,i._avatarData="",i._email="",i._setAvatarDataIfValidUrl=function(e,t){a.default.loadAvatarUri(e,function(e){i.avatarData=e},t)},i.getPersonData=function(){if(i.displayName&&i.avatarData&&i._isFilled)return Promise.resolve();if(i._isFilled=!0,i.isAgent||i.isPstn)return Promise.resolve();if(i._ongoingStratusRequest)return i._ongoingStratusRequest;var e=function(e){c.default.throwError(d.ErrorCodes.ERR_RESOLVE_USER_DETAILS,"Unable to resolve user details",e)};if(i._isMePerson){i._ongoingStratusRequest=p.default.stratusService.fetchMeProperties().then(function(e){if(e){var t=e.firstname||"";t+=e.lastname?" "+e.lastname:"",i.displayName=t||i.displayName;var n=e.avatarUrl||e.avatarData;i._setAvatarDataIfValidUrl(n)}},e)}else{if(!i.shouldFetchProfile())return Promise.resolve();i._ongoingStratusRequest=p.default.stratusService.fetchPerson(i._id).then(function(e){var t=(e=e||[]).filter(function(e){return e.username===i._id||e.username===i._mri})[0];if(t){var n=t.displayname?t.displayname:"",r=t.username?t.username:"",o=n||r;o&&(i.displayName=o),i._id===i._mri&&(i._mri=(i.isAgent?"28:":"8:")+i._id),t.avatarUrl&&i._setAvatarDataIfValidUrl(t.avatarUrl,function(){}),t.avatarData&&(i.avatarData=t.avatarData)}else c.default.throwError(d.ErrorCodes.ERR_RESOLVE_USER_DETAILS,"Unable to resolve user details")},e)}return i._ongoingStratusRequest},i.getDataFromContactsService=function(){return i._ongoingContactsRequest?i._ongoingContactsRequest:i.isPstn?Promise.resolve():(i._ongoingContactsRequest=p.default.signInManager.getSkypeToken().then(function(){var e=p.default.signInManager.currentUserName;return e.indexOf("guest")>-1||i.isGuest||i._isMePerson?i._fetchDisplayNameAndAvatar():p.default.contactsService.getContact(e,i._mri).then(function(e){if(e){var t=e.avatar,n=e.display_name;return t||(t=e.profile?e.profile.avatar_url:""),n&&(i.displayName=n),t?i._setAvatarDataIfValidUrl(t):i._fetchDisplayNameAndAvatar(),i._ongoingContactsRequest=null,""}return i._ongoingContactsRequest=null,i._fetchDisplayNameAndAvatar()},function(){return i._ongoingContactsRequest=null,i._fetchDisplayNameAndAvatar()})},function(){return i._ongoingContactsRequest=null}),i._ongoingContactsRequest)},i._mri=i._id,i._mri.indexOf("https://");var o=l.default.normalizePersonId(i._id);return o!==i._id&&(i._id=o),i._isAgent=n||i._mri.indexOf("28:")>-1,i._isGuest=i._id.indexOf(f)>-1,i._isPstn=i._mri.indexOf("4:")>-1,p.default.contactsService.getBlockedList().then(function(e){if(e){var t=i._mri;i.isBlocked=e.filter(function(e){return e.mri===t}).length>0}}),i._description="",i._isMePerson=i._id===p.default.signInManager.currentUserName||l.default.normalizePersonId(i._id)===p.default.signInManager.currentUserName,r&&i.fetchDisplayNameAndAvatar(),i}return i(t,e),Object.defineProperty(t.prototype,"isAgent",{get:function(){return this._isAgent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPstn",{get:function(){return this._isPstn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBlocked",{get:function(){return this._isBlocked},set:function(e){e!==this._isBlocked&&(this._isBlocked=e,this.publish("isBlocked",this._isBlocked))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isGuest",{get:function(){return this._isGuest},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mri",{get:function(){return this._mri},set:function(e){this._mri=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayName",{get:function(){return this._displayName},set:function(e){e&&e!==this._displayName&&(this._displayName=u.default.parseTopic(e),this.publish("displayName",this._displayName))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){return this._description},set:function(e){e!==this._description&&(this._description=e,this.publish("description",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"avatarData",{get:function(){return this._avatarData},set:function(e){e!==this._avatarData&&(this._avatarData=e,this.publish("avatarData",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extraLargeAvatarUrl",{get:function(){return this.extraLargeAvatarUrl},set:function(e){e!==this._extraLargeAvatarUrl&&(this._extraLargeAvatarUrl=e,this.publish("extraLargeAvatarUrl",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"email",{get:function(){return this._email},set:function(e){e!==this._email&&(this._email=e,this.publish("email",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"presenceStatus",{get:function(){return this._presenceStatus},set:function(e){this._presenceStatus!==e&&(this._presenceStatus=e,this.publish("presenceStatus",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFilled",{get:function(){return this._isFilled},enumerable:!0,configurable:!0}),t.prototype.fetchDisplayNameAndAvatar=function(){return this.isFilled?Promise.resolve():this.getDataFromContactsService()},t.prototype._fetchDisplayNameAndAvatar=function(){var e=this;return this._isFilled=!0,this.isAgent?p.default.agentsService.getAgentDetails(this._id).then(function(t){if(t&&t.agentDescriptions&&1===t.agentDescriptions.length){var n=t.agentDescriptions[0].displayName;e._description=t.agentDescriptions[0].description,e._setAvatarDataIfValidUrl(t.agentDescriptions[0].userTileExtraLargeUrl),n&&(e.displayName=n)}return e._displayName}):this.getPersonData().then(function(){return e.displayName})},t.prototype.shouldFetchProfile=function(){return this._mri.indexOf("8:")>-1&&(!o.default.get.isTeams()||o.default.get.isTeams()&&!this._displayName)},t}(s.default);t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(10),o=n(11),s=n(307),a=function(){function e(){var e=this;this._pesManager=null,this._isLoading=!1,this._setLoadingFinished=function(){e._isLoading=!1},this.canRenderConfigItems=function(){return e._pesManager.canRenderConfigItems()},this.getConfiguration=function(){return new Promise(function(t,n){e.config?t(e.config):e.init().then(function(n){t(e.config)})})},this._pesManager=new s.default}return Object.defineProperty(e.prototype,"isInitialized",{get:function(){return this._isLoading||this._pesManager.isInitialized},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"map",{get:function(){return this._pesManager.map},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"emoticonMap",{get:function(){return this._pesManager.emoticonMap},enumerable:!0,configurable:!0}),e.prototype.initSkype=function(){var e=this;return this.getConfigurationPromise?this.getConfigurationPromise:(this._isLoading=!0,this.getConfigurationPromise=new Promise(function(t,n){r.default.instance.MePersonManager.fetch().then(function(n){e._pesManager.isInitialized||e._pesManager.init(n.id).then(function(n){e.config=n,e._setLoadingFinished(),t(e.config)},e._setLoadingFinished)},function(t){e._setLoadingFinished(),n(t),o.default.throwError(i.ErrorCodes.ERR_FETCH_ME_PERSON_AND_LOAD_PES,"Unable to fetch me person and load PES",t)})}),this.getConfigurationPromise)},e.prototype.init=function(){return this.initSkype()},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={version:"1.0.0.0",urls:["https://config.edge.skype.com"]};!function(e){e.Skype="Skype",e.SWC="SkypeWebControl"}(t.EcsClient||(t.EcsClient={})),function(e){e.Prod="Prod",e.Int="INT",e.Dogfood="DF",e.PPE="PPE"}(t.Environment||(t.Environment={})),t.configLoader=function(e,t,n){return new Promise(function(s,a){var c=o(e,r.version,t),u=0,l=function(){if(u<c.length){n&&{Authorization:n};var t=c[u++];i(e,t).then(function(e){return e?s(e):l()}).catch(function(e){return l()})}else{a("Unable to fetch config from ECS - "+e)}};l()})};var i=function(e,t){return new Promise(function(n,r){var i=encodeURIComponent("jsonSwcEcsFetch"+e+Date.now()),o=document.querySelector("body"),s=document.createElement("script"),a=-1===t.indexOf("?")?"?":"&";s.src=""+t+a+"callback="+i;var c=function(){delete window[i],o.removeChild(s)};window[i]=function(e){clearTimeout(u),c(),n(e)};var u=setTimeout(function(){c(),r("ECS timed out")},1e4);o.appendChild(s)})},o=function(e,t,n){var i,o,s=[],a=(i=n,o=[],Object.keys(i).forEach(function(e){o.push(encodeURIComponent(e)+"="+encodeURIComponent(i[e]))}),o.join("&"));return r.urls.forEach(function(n){s.push(n+"/config/v1/"+e+"/"+t+(a?"?"+a:""))}),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.SMALL="small",e.LARGE="large",e.EXTRA_LARGE="extraLarge",e.SUPER_LARGE="superLarge"}(t.ITEM_SIZES||(t.ITEM_SIZES={})),t.STATIC_MEDIA_INFO={firstFrame:0,framesCount:1,fps:1},function(e){e.camel="drawState",e.dash="draw-state"}(t.DRAW||(t.DRAW={}))},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(44),s=n(73),a=n(11),c=n(5),u=n(36),l=n(8),p=n(10),d=function(e){function t(t){var n=e.call(this,"kpi_message_sent",t)||this;return n.index=0,n}return i(t,e),t.prototype.getSharedCustomProperties=function(){var t=e.prototype.getCustomProperties.call(this);t.push(c.TelemetryPropertyValue.Create("timeSent",this.timeToSend)),t.push(c.TelemetryPropertyValue.Create("status",this.status||l.NA)),t.push(c.TelemetryPropertyValue.Create("errorCode",this.errorCode||l.NA)),t.push(c.TelemetryPropertyValue.Create("errorMessage",this.errorMessage||l.NA)),t.push(c.TelemetryPropertyValue.Create("messageLength",this.messageLength||0)),t.push(c.TelemetryPropertyValue.Create("messageType",this.getMessageType())),t.push(c.TelemetryPropertyValue.Create("index",this.index+"")),t.push(c.TelemetryPropertyValue.Create("isContact",this.isContact||l.NA));var n=l.NA;switch(this.origin){case o.ActionTrigger.BUTTON_SEND_CLICK:n="button";break;case o.ActionTrigger.KEYPRESS_ENTER:n="enter";break;case o.ActionTrigger.WELCOME_MESSAGE:n="welcome";break;case o.ActionTrigger.ADDON:n="addon";break;default:n=this.origin?this.origin+"":l.NA}return t.push(c.TelemetryPropertyValue.Create("origin",n)),t},t.prototype.getCustomProperties=function(){return this.getSharedCustomProperties()},t.prototype.getMessageType=function(){switch(this.messageType){case s.MessageType.TEXT:return"text";case s.MessageType.IMAGE:return"image";case s.MessageType.FILE:return"file";case s.MessageType.SWIFT:return"swift";case s.MessageType.EMOTICON:return"emoticon";case s.MessageType.QUICK_REPLY:return"quick reply";case s.MessageType.UNDETERMINED:return l.NA;default:a.default.throwError(p.ErrorCodes.ERR_UNKNOWN_MESSAGE_TYPE,"Unknown Message type:"+this.messageType)}return l.NA},t}(u.ConversationDataEvent);t.MessageSentEvent=d},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=n(36),a=n(8),c=function(e){function t(t){var n=e.call(this,"kpi_message_received",t)||this;return n.messageType=a.NA,n}return i(t,e),t.prototype.getCustomProperties=function(){var t=e.prototype.getCustomProperties.call(this);return t.push(o.TelemetryPropertyValue.Create("messageType",this.messageType)),t},t}(s.ConversationDataEvent);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20);t.NOTICE_CONTENT_TYPE={GENERIC:"application/vnd.microsoft.notice",USER:"application/vnd.microsoft.notice.avatar"};var i=function(){return function(e,t){this.id=e.campaignGuid||e.campaignId||r.guid.generate(),this.type=t,this.language=e.language,this.clientVersion=e.clientVersion,this.platformList=e.platformList,this.userTagging=e.userTagging,this.validUntilTimestamp=e.validUntilTimestamp?new Date(e.validUntilTimestamp):null,this.experimentName=e.experimentName,this.contentCategory=e.contentCategory,this.telemetry=e.telemetry}}();t.default=i},function(e,t){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){"use strict";if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),r=n.length>>>0,i=arguments[1],o=0;o<r;o++)if(t=n[o],e.call(i,t,o,n))return t}}),[Element.prototype,CharacterData.prototype].forEach(function(e){e.hasOwnProperty("nextElementSibling")||Object.defineProperty(e,"nextElementSibling",{configurable:!0,enumerable:!0,get:function(){for(var e=this;e=e.nextSibling;)if(1===e.nodeType)return e;return null},set:void 0})})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(155))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Skype="skype",e.Aad="aad"}(t.TokenType||(t.TokenType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(){var e=this;this.getDataPart=function(e){var t=e.substring(e.indexOf(".")+1);return t.substring(0,t.indexOf("."))},this.retrieveMeName=function(t){return t&&e.getTokenData(t).skypeid||""},this.getTokenData=function(t){return JSON.parse(atob(e.getDataPart(t)))}}}();t.default=r},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e){e.exports={area_text_insertText:"Type to chat...",search:"Search",search_no_results_found:"No results found",search_results:"{resultscount} RESULTS","_search_results.comment":'{Locked="{resultscount}"}',clear_search_text:"Clear",text_bots:"Bots","_text_bots.comment":"Header for search in bots directory",text_people:"People","_text_people.comment":"Header for search in contacts directory",text_favorites_contacts:"Favorites","_text_favorites_contacts.comment":"Header for Favorites contacts in contact list",text_contacts:"Contacts","_text_contacts.comment":"Header for Contact from Contacts list",text_chats:"Chats",text_all:"All",new_chat_header:"New Chat",new_chat_enter_group_name:"Enter group name...",new_chat_header_select_who_to_chat_with:"SELECT WHO YOU WOULD LIKE TO CHAT WITH",new_chat_header_to:"To:",new_chat_button_confirm_selection:"Done",new_chat_button_remove_selection:"Remove",new_chat_text_start_chat_with:"Start chat with {participant}","_new_chat_text_start_chat_with.comment":'{Locked="{participant}"}',right_now:"Right now",time_minutes_ago:"{minutes} min ago",emoticon_picker_open:"Open Emoticon picker",emoticon_picker_close:"Close Emoticon picker","_area_text_insertText.comment":"Placeholder text in chat input field",area_text_disabled:"Currently unable to chat.","_area_text_disabled.comment":"Text displayed to user in chat input field in case chatting is not possible",action_button_send:"Send","_action_button_send.comment":"? Tooltip for Send (message) button",joinedConversation:"{participant} joined this conversation","_joinedConversation.comment":'System notification in chat {Locked="{participant}"}',unread_messages:"Unread messages","_unread_messages.comment":"System notification in chat about unread messages",wasAdded:"{participant} added {contact} to this conversation","_wasAdded.comment":'System notification in chat {Locked="{participant}"} {Locked="{contact}"}',hasLeftConversation:"{participant} has left this conversation","_hasLeftConversation.comment":'System notification in chat {Locked="{participant}"}  ',wasRemoved:"{participant} has removed {removedParticipant} from this conversation","_wasRemoved.comment":'System notification in chat  {Locked="{participant}"} {Locked="{removedParticipant}"} ',historyClosed:"{participant} has made the chat history visible to everyone","_historyClosed.comment":'System notification in chat {Locked="{participant}"} ',historyDisclosed:"{participant} has hidden the conversation history from new participants","_historyDisclosed.comment":'System notification in chat {Locked="{participant}"} ',joiningEnabled:"{participant} enabled joining this conversation","_joiningEnabled.comment":'System notification in chat {Locked="{participant}"} ',joiningDisabled:"{participant} disabled joining this conversation","_joiningDisabled.comment":'System notification in chat {Locked="{participant}"} ',threadPictureUpdated:"{participant} has changed the conversation picture","_threadPictureUpdated.comment":'System notification in chat {Locked="{participant}"} ',roleUpdated:"{who} updated {whom}'s role to {role}","_roleUpdated.comment":'System notification in chat {Locked="{who}"}{Locked="{whom}"} {Locked="{role}"}  ',topicUpdated:"{participant} has changed the conversation topic to '{topic}'","_topicUpdated.comment":'System notification in chat {Locked="{participant}"} {Locked="{topic}"}',chatBlocked:"Conversation is blocked","_chatBlocked.comment":"System notification in chat",waitingForReply:"You need to wait for {user_name}'s reply to continue chatting.","_waitingForReply.comment":'System notification in chat {Locked="{user_name}"}',ms_service_privacy_agreement:"By chatting below, you agree to the {0}Microsoft services agreement{1} and {2}privacy statement{3}.","_ms_service_privacy_agreement.comment":'terms of use text {Locked="{0}"} {Locked="{1}"} {Locked="{2}"} {Locked="{3}"}',s_title:"Sent you a message","_s_title.comment":"String used for Swift card title in case the card does not have its own",s_card:"Card","_s_card.comment":"Swift card",s_cards:"Cards","_s_cards.comment":"Swift cards",s_vat:"VAT","_s_vat.comment":"VAT in swift cards",s_tax:"Tax","_s_tax.comment":"Tax in swift cards",s_totalPrice:"Total","_s_totalPrice.comment":"Total price in swift cards",s_unsupported:"This card is currently not supported on this version of Skype.","_s_unsupported.comment":"Text displayed when using old version of Skype",s_unsupported_button:"Next","_s_unsupported_button.comment":"Button text displayed when user is using old version of Skype",s_learnMore:"Learn more","_s_learnMore.comment":"Text of the card title displayed when card is unsupported",s_showImageTitle:"Enlarge image","_s_showImageTitle.comment":"Some of pictures in swift cards can be enlarged upon clicking on them. This is a tooltip text for such pictures.",s_signInTitle:"Connect","_s_signInTitle.comment":"Text of the card title displayed for Sign in cards",s_prevCard:"Show previous","_s_prevCard.comment":"Button tooltip for showing previous card in Carousel cards",s_nextCard:"Show next","_s_nextCard.comment":"Button tooltip for showing next card in Carousel cards",s_showAll:"Show all","_s_showAll.comment":"Button text for showing all cards",s_showLess:"Show less","_s_showLess.comment":"Button text for showing less cards",mediaPlayer_play:"Play","_mediaPlayer_play.comment":"Play button in swift media",mediaPlayer_pause:"Pause","_mediaPlayer_pause.comment":"Pause button in swift media",videoPlayer_fullscreen:"Fullscreen","_videoPlayer_fullscreen.comment":"Tooltip on the button to switch to Fullscreen mode on swift card video player",videoPlayer_exitFullscreen:"Exit fullscreen","_videoPlayer_ExitFullscreen.comment":"Tooltip on the button to exit Fullscreen mode on swift card video player",videoPlayer_button_mute:"Mute","_videoPlayer_button_mute.comment":"Tooltip on the button to mute on swift card video player",videoPlayer_button_unmute:"Unmute","_videoPlayer_button_unmute.comment":"Tooltip on the button to unmute on swift card video player",videoPlayer_button_turnOnVideo:"Turn on video","_videoPlayer_button_turnOnVideo.comment":"Tooltip on the video button displayed when my video is off during call",videoPlayer_button_turnOffVideo:"Turn off video","_videoPlayer_button_turnOffVideo.comment":"Tooltip on the video button displayed when my video is on during call",videoPlayer_button_turnOnIncomingVideo:"Turn on incoming video","_videoPlayer_button_turnOnIncomingVideo.comment":"Tooltip on the incoming video button displayed when incoming video is off during call",videoPlayer_button_turnOffIncomingVideo:"Turn off incoming video","_videoPlayer_button_turnOffIncomingVideo.comment":"Tooltip on the incoming video button displayed when incoming video is on during call",videoPlayer_button_endCall:"End call","_videoPlayer_button_endCall.comment":"Tooltip on the end call button during call",videoPlayer_button_startScreenSharing:"Share screen","_videoPlayer_button_startScreenSharing.comment":"(Action) Tooltip on the screen sharing button displayed when screen sharing is off during call",videoPlayer_button_stopScreenSharing:"Stop sharing","_videoPlayer_button_stopScreenSharing.comment":"Tooltip on the screen sharing button displayed when screen sharing is on during call",calling_button_toggleChat:"Toggle chat","_calling_button_toggleChat.comment":"Tooltip on the chat button during call",calling_button_dock:"Dock","_calling_button_dock.comment":"Tooltip on the dock button during call",calling_button_fullscreen:"Fullscreen","_calling_button_fullscreen.comment":"Tooltip on the fullscreen button during call",calling_button_settings:"Settings","_calling_button_settings.comment":"Tooltip on the settings button during call",calling_button_acceptWithAudio:"Accept with audio","_calling_button_acceptWithAudio.comment":"Tooltip on the accept button for incoming call",calling_button_acceptWithVideo:"Accept with video","_calling_button_acceptWithVideo.comment":"Tooltip on the accept button for incoming call",calling_button_reject:"Reject","_calling_button_reject.comment":"Tooltip on the reject button for incoming call",calling_settings_devices:"Devices","_calling_settings_devices.comment":"Title for calling devices settings",calling_settings_cameras:"Cameras","_calling_settings_cameras.comment":"Title for calling cameras select",calling_settings_microphones:"Microphones","_calling_settings_microphones.comment":"Title for calling microphones select",calling_settings_speakers:"Speakers","_calling_settings_speakers.comment":"Title for calling speakers select",calling_participants_close:"Close","_calling_participants_close.comment":"Title for call participants list closing button  (action)",calling_button_startAudio:"Start audio call","_calling_button_startAudio.comment":"Title for start call button (action)",calling_button_startVideo:"Start video call","_calling_button_startVideo.comment":"Title for start call button  (action)",calling_rate_request:"How would you rate the quality of this call?","_calling_rate_request.comment":"Question on call rate screen",accessibility_swift_action_prefix:"Click to {swiftAction}","_accessibility_swift_action_prefix.comment":'Tooltip on the button to unmute on swift card video player {Locked="{swiftAction}"}',header_termsOfUse:"Terms of use","_header_termsOfUse.comment":"Link to Terms of use",header_privacyPolicy:"Privacy policy","_header_privacyPolicy.comment":"Link to Privacy policy",m_unsupported:"This message type is currently not supported. Go to http://web.skype.com for full experience","_m_unsupported.comment":'Text displayed in chat when receiving unsupported message {Locked="http://web.skype.com"}',builder_botId:"Bot ID","_builder_botId.comment":"Bot ID text on Builder page",builder_buttonStyle:"Button style","_builder_buttonStyle.comment":"Button style text on Builder page",builder_buttonImage:"Button image","_builder_buttonImage.comment":"Button image text on Builder page",builder_buttonLabel:"Button label","_builder_buttonLabel.comment":"Button label text on Builder page",builder_colors:"Colors","_builder_colors.comment":"Colors text on Builder page",builder_message:"Message","_builder_message.comment":"Message text on Builder page",builder_theme:"Theme","_builder_theme.comment":"Theme text on Builder page",builder_code:"Code","_builder_code.comment":"Code word on Builder page",builder_copy:"Copy","_builder_copy.comment":"Copy word on the copy button on Builder page",builder_light:"Light","_builder_light.comment":"Light word on the copy button on Builder page",builder_dark:"Dark","_builder_dark.comment":"Dark word on the copy button on Builder page",sending:"Sending","_sending.comment":"Displayed while sending a message to SWC",failed:"Failed","_failed.comment":"Displayed when a message delivery failed",sign_in_welcome:"Please sign in to start chatting","_sign_in_welcome.comment":"Message in chatlog prompting user to sign in when in chat with 1:1",sign_in:"Sign in","_sign_in.comment":"Text on Button when in chat with 1:1",sign_in_cancel:"Cancel","_sign_in_cancel.comment":"Link in chat with 1:1",send_message:"Send message","_send_message.comment":"aria label for send (message) button",send_file:"Send file","_send_file.comment":"aria label for send (file) button",close_window:"Close window","_close_window.comment":"aria label for button which closes window",say_hi_to_a_bot:"Say hi to a bot",hi:"hi","_hi.comment":"message 'hi' sent to bot","_say_hi_to_a_bot.comment":"aria label for the button which when clicked submits say hi message",sign_in_to_save_your_chat:"Sign in to save your chat","_sign_in_to_save_your_chat.comment":"aria label for the button which when clicked submits say hi message",click_here_to_switch_accounts_aria_label:"Click here to switch accounts","_click_here_to_switch_accounts_aria_label.comment":"aria label for the button which when clicked switches accounts",you_cannot_sign_in_when_guest_only_mode_enabled:"You cannot sign in when guest only mode enabled","_you_cannot_sign_in_when_guest_only_mode_enabled.comment":"aria label displayed in guest only mode",say_hi:"Say 'hi'","_say_hi.comment":"Text displayed in chat.",or_text:" or ","_or_text.comment":"Part of Welcome message displayed in chat. The spaces at the beginning and at the end is necessary",sign_in_text:"sign in","_sign_in_text.comment":"Part of Welcome message displayed in chat.",to_save_your_chat:" to save your chat.","_to_save_your_chat.comment":"Part of Welcome message displayed in chat. The space before sentence is necessary",welcome_back:"Welcome back, {displayName}","_welcome_back.comment":'Text which appears in chat after user logs in {Locked="{displayName}"}',welcome_back_text:"Welcome back, ","_welcome_back_text.comment":"Text which appears in chat after user logs in. the space at the end is necessary",click_here_to_switch_account:"{0}Click here{1} to switch accounts","_click_here_to_switch_account.comment":'Text which appears after clicking on username in chat {Locked="{0}"} {Locked="{1}"}',click_here_text:"Click here","_click_here_text.comment":"Text which appears after clicking on username in chat",to_switch_accounts:" to switch accounts.","_to_switch_accounts.comment":"Text which appears after clicking on username in chat. Space at the beginning is necessary.",they_are_speaking:"They are speaking {theirLanguage}","_they_are_speaking.comment":'For example: They are speaking English {Locked="{theirLanguage}"}',you_are_speaking:"You are speaking {myLanguage}","_you_are_speaking.comment":'For example: You are speaking French {Locked="{myLanguage}"}',typingIndicator:"{typingMessage} is responding...","_typingIndicator.comment":'Message displayed after you submit a message to bot. For example: Swift bot is responding... {Locked="{typingMessage}"}',typingIndicatorHuman:"{typingMessage} is typing...","_typingIndicatorHuman.comment":'Message displayed when somebody is writing a message to a chat. For example: Anna is typing... {Locked="{typingMessage}"}',typingIndicatorOnLoad:"Loading...","_typingIndicatorOnLoad.comment":"Message displayed while conversation data is loading",recentlistChats:"Recent chats",recentlistChats_loading:"Loading chats...","_recentlistChats_loading.comment":"Chats loading label before list of chats is loaded",recentlist_new_conversation:"New Conversation",recentList_seeAllInSkype:"See All in Skype",recentList_welcome_heading:"Welcome to the new Skype",recentList_welcome_text_outlook:'Check it out by clicking the "{beforePlus}+{afterPlus}" at the top to start a new chat.',recentList_sorting_select_unread:"Unread","_recentList_sorting_select_unread.comment":"Recenlist select to filter unread items only",recentList_sorting_select_time:"Time","_recentList_sorting_select_time.comment":"Recenlist select to filter based on time",conversation_add_people_to_chat:"Add to group chat",button_add_participants:"Add",button_create_new_chat:"Create",conversation_remove_people_to_chat:"Chat participants",conversation_show_people_in_chat:"Participants","_conversation_show_people_in_chat.comment":"Title for view showing list of participants in conversation",callee_unavailable:"The person you're trying to call may not be available","_callee_unavailable.comment":"Text displayed to user when trying to call unavailable participant",calling_screen_calling:"CALLING...",calling_screen_incoming:"INCOMING CALL",calling_screen_onhold:"CALL ON HOLD...",message_text_ongoingCall:"Ongoing call","_message_text_ongoingCall.comment":"Message displayed to user on ongpoing call",message_text_startedCall:"Call",message_text_startedGroupCall:"Group call",message_text_endedCall:"Call ended",message_text_endedGroupCall:"Group call ended",message_text_missedCall:"Missed call",message_text_missedGroupCall:"Missed group call",message_text_noAnswerCall:"Call, no answer",message_text_noAnswerGroupCall:"Group call, no answer",message_text_hours:"h","_message_text_hours.comment":"Shortcut for hour",message_text_minutes:"m","message_text_minutes.comment":"Shortcut for minute",message_text_seconds:"s","message_text_seconds.comment":"Shortcut for second",message_text_photo:"photo","message_text_photo.comment":"Text displayed in message preview for image",message_text_you_have_left_the_conversation:"You have left the conversation",reactions_see_who_reacted_text:"See who reacted with emoticon {key}",reactions_you_text:"(you)",icon_text_message_was_edited:"This message has been edited",text_cancel_editing_message:"Cancel edit",deviceconsent_legend:"Click allow to give microphone and camera access.","_deviceconsent_legend.comment":"Text explaning the user how to grant access to microphone and camera.",roster_menu_item_create_group:"Create a group",roster_menu_delete_conversation:"Delete conversation",roster_menu_block_contact:"Block contact","_roster_menu_block_contact.comment":"Menu item in pop up to block current contact",roster_menu_unblock_contact:"Unblock contact","_roster_menu_unblock_contact.comment":"Menu item in pop up to unblock current contact",roster_menu_leave_conversation:"Leave conversation",roster_menu_report_a_problem:"Report a problem",roster_menu_get_help:"Get help",roster_menu_send_feedback:"Send feedback",confirm_dialog_delete_conversation_header:"Delete chat",confirm_dialog_delete_conversation_text:"Are you sure you want to delete this chat?",confirm_dialog_leave_conversation_header:"Leave chat",confirm_dialog_leave_conversation_text:"Are you sure you want to leave this chat?",confirm_dialog_delete_msg_header:"Remove message",confirm_dialog_edit_msg_header:"Edit message",confirm_dialog_delete_msg_text:"Are you sure you want to remove this message?",confirm_dialog_block_contact_header:"Block this contact?","_confirm_dialog_block_contact_header.comment":"Ask user if he wants to block current contact",confirm_dialog_block_report_abuse_checkbox:"Report abuse from this person","_confirm_dialog_block_report_abuse_checkbox.comment":"Ask user if he wants to report abuse from this person",confirm_dialog_block_select_abuse_reason:"Select a reason","_confirm_dialog_block_select_abuse_reason.comment":"Ask user to select abude resaon",confirm_dialog_report_abuse_spam_reason_text:"Spam","_confirm_dialog_report_abuse_spam_reason_text.comment":"Report spam as abuse reason",confirm_dialog_report_abuse_pornography_reason_text:"Contains nudity or pornography","_confirm_dialog_report_abuse_pornography_reason_text.comment":"The reason to report abuse is that content from contact contains nudity or pornography",confirm_dialog_report_abuse_child_exploitation_reason_text:"Child exploitation","_confirm_dialog_report_abuse_child_exploitation_reason_text.comment":"The reason to report abuse is child exploitation",confirm_dialog_report_abuse_harassment_reason_text:"Harassment or threats","_confirm_dialog_report_abuse_harassment_reason_text.comment":"he reason to report abuse is that content from contact contains harassment or threats",open_menu_dialog_text:"Open menu",btn_confirm_leave:"Leave",btn_confirm_deletion:"Delete",btn_confirm_removal:"Remove",btn_confirm_blocking:"Block","_btn_confirm_blocking.comment":"Text on the button to block contact",translator_active:"Translator: {0}active{1}","_translator_active.comment":'Message displayed when translator is active {Locked="{0}"} {Locked="{1}"}',scroll_to_bottom:"Scroll to bottom","_scroll_to_bottom.comment":"After user scrolls in chat to the top, a button appears with that text",crMessage:"Hi, I would like to add you to my contacts.","_cr_message.comment":"Message in chat",no_connection:"No connection","_no_connection.comment":"Message displayed in chat when there is no internet connection",message_failed:"Unable to send a message. Please try again later","_message_failed.comment":"Unable to send a message. Service currently is not available",polling_failed:"Service is currently unavailable","_polling_failed.comment":"Service currently is not available. Please try again later",notification_summary:"You have {count} unread conversation",notification_summary_few:"You have {count} unread conversation",notification_summary_few_comment:"Text of notification that appears right after user loggs in if he has unread conversations","_notification_summary.comment":'Text of notification that appears right after user loggs in if he has some unread conversations. {Locked="{count}"}',notification_summary_many:"You have {count} unread conversations","_notification_summary_many.comment":'Text of notification that appears right after user loggs in if he has some unread conversations {Locked="{count}"}',notification_reminder:"Unread chats: {name}","_notification_reminder.comment":'Text of notification when user has more than 2 new unread messages in a chat{Locked="{name}"}',notification_reminder_desc:"{count} unread chat","notification_reminder_desc.comment":'Text of the notification description when user has more than 2 new unread messages in a chat{Locked="{count}"}',notification_reminder_desc_many:"{count} unread chats","notification_reminder_desc_many.comment":'Text of notification when user has more than 2 new unread messages in few chats {Locked="{count}"}',separator:",","_separator.comment":"Separator between words",file_sent:"Sent a file","_file_sent.comment":"Message that showed in notification was a file was sent in conversation",pic_sent:"Sent a picture","_pic_sent.comment":"Message that showed in notification was a picture was sent in conversation",open:"Open","_open.comment":"Open something, for example a chat",open_client_descr:"Open Skype client","_open_client_descr.comment":"Description for Open Skype client button",accept:"Accept","_accept.comment":"Accept a call button",accept_descr:"Accept the call","_accept_descr.comment":"Description to Accept button",ignore:"Ignore","_ignore.comment":"Ignore text",ignore_descr:"Ignore the call","_ignore_descr.comment":"Description for Ignore call button",ignore_summary_notificaton_descr:"Ignore notifications from Skype client for some time","_ignore_summary_notificaton_descr.comment":"Description for Ignore notifications from Skype client button",ignore_reminder_notificaton_descr:"Ignore unread message reminder notification","_ignore_reminder_notificaton_descr.comment":"Description for Ignore current notifications from Skype client button",ignore_unread_notificaton_descr:"Ignore unread message notification","_ignore_unread_notificaton_descr.comment":"Description for Ignore current notifications from Skype client button",msn_signin_screen_title:"Skype on MSN","_msn_signin_screen_title.comment":"MSN sign-in screen - title",msn_signin_screen_contacts:"See who's online","_msn_signin_screen_contacts.comment":"MSN sign-in screen - contacts label",msn_signin_screen_recents:"Notifications and missed messages","_msn_signin_screen_recents.comment":"MSN sign-in screen - recent items label: missed calls, messages...",msn_signin_screen_calling_messaging:"Voice calls and chats","_msn_signin_screen_calling_messaging.comment":"MSN sign-in screen - messaging and calling label",msn_signin_screen_connect:"Start connecting your Skype","_msn_signin_screen_connect.comment":"MSN sign-in screen - connect skype title",msn_signin_screen_connect_description:"Connecting Skype with MSN requires a Microsoft account to get set up.","_msn_signin_screen_connect_description.comment":"MSN sign-in screen - connect description: what is needed to connect Skype",msn_signin_screen_sign_in_has_account:"Already have a Microsoft account?","_msn_signin_screen_sign_in_has_account.comment":"MSN sign-in screen - user already has an account label",msn_signin_screen_sign_in_button:"SIGN IN","_msn_signin_screen_sign_in_button.comment":"MSN sign-in screen - sign in button text",msn_signin_screen_sign_in_no_account:"Don't have a Microsoft account?","_msn_signin_screen_sign_in_no_account.comment":"MSN sign-in screen - user doesn't have an account yet label",msn_signin_screen_create_account_button:"CREATE NOW","_msn_signin_screen_create_account_button.comment":"MSN sign-in screen - create an account button text",date_monday:"Mon",date_tuesday:"Tue",date_wednesday:"Wed",date_thursday:"Thu",date_friday:"Fri",date_saturday:"Sat",date_sunday:"Sun",powered_by_skype:"Powered by Skype",do_not_have_account:"Do not have an account?","_do_not_have_account.comment":"Message showed on the login page for people who want to register.",sign_up:"Sign up!","_sign_up.comment":"Message shown for the action of signing up for a Skype account.",mark_all_conversations_as_read:"Mark all as read","_mark_all_conversations_as_read.comment":"Message displayed on button that marks all the conversations as read.",show_options:"Show options","_show_options.comment":"Message displayed on hover for action of displaying options",confirm_mark_all_as_read_header:"Mark all as read","_confirm_mark_all_as_read_header.comment":"Message for confirmation dialog header.",confirm_mark_all_as_read_text:"Are you sure you want to mark all conversations as read?","_confirm_mark_all_as_read_text.comment":"Confirmation message for marking all as read.",btn_confirm_marking_as_read:"Yes","_btn_confirm_marking_as_read.comment":"Message on marking button.",show_incoming_video_button:"Show incoming video","_show_incoming_video_button.comment":"Message on button that triggers the action of showing incoming videos.",hide_incoming_video_button:"Hide incoming video","_hide_incoming_video_button.comment":"Message on button that triggers the action of hiding incoming videos."}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=n(108),i=function(){function t(){}return t.prototype.load=function(t,n){var i=this,o=(new XMLHttpRequest,t+"/"+n+"/Strings.json");return new Promise(function(t,n){return e(o).then(function(e){return e.json().then(function(e){i._translations=e,r.default.merge(e),t()},n)})})},t}();t.default=new i}).call(this,n(61))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),i=n(11),o={af:"af",am:"am",ar:"ar",as:"as",az:"az",be:"be",bg:"bg",bn:"bn",bs:"bs",chr:"chr",ca:"ca",cs:"cs",cy:"cy",da:"da",de:"de",el:"el",en:"en",es:"es",et:"et",eu:"eu",fa:"fa",fi:"fi",fil:"fil",fr:"fr",ga:"ga",gd:"gd",gl:"gl",gu:"gu",ha:"ha",he:"he",hi:"hi",hr:"hr",hu:"hu",hy:"hy",id:"id",ig:"ig",is:"is",it:"it",iw:"iw",ja:"ja",ka:"ka",kk:"kk",km:"km",kn:"kn",ko:"ko",kok:"kok",ku:"ku",ky:"ky",lb:"lb",lt:"lt",lv:"lv",mi:"mi",ml:"ml",mn:"mn",mr:"mr",ms:"ms",ne:"ne",nl:"nl",nn:"nn",nb:"nb",no:"no",nso:"nso",or:"or",pa:"pa",pl:"pl",prs:"prs",pt_br:"pt-br",pt_pt:"pt-pt",qps:"qps",qut:"qut",quz:"quz",ro:"ro",ru:"ru",rw:"rw",sd:"sd",si:"si",sl:"sl",sk:"sk",sq:"sq",sr:"sr",sv:"sv",sw:"sw",ta:"ta",te:"te",tg:"tg",th:"th",ti:"ti",tk:"tk",tn:"tn",tr_tr:"tr-tr",tt:"tt",ug:"ug",uk:"uk",ur:"ur",uz:"uz",vi:"vi",wo:"wo",xh:"xh",yo:"yo",zh:"zh",zu:"zu"},s={group0:{languages:[o.ja,o.id,o.ko,o.tr_tr,o.vi,o.zh,o.az,o.ig,o.fa,o.ka,o.km,o.kn,o.ms,o.prs,o.th,o.tt,o.ug,o.wo,o.yo]},group1:{languages:[o.bg,o.ca,o.cy,o.da,o.de,o.el,o.en,o.es,o.et,o.fi,o.he,o.hu,o.it,o.iw,o.nb,o.nl,o.no,o.pt_pt,o.qps,o.sv,o.af,o.as,o.bn,o.chr,o.eu,o.gl,o.gu,o.ha,o.hy,o.is,o.kk,o.kok,o.ku,o.ky,o.lb,o.mi,o.ml,o.mn,o.mr,o.ne,o.nn,o.or,o.pa,o.qut,o.quz,o.rw,o.sd,o.si,o.sq,o.sw,o.ta,o.te,o.tk,o.tn,o.ur,o.xh,o.zu]},group2:{languages:[o.fr,o.pt_br,o.am,o.fil,o.hi,o.nso,o.tg,o.ti,o.uz]},group3:{languages:[o.lv]},group4:{languages:[o.gd]},group5:{languages:[o.ro]},group6:{languages:[o.lt]},group7:{languages:[o.ru,o.uk,o.hr,o.sr,o.be,o.bs,o.sl]},group8:{languages:[o.cs,o.sk]},group9:{languages:[o.pl]},group11:{languages:[o.ga]},group12:{languages:[o.ar]}},a=function(){function e(){}return e.prototype.init=function(e){void 0===e&&(e=o.en);var t=e.replace("-","_").toLowerCase();if(!o[t]){var n=t.split("_");1===n.length&&i.default.throwError(r.ErrorCodes.ERR_UNSUPPORTED_LANGUAGE,"Unsupported language:"+e),t=n[0]}this._currentLocale=t},e.prototype.getPluralSuffix=function(e){var t,n=null,r="";for(t in s)-1!==s[t].languages.indexOf(this._currentLocale)&&(n=t);switch(n){case"group0":r=1===e?"":"_few";break;case"group1":r=1===e?"":"_many";break;case"group2":r=e>1?"_many":"";break;case"group3":r=e%10==1&&e%100!=11?"":0===e?"_few":"_many";break;case"group4":r=1===e||11===e?"":2===e||12===e?"_few":"_many";break;case"group5":r=1===e?"":0===e||e%100>0&&e%100<20?"_few":"_many";break;case"group6":r=e%10==1&&e%100!=11?"":e%10>=2&&(e%100<10||e%100>=20)?"_many":"_few";break;case"group7":r=e%10==1&&e%100!=11?"":e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?"_few":"_many";break;case"group8":r=1===e?"":e>=2&&e<=4?"_few":"_many";break;case"group9":r=1===e?"":e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?"_few":"_many";break;case"group11":r=1===e?"":e>=2&&e<=10?"_few":"_many";break;case"group12":r=1===e?"":2===e?"_few":"_many";break;default:r=""}return r},e}();t.default=new a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(2),o=n(13),s=n(120),a=n(14),c=n(220),u=n(221),l=n(224),p=n(225),d=n(228),f=n(229),h=n(230),g=n(231),m=n(232),_=n(233),y=n(234),v=n(235),b=n(236),P=n(237),T=n(238),w=n(239),E=function(){function e(){this._processors=[],this._xmmFallbackProcessor=new w.default,this._processors.push(new P.default),this._processors.push(new c.default),this._processors.push(new l.default),this._processors.push(new y.default),this._processors.push(new T.default),this._processors.push(new _.default),this._processors.push(new f.default),this._processors.push(new g.default),this._processors.push(new v.default),this._processors.push(new u.default),this._processors.push(new h.default),this._processors.push(new d.default),this._processors.push(new m.default),this._processors.push(new p.default)}return Object.defineProperty(e.prototype,"teamsFileProcessor",{get:function(){return this._teamsFileProcessor||(this._teamsFileProcessor=new b.default),this._teamsFileProcessor},enumerable:!0,configurable:!0}),e.prototype.handle=function(e,t){var n,i=0;for(e.contentOriginal&&e.contentOriginal!==e.content?e.content=e.contentOriginal:e.contentOriginal=e.contentOriginal||e.content;!n&&i<this._processors.length;)n=this._processors[i].process(e,t),i++;return r.default.get.isTeams(),n||(n=this._xmmFallbackProcessor.process(e)),n},e.prototype.generateOutgoing=function(e){for(var t,n=0;!t&&n<this._processors.length;)t=this._processors[n].generate(e),n++;return t},e.prototype.updateExistingMessage=function(e,t,n){if(!t||e.senderId!==t.senderId)return e;var c=0===t.content.indexOf(i.default.MSG_DELETED_CLASSIC_SKYPE),u=0===e.content.indexOf(i.default.MSG_DELETED_CLASSIC_SKYPE),l=t.skypeEditedId&&c,p=t.version>e.version,d=t.originalTimestamp>e.originalTimestamp,f=p||d;return d&&n&&(e.content=l?a.default.extractMsgContent(t.content):t.content,e.timestamp=t.timestamp,e.originalTimestamp=t.originalTimestamp),e.status=t.status,t.skypeEditedId?t.editedTimestamp&&s.default.updateMessageProperties(e,t):s.default.updateMessageProperties(e,t),t.isEdited&&(e.isEdited=!0,u&&(e.content=a.default.extractMsgContent(e.content)),(t.editedTimestamp>e.timestamp||f)&&(e.content=t.content)),e.isEdited&&!d&&n&&(e.timestamp=t.timestamp),t.isDeleted&&(e.isDeleted=!0),r.default.get.backend===o.MessagingBackend.TEAMS&&(e.isDeleted=t.isDeleted),e},e.prototype.isTypingIndicator=function(e){return"Control/Typing"===e.messagetype||"Control/ClearTyping"===e.messagetype},e}();t.default=E},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s=n(58),a=n(0),c=n(1),u=n(15),l=n(27),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.process=function(e,t){if("ThreadActivity/AddMember"!==e.messagetype)return null;var n=new l.default(this._createMessageModel.bind(this),this._generateContent,e);n._subscribeOnceToPersonsName(n._initiator),n._targets.forEach(n._subscribeOnceToPersonsName);var r=this.parseContentFor(e.content,"target"),i=c.default.instance.Persons.getPerson(r),u=t.conversation.participants;if(!t.isHistory&&r&&u&&!u.some(function(e){return e.person.id===i.id})){var p=new s.default(i);u.pushObservable(p),i.isAgent&&a.swc.API.triggerEvent(o.ApiEvents.BotAddedToThread,i.id)}return t.conversation.isOneOnOne&&(n._messageModel.content=""),n._messageModel},t.prototype._generateContent=function(e){var t=e._initiator.displayName||e._initiator.id;return e._isSelfAction()?c.default.instance.i18n.fetch("joinedConversation",{participant:"<b>"+t+"</b>"}):c.default.instance.i18n.fetch("wasAdded",{participant:"<b>"+t+"</b>",contact:"<b>"+e._targets.filter(function(t){return t.id!==e._initiator.id}).map(function(e){return e.displayName||e.id}).join("</b>, <b>")+"</b>"})},t}(u.default);t.default=p},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),s=n(222),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.process=function(e,t){return(o.default.ECS.showEngagementCampaings&&"PopCard"===e.messagetype||"Notice"===e.messagetype)&&s.default.instance.register(e,t),null},t}(n(15).default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(2),o=n(0),s=n(223),a=12096e5,c=function(){function e(){var e=this;this.register=function(t,n){var i,a;if(e._isSupported(n.conversation)&&e._isWithinTwoWeeks(t)){try{a=JSON.parse(t.content)}catch(e){}if(a&&a.length){switch(t.messagetype){case"Notice":i=new s.default(a[0],t.messagetype)}e._isInValid(i.validUntilTimestamp)||i&&o.swcWindow.swc.API.triggerEvent(r.CampaignEvents.SHOW,i)}}},this._isSupported=function(t){return t.isAgent&&e._isConversationWithConciergeBot(t.id)},this._isInValid=function(e){return Date.now()>e.getTime()},this._isWithinTwoWeeks=function(e){var t=Date.now()-a;return new Date(e.originalarrivaltime).getTime()>t},this._isConversationWithConciergeBot=function(e){return e===i.default.CONCIERGE_BOT_MRI||e===i.default.CONCIERGE_BOT_DF_MRI},this.unregister=function(e){o.swcWindow.swc.API.triggerEvent(r.CampaignEvents.DISMISS,e)}}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e}();t.default=c},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.campaignId=t.campaignId,r.schemaVersion=t.schemaVersion,r.attachment=t.attachments&&t.attachments.length?t.attachments[0]:null,r}return i(t,e),t}(n(151).default);t.default=o},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(15),a=n(27),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.process=function(e,t){if("ThreadActivity/DeleteMember"!==e.messagetype)return null;var n=new a.default(this._createMessageModel.bind(this),this._generateContent,e);if(n._subscribeOnceToPersonsName(n._initiator),n._targets.forEach(function(e){n._subscribeOnceToPersonsName(e),t.conversation&&e===o.default.instance.MePersonManager.mePerson&&(t.conversation.isChatEnabled=!1)}),!1===t.isHistory)for(var r=this.parseContentFor(e.content,"target"),i=o.default.instance.Persons.getPerson(r),s=0;s<t.conversation.participants.length;s++){if(t.conversation.participants[s].person.id===i.id){t.conversation.participants.spliceObservable(s,1);break}}return n._messageModel},t.prototype._generateContent=function(e){var t=e._initiator.displayName||e._initiator.id;return e._isSelfAction()?o.default.instance.i18n.fetch("hasLeftConversation",{participant:"<b>"+t+"</b>"}):o.default.instance.i18n.fetch("wasRemoved",{participant:"<b>"+t+"</b>",removedParticipant:"<b>"+e._targets.map(function(e){return e.displayName||e.id}).join("</b>, <b>")+"</b>"})},t}(s.default);t.default=c},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),s=n(112),a=n(14),c=n(1),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._getCallEventContentByType=function(e,t){var n=(e.conversationId||e.conversationid||"").indexOf("@thread.skype")>-1||!!e.threadtopic,r=e.content.replace(/\r?\n/g,""),i=null,c=o.CustomMessageType.Call;if(r.indexOf("<partlist")>-1){var u=/(<partlist alt ?= ?"">\s*<\/partlist>)|(<partlist type="started")/.test(r),l=/(^<ended)|(<partlist type="ended")/.test(r),p=/<partlist type="missed"/.test(r),d=new RegExp('<part identity="(\\d+:)?'+t+'">.*?</part>',"g"),f=new RegExp("<duration>([\\d|\\.]+)</duration>"),h=r.match(d.source),g=r.match(f.source),m=!!h&&!!h[0],_=g?parseInt(g[1],10):0,y=s.getCallMessage({isGroup:n,isMyself:m,isStarted:u,isEnded:l,isMissed:p,duration:_});i=y.message,c=y.messageType}return{content:a.default.getMessageSanitizedContent(i),contentType:c}},t}return i(t,e),t.prototype.process=function(e){if("Event/Call"!==e.messagetype&&"Signal/Flamingo"!==e.messagetype)return null;var t=this._createMessageModel(e,"",!0),n=c.default.instance.MePersonManager.mePerson,r=this._getCallEventContentByType(e,n.id);return t.content=r.content,t.isDeleted=!1,t.isEdited=!1,t.customType=r.contentType,null==r.content?null:t},t}(n(15).default);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._callback=e,this._duration=0,this._isGoing=!1}return e.prototype.start=function(){var e=this,t=Date.now();this._isGoing=!0;var n=function(){if(e._isGoing){var r=Date.now(),i=Math.floor((r-t)/1e3);e._duration!==i&&(e._duration=i,e._callback(i)),window.setTimeout(n,500)}};n()},e.prototype.reset=function(){this._isGoing=!1,this._duration=0,this._callback(this._duration)},e}();t.Duration=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(7);t.getCallMessage=function(e){var t=null,n=i.CustomMessageType.Call,o=e.isGroup?"GroupCall":"Call";if(e.isStarted)t=r.default.instance.i18n.fetch("message_text_ongoingCall"),n=i.CustomMessageType.Call;else if(e.isEnded&&e.isMyself){var s=e.duration?"<span>"+function(e){var t="",n=Math.round(e/3600);if(n>0){var i=r.default.instance.i18n.fetch("message_text_hours");t+=n+i+" "}e%=3600;var o=Math.round(e/60);if(o>0){var s=r.default.instance.i18n.fetch("message_text_minutes");t+=o+s+" "}var a=e%60;if(a>0){var c=r.default.instance.i18n.fetch("message_text_seconds");t+=a+c}return t.trim()}(e.duration)+"</span>":"";t=e.duration?r.default.instance.i18n.fetch("message_text_ended"+o)+" "+s:r.default.instance.i18n.fetch("message_text_noAnswer"+o),n=i.CustomMessageType.CallEnd}else(e.isMissed||e.isEnded&&!e.isMyself)&&(t=r.default.instance.i18n.fetch("message_text_missed"+o),n=e.isGroup?i.CustomMessageType.MissedGroupCall:i.CustomMessageType.MissedCall);return{message:t,messageType:n}}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),s=n(14),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.parseRawMessage=function(e){if(!e)return null;var t=e.match(/<URIObject[^>]*?\suri=\"([^"]+?)\"/i),n=e.match(/<URIObject[^>]*?\stype=\"([^"]+?)\"/i),r=e.match(/<meta[^>]*?\stype=\"([^"]+?)\"/i);if(!t)return null;var i=new c;return i.uri=t[1],i.uriObjectType=r?r[1]:null,i.xmmType=n?n[1].split(".")[0]:null,i},t.isValidFileMessage=function(e){return null===e||null===e.uri||!("File"===e.xmmType)},t.createFileContent=function(e){return'<LwcFile url="'+e.uri+'" size="'+e.size+'" originalName="'+e.originalName+'"></LwcFile>'},t}return i(t,e),t.prototype.process=function(e){if(-1===["RichText/UriObject","RichText/Media_GenericFile","RichText/Media_Video","RichText/Media_AudioMsg","RichText/Media_Card"].indexOf(e.messagetype))return null;var t=e.content,n=this.parseRawMessage(t);if(!n)return e.content=s.default.getMessageSanitizedContent(e.content),this._createMessageModel(e);if(this.isValidFileMessage(n))return null;var r=t.match(/<FileSize[\s]+[^<]*v=\"([\d]*?)\"[^<]/i),i=t.match(/<OriginalName[\s]+[^<]*v=\"([\s\S]*?)\"[^<]/);n.size=r?r[1]:"0",n.originalName=i?i[1]:null;var a=this._createMessageModel(e);return a.type=o.MessageType.LwcFile,a.content=this.createFileContent(n),a},t.prototype.generate=function(e){if("RichText/Media_GenericFile"!==e.messagetype)return null;var t=e.content,n=this.parseRawMessage(t);if(this.isValidFileMessage(n))return null;var r=t.match(/<FileSize[\s]+[^<]*v=\"([\d]*?)\"[^<]/i),i=t.match(/<OriginalName[\s]+[^<]*v=\"([\s\S]*?)\"[^<]/);n.size=r?r[1]:"0",n.originalName=i?i[1]:null;var s=this._generateOutgoingModel(e);return s.type=o.MessageType.LwcFile,s.content=this.createFileContent(n),s},t}(n(15).default);t.default=a;var c=function(){return function(){}}()},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(15),a=n(27),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.process=function(e){if("ThreadActivity/HistoryDisclosedUpdate"!==e.messagetype)return null;var t=new a.default(this._createMessageModel.bind(this),this._generateContent.bind(this,e.content),e);return t._subscribeOnceToPersonsName(t._initiator),t._messageModel},t.prototype._generateContent=function(e,t){var n=t._initiator.displayName||t._initiator.id;return"false"===this._getUpdateValue(e)?o.default.instance.i18n.fetch("historyDisclosed",{participant:"<b>"+n+"</b>"}):o.default.instance.i18n.fetch("historyClosed",{participant:"<b>"+n+"</b>"})},t.prototype._getUpdateValue=function(e){var t=e.match(/<value>(.+)<\/value>/i);return t?t[1]:""},t}(s.default);t.default=c},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.parseRawMessage=function(e){if(!e)return null;var t=e.match(/<URIObject[^>]*?\suri=\"([^"]+?)\"/i),n=e.match(/<URIObject[^>]*?\stype=\"([^"]+?)\"/i),r=e.match(/<meta[^>]*?\stype=\"([^"]+?)\"/i),i=e.match(/<originalname[^>]*?\sv=\"([^"]+?)\"/i);if(!t)return null;var o=new a;return o.filename=i?i[1]:null,o.uri=t[1],o.uriObjectType=r?r[1]:null,o.xmmType=n?n[1].split(".")[0]:null,o},t.isValidImageMessage=function(e){return null===e||null===e.uri||!("Picture"===e.xmmType||"photo"===e.uriObjectType)},t.createImageContent=function(e){return'<LwcImage url="'+e.uri+'" filename="'+e.filename+'" ></LwcImage>'},t}return i(t,e),t.prototype.process=function(e){if("RichText/UriObject"!==e.messagetype)return null;var t=this.parseRawMessage(e.content);if(!t&&e.skypeeditedid)return this._createMessageModel(e);if(this.isValidImageMessage(t))return null;var n=this._createMessageModel(e);return n.type=o.MessageType.LwcImage,n.content=this.createImageContent(t),n},t.prototype.generate=function(e){if("RichText/UriObject"!==e.messagetype)return null;var t=this.parseRawMessage(e.content);if(this.isValidImageMessage(t))return null;var n=this._generateOutgoingModel(e);return n.type=o.MessageType.LwcImage,n.content=this.createImageContent(t),n},t}(n(15).default);t.default=s;var a=function(){return function(){}}()},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(15),a=n(27),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.process=function(e){if("ThreadActivity/JoiningEnabledUpdate"!==e.messagetype)return null;var t=new a.default(this._createMessageModel.bind(this),this._generateContent.bind(this,e.content),e);return t._subscribeOnceToPersonsName(t._initiator),t._messageModel},t.prototype._generateContent=function(e,t){var n=t._initiator.displayName||t._initiator.id;return"true"===this._getUpdateValue(e)?o.default.instance.i18n.fetch("joiningEnabled",{participant:"<b>"+n+"</b>"}):o.default.instance.i18n.fetch("joiningDisabled",{participant:"<b>"+n+"</b>"})},t.prototype._getUpdateValue=function(e){var t=e.match(/<value>(.+)<\/value>/i);return t?t[1]:""},t}(s.default);t.default=c},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(14),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.process=function(e){if("SystemMessage"!==e.messagetype)return null;var t=o.default.getMessageSanitizedContent(e.content);return this._createMessageModel(e,t,!0)},t}(n(15).default);t.default=s},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(15),a=n(27),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.process=function(e,t){if("ThreadActivity/PictureUpdate"!==e.messagetype)return null;var n=new a.default(this._createMessageModel.bind(this),this._generateContent,e);if((n._subscribeOnceToPersonsName(n._initiator),t.conversation&&t.conversation.messages&&t.conversation.messages.length)&&t.conversation.messages[t.conversation.messages.length-1].timestamp<n._messageModel.timestamp){var r=this.getNewPicture(e.content);t.conversation.avatar=r||t.conversation.avatar}return n._messageModel},t.prototype._generateContent=function(e){var t=e._initiator.displayName||e._initiator.id;return o.default.instance.i18n.fetch("threadPictureUpdated",{participant:"<b>"+t+"</b>"})},t.prototype.getNewPicture=function(e){var t=e.match(/URL@([^<]+)(?=<\/value>)/g);return t?t[0].replace("URL@",""):null},t}(s.default);t.default=c},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(7),a=n(15),c=n(27),u={admin:s.ParticipantRole.Admin,user:s.ParticipantRole.User},l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._updateParticipantRoles=function(e,t,n){var r=u[n.toLowerCase()];t.forEach(function(t){e.participants.forEach(function(e){var n=e.person.id;t.id===n&&(e.role=r)})})},t}return i(t,e),t.prototype.process=function(e,t){if("ThreadActivity/RoleUpdate"!==e.messagetype)return null;var n=this._getRole(e.content),r=new c.default(this._createMessageModel.bind(this),this._generateContent.bind(this,n),e);return r._subscribeOnceToPersonsName(r._initiator),r._targets.forEach(r._subscribeOnceToPersonsName),t.conversation&&t.conversation.participants&&this._updateParticipantRoles(t.conversation,r._targets,n),r._messageModel},t.prototype._generateContent=function(e,t){var n=t._initiator.displayName||t._initiator.id,r=t._targets[0].displayName||t._targets[0].id;return o.default.instance.i18n.fetch("roleUpdated",{who:"<b>"+n+"</b>",whom:"<b>"+r+"</b>",role:"<b>"+e+"</b>"})},t.prototype._getRole=function(e){var t=e.match(/<role>(.+)<\/role>/i);return t?t[1]:""},t}(a.default);t.default=l},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(7),a=n(25),c=n(35),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._getTitle=function(e){var t=e.content.match(/<Title>(.*)<\/Title>/i);return t?t[1]:o.default.instance.i18n.fetch("s_title",{mesageType:e.messagetype})},t}return i(t,e),t.prototype.process=function(e){if("RichText/Media_Card"!==e.messagetype)return null;var t=this._getTitle(e),n=e.content.match(/<Swift b64="([^"]+)"\s*\/>/i);try{var r=c.default.b64DecodeUnicode(n[1]);e.content='<SwiftCard Swift="'+encodeURIComponent(r)+'">'+a.default.dompurify.sanitize(t,{ALLOWED_TAGS:[]})+"</SwiftCard>"}catch(e){return null}var i=this._createMessageModel(e);i.type=s.MessageType.SwiftCard;try{i.content=decodeURIComponent(e.content)}catch(e){return null}return i},t}(n(15).default);t.default=u},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.createFileContent=function(e){return"<LwcSharepointFile>"+JSON.stringify(e)+"</LwcSharepointFile>"},t}return i(t,e),t.prototype.process=function(e){var t=this;if(!e.properties||!e.properties.files)return null;var n=JSON.parse(e.properties.files),r=this._createMessageModel(e);return r.type=o.MessageType.LwcFile,n.forEach(function(e){r.content+=t.createFileContent(e)}),r},t}(n(15).default);t.default=s},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(51),s=n(14),a=/<context reason=\"customAad\">.*<\/context>/g,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.process=function(e,t){if("RichText"!==e.messagetype&&"Text"!==e.messagetype&&"InviteFreeRelationshipChanged/Initialized"!==e.messagetype&&"RichText/Html"!==e.messagetype)return null;e.content||(e.content="");var n=e.content,r=n.match(a);r&&r[0]&&(n=n.replace(r[0],"")),e.content=n;var i=this._createMessageModel(e);return i.content=o.default.parse(i.content),i.content=s.default.getMessageSanitizedContent(i.content,t),i},t.prototype.generate=function(e){return"RichText"!==e.messagetype?null:this._generateOutgoingModel(e)},t}(n(15).default);t.default=c},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(14),a=n(15),c=n(27),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.process=function(e,t){if("ThreadActivity/TopicUpdate"!==e.messagetype)return null;e.threadtopic&&t.conversation&&(t.conversation.topic=s.default.parseTopic(e.threadtopic));var n=new c.default(this._createMessageModel.bind(this),this._generateContent.bind(this,e.content),e);return n._subscribeOnceToPersonsName(n._initiator),n._messageModel},t.prototype._generateContent=function(e,t){var n=this.parseContentFor(e,"value"),r=t._initiator.displayName||t._initiator.id;return n=n?s.default.parseTopic(n):"",o.default.instance.i18n.fetch("topicUpdated",{participant:"<b>"+r+"</b>",topic:"<i>"+n+"</i>"})},t}(a.default);t.default=u},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(14),s=n(1),a=n(7),c=["RichText/UriObject","RichText/Media_GenericFile","RichText/Media_Video","RichText/Media_FlikMsg","RichText/Media_Card","RichText/Contacts","RichText/Location","RichText/Files","RichText/Sms","Event/SkypeVideoMessage","Event/SkypeAudioMessage"],u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.process=function(e){if(c.indexOf(e.messagetype)<0)return null;var t=e.content.match(/^<uriobject[^>]*?>(.*?)<\/uriobject>$/i);if(!t){var n=s.default.instance.i18n.fetch("m_unsupported"),r=this._createMessageModel(e,n);return r.type=a.MessageType.Unsupported,r}var i=o.default.getMessageSanitizedContent(t[1]);return this._createMessageModel(e,i)},t}(n(15).default);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.implode=function(e){return e.join(",")},e.explode=function(e){return e?e.replace(/\s/g,"").split(","):[]},e.find=function(t,n){return e.explode(t).indexOf(n)>-1},e.add=function(t,n,r){if(!r||!e.find(t,n)){var i=e.explode(t);i.push(n),t=e.implode(i)}return t},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(4),o=n(45),s=n(0);!function(e){e[e.replace=1]="replace"}(r=t.Rule||(t.Rule={}));var a=function(){function e(e,t,n){var r=this;this.pattern=e,this.rule=t,this.replace=function(e){return e.replace(r.pattern,r.replacer)},this.replacer=function(e){for(var t=e.length,n="",i=r.replacement;t--;)n+=i;return n},this.replacement=n}return Object.defineProperty(e.prototype,"replacement",{get:function(){return this.char?String.fromCharCode(this.char):void 0},set:function(e){this.char=e?e.charCodeAt(0):this.char},enumerable:!0,configurable:!0}),e}();t.Mask=a;var c=function(){function e(){var e=this;this.masks=[],this.setupProxy=function(){var t=s.swc.API;t.registerEvent(i.ApiEvents.invoke.registerMask,function(t){e.register(t,r.replace,"#")}),t.registerEvent(i.ApiEvents.invoke.unregisterMask,function(t){e.unregister(t)})},o.ProxyConnector.instance.connect("messageMasking",null,this.setupProxy)}return Object.defineProperty(e,"instance",{get:function(){return e.init()},enumerable:!0,configurable:!0}),e.init=function(){return e._instance||(e._instance=new e)},Object.defineProperty(e.prototype,"empty",{get:function(){return!this.masks.length},enumerable:!0,configurable:!0}),e.prototype.register=function(e,t,n){var r=this.masks.find(function(n){return n.pattern==e&&n.rule==t});r?r.replacement!=n&&(r.replacement=n):this.masks.push(new a(e,t,n))},e.prototype.unregister=function(e,t){this.masks.forEach(function(n,r,i){n.pattern!=e||t&&n.rule!==t||i.splice(r,1)})},e.prototype.shouldMask=function(e){if(this.empty)return!1;for(var t,n=0,r=this.masks;n<r.length;n++){var i=r[n];if(t=e.search(i.pattern)>-1)break}return t},e.prototype.process=function(e){return this.masks.forEach(function(t){return e=t.replace(e)}),e},e}();t.Masks=c},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(65);n(114),n(87),n(64);var i=n(3),o=r.default.build("SkypeWebControl",window);t.default=o.services=o.services||i.default},,,function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=n(36),a=n(8),c=function(e){function t(t,n){var r=e.call(this,"kpi_file_upload",t)||this,i=n.name.match(/\.([a-zA-Z\d]*)$/i);return r.size=n.size,r.fileType=i?i[1]:a.NA,r}return i(t,e),t.prototype.getCustomProperties=function(){var t=e.prototype.getCustomProperties.call(this);return t.push(o.TelemetryPropertyValue.Create("size",this.size)),t.push(o.TelemetryPropertyValue.Create("type",this.fileType)),t.push(o.TelemetryPropertyValue.Create("ttc",this.ttc)),t.push(o.TelemetryPropertyValue.Create("status",this.status)),t.push(o.TelemetryPropertyValue.Create("contentType",this.getContentType())),t},t.prototype.getContentType=function(){switch(this.fileType){case"png":case"jpg":case"gif":case"bmp":case"tiff":return"Picture";case"avi":case"mp4":case"mkv":case"wmv":case"m4v":return"Video";case"mp3":case"cda":case"m4a":case"wav":return"Audio";case"xls":case"xlsx":case"xlsm":case"doc":case"docx":case"ppt":case"pptx":return"MSOffice";case"zip":case"rar":case"ace":case"7z":case"dmg":return"Archive";case"exe":case"msi":case"iso":return"Binary";case"html":case"htm":case"txt":return"Text";case"pdf":return"Pdf";default:return"Other"}},t}(s.ConversationDataEvent);t.default=c},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){void 0===t&&(t=!1);var n=e.call(this)||this;return n._useAms=!1,n._amsService=n.getServices().amsService,n._sharepointService=n.getServices().sharepointService,n._useAms=!!t,n._authenticated=!1,n}return i(t,e),t.prototype.sendFile=function(e,t){return this._useAms?this.sendFileViaAms(e,t):this.sendFileViaSharepoint(e,t)},t.prototype.sendFileViaAms=function(t,n){return e.prototype.sendFile.call(this,t,n)},t.prototype.sendFileViaSharepoint=function(t,n){var r=this;if(this._amsService.isDocumentTypeImage(n.type))return e.prototype.sendFile.call(this,t,n);return this._sharepointService.uploadFile(n).then(function(e){var n=r.getServices().contactsService,i=[];t.members.forEach(function(e){i.push(n.getContact("",e.id))});Promise.all(i).then(function(n){var i=[];n.forEach(function(e){e&&e.email&&i.push(e.email)}),r._sharepointService.shareFile(e.objectUrl,i).then(function(n){return i=[{"@type":"http://schema.skype.com/File",version:2,id:(r=e).objectId,baseUrl:r.siteInfo.siteUrl,type:r.type,title:r.title,state:"active",objectUrl:r.objectUrl,providerData:'{"code":null,"type":0}',itemid:r.objectId,fileName:r.title,fileType:r.type,fileInfo:{fileUrl:r.objectUrl,siteUrl:r.siteInfo.siteUrl,serverRelativeUrl:r.siteInfo.relativeUrl},botFileProperties:{},filePreview:{},fileChicletState:{serviceName:"p2p",state:"active"}}],void t.sendFileAsProperty({files:i});var r,i})})}),Promise.resolve()},t}(n(135).default);t.TeamsAmsManager=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(250),s=n(102),a="imgt1",c="imgpsh_fullsize",u="original",l=0,p=500,d=3,f=function(){return function(){var e=this;this.createNewDocument=function(t,n){var r={type:e.getDocumentTypeFromContentType(n.type),permissions:{}};return r.filename=n.name,r.permissions[t]=[o.Permission[o.Permission.read]],s.post("createNewDocument","objects",JSON.stringify(r)).then(function(e){return e.json()})},this.sendFile=function(t,n){var r="objects/"+t+"/content/"+(e.isDocumentTypeImage(n.type)?"imgpsh":"original");return s.putData("sendFile",r,n)},this.downloadPictureThumbnail=function(t){var n=r.default.AMS_HOST_URL+"objects/"+t;return new Promise(function(t){e.getViewStatus(n,a).then(function(e){s.getData("downloadPictureThumbnail",e).then(t)})})},this.downloadFile=function(t){return new Promise(function(n){e.getViewStatus(t,u).then(function(e){return s.getData("downloadPicture",e).then(n)})})},this.downloadPicture=function(t){var n=r.default.AMS_HOST_URL+"objects/"+t;return new Promise(function(t){e.getViewStatus(n,c).then(function(e){return s.getData("downloadPicture",e).then(t)})})},this.getPictureThumbnail=function(e){return new Promise(function(t){return s.get("getPictureThumbnail",e).then(function(e){return s.parseJson(e)}).then(t)})},this.authenticate=function(){return new Promise(function(e){i.default.signInManager.getSkypeToken().then(function(t){var n="skypetoken="+t;return s.postForm("authenticate","skypetokenauth",n).then(e)},function(){})})},this.logout=function(){return s.get("logout","skypetokenauth/expire")},this.isDocumentTypeImage=function(e){return-1!==e.indexOf("image")},this.getDocumentTypeFromContentType=function(t){return e.isDocumentTypeImage(t)?"pish/image":"sharing/file"},this.getViewStatus=function(t,n,r,i){void 0===r&&(r=l),void 0===i&&(i=d);var o=t+"/views/"+n,a=o+"/status";if(0===i)return Promise.reject({});var c=function(s){if(s.view_location)return Promise.resolve(s.view_location);var a=s.scan&&"in progress"!==s.scan.status&&"ready"!==s.scan.status,c="ready"===s.view_state&&!s.scan,u="ready"===s.view_state&&s.scan&&"passed"===s.scan.status;return s.status_location&&!s.view_state?(t=s.status_location.replace("/views/"+n+"/status",""),e.getViewStatus(t,n,r,i)):c||u?Promise.resolve(o):"failed"===s.view_state||a?Promise.reject({}):"expired"!==s.content_state?e.getViewStatus(t,n,p,i):Promise.reject({})},u=function(o){return 401===o.status||403===o.status?(i--,e.authenticate().then(function(){return e.getViewStatus(t,n,r,i)})):Promise.reject({})};return new Promise(function(e){setTimeout(e,r)}).then(function(){return s.getJson("getViewStatus",a).then(c,u)})}}}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.read=0]="read"}(t.Permission||(t.Permission={}))},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(57),s=n(5),a=n(8);t.NA="n/a";var c=function(e){function t(t,n,r,i,s){var a=e.call(this,"service_qos")||this;return a.ttsSuccess=0,a.ttsFailure=0,a.successCount=0,a.totalCount=0,a.serviceName=t,a.requestLength=r,a.responseStatus=i,a.requestType=s,n&&(a.protocol=o.default.extractProtocol(n),a.domain=o.default.extractHostname(n),a.path=o.default.extractPath(n),a.queryParams=o.default.extractQuery(n)),a}return i(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(s.TelemetryPropertyValue.Create("serviceName",this.serviceName)),e.push(s.TelemetryPropertyValue.Create("protocol",this.protocol)),e.push(s.TelemetryPropertyValue.Create("domain",this.domain)),e.push(s.TelemetryPropertyValue.Create("path",this.path)),e.push(s.TelemetryPropertyValue.Create("queryParams",this.queryParams)),e.push(s.TelemetryPropertyValue.Create("requestLength",this.requestLength)),e.push(s.TelemetryPropertyValue.Create("responseStatus",this.responseStatus)),e.push(s.TelemetryPropertyValue.Create("requestType",this.requestType)),e.push(s.TelemetryPropertyValue.Create("successCount",this.successCount)),e.push(s.TelemetryPropertyValue.Create("totalCount",this.totalCount)),e.push(s.TelemetryPropertyValue.Create("ttsSuccess",this.ttsSuccess)),e.push(s.TelemetryPropertyValue.Create("ttsFailure",this.ttsFailure)),e},t}(a.TelemetryEvent);t.default=c},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),s=n(3),a=n(5),c=function(e){function t(){return e.call(this,"service_fault_qos")||this}return i(t,e),t.report=function(e,n,r,i){n=n||{};var a=new t;a.serviceName=e,a.errorCode=n.status,a.errorMessage=n.statusText||n.message,n.headers&&"function"==typeof n.headers.get&&(a.contextId=n.headers.get("contextid")||n.headers.get("X-Skype-Caller")||n.headers.get("X-Skype-Request-Id")),a.setServiceHost(n.url||i),a.tts=r,a.isZombie=s.default.isZombie;try{o.swc.services.telemetryManager.sendEvent(a)}catch(e){}},t.prototype.getCustomProperties=function(){var e=new Array;return e.push(a.TelemetryPropertyValue.Create("serviceName",this.getProperty(this.serviceName))),e.push(a.TelemetryPropertyValue.Create("errorCode",this.getProperty(this.errorCode))),e.push(a.TelemetryPropertyValue.Create("errorMessage",this.getProperty(this.errorMessage))),e.push(a.TelemetryPropertyValue.Create("isZombie",this.getProperty(this.isZombie))),e.push(a.TelemetryPropertyValue.Create("serviceHost",this.getProperty(this.serviceHost))),e.push(a.TelemetryPropertyValue.Create("contextId",this.getProperty(this.contextId))),e.push(a.TelemetryPropertyValue.Create("tts",this.getProperty(this.tts))),e},t.prototype.setServiceHost=function(e){var t;e&&(t=(t=(t=e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0]).split("?")[0],this.serviceHost=t)},t}(n(8).TelemetryEvent);t.ServiceFaultEvent=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(3);t.getHeaders=function(){var e=new Headers,t=r.default.getClientVersion();return new Promise(function(n){i.default.signInManager.getSkypeToken().then(function(i){e.append("Authorization","skype_token "+i),r.default.ECS.version&&e.append("X-MS-Client-Version",t),n(e)},function(){})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(255),o=function(){function e(){var e=this;this._agents={},this.addAgentToContacts=function(e,t){var n="relationship/"+t+"/"+e;return i.put("addAgentToContacts",n)},this.getAgentDetails=function(t){if(e._agents[t])return Promise.resolve({agentDescriptions:[e._agents[t]]});var n="agents?agentId="+t;return i.get("getAgentDetails",n).then(function(t){return t&&t.agentDescriptions&&t.agentDescriptions.forEach(function(t){e._agents[t.agentId]=t;var n=r.default.persons.getPerson("28:"+t.agentId);n.displayName=t.displayName,n.avatarData=t.userTileSmallUrl||t.userTileStaticUrl||""}),t})},this.searchAgents=function(t){var n="agents?q="+t;return i.get("searchAgents",n).then(function(t){return t&&t.agentDescriptions&&t.agentDescriptions.forEach(function(t){e._agents[t.agentId]=t;var n=r.default.persons.getPerson("28:"+t.agentId);n.displayName=t.displayName,n.avatarData=t.userTileSmallUrl||t.userTileStaticUrl||""}),t})}}return Object.defineProperty(e.prototype,"agents",{get:function(){return this._agents},enumerable:!0,configurable:!0}),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(16),o=n(256),s={retryCount:3,timeout:12e4,policy:""};t.get=function(e,t){return o.getHeaders().then(function(n){var o={method:"GET"};return o.headers=n,function(e,t,n){return i.default("aps-"+e,s,r.default.APS_HOST_URL+t,n).then(function(e){return e.json()})}(e,t,o)})},t.put=function(e,t,n){return void 0===n&&(n=""),o.putHeaders().then(function(o){var a={method:"PUT"};return a.body=n,a.headers=o,function(e,t,n){return i.default("aps-"+e,s,r.default.APS_HOST_URL+t,n)}(e,t,a)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.getHeaders=function(){var e=new Headers;return new Promise(function(t){r.default.signInManager.getSkypeToken().then(function(n){e.append("X-Skypetoken",n),e.append("Pragma","no-cache"),e.append("Cache-Control","no-cache, no-store, must-revalidate"),t(e)},function(){})})},t.putHeaders=function(){var e=new Headers;return new Promise(function(t){r.default.signInManager.getSkypeToken().then(function(n){e.append("X-Skypetoken",n),t(e)},function(){})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(258),o=function(){function e(){this.arrayBufferToBase64=function(e){var t="";return[].slice.call(new Uint8Array(e)).forEach(function(e){return t+=String.fromCharCode(e)}),window.btoa(t)},this.authenticate()}return e.prototype.authenticate=function(){var e=this;if(this.authenticationPromise)return this.authenticationPromise;return this.authenticationPromise=i.postRaw("cookie","/beta/imageauth/cookie"),this.authenticationPromise.then(function(){setTimeout(function(){e.authenticationPromise=null},54e4)}),this.authenticationPromise},e.prototype.fetchAvatars=function(e,t){var n=this,r="/beta/users/"+e+"/profilepicturev2",o={displayname:t,voidCache:"true"},s=i.addGetParamsToUrl(r,o);return this.authenticate().then(function(){return i.getRaw("avatars",s).then(n.getValueFromBuffer.bind(n))},this.resetAuth.bind(this))},e.prototype.fetchMergedAvatars=function(e){var t=this,n=e.filter(function(e){return e.userId!==r.default.mePerson.mri});n.length>4&&(n=n.slice(0,3));var o="/beta/users/mergedProfilePicturev2?usersInfo="+encodeURIComponent(JSON.stringify(n))+"&size=HR64x64&voidCache=true";return this.authenticate().then(function(){return i.getRaw("mergedAvatars",o).then(t.getValueFromBuffer.bind(t))},this.resetAuth.bind(this))},e.prototype.resetAuth=function(){this.authenticationPromise=null},e.prototype.getValueFromBuffer=function(e){var t=this;return e.arrayBuffer().then(function(e){return"data:image/jpeg;base64,"+t.arrayBufferToBase64(e)})},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(16),o=n(259),s={retryCount:3,timeout:12e4,policy:""},a=function(e,t,n){return i.default("avatar-"+e,s,r.default.AVATAR_SERVICE_URL+t,n)};t.get=function(e,n){return t.getRaw(e,n).then(function(e){return e.json()})},t.getRaw=function(e,t){return o.getHeaders().then(function(n){var r={method:"GET"};return r.headers=n,r.cache="no-cache",r.credentials="include",a(e,t,r)})},t.post=function(e,n){return t.postRaw(e,n).then(function(e){return e.json()})},t.postRaw=function(e,t){var n="cookie"===e;return o.getHeaders(n).then(function(n){var r={method:"POST"};return r.headers=n,r.cache="no-cache",r.credentials="include",a(e,t,r)})};var c=n(104);t.addGetParamsToUrl=c.addGetParamsToUrl},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(2),o=n(13),s=n(3);t.getHeaders=function(e){return void 0===e&&(e=!1),r.default.get.backend===o.MessagingBackend.TEAMS?s.default.signInManager.aad().then(function(t){var n=new Headers;return e&&n.append("authorization",t),n.append("x-ms-client-type","web"),n.append("x-ms-user-type","user"),n}):new Promise(function(e){s.default.signInManager.getSkypeToken().then(function(t){var n=new Headers;n.append("x-skypetoken",t),n.append("x-skype-client",i.default.getClientVersion()),e(n)},function(){})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(6),o=n(2),s=n(13),a=n(3),c=!1,u=function(e){return{value:null,expiry:null,failureCount:e.value?e.failureCount+1||1:e.failureCount||0}};t.handleRegTokenExpiry=function(e){var t=403===e.status&&(!e.headers||"Quarantine limit Exceeded"!==e.headers.get("StatusText")),n=401===e.status;return t||n?(r=u(r),a.default.storage.setItem(o.default.SKYPE_REGTOKEN_KEY,JSON.stringify(r)),a.default.signInManager.checkAuthFailuresCount(r.failureCount),Promise.reject(e)):Promise.resolve(e)},t.handleSkypeTokenExpiry=function(e){return 401===e.status?(a.default.signInManager.logout("services:401"),Promise.reject(e)):Promise.resolve(e)},t.processHeaders=function(e){var t=e.headers.get("set-registrationtoken");if(t){var n=t.match(/registrationToken=(.+); expires=(\d+)/);n&&(r.value=n[1],r.expiry=parseInt(n[2],10),r.expiry<1e10&&(r.expiry*=1e3),delete r.failureCount,a.default.storage.setItem(o.default.SKYPE_REGTOKEN_KEY,JSON.stringify(r)))}return e},t.getHeaders=function(){c&&r.expiry<Date.now()&&(r=u(r));var e={};i.default.get.backend===s.MessagingBackend.TEAMS&&(e["x-ms-user-type"]="user",e["x-ms-client-type"]="web");var t=function(){return r.value?(e.RegistrationToken="registrationToken="+r.value,Promise.resolve(e)):new Promise(function(t,n){a.default.signInManager.getSkypeToken().then(function(n){e.Authentication="skypetoken="+n,t(e)},function(){return n()})})};return c?t():a.default.signInManager.onceSignedIn().then(function(){return function(){var e,t=null;if(!r){try{t=sessionStorage.getItem(o.default.SKYPE_REGTOKEN_KEY)}catch(e){}if(t)try{e=JSON.parse(t)}catch(e){}r=e&&e.value&&e.expiry?e:{value:null,expiry:null}}c=!0}(),t()})},t.reset=function(){r={value:null,expiry:null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(41),i=n(11),o=n(26),s=n(10),a=function(){function e(){}return e.strip=function(e){var t=e.match(this.idRegExp);return t?t[2]:e},e.detectConversationType=function(e){if(!e)return r.ConversationType.UNDEFINED;if(this.typeMapppings[e])return this.typeMapppings[e];var t,n=e.match(this.idRegExp);if(n&&(t=this.getTypeByPrefix(n[1])),t)return this.typeMapppings[e]=t,t;if(0===e.indexOf("https://join.skype.com/"))return this.typeMapppings[e]=r.ConversationType.JOIN,r.ConversationType.JOIN;if(/^(28:)?[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i.test(e))return this.typeMapppings[e]=r.ConversationType.AGENT,r.ConversationType.AGENT;if(/^(19:)?[\S]+[@]([\S].)?[\S]*thread\.skype/i.test(e))return this.typeMapppings[e]=r.ConversationType.GROUP,r.ConversationType.GROUP;if(/(?:00|\+)?(^[^a-z][^A-Z])(\d+$)/i.test(e.replace(/\s+|[()\-\+]/gi,"")))return this.typeMapppings[e]=r.ConversationType.PHONE,r.ConversationType.PHONE;return/^(99:)?([A-Z]|[a-z][^\.])+([\S])*\.(cwA|dAA)/i.test(e)?(this.typeMapppings[e]=r.ConversationType.DIRECT_LINE,r.ConversationType.DIRECT_LINE):(this.typeMapppings[e]=r.ConversationType.PERSON,r.ConversationType.PERSON)},e.getSdkModeFromId=function(e){switch(this.detectConversationType(e)){case r.ConversationType.PERSON:return o.SDKMode.PERSON;case r.ConversationType.AGENT:return o.SDKMode.BOT;case r.ConversationType.JOIN:return o.SDKMode.JOIN_URL;case r.ConversationType.DIRECT_LINE:return o.SDKMode.DIRECT_LINE_TOKEN;case r.ConversationType.PHONE:return o.SDKMode.PHONE;case r.ConversationType.GROUP:return o.SDKMode.THREAD}return o.SDKMode.UNDEFINED},e.toFullIdentifier=function(e){var t=this.getPrefixForId(e);return 0===e.indexOf(t+":")?e:t?t+":"+e:e},e.addPrefix=function(e,t){return 0===t.indexOf(e+this.SPLITTER)?t:0===t.indexOf(this.SPLITTER)?e+t:e+this.SPLITTER+t},e.getNormalizeId=function(e){return e.match(this.idRegExp)?e.replace(/\d{1,2}:/,""):e},e.isEqual=function(e,t){return this.toFullIdentifier(e).toLowerCase()===this.toFullIdentifier(t).toLowerCase()},e.getPrefixForId=function(e){if(this.hasAlreadyPrefix(e))return"";var t=this.getSdkModeFromId(e);switch(t){case o.SDKMode.PERSON:return"8";case o.SDKMode.BOT:return"28";case o.SDKMode.THREAD:return"19";case o.SDKMode.DIRECT_LINE_TOKEN:return"99";case o.SDKMode.PHONE:return"4";default:i.default.throwError(s.ErrorCodes.ERR_DEFINE_CONVERSATION_PREFIX,"Unable to define conversation prefix",{id:e,sdkMode:t})}return""},e.getTypeByPrefix=function(e){if(!e)return r.ConversationType.UNDEFINED;switch(e.indexOf(":")>-1&&(e=e.replace(":","")),e){case"4":return r.ConversationType.PHONE;case"8":return r.ConversationType.PERSON;case"19":return r.ConversationType.GROUP;case"28":return r.ConversationType.AGENT;case"99":return r.ConversationType.DIRECT_LINE;default:return r.ConversationType.UNDEFINED}},e.hasAlreadyPrefix=function(e){var t=/^\d+:/.exec(e);return!!t&&!!t[0]},e.SPLITTER=":",e.idRegExp=/(\d{1,2}:)([\S]*)/,e.typeMapppings={},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(45),o=function(){function e(){var e=this;this.registrations={},this.setupProxy=function(){e.events.registerEvent(r.ApiEvents.threadNotificationsProxy.reg,function(t){return e.register(t.botId,t.conversationId)}),e.events.registerEvent(r.ApiEvents.threadNotificationsProxy.unreg,function(t){return e.unregister(t.botId,t.conversationId)})},this.events=window.swc.API,i.ProxyConnector.instance.connect("threadNotifications",null,this.setupProxy)}return Object.defineProperty(e,"instance",{get:function(){return e.init()},enumerable:!0,configurable:!0}),e.init=function(){return e._instance||(e._instance=new e)},Object.defineProperty(e.prototype,"empty",{get:function(){return!Object.keys(this.registrations).length},enumerable:!0,configurable:!0}),e.prototype.register=function(e,t){var n=this.registrations[e]=this.registrations[e]||[];t&&-1===n.indexOf(t)&&n.push(t)},e.prototype.unregister=function(e,t){var n=this.registrations[e];if(n)if(t){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}else delete this.registrations[e]},e.prototype.notify=function(e,t,n){var i=this.registrations[e];!i||i.length&&-1===i.indexOf(t)||this.events.triggerEvent(r.ApiEvents.threadNotificationsProxy.notify,{botId:e,message:n})},e}();t.ThreadNotifications=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=null,o=1;function s(){r&&clearTimeout(r)}t.execute=function(e){s(),null===i&&(i=1e3),r=setTimeout(e,i+.5*Math.random()*i),i<12e4&&(i*=++o)},t.stop=function(){s()},t.reset=function(){s(),i=null,o=1}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(21),s=n(10),a=n(11),c=n(265),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setEndpointPresence=function(){if(o.getServices().signInManager.isAadSupported())try{var e=o.getServices().mePerson.mri;c.presence.subscribe(e,t.handleNotifications),c.presence.startPolling()}catch(e){a.default.throwError(s.ErrorCodes.ERR_UNIFIED_PRESENCE_FAILED,"Presence init failed.")}return Promise.resolve()},t.handleNotifications=function(e){e.etagMatch||("Self"===e.presence.sourceNetwork&&e.presence.deviceType===c.DeviceType.Desktop?o.getServices().notificationsManager.disableNotifications():o.getServices().notificationsManager.enableNotifications())},t}return i(t,e),t.prototype._getInterestedResources=function(){return["/v1/users/ME/conversations/ALL/properties","/v1/users/ME/conversations/ALL/messages","/v1/threads/ALL","/v1/users/ME/contacts/ALL"]},t}(n(139).Polling);t.PollingTeams=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(266);!function(e){e.Mobile="Mobile",e.Desktop="Desktop",e.Web="Web"}(t.DeviceType||(t.DeviceType={}));var i=function(){function e(){var e=this;this.subscriptions={},this.start=function(){e.pollInterval||(e.pollInterval=setInterval(e.poll,2e4))},this.stop=function(){clearInterval(e.pollInterval),e.pollInterval=void 0},this.getUsers=function(){return Object.keys(e.subscriptions).map(function(t){return{mri:t,etag:e.subscriptions[t].etag||""}})},this.handlePoll=function(t){return t.forEach(function(t){e.subscriptions.hasOwnProperty(t.mri)&&(e.subscriptions[t.mri].etag=t.etag,e.subscriptions[t.mri].handlers.forEach(function(e){return e(t)}))}),t},this.poll=function(){var n=e.getUsers();return n?t.presence.pollPresence(n).then(e.handlePoll):Promise.resolve([])}}return e.get=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.subscribe=function(e,t){this.subscriptions[e]||(this.subscriptions[e]={handlers:[]}),this.subscriptions[e].handlers.push(t)},e}();t.presence={getMeEndpoints:function(){return r.get("Presence.getMeEndpoints","/me/endpoints")},pollPresence:function(e){return r.post("Presence.pollPresence","/presence/getpresence",JSON.stringify(e))},subscribe:function(e,t){i.get().subscribe(e,t)},startPolling:function(){i.get().start()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(21),o=n(10),s=n(11),a=n(20),c=n(3),u=n(55),l=n(16),p={baseUrl:"https://presence.teams.microsoft.com/v1"},d={retryCount:3,timeout:12e4,policy:""},f=function(e,t,n){return l.default("presence-"+e,d,p.baseUrl+t,n).then(function(r){if(404===r.status){var i=r.headers.get("location");if(i){var o=/^(https:\/\/[^\/]+\/v1)/g.exec(i)[0];return p.baseUrl=o,l.default("presence-"+e,d,p.baseUrl+t,n)}}return r})},h=function(e){void 0===e&&(e=u.AadAudience.Presence);return i.getServices().signInManager.isAadSupported()?Promise.all([c.default.signInManager.aad(e),c.default.signInManager.getSkypeToken()]).then(function(e){var t=e[0],n=(e[1],new Headers);return n.append("Authorization",t),n.append("Accept","application/json"),n.append("x-skype-client",r.default.getClientVersion()),n.append("x-ms-correlation-id",a.guid.generate()),n.append("x-ms-client-type","Web"),n.append("x-ms-client-version",r.default.getClientVersion()),n.append("x-ms-client-user-agent","swc"),n.append("content-type","application/json;charset=UTF-8"),n.append("BehaviorOverride","redirectAs404"),n}):(s.default.throwError(o.ErrorCodes.ERR_UNIFIED_PRESENCE_NO_AAD,"Unable to get AAD Token"),Promise.reject("Unable to get AAD Token"))};t.post=function(e,t,n){return h().then(function(r){return f(e,t,{method:"POST",cache:"no-cache",headers:r,body:n}).then(function(e){return e.json()})})},t.get=function(e,t){return h().then(function(n){var r={method:"GET"};return r.headers=n,f(e,t,r).then(function(e){return e.json()})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var n=this;this.execCallback=function(){if(n._callback){var e=n.reset.bind(n);return n._callback().then(e,e)}return n.reset(),Promise.resolve()},this.reset=function(){n._callback=null,n._toRelogin=!1},this.setContext(e,t)}return e.prototype.setContext=function(e,t){this._toRelogin=e,this._callback=t},Object.defineProperty(e.prototype,"canRelogin",{get:function(){return this._toRelogin},enumerable:!0,configurable:!0}),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(16),o={retryCount:3,timeout:12e4,policy:""},s=function(){function e(){}return e.getGuestToken=function(t){var n={name:t};return new Promise(function(t,r){e.request("POST","users/guests/lwc",n).then(function(e){e.json().then(function(e){t(e)}).catch(function(e){r(e)})},function(e){r(e)})})},e.request=function(e,t,n){var s={};s.method=e,s.body=JSON.stringify(n);var a=new Headers;return a.append("Content-Type","application/json"),a.append("X-Skype-Caller",r.default.getUiVersion()),s.headers=a,i.default("scom-invite",o,r.default.INVITE_HOST_URL+t,s)},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(16),o={retryCount:3,timeout:12e4,policy:""},s=function(){function e(){}return e.exchangeForSkypeToken=function(e){var t={method:"post",headers:{Authorization:e,"x-ms-client-type":"web","x-ms-user-type":"user"}};return i.default("teams-exchange",o,r.default.TEAMS_URL+"beta/auth/skypetoken",t)},e.fetchGuestTokenForTenant=function(e){var t={method:"post",body:JSON.stringify({tenantId:e})};return i.default("teams-anonymout",o,r.default.TEAMS_AUTH_URL+"v1.0/authz/visitor",t)},e}();t.default=s},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=n(8),a=function(e){function t(){return e.call(this,"qos_signin_complete")||this}return i(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(o.TelemetryPropertyValue.Create("status",this.status)),e.push(o.TelemetryPropertyValue.Create("origin",this.authOrigin)),e.push(o.TelemetryPropertyValue.Create("ttc",this.ttc>=0?this.ttc:s.NA)),e.push(o.TelemetryPropertyValue.Create("errorMessage",this.errorMessage||s.NA)),e},t}(s.TelemetryEvent);t.SignInEvent=a},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=n(8),a=function(e){function t(){return e.call(this,"qos_signout_complete")||this}return i(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(o.TelemetryPropertyValue.Create("status",this.status||s.NA)),e.push(o.TelemetryPropertyValue.Create("origin",this.origin||s.NA)),e.push(o.TelemetryPropertyValue.Create("ttc",this.ttc>=0?this.ttc:s.NA)),e.push(o.TelemetryPropertyValue.Create("errorMessage",this.errorMessage||s.NA)),e},t}(s.TelemetryEvent);t.SignOutEvent=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.Cache=10]="Cache",e[e.SilentLogin=20]="SilentLogin",e[e.Popup=30]="Popup",e[e.Guest=40]="Guest",e[e.UserLogout=50]="UserLogout",e[e.External=60]="External",e[e.WX=70]="WX",e[e.AAD=80]="AAD"}(t.AuthSource||(t.AuthSource={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.isRelogin=!1}return e.prototype.reset=function(){this.isRelogin=!1,this.signoutPromise=null},e}();t.default=r},function(e,t){!function(){"use strict";var e,t,n,r,i,o,s,a,c,u,l,p,d,f,h,g,m,_,y;void 0===window.SKYPE&&(window.SKYPE={}),window.SKYPE.login=window.SKYPE.login||{},window.SKYPE.login.Silent=(n={qa:"https://a.qa.lw.skype.net",live:"https://a.lw.skype.com"},r=null,i={},o=null,s=null,a="",c=!1,u=!1,l=null,p={env:"live",client_id:null,redirect_uri:null},d=function(e,t){if(null===l&&(l=window.location.host.match(/^(pre|dev|qa).*\.net$/)||document.cookie.indexOf("debug")>-1||window.location.search.indexOf("debug")>-1),l)try{if("object"==typeof t){var n=[];for(var r in t)"skypetoken"===r?n.push(r+": <HIDDEN>"):n.push(r+": "+JSON.stringify(t[r]));e+=" - "+n.join(", ")}else"string"==typeof t&&(e+=" - "+t);e="[silentlogin.js] - "+e}catch(e){}},f=function(e){if(d("Received message from "+e.origin),s&&e.origin===s){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){}d("Message data",t);var n=t.state||null;if(a===n){for(var r in window.clearTimeout(o),i={},t)t.hasOwnProperty(r)&&(i[r]=t[r]);g()}else d("State "+n+" doesn't match the last submitted state "+a)}},h=function(){r&&(e.removeChild(r),r=null)},g=function(){d("Calling callback function",i),u=!1,"function"==typeof t&&t(i)},m=function(){h(),(i={}).error="timeout",g()},_=function(){var e=(new Date).getTime(),t=n;a="silentloginsdk_"+e;var r={response_type:"postmessage",client_id:p.client_id,partner:"999",redirect_uri:p.redirect_uri,state:a,_accept:"1.0",_nc:e};return(s=t[p.env]||t.live)+"/login/silent?"+function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}(r)},{init:function(e){if("object"==typeof e)for(var t in(e=e||{}).hasOwnProperty("callback")&&y(e.callback),p)e.hasOwnProperty(t)&&(p[t]=e[t]);return c||(c=!0,window.addEventListener?window.addEventListener("message",f,!1):window.attachEvent("onmessage",f)),this},setCallback:y=function(e){return"function"==typeof e&&(t=e),this},load:function(){if(!u){if(function(){if(!p.client_id)throw"[silentlogin.js] client_id not initialized. Call init() first.";p.redirect_uri||(p.redirect_uri=window.location.protocol+"//"+window.location.host+window.location.pathname)}(),u=!0,!("postMessage"in window&&"object"==typeof JSON&&JSON.parse))return i={error:"unsupported_browser"},void g();var t;window.clearTimeout(o),o=window.setTimeout(m,2e4),t=_(),h(),void 0===e&&(e=document.body||document.head||document.getElementsByTagName("head")[0]),(r=document.createElement("iframe")).frameBorder=0,r.width="1px",r.height="1px",r.style.display="none",r.style.visibility="hidden",r.id="silentLoginFrame"+Math.floor(10*Math.random()+1),r.setAttribute("src",t),e.appendChild(r),d("Created iFrame: "+t)}},getSkypetoken:function(){return i.skypetoken||null},getFullResponse:function(){return i}})}()},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s=n(6),a=n(18),c=n(40),u=n(13),l=n(0),p=n(14),d=n(42),f=n(3),h=n(141),g=n(58),m=n(276),_=n(47),y={Text:1,RichText:1,"RichText/UriObject":1,"RichText/Media_GenericFile":1,"Event/Call":1,"Signal/Flamingo":1,"RichText/Html":1},v={"Event/Call":1,"Signal/Flamingo":1},b={CallEndMsg:1,MissedCallMsg:1,MissedGroupCallMsg:1,CallMsg:1},P=function(e){function t(t){var n=e.call(this)||this;return n._avatar="",n._isBlocked=!1,n._contentRegisteredToHitAlert=function(e){var t=!1,r=e.alertmatches?e.alertmatches.split(" "):[];if(E(e))for(var i=n.lastMessage.content&&n.lastMessage.content.toLowerCase(),o=0;o<r.length;o++)i.indexOf(r[o].toLowerCase())>-1&&(t=!0);return t},n._showNotification=function(e){return!(!n.isUnread||n.isBlocked)&&(!!n._contentRegisteredToHitAlert(e)||!n.alertsOff)},n._isConversationUnread=function(e,t,r){return!n.isPstn&&(r.customType&&b[r.customType]?n._isUnread:!!y[r.messagetype]&&(!w(r)&&(!!r.content&&(!t.consumptionhorizon&&"AcceptPendingRecipient"===t.conversationstatus||!T(t.consumptionhorizon,r)&&(!v[r.messagetype]||n._isUnread)))))},n._isRawConversationUnread=function(e){return n._isConversationUnread(e.id,e.properties,e.lastMessage)},n._id=t.id,n.isPstn=n._id.indexOf("4:")>-1,n.isAgent=n.id.indexOf("28:")>-1||n.id.indexOf("99:")>-1,n._lastMessage=t.lastMessage,n._isUnread=n._isRawConversationUnread(t),n._properties=t.properties,n._alertsOff=E(t.properties),n._isBlocked=S(t.properties),n._threadProperties=t.threadProperties,n._participants=new c.ObservableCollection,n.fillWithData(t),n}return i(t,e),t.prototype.setTeamsTitle=function(e){var t=this;if(!e||!e.topic)return this.topic;var n=e.topic;n&&n.indexOf(f.default.mePerson.mri)>-1&&(n=(n=n.replace(f.default.mePerson.mri+", ","")).replace(", "+f.default.mePerson.mri,""));var r=n&&n.match(/\d+\:?[a-zA-Z]{0,}\:[a-zA-Z0-9\-_]+/g),i=n;return r&&r.forEach(function(e){var n=f.default.persons.getPerson(e,!0);if(n.displayName)i=i.replace(e,n.displayName);else{var r=function(){n.unsubscribe("displayName",r),t.topic=t.topic.replace(e,n.displayName)};n.subscribe("displayName",r)}}),this.topic=i||this.topic,this.topic},t.prototype.setTeamsGroupAvatar=function(e){e&&!this.avatar&&(this._groupAvatarHelper||(this._groupAvatarHelper=new m.default(this)),this._groupAvatarHelper.members=e,this._groupAvatarHelper.fetch())},t.prototype.fillWithData=function(e){var t=this;if(this.isGroup){var n=e.threadProperties&&e.threadProperties.picture?e.threadProperties.picture:"";if(n?this.avatar=n:s.default.get.backend===u.MessagingBackend.TEAMS&&e.members&&this.setTeamsGroupAvatar(e.members),s.default.get.backend===u.MessagingBackend.TEAMS?this.setTeamsTitle(e.threadProperties):this.topic=e.threadProperties?e.threadProperties.topic:"",e.threadProperties&&e.threadProperties.members){var r=void 0;try{r=JSON.parse(e.threadProperties.members)}catch(e){}if(!r||!r.length)return;r.forEach(function(e){if("string"==typeof e){var n=f.default.persons.getPerson(e,!0);if(!t.participants.some(function(e){return e.person.id===n.id})){var r=new g.default(n);t.participants.pushObservable(r),n.isAgent&&l.swc.API.triggerEvent(o.ApiEvents.BotAddedToThread,n.id)}}})}}else{var i=f.default.persons.getPerson(e.id,!0);i&&(this.avatar=i.avatarData,this.topic=i.displayName||i.id,this.isBlocked=i.isBlocked,i.subscribe("displayName",function(e){t.topic=e}),i.subscribe("avatarData",function(e){t.avatar=e}),i.subscribe("isBlocked",function(e){t.isBlocked=e}))}this.members=e.members},t.prototype.update=function(e){this._id===e.id&&(e.threadProperties&&(this.topic=s.default.get.backend===u.MessagingBackend.TEAMS?this.setTeamsTitle(e.threadProperties):e.threadProperties.topic||this.topic,e.threadProperties.picture&&(this.avatar=e.threadProperties.picture||this.avatar)),this._properties=e.properties||this._properties,this._threadProperties=e.threadProperties||this._threadProperties,this.isBlocked=S(e.properties),this.updateLastMessage(this._properties,e.lastMessage))},t.prototype.updateThread=function(e){this._id===e.id&&(this.members=e.members,e.properties&&(this.topic=s.default.get.backend===u.MessagingBackend.TEAMS?this.setTeamsTitle(e.properties):e.properties.topic||this.topic,e.properties.picture&&(this.avatar=e.properties.picture.replace("URL@","")||this.avatar),this._historyDisclosed=e.properties.historydisclosed,this._threadProperties=e.properties),s.default.get.backend===u.MessagingBackend.TEAMS&&e.members&&this.setTeamsGroupAvatar(e.members))},t.prototype.updateFromMessage=function(e){this.updateLastMessage(this._properties,e),"ThreadActivity/TopicUpdate"===e.messagetype&&(this.topic=e.threadtopic)},t.prototype.updateLastMessage=function(e,t){var n=this;this.lastMessage=t,this.alertsOff=E(e),this.isUnread=this._isConversationUnread(this.id,e,this.lastMessage),this._showNotification(e)&&setTimeout(function(){n.isUnread&&n._isConversationUnread(n.id,n._properties,n.lastMessage)&&f.default.notificationsManager.registerUnreadMessage(n,t)},3e3)},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topic",{get:function(){return this._topic},set:function(e){e!==this._topic&&(this._topic=p.default.parseTopic(e),this.publish("topic",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"threadProperties",{get:function(){return this._threadProperties},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"members",{get:function(){return this._members},set:function(e){this._members=e,this.publish("members",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"participants",{get:function(){return this._participants},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alertsOff",{get:function(){return this._alertsOff},set:function(e){e!==this._alertsOff&&(this._alertsOff=e,this.publish("alertsOff",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBlocked",{get:function(){return this._isBlocked},set:function(e){e!==this._isBlocked&&(this._isBlocked=e,this.publish("isBlocked",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isUnread",{get:function(){return this._isUnread},set:function(e){e!==this._isUnread&&(this._isUnread=e,this.publish("isUnread",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"avatar",{get:function(){return this._avatar},set:function(e){(e=d.default.resolveConversationAvatar(this.isGroup,e))&&e!==this._avatar&&(this._avatar=e,this.publish("avatar",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastMessage",{get:function(){return this._lastMessage},set:function(e){this._lastMessage=e,this.publish("lastMessage",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isGroup",{get:function(){return/^19:/.test(this.id)},enumerable:!0,configurable:!0}),t.prototype.setConsumptionHorizon=function(e){this._properties.consumptionhorizon=e},t}(a.default);t.ConversationObservable=P,t.default=P;var T=function(e,t){if(!e)return!1;var n=new h.ConsumptionHorizon;n.set(e);var r=t.skypeeditedid||t.clientmessageid||t.messageid||t.id||"0",i=n.lastReadMessageId===r||""===n.lastReadMessageId||n.lastReadMessageId===t.id,o=new Date(t.originalarrivaltime).getTime();t.skypeeditedid&&+t.skypeeditedid>0&&(o=new Date(+t.skypeeditedid).getTime());var s=n.lastReadMessageTimestamp>=o;return i||s},w=function(e){return!!e.from&&_.normalizePersonId(p.default.getSenderIdFromUrl(e.from))===f.default.signInManager.currentUserName},E=function(e){return!!e.alerts&&/false/i.test(e.alerts)},S=function(e){return!!e.conversationblocked&&"true"===e.conversationblocked.toLocaleLowerCase()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=function(){function e(e){var t=this;this.conversation=e,this.missingNamesCount=0,this.timeout=-1,this.displayNameHanlder=function(e,n){t.missingNamesCount--,0===t.missingNamesCount&&t.fetchMergedAvatar(t._selectedPeople)},this.fetchMergedAvatar=function(e){clearTimeout(t.timeout);var n=e.map(function(e){return e.unsubscribe("displayName",t.bindedDsiplayNameHandler),{userId:e.mri,displayName:e.displayName}});r.default.avatarService.fetchMergedAvatars(n).then(function(e){t.conversation.avatar=e||t.conversation.avatar},function(e){})},this.bindedDsiplayNameHandler=this.displayNameHanlder.bind(this)}return e.prototype.fetch=function(){var e=this,t=this.members.filter(function(e){return e.id!==r.default.mePerson.mri});this.members.length>4&&(t=t.slice(0,3)),this._selectedPeople=t.map(function(t){var n=r.default.persons.getPerson(t.id,!0);return n.displayName||(e.missingNamesCount++,n.subscribe("displayName",e.bindedDsiplayNameHandler)),n}),this.missingNamesCount>0?this.timeout=setTimeout(function(){if(e.missingNamesCount>0){var t=e._selectedPeople.filter(function(e){return!!e.displayName});t.length&&e.fetchMergedAvatar(t)}},5e3):this.fetchMergedAvatar(this._selectedPeople)},e}();t.default=i},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n(137),a=n(17),c=n(10),u=n(11),l=n(19),p=n(16),d=n(278),f=n(3),h=n(136),g=n(106),m=n(53),_=[g.ThreadType.Chat,g.ThreadType.SfbInterop],y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.guessThreadType=function(e,t){return 1===t||-1!==e.indexOf("@sfb.unq.gbl.spaces")?g.ThreadType.SfbInterop:g.ThreadType.Chat},t.fetchMessagesByLink=function(e){return-1===e.indexOf("startTime")&&(e=l.default.appendQueryParam(e,"startTime",0)),s.getPolling().authorization.then(function(){return m.getWithDomain("fetchMessagesByLink",e).then(function(e){return m.parseJson(e)})},console.warn)},t}return i(t,e),t.prototype.fetchRecentConversations=function(e,t){var n=this;if(this._fetchRecentsPromise&&this._fetchRecentsPromise.status===a.PromiseStatus.Pending)return this._fetchRecentsPromise.promise;var r=f.default.signInManager.aad("https://chatsvcagg.teams.microsoft.com").then(function(r){return f.default.signInManager.onceSignedIn().then(function(){return p.default("teams-recents",{retryCount:1,timeout:12e4,policy:""},"https://chatsvcagg.teams.microsoft.com/api/v1/teams/users/me/chats?isPrefetch=false&enableMembershipSummary=false",{method:"get",headers:{Authorization:r,"x-ms-client-type":"web","x-ms-user-type":"user"}}).then(function(r){return r?r.json&&r.json().then(function(e){var t=[],r=[],i={};return e.forEach(function(e){var o=n.toSkypeConversation(e);t.push(o),e.members.forEach(function(e){!i[e.mri]&&e.displayName&&(i[e.mri]=!0,r.push(e))})}),{conversations:t,users:r,_metadata:{},hasMoreConversations:!1}},function(r){return n.fetchRecentConversationsFallback(e,t)}):n.fetchRecentConversationsFallback(e,t)},function(r){return n.fetchRecentConversationsFallback(e,t)})},function(){n._fetchRecentsPromise.cancel(),n._fetchRecentsPromise=null})},function(){});return this._fetchRecentsPromise=new a.CancelablePromise(r),this._fetchRecentsPromise.promise},t.prototype.toSkypeConversation=function(e){var t=e.consumptionHorizon,n=t?t.timeStamp+";"+t.originalArrivalTime+";"+t.clientMessageId:void 0,r=e.lastMessage;return{id:e.id,lastMessage:{id:r.id,clientmessageid:r.clientMessageId,from:r.from,messagetype:r.messageType,originalarrivaltime:r.originalArrivalTime,content:r.content,composetime:r.composeTime,version:r.version+"",messageid:r.id},isOneOnOne:e.isOneOnOne,properties:{consumptionhorizon:n,picture:"",lastimreceivedtime:""},threadProperties:{topic:e.title,picture:"",historydisclosed:!0,threadType:this.guessThreadType(e.id,e.interopType)},version:e.version,members:e.members.map(function(e){return{id:e.mri,role:e.role,name:e.displayName}})}},t.prototype.fetchRecentConversationsFallback=function(e,t){var n=this;if(void 0===e&&(e=1),void 0===t&&(t=100),!this._fetchRecentsPromise||this._fetchRecentsPromise.status!==a.PromiseStatus.Pending){return Promise.resolve({conversations:[],_metadata:{},hasMoreConversations:!1})}var r={view:"supportsExtendedHistory|msnp24Equivalent|supportsMessageProperties",pageSize:t,startTime:e};this.syncState?r.syncState=this.syncState:r.targetType="Passport|Skype|Lync|Thread|Agent|ShortCircuit|PSTN|SmsMms|Flxt|NotificationStream|Highlights|Cast|CortanaBot|ModernBots|InviteFree";var i=m.addGetParamsToUrl("users/ME/conversations",r);return m.get("fetchRecents-teams",i).then(function(e){e.ok?n._fetchRecentsPromise.isCanceled||m.parseJson(e).then(function(e){n.syncState=n.getSyncState(e._metadata.syncState);var t=e.conversations.filter(function(e){return e.threadProperties&&(t=e.threadProperties.threadType,_.some(function(e){return e===t}));var t});n.allConversations=n.allConversations.concat(t),n._fetchRecentsPromise.resolve({conversations:n.allConversations,hasMoreConversations:!!e._metadata.backwardLink})}).catch(function(t){u.default.throwError(c.ErrorCodes.ERR_PARSE_RESPONSE2,"fetchRecentConversationsFallback unable to parse response",t),n._fetchRecentsPromise.cancel(e,n.allConversations)}):n._fetchRecentsPromise.cancel(e,n.allConversations)}),this._fetchRecentsPromise=new a.CancelablePromise,this._fetchRecentsPromise.promise},t.prototype.fetchMessages=function(e,t,n){void 0===t&&(t=20),void 0===n&&(n=0);var r={pageSize:t,view:"msnp24Equivalent|supportsMessageProperties",startTime:n},i=m.addGetParamsToUrl("users/ME/conversations/"+e+"/messages",r);return s.getPolling().authorization.then(function(){return m.get("fetchMessages",i).then(function(e){return m.parseJson(e).then(function(e){return e})})})},t.prototype.sendMessage=function(t,n){var r=o({},n,{messagetype:n.messagetype===g.MessagePayloadType.RichText?g.MessagePayloadType.RichTextHtml:n.messagetype});if(d.isInteropEnabled(t)){if(n.messagetype===g.MessagePayloadType.ControlTyping||n.messagetype===g.MessagePayloadType.ControlClearTyping)return Promise.reject("Typing not supported in SFB");r=d.addInteropDataToMessage(t,n)}return e.prototype.sendMessage.call(this,t,r)},t.prototype.deleteMessage=function(e,t){var n="users/ME/conversations/"+e+"/messages/"+t,r=m.addGetParamsToUrl(n,{behavior:"softDelete"});return m.del("deleteMessage",r)},t.prototype.addParticipant=function(e,t,n){var r="threads/"+e+"/members",i={members:[{id:t,role:"Admin",shareHistoryTime:-1}]};return m.post("addParticipant",r,{body:JSON.stringify(i)})},t.prototype.createThread=function(e){e.forEach(function(e){return e.role="Admin"});var t={members:e,properties:{chatFilesIndexId:2,threadType:"chat"}};2===e.length&&(t.properties=o({},t.properties,{fixedRoster:!0,uniquerosterthread:!0}));var n={headers:{"Content-Type":"application/json",Accept:"application/json, text/javascript"},body:JSON.stringify(t)};return m.post("thread","threads",n)},t}(h.ConversationConsumerWebApi);t.ConversationTeamsWebApi=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(279))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(21),i=n(106);t.isInteropEnabled=function(e){return-1!==e.indexOf("@sfb.unq.gbl.spaces")},t.addInteropDataToMessage=function(e,t){try{var n=r.getServices().conversations.get(e,{}),c=s(n).email,u=a(n).mri;return t={clientmessageid:t.clientmessageid,content:t.content,contenttype:t.contenttype,messagetype:i.MessagePayloadType.Text,amsreferences:t.amsreferences||[],imdisplayname:t.imdisplayname,properties:{importance:"",interopType:"receiverSfB",subject:null},fromSipUri:"sip:"+c,toSipUri:"sip:"+o(u)}}catch(e){}return t};var o=function(e){var t=r.getServices().contactsService.getContactByMri(e);return t?t.email:void 0},s=function(e){return e.selfParticipant.person},a=function(e){var t,n=e.selfParticipant.person.mri;return e.participants.some(function(e){return e.person.mri!==n&&(t=e.person,!0)}),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(23),o=n(17),s=n(3),a=n(142),c=function(){function e(){var e=this;this._contactsByEmail=[],this._haveAllContactsByEmail=!1,this.fetchContactsByMail=function(t,n,r){void 0===t&&(t=100),void 0===n&&(n=10);var i=0;if(e._fetchContactsByMailPromise)return r&&r(e._contactsByEmail),e._fetchContactsByMailPromise.promise;var a=new Promise(function(o,a){var c=function(){if(!e._fetchContactsByMailPromise||!e._fetchContactsByMailPromise.isCanceled){s.default.microsoftGraphService.fetchCommonEmails(t,i*t).then(function(s){if(!e._fetchContactsByMailPromise.isCanceled)if(s&&s.value){if(0===s.value.length)return void(e._haveAllContactsByEmail=!0);var u=[];s.value.forEach(function(e){e.scoredEmailAddresses.forEach(function(e){u.push(e.address)})}),e.getContactsByEmail(u).then(function(s){if(!e._fetchContactsByMailPromise.isCanceled){if(!s.ok){var l={code:s.status,message:s.statusText};return a(l),void(e._fetchContactsByMailPromise=null)}s.json().then(function(l){return function(l){if(!l)return e._haveAllContactsByEmail=!0,void(e._contactsByEmail?o(e._contactsByEmail):(a({status:s.status,statusText:s.statusText}),e._fetchContactsByMailPromise=null));r&&r(l.contacts),e._contactsByEmail=e._contactsByEmail.concat(l.contacts),e._haveAllContactsByEmail=e._haveAllContactsByEmail||e._contactsByEmail.length>=n||u.length<t,e._haveAllContactsByEmail?o(e._contactsByEmail):(i++,c())}(l)},function(t){a(t),e._fetchContactsByMailPromise=null})}}).catch(function(e){a(e)})}else e._contactsByEmail?o(e._contactsByEmail):(a({status:0,statusText:"No emails to get skypeIds"}),e._fetchContactsByMailPromise=null)}).catch(function(e){a(e)})}};s.default.signInManager.onceSignedIn().then(c.bind(e))});return e._fetchContactsByMailPromise=new o.CancelablePromise(a),e._fetchContactsByMailPromise.promise},s.default.signInManager.subscribe("state",function(t){t===i.SigninState.SignedOut&&e.dispose()})}return Object.defineProperty(e.prototype,"fetchContactsByMailPromise",{get:function(){return this._fetchContactsByMailPromise&&this._fetchContactsByMailPromise.promise},enumerable:!0,configurable:!0}),e.prototype.getContactsByEmail=function(e){var t={Emails:e};return a.post("fetchContactsByEmail","scdemaillookup",JSON.stringify(t),r.default.CONTACTS_SCD_HOST_URL)},e.prototype.dispose=function(){this._contactsByEmail=[],this._fetchContactsByMailPromise&&this._fetchContactsByMailPromise.status===o.PromiseStatus.Pending&&this._fetchContactsByMailPromise.cancel(),this._fetchContactsByMailPromise=null},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(2);t.getHeaders=function(){return new Promise(function(e){r.default.signInManager.getSkypeToken().then(function(t){var n=new Headers;n.append("X-Skypetoken",t),n.append("X-Skype-Caller",i.default.getUiVersion()),e(n)},function(){})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(2),o=n(23),s=n(17),a=n(10),c=n(13),u=n(11),l=n(283),p=n(3),d=n(284),f=n(142),h=n(42),g="X-Skype-Continuation-Token",m=function(){function e(){var e=this;this._contacts=[],this._groups=[],this._blocklist=[],this._pendingContactFetching={},this._haveAllContacts=!1,this.fetchMyContacts=function(t,n){void 0===t&&(t=100);var r=new l.default,i=Date.now(),o=0;if(e._fetchContactsPromise)return n&&n(e._contacts),e._fetchContactsPromise.promise;var c=new d.ContactsInfo,f=new Promise(function(s,l){var d=function(f){if(o++,!e._fetchContactsPromise||!e._fetchContactsPromise.isCanceled){var h=Date.now(),m=p.default.signInManager.currentUserName;e.fetchContacts(m,t,f).then(function(f){if(!e._fetchContactsPromise.isCanceled){if(!f.ok){var m={code:f.status,message:f.statusText};return u.default.throwError(a.ErrorCodes.ERR_FETCH_CONTACTS_MAIN,"Unable to fetch contacts",m),l(m),void(e._fetchContactsPromise=null)}f.json().then(function(a){return function(a){if(e._haveAllContacts=!0,!a)return e._contacts?s(c):(l({status:f.status,statusText:f.statusText}),e._fetchContactsPromise=null),r.status=f.status,r.pages=o,void p.default.telemetryManager.sendEvent(r);a.duration=Date.now()-h,c.update(a);var u={"If-None-Match":"/"};n&&n(a.contacts);var m=f.headers.get(g);return m?(u[g]=m,d(u)):(a.contacts=e._contacts=c.contacts.getItems(),a.groups=e._groups=c.groups.getItems(),a.blocklist=e._blocklist=c.blocklist.getItems(),a.scope=c.firstScope,a.duration=c.duration,s(a),r.ttl=Date.now()-i,r.total=a.contacts.length,r.blocked=a.blocklist.length,r.groups=a.groups.length,r.agents=c.filter(28).length,r.pstn=c.filter(4).length,r.person=c.filter(8).length,r.status=f.status,r.pages=o,r.pageSize=t,p.default.telemetryManager.sendEvent(r),void e.createPersonForAllContacts())}(a)},function(t){u.default.throwError(a.ErrorCodes.ERR_FETCH_CONTACTS_MAIN,"Unable to fetch contacts",t),l(t),e._fetchContactsPromise=null,r.status=f.status,r.error=t,p.default.telemetryManager.sendEvent(r)})}})}};p.default.signInManager.onceSignedIn().then(d.bind(e))});return e._fetchContactsPromise=new s.CancelablePromise(f),e._fetchContactsPromise.promise},this.fetchContacts=function(e,t,n){if(void 0===t&&(t=100),r.default.get.backend===c.MessagingBackend.TEAMS)return Promise.resolve({status:200,statusText:"Aad is here"});var i="users/"+encodeURIComponent(e)+"?page_size="+t+"&reason=default";return f.getRaw("fetchContacts",i,n)},this.getContact=function(t,n){if(e._fetchContactsPromise&&e._fetchContactsPromise.status===s.PromiseStatus.Pending)return e._fetchContactsPromise.promise.then(function(){for(var t,r=0;r<e._contacts.length;r++)if(e._contacts[r].mri===n){t=e._contacts[r];break}return t});if(e._pendingContactFetching[n])return e._pendingContactFetching[n];for(var r,i=0;i<e._contacts.length;i++)if(e._contacts[i].mri===n){r=e._contacts[i];break}return r?(delete e._pendingContactFetching[n],Promise.resolve(r)):e._haveAllContacts?Promise.resolve():(e._pendingContactFetching[n]=new Promise(function(r,i){e.fetchContact(t,n).then(function(t){return t.json().then(function(t){var i,o=t.contacts||[];t.contacts&&t.contacts.length&&e._contacts.push(o),delete e._pendingContactFetching[n];for(var s=0;s<o.length;s++)if(o[s].mri&&o[s].mri===n){i=o[s];break}r(i)},function(t){delete e._pendingContactFetching[n],u.default.throwError(a.ErrorCodes.ERR_FETCH_CONTACT_MAIN,"Unable to fetch contact",t),i(t)})},function(t){delete e._pendingContactFetching[n],u.default.throwError(a.ErrorCodes.ERR_FETCH_CONTACT_MAIN,"Unable to fetch contact",t)})}),e._pendingContactFetching[n])},this.fetchContact=function(e,t){if(r.default.get.backend===c.MessagingBackend.TEAMS)return Promise.resolve({status:200,statusText:"Aad is here"});var n=h.default.normalizePersonId(t),i="users/"+e+"/contacts?$filter=mri%2Fnamespace+eq+%27"+h.default.parsePersonId(t).type+"%27+and+mri%2Fidentifier+eq+%27"+n+"%27";return f.getRaw("fetchContact",i)},p.default.signInManager.subscribe("state",function(t){t===o.SigninState.SignedOut&&e.dispose()})}return Object.defineProperty(e.prototype,"fetchMyContactsPromise",{get:function(){return this._fetchContactsPromise&&this._fetchContactsPromise.promise},enumerable:!0,configurable:!0}),e.prototype.addContact=function(e,t){var n="users/"+p.default.signInManager.currentUserName+"/contacts",r={mri:e,greeting:t};return f.post("addContact",n,JSON.stringify(r))},e.prototype.blockContact=function(e,t,n){var r=this;void 0===t&&(t=!0),void 0===n&&(n="spam");var o=p.default.signInManager.currentUserName,s="users/"+o+"/contacts/blocklist/"+e,a={delete_contact:!1,report_abuse:t,ui_version:i.default.getUiVersion(),reason:n};return this.invalidateCache(),t?f.put("blockContact",s,JSON.stringify(a)).then(function(){return r.reportAbuse(o,e,n)}):f.put("blockContact",s,JSON.stringify(a))},e.prototype.reportAbuse=function(e,t,n){void 0===n&&(n="spam");var r="users/"+e+"/contacts/"+t+"/report",o={ui_version:i.default.getUiVersion(),reason:n,report_context:"contact_request",content:{hash:"af94h"}};return f.post("reportAbuse",r,JSON.stringify(o))},e.prototype.unblockContact=function(e){var t="users/"+p.default.signInManager.currentUserName+"/contacts/blocklist/"+e;return this.invalidateCache(),f.deleteMethod("unblockContact",t)},e.prototype.invalidateCache=function(){this._fetchContactsPromise&&(this._fetchContactsPromise.cancel(),this._fetchContactsPromise=null),this.fetchMyContacts()},e.prototype.getContactByMriIfPresent=function(e){var t=this._contacts.filter(function(t){return t.mri===e});return t.length?t[0].display_name:null},e.prototype.getContactByMri=function(e){var t=this._contacts.filter(function(t){return t.mri===e});return t.length?t[0]:void 0},e.prototype.createPersonForAllContacts=function(){var e=this;return this._fetchContactsPromise?this._fetchContactsPromise.promise.then(function(){e._contacts.forEach(function(e){var t=p.default.persons.getPerson(e.mri||e.id,!1);t.displayName=e.display_name,t.avatarData=e.avatar_url,t.isBlocked=e.blocked})}):Promise.resolve()},e.prototype.getBlockedList=function(){return this._fetchContactsPromise?this._fetchContactsPromise.promise.then(function(e){return e.blocklist}):Promise.resolve()},Object.defineProperty(e.prototype,"contactsList",{get:function(){return this._contacts},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._contacts=[],this._groups=[],this._blocklist=[],this._fetchContactsPromise&&this._fetchContactsPromise.status===s.PromiseStatus.Pending&&this._fetchContactsPromise.cancel(),this._fetchContactsPromise=null},e}();t.default=m},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=function(e){function t(){return e.call(this,"contacts_load_qos")||this}return i(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(o.TelemetryPropertyValue.Create("total",this.total)),e.push(o.TelemetryPropertyValue.Create("blocked",this.blocked)),e.push(o.TelemetryPropertyValue.Create("groups",this.groups)),e.push(o.TelemetryPropertyValue.Create("pstn",this.pstn)),e.push(o.TelemetryPropertyValue.Create("person",this.person)),e.push(o.TelemetryPropertyValue.Create("agents",this.agents)),e.push(o.TelemetryPropertyValue.Create("pages",this.pages)),e.push(o.TelemetryPropertyValue.Create("pageSize",this.pages)),e.push(o.TelemetryPropertyValue.Create("ttl",this.ttl)),e.push(o.TelemetryPropertyValue.Create("status",this.status)),e.push(o.TelemetryPropertyValue.Create("error",this.error)),e.push(o.TelemetryPropertyValue.Create("successful",this.status<400||!this.error)),e},t}(n(8).TelemetryEvent);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.items=[],this.key=e}return e.prototype.reset=function(){this.items=[]},e.prototype.add=function(e,t){var n=this;e&&(e.forEach(function(e){n.items=n.items.filter(function(t){return t[n.key]!==e[n.key]})}),t&&(e=e.filter(function(e){return!e.deleted})),this.items=this.items.concat(e))},e.prototype.getItems=function(){return this.items},e.prototype.getItemsByType=function(e){return this.items.filter(function(t){return 0===t.person_id.indexOf(e+":")})},e}(),i=function(){function e(){this.callCount=0,this.contacts=new r("mri"),this.blocklist=new r("mri"),this.groups=new r("id"),this.duration=0,this.firstScope=""}return e.prototype.reset=function(){this.firstScope="",this.contacts.reset(),this.groups.reset(),this.blocklist.reset()},e.prototype.update=function(e){this.callCount++,e&&(this.callCount>1&&"full"===e.scope&&this.reset(),e.scope&&!this.firstScope&&(this.firstScope=e.scope),this.contacts.add(e.contacts,!0),this.groups.add(e.groups,!1),this.blocklist.add(e.blocklist,!0))},e.prototype.filter=function(e){return this.contacts.getItemsByType(e)},e}();t.ContactsInfo=i},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(23),a=n(21),c=n(32),u=n(43),l=n(35),p=100,d="8:echo123",f=function(e){function t(){var t=e.call(this)||this;return t._contactsData={contacts:[],blocked:[],groups:[]},t._fetchContactsResolved=!1,t.fetchMyContacts=function(e){return t._fetchContactsResolved?new Promise(function(e){e(t._contactsData)}):t._contactsService.fetchMyContacts(p).then(function(e){if(!t._fetchContactsResolved){var n=e.contacts.filter(function(e){return!(e.mri.indexOf("4:")>-1)&&e.mri!==d});t._contactsData.groups=e.groups,t._contactsData.contacts=n.map(function(e){return{skypeid:e.mri,name:e.display_name,favorite:e.favorite,normalized_name:l.default.normalizeString(e.display_name),avatar:e.profile&&e.profile.avatar_url?e.profile.avatar_url:"",type:u.default.getContactType({mri:e.mri})}}),e.blocklist&&(t._contactsData.blocked=e.blocklist.map(function(e){return{skypeid:e.mri}})),t._fetchContactsResolved=!0}return t._contactsData},function(e){})},t.isPersonContact=function(e){return new Promise(function(n,r){t._isPersonContactPromiseRejectCallback=r,o.default.instance.SignInManager.getSkypeToken().then(function(r){var i=o.default.instance.SignInManager.currentUserName;if(o.default.instance.SignInManager.userIdentityType===c.IdentityType.GUEST)return n(!0);t._contactsService.getContact(i,e).then(function(r){t._isPersonContactPromiseRejectCallback=null,n(t.isContact(r,e))},function(e){t._isPersonContactPromiseRejectCallback(!1),t._isPersonContactPromiseRejectCallback=null})},t._isPersonContactPromiseRejectCallback.bind(t,{source:"onSigninFailed"}))})},t.addContact=function(e,n){return t._contactsService.addContact(e,n)},t.blockContact=function(e,n,r){return t._contactsService.blockContact(e,n,r)},t.unblockContact=function(e){return t._contactsService.unblockContact(e)},t.getBlockedlist=function(){return t._contactsService.getBlockedList()},t.signinStateChangedHandler=function(){o.default.instance.SignInManager.state===s.SigninState.SignedOut&&(t._contactsService.dispose(),t._isPersonContactPromiseRejectCallback&&t._isPersonContactPromiseRejectCallback({source:"signout"}),t._contactsData={blocked:[],groups:[],contacts:[]},t._fetchContactsResolved=!1)},t.isContact=function(e,t){return!!e&&(!!e&&e.mri===t&&e.authorized)},t._contactsService=t.getServices().contactsService,t._outlookContactsService=t.getServices().outlookContactsService,o.default.instance.SignInManager.subscribe("state",t.signinStateChangedHandler),t}return i(t,e),t.prototype.dispose=function(){this._contactsService.dispose(),this._isPersonContactPromiseRejectCallback&&this._isPersonContactPromiseRejectCallback({source:"onDispose"}),o.default.instance.SignInManager.unsubscribe("state",this.signinStateChangedHandler)},t}(a.default);t.SkypeContactsManager=f,t.default=f},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(17),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._searchAadDirectory=function(e){return t._searchPromise&&t._searchPromise.status===o.PromiseStatus.Pending&&(t._searchPromise.cancel(),t._searchPromise=null),t._searchKey=e,t._searchPromise=new o.CancelablePromise(t.getServices().teamsGraphService.fetchProfiles(e)),t._searchPromise.promise},t}return i(t,e),t.prototype.searchSkypeDirectory=function(e){var t=function(e){return{nodeProfileData:{avatarUrl:"",city:"",contactType:"",country:"",countryCode:"",language:"",state:"",name:e.displayName,skypeId:e.mri,jobTitle:e.jobTitle,department:e.department,location:e.userLocation},nodeAnnotation:"",nodeConnectionData:{distance:0,mutualFriendCount:0}}},n=function(e){return!!e.mri};return this._searchAadDirectory(e).then(function(e){return{requestId:"",results:e.filter(n).map(t)}})},t}(n(144).default);t.TeamsSearchManager=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(54),i=n(11),o=n(107),s=n(288),a=n(10),c="polling_failed",u=function(){function e(e,t){var n=this;this.watermark="",this.pollingForWatermarkPromise={},this.initPolling=function(e,t){var s=0,u=0;n._clearPollingTimeout();var l=function(p,d){if(!n.pollingForWatermarkPromise[p]){s++;var f="conversations/"+e+"/activities"+n.watermark,h=n.helper.createParams("GET",n.token),g=n.helper.sendRequest("polling",f,h);n.pollingForWatermarkPromise[p]=g,g.then(function(c){n.helper.isStatusForbidden(c)?u++:c.json().then(function(e){u=0;var i=!1;e.activities=e.activities||{};for(var a=0;a<e.activities.length;a++){var c=e.activities[a];t&&c&&(i=t(c))}if(e.watermark&&(n.watermark="?watermark="+e.watermark),delete n.pollingForWatermarkPromise[p],i||d)return n.pollingTimeout||(n.pollingTimeout=new r.FixedTimeout(l.bind(n,n.watermark,!0),o.CONTINUOUS_POLLING_INTERVAL)),void n.pollingTimeout.start();s<o.MAX_POLLING_RETRIES&&setTimeout(l.bind(n,n.watermark),o.POLLING_INTERVAL)},function(t){delete n.pollingForWatermarkPromise[p],i.default.throwError(a.ErrorCodes.ERR_PARSE_POLLING,"[DL_v3] Unable to parse polling response",t,e)})},function(t){delete n.pollingForWatermarkPromise[p],u>=o.MAX_RETRY_ATTEMPTS?"function"==typeof n.systemMessageCallback&&n.systemMessageCallback(c):(u++,n.pollingTimeout||(n.pollingTimeout=new r.FixedTimeout(l.bind(n,n.watermark,!0),o.CONTINUOUS_POLLING_INTERVAL)),n.pollingTimeout.start(),i.default.throwError(a.ErrorCodes.ERR_INIT_POLLING,"[DL_v3] Unable to init polling",t,e))})}};l(n.watermark)},this.helper=new s.Helper(t?o.V3_BING_HOST_URL:o.V3_HOST_URL);var u=e.split(":");this.token=u.length>1?u[1]:u[0]}return e.prototype.getToken=function(e){var t=this,n=this.helper.createParams("POST",e);return this.helper.sendRequest("getToken","tokens/generate",n).then(function(e){"function"==typeof e.json?e.json().then(function(n){t.updateRefreshTokenTimeout(e)}):t.updateRefreshTokenTimeout(e)})},e.prototype.createConversation=function(){var e=this,t=this.helper.createParams("POST",this.token);return this.helper.sendRequest("createConversation","conversations",t).then(function(t){return e.helper.isStatusForbidden(t)?Promise.reject("Not authorized"):t.json().then(function(t){return e.updateRefreshTokenTimeout(t),t.conversationId},function(t){i.default.throwError(a.ErrorCodes.ERR_CREATE_CONVERSATION,"[DL_v3] Unable to createConversation",t,e.token)})})},e.prototype.setSystemMessagesHandler=function(e){this.systemMessageCallback=e},e.prototype.postMessage=function(e,t,n,r){var s=this;return void 0===r&&(r=0),new Promise(function(c,u){var l=s.helper.createParams("POST",s.token,s.buildPostMessageBody(e,t,n)),p="conversations/"+t+"/activities";s.helper.sendRequest("postMessage",p,l).then(function(i){return s.helper.isStatusForbidden(i)?r>=o.MAX_RETRY_ATTEMPTS?void("function"==typeof s.systemMessageCallback&&s.systemMessageCallback("message_failed")):s.refreshToken().then(function(){return s.postMessage(e,t,n,r+1)}):c(i)},function(e){u(e),i.default.throwError(a.ErrorCodes.ERR_SEND_MESSAGE,"[DL_v3] Unable to sendMessage",e,t)})})},e.prototype._clearPollingTimeout=function(){this.pollingTimeout&&(this.pollingTimeout.reset(),this.pollingTimeout=null)},e.prototype.dispose=function(){this._clearPollingTimeout()},e.prototype.refreshToken=function(){var e=this;return this.helper.sendRequest("refreshToken","tokens/refresh",this.helper.createParams("POST",this.token)).then(function(t){return t.json().then(function(n){return e.updateRefreshTokenTimeout(n),t},function(e){i.default.throwError(a.ErrorCodes.ERR_PARSE_JSON,"[DL_v3] Unable to parse json with token refresh timeout")})},function(e){i.default.throwError(a.ErrorCodes.ERR_SET_TOKEN_REFRESH_TIMEOUT,"[DL_v3] Unable to set token refresh timeout",e)})},e.prototype.buildPostMessageBody=function(e,t,n){return JSON.stringify({type:"message",text:e,from:{id:"user"},channelData:n.channelData})},e.prototype.updateRefreshTokenTimeout=function(e){if(e.expires_in){e.token&&(this.token=e.token),this.refreshTokenTimeout&&clearTimeout(this.refreshTokenTimeout);var t=1e3*(e.expires_in-20);this.refreshTokenTimeout=setTimeout(this.refreshToken.bind(this),t)}else i.default.throwError(a.ErrorCodes.ERR_SET_TOKEN_REFRESH_TIMEOUT,"[DL_v3] Unable to set token refresh timeout")},e}();t.DirectLineV3=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(11),o=n(107),s=n(10),a={retryCount:3,timeout:12e4,policy:""},c=function(){function e(e){var t=this;this.baseUrl=e,this.createParams=function(e,n,r){var i=t.baseUrl===o.V3_HOST_URL||t.baseUrl===o.V3_BING_HOST_URL?"Bearer":"BotConnector",s=new Headers;s.append("Authorization",i+" "+n),s.append("Content-Type","text/json;charset=UTF-8"),s.append("Accept","application/json");var a={};return a.method=e||"POST",a.headers=s,r&&(a.body=r),a}}return e.prototype.sendRequest=function(e,t,n){return r.default("dl-"+e,a,this.baseUrl+t,n)},e.prototype.isStatusForbidden=function(e){return(401===e.status||403===e.status||404===e.status)&&(i.default.throwError(s.ErrorCodes.ERR_GET_CONVERSATION_ID,"Unable to get conversation id, we are DONE. Probably wrong token/secret key.",e),!0)},e}();t.Helper=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(290),i=function(){return function(){this.addAgentToContacts=function(e){var t="api/v1/bots/add/"+e;return r.put("addAgentToContacts",t)}}}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(16),o=n(291),s={retryCount:3,timeout:12e4,policy:""},a=function(e,t,n){return i.default("joinAgents-"+e,s,r.default.AGENTS_HOST_URL+t,n)};t.getResponse=function(e,t){return a(e,t)},t.get=function(e,t){var n={method:"GET"};return function(e,t,n){return i.default("joinAgents-"+e,s,r.default.AGENTS_HOST_URL+t,n).then(function(e){return e.json()})}(e,t,n)},t.put=function(e,t,n){return void 0===n&&(n=""),o.putHeaders().then(function(r){var i={method:"PUT"};return i.body=n,i.headers=r,a(e,t,i)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.putHeaders=function(){var e=new Headers;return new Promise(function(t){r.default.signInManager.getSkypeToken().then(function(n){e.append("X-Skypetoken",n),t(e)},function(){})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(16),o=n(6),s={retryCount:3,timeout:12e4,policy:""},a=function(){function e(){}return e.auth=function(e){void 0===e&&(e="customer");var t=new Headers;t.append("Content-Type","application/json");var n={body:JSON.stringify({name:e,lang:"en",greeniddc:"none"})},o=Object.assign({},n);return o.method="POST",o.headers=t,o.cache="no-cache",i.default("join-auth",s,r.default.WX_HOST_URL,o).then(function(e){return e.json()})},e.join=function(e,t){void 0===t&&(t="guest"),0!==e.indexOf("19:")&&(e="19:"+e),0===t.length&&(t="guest");var n=new Headers;n.append("Content-Type","application/json"),n.append("Accept","application"),n.append("Accept-Language","en-US,en;");var a={body:JSON.stringify({name:t,threadId:e,longId:"swc",shortId:"swc",flowId:o.default.get.sessionId})},c=Object.assign({},a);return c.method="POST",c.headers=n,c.cache="no-cache",i.default("join-join",s,r.default.INVITE_HOST_URL_INT+"users/guests/light",c).then(function(e){return e.json()})},e}();t.default=a},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var n=e.call(this,t,!1,!0)||this;return n._isMePerson=!0,n}return i(t,e),Object.defineProperty(t.prototype,"msaId",{get:function(){return this._msaId},set:function(e){e&&(this._msaId=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"personalFileSite",{get:function(){return this._personalFileSite},set:function(e){e&&(this._personalFileSite=e)},enumerable:!0,configurable:!0}),t}(n(145).default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(295),i=function(){function e(){}return e.prototype.fetchCommonEmails=function(e,t){void 0===e&&(e=10),void 0===t&&(t=0);var n="people/?$top="+e+"&$skip="+t+"&$Select=scoredEmailAddresses";return r.get("scoredMails",n).then(function(e){return e})},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(16),o=n(296),s={retryCount:3,timeout:12e4,policy:""},a=function(e,t,n){return i.default("msGraph-"+e,s,r.default.MS_GRAPH_URL+t,n)};t.postWithoutHeaders=function(e,t,n){var r={method:"GET",cache:"no-cache"};return n&&(r.headers=n),a(e,t,r).then(function(e){return e.json()})},t.get=function(e,t){return o.getHeaders().then(function(n){var r={method:"GET"};return r.headers=n,r.cache="no-cache",a(e,t,r).then(function(e){return e.json()})},function(e){})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(104),o=n(20),s=n(59),a=n(3),c={clientID:r.default.MS_APP_CLIENT_ID,graphScopes:["People.Read","openid","profile"]},u=function(){return function(e,t,n){var r=JSON.parse(window.sessionStorage.getItem(e)),i=Math.round((new Date).getTime()/1e3);if(r){if(r.expiresIn>i)return Promise.resolve(r.token);window.sessionStorage.removeItem(e)}return new Promise(function(i,o){var s;r&&(s=r.token),n(s).then(function(n){var r={expiresIn:t(n),token:n};window.sessionStorage.setItem(e,JSON.stringify(r)),i(n)}).catch(o)})}("skype|graphAccessToken"+s.hashCode(a.default.signInManager.currentUserName),function(e){return Math.round((new Date).getTime()/1e3)+ +e.expires_in},function(){return new Promise(function(e,t){var n=a.default.signInManager.currentUserName,s=o.guid.generate(),u=r.default.MS_AUTHORIZE_URL,l=r.default.MS_APP_REDIRECT_URL_DEMO;window.location.hostname.toLowerCase().indexOf("outlook")>=0&&(l=r.default.MS_APP_REDIRECT_URL_OUTLOOK);var p={response_type:"token",scope:c.graphScopes.join(" "),client_id:c.clientID,username:n,nonce:s,redirect_uri:l},d=i.addGetParamsToUrl(u,p),f=function(n){if(n.data){window.removeEventListener("message",f);var r=n.data;if(-1!==r.indexOf("access_token")){var i={};r.split("&").forEach(function(e){var t=e.split("="),n=t[0],r=t[1];i[n]=decodeURIComponent(r)}),e(i)}t(r)}};window.addEventListener("message",f),window.open(d,"_blank",r.default.LOGIN_POPUP_FEATURES)})})};t.getHeaders=function(){return new Promise(function(e,t){var n=new Headers;u().then(function(t){n.append("Authorization",[t.token_type,t.access_token].join(" ")),e(n)}).catch(function(e){t(e)})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(10),o=n(0),s=n(11),a=n(33),c=n(3),u=n(298),l=n(299),p=n(300),d=n(301),f={"Event/Call":1,"Signal/Flamingo":1},h=function(){function e(){this.activeCallNotifications={},this.idOfShowedMessageNotifications={},this.everOpenedChats={},this.notifications=[],this.unreadMessageObserver=new d.default,this.isEnabled=!0}return e.prototype.enableNotifications=function(){this.isEnabled=!0},e.prototype.disableNotifications=function(){this.isEnabled=!1},e.prototype.registerUnreadMessage=function(e,t){if(!this.idOfShowedMessageNotifications[t.id]&&!this.isOpenedConversation(e.id)&&!f[t.messagetype]){var n=this.unreadMessageObserver.getNotification(e,t);n&&(this.idOfShowedMessageNotifications[t.id]=!0,this.notifications.push(n),this.showNotifications())}},e.prototype.registerUnreadConversationsSummary=function(e){if(p.default.isEnabled&&0!==e.length&&!p.default.isIgnored()){var t=this.getUnreadConversationsNotification(e);t?this.notifications.push(t):s.default.throwError(i.ErrorCodes.ERR_CREATE_SUMMARY_NOTIFICATION,"Unable to create summary notification"),this.showNotifications()}},e.prototype.registerCall=function(e){var t=new l.default(e),n=t.getNotification();n?(this.activeCallNotifications[t.callId]=n,o.swc.API.triggerEvent(r.ApiEvents.ReceivedNotification,n)):s.default.throwError(i.ErrorCodes.ERR_CREATE_CALL_NOTIFICATION,"Unable to create call notification")},e.prototype.callStateHandler=function(e){this.activeCallNotifications[e.id]&&(this.activeCallNotifications[e.id].hide(),delete this.activeCallNotifications[e.id])},e.prototype.setOpenedConversations=function(e){this.everOpenedChats=e,c.default.setEverOpenedChats(e)},e.prototype.isOpenedConversation=function(e){var t=this.everOpenedChats[e];return t&&t.onStage},e.prototype.showNotifications=function(){if(this.isEnabled)for(var e=this.notifications.length,t=0;t<e;t++){var n=this.notifications.pop();o.swc.API.triggerEvent(r.ApiEvents.ReceivedNotification,n),c.default.telemetryManager.sendEvent(new u.default(n.type))}else this.notifications=[]},e.prototype.getUnreadConversationsNotification=function(e){var t=a.LocalStorage.getItem("swc-recentslastseen");if(!t)return new p.default(e);var n=e.filter(function(e){return new Date(e.lastMessage.originalarrivaltime).getTime()>+t});return n.length?new p.default(n):null},e}();t.default=h},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=function(e){function t(t){var n=e.call(this,"notification_created")||this;return n.notificationType=t,n}return i(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(o.TelemetryPropertyValue.Create("type",this.notificationType)),e},t}(n(8).TelemetryEvent);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(21),o=n(0),s=n(49),a=n(71),c=n(72),u=function(){function e(e){this._callInfo=e,this.reject=function(e){var t={id:e.callId,reject:!0,callerMri:e.callerMri||""};o.swc.API.triggerEvent(r.ApiEvents.RejectCall,t),i.getServices().telemetryManager.sendEvent(new a.default("Calling","Ignore"))},this.accept=function(e){if(o.swc.ChatContent){var t=e.mri,n={ConversationId:t||"",ExecuteCall:{id:e.callId,accept:!0,callerMri:t||""}};o.swc.API.triggerEvent(r.ApiEvents.StartChat,n),i.getServices().telemetryManager.sendEvent(new a.default("Calling","Accept"))}}}return Object.defineProperty(e.prototype,"callId",{get:function(){return this._callInfo.callId},enumerable:!0,configurable:!0}),e.prototype.getNotification=function(){var e=new c.Notification;return e.type="Calling",e.title=this._callInfo.displayName||"",e.description="Incoming call",e.avatarUrl=this._callInfo.avatar,e.actions=this.getActions(this._callInfo),e},e.prototype.getActions=function(e){var t=this;return[{type:"Accept",title:s.default.fetch("accept"),description:s.default.fetch("accept_descr"),action:function(){t.accept(e)}},{type:"Ignore",title:s.default.fetch("ignore"),description:s.default.fetch("ignore_descr"),action:function(){t.reject(e)}}]},e}();t.default=u},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s=n(2),a=n(0),c=n(59),u=n(49),l=n(71),p=n(3),d=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/,f=function(e){function t(n){var r=e.call(this)||this;return r.type="Summary",r.description=u.default.fetch("notification_summary",{count:n.length}),r.avatarUrl=r.getAvatar(n)||s.default.DEFAULT_AVATAR_URI,r.actions=r.getActions(),t.isEnabled=!1,t.setIgnoreToStorage(),r}return i(t,e),t.prototype.getAvatar=function(e){var t=e.filter(function(e){return!e.isGroup}),n=t.length>0?t[0]:e[0];if(n.avatar&&n.avatar.match(d))return n.avatar;var r=n.isGroup?void 0:n.id.replace(/^\d+:/,""),i=r?encodeURIComponent(r):"thread",o="https://avatar.skype.com/v1/"+"avatars/${contactId}/public?returnDefaultImage=false&cacheHeaders=true".replace("${contactId}",i);return o=o.replace("returnDefaultImage=false","returnDefaultImage=true")},t.prototype.getActions=function(){return[{type:"Accept",title:u.default.fetch("open"),description:u.default.fetch("open_client_descr"),action:function(){a.swc.API.triggerEvent(o.ApiEvents.OpenRecentList),p.default.telemetryManager.sendEvent(new l.default("Summary","Accept"))}},{type:"Ignore",title:u.default.fetch("ignore"),description:u.default.fetch("ignore_summary_notificaton_descr"),action:function(){p.default.telemetryManager.sendEvent(new l.default("Summary","Ignore"))}}]},t.setIgnoreToStorage=function(){try{var e=60*(s.default.ECS.sumToastDelayMin||0)*1e3,t={ignoreUntil:Date.now()+(0===e?864e5:e),id:c.hashCode(p.default.signInManager.currentUserName)};p.default.localStorage.setItem("swc|notificationIgnore",JSON.stringify(t))}catch(e){}},t.isIgnored=function(){try{var e=p.default.localStorage.getItem("swc|notificationIgnore"),t=c.hashCode(p.default.signInManager.currentUserName);if(e){var n=JSON.parse(e);if(!n.id||n.id!=t)return p.default.localStorage.removeItem("swc|notificationIgnore"),!1;if(!n.ignoreUntil||isNaN(n.ignoreUntil))return!1;if(n.ignoreUntil>Date.now())return!0}return!1}catch(e){return!1}},t.isEnabled=!0,t}(n(72).Notification);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(302),o=n(303),s=function(){function e(){var e=this;this.unreadConversations={},this.freshUnreadConversations={},r.default.webApi.recents().getUnreadConversations().then(function(t){t.forEach(function(t){e.unreadConversations[t.id]=100}),t.subscribe(function(t,n){n.newItems&&n.newItems.forEach(function(t){e.freshUnreadConversations[t.id]=0}),n.oldItems&&n.oldItems.forEach(function(t){delete e.unreadConversations[t.id],delete e.freshUnreadConversations[t.id]})})})}return e.prototype.getNotification=function(e,t){if(!this.canShow(e,t))return null;if(!this.isAllowedByUnread(e.id)){if(3===this.freshUnreadConversations[e.id]){var n=Object.getOwnPropertyNames(this.freshUnreadConversations).map(function(e){return r.default.webApi.recents().getConversation(e)});return new i.default(n,e)}return null}var s=new o.default(e,t);return s&&s.description?s:null},e.prototype.canShow=function(e,t){return!e.isBlocked},e.prototype.isAllowedByUnread=function(e){return!this.unreadConversations[e]&&(void 0===!this.freshUnreadConversations[e]?(this.freshUnreadConversations[e]=0,!0):(this.freshUnreadConversations[e]++,this.freshUnreadConversations[e]<3))},e}();t.default=s},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),s=n(47),a=n(49),c=n(3),u=n(71),l=n(72),p=window,d=function(e){function t(n,r){var i=e.call(this)||this;return i.type="UnreadMessage",i.title=i.getTitle(n),i.description=t.getDescription(n),i.actions=i.getActions(r),i.sender="",i.avatarUrl=t.getAvatar(r),i}return i(t,e),t.prototype.getTitle=function(e){var t="",n=a.default.fetch("separator");return e.forEach(function(e){if(e.isGroup)t+=""===t?e.topic:n+" "+e.topic;else{var r=c.default.contactsService.getContactByMriIfPresent(e.id)||s.normalizePersonId(e.id);t+=""===t?r:n+" "+r}}),t},t.getDescription=function(e){return a.default.fetch("notification_reminder_desc",{count:e.length})},t.getAvatar=function(e){return e.avatar||o.default.DEFAULT_AVATAR_URI},t.prototype.getActions=function(e){return[{type:"Accept",title:a.default.fetch("open"),description:a.default.fetch("open_client_descr"),action:function(){p.swc.SDK.Chat.startChat({ConversationId:e.id}),c.default.telemetryManager.sendEvent(new u.default("Reminder","Accept"))}},{type:"Ignore",title:a.default.fetch("ignore"),description:a.default.fetch("ignore_reminder_notificaton_descr"),action:function(){c.default.telemetryManager.sendEvent(new u.default("Reminder","Ignore"))}}]},t}(l.Notification);t.default=d},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),s=n(14),a=n(47),c=n(49),u=n(3),l=n(71),p=n(72),d=n(25),f=function(e){function t(n,r){var i=e.call(this)||this;return i.type="UnreadMessage",i.title=t.getTitle(n,r),i.description=t.getDescription(r),i.actions=i.getActions(n),i.sender=t.getSender(n,r),i.avatarUrl=t.getAvatar(n,r),i}return i(t,e),t.getTitle=function(e,t){return e.isGroup?e.topic:u.default.contactsService.getContactByMriIfPresent(e.id)||a.normalizePersonId(e.id)},t.getDescription=function(e){switch(e&&e.content&&(e.content=e.content.replace(/&apos;/g,"'")),e.messagetype){case"Text":case"RichText":return d.default.dompurify.sanitize(e.content,{ALLOWED_TAGS:[]});case"RichText/UriObject":return c.default.fetch("pic_sent");case"RichText/Media_GenericFile":return c.default.fetch("file_sent");case"Event/Call":return c.default.fetch(t.getCallMessage(e.content));default:return d.default.dompurify.sanitize(e.content,{ALLOWED_TAGS:[]})}},t.getCallMessage=function(e){return/<partlist type="missed"="/.test(e)?"message_text_missedCall":(/<partlist type="ended"="/.test(e),"message_text_endedCall")},t.getAvatar=function(e,t){var n=e.avatar||o.default.DEFAULT_AVATAR_URI;return n=n.replace("returnDefaultImage=false","returnDefaultImage=true")},t.prototype.getActions=function(e){return[{type:"Accept",title:c.default.fetch("open"),description:c.default.fetch("open_client_descr"),action:function(){window.swc.SDK.Chat.startChat({ConversationId:e.id}),u.default.telemetryManager.sendEvent(new l.default("UnreadMessage","Accept"))}},{type:"Ignore",title:c.default.fetch("ignore"),description:c.default.fetch("ignore_unread_notificaton_descr"),action:function(){u.default.telemetryManager.sendEvent(new l.default("UnreadMessage","Ignore"))}}]},t.getSender=function(e,t){if(!e.isGroup)return"";if(!t.from)return"";var n=s.default.getSenderIdFromUrl(t.from),r=a.normalizePersonId(n);return u.default.contactsService.getContactByMriIfPresent(n)||r},t}(p.Notification);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(305);t.ping=function(){return r.sendRequest("ping","GET","/swc")},t.getExistingCompanies=function(){return r.sendRequest("getCompanies","GET","/companies")},t.createCompany=function(e,t){var n={businessName:e,description:t};return r.sendRequest("createCompany","POST","/swc",{body:JSON.stringify(n)})},t.setCompanyEnabledStatusTo=function(e){return r.sendPutRequest("enableCompany","/swc/status",{body:JSON.stringify({enabled:e})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(16),o=n(306),s={retryCount:3,timeout:12e4,policy:""},a=function(e,t,n){return i.default("oa-"+e,s,r.default.OA_URL+t,n)},c=function(e,t,n){e.append("Content-Type","application/json");var r=Object.assign({},n);return r.method=t,r.headers=e,r.cache="no-cache",r};t.sendRequest=function(e,t,n,r){return o.getHeaders().then(function(i){return a(e,n,c(i,t,r)).then(function(e){return e.json()})})},t.sendPutRequest=function(e,t,n){return o.getHeaders().then(function(r){return a(e,t,c(r,"PUT",n))})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.postHeaders=function(){return new Promise(function(e){r.default.signInManager.getSkypeToken().then(function(t){var n=new Headers;n.append("X-Skypetoken",t),e(n)},function(){})})},t.getHeaders=function(){return new Promise(function(e){r.default.signInManager.getSkypeToken().then(function(t){var n=new Headers;n.append("X-Skypetoken",t),e(n)},function(){})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(109),o=n(0),s=n(308),a=n(309),c=n(312),u=n(313),l=function(){function e(){this._isInitialized=!1,this.canRenderConfigItems=function(){return s.default.canRenderConfigItems()}}return Object.defineProperty(e.prototype,"isInitialized",{get:function(){return this._isInitialized},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"map",{get:function(){return i.shortcutIdMap},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"emoticonMap",{get:function(){return i.idEmoticonMap},enumerable:!0,configurable:!0}),e.prototype.init=function(e){var t=this;return new Promise(function(n,i){c.default.init(e).then(function(e){var i=s.default.init(e);a.default.register(i),u.default.updateCache(i),i.items&&i.items.forEach(function(e){e.background=u.default.getUrlFromCache(e.id)}),u.default.isRunning()||u.default.start(),n(i),t._isInitialized=!0,o.swc.API.triggerEvent(r.ApiEvents.PesConfigInitialized)}).catch(function(){i()})})},e}();t.default=l},function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Object.defineProperty(t,"__esModule",{value:!0});var i=n(109),o=n(19),s=n(34),a=n(110),c=function(){function e(){this._configuration={countryCode:"",tabsRoot:"",itemsRoot:"",emoticonsRoot:"",packsRoot:"",items:[],packs:[],tabs:[],emoticonPreviewItem:null}}return e.prototype.canRenderConfigItems=function(){return this._configuration.items.length>0},e.prototype.init=function(e){var t=this._processItems(e);t.forEach(function(e){i.idEmoticonMap[e.id]=e});var n=this._processPacks(e,t),o=e.tabs?this._resolveTabsFromSections(e,n):this._makeTabsFromPacks(n,e.packsRoot);return this._configuration=r({},e,{packs:n,tabs:o,items:t},{emoticonPreviewItem:t[0]}),this._configuration},e.prototype._processPacks=function(e,t){return e.packs.map(function(e){var n=[];return e.items.forEach(function(e){var r=t.find(function(t){return t.id===e});r&&n.push(r)}),r({},e,{items:n})})},e.prototype._resolveTabsFromSections=function(e,t){var n=this;return e.tabs.map(function(i){var o=[];return i.sections.forEach(function(e){var n=t.find(function(t){return t.id===e.pack});n&&n.items&&n.items.length&&o.push(n)}),r({},i,{packs:o,type:s.default.itemTypes.tab.id,thumbnailUrl:n._createThumbnailUrl(i.id,e.tabsRoot)})})},e.prototype._createThumbnailUrl=function(e,t){var n=(t||"#")+"/"+e+"/views/thumbnail";return n=a.rewriteUrls(n,s.default.pesCDNAuthentication.rewriteRules)},e.prototype._makeTabsFromPacks=function(e,t){var n=this,r=[];return e?(e.forEach(function(e){if(!n._isFeaturedPack(e)){var i=n._createTabFromPack(e,t);r.push(i)}}),e.forEach(function(e){if(n._isFeaturedPack(e)){var i=e.title.replace(s.default.FEATURED_IN_PREFIX,""),o=r.find(function(e){return e.title===i});o?(e.isHidden=!1,o.packs.unshift(e)):!1===e.isHidden&&(e.title=i,o=n._createTabFromPack(e,t),r.push(o))}}),r):r},e.prototype._createTabFromPack=function(e,t){var n=this._createThumbnailUrl(e.id,t),i=r({},e,{type:s.default.itemTypes.tab.id,thumbnailUrl:n,packs:[e],sections:[{pack:e.id}],glyphBgColor:"",isDiscoverable:!1,badgeETag:""});return delete i.isSponsored,delete i.items,i},e.prototype._isFeaturedPack=function(e){return 0===(e.title||"").indexOf(s.default.FEATURED_IN_PREFIX)},e.prototype._processItems=function(e){var t=this,n=e.countryCode;return e.items.filter(function(e){return e.type===s.default.itemTypes.emoticon.id&&(!(n&&e.excludedCountries&&e.excludedCountries.indexOf(n)>=0)&&!(n&&e.includedCountries&&e.includedCountries.length&&e.includedCountries.indexOf(n)<0))}).map(function(n){var i={staticHtmlClass:n.id,staticExtraLargeHtmlClass:n.id+" extraLarge",animatedExtraLargeHtmlClass:n.id+" extraLarge animated",background:""},o=e.emoticonsRoot+"/"+n.id+"/views/",s=t._getEmoticonURLs(o,n.etag),a=r({},n,i,s,{descriptionUpperCase:n.description.toUpperCase(),views:[]});return delete a.includedCountries,delete a.excludedCountries,a})},e.prototype._getEmoticonURLs=function(e,t){return e=a.rewriteUrls(e,s.default.pesCDNAuthentication.rewriteRules),{smallStaticUrl:this._buildUrl(e+s.default.profiles.emoticons.getSmall(),t),largeStaticUrl:this._buildUrl(e+s.default.profiles.emoticons.getLarge(),t),extraLargeStaticUrl:this._buildUrl(e+s.default.profiles.emoticons.getExtraLarge(),t),superLargeStaticUrl:this._buildUrl(e+s.default.profiles.emoticons.getSuperLarge(),t),smallUrl:this._buildUrl(e+s.default.profiles.emoticons.getSmallAnimated(),t),largeUrl:this._buildUrl(e+s.default.profiles.emoticons.getLargeAnimated(),t),extraLargeUrl:this._buildUrl(e+s.default.profiles.emoticons.getExtraLargeAnimated(),t),superLargeUrl:this._buildUrl(e+s.default.profiles.emoticons.getSuperLargeAnimated(),t)}},e.prototype._buildUrl=function(e,t){return o.default.setQueryParameters(e,{etag:t})},e}();t.default=new c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(109),i=n(34),o=n(310),s=n(311),a=function(){function e(){}return e.prototype.register=function(e){var t=this._getArtifacts(e),n="";r.clearShortcutMap(),t.encodingMaps.forEach(function(e){switch(e.type){case i.default.itemTypes.emoticon.id:r.shortcutIdMap[e.shortcut]=e.id;break;case i.default.itemTypes.tab.id:case i.default.itemTypes.moji.id:case i.default.itemTypes.sticker.id:throw new Error("mapping.type not implemented yet:"+e.type);default:throw new Error("mapping.type not supported yet:"+e.type)}}),t.pesStyles.forEach(function(e){n+=e}),this._registerStyles(n)},e.prototype._getArtifacts=function(e){var t=[],n=[],r=[];return e.tabs&&e.tabs.forEach(function(e){var i=s.default.getResources(e);t.push(i.styleDef),n.unshift(i.prefetchUrls[0]),e.packs.forEach(function(e){e.items.forEach(function(e){var i=o.default.getResources(e);i&&(t.push(i.styleDef),r.push.apply(r,i.encoderMaps),n.push.apply(n,i.prefetchUrls))})})}),{pesStyles:t,prefetchUrls:n,encodingMaps:r}},e.prototype._registerStyles=function(e){var t,n,r=document.getElementById("pesStyles");return r||(n=document.head,(r=document.createElement("style")).id="pesStyles",r.type="text/css"),r.styleSheet?r.styleSheet.cssText=e:(t=document.createTextNode(e),r.firstChild&&r.removeChild(r.firstChild),r.appendChild(t)),n&&n.appendChild(r),e},e}();t.default=new a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(34),i=function(){function e(){}return e.prototype.getResources=function(e){if(e.type!==r.default.itemTypes.emoticon.id)return null;var t=e.shortcuts.map(function(t){return{shortcut:t,id:e.id,type:r.default.itemTypes.emoticon.id}});return{styleDef:"",prefetchUrls:[e.smallUrl,e.smallStaticUrl,e.largeUrl,e.largeStaticUrl,e.extraLargeUrl,e.extraLargeStaticUrl,e.superLargeUrl,e.superLargeStaticUrl],encoderMaps:t}},e}();t.default=new i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(34),i=function(){function e(){}return e.prototype.getResources=function(e){if(e.type!==r.default.itemTypes.tab.id)return null;var t="\n.swx .tab_id_"+e.id+"\n";return t+="{\n",t+=" -ms-high-contrast-adjust: none;\n",t+=" background-image: url('"+e.thumbnailUrl+"'); \n",{styleDef:t+="} \n",prefetchUrls:[e.thumbnailUrl]}},e}();t.default=new i},function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=n(10),s=n(102),a=n(116),c=n(147),u=n(16),l=n(6),p=n(11),d=n(34),f=n(110),h={retryCount:3,timeout:12e4,policy:""},g=function(){function e(){}return e.prototype.init=function(e){var t=this;return this._initPromise?this._initPromise:(l.default.get.pesLanguageLocale=a.default.getPesLocale(l.default.get.currentLocale||i.default.LOCALE),this._initPromise=c.configLoader(c.EcsClient.Skype,{id:e}).then(function(e){var n=e.SkypePersonalization?e.SkypePersonalization.pes_config:null,i=e.Headers?e.Headers.CountryCode:null;return n||t._throwUncaughtError("No config URL",e),t._fetchConfiguration(n).then(function(e){return r({},e,{countryCode:i})})}).catch(function(e){t._throwUncaughtError("",e)}),this._initPromise)},e.prototype._throwUncaughtError=function(e,t){var n=t&&"string"==typeof t?t:JSON.stringify(t);p.default.throwError(o.ErrorCodes.ERR_PES_CONFIG_LOAD,"[PES] configSync, url "+e+", error "+n)},e.prototype._fetchConfiguration=function(e){var t=this;return this._fetch(this._getLocalizedUrl(e)).catch(function(){return t._fetch(e)}).catch(function(n){return t._throwUncaughtError(e,n)})},e.prototype._fetch=function(e){var t=this;return e=f.rewriteUrls(e,d.default.pesCDNAuthentication.rewriteRules),Promise.resolve(u.default("pes-CDNTokenFromSkypeToken",h,e,{method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json, text/javascript"}}).then(function(e){return s.parseJson(e)}).catch(function(n){return t._throwUncaughtError(e,n)}))},e.prototype._getLocalizedUrl=function(e){var t=l.default.get.pesLanguageLocale||i.default.PES_LOCALE;return e.replace("/default","/"+t)},e}();t.default=new g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(28),i=n(34),o=n(314),s=n(148),a=function(){function e(){this._isRunning=!1,this._pixelRatio=1,this._lastDrawTimestamp=-1313,this._lastBoundsTimestamp=-1313,this._refreshTime=0,this._bounds={},this.BOUNDS_REFRESH_TIMEOUT=100,this._imageCache={}}return e.prototype.isRunning=function(){return this._isRunning},e.prototype.start=function(){var e=r.default.getWindow();"devicePixelRatio"in e&&(this._pixelRatio=e.devicePixelRatio),this._isRunning=!0,this._lastDrawTimestamp=-1313,e.requestAnimationFrame(this.draw.bind(this))},e.prototype.stop=function(){this._isRunning=!1},e.prototype.updateCache=function(e){var t=this,n=0;e.items.forEach(function(r){if(!t._imageCache[r.id]&&r.type===i.default.itemTypes.emoticon.id){t._imageCache[r.id]=new o.default(e.emoticonsRoot,r);var s=r.media;s&&s.default&&s.default.fps>n&&(n=s.default.fps)}}),0!==n&&(this._refreshTime=Math.floor(1e3/n))},e.prototype.getUrlFromCache=function(e){var t="";for(var n in this._imageCache)if(this._imageCache[n].id===e){var r=this._imageCache[n].largeStatic;t=r?r.url:"";break}return t},e.prototype.draw=function(e){var t=this;if(e-this._lastDrawTimestamp>=this._refreshTime){this._lastDrawTimestamp=e;var n=this.getEmoticonCanvases(),i=e-this._lastBoundsTimestamp>this.BOUNDS_REFRESH_TIMEOUT;i&&(this._lastBoundsTimestamp=e),Array.prototype.forEach.call(n,function(n){i&&delete t._bounds[n.id],t._bounds[n.id]||(t._bounds[n.id]=n.getBoundingClientRect());var o=t._bounds[n.id];if(!(o.width<=2)&&r.default.isInViewport(o)){i&&t.setDimensionsIfNeeded(n,o);var s="itemId",a="item-id",c="isAnimated",u="is-animated",l=r.default.readDataset(n,s,a),p=t._imageCache[l],d="true"===r.default.readDataset(n,c,u);try{p&&t.drawEmoticon(n,p,o.width,d,e/1e3)}catch(e){}}})}this._isRunning&&r.default.getWindow().requestAnimationFrame(this.draw.bind(this))},e.prototype.getEmoticonCanvases=function(){return document.querySelectorAll(".swc span.emoticon canvas")},e.prototype.drawEmoticon=function(e,t,n,r,o){t[(n<=i.default.frameHeights.emoticons.SMALL?s.ITEM_SIZES.SMALL:n<=i.default.frameHeights.emoticons.LARGE?s.ITEM_SIZES.LARGE:n<=i.default.frameHeights.emoticons.EXTRA_LARGE?s.ITEM_SIZES.EXTRA_LARGE:s.ITEM_SIZES.SUPER_LARGE)+(r?"Animated":"Static")].draw(e,o)},e.prototype.setDimensionsIfNeeded=function(e,t){var n=t.width*this._pixelRatio;e.width===n&&e.height===n||(e.width=n,e.height=n)},e}();t.default=new a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(110),i=n(148),o=n(315),s=function(){return function(e,t){this.id=t.id,this.smallAnimated=new o.default(r.buildEmoticonUrl(e,t,i.ITEM_SIZES.SMALL,!0),t.media.default),this.largeAnimated=new o.default(r.buildEmoticonUrl(e,t,i.ITEM_SIZES.LARGE,!0),t.media.default),this.extraLargeAnimated=new o.default(r.buildEmoticonUrl(e,t,i.ITEM_SIZES.EXTRA_LARGE,!0),t.media.default),this.superLargeAnimated=new o.default(r.buildEmoticonUrl(e,t,i.ITEM_SIZES.SUPER_LARGE,!0),t.media.default),this.smallStatic=new o.default(r.buildEmoticonUrl(e,t,i.ITEM_SIZES.SMALL,!1),i.STATIC_MEDIA_INFO),this.largeStatic=new o.default(r.buildEmoticonUrl(e,t,i.ITEM_SIZES.LARGE,!1),i.STATIC_MEDIA_INFO),this.extraLargeStatic=new o.default(r.buildEmoticonUrl(e,t,i.ITEM_SIZES.EXTRA_LARGE,!1),i.STATIC_MEDIA_INFO),this.superLargeStatic=new o.default(r.buildEmoticonUrl(e,t,i.ITEM_SIZES.SUPER_LARGE,!1),i.STATIC_MEDIA_INFO)}}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.isLoaded=!1,this.isLoading=!1,this.url=e,this.mediaInfo=t}return e.prototype.draw=function(e,t){var n=this;if(!this.isLoading)if(this.isLoaded){var r=e.getContext("2d"),i=this.image.naturalWidth;r.clearRect(0,0,e.width,e.width);var o=void 0;o=1===this.mediaInfo.framesCount?0:Math.floor(t*this.mediaInfo.fps)%this.mediaInfo.framesCount,r.drawImage(this.image,0,i*o,i,i,0,0,e.width,e.width)}else this.image=new Image,this.isLoading=!0,this.image.onload=function(){n.isLoading=!1,n.isLoaded=!0,n.draw(e,t)},this.image.src=this.url},e}();t.default=r},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._teamsEmotes={smile:{unicode:"smile",unicode_alternates:":smile:",name:"emoticon_smile_name",shortname:"(smile)",shortcuts:":),:-),:=),(smile),(Smile)",category:"emoticons",keywords:"emoticon_smile_keywords",link:"smile_20.png",linkAnim:"smile_20_anim.png"},laugh:{unicode:"laugh",unicode_alternates:":laughing:",name:"emoticon_laugh_name",shortname:"(laugh)",shortcuts:":D,:-D,:=D,:d,:-d,:=d,(laugh),(Laugh),:>,:->,(lol),(LOL),(Lol)",category:"emoticons",keywords:"emoticon_laugh_keywords",link:"laugh_20.png",linkAnim:"laugh_20_anim.png"},heart:{unicode:"heart",unicode_alternates:":heart:",name:"emoticon_heart_name",shortname:"(heart)",shortcuts:"(heart),(Heart),<3",category:"emoticons",keywords:"emoticon_heart_keywords",link:"heart_20.png",linkAnim:"heart_20_anim.png"},kiss:{unicode:"kiss",unicode_alternates:":kiss:",name:"emoticon_kiss_name",shortname:"(kiss)",shortcuts:"(kiss),(Kiss),:*,:-*,:=*,(xo)",category:"emoticons",keywords:"emoticon_kiss_keywords",link:"kiss_20.png",linkAnim:"kiss_20_anim.png"},sad:{unicode:"sad",unicode_alternates:":slight_frown:",name:"emoticon_sad_name",shortname:"(sad)",shortcuts:":(,:-(,:=(,(sad),(Sad),:<,:-<",category:"emoticons",keywords:"emoticon_sad_keywords",link:"sad_20.png",linkAnim:"sad_20_anim.png"},tongueout:{unicode:"tongueout",unicode_alternates:":stuck_out_tongue:",name:"emoticon_tongueout_name",shortname:"(tongueout)",shortcuts:":P,:-P,:=P,:p,:-p,:=p,(tongueout),(Tongueout)",category:"emoticons",keywords:"emoticon_tongueout_keywords",link:"tongueout_20.png",linkAnim:"tongueout_20_anim.png"},wink:{unicode:"wink",unicode_alternates:":wink:",name:"emoticon_wink_name",shortname:"(wink)",shortcuts:";),;-),;=),(wink),(Wink)",category:"emoticons",keywords:"emoticon_wink_keywords",link:"wink_20.png",linkAnim:"wink_20_anim.png"},cry:{unicode:"cry",unicode_alternates:":cry:",name:"emoticon_cry_name",shortname:"(cry)",shortcuts:";(,;-(,;=(,(cry),(Cry),:'(",category:"emoticons",keywords:"emoticon_cry_keywords",link:"cry_20.png",linkAnim:"cry_20_anim.png"},inlove:{unicode:"inlove",unicode_alternates:":heart_eyes:",name:"emoticon_inlove_name",shortname:"(inlove)",shortcuts:"(inlove),(Inlove),(love),(Love),:],:-]",category:"emoticons",keywords:"emoticon_inlove_keywords",link:"inlove_20.png",linkAnim:"inlove_20_anim.png"},hug:{unicode:"hug",unicode_alternates:":hugging:",name:"emoticon_hug_name",shortname:"(hug)",shortcuts:"(hug),(Hug),(bear),(Bear)",category:"emoticons",keywords:"emoticon_hug_keywords",link:"hug_20.png",linkAnim:"hug_20_anim.png"},cwl:{unicode:"cwl",unicode_alternates:":joy:",name:"emoticon_cwl_name",shortname:"(cwl)",shortcuts:"(cwl),(Cwl),(cryingwithlaughter),(Cryingwithlaughter)",category:"emoticons",keywords:"emoticon_cwl_keywords",link:"cwl_20.png",linkAnim:"cwl_20_anim.png"},lips:{unicode:"lips",unicode_alternates:":lips:",name:"emoticon_lips_name",shortname:"(lips)",shortcuts:"(lips),(Lips)",category:"emoticons",keywords:"emoticon_lips_keywords",link:"lips_20.png",linkAnim:"lips_20_anim.png"},blush:{unicode:"blush",unicode_alternates:":blush:",name:"emoticon_blush_name",shortname:"(blush)",shortcuts:':$,:-$,:=$,:">,(blush),(Blush)',category:"emoticons",keywords:"emoticon_blush_keywords",link:"blush_20.png",linkAnim:"blush_20_anim.png"},surprised:{unicode:"surprised",unicode_alternates:":open_mouth:",name:"emoticon_surprised_name",shortname:"(surprised)",shortcuts:":O,:-O,:=O,:o,:-o,:=o,(surprised),(Surprised)",category:"emoticons",keywords:"emoticon_surprised_keywords",link:"surprised_20.png",linkAnim:"surprised_20_anim.png"},penguin:{unicode:"penguin",unicode_alternates:":penguin:",name:"emoticon_penguin_name",shortname:"(penguin)",shortcuts:"(penguin),(Penguin),(dancingpenguin),(Dancingpenguin),(penguindance),(Penguindance)",category:"emoticons",keywords:"emoticon_penguin_keywords",link:"penguin_20.png",linkAnim:"penguin_20_anim.png"},yes:{unicode:"yes",unicode_alternates:":thumbsup:",name:"emoticon_yes_name",shortname:"(yes)",shortcuts:"(y),(Y),(yes),(Yes)",category:"emoticons",keywords:"emoticon_yes_keywords",link:"yes_20.png",linkAnim:"yes_20_anim.png"},cool:{unicode:"cool",unicode_alternates:":sunglasses:",name:"emoticon_cool_name",shortname:"(cool)",shortcuts:"(cool),(Cool),8-),8=),B-),B=)",category:"emoticons",keywords:"emoticon_cool_keywords",link:"cool_20.png",linkAnim:"cool_20_anim.png"},rofl:{unicode:"rofl",unicode_alternates:":laughing:",name:"emoticon_rofl_name",shortname:"(rofl)",shortcuts:"(rofl),(Rofl),(rotfl),(Rotfl)",category:"emoticons",keywords:"emoticon_rofl_keywords",link:"rofl_20.png",linkAnim:"rofl_20_anim.png"},cat:{unicode:"cat",unicode_alternates:":cat:",name:"emoticon_cat_name",shortname:"(cat)",shortcuts:"(cat),(Cat),(@),(meow),(Meow),(kitty),(Kitty)",category:"emoticons",keywords:"emoticon_cat_keywords",link:"cat_20.png",linkAnim:"cat_20_anim.png"},monkey:{unicode:"monkey",unicode_alternates:":monkey_face:",name:"emoticon_monkey_name",shortname:"(monkey)",shortcuts:"(monkey),(Monkey),(ape),(Ape),:(|)",category:"emoticons",keywords:"emoticon_monkey_keywords",link:"monkey_20.png",linkAnim:"monkey_20_anim.png"},hi:{unicode:"hi",unicode_alternates:":wave:",name:"emoticon_hi_name",shortname:"(hi)",shortcuts:"(wave),(Wave),(hi),(Hi),(HI),(bye),(Bye),(BYE)",category:"emoticons",keywords:"emoticon_hi_keywords",link:"hi_20.png",linkAnim:"hi_20_anim.png"},snowangel:{unicode:"snowangel",unicode_alternates:":snowman:",name:"emoticon_snowangel_name",shortname:"(snowangel)",shortcuts:"(snowangel),(Snowangel)",category:"emoticons",keywords:"emoticon_snowangel_keywords",link:"snowangel_20.png",linkAnim:"snowangel_20_anim.png"},flower:{unicode:"flower",unicode_alternates:":blossom:",name:"emoticon_flower_name",shortname:"(flower)",shortcuts:"(flower),(Flower)",category:"emoticons",keywords:"emoticon_flower_keywords",link:"flower_20.png",linkAnim:"flower_20_anim.png"},giggle:{unicode:"giggle",unicode_alternates:":joy:",name:"emoticon_giggle_name",shortname:"(giggle)",shortcuts:"(chuckle),(Chuckle),(giggle),(Giggle)",category:"emoticons",keywords:"emoticon_giggle_keywords",link:"giggle_20.png",linkAnim:"giggle_20_anim.png"},devil:{unicode:"devil",unicode_alternates:":smiling_imp:",name:"emoticon_devil_name",shortname:"(devil)",shortcuts:"(devil),(Devil)",category:"emoticons",keywords:"emoticon_devil_keywords",link:"devil_20.png",linkAnim:"devil_20_anim.png"},party:{unicode:"party",unicode_alternates:":tada:",name:"emoticon_party_name",shortname:"(party)",shortcuts:"(party),(Party),<O),<o),<:o)",category:"emoticons",keywords:"emoticon_party_keywords",link:"party_20.png",linkAnim:"party_20_anim.png"},worry:{unicode:"worry",unicode_alternates:":worried:",name:"emoticon_worry_name",shortname:"(worry)",shortcuts:"(worry),(Worry),:S,:s,:-s,:-S,:=s,:=S,(worried),(Worried)",category:"emoticons",keywords:"emoticon_worry_keywords",link:"worry_20.png",linkAnim:"worry_20_anim.png"},champagne:{unicode:"champagne",unicode_alternates:":champagne:",name:"emoticon_champagne_name",shortname:"(champagne)",shortcuts:"(champagne),(Champagne),(sparkling),(Sparkling)",category:"emoticons",keywords:"emoticon_champagne_keywords",link:"champagne_20.png",linkAnim:"champagne_20_anim.png"},sun:{unicode:"sun",unicode_alternates:":sun_with_face:",name:"emoticon_sun_name",shortname:"(sun)",shortcuts:"(sun),(Sun)",category:"emoticons",keywords:"emoticon_sun_keywords",link:"sun_20.png",linkAnim:"sun_20_anim.png"},star:{unicode:"star",unicode_alternates:":star:",name:"emoticon_star_name",shortname:"(star)",shortcuts:"(star),(Star)",category:"emoticons",keywords:"emoticon_star_keywords",link:"star_20.png",linkAnim:"star_20_anim.png"},polarbear:{unicode:"polarbear",unicode_alternates:":bear:",name:"emoticon_polarbear_name",shortname:"(polarbear)",shortcuts:"(polarbear),(Polarbear),(polarbearhug),(Polarbearhug)",category:"emoticons",keywords:"emoticon_polarbear_keywords",link:"polarbear_20.png",linkAnim:"polarbear_20_anim.png"},dull:{unicode:"dull",unicode_alternates:":unamused:",name:"emoticon_dull_name",shortname:"(dull)",shortcuts:"|-(,|(,|=(,(dull),(Dull)",category:"emoticons",keywords:"emoticon_dull_keywords",link:"dull_20.png",linkAnim:"dull_20_anim.png"},speechless:{unicode:"speechless",unicode_alternates:":astonished:",name:"emoticon_speechless_name",shortname:"(speechless)",shortcuts:":|,:-|,:=|,(speechless),(Speechless)",category:"emoticons",keywords:"emoticon_speechless_keywords",link:"speechless_20.png",linkAnim:"speechless_20_anim.png"},wonder:{unicode:"wonder",unicode_alternates:":thinking_face:",name:"emoticon_wonder_name",shortname:"(wonder)",shortcuts:":^),(wonder),(Wonder)",category:"emoticons",keywords:"emoticon_wonder_keywords",link:"wonder_20.png",linkAnim:"wonder_20_anim.png"},angry:{unicode:"angry",unicode_alternates:":angry:",name:"emoticon_angry_name",shortname:"(angry)",shortcuts:"(angry),(Angry),:@,:-@,:=@,x(,x-(,X(,X-(,x=(,X=(,;@,;-@",category:"emoticons",keywords:"emoticon_angry_keywords",link:"angry_20.png",linkAnim:"angry_20_anim.png"},puke:{unicode:"puke",unicode_alternates:":face_with_thermometer:",name:"emoticon_puke_name",shortname:"(puke)",shortcuts:"(puke),(Puke),:&,:-&,:=&,+o(",category:"emoticons",keywords:"emoticon_puke_keywords",link:"puke_20.png",linkAnim:"puke_20_anim.png"},facepalm:{unicode:"facepalm",unicode_alternates:":tired_face:",name:"emoticon_facepalm_name",shortname:"(facepalm)",shortcuts:"(facepalm),(Facepalm),(fail),(Fail)",category:"emoticons",keywords:"emoticon_facepalm_keywords",link:"facepalm_20.png",linkAnim:"facepalm_20_anim.png"},sweat:{unicode:"sweat",unicode_alternates:":sweat:",name:"emoticon_sweat_name",shortname:"(sweat)",shortcuts:"(:|,(sweat),(Sweat)",category:"emoticons",keywords:"emoticon_sweat_keywords",link:"sweat_20.png",linkAnim:"sweat_20_anim.png"},holidayspirit:{unicode:"holidayspirit",unicode_alternates:":christmas_tree:",name:"emoticon_holidayspirit_name",shortname:"(holidayspirit)",shortcuts:"(holidayspirit),(Holidayspirit),(crazyxmas),(Crazyxmas),(crazychristmas),(Crazychristmas)",category:"emoticons",keywords:"emoticon_holidayspirit_keywords",link:"holidayspirit_20.png",linkAnim:"holidayspirit_20_anim.png"},sleepy:{unicode:"sleepy",unicode_alternates:":sleepy:",name:"emoticon_sleepy_name",shortname:"(sleepy)",shortcuts:"|-),I-),I=),(snooze),(Snooze),(sleepy),(Sleepy)",category:"emoticons",keywords:"emoticon_sleepy_keywords",link:"sleepy_20.png",linkAnim:"sleepy_20_anim.png"},bow:{unicode:"bow",unicode_alternates:":bow:",name:"emoticon_bow_name",shortname:"(bow)",shortcuts:"(bow),(Bow)",category:"emoticons",keywords:"emoticon_bow_keywords",link:"bow_20.png",linkAnim:"bow_20_anim.png"},makeup:{unicode:"makeup",unicode_alternates:":lipstick:",name:"emoticon_makeup_name",shortname:"(makeup)",shortcuts:"(makeup),(Makeup),(kate),(Kate)",category:"emoticons",keywords:"emoticon_makeup_keywords",link:"makeup_20.png",linkAnim:"makeup_20_anim.png"},cash:{unicode:"cash",unicode_alternates:":moneybag:",name:"emoticon_cash_name",shortname:"(cash)",shortcuts:"(cash),(Cash)",category:"emoticons",keywords:"emoticon_cash_keywords",link:"cash_20.png",linkAnim:"cash_20_anim.png"},lipssealed:{unicode:"lipssealed",unicode_alternates:":zipper_mouth_face:",name:"emoticon_lipssealed_name",shortname:"(lipssealed)",shortcuts:":x,:-x,:X,:-X,:#,:-#,:=x,:=X,:=#,(lipssealed),(Lipssealed)",category:"emoticons",keywords:"emoticon_lipssealed_keywords",link:"lipssealed_20.png",linkAnim:"lipssealed_20_anim.png"},shivering:{unicode:"shivering",unicode_alternates:":cold_sweat:",name:"emoticon_shivering_name",shortname:"(shivering)",shortcuts:"(shivering),(Shivering),(cold),(Cold),(freezing),(Freezing)",category:"emoticons",keywords:"emoticon_shivering_keywords",link:"shivering_20.png",linkAnim:"shivering_20_anim.png"},cake:{unicode:"cake",unicode_alternates:":birthday:",name:"emoticon_cake_name",shortname:"(cake)",shortcuts:"(cake),(Cake)",category:"emoticons",keywords:"emoticon_cake_keywords",link:"cake_20.png",linkAnim:"cake_20_anim.png"},headbang:{unicode:"headbang",unicode_alternates:":confounded:",name:"emoticon_headbang_name",shortname:"(headbang)",shortcuts:"(headbang),(Headbang),(banghead),(Banghead)",category:"emoticons",keywords:"emoticon_headbang_keywords",link:"headbang_20.png",linkAnim:"headbang_20_anim.png"},dance:{unicode:"dance",unicode_alternates:":dancer:",name:"emoticon_dance_name",shortname:"(dance)",shortcuts:"o/,:D/,:d/,(dance),(Dance)",category:"emoticons",keywords:"emoticon_dance_keywords",link:"dance_20.png",linkAnim:"dance_20_anim.png"},wasntme:{unicode:"wasntme",unicode_alternates:":see_no_evil:",name:"emoticon_wasntme_name",shortname:"(wasntme)",shortcuts:"(wasntme),(Wasntme),(wm),(Wm)",category:"emoticons",keywords:"emoticon_wasntme_keywords",link:"wasntme_20.png",linkAnim:"wasntme_20_anim.png"},hungover:{unicode:"hungover",unicode_alternates:":face_with_head_bandage:",name:"emoticon_hungover_name",shortname:"(hungover)",shortcuts:"(morningafter),(Morningafter),(hungover),(Hungover)",category:"emoticons",keywords:"emoticon_hungover_keywords",link:"hungover_20.png",linkAnim:"hungover_20_anim.png"},yawn:{unicode:"yawn",unicode_alternates:":sleeping:",name:"emoticon_yawn_name",shortname:"(yawn)",shortcuts:"(yawn),(Yawn)",category:"emoticons",keywords:"emoticon_yawn_keywords",link:"yawn_20.png",linkAnim:"yawn_20_anim.png"},gift:{unicode:"gift",unicode_alternates:":gift:",name:"emoticon_gift_name",shortname:"(gift)",shortcuts:"(gift),(Gift)",category:"emoticons",keywords:"emoticon_gift_keywords",link:"gift_20.png",linkAnim:"gift_20_anim.png"},angel:{unicode:"angel",unicode_alternates:":angel:",name:"emoticon_angel_name",shortname:"(angel)",shortcuts:"(angel),(Angel)",category:"emoticons",keywords:"emoticon_angel_keywords",link:"angel_20.png",linkAnim:"angel_20_anim.png"},xmastree:{unicode:"xmastree",unicode_alternates:":christmas_tree:",name:"emoticon_xmastree_name",shortname:"(xmastree)",shortcuts:"(xmastree),(Xmastree),(christmastree),(Christmastree)",category:"emoticons",keywords:"emoticon_xmastree_keywords",link:"xmastree_20.png",linkAnim:"xmastree_20_anim.png"},brokenheart:{unicode:"brokenheart",unicode_alternates:":broken_heart:",name:"emoticon_brokenheart_name",shortname:"(brokenheart)",shortcuts:"(brokenheart),(Brokenheart)",category:"emoticons",keywords:"emoticon_brokenheart_keywords",link:"brokenheart_20.png",linkAnim:"brokenheart_20_anim.png"},think:{unicode:"think",unicode_alternates:":thinking:",name:"emoticon_think_name",shortname:"(think)",shortcuts:"(think),(Think),:-?,:?,:=?,*-)",category:"emoticons",keywords:"emoticon_think_keywords",link:"think_20.png",linkAnim:"think_20_anim.png"},clap:{unicode:"clap",unicode_alternates:":clap:",name:"emoticon_clap_name",shortname:"(clap)",shortcuts:"(clap),(Clap)",category:"emoticons",keywords:"emoticon_clap_keywords",link:"clap_20.png",linkAnim:"clap_20_anim.png"},punch:{unicode:"punch",unicode_alternates:":punch:",name:"emoticon_punch_name",shortname:"(punch)",shortcuts:"(punch),(Punch),*|,*-|",category:"emoticons",keywords:"emoticon_punch_keywords",link:"punch_20.png",linkAnim:"punch_20_anim.png"},envy:{unicode:"envy",unicode_alternates:":angry:",name:"emoticon_envy_name",shortname:"(envy)",shortcuts:"(envy),(Envy)",category:"emoticons",keywords:"emoticon_envy_keywords",link:"envy_20.png",linkAnim:"envy_20_anim.png"},handshake:{unicode:"handshake",unicode_alternates:":ok_hand:",name:"emoticon_handshake_name",shortname:"(handshake)",shortcuts:"(handshake),(Handshake)",category:"emoticons",keywords:"emoticon_handshake_keywords",link:"handshake_20.png",linkAnim:"handshake_20_anim.png"},nod:{unicode:"nod",unicode_alternates:":thumbsup:",name:"emoticon_nod_name",shortname:"(nod)",shortcuts:"(nod),(Nod)",category:"emoticons",keywords:"emoticon_nod_keywords",link:"nod_20.png",linkAnim:"nod_20_anim.png"},nerdy:{unicode:"nerdy",unicode_alternates:":nerd:",name:"emoticon_nerdy_name",shortname:"(nerdy)",shortcuts:"(nerd),(Nerd),8-|,B-|,8|,B|,8=|,B=|,(nerdy),(Nerdy)",category:"emoticons",keywords:"emoticon_nerdy_keywords",link:"nerdy_20.png",linkAnim:"nerdy_20_anim.png"},emo:{unicode:"emo",unicode_alternates:":cry:",name:"emoticon_emo_name",shortname:"(emo)",shortcuts:"(emo),(Emo)",category:"emoticons",keywords:"emoticon_emo_keywords",link:"emo_20.png",linkAnim:"emo_20_anim.png"},muscle:{unicode:"muscle",unicode_alternates:":muscle:",name:"emoticon_muscle_name",shortname:"(muscle)",shortcuts:"(flex),(Flex),(muscle),(Muscle)",category:"emoticons",keywords:"emoticon_muscle_keywords",link:"muscle_20.png",linkAnim:"muscle_20_anim.png"},mmm:{unicode:"mmm",unicode_alternates:":thinking_face:",name:"emoticon_mmm_name",shortname:"(mmm)",shortcuts:"(mm),(Mm),(mmm),(Mmm),(mmmm),(Mmmm)",category:"emoticons",keywords:"emoticon_mmm_keywords",link:"mmm_20.png",linkAnim:"mmm_20_anim.png"},ok:{unicode:"ok",unicode_alternates:":ok_hand:",name:"emoticon_ok_name",shortname:"(ok)",shortcuts:"(ok),(OK),(oK),(Ok),(okay),(Okay)",category:"emoticons",keywords:"emoticon_ok_keywords",link:"ok_20.png",linkAnim:"ok_20_anim.png"},highfive:{unicode:"highfive",unicode_alternates:":raised_hand:",name:"emoticon_highfive_name",shortname:"(highfive)",shortcuts:"(highfive),(Highfive),(hifive),(Hifive),(h5),(H5)",category:"emoticons",keywords:"emoticon_highfive_keywords",link:"highfive_20.png",linkAnim:"highfive_20_anim.png"},turkey:{unicode:"turkey",unicode_alternates:":turkey:",name:"emoticon_turkey_name",shortname:"(turkey)",shortcuts:"(turkey),(Turkey),(turkeydance),(Turkeydance),(thanksgiving),(Thanksgiving)",category:"emoticons",keywords:"emoticon_turkey_keywords",link:"turkey_20.png",linkAnim:"turkey_20_anim.png"},call:{unicode:"call",unicode_alternates:":calling:",name:"emoticon_call_name",shortname:"(call)",shortcuts:"(call),(Call)",category:"emoticons",keywords:"emoticon_call_keywords",link:"call_20.png",linkAnim:"call_20_anim.png"},movember:{unicode:"movember",unicode_alternates:":guardsman:",name:"emoticon_movember_name",shortname:"(movember)",shortcuts:"(movember),(Movember),(mo),(Mo),(november),(November),(moustache),(Moustache),(mustache),(Mustache),(bowman),(Bowman),:{",category:"emoticons",keywords:"emoticon_movember_keywords",link:"movember_20.png",linkAnim:"movember_20_anim.png"},dog:{unicode:"dog",unicode_alternates:":dog:",name:"emoticon_dog_name",shortname:"(dog)",shortcuts:"(dog),(Dog),:o3,(&)",category:"emoticons",keywords:"emoticon_dog_keywords",link:"dog_20.png",linkAnim:"dog_20_anim.png"},coffee:{unicode:"coffee",unicode_alternates:":coffee:",name:"emoticon_coffee_name",shortname:"(coffee)",shortcuts:"(coffee),(Coffee)",category:"emoticons",keywords:"emoticon_coffee_keywords",link:"coffee_20.png",linkAnim:"coffee_20_anim.png"},poke:{unicode:"poke",unicode_alternates:":point_right:",name:"emoticon_poke_name",shortname:"(poke)",shortcuts:"(poke),(Poke),(nudge),(Nudge)",category:"emoticons",keywords:"emoticon_poke_keywords",link:"poke_20.png",linkAnim:"poke_20_anim.png"},swear:{unicode:"swear",unicode_alternates:":angry:",name:"emoticon_swear_name",shortname:"(swear)",shortcuts:"(swear),(Swear)",category:"emoticons",keywords:"emoticon_swear_keywords",link:"swear_20.png",linkAnim:"swear_20_anim.png"},donttalktome:{unicode:"donttalktome",unicode_alternates:":angry:",name:"emoticon_donttalktome_name",shortname:"(donttalktome)",shortcuts:"(donttalk),(Donttalk),(donttalktome),(Donttalktome)",category:"emoticons",keywords:"emoticon_donttalktome_keywords",link:"donttalktome_20.png",linkAnim:"donttalktome_20_anim.png"},fingerscrossed:{unicode:"fingerscrossed",unicode_alternates:":pray:",name:"emoticon_fingerscrossed_name",shortname:"(fingerscrossed)",shortcuts:"(yn),(Yn),(fingers),(Fingers),(fingerscrossed),(Fingerscrossed),(crossedfingers),(Crossedfingers)",category:"emoticons",keywords:"emoticon_fingerscrossed_keywords",link:"fingerscrossed_20.png",linkAnim:"fingerscrossed_20_anim.png"},rainbow:{unicode:"rainbow",unicode_alternates:":rainbow:",name:"emoticon_rainbow_name",shortname:"(rainbow)",shortcuts:"(rainbow),(Rainbow)",category:"emoticons",keywords:"emoticon_rainbow_keywords",link:"rainbow_20.png",linkAnim:"rainbow_20_anim.png"},headphones:{unicode:"headphones",unicode_alternates:":headphones:",name:"emoticon_headphones_name",shortname:"(headphones)",shortcuts:"(headphones),(Headphones)",category:"emoticons",keywords:"emoticon_headphones_keywords",link:"headphones_20.png",linkAnim:"headphones_20_anim.png"},waiting:{unicode:"waiting",unicode_alternates:":alarm_clock:",name:"emoticon_waiting_name",shortname:"(waiting)",shortcuts:"(waiting),(Waiting),(forever),(Forever),(impatience),(Impatience)",category:"emoticons",keywords:"emoticon_waiting_keywords",link:"waiting_20.png",linkAnim:"waiting_20_anim.png"},festiveparty:{unicode:"festiveparty",unicode_alternates:":tada:",name:"emoticon_festiveparty_name",shortname:"(festiveparty)",shortcuts:"(festiveparty),(Festiveparty),(partyxmas),(Partyxmas)",category:"emoticons",keywords:"emoticon_festiveparty_keywords",link:"festiveparty_20.png",linkAnim:"festiveparty_20_anim.png"},bandit:{unicode:"bandit",unicode_alternates:":spy:",name:"emoticon_bandit_name",shortname:"(bandit)",shortcuts:"(bandit),(Bandit)",category:"emoticons",keywords:"emoticon_bandit_keywords",link:"bandit_20.png",linkAnim:"bandit_20_anim.png"},heidy:{unicode:"heidy",unicode_alternates:":hamster:",name:"emoticon_heidy_name",shortname:"(heidy)",shortcuts:"(squirrel),(Squirrel),(heidy),(Heidy)",category:"emoticons",keywords:"emoticon_heidy_keywords",link:"heidy_20.png",linkAnim:"heidy_20_anim.png"},beer:{unicode:"beer",unicode_alternates:":beer:",name:"emoticon_beer_name",shortname:"(beer)",shortcuts:"(beer),(Beer),(bricklayers),(Bricklayers)",category:"emoticons",keywords:"emoticon_beer_keywords",link:"beer_20.png",linkAnim:"beer_20_anim.png"},doh:{unicode:"doh",unicode_alternates:":dizzy_face:",name:"emoticon_doh_name",shortname:"(doh)",shortcuts:"(doh),(Doh)",category:"emoticons",keywords:"emoticon_doh_keywords",link:"doh_20.png",linkAnim:"doh_20_anim.png"},bomb:{unicode:"bomb",unicode_alternates:":bomb:",name:"emoticon_bomb_name",shortname:"(bomb)",shortcuts:"(bomb),(Bomb),(explosion),(Explosion),(explode),(Explode),@=",category:"emoticons",keywords:"emoticon_bomb_keywords",link:"bomb_20.png",linkAnim:"bomb_20_anim.png"},happy:{unicode:"happy",unicode_alternates:":smile:",name:"emoticon_happy_name",shortname:"(happy)",shortcuts:"(happy),(Happy)",category:"emoticons",keywords:"emoticon_happy_keywords",link:"happy_20.png",linkAnim:"happy_20_anim.png"},ninja:{unicode:"ninja",unicode_alternates:":spy:",name:"emoticon_ninja_name",shortname:"(ninja)",shortcuts:"(ninja),(Ninja)",category:"emoticons",keywords:"emoticon_ninja_keywords",link:"ninja_20.png",linkAnim:"ninja_20_anim.png"}},t.getConfiguration=function(){return new Promise(function(e,n){t.config?e(t.config):t.init().then(function(t){e(t)})})},t}return i(t,e),t.prototype._filterConfiguration=function(e){var t=Object.keys(this._teamsEmotes),n=function(e){for(var n in t)if(t[n]===e)return!0;return!1};for(var r in e.items=e.items.filter(function(e){return n(e.id)}),e.packs)e.packs[r].items=e.packs[r].items.filter(function(e){return n(e.id)});return e},t.prototype.init=function(){var e=this;return new Promise(function(t,n){e.initSkype().then(function(n){e.config=e._filterConfiguration(n),t(e.config)})})},t}(n(146).default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(20),o=n(53),s=n(3),a=n(318),c=n(319),u=function(){function e(){this.updateFileName=function(e,t){var n="$1 ("+t+")$2";return e.replace(/^(.+)(\.[\w\d]+)$/g,n)},this.checkFile=function(e){var t=s.default.mePerson.personalFileSite.personalRootFolderUrl.match(/^https?:\/\/[^\/]+(.*)\/?$/),n=(t[0],{parentServerRelativeUrl:t[1]+"/Microsoft Teams Chat Files",itemName:e,createBlankFile:!1,overwrite:!1}),i=o.addGetParamsToUrl(r.default.TEAMS_PROFILE_URL+"api/mt/amer/beta/me/files",n);return new Promise(function(e,t){a.post("api.teams.microsoft.com",i,"").then(function(n){if(n.errorCode&&"FilenameCollision"===n.errorCode)return t(n);e(n)})})},this.downloadFile=function(e){var t="_api/web/GetFileByServerRelativeUrl('"+e.fileInfo.serverRelativeUrl+"')/GetPreAuthorizedAccessUrl(1)";return a.get("SharepointService.downloadFile",""+e.baseUrl+t).then(function(e){return a.getData("SharepointService.downloadFile",e.value)})}}return e.prototype.uploadFile=function(e){var t=this,n=function(r,i){return void 0===i&&(i=0),new Promise(function(o){t.checkFile(r).then(function(e){return o(e.value)}).catch(function(r){return n(t.updateFileName(e.name,++i),i).then(o)})})};return new Promise(function(t,r){n(e.name).then(function(n){return function(e,n){var o=s.default.mePerson.personalFileSite,a=i.guid.generate(),u="_api/web/GetFolderByServerRelativeUrl(@folder)/Files/getByUrlOrAddStub(@file)/StartUpload(uploadId=guid'"+a+"')",l="@folder='"+n.siteInfo.relativeUrl+"'&@file='"+n.title+"'",p=""+o.personalSiteUrl+u+"?"+l,d=function(t){var r="_api/web/GetFolderByServerRelativeUrl(@folder)/Files/getByUrlOrAddStub(@file)/FinishUpload(uploadId=guid'"+a+"',fileOffset="+e.size+")",i=""+o.personalSiteUrl+r+"?"+l;c.post(i,"").then(function(){return t(n)})};c.post(p,e).then(function(){return d(t)}).catch(function(){return d(r)})}(e,n)})})},e.prototype.shareFile=function(e,t){var n=r.default.SHAREPOINT_URL+"_api/SP.Sharing.DocumentSharingManager.UpdateDocumentSharingInfo",i={additiveMode:!1,customMessage:"Shared a file",includeAnonymousLinksInNotification:!0,resourceAddress:e,sendServerManagedNotification:!1,userRoleAssignments:t.map(function(e){return{Role:2,UserId:e}}),validateExistingPermissions:!1};return c.postJson(n,JSON.stringify(i))},e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(102),o=n(3),s=n(55),a=n(16),c={retryCount:3,timeout:12e4,policy:""};t.post=function(e,n,r){return t.getHeaders().then(function(t){return function(e,t,n){return a.default("sharepoint-"+e,c,t,n)}(e,n,{method:"POST",cache:"no-cache",headers:t,body:r}).then(function(e){return e.json()})})},t.getHeaders=function(e){return void 0===e&&(e=s.AadAudience.SpacesApi),new Promise(function(t){Promise.all([o.default.signInManager.aad(e),o.default.signInManager.getSkypeToken()]).then(function(e){var n=e[0],i=e[1],o=new Headers;o.append("Authorization",n),o.append("x-skypetoken",i),o.append("x-skype-client",r.default.getClientVersion()),t(o)})})},t.get=function(e,n){var r=n.match(/^(https?:\/\/[^\/]+).*\/?$/),o=(r[0],r[1]);return t.getHeaders(o).then(function(t){var r={method:"GET"};return r.headers=t,r.headers.append("Accept","application/json"),i.request(e,n,r).then(function(e){return e.json()})})},t.getData=function(e,t){var n=new Headers;n.append("Accept","text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8"),n.append("Accept-Encoding","gzip, deflate, sdch, br");var r={method:"GET"};return r.headers=n,i.request(e,t,r).then(function(e){return e.blob()})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(55),s=n(16),a={retryCount:3,timeout:12e4,policy:""},c=function(e,t,n){return s.default("sharepoint-"+e,a,t,n)};t.postJson=function(e,n){return t.getHeaders("application/json").then(function(t){return c("sharepoint",e,{method:"POST",cache:"no-cache",headers:t,body:n}).then(function(e){try{return e.json()}catch(t){return e}})})},t.post=function(e,n){return t.getHeaders().then(function(t){return c("sharepoint",e,{method:"POST",cache:"no-cache",headers:t,body:n}).then(function(e){try{return e.json()}catch(t){return e}})})},t.getHeaders=function(e){return new Promise(function(t){i.default.signInManager.aad(o.SHAREPOINT_AAD_AUD).then(function(n){var i=new Headers;i.append("Authorization",n),i.append("x-skype-client",r.default.getClientVersion()),i.append("Accept","application/json"),e&&i.append("content-type",e),t(i)})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(10),o=n(11),s=n(20),a=n(147),c=n(3),u=n(321),l=function(){function e(){this._profiles={}}return e.prototype.fetchProfiles=function(e){var t=this;return this.getEcsConfig().then(function(){var n="?requestid="+t.getAppDataParams()+"&locale="+r.default.LOCALE+"&searchstring="+e;return u.get("namesearch",n).then(function(e){return e&&e.results.forEach(function(e){var t=c.default.persons.getPerson(e.nodeProfileData.skypeId,!1,!1);t.displayName=e.nodeProfileData.name,t.avatarData=e.nodeProfileData.avatarUrl}),e})},this.searchV1.bind(this,e))},e.prototype.searchV1=function(e){var t="search/v1.1/namesearch/swx/?requestid="+this.getAppDataParams()+"&locale="+r.default.LOCALE+"&searchstring="+e;return u.get("namesearch",t)},e.prototype.getAppDataParams=function(){return[r.default.APPNAME,r.default.ECS.version,s.guid.generate()].join("-")},e.prototype.getEcsConfig=function(){if(e.getEcsConfigPromise)return e.getEcsConfigPromise;var t={id:c.default.signInManager.currentUserName};return e.getEcsConfigPromise=a.configLoader(a.EcsClient.Skype,t).then(function(e){r.default.ECS_GRAPH_ETAG=e.Headers.ETag;var t=e.PeopleSearch?e.PeopleSearch:void 0;if(t&&t.v2Endpoint&&(r.default.ECS_GRAPH_URL=t.v2Endpoint),t&&t.serviceSettings){var n=t.serviceSettings;r.default.ECS_GRAPH_SERVICE_SETTINGS="experiment="+n.experiment+";geoProximity="+n.geoProximity}},function(e){throw o.default.throwError(i.ErrorCodes.ERR_GET_ADVANCED_SEARCH_PARAMS,"Unable to get advanced search params",e),e}),e.getEcsConfigPromise},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(16),o=n(322),s={retryCount:3,timeout:12e4,policy:""};t.get=function(e,t){return o.getHeaders().then(function(n){var o={method:"GET"};return o.headers=n,o.cache="no-cache",function(e,t,n){return i.default("skypegraph-"+e,s,r.default.ECS_GRAPH_URL+t,n)}(e,t,o).then(function(e){return e.json()})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(3);t.getHeaders=function(){return new Promise(function(e){i.default.signInManager.getSkypeToken().then(function(t){var n=new Headers;n.append("x-skypetoken",t),n.append("x-skype-client",r.default.getClientVersion()),r.default.ECS_GRAPH_ETAG&&n.append("x-ecs-etag",r.default.ECS_GRAPH_ETAG),r.default.ECS_GRAPH_SERVICE_SETTINGS&&n.append("x-skypegraphservicesettings",r.default.ECS_GRAPH_SERVICE_SETTINGS),e(n)},function(){})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(324),o=function(){function e(){this.timeout=0,this.idInQueue=[]}return e.prototype.fetchMeProperties=function(){return i.get("fetchMeProfiles","users/self/profile")},e.prototype.fetchPerson=function(e){var t=this;return this.idInQueue.push(e),10!==this.idInQueue.length?this.idInQueue.length>1?this.idInQueuePromise:(this.idInQueuePromise=new Promise(function(e,n){t.lastCreatedRequest=function(){t.fetchPersons(t.idInQueue).then(e,n),t.idInQueue=[],clearTimeout(t.timeout)},t.timeout=setTimeout(t.lastCreatedRequest,2e3)}),this.idInQueuePromise):(this.lastCreatedRequest(),this.idInQueuePromise)},e.prototype.getAvatarUrl=function(e){return r.default.STRATUS_DOMAIN_HOST_URL+"users/"+e+"/profile/avatar?cacheHeaders=1"},e.prototype.fetchPersons=function(e){var t={usernames:e};return i.post("fetchPersons","batch/profiles",JSON.stringify(t))},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(16),o=n(325),s={retryCount:3,timeout:12e4,policy:""},a=function(e,t,n){return i.default("stratus-"+e,s,r.default.STRATUS_DOMAIN_HOST_URL+t,n)};t.put=function(e,t,n){return o.putHeaders().then(function(r){var i={method:"PUT"};return i.body=n,i.headers=r,a(e,t,i)})},t.post=function(e,t,n){return o.getHeaders().then(function(r){r.append("Content-Type","application/json");var i={method:"POST"};return i.body=n,i.headers=r,a(e,t,i).then(function(e){return e.json()})})};t.get=function(e,t){return o.getHeaders().then(function(n){var o={method:"GET"};return o.headers=n,function(e,t,n,o){return i.default("stratus-"+e,s,(o||r.default.STRATUS_DOMAIN_HOST_URL)+t,n).then(function(e){return e.json()})}(e,t,o)})},t.getData=function(e,t){return o.getDataHeaders().then(function(n){var o={method:"GET"};return o.headers=n,function(e,t,n,o){return i.default("stratus-"+e,s,(o||r.default.STRATUS_DOMAIN_HOST_URL)+t,n).then(function(e){return e.blob()})}(e,t,o)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(3);function o(e){var t=new Headers;return e&&t.append("X-Skypetoken",e),t.append("X-Stratus-Caller",r.default.getUiVersion()),t}t.putHeaders=function(){return new Promise(function(e){i.default.signInManager.getSkypeToken().then(function(t){var n=o(t);n.append("Content-Type","application/x-www-form-urlencoded"),e(n)},function(){})})},t.getHeaders=function(){return new Promise(function(e){i.default.signInManager.getSkypeToken().then(function(t){var n=o(t);e(n)},function(){})})},t.getProxyHeaders=function(){return new Promise(function(e){var t=o();t.append("Accept","application/json, text/javascript"),e(t)})},t.getDataHeaders=function(){return new Promise(function(e){i.default.signInManager.getSkypeToken().then(function(t){var n=o(t);n.append("Accept","image/webp,image/*,*/*;q=0.8"),n.append("Accept-Encoding","gzip, deflate, sdch"),e(n)},function(){})})},t.getDataProxyHeaders=function(){return new Promise(function(e){var t=o();t.append("Accept","image/webp,image/*,*/*;q=0.8"),t.append("Accept-Encoding","gzip, deflate, sdch"),e(t)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(143),o=n(3),s=n(16),a=function(){function e(){this.ongoingRequest={}}return e.prototype.fetchMeProperties=function(){return Promise.resolve()},e.prototype.fetchShortProfile=function(e){return o.default.signInManager.aad().then(function(t){return s.default("teams-shortProfile",{retryCount:1,timeout:12e4,policy:""},r.default.TEAMS_PROFILE_URL+"api/mt/amer/beta/users/fetchShortProfile?isMailAddress=false&enableGuest=true&skypeTeamsInfo=true",{method:"post",headers:{Authorization:t,"x-ms-client-type":"web","x-ms-user-type":"user","content-type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json?e.json().then(function(e){return e.value}):Promise.reject("Unable to fetch person")})})},e.prototype.fetchPerson=function(e){var t=this,n=e.indexOf("8:")>-1?e:"8:"+e;return this.ongoingRequest[n]?this.ongoingRequest[n]:(this.ongoingRequest[n]=new Promise(function(e,i){o.default.signInManager.aad().then(function(a){s.default("teams-shortProfile",{retryCount:1,timeout:12e4,policy:""},r.default.TEAMS_PROFILE_URL+"api/mt/amer/beta/users/fetchShortProfile?isMailAddress=false&enableGuest=true&skypeTeamsInfo=true",{method:"post",headers:{Authorization:a,"x-ms-client-type":"web","x-ms-user-type":"user","content-type":"application/json"},body:JSON.stringify([n])}).then(function(r){r.json&&r.json().then(function(t){var n=t.value.map(function(e){return o.default.avatarService.fetchAvatars(t.value[0].mri,t.value[0].displayName)});Promise.all(n).then(function(n){var r=t.value.map(function(e,t){return{avatarUrl:"",username:e.mri,displayname:e.displayName,avatarData:n[t]}});e(r)})},function(e){delete t.ongoingRequest[n],i(e)})},function(e){delete t.ongoingRequest[n],i(e)})},i)}),this.ongoingRequest[n])},e.prototype.saveContactInfo=function(e){o.default.contactsService.addContact(e.mri,"",i.default.createContactFromShortProfile(e))},e.prototype.getAvatarUrl=function(e){return""},e.prototype.fetchPersons=function(e){return Promise.resolve([])},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(328),o=function(){function e(){}return e.prototype.fetchProfiles=function(e){if(e.length>3){return new Promise(function(t){i.post("search","https://teams.microsoft.com/api/mt/amer/beta/users/search?includeDLs=true&includeBots=true&enableGuest=true&skypeTeamsInfo=true",e).then(function(e){e.value&&e.value.forEach(function(e){if(e.mri){var t=r.default.persons.getPerson(e.mri,!1,!1);t.displayName=e.displayName,t.email=e.email,t.description=e.jobTitle,r.default.avatarService.fetchAvatars(e.mri,e.displayName).then(function(e){e&&(t.avatarData=e)})}}),t(e.value)})})}return Promise.resolve([])},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(55),s=n(16),a={retryCount:3,timeout:12e4,policy:""};t.post=function(e,n,r){return t.getHeaders().then(function(t){return function(e,t,n){return s.default("teamsgraph-"+e,a,t,n)}(e,n,{method:"POST",cache:"no-cache",headers:t,body:r}).then(function(e){return e.json()})})},t.getHeaders=function(){return new Promise(function(e){Promise.all([i.default.signInManager.aad(o.SKYPE_AAD_AUD),i.default.signInManager.getSkypeToken()]).then(function(t){var n=t[0],i=t[1],o=new Headers;o.append("Authorization",n),o.append("x-skypetoken",i),o.append("x-skype-client",r.default.getClientVersion()),e(o)})})}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),s=n(2),a=n(24),c=n(5),u=n(8),l=function(e){function t(){var t=e.call(this,"kpi_inapp_activity_start")||this;return t.foregroundStartTime="",t}return i(t,e),t.send=function(e){o.default.signInManager.getSkypeToken().then(function(){var n=new t;n.entryPoint=e,n.foregroundStartTime=Date.now()+"",n.userName=o.default.signInManager.currentUserName,o.default.telemetryManager.sendEvent(n)},function(){}).catch()},t.prototype.getCustomProperties=function(){var e=new Array;return e.push(c.TelemetryPropertyValue.Create("Foreground_Start_Time",this.foregroundStartTime||u.NA)),e.push(c.TelemetryPropertyValue.Create("Entry_Point",this.entryPoint||u.NA)),e.push(c.TelemetryPropertyValue.Create("Skype_InitiatingUser_Username",this.userName||u.NA)),e.push(c.TelemetryPropertyValue.Create("Platform_Uiversion",s.default.getUiVersion())),e.push(c.TelemetryPropertyValue.Create("DeviceInfo_OsVersion",a.default.getOsVersion())),e.push(c.TelemetryPropertyValue.Create("Client_Name","SWC")),e.push(c.TelemetryPropertyValue.Create("ETag",u.NA)),e},t}(u.TelemetryEvent);t.default=l},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=function(){function t(){}return t.translate=function(e,t,n){var r="https://dev.microsofttranslator.com/api/skype/translate?from="+e+"&to="+t+"&text="+n;return this._requestWithToken(r)},t.detect=function(t){var n="https://f3cc4fc2.ngrok.io/detect?text="+t;return new Promise(function(t,r){return e(encodeURI(n),{method:"GET"}).then(function(e){e.json().then(function(e){var n=e.string.$t.split("-")[0];t(n)}).catch(function(e){r(e)})},function(e){r(e)})})},t.getLanguages=function(){return this._requestWithToken("https://dev.microsofttranslator.com/api/languages")},t._requestWithToken=function(t){var n=new Headers,i={};return new Promise(function(o,s){r.default.signInManager.getSkypeToken().then(function(r){return n.append("Content-Type","application/x-www-form-urlencoded"),n.append("X-Skypetoken",r),n.append("X-ScenarioId","FF63883DDDED40068EC45030A601460C"),i.method="GET",i.headers=n,e(encodeURI(t),i).then(function(e){e.json().then(function(e){o(e)}).catch(function(e){s(e)})},function(e){s(e)})})})},t}();t.default=i}).call(this,n(61))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(332),i=function(){function e(){this._conversations={}}return e.prototype.get=function(e,t){return this._conversations.hasOwnProperty(e)||(this._conversations[e]=new r.default(e,t)),this._conversations[e]},e}();t.default=i},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(111),s=n(4),a=n(1),c=n(18),u=n(40),l=n(10),p=n(13),d=n(26),f=n(0),h=n(46),g=n(11),m=n(31),_=n(333),y=n(7),v=n(334),b=n(335),P=n(25),T=n(141),w=function(e){function t(t,n){var r=e.call(this)||this;return r._definition=n,r.backend=p.MessagingBackend.UNDETERMINED,r.isAgent=function(){return!!r.id&&("28"===r.id.split(":")[0]||"99"===r.id.split(":")[0])},r.isGroup=function(){return!!r.id&&0===r.id.indexOf("19:")},r.isPerson=function(){return!!r.id&&(0===r.id.indexOf("8:")||0===r.id.indexOf("2:"))},r.messagesReceived=0,r.messagesSent=0,r.sdkMode=d.SDKMode.UNDEFINED,r._contextAad="",r._isChatEnabled=!0,r._topic="",r._alertsOff=!1,r.sendLiveState=function(){return r._messagingService.sendLiveState()},r.download=function(e){return r.externalDownload&&f.swc.API.triggerEvent(s.ApiEvents.conversationProxy.resDownload,{refId:r.refId,url:e})},r.setupProxy=function(){var e=function(e){return e===r.id};r._isOneOnOne||f.swc.API.registerEvent(s.ApiEvents.conversationProxy.connected,function(t){e(t.id)&&r.heartBeat&&(t.connected?r.heartBeat.connect():r.heartBeat.disconnect())}),f.swc.API.registerEvent(s.ApiEvents.conversationProxy.regMessageReceived,function(t){e(t.id)&&(r.refId=r.refId||t.refId,r.messageReceivedProxied=!0)}),f.swc.API.registerEvent(s.ApiEvents.conversationProxy.regDownload,function(t){e(t.id)&&(r.refId=r.refId||t.refId,r.externalDownload=!0)})},r._id=t,r.sdkMode=m.default.getSdkModeFromId(r._id),r._messages=new u.ObservableCollection,r._allMessages=new u.ObservableCollection,r._participants=new u.ObservableCollection,r._messagingService=r.isDirectLineBackend()?new v.default(r):new b.default(r),r._isControlOpen=!1,r._consumptionHorizon=new T.ConsumptionHorizon,r._unreadMessagesCount=0,r.isActive=!0,r._isOneOnOne=r.getConversationType()!==y.ConversationType.GROUP,r._isOneOnOne||(r.heartBeat=new _.HeartBeat(r.sendLiveState)),r.setupProxy(),r.members=[],r}return i(t,e),Object.defineProperty(t.prototype,"allMessages",{get:function(){return this._allMessages},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"avatar",{get:function(){return this._avatar},set:function(e){((e=h.default.resolveConversationAvatar(this.isGroup(),e))||e!==this._avatar)&&(this._avatar=e,this.publish("avatar",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"consumptionHorizon",{get:function(){return this._consumptionHorizon},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contextAad",{get:function(){return this._contextAad},set:function(e){e=(e=P.default.dompurify.sanitize(e,{ALLOWED_TAGS:[],ALLOWED_ATTR:[]})).replace(/["()\'/+*`~!@#$%^\[\]:=]/g,""),this._contextAad=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return this._definition},set:function(e){this._definition=e,this.publish("definition",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(e){e!==this._id&&(this._id=e,this.publish("id",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isActive",{get:function(){return this._isActive},set:function(e){var t=e&&e!==this._isActive;this._isActive=e,t&&this.markAsRead()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBlocked",{get:function(){return this._isBlocked},set:function(e){e!==this._isBlocked&&(this._isBlocked=e,this.publish("isBlocked",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isChatEnabled",{get:function(){return this._isChatEnabled},set:function(e){e!==this._isChatEnabled&&(this._isChatEnabled=e,this.publish("isChatEnabled",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isControlOpen",{get:function(){return this._isControlOpen},set:function(e){this._isControlOpen=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return this._isLoaded},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isNew",{get:function(){return this._isNew},set:function(e){e!==this._isNew&&(this._isNew=e,this.publish("isNew",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isOneOnOne",{get:function(){return this._isOneOnOne},set:function(e){this._isOneOnOne!==e&&(this._isOneOnOne="true"===e,this.publish("isOneOnOne",this._isOneOnOne))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isUnderQuarantine",{get:function(){return this._isUnderQuarantine},set:function(e){e!==this._isUnderQuarantine&&(this._isUnderQuarantine=e,this.publish("isUnderQuarantine",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"members",{get:function(){return this._members},set:function(e){this._members=e,this.publish("members",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"messages",{get:function(){return this._messages},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"participants",{get:function(){return this._participants},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selfParticipant",{get:function(){return this._selfParticipant},set:function(e){e!==this._selfParticipant&&(this._selfParticipant=e,this.publish("selfParticipant",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topic",{get:function(){return this._topic},set:function(e){e!==this._topic&&(this._topic=e,this.publish("topic",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unreadMessagesCount",{get:function(){return this._unreadMessagesCount},set:function(e){this._unreadMessagesCount!==e&&(this._unreadMessagesCount=e,this.publish("unreadMessagesCount",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alertsOff",{get:function(){return this._alertsOff},set:function(e){e!==this._alertsOff&&(this._alertsOff=e,this.publish("alertsOff",e))},enumerable:!0,configurable:!0}),t.prototype.addBotToThread=function(e){this._messagingService.addBotToThread(e)},t.prototype.addParticipant=function(e){this._messagingService.addParticipantToThread(e)},t.prototype.deleteConversation=function(){return this._messagingService.deleteConversation(this.id)},t.prototype.deleteMessage=function(e){return this._messagingService.deleteMessage(e)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._contextAad="",this._messages&&(this._messages.forEach(function(e){e.dispose()}),this._messages.dispose(),this._messages.spliceObservable(0,this._messages.length)),this._participants.dispose(),this._isDisposed=!0,this._messagingService.dispose()},t.prototype.editMessage=function(e,t){return this._messagingService.editMessage(e,t)},t.prototype.getBackend=function(){if(this.backend!==p.MessagingBackend.UNDETERMINED)return this.backend;switch(this.id.split(":")[0]){case"8":case"28":case"19":this.backend=p.MessagingBackend.SKYPE;break;case"99":this.backend=p.MessagingBackend.DIRECT_LINE;break;default:return p.MessagingBackend.UNDETERMINED}return this.backend},t.prototype.getConversationType=function(){if(0===this._id.indexOf("http"))return y.ConversationType.JOIN;if(this.isDirectLineBackend())return y.ConversationType.AGENT;switch(this._id.split(":")[0]){case"4":return y.ConversationType.PHONE;case"8":return y.ConversationType.PERSON;case"28":case"99":return y.ConversationType.AGENT;case"19":return y.ConversationType.GROUP;default:return y.ConversationType.UNDEFINED}},t.prototype.getReceviedMessagesCount=function(){return 0},t.prototype.getSentMessagesCount=function(){return 0},t.prototype.isDirectLineBackend=function(){return this.getBackend()===p.MessagingBackend.DIRECT_LINE},t.prototype.isSkypeBackend=function(){return this.getBackend()===p.MessagingBackend.SKYPE},t.prototype.isWithMe=function(){return this.getConversationType()===y.ConversationType.PERSON&&m.default.isEqual(this.id,a.default.instance.SignInManager.currentUserName)},t.prototype.loadMoreMessages=function(){return this._messagingService.loadMoreMessages(this)},t.prototype.markAsRead=function(){this._messagingService.markAsRead()},t.prototype.removeMessageProperty=function(e,t,n,r){return this._messagingService.removeMessageProperty(e,t,n,r)},t.prototype.removeParticipant=function(e){return this._messagingService.removeParticipantFromThread(e)},t.prototype.sendDataToBot=function(e){if(this.getConversationType()===y.ConversationType.GROUP){var t=this.participants.filter(function(e){return e.person.isAgent});if(t.length>0)return this._messagingService.sendDataToBot(m.default.toFullIdentifier(t[0].person.id),e)}return this.isAgent()?this._messagingService.sendDataToBot(this.id,e):Promise.resolve()},t.prototype.sendFile=function(e){return f.swc.API.triggerEvent(s.ApiEvents.OnMessageSent,{type:o.default.File}),this._messagingService.sendFile(e)},t.prototype.sendFileAsProperty=function(e){return f.swc.API.triggerEvent(s.ApiEvents.OnMessageSent,{type:o.default.Card}),this._messagingService.sendFileAsProperty(e)},t.prototype.sendImage=function(e){return f.swc.API.triggerEvent(s.ApiEvents.OnMessageSent,{type:o.default.File}),this._messagingService.sendImage(e)},t.prototype.sendMessage=function(e,t,n){this._messagingService.sendMessage(e,t,n),f.swc.API.triggerEvent(s.ApiEvents.OnMessageSent,{type:o.default.Text})},t.prototype.sendSwift=function(e){return f.swc.API.triggerEvent(s.ApiEvents.OnMessageSent,{type:o.default.Card}),this._messagingService.sendSwift(e)},t.prototype.setIsTyping=function(e){this._messagingService.setIsTyping(e)},t.prototype.setMessageProperty=function(e,t,n,r){return this._messagingService.setMessageProperty(e,t,n,r)},t.prototype.setParticipantTyping=function(e,t){var n=this._participants.filter(function(t){return t.person.id===e});n.length&&(n[0].isTyping=t)},t.prototype.setTopic=function(e){this._messagingService.setConversationTopic(e)},t.prototype.start=function(){var e=this;return this._isDisposed=!1,this._messagingService.startConversation().then(function(){e._isLoaded=!0,e.publish("isLoaded",!0)},function(t){g.default.throwError(l.ErrorCodes.ERR_START_CONVERSATION,"Unable to start conversation",t,e.id)})},t.prototype.startGuestConversation=function(){return this.isAgent()?this._messagingService.startGuestConversation():Promise.resolve()},t.prototype.update=function(e){this._id===e.id&&(this.properties=e.properties||this.properties,this.threadProperties=e.threadProperties||this.threadProperties,this.isBlocked=E(e.properties),this.updateConsumptionHorizon(this.properties.consumptionhorizon),this.alertsOff=S(e.properties))},t.prototype.updateConsumptionHorizon=function(e){e&&e!==this._consumptionHorizon.value&&this._consumptionHorizon.set(e)},t.prototype.messageReceived=function(e,t){var n={type:e,messageType:t};f.swc.API.triggerEvent(s.ApiEvents.OnMessageReceived,n),this.messageReceivedProxied&&f.swc.API.triggerEvent(s.ApiEvents.conversationProxy.messageReceived,{refId:this.refId,message:n})},t}(c.default);t.default=w;var E=function(e){return!!e.conversationblocked&&"true"===e.conversationblocked.toLocaleLowerCase()},S=function(e){return!!e.alerts&&/false/i.test(e.alerts)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.callback=e}return e.prototype.connect=function(){this.timer||(this.callback(),this.timer=setInterval(this.callback,3e4))},e.prototype.disconnect=function(){clearInterval(this.timer)},e}();t.HeartBeat=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(80),i=n(111),o=n(4),s=n(50),a=n(88),c=n(1),u=n(21),l=n(44),p=n(10),d=n(73),f=n(51),h=n(118),g=n(14),m=n(107),_=n(54),y=n(7),v=n(75),b=n(58),P=n(81),T=n(149),w=n(11),E=n(150),S=function(){function e(e){var t=this;this.conversation=e,this._encoder=new s.default([],[new a.URLDomTransformer]),this._failedAttemptsCount=0,this.enquedMessages=new Array,this.isMessageProcessed=function(e){return 0!==t.sentMessages.length&&t.sentMessages.some(function(t){return t.content===e})},this.onMessageReceiveHandler=function(e){var n=!1,s=e.text?t._encoder.encode(e.text):null;if(!s&&!e.attachments&&!e.channelData)return n;if(s&&0===s.length&&e.attachments&&0===e.attachments.length&&e.channelData&&e.channelData.attachments&&0===e.channelData.attachments.length)return n;if("user"===(e.from.id||e.from.name||e.from))return n;n=!0,t.conversation.topic||(t.conversation.topic=e.from.name||"");var a=t.parseRaw(e);t.conversation.messages.pushObservable(a);var u=new E.default(t.conversation);return u.messageType=a.type,c.default.instance.TelemetryService.sendEvent(u),t.conversation.participants[0].isTyping=!1,r.default.triggerEvent(o.ApiEvents.OnMessageReceived,{type:i.default.getReceivedMessageType(a.type)}),n},this.sentMessages=[],this.conversation||w.default.throwError(p.ErrorCodes.ERR_CONVERSATION_MISSING,"conversation is missing"),this.conversation.id||w.default.throwError(p.ErrorCodes.DBG_DL_REQUIRES_TOKEN,"Directline mode requires token"),this.conversation.avatar=this.conversation.avatar||this.createDefaultAvatar(),this.directLineApi=u.loadServices().then(function(e){return e.createDirectLineService(t.conversation.id,t.conversation.definition.BingDLApi)})}return e.prototype.addBotToThread=function(e){},e.prototype.addParticipantToThread=function(e){},e.prototype.deleteConversation=function(e){return null},e.prototype.deleteMessage=function(e){return null},e.prototype.dispose=function(){this.directLineApi.then(function(e){e.dispose()}),this._postMessageTimeout&&this._postMessageTimeout.reset()},e.prototype.editMessage=function(e,t){return null},e.prototype.getUnreadMessagesCount=function(){return 0},e.prototype.loadMoreMessages=function(e){return Promise.reject("not implemented")},e.prototype.markAsRead=function(){},e.prototype.removeMessageProperty=function(e,t,n,r){return null},e.prototype.removeParticipantFromThread=function(e){return Promise.reject("not implemented")},e.prototype.sendDataToBot=function(e,t){return Promise.resolve()},e.prototype.sendFile=function(e){return Promise.reject("not implemented")},e.prototype.sendFileAsProperty=function(e){return Promise.reject({})},e.prototype.sendImage=function(e){return Promise.reject("not implemented")},e.prototype.sendMessage=function(e,t,n){var r=this;this.conversation.participants[0].isTyping=!0;var i={channelData:this.conversation.definition.Payload,payload:n};if(e=(e=e||"").trim(),this.lastMessage=new v.default(!1,i),this.lastMessage.processedContent=n?n.title:null,this.lastMessage.content=e?this._encoder.encode(e):"",this.lastMessage.direction=y.Direction.Outgoing,this.lastMessage.type=y.MessageType.UserMessage,t===l.ActionTrigger.SUGGESTED_ACTION&&n.image){var o='<img src="'+encodeURI(n.image)+'" />';this.lastMessage.imageContent=o?g.default.getMessageSanitizedContent(f.default.parse(o)):""}e.length>0&&this.conversation.messages.pushObservable(this.lastMessage);var s=new T.MessageSentEvent(this.conversation);return s.origin=t,s.messageLength=this.lastMessage.content.length,s.messageType=d.MessageType.TEXT,this.enquedMessages.push({message:this.lastMessage,event:s}),this.enquedMessages.length>=1&&(this.lastDequeue=new Promise(function(e,t){r._postMessageTimeout&&r._postMessageTimeout.reset(),r._postMessageTimeout=new _.FixedTimeout(r.dequeueMessages.bind(r,e),5e3),r.dequeueMessages(e)})),this.lastDequeue},e.prototype.sendSwift=function(e){var t=e.value;return t?this.sendMessage(t,l.ActionTrigger.SUGGESTED_ACTION,e):Promise.reject("swift - Cannot send empty payload")},e.prototype.setConversationTopic=function(e){},e.prototype.setIsTyping=function(e){},e.prototype.setMessageProperty=function(e,t,n,r){return null},e.prototype.startConversation=function(){var e=this;return new Promise(function(t,n){var r=Date.now();e.directLineApi.then(function(i){i.setSystemMessagesHandler(e.addLocalSystemMessage.bind(e)),i.createConversation().then(function(n){i.initPolling(n,e.onMessageReceiveHandler);var o=c.default.instance.Persons.createEmptyPerson(n);e.conversation.participants.pushObservable(new b.default(o)),e.conversation.id=n;var s=new P.ConversationLoadEvent(e.conversation);s.timeToLoad=Date.now()-r,c.default.instance.TelemetryService.sendEvent(s),t()},function(t){e.addLocalSystemMessage("polling_failed"),n(t)})},n)})},e.prototype.startGuestConversation=function(){return Promise.reject("not implemented")},e.prototype.stopListeningConversation=function(){},e.prototype._convertDirectlineToSwiftTypes=function(e){var t,n=e.thumbnailUrl?e.thumbnailUrl:"",r=!!e.autoPlay&&e.autoPlay,i=!!e.loop&&e.loop,o=e.name?e.name:"";switch(e.contentType){case"image/png":case"image/jpg":case"image/jpeg":case"image/gif":t={content:{image:{url:e.contentUrl},title:o},contentType:"application/vnd.microsoft.card.hero"};break;case"audio/mpeg":case"audio/mp4":t={content:{media:[{url:e.contentUrl}],autoloop:i,image:{url:n},title:o},contentType:"application/vnd.microsoft.card.audio"};break;case"video/mp4":t={content:{media:[{url:e.contentUrl}],autoloop:i,autostart:r,title:o},contentType:"application/vnd.microsoft.card.video"};break;default:t=e}return t},e.prototype.addLocalSystemMessage=function(e){this.conversation.participants.length&&(this.conversation.participants[0].isTyping=!1);c.default.instance.i18n.fetch(e)},e.prototype.createDefaultAvatar=function(){var e=Math.floor(11*Math.random());return"https://bot-framework.azureedge.net/bot-icons-v1/bot-framework-default-"+(e=0===e?1:e)+".png"},e.prototype.dequeueMessages=function(e){var t=this;var n=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n&&!n.isSending)return n}return null}(this.enquedMessages);if(n){n.isSending=!0;var r=n.message,i=n.event;i.timeToSend=Date.now();var o=n.message.payload||this.conversation.definition.Payload;this.directLineApi.then(function(s){s.postMessage(r.content,t.conversation.id,o).then(function(r){i.timeToSend=Date.now()-i.timeToSend,i.status=r.status,t._failedAttemptsCount=0,s.initPolling(t.conversation.id,t.onMessageReceiveHandler),t.sentMessages.push(n.message),c.default.instance.TelemetryService.sendEvent(i),t.enquedMessages.splice(0,1),t.dequeueMessages(e)},function(e){if(n.isSending=!1,t._failedAttemptsCount++,i.timeToSend=Date.now()-i.timeToSend,i.status=e.status,c.default.instance.TelemetryService.sendEvent(i),t._failedAttemptsCount>=m.MAX_RETRY_ATTEMPTS)return t.addLocalSystemMessage("message_failed"),void(t._failedAttemptsCount=0);t._postMessageTimeout.start()})})}else e()},e.prototype.getSwiftCardType=function(e,t){var n={carousel:"message/card.carousel",multiline:"message/card.multiline",card:"message/card"};return n[e.attachmentLayout]?n[e.attachmentLayout]:t.length>1?n.multiline:n.card},e.prototype.parseRaw=function(e){var t=this,n=new v.default(!1),r=e.text?e.text:"",i=e.from.id||e.from,o=e.attachments&&e.attachments.length>0||e.channelData&&e.channelData.attachments&&e.channelData.attachments.length>0;if(n.direction="guest"===e.from||"guest"===e.from.id||"user"===e.from||"user"===e.from.id?y.Direction.Outgoing:y.Direction.Incoming,e.suggestedActions&&e.suggestedActions.actions&&e.suggestedActions.actions.forEach(function(e){n.suggestedActions.pushObservable(new h.default(e,t.conversation,i))}),"system"===e.from&&(n.type=y.MessageType.SystemMessage),o){var s=void 0;e.attachments&&e.attachments.length>0?s=e.attachments:e.channelData.attachments&&e.channelData.attachments.length>0&&(s=e.channelData.attachments);var a=this.getSwiftCardType(e,s);s&&s.length>0&&(s=s.map(function(e){return t._convertDirectlineToSwiftTypes(e)}));var c={content:r,summary:"",attachments:s,type:a};n.content='<SwiftCard Swift="'+JSON.stringify(c)+'"></SwiftCard>',n.type=y.MessageType.SwiftCard,n.senderId=i}else e.text&&(n.content=this._encoder.encode(r));return n},e}();t.default=S},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(111),i=n(4),o=n(6),s=n(50),a=n(1),c=n(219),u=n(17),l=n(40),p=n(44),d=n(336),f=n(10),h=n(32),g=n(73),m=n(13),_=n(51),y=n(106),v=n(25),b=n(81),P=n(150),T=n(149),w=n(337),E=n(0),S=n(118),C=n(240),k=n(11),O=n(31),A=n(241),M=n(14),I=n(70),R=n(43),N=n(120),L=n(54),x=n(7),D=n(58),U=/(^|\s)(https?:\/\/[^\s]*\.(?:png\?\d+|png|jpg\?\d+|jpg|jpeg\?\d+|jpeg|gif))($|<|\s)/gim,j={ALLOWED_TAGS:["img","a"],ALLOWED_ATTR:["target","src","alt","class","href"]},F=/<a href="([^"]+)"( target="([^"]+)")?>([^<]+)<\/a>/g,H=730,B=5e3,G=3e3,z=!0,V=window,W=function(){function e(e){var t=this;this.conversation=e,this._encoder=new s.default(null,null),this._handleMessageResource=function(e,n){if(t._messageTypesHandler.isTypingIndicator(n)&&n.from){var i=R.default.normalizePersonId(M.default.getSenderIdFromUrl(n.from));e.setParticipantTyping(i,"Control/Typing"===n.messagetype)}else{var o=n.contentOriginal&&0===n.contentOriginal.trim().length;if(n.content&&0!==n.content.trim().length||!o||n.skypeeditedid){t._setHistoryParamToCache(e.id);var s=t.processNewMessage(e,n,null,!1);if(s&&s.direction===x.Direction.Incoming){var c=M.default.getSenderIdFromUrl(n.from);(i=R.default.normalizePersonId(c))&&e.setParticipantTyping(i,!1);var u=new P.default(t.conversation);u.messageType=s.type,a.default.instance.TelemetryService.sendEvent(u),e.messagesReceived++,t._updateUnreadMessageCounter(e,s),e.messageReceived(r.default.getReceivedMessageType(s.type),s.type)}}}},this._updateUnreadMessageCounter=function(e,n){if(e.isControlOpen)t.updateConsumptionHorizonToLastMessage(),e.unreadMessagesCount=0;else if(n.isDeleted){var r=n.originalTimestamp.getTime();!(e.consumptionHorizon.lastReadMessageTimestamp>=r)&&e.unreadMessagesCount>0&&e.unreadMessagesCount--}else n.isEdited||e.unreadMessagesCount++},this._isFetched=!1,this._isTeamsBackend=o.default.get.backend===m.MessagingBackend.TEAMS,this._isUseEditMessageClassic=function(){return z&&o.default.get.backend!==m.MessagingBackend.TEAMS},this._messageToBotWasSent=!1,this._pendingContactRequest=!1,this._quarantineCountDown=-1,this.checkConversationStatus=function(e){return t.isConversationNotFoundError(e)?Promise.resolve():a.default.instance.WebApi.fetchConversation(t.conversation.id).then(function(e){if(!t.isConversationNotFoundError(e)){if(t.isConversationBlocked(e))return t.conversation.isBlocked=!0,void(t.conversation.isChatEnabled=!1);switch(e.properties.conversationstatus){case"Accepted":return t.conversation.isUnderQuarantine=!1,t.conversation.isChatEnabled=!0,void(t._quarantineCountDown=-1);case"AcceptPendingSender":break;case"AcceptPendingRecipient":return t._pendingContactRequest=!0,t.conversation.isUnderQuarantine=!1,void(t.conversation.isChatEnabled=!0);default:return}t.checkIfBuddy()}},function(e){t.isConversationNotFoundError(e)||k.default.throwError(f.ErrorCodes.ERR_CHECK_CONVERSATION_STATUS,"Unable to check Conversation Status",e)})},this.checkIfBuddy=function(){t._checkContactTimeout||(t._checkContactTimeout=L.build(t.checkConversationStatus.bind(t),B)),t._checkContactTimeout.start()},this.fetchUserMessages=function(e){return new Promise(function(n,r){a.default.instance.WebApi.fetchMessages(t.conversation.id).then(function(r){t._messagesHandler(t.conversation,e,r),t._isFetched=!0,n(r)},function(e){t.onConversationLoadingFinished(),r(e)})})},this.isConversationBlocked=function(e){return!!e.properties.conversationblocked&&"true"===e.properties.conversationblocked.toLocaleLowerCase()},this.isConversationNotFoundError=function(e){return!(!e||e.errorCode!==H)&&(t.conversation.isChatEnabled=!0,t._quarantineCountDown=0,!0)},this.isOneToOneOrBot=function(){return t.conversation.isPerson()||t.conversation.isAgent()},this.startConversationWithBot=function(e){void 0===e&&(e=!0);var n=t.conversation.id,r=t.conversation.id.slice(3),i=t;if(0===t.conversation.participants.length){var o=new D.default(a.default.instance.Persons.getPerson(t.conversation.id,!0));t.conversation.participants.pushObservable(o)}return t.executeWhenSignedIn(function(){a.default.instance.ContactsManager.isPersonContact(n).then(function(n){n?(i.subscribeToConversation(),t.conversation.isChatEnabled=!0,a.default.instance.SignInManager.userIdentityType===h.IdentityType.GUEST&&(t.conversation.isNew=!0,t.conversation.startGuestConversation()),t.conversation.definition.Payload&&t.conversation.sendDataToBot({payload:t.conversation.definition.Payload})):(t.conversation.isChatEnabled=!1,t.conversation.isNew=!0,e&&a.default.instance.AgentsManager.addAgent(r),t._checkContactTimeout=L.build(function(){i.startConversationWithBot(!1)},G),t._checkContactTimeout.start())},function(e){k.default.throwError(f.ErrorCodes.ERR_START_CONVERSATION_WITH_BOT,"Unable to start conversation with bot",e,n)})})},this.startConversationWithPerson=function(){t.conversation.id.slice(2);if(0===t.conversation.participants.length){var e=new D.default(a.default.instance.Persons.getPerson(t.conversation.id,!0));t.conversation.participants.pushObservable(e)}return t.executeWhenSignedIn(function(){return a.default.instance.ContactsManager.isPersonContact(t.conversation.id).then(function(e){return e?(t.conversation.isNew=!1,a.default.instance.WebApi.subscribeContactPresence(t.conversation.id),t.subscribeToConversation()):(t.conversation.isNew=!0,t.subscribeToConversation().then(t.checkConversationStatus.bind(t)))})})},this.startGroupConversation=function(){var e=function(){return a.default.instance.WebApi.fetchThread(t.conversation.id).then(function(e){if(e.properties){var n=e.properties;e.members&&(n.members=e.members),t.updateConversationProperties(n);var r=n.joiningenabled,o=n.capabilities,s=!o||0===o.length;if(t._isTeamsBackend){var c=n.fixedRoster&&n.uniquerosterthread;t.conversation.isOneOnOne=c}else t.conversation.isOneOnOne=-1===e.id.indexOf("19:");var u=t.isMember(a.default.instance.SignInManager.currentUserName,e);!s||r||t._isTeamsBackend&&u?t.subscribeToConversation():k.default.throwError(f.ErrorCodes.INFO_JOIN_GROUP_DISABLED,"Joining to a group conversation is disabled",{},t.conversation.id);var l=t.conversation.participants,p=!l.length;e.members.forEach(function(e){var t=a.default.instance.Persons.getPerson(e.id,!0);if(p||!l.some(function(e){return e.person.id===t.id})){var n=new D.default(t,e);l.pushObservable(n),t.isAgent&&E.swc.API.triggerEvent(i.ApiEvents.BotAddedToThread,t.id)}}),a.default.instance.MePersonManager.fetch().then(function(e){l.forEach(function(n){e.id===n.person.id&&(t.conversation.selfParticipant=n)})})}else t.subscribeToConversation();return t.conversation.members=e.members,e},function(e){k.default.throwError(f.ErrorCodes.ERR_FETCH_THREAD,"Unable to fetch a thread",e,t.conversation.id)})};return t.executeWhenSignedIn(function(){e().then(function(n){var r,i="8:"+a.default.instance.SignInManager.currentUserName;t.isMember(a.default.instance.SignInManager.currentUserName,n)||(r=i,a.default.instance.WebApi.addParticipant(t.conversation.id,r).then(null,function(e){k.default.throwError(f.ErrorCodes.ERR_JOIN_CONVERSATION,"Unable to join conversation",e,t.conversation.id)})).then(e.bind(t))})})},this.subscribeToConversation=function(){var e=t,n=t.currentUserHasHistory(e.conversation.id),r=a.default.instance.SignInManager.userIdentityType===h.IdentityType.SKYPE||n;E.swc.API.triggerEvent(i.ApiEvents.OnConversationReady,{id:t.conversation.id});var o=new b.ConversationLoadEvent(t.conversation);return a.default.instance.TelemetryService.sendEvent(o),a.default.instance.WebApi.subscribeConversation(t.conversation.id,t._eventHandler.bind(t,t.conversation),function(){return t._backfilllingHandler(!0)},r).then(function(r){if(t.isConversationNotFoundError(r))return r;r&&r.properties&&r.properties.consumptionhorizon&&t.conversation.updateConsumptionHorizon(r.properties.consumptionhorizon),r&&r.threadProperties&&t.updateConversationProperties(r.threadProperties,!0);var i=t.isConversationBlocked(r);if(t.conversation.isBlocked=i,t.conversation.isChatEnabled=!i,a.default.instance.SignInManager.userIdentityType!==h.IdentityType.SKYPE)return n?t.fetchUserMessages(Date.now()):(e.onConversationLoadingFinished(),r);t.fetchUserMessages(Date.now())},function(n){t._messageToBotWasSent?t.fetchUserMessages(Date.now()):e.onConversationLoadingFinished()})},this.sendFile=function(e){return t.sendMessageToService(t.createMessageData({content:e,messagetype:y.MessagePayloadType.RichTextMedia_GenericFile}),t.getMessageEvent(g.MessageType.FILE))},this.sendFileAsProperty=function(e){return t.sendMessageToService(t.createMessageData({content:"",messagetype:y.MessagePayloadType.RichTextHtml,properties:JSON.stringify(e)}),t.getMessageEvent(g.MessageType.TEXT))},this.sendImage=function(e){return t.sendMessageToService(t.createMessageData({content:e,messagetype:y.MessagePayloadType.RichTextUriObject}),t.getMessageEvent(g.MessageType.IMAGE))},this.sendSwift=function(e){return t.sendMessageToService(t.createMessageData({content:e.title,properties:e.value||e,messagetype:y.MessagePayloadType.RichText,processedcontent:e.title}),t.getMessageEvent(g.MessageType.SWIFT))},this.sendLiveState=function(){return t.sendMessageToService(t.createMessageData({content:"",messagetype:y.MessagePayloadType.ControlLiveState}))},this.setIsTyping=function(e){return t.sendMessageToService(t.createMessageData({content:"",messagetype:e?y.MessagePayloadType.ControlTyping:y.MessagePayloadType.ControlClearTyping}))},e||k.default.throwError(f.ErrorCodes.ERR_CONVERSATION_MISSING,"conversation is missing"),this._messageTypesHandler=new c.default,this._firstMessagePopulationPromise=new u.CancelablePromise,a.default.instance.MePersonManager.fetch(),this._backfilllingHandler=this.backFillLostMessges.bind(this),I.get().subscribe("isOnline",this._backfilllingHandler)}return Object.defineProperty(e.prototype,"mePerson",{get:function(){return a.default.instance.MePersonManager.mePerson},enumerable:!0,configurable:!0}),e.prototype.isMember=function(e,t){var n="8:"+e;return t&&t.members&&t.members.some(function(e){return e.id===n})},e.prototype.addBotToThread=function(e){a.default.instance.WebApi.addParticipant(this.conversation.id,"28:"+e).then(function(e){},function(t){k.default.throwError(f.ErrorCodes.ERR_ADD_BOT_TO_CONVERSATION,"Unable to add bot to conversation",t,e)})},e.prototype.addParticipantToThread=function(e){a.default.instance.WebApi.addParticipant(this.conversation.id,e).then(function(e){},function(t){k.default.throwError(f.ErrorCodes.ERR_ADD_PERSON_TO_CONVERESATION,"Unable to add participant to conversation",t,e)})},e.prototype.createConversation=function(e){e&&a.default.instance.WebApi.createThread([])},e.prototype.deleteConversation=function(e){return a.default.instance.WebApi.deleteConversation(e)},e.prototype.deleteMessage=function(e){return this._isUseEditMessageClassic()?this.editMessageClassicWay(e):a.default.instance.WebApi.deleteMessage(this.conversation.id,e.id)},e.prototype.dispose=function(){this._messageToBotWasSent=!1,this.stopListeningConversation(),this._checkContactTimeout&&(this._checkContactTimeout.reset(),this._checkContactTimeout=null),this._firstMessagePopulationPromise.status===u.PromiseStatus.Pending&&(this._firstMessagePopulationPromise.promise.then(null,function(){}),this._firstMessagePopulationPromise.cancel()),this._firstMessagePopulationPromise=new u.CancelablePromise,I.get().unsubscribe("isOnline",this._backfilllingHandler)},e.prototype.mask=function(e,t){var n=A.Masks.instance;return n&&n.shouldMask(e)&&(e=n.process(e),t&&(t.tags=t.tags||"",t.tags=C.default.add(t.tags||"","masked",!0))),e},e.prototype.editMessage=function(e,t){t=this.mask(t);var n=this._encoder.encode(t,this.conversation,this.mePerson);return _.default.parse(n),this._isUseEditMessageClassic()?this.editMessageClassicWay(e,n):a.default.instance.WebApi.editMessage(this.conversation.id,e.id,e.rawMessageType,n)},e.prototype.getUnreadMessagesCount=function(){return this.conversation.unreadMessagesCount},e.prototype.loadMoreMessages=function(e){return this._backwardLink?a.default.instance.WebApi.fetchMessagesByLink(this._backwardLink).then(this._messagesHandler.bind(this,e,Date.now())):Promise.resolve()},e.prototype.markAsRead=function(){(a.default.instance.SignInManager.userIdentityType===h.IdentityType.SKYPE||this.currentUserHasHistory(this.conversation.id))&&this.updateConsumptionHorizonToLastMessage()},e.prototype.removeMessageProperty=function(e,t,n,r){return a.default.instance.WebApi.removeMessageProperty(e,t,n,r)},e.prototype.removeParticipantFromThread=function(e){return a.default.instance.WebApi.removeParticipant(this.conversation.id,e).then(function(e){},function(t){k.default.throwError(f.ErrorCodes.ERR_REMOVE_PERSON_FROM_CONVERSATION,"Unable to remove participant from conversation",t,e)})},e.prototype.sendDataToBot=function(e,t){var n={name:"SWC",conversation:{id:this.conversation.isGroup()?this.conversation.id:a.default.instance.SignInManager.currentUserName},value:t};return this._messageToBotWasSent=!0,a.default.instance.WebApi.sendDataToBot(e,n)},e.prototype.sendMessage=function(e,t,n){var r=this.getMessageEvent(g.MessageType.TEXT);r.messageLength=e.length,r.origin=t,n=n||{},e=this.mask(e,n);var i=this._encoder.encode(e,this.conversation,this.mePerson),o=_.default.parse(i),s=this.createMessageData({content:o,messagetype:y.MessagePayloadType.RichText,"Has-Mentions":this.messageContainsMention(i)});return Object.keys(n).length&&(s.properties=n),this.sendMessageToService(s,r)},e.prototype.setConversationTopic=function(e){a.default.instance.WebApi.setConversationTopic(this.conversation.id,e)},e.prototype.setMessageProperty=function(e,t,n,r){return a.default.instance.WebApi.setMessageProperty(e,t,n,r)},e.prototype.startConversation=function(){return this.isOneToOneOrBot()?this.conversation.isPerson()?this.startConversationWithPerson():this.startConversationWithBot():this.startGroupConversation()},e.prototype.startGuestConversation=function(){var e={name:"startConversation",conversation:{id:O.default.toFullIdentifier(a.default.instance.SignInManager.currentUserName)},value:{}};return a.default.instance.WebApi.sendDataToBot(this.conversation.id,e)},e.prototype.stopListeningConversation=function(){a.default.instance.WebApi.unsubscribeConversation(this.conversation.id)},e.prototype._eventHandler=function(e,t,n){switch(t){case"NewMessage":case"MessageUpdate":this._handleMessageResource(e,n);break;case"ConversationUpdate":this._isFetched||this.fetchUserMessages(Date.now()),e.update(n)}},e.prototype._messagesHandler=function(e,t,n){var r=this;if(e.messages)if(n){Date.now();this._backwardLink=n._metadata.backwardLink;var i=new l.ObservableCollection;n.messages.forEach(function(t){r.processNewMessage(e,t,i,!0)}),i.sortObservable(function(e,t){return e.timestamp.getTime()>t.timestamp.getTime()?1:-1});var o,s=new w.MessagesFetchEvent(this.conversation);s.messageCount=n.messages.length,s.status=200,s.timeToFetch=Date.now()-t,a.default.instance.TelemetryService.sendEvent(s),(o=e.messages).pushObservable.apply(o,i),this.onConversationLoadingFinished()}else this.onConversationLoadingFinished();else this.onConversationLoadingFinished()},e.prototype._setHistoryParamToCache=function(e){if(a.default.instance.SignInManager.userIdentityType!==h.IdentityType.SKYPE&&!this.currentUserHasHistory(e)){var t=a.default.instance.Storage.getItem("skype|hasHistory")||"";t=""===t?e:t+";"+e,a.default.instance.Storage.setItem("skype|hasHistory",t)}},e.prototype._triggerCustomAction=function(e){var t=e.content;if(t){var n=/<swc-event>(?:<name>([\s\S]*)<\/name>)[\s]?(?:<action>([\s\S]*)<\/action>)[\s]?(?:<data>([\s\S]*)<\/data>)<\/swc-event>/i,r=t.match(n);if(r&&!(r.length<3)){var i=r[1],o=r[2],s=r[3];o&&o.toLowerCase()===d.default.DELIVERED.toLowerCase()&&(i&&V.swc.API.triggerEvent(i,s),e.content=t.replace(n,""))}}},e.prototype.backFillLostMessges=function(e){var t=this;if(!this._backfilllingPromise||this._backfilllingPromise.status!==u.PromiseStatus.Pending){var n=this;this._backfilllingPromise=new u.CancelablePromise(a.default.instance.WebApi.fetchMessages(this.conversation.id)),this._backfilllingPromise.promise.then(function(e){e.messages&&e.messages.sort(function(e,t){var n=new Date(e.originalarrivaltime),r=new Date(t.originalarrivaltime);return n>r?1:n<r?-1:0}),n._messagesHandler(t.conversation,Date.now(),e)},function(e){})}},e.prototype.currentUserHasHistory=function(e){return(a.default.instance.Storage.getItem("skype|hasHistory")||"").indexOf(e)>=0||this.conversation.isGroup()},e.prototype.editMessageClassicWay=function(e,t){void 0===t&&(t="");var n={messagetype:e.rawMessageType,content:t,skypeeditedid:e.clientMessageId?e.clientMessageId:e.key};return a.default.instance.WebApi.sendMessage(this.conversation.id,n)},e.prototype.executeWhenSignedIn=function(e){return a.default.instance.SignInManager.getSkypeToken().then(function(t){return e()})},e.prototype.filterMessagesByKey=function(e,t){return e.filter(function(e){return e.key===t})[0]},e.prototype.getExistingMessage=function(e,t,n){var r=n!==t,i=this.filterMessagesByKey(n,e.key);return i||(r&&(i=this.filterMessagesByKey(t,e.key)),i)},e.prototype.mapSuggestedActionsArray=function(e,t,n){e.forEach(function(e){t.suggestedActions.pushObservable(n(e))})},e.prototype.messageContainsMention=function(e){return/<at id="(.*?)">.*?<\/at>/g.test(e).toString().toLowerCase()},e.prototype.onConversationLoadingFinished=function(){this._firstMessagePopulationPromise.status===u.PromiseStatus.Pending&&(this._firstMessagePopulationPromise.resolve(),(a.default.instance.SignInManager.userIdentityType===h.IdentityType.SKYPE||this.currentUserHasHistory(this.conversation.id))&&this.updateConsumptionHorizonToLastMessage()),b.ConversationLoadEvent.isAvailable&&(b.ConversationLoadEvent.isAvailable=!1)},e.prototype.processNewMessage=function(e,t,n,r){function i(t){return t.title&&(t.title=this._encoder.decode(this._encoder.encode(t.title))),new S.default(t,e,o.senderId)}this._triggerCustomAction(t),n=n||e.messages;var o=this._messageTypesHandler.handle(t,{conversation:this.conversation,isHistory:r});if("Control/LiveState"===t.messagetype)return null;if(!o)return null;N.default.parseMessageProperties(o,t),o.status=x.DeliveryStatus.Sent,t.suggestedActions&&t.suggestedActions.actions&&this.mapSuggestedActionsArray(t.suggestedActions.actions,o,i.bind(this)),t.properties&&t.properties.suggestedActions&&t.properties.suggestedActions.actions&&this.mapSuggestedActionsArray(t.properties.suggestedActions.actions,o,i.bind(this));var s,a,c=this.getExistingMessage(o,n,e.messages);if((s=o)&&"SystemMessage"===s.type)return c?(o.isEdited=!0,this._messageTypesHandler.updateExistingMessage(c,o,r),o):(n.pushObservable(o),o);if(!this._isTeamsBackend&&!c&&o.skypeEditedId)return(a=this.filterMessagesByKey(e.allMessages,o.key))?this._messageTypesHandler.updateExistingMessage(a,o,r):e.allMessages.pushObservable(o),o;if(!c&&!o.skypeEditedId&&(a=this.filterMessagesByKey(e.allMessages,o.key)))return this._messageTypesHandler.updateExistingMessage(a,o,r),n.pushObservable(a),a;if(U.test(o.content)&&(o.content=o.content.replace(U,"$1"+v.default.dompurify.sanitize('<a class="replacedImg" href="$2" target="_blank"><img src="$2" alt=""></a>',j)+"$3")),F.test(o.content)){var u=o.content.match(F);u&&!u[2]&&(o.content=o.content.replace(u[0],v.default.dompurify.sanitize(u[0],j)))}return c?this._messageTypesHandler.updateExistingMessage(c,o,r):n.pushObservable(o),o},e.prototype.getMessageEvent=function(e){var t=new T.MessageSentEvent(this.conversation);return t.messageType=e,t},e.prototype.createMessageData=function(e){var t={contenttype:"text",composetime:(new Date).toISOString(),clientmessageid:Date.now().toString()};return Object.assign(t,e||{})},e.prototype.sendMessageToService=function(e,t){var n=this,r=-1!==e.messagetype.indexOf("Control");this._quarantineCountDown>=0&&!r&&(this._quarantineCountDown++,this.conversation.isChatEnabled=this.conversation.isChatEnabled&&this._quarantineCountDown<10,this.checkIfBuddy()),this._pendingContactRequest&&!r&&(this._pendingContactRequest=!1,a.default.instance.WebApi.acceptConversation(this.conversation.id));var i,o=this.mePerson;o&&o.displayName&&(e.imdisplayname=o.displayName),t&&t.messageType===g.MessageType.SWIFT||(i=this._messageTypesHandler.generateOutgoing(e));var s=Date.now(),c=this.conversation.isAgent()&&"RichText"===e.messagetype&&I.get().isOnline;i&&this.conversation.messages.pushObservable(i),c&&this.conversation.participants.length&&(this.conversation.participants[0].isTyping=!0);return this.conversation.contextAad&&(e.content+='<context reason="customAad">'+this.conversation.contextAad+"</context>"),a.default.instance.WebApi.sendMessage(this.conversation.id,e).then(function(e){i&&(i.status=x.DeliveryStatus.Sent),t&&(t.origin!==p.ActionTrigger.TYPING&&(n.conversation.messagesSent++,n.updateConsumptionHorizonToLastMessage()),t.index++,t.timeToSend=Date.now()-s,t.status=200,a.default.instance.TelemetryService.sendEvent(t))},function(e){i&&(i.status=x.DeliveryStatus.Failed),t&&(t.status=e.status,t.errorCode=e.errorCode,t.errorMessage=e.message,t.timeToSend=Date.now()-s,a.default.instance.TelemetryService.sendEvent(t)),804===e.errorCode&&(n.conversation.isChatEnabled=!1,n.conversation.isUnderQuarantine=!0,n.checkIfBuddy()),c&&n.conversation.participants.length&&(n.conversation.participants[0].isTyping=!1)})},e.prototype.updateConsumptionHorizonToLastMessage=function(){if(0!==this.conversation.messages.length&&this.conversation.isActive&&a.default.instance.isFocused){var e=this.conversation.messages[this.conversation.messages.length-1],t=e.timestamp.getTime()+";"+(new Date).getTime()+";"+e.key;this.conversation.consumptionHorizon.lastReadMessageTimestamp>=e.timestamp.getTime()||a.default.instance.WebApi.updateConsumptionHorizon(this.conversation.id,t).then(this.conversation.updateConsumptionHorizon.bind(this.conversation,t))}},e.prototype.updateConversationProperties=function(e,t){var n=this;if(void 0===t&&(t=!1),e){if(e.topic){if(!this.conversation.topic&&t){var r=this.mePerson;r&&e.topic.indexOf(r.id)>-1&&(e.topic=e.topic.replace(r.mri+", ",""),e.topic=e.topic.replace(", "+r.mri,""),e.topic=e.topic.replace(r.id+", ",""),e.topic=e.topic.replace(", "+r.id,"")),this.conversation.participants.forEach(function(t){var n=t.person.displayName;n&&(e.topic=e.topic.replace(t.person.mri,n),e.topic=e.topic.replace(t.person.id,n))})}this.conversation.topic=M.default.parseTopic(e.topic)}if(e.picture&&(this.conversation.avatar=e.picture.replace("URL@","")),this._isTeamsBackend&&e.members){var i=[];if(e.members.forEach(function(e){if(!a.default.instance.MePersonManager.isMe(e.id)){var t=a.default.instance.Persons.getPerson(e.id);t.displayName&&i.push({userId:e.id,displayName:t.displayName})}}),0===i.length)return;a.default.instance.SignInManager.isAadSupported()&&a.default.instance.AvatarService.fetchMergedAvatars(i).then(function(e){e&&(n.conversation.avatar=e)})}}},e}();t.default=W},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.DELIVERED="delivered",e.CLICK="click",e}();t.default=r},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=function(e){function t(t){return e.call(this,"kpi_messages_fetch",t)||this}return i(t,e),t.prototype.getCustomProperties=function(){var t=e.prototype.getCustomProperties.call(this);return t.push(o.TelemetryPropertyValue.Create("timeToFetch",this.timeToFetch)),t.push(o.TelemetryPropertyValue.Create("status",this.status)),t.push(o.TelemetryPropertyValue.Create("messageCount",this.messageCount)),t.push(o.TelemetryPropertyValue.Create("numberOfRetries",this.getProperty(this.numberOfRetries))),t},t}(n(36).ConversationDataEvent);t.MessagesFetchEvent=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),i=n(113),o=n(145),s=n(3),a=function(){function e(){var e=this;this.persons={},this.subscribedPresenceStatus={},this.subscribeToUserStatus=function(t,n){if(!t||!n)return Promise.resolve(!1);if(e.subscribedPresenceStatus[t])return Promise.resolve(!0);var r=function(){return delete e.subscribedPresenceStatus[t],Promise.resolve(!1)},o=n.bind(null,t);return e.subscribedPresenceStatus[t]=o,s.default.initPromise.then(function(){return s.default.signInManager.onceSignedIn().then(function(){var n=s.default.signInManager.currentUserName,a=e.getMri(t);return s.default.contactsService.getContact(n,a).then(function(t){if(!t)return!1;var n=e.getPerson(a);return n.subscribe("presenceStatus",o),s.default.webApi.subscribeContactPresence(a),n.presenceStatus&&n.presenceStatus!==i.PresenceStatus.Undefined&&o(n.presenceStatus),!0},r)},r)},r)}}return e.prototype.getPerson=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var i=this.persons[e];if(!i){var a=r.default.normalizePersonId(e);i=this.persons[a]}var c=s.default.mePerson,u=c&&(e===c.mri||e===c.id||e.indexOf(c.msaId)>-1);return!i&&c&&u&&(i=this.persons[c.mri],e=c.mri,u=!0,i||(i=c)),i||(i=this.persons[e]=new o.default(e,n,t)),i.isFilled||!t||u||i.fetchDisplayNameAndAvatar(),i},e.prototype.dispose=function(){var e=this;Object.getOwnPropertyNames(this.persons).forEach(function(t){e.persons[t].dispose()}),this.persons={},this.subscribedPresenceStatus={}},e.prototype.createEmptyPerson=function(e){var t=new o.default(e,!1,!1);return this.persons[t.id]=t,t},e.prototype.handlePresenceData=function(e,t){var n=this.getPerson(e),r=t.status;n.presenceStatus=r},e.prototype.unsubscribeFromUserStatus=function(e){if(!e||!this.subscribedPresenceStatus[e])return!1;var t=this.getMri(e);return this.getPerson(t).unsubscribe("presenceStatus",this.subscribedPresenceStatus[e]),delete this.subscribedPresenceStatus[e],!0},e.prototype.getUserStatus=function(e){var t=this;if(!e)return Promise.resolve(null);var n=function(){return Promise.resolve(null)};return s.default.initPromise.then(function(){return s.default.signInManager.onceSignedIn().then(function(){var r=s.default.signInManager.currentUserName,o=t.getMri(e);return s.default.contactsService.getContact(r,o).then(function(e){if(!e)return null;var n=t.getPerson(o);return n.presenceStatus&&n.presenceStatus!==i.PresenceStatus.Undefined?n.presenceStatus:s.default.webApi.getUsersPresence([o]).then(function(e){var t=e[0];return t.Payload&&t.Payload.status})},n)},n)},n)},e.prototype.subscribeToMyStatus=function(e){var t=this;return s.default.initPromise.then(function(){return s.default.signInManager.onceSignedIn().then(function(){var n=s.default.mePerson;return n.subscribe("presenceStatus",e),s.default.webApi.subscribeContactPresence(n.mri),t.subscribedPresenceStatus[n.id]=e,!0},function(e){return Promise.resolve(!1)})},function(e){return Promise.resolve(!1)})},e.prototype.getMyStatus=function(){return s.default.mePerson.presenceStatus},e.prototype.setMyStatus=function(e){return s.default.webApi.setMyPresence(e).then(function(e){return e.ok?Promise.resolve(!0):Promise.resolve(!1)},function(e){return Promise.resolve(!1)})},e.prototype.getMri=function(e){return-1===e.indexOf("8:")?"8:"+e:e},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(133),i=n(8),o=n(30),s=n(5),a=n(103),c=n(3),u=function(){function e(){this._ariaTelemetryService=new r.AriaTelemetryService,this._commonProperties=[],this.flushAll=a.default().flushAll.bind(a.default())}return e.prototype.sendEvent=function(e){this.addCommonProperties(e),this._ariaTelemetryService.sendEvent(e)},e.prototype.setCommonProperty=function(e,t,n){this._commonProperties.push(s.TelemetryPropertyValue.Create(e,t,n?o.PIIType.Identity:o.PIIType.NotSet))},e.prototype.addCommonProperties=function(e){e.identityType=s.TelemetryPropertyValue.Create("identitytype",this.getIdentityType()),this._commonProperties.forEach(function(t){e[t.key]=t})},e.prototype.getIdentityType=function(){if(!c.default.signInManager)return i.NA;var t=c.default.signInManager.userIdentityType.valueOf();return e.identityType[t]||"Unknown"},e.identityType={0:"UNDEFINED",10:i.NA,100:"Guest",200:"Skype",300:"Guest"},e}();t.default=u}]);