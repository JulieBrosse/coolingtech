window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.vendors~Lightning.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[224],{1235:function(e,t,n){"use strict";var o=n(0),r=n(1),i=n(381),s=n(630),u=n(1887),c=n(1446),l=n(219),a=n(7),d=r.version,p='<html dir="'+(Object(u.a)()?"rtl":"ltr")+'"><head></head><body style="min-width: 0;"></body></html>',h=!1,f=function(e){function t(t){var n=e.call(this,t)||this;return n.state={errored:!1},"undefined"==typeof window||h||(l.b.getInstance().setConfig({onInsertRule:c.insertPopoutStylesheetRule}),h=!0),n}return o.__extends(t,e),t.prototype.render=function(){if(0==d.indexOf("16")){var e=this.props,t=e.html,n=o.__rest(e,["html"]);return t||(t=p),r.createElement(s.a,{child:r.createElement(c.Popout,o.__assign({},o.__assign({html:t},n))),onError:m,ErrorComponent:i.a})}return a.c.error("OWA Popout render control triggered for React version <16.0.0"),null},t}(r.Component);function m(e,t){a.c.error({message:"Error launching popout: "+e.message,error:e,diagnosticInfo:t.componentStack})}var v=n(369);function w(){return(location?location.pathname:"").split("/").indexOf(v.c)>=0}n(55),n(883);n(1379),n(1441);n.d(t,"b",function(){return w});t.a=f},1379:function(e,t,n){"use strict";var o=n(369),r=n(55),i=n(883),s=n(161);function u(e,t){if(t){var n=t.displayName?t.displayName+"<"+t.smtpAddress+">":t.smtpAddress;return e?"&"+e+"="+n:n}return""}function c(e,t){return t?"&"+e+"="+t:""}function l(e){if(!e.to||!e.to.smtpAddress)return"";var t=s.parse(Object(r.a)().search.substr(1));return t.mailtolink=function(e){if(!e.to||!e.to.smtpAddress)return"";var t="mailto:"+u(null,e.to),n="";return n+=u("cc",e.cc),n+=u("bcc",e.bcc),n+=c("subject",e.subject),(n+=c("body",e.body))?t+"?"+n.slice(1):t}(e),Object(i.a)(o.e,o.b,"?"+s.stringify(t))}n.d(t,"a",function(){return l})},1440:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.popouts={}},1441:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(369),r=n(55),i=n(883);function s(e){return e?Object(i.a)(o.e,o.f+"/"+encodeURIComponent(e),Object(r.a)().search):""}},1446:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1727);t.Popout=o.Popout;var r=n(1731);t.insertPopoutStylesheetRule=r.insertPopoutStylesheetRule},1539:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="__$$REACT_POPOUT_COMPONENT$$__";t.id=o,t.set=function(e,t){window[o]=window[o]||{},window[o][e]=t},t.get=function(e){return window[o]&&window[o][e]}},1727:function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),s=n(40),u=n(1728),c=n(1440),l=n(1729),a=n(1539);n(1730);var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setupAttempts=0,t.openChildWindow=function(){var e=u.generateWindowFeaturesString(t.props.options||{}),n=t.props.name||Math.random().toString(12).slice(2);t.child=function(e){if(!e||e.closed||void 0===e||void 0===e.closed)return null;return e}(window.open(t.props.url||"about:blank",n,e)),t.child?(t.id="__"+n+"_container__",t.container=t.initializeChildWindow(t.id,t.child)):(t.props.onBlocked&&t.props.onBlocked(),t.container=null)},t.closeChildWindowIfOpened=function(){p(t.child)&&(t.child.close(),t.child=null,t.props.onClose&&t.props.onClose())},t}return r(t,e),t.prototype.setupOnCloseHandler=function(e,t){var n,o=this;if(!(this.setupAttempts>=5))if(t&&t.document&&t.document.head){var r=t.document.createElement("script"),i="\n            window.onbeforeunload = function(e) {\n                var result = window.opener."+a.id+".onBeforeUnload.call(window, '"+e+"', e);\n\n                if (result) {\n                    window.opener."+a.id+".startMonitor.call(window.opener, '"+e+"');\n\n                    e.returnValue = result;\n                    return result;\n                } else {\n                    window.opener."+a.id+".onChildClose.call(window.opener, '"+e+"');\n                }\n            }";r.innerHTML="\n            window.onload = function(e) {\n                "+i+"\n            };\n            ",n="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent:"",(/Edge/.test(n)||/Trident/.test(n)||!this.props.url)&&(r.innerHTML=i),t.document.head.appendChild(r),this.setupCleanupCallbacks()}else this.setupAttempts++,setTimeout(function(){return o.setupOnCloseHandler(e,t)},50)},t.prototype.setupCleanupCallbacks=function(){var e=this;window.addEventListener("unload",function(t){return e.closeChildWindowIfOpened()}),a.set("onChildClose",function(e){c.popouts[e].props.onClose&&c.popouts[e].props.onClose()}),a.set("onBeforeUnload",function(e,t){if(c.popouts[e].props.onBeforeUnload)return c.popouts[e].props.onBeforeUnload(t)})},t.prototype.setupStyleElement=function(e){this.styleElement=e.document.createElement("style"),this.styleElement.setAttribute("data-this-styles","true"),this.styleElement.type="text/css",e.document.head.appendChild(this.styleElement)},t.prototype.injectHtml=function(e,t){var n;if(this.props.html){t.document.write(this.props.html);for(var o=t.document.head,r="",i=null,s=window.document.styleSheets.length-1;s>=0;s--){var u=window.document.styleSheets[s];try{i=u.cssRules}catch(e){var c=t.document.createElement("link");c.type=u.type,c.rel="stylesheet",c.href=u.href,o.appendChild(c)}finally{if(i)for(var l=0;l<i.length;l++)try{r+=i[l].cssText}catch(e){}}i=null}var a=t.document.createElement("style");a.innerHTML=r,o.appendChild(a),(n=t.document.createElement("div")).id=e,t.document.body.appendChild(n)}else{var d="<!DOCTYPE html><html><head>";for(s=window.document.styleSheets.length-1;s>=0;s--){u=window.document.styleSheets[s];try{d+="<style>"+(r=u.cssText)+"</style>"}catch(e){}}d+='</head><body><div id="'+e+'"></div></body></html>',t.document.write(d),n=t.document.getElementById(e)}return this.setupStyleElement(t),n},t.prototype.setupStyleObserver=function(e){new MutationObserver(function(t){t.forEach(function(t){"childList"==t.type&&function(e,t,n){for(var o,r=0;r<e.length;r++)"STYLE"==(o=e[r]).tagName&&t.call(n,o,r)}(t.addedNodes,function(t){e.document.head.appendChild(l.crossBrowserCloneNode(t,e.document))})})}).observe(document.head,{childList:!0})},t.prototype.initializeChildWindow=function(e,t){if(c.popouts[e]=this,this.props.url)return this.setupOnCloseHandler(e,t),null;var n=this.injectHtml(e,t);return this.setupStyleObserver(t),this.setupOnCloseHandler(e,t),n},t.prototype.renderChildWindow=function(){!function(e){if(!e)return;var t=document.createElement("a");t.href=e;var n=window.location;if(t.hostname&&n.hostname!=t.hostname||t.protocol&&n.protocol!=t.protocol)throw new Error("react-popup-component error: cross origin URLs are not supported (window="+n.protocol+"//"+n.hostname+"; popout="+t.protocol+"//"+t.hostname+")")}(this.props.url),this.props.hidden?this.closeChildWindowIfOpened():(p(this.child)||this.openChildWindow(),!this.props.url&&this.container&&s.render(this.props.children,this.container))},t.prototype.componentDidUpdate=function(){this.renderChildWindow()},t.prototype.componentDidMount=function(){this.renderChildWindow()},t.prototype.componentWillUnmount=function(){this.closeChildWindowIfOpened()},t.prototype.render=function(){return null},t}(i.Component);function p(e){return e&&!e.closed}t.Popout=d},1728:function(e,t,n){"use strict";var o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};Object.defineProperty(t,"__esModule",{value:!0}),t.generateWindowFeaturesString=function(e){var t={left:0,top:0,height:600,width:800,location:!1,menubar:!1,resizable:!1,scrollbars:!1,status:!1,toolbar:!1};return t=o({},t,e),Object.getOwnPropertyNames(t).map(function(e){return e+"="+("boolean"==typeof(n=t[e])?n?"1":"0":n?String(n):void 0);var n}).join(",")}},1729:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.crossBrowserCloneNode=function(e,t){var n=t.createElement(e.tagName);if(n.innerHTML=e.innerHTML,e.hasAttributes())for(var o=void 0,r=0;r<e.attributes.length;r++)o=e.attributes[r],n.setAttribute(o.name,o.value);return n}},1730:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1440),r={},i=250;n(1539).set("startMonitor",function(e){var t=function(){var n;o.popouts[e]&&o.popouts[e].props.onClose&&(!o.popouts[e].child||o.popouts[e].child.closed?(r[n=e]&&(clearTimeout(r[n]),delete r[n]),o.popouts[e].props.onClose(),o.popouts[e].child=null):r[e]=setTimeout(t,i))};r[e]=setTimeout(t,i)})},1731:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1440);t.insertPopoutStylesheetRule=function(e){Object.keys(o.popouts).forEach(function(t){var n=o.popouts[t];if(n.child&&n.styleElement)try{var r=n.styleElement.sheet;r.insertRule(e,r.cssRules.length)}catch(e){}})}},369:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return s}),n.d(t,"h",function(){return u}),n.d(t,"g",function(){return c}),n.d(t,"f",function(){return l}),n.d(t,"d",function(){return a}),n.d(t,"e",function(){return d}),n.d(t,"a",function(){return p});var o=n(0),r=n(210),i="deeplink",s="compose",u="reply",c="replyall",l="read",a="group",d="/"+o.__spread(["mail"],Object(r.a)().split("/").slice(1)).join("/")+i+"/",p="/"+o.__spread(["calendar"],Object(r.a)().split("/").slice(1)).join("/")+i+"/"},5630:function(e,t,n){"use strict";n.r(t);var o=n(20),r=n(7),i=n(4),s=n(161),u=n(0),c=n(21),l=n(942),a=Object(i.action)("initializeLightning")(function(e){var t,n;r.c.info("initialize lightning store");var o=Object(l.a)();if(o.lastShownId=null,o.lightedCount=0,o.unseenItems=new c.a,e)try{for(var i=u.__values(e),s=i.next();!s.done;s=i.next()){var a=s.value;o.unseenItems.set(a.identity,a)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}});var d,p=n(81),h="ows/v1.0/lightning/items/unseen";function f(){return r.c.info("initialize lightning from server"),Object(p.b)(h).then(function(e){var t=e.map(function(e){return{identity:e,visible:!1}});a(t)})}var m="lightning";function v(){if(!d){var e="undefined"!=typeof location&&location.search?Object(s.parse)(location.search.substr(1)):null;d=e&&e.hasOwnProperty(m)?function(e){r.c.info("initialize lightning from override query parameter");var t=e.split(",").map(function(e){return{identity:e,visible:!1}});return a(t),Promise.resolve()}(e[m]):f()}return d}var w=n(9),b={datapoint:{name:"LIGHTUP",customData:function(e){return[e]}}},y=Object(i.action)("lightup")(function(e){r.c.info("lightup - id:"+e);var t=Object(l.a)();t.lastShownId=e,t.lightedCount++,t.unseenItems.get(e).visible=!0;var n=b.datapoint,o=n.name,i=n.customData;Object(w.n)(o,i(e))}),g=n(1235),O=Object(i.select)({lastShownId:function(){return l.b.lastShownId},lightedCount:function(){return l.b.lightedCount},unseenItems:function(){return l.b.unseenItems}})(function(e,t,n){if(r.c.info("lightupOrReject - id:"+e+", recurrenceCount:"+t+", lightedCount:"+l.b.lightedCount+", lastShown:"+l.b.lastShownId),Object(g.b)())r.c.info("lightning is disabled for deeplink");else{var o=!1;if(n.lastShownId){if(t&&!n.unseenItems.get(n.lastShownId).visible&&n.unseenItems.has(e)){var i=t.indexOf(n.lastShownId),s=t.indexOf(e);i>=0&&i+1==s&&(o=!0)}}else n.unseenItems.has(e)&&(o=!0);o&&y(e)}}),_=Object(i.action)("beginLightning")(function(e,t,n){r.c.info("beginLightning - id:"+e),t(function(t){v().then(function(){t?Object(o.when)(function(){return Object(l.a)().unseenItems.get(e).counter>=t},function(){return O(e,n)}):O(e,n)}).catch(function(t){r.c.warn("something is wrong, lightning id:"+e+", reason:"+t)})})}),C="ows/v1.0/lightning/items";var j="undefined"!=typeof location&&location.search?Object(s.parse)(location.search.substr(1)):null,I=Object(i.action)("endLightning")(function(e,t){return r.c.info("endLightning - id:"+e),Object(l.a)().lastShownId==e&&Object(l.a)().unseenItems.get(e).visible?(Object(l.a)().unseenItems.get(e).visible=!1,j&&j.hasOwnProperty("lightning")?(r.c.info("skipping the update because override exists"),Promise.resolve()):(n=e,void 0===(o=t)&&(o="Primary"),Object(p.f)(C+"/"+n+"?actionType="+o,{id:n}))):Promise.resolve();var n,o});n.d(t,"beginLightningImp",function(){return _}),n.d(t,"endLightningImp",function(){return I})},883:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(25),r=n(138),i=n(369);function s(e,t,n){var s=Object(o.h)("fwk-pathBasedRouter")?{pathname:e+t,search:n}:{pathname:e,search:n,hash:"/"+i.c+"/"+t};return r.format(s)}}},0,[218]]);
//# sourceMappingURL=owa.vendors~Lightning.js.map
window.scriptsLoaded['owa.vendors~Lightning.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.vendors~Lightning.js'] = (new Date()).getTime();