!function(e){function t(t){for(var i,s,a=t[0],c=t[1],l=t[2],d=0,p=[];d<a.length;d++)s=a[d],r[s]&&p.push(r[s][0]),r[s]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);for(u&&u(t);p.length;)p.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],i=!0,a=1;a<n.length;a++){var c=n[a];0!==r[c]&&(i=!1)}i&&(o.splice(t--,1),e=s(s.s=n[0]))}return e}var i={},r={5:0},o=[];function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=i,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var a=window.swcJsonp=window.swcJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;o.push([512,0]),n()}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(91),r=window;t.swcWindow=r,r.swc=r.swc||r.SkypeWebControl||{},r.swc.shared=r.swc.shared||{},r.swc.scriptLoader=r.swc.scriptLoader||i.default,r.SKYPE=r.SKYPE||{},r.SkypeWebControl=r.swc;var o=r.swc;t.swc=o,t.SKYPE=r.SKYPE||{}},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(124),s=n(18),a=n(33),c=n(0),l=n(38),u=n(21),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isFocused=!0,t.restart=function(){t.dispose(),t._initManagers&&t._initManagers(),t._signInManager.getSkypeToken().then(null,function(){}),t.MePersonManager.fetch(),t.restoreLastConversation()},t}return r(t,e),Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.initServices=function(e){t._initParams=e,t.instance.SignInManager,t.instance.WebApi},t.prototype.dispose=function(){var e;e=this._mePersonManager,c.swc.MePersonManager,e&&(e.dispose(),e=null),this._amsManager&&this._amsManager.dispose(),this._persons&&this._persons.dispose(),this._isReady=!1,this._isCleared=!1},Object.defineProperty(t,"performanceData",{get:function(){return t._performanceData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MePersonManager",{get:function(){return this._mePersonManager||(this._mePersonManager=c.swc.MePersonManager),this._mePersonManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AgentsManager",{get:function(){return this._agentsManager||(this._agentsManager=new o.default),this._agentsManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AmsManager",{get:function(){return this._amsManager||(this._amsManager=u.getServices().amsManager),this._amsManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ContactsManager",{get:function(){return this._contactsManager||(this._contactsManager=u.getServices().contactsManager),this._contactsManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SignInManager",{get:function(){if(!this._signInManager&&(this._signInManager=u.getServices().signInManager,!this._signInManager)){var e=t._initParams;u.getServices().initManagers(l.default.locale,{tokenProvider:e.skypeTokenProvider,initialToken:e.initialSkypeTokenData,externalLogin:e.externalLogin,tokenType:e.tokenType}),this._signInManager=u.getServices().signInManager,this._signInManager&&this._signInManager.subscribe("resurrect",this.restart)}return this._signInManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Persons",{get:function(){return this._persons||(this._persons=u.getServices().persons),this._persons},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TelemetryService",{get:function(){return this._telemetryService||(this._telemetryService=u.getServices().telemetryManager),this._telemetryService},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PesManager",{get:function(){return this._pesManager||(this._pesManager=u.getServices().pesManager),this._pesManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SearchManager",{get:function(){return this._searchManager||(this._searchManager=u.getServices().searchManager),this._searchManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Storage",{get:function(){return a.default.get()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"WebApi",{get:function(){return this._webApi||(this._webApi=u.getServices().webApi),this._webApi},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NotificationsManager",{get:function(){return u.getServices().notificationsManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wx",{get:function(){return u.getServices().wx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"i18n",{get:function(){return u.getServices().i18n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AvatarService",{get:function(){return u.getServices().avatarService},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCleared",{get:function(){return this._isCleared},set:function(e){e!==this._isCleared&&(this._isCleared=e,this.publish("isCleared",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFocused",{get:function(){return this._isFocused},set:function(e){e!==this._isFocused&&(this._isFocused=e,this.publish("isFocused",e))},enumerable:!0,configurable:!0}),t.prototype.setRestoreOfLastConversation=function(e){this._lastConversationCallback=e},t.prototype.restoreLastConversation=function(){this._lastConversationCallback&&this._lastConversationCallback()},t.prototype.setManagersInit=function(e){this._initManagers||(this._initManagers=e)},t._performanceData={},t.initPesManager=function(){u.getServices().initPesManager()},t}(s.default);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(24),o=n(24),s=n(19),a=n(66),c=function(){function e(){}return Object.defineProperty(e,"ECS",{get:function(){return i.swc.EcsConfig},set:function(e){i.swc.EcsConfig=e},enumerable:!0,configurable:!0}),e.getPlatformId=function(){if(e._platformID)return e._platformID;var t=s.default.getHost(),n={"outlook.live.com":915,"outlook-sdf.live.com":915,"interviews.skype.com":916,"interviews-df.skype.com":916,"interviews-int.skype.com":916,"www.bing.com":917,"www.staging-bing-int.com":917,"www.bing-int.com":917,"www.msn.com":918,"int.msn.com":918,"int1.msn.com":918,"wtskype2.azurewebsites.net":919,"azuresupportextension-ms.hosting.portal.azure.net":919,"portal.azure.com":919,"rc.portal.azure.com":919,"ms.portal.azure.com":919,"onedrive.live.com":920,"www.skype.com":921};for(var i in n)if(n.hasOwnProperty(i)&&t.indexOf(i)>-1)return n[i];return 912},e.getPlatformName=function(){switch(this.getPlatformId()){case 915:return"outlook";case 916:return"interviews";case 917:return"bing";case 918:return"msn";case 919:return"azureportal";case 920:return"onedrive";case 921:return"scom";default:return"other"}},e.getClientVersion=function(){if(e.CLIENT_VERSION!==e.DEFAULT_CLIENT_VERSION)return e.CLIENT_VERSION;for(var t=e.ECS.version.split("."),n=t.length,i=0;i<4-n;i++)t.splice(t.length-1,0,"0");return e.CLIENT_VERSION=e.getPlatformId()+"/"+t.join("."),e.CLIENT_VERSION},e.getChatClientInfo=function(){return this.CHAT_CLIENT_INFO?this.CHAT_CLIENT_INFO:(this.CHAT_CLIENT_INFO="os=Windows; osVer=10; proc=Win32; lcid=en-us; deviceType=1; country=n/a; clientName=swc; clientVer="+e.getUiVersion(),this.CHAT_CLIENT_INFO)},e.getUiVersion=function(){return this.UI_VERSION?this.UI_VERSION:(this.UI_VERSION=e.getClientVersion()+"//swc",this.UI_VERSION)},e.getClientInfo=function(){if(this.SYSTEM_INFO)return this.SYSTEM_INFO;var t=o.UNKNOWN_VERSION;try{t=window.navigator.platform}catch(e){}return this.SYSTEM_INFO=e.getUiVersion()+"os="+r.default.getOsName()+"; osVer="+r.default.getOsVersion()+"; proc="+t+"; deviceType="+r.default.getDeviceType()+"; browser="+r.default.getBrowserName()+"; browserVer="+r.default.getBrowserVersion(),this.SYSTEM_INFO},e.APPNAME="SWC",e.LOCALE="en-us",e.PES_LOCALE="en",e.ORIGIN="SkypeLWC",e.ORIGIN_CALLING="SkypeCalling",e.MSG_MAX_LENGTH=2e3,e.SKYPE_TOKEN_KEY=a.SKYPE_TOKEN_KEY,e.SKYPE_REGTOKEN_KEY=a.SKYPE_REGTOKEN_KEY,e.PLATFORM_ID=912,e.BUTTON_MARKER_CLASS=".skype-button",e.CHAT_MARKER_CLASS=".skype-chat",e.RECENTS_MARKER_CLASS=".skype-recents",e.CHAT_FRAME_MARKER_CLASS=".lwc-chat-frame",e.CALL_FRAME_MARKER_CLASS=".swc-call-frame",e.LOGIN_CLIENT_ID="919866",e.LOGIN_PAGE_URL="https://login.skype.com/login",e.LOGIN_THEME="skype-white",e.LOGOUT_PAGE_URL="https://login.skype.com/logout",e.LOGIN_POPUP_URL="https://demoplayground.skype.com/joinlwc?t=",e.LOGIN_POPUP_FEATURES="width=600, height=620, menubar=no, status=no, titlebar=no, toolbar=no",e.LOGOUT_POPUP_FEATURES="width=1, height=1, menubar=no, status=no, titlebar=no, toolbar=no",e.TEAMS_URL="https://api.teams.skype.com/",e.TEAMS_AUTH_URL="https://authsvc-server.teams.microsoft.com",e.TEAMS_PROFILE_URL="https://teams.microsoft.com/",e.SHAREPOINT_URL="https://microsoft-my.sharepoint.com/",e.AMS_HOST_URL="https://api.asm.skype.com/v1/",e.APS_HOST_URL="https://api.aps.skype.com/v1/",e.CDN_SERVICE_HOST="secure.skypeassets.com",e.OA_URL="https://pro.skype.com/v1/onboarding",e.OA_URL_INT="https://havana-latest.skype.com/v1/onboarding",e.URLP_SERVICE_URL="https://urlp.asm.skype.com",e.ECS_GRAPH_URL="https://skypegraph.skype.com/",e.MS_GRAPH_URL="https://graph.microsoft.com/v1.0/me/",e.MS_APP_CLIENT_ID="b8d5facb-2aee-4653-98cb-4acc8f0d0e97",e.MS_APP_SECRET="sYUC331musgrjOBHJ45$%_}",e.MS_APP_REDIRECT_URL_DEMO="https://latest-swc.cdn.skype.com/demo/connect.html",e.MS_APP_REDIRECT_URL_OUTLOOK="https://latest-swc.cdn.skype.com/demo/msauth.html",e.MS_AUTHORIZE_URL="https://login.microsoftonline.com/common/oauth2/v2.0/authorize",e.ECS_GRAPH_ETAG=null,e.ECS_GRAPH_SERVICE_SETTINGS=null,e.INVITE_HOST_URL_INT="https://latest-join.skype.com/api/v1/",e.INVITE_HOST_URL="https://join.skype.com/api/v1/",e.CHAT_CLIENT_INFO="",e.CHAT_GUEST_HOST_URL="https://client-s.gateway.messenger.live.com/v1/",e.CHAT_HOST_URL="https://client-s.gateway.messenger.live.com/v1/",e.CHAT_JOIN_URL="https://latest-join.skype.com/api/v2/conversation",e.SKYPE_CALLER_ID="lwc",e.CONTACTS_HOST_URL="https://edge.skype.com/pcs-df/contacts/v2/",e.CONTACTS_SCD_HOST_URL="https://scd.skype.com/contacts/v3/",e.AGENTS_HOST_URL="https://join.skype.com/",e.AVATAR_SERVICE_URL="https://avatar.skype.com/v1/",e.STRATUS_DOMAIN_HOST_URL="https://profile.skype.com/profile/v1/",e.WX_HOST_URL="https://wx.skype.com/api/v1/scom/",e.ECS_CLIENT_NAME="skype",e.ECS_TEAM_NAME="lwc",e.ECS_CLIENT_VERSION="1.00",e.GET_HELP_URL="https://support.skype.com/en/faq/FA34704/what-is-skype-web-control",e.CONCIERGE_BOT_MRI="28:concierge",e.CONCIERGE_BOT_DF_MRI="28:concierge_df",e.DEFAULT_CLIENT_VERSION=e.getPlatformId()+"/0.0.0.0",e.CLIENT_VERSION=e.DEFAULT_CLIENT_VERSION,e.DEFAULT_AVATAR_URI="https://swc.cdn.skype.com/assets/img/defaultAvatar.png",e.WELCOME_IMG_URI="https://swc.cdn.skype.com/assets/img/welcome_add_2x.png",e.MSG_DELETED_CLASSIC_SKYPE="Edited previous message: ",e.UI_VERSION="",e.SYSTEM_INFO="",e.MESSAGE_PROPERTIES={GLOBAL:{ACTIVITY_DATA:"activityData",PINNED:"pinned",PROTOTYPE_SKYPEX:"prototype_skypex"},PER_USER:{EMOTIONS:"emotions",POLL:"poll",TRANSLATIONS:"translations",ACTIVITY_DATA:"activityData",SMS_REPORT:"smsdeliveryreports"}},e.CHAT_SERVICE_COMMANDS={SET_MESSAGE_PROPERTY:"setMessageProperty",REMOVE_MESSAGE_PROPERTY:"removeMessageProperty",REMOVE_ALL_MESSAGES:"removeAllMessage",SET_IS_FAVORITE:"setIsFavorite",SMS_PRICE:"getSmsPrice"},e}();t.default=c},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.CreateControl="createControl",e.IncomingCall="incomingCall",e.CallingReady="callingReady",e.RecentsReady="recentsReady",e.InChatCallingReady="inChatCallingReady",e.BotAddedToThread="botAddedToThread",e.RecentDataLoaded="recentDataLoaded",e.StartChat="startChat",e.StartCall="startCall",e.AcceptCall="acceptCall",e.RejectCall="rejectCall",e.UpdateCallingScreen="updateCallingScreen",e.ForceExpandChat="forceExpandChat",e.ToggleExpressionPicker="toggleExpressionPicker",e.HideExpressionPicker="hideExpressionPicker",e.PesConfigInitialized="pesConfigInitialized",e.Ready="ready",e.ChatOpen="chat-open",e.Click="click",e.Fullscreenchange="fullscreenchange",e.UpdateUnreadMessageCounter="updateUnreadMessageCounter",e.InappActivityStarted="inappActivityStarted",e.ClientOpened="clientOpened",e.ClientFocused="clientFocused",e.ChatServiceUnavailable="chatServiceUnavailable",e.RemoveAllMessagesFromUi="removeAllMessagesFromUi",e.RequestEditingMessage="requestEditingMessage",e.OnVisibilityChange="onVisibilityChange",e.OnMessageSent="onMessageSent",e.OnMessageReceived="onMessageReceived",e.onFocused="onFocused",e.OnConversationReady="onConversationReady",e.onControlShow="onControlShow",e.onControlHide="onControlHide",e.onControlClose="onControlClose",e.OnCallStart="onCallStart",e.OnCallConnect="onCallConnect",e.OnCallEnd="onCallEnd",e.CallingLayoutChanged="callingLayoutChanged",e.CallLayoutChanged="callLayoutChanged",e.CallStatusChanged="callStatusChanged",e.DevicesPermissions="devicesPermissions",e.DominantSpeakerChanged="dominantSpeakerChanged",e.EndpointRegistered="endpointRegistered",e.RecentConversationsFetched="recentConversationsFetched",e.UnreadConversationsUpdate="unreadConversationsUpdate",e.ReceivedNotification="receivedNotification",e.HideNotification="hideNotification",e.OpenRecentList="openRecentList",e.recentsShown="recentsShown",e.recentsHidden="recentsHidden",e.RecentItemSelected="onRecentItemSelected",e.recentsUIReady="recentsUIReady",e.recentItemsLoaded="recentItemsLoaded",e.onMessageExpand="onMessageExpand",e.onMessageCollapse="onMessageCollapse",e.OnConversationDelete="onConversationDelete",e.scrollToBottom="scrollToBottom",e.hideBubbleWindow="hideBubbleWindow",e.errorCode="errorCode",e.invoke={sendMessageToBotResponse:"invoke:sendMessageToBot:response",sendMessageToBot:"invoke:sendMessageToBot",signOut:"invoke:signOut",startCall:"invoke:startCall",stopCall:"invoke:stopCall",setAad:"invoke:setAad",getTokenExpirationTime:"invoke:getTokenExpirationTime",registerMask:"registerMask",unregisterMask:"unregisterMask"},e.cmd={reg:"cmd:register",unreg:"cmd:unregister",exec:"cmd:execute"},e.threadNotificationsProxy={reg:"proxy:threadNotifications:register",unreg:"proxy:threadNotifications:unregister",notify:"proxy:threadNotifications:notify"},e.messagingProxy={disconnect:"proxy:messaging:disconnect",disconnected:"proxy:messaging:disconnected"},e.conversationProxy={disableInput:"proxy:conversation:disableInput",expand:"proxy:conversation:expand",connected:"proxy:conversation:connected",focusInput:"proxy:conversation:focusInput",openFilePicker:"proxy:conversation:filepicker",setInputPlaceholder:"proxy:conversation:placeholder",setMessageProperties:"proxy:conversation:setMessageProperties",setInputText:"proxy:conversation:inputtext",toggleEmoticonPicker:"proxy:conversation:emoticonpicker",showConfirmationDialog:"proxy:conversation:showConfirmationDialog",resShowConfirmationDialog:"proxy:conversation:resShowConfirmationDialog",regMessageReceived:"proxy:conversation:regMessageReceived",messageReceived:"proxy:conversation:messageReceived",regUnreadCount:"proxy:conversation:regUnreadCount",unreadCount:"proxy:conversation:unreadCount",setActionBar:"proxy:conversation:setActionBar",resActionBar:"proxy:conversation:resActionBar",regDownload:"proxy:conversation:regDownload",resDownload:"proxy:conversation:resDownload"},e.proxy={resolve:"proxy:resolve",request:"proxy:request"},e.bridge={theme:{request:"bridge:request:theme",return:"bridge:request:return"}},e}();t.ApiEvents=i;var r=function(){function e(){}return e.SELECTED_PARTICIPANTS_CHANGE="selectedParticipants:change",e}();t.ParticipantEvents=r;var o=function(){function e(){}return e.SCROLL_RECOUNT="scroll:recount",e}();t.ScrollEvents=o;var s=function(){function e(){}return e.ITEM_SELECT_REQUEST="pes:picker:selectRequest",e.ITEM_SEND_REQUEST="pes:picker:sendRequest",e.ITEM_CANCEL_REQUEST="pes:picker:cancelRequest",e.OPEN_PICKER="pes:picker:open",e.SEARCH_QUERY_CHANGED="pes:picker:searchQueryChanged",e.CLEAR_SEARCH_RESULTS="pes:picker:clearSearchResults",e}();t.ExpressionPickerEvents=s;var a=function(){function e(){}return e.SEARCH_START="search:start",e.SHOW_CONTACTS="show:contacts",e.UPDATE_SEARCH_RESULTS="search:updateResults",e.TOGGLE_RESULTS_COMPONENT="search:toggleResultsComponent",e.SEARCH_CREATE_CONTACTLIST="create:contactlist",e.EMPTY_QUERY="search:EmptyQuery",e.FOCUS_SEARCH_INPUT="search:FocusInput",e.EMPTY_RESULTS="search:emptyResults",e}();t.SearchEvents=a;var c=function(){function e(){}return e.SHOW="campaign:show",e.DISMISS="campaign:dismiss",e}();t.CampaignEvents=c,function(e){e.TokenProviderRequest="swc:auth:request:tokenprovider",e.TokenProviderResponse="swc:auth:response:tokenprovider",e.RegionGtmsRequest="swc:auth:request:regiongtms",e.RegionGtmsResponse="swc:auth:response:regiongtms"}(t.AuthEvents||(t.AuthEvents={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(30),r=function(){function e(){}return e.Create=function(t,n,r){void 0===r&&(r=i.PIIType.NotSet);var o=new e;return o.key=t,o.value=n,o.type=r,o},e}();t.TelemetryPropertyValue=r},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s=n(18),a=n(13),c=n(0),l=n(38),u=function(e){function t(){var t=e.call(this)||this;return t.sessionId="",t.backend=a.MessagingBackend.UNDETERMINED,t.style="",t.translatorEnabled=!1,t.frameless=!1,t.callingReady=!1,t.standaloneCalling=!1,t.largeEmoticonClass=!1,t.isParallelView=!1,t.parentProtocol="n/a",t.bridge(),t}return r(t,e),Object.defineProperty(t,"get",{get:function(){return c.swc.shared.app||(c.swc.shared.app=new t),c.swc.shared.app},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentLocale",{get:function(){return l.default.locale},enumerable:!0,configurable:!0}),t.prototype.copy=function(e){e&&Object.getOwnPropertyNames(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);i&&i.writable&&(t[n]=i.value||t[n])})},t.prototype.isTeams=function(){return this.backend===a.MessagingBackend.TEAMS},Object.defineProperty(t.prototype,"theme",{get:function(){return this._theme},set:function(e){e!==this._theme&&(this._theme=e,this.publish("theme",e))},enumerable:!0,configurable:!0}),t.prototype.bridge=function(){var e=this;c.swc.API.registerEvent(o.ApiEvents.bridge.theme.return,function(t){return e.theme=t}),c.swc.API.triggerEvent(o.ApiEvents.bridge.theme.request)},t}(s.default);t.default=u},function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(29)),i(n(94)),i(n(95)),i(n(96)),i(n(41)),i(n(97))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),r=n(2),o=n(19),s=n(5);t.NA="n/a";var a=function(){function e(e){this.name=e,this.timestamp=Date.now(),this.type="general"}return e.prototype.getEventProperties=function(){return this.version=s.TelemetryPropertyValue.Create("version",r.default.ECS.version),this.host=s.TelemetryPropertyValue.Create("host",this.gethost()),this.isFirstPartyIntegration=s.TelemetryPropertyValue.Create("isFirstParty",this.isFirstParty()),this.lang=s.TelemetryPropertyValue.Create("locale",i.default.get.currentLocale),this.correlationId||(this.correlationId=s.TelemetryPropertyValue.Create("correlationId",i.default.get.correlationId)),this.identityType=this.identityType||s.TelemetryPropertyValue.Create("identitytype",t.NA),this.getCustomProperties()},e.prototype.getProperty=function(e){return void 0===e||null===e?t.NA:"string"!=typeof e?e+"":e},e.prototype.gethost=function(){return i.default.get.host&&i.default.get.host.toLowerCase()!==t.NA.toLowerCase()?i.default.get.host:o.default.getHost()||t.NA},e.prototype.isFirstParty=function(){var e=this.gethost();return[".skype.com",".bing.com",".live.com",".office.com",".office365.com",".msn.com",".linkedin.com",".azure.com",".microsoft.com"].some(function(t){return e.indexOf(t)>-1})},e}();t.TelemetryEvent=a},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.HTTP_ERROR_RANGE=1e3]="HTTP_ERROR_RANGE",e[e.ERR_FAIL_INIT=1]="ERR_FAIL_INIT",e[e.ERR_PARSE_RESPONSE=111]="ERR_PARSE_RESPONSE",e[e.ERR_PARSE_RESPONSE2=112]="ERR_PARSE_RESPONSE2",e[e.INFO_CONVERSATION_ALREADY_SUBSCRIBED=1e4]="INFO_CONVERSATION_ALREADY_SUBSCRIBED",e[e.INFO_REQUESTED_ECS=10001]="INFO_REQUESTED_ECS",e[e.ERR_UNSUPPORTED_CONVERSATION_ID=10002]="ERR_UNSUPPORTED_CONVERSATION_ID",e[e.ERR_UNSUPPORTED_CONVERSATION_ID_TYPE=10003]="ERR_UNSUPPORTED_CONVERSATION_ID_TYPE",e[e.ERR_RESOURCE_ALREADY_HANDLED=10004]="ERR_RESOURCE_ALREADY_HANDLED",e[e.ERR_UPDATE_SUBSCRIPTION=10005]="ERR_UPDATE_SUBSCRIPTION",e[e.ERR_ME_PERSON_ALREADY_FETCHED=10006]="ERR_ME_PERSON_ALREADY_FETCHED",e[e.ERR_FETCH_ME_PERSON=10007]="ERR_FETCH_ME_PERSON",e[e.INFO_CONTACT_ALREADY_SUBSCRIBED=10008]="INFO_CONTACT_ALREADY_SUBSCRIBED",e[e.ERR_DESTINATION_NOT_REACHABLE=10009]="ERR_DESTINATION_NOT_REACHABLE",e[e.DBG_DL_REQUIRES_TOKEN=10011]="DBG_DL_REQUIRES_TOKEN",e[e.ERR_GET_CONVERSATION_ID=10021]="ERR_GET_CONVERSATION_ID",e[e.DL_SERVICE_CREATE_CONVERSATION=10024]="DL_SERVICE_CREATE_CONVERSATION",e[e.ERR_CREATE_CONVERSATION=10025]="ERR_CREATE_CONVERSATION",e[e.DL_SERVICE_SEND_MESSAGE=10023]="DL_SERVICE_SEND_MESSAGE",e[e.ERR_SEND_MESSAGE=10026]="ERR_SEND_MESSAGE",e[e.ERR_RESET_TOKEN=10027]="ERR_RESET_TOKEN",e[e.ERR_SET_TOKEN_REFRESH_TIMEOUT=10028]="ERR_SET_TOKEN_REFRESH_TIMEOUT",e[e.ERR_UNDEFINED_IDENTITY_TYPE=10029]="ERR_UNDEFINED_IDENTITY_TYPE",e[e.ERR_PARSE_JSON=10030]="ERR_PARSE_JSON",e[e.ERR_UNKNOWN_BACKEND=10033]="ERR_UNKNOWN_BACKEND",e[e.ERR_INVALID_TIMEOUT=10040]="ERR_INVALID_TIMEOUT",e[e.INFO_JSON_EMPTY=10041]="INFO_JSON_EMPTY",e[e.INFO_ASYNC_FLAG_NOT_BOOLEAN=10042]="INFO_ASYNC_FLAG_NOT_BOOLEAN",e[e.ERR_UNSUPPORTED_LANGUAGE=10050]="ERR_UNSUPPORTED_LANGUAGE",e[e.ERR_NOT_SUPPORTED_YET=10051]="ERR_NOT_SUPPORTED_YET",e[e.ERR_NAME_ALREADY_EXISTS=10060]="ERR_NAME_ALREADY_EXISTS",e[e.ERR_CALLBACK_NAMESPACE_ALREADY_EXISTS=10061]="ERR_CALLBACK_NAMESPACE_ALREADY_EXISTS",e[e.ERR_INIT_POLLING=10070]="ERR_INIT_POLLING",e[e.ERR_PARSE_POLLING=10071]="ERR_PARSE_POLLING",e[e.DL_SERVICE_INIT_POLLING=10072]="DL_SERVICE_INIT_POLLING",e[e.ERR_PES_CONFIG_LOAD=10080]="ERR_PES_CONFIG_LOAD",e[e.ERR_LOAD_IMG=10110]="ERR_LOAD_IMG",e[e.ERR_UNKNOWN_MESSAGE_TYPE=10250]="ERR_UNKNOWN_MESSAGE_TYPE",e[e.ERR_I18N_NOT_INITIALIZED=10500]="ERR_I18N_NOT_INITIALIZED",e[e.ERR_CONVERSATION_MISSING=10501]="ERR_CONVERSATION_MISSING",e[e.ERR_DEFINE_CONVERSATION_PREFIX=10502]="ERR_DEFINE_CONVERSATION_PREFIX",e[e.ERR_FETCH_ME_PERSON_AND_LOAD_PES=10503]="ERR_FETCH_ME_PERSON_AND_LOAD_PES",e[e.ERR_CREATE_GROUP_WITH_GUEST=10504]="ERR_CREATE_GROUP_WITH_GUEST",e[e.DBG_EMPTY_CHAT_SHOWN=10505]="DBG_EMPTY_CHAT_SHOWN",e[e.INFO_JOIN_GROUP_DISABLED=10506]="INFO_JOIN_GROUP_DISABLED",e[e.ERR_JOIN_CONVERSATION=10507]="ERR_JOIN_CONVERSATION",e[e.ERR_SENDING_MESSAGE_TO_BOT=10508]="ERR_SENDING_MESSAGE_TO_BOT",e[e.ERR_FETCH_THREAD=10509]="ERR_FETCH_THREAD",e[e.ERR_ADD_BOT_TO_CONVERSATION=10510]="ERR_ADD_BOT_TO_CONVERSATION",e[e.ERR_ADD_PERSON_TO_CONVERESATION=10511]="ERR_ADD_PERSON_TO_CONVERESATION",e[e.ERR_REMOVE_PERSON_FROM_CONVERSATION=10512]="ERR_REMOVE_PERSON_FROM_CONVERSATION",e[e.ERR_RESOLVE_USER_DETAILS=10801]="ERR_RESOLVE_USER_DETAILS",e[e.ERR_UPDATE_CALLING_SCREEN=10901]="ERR_UPDATE_CALLING_SCREEN",e[e.ERR_HIDE_CALLING_SCREEN=10902]="ERR_HIDE_CALLING_SCREEN",e[e.ERR_FETCH_CONTACTS_MAIN=11001]="ERR_FETCH_CONTACTS_MAIN",e[e.ERR_FETCH_CONTACT_MAIN=11002]="ERR_FETCH_CONTACT_MAIN",e[e.ERR_FETCH_CONTACTS_TEAMS=11010]="ERR_FETCH_CONTACTS_TEAMS",e[e.ERR_GET_ECS_CONFIG=12001]="ERR_GET_ECS_CONFIG",e[e.ERR_GET_ADVANCED_SEARCH_PARAMS=12002]="ERR_GET_ADVANCED_SEARCH_PARAMS",e[e.ERR_START_CONVERSATION=100001]="ERR_START_CONVERSATION",e[e.ERR_FETCH_ME_PERSON_IN_LIST=101010]="ERR_FETCH_ME_PERSON_IN_LIST",e[e.ERR_START_CONVERSATION_WITH_BOT=105001]="ERR_START_CONVERSATION_WITH_BOT",e[e.ERR_CHECK_CONVERSATION_STATUS=105002]="ERR_CHECK_CONVERSATION_STATUS",e[e.ERR_CREATE_SUMMARY_NOTIFICATION=200001]="ERR_CREATE_SUMMARY_NOTIFICATION",e[e.ERR_CREATE_CALL_NOTIFICATION=200003]="ERR_CREATE_CALL_NOTIFICATION",e[e.ERR_UNIFIED_PRESENCE_FAILED=103501]="ERR_UNIFIED_PRESENCE_FAILED",e[e.ERR_UNIFIED_PRESENCE_NO_AAD=103502]="ERR_UNIFIED_PRESENCE_NO_AAD"}(t.ErrorCodes||(t.ErrorCodes={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=n(10),o=n(86),s=n(0),a=function(){function e(){}return e.throwError=function(e,t,n,r){var a=new Error(function(){if(!n||0===Object.getOwnPropertyNames(n).length)return e+(t?": "+t:"");if("string"==typeof n)return n;var i="";return Object.getOwnPropertyNames(n).forEach(function(e){i+=e+": "+n[e]+";"}),i}()),c=new o.ErrorEvent;c.code=e+"",c.message=a.message,c.shortMessage=e+(t?": "+t:""),c.stack=a.stack,c.conversationId=r,s.swc.API.triggerEvent(i.ApiEvents.errorCode,e);try{s.swc.services.telemetryManager.sendEvent(c)}catch(e){}},e.throwHttpErrorCode=function(e,t){e+=r.ErrorCodes.HTTP_ERROR_RANGE,s.swc.API.triggerEvent(i.ApiEvents.errorCode,e)},e}();t.default=a},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.UNDETERMINED=10]="UNDETERMINED",e[e.SKYPE=100]="SKYPE",e[e.DIRECT_LINE=200]="DIRECT_LINE",e[e.TEAMS=300]="TEAMS"}(t.MessagingBackend||(t.MessagingBackend={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),r=n(2),o=n(13),s=n(25),a=n(99),c=n(57),l={"<":"&lt;",">":"&gt;","&lt;":"<","&gt;":">","&LT;":"<","&GT;":">","&":"&amp;",'"':"&quot;","'":"&apos;","&amp;":"&","&quot;":'"',"&apos;":"'","&#39;":"'","&#96;":"`","&AMP;":"&","&QUOT;":'"',"&APOS;":"'"},u='(?:(?:\\s*title="[^"]+?"\\s*)|(?:\\s*tabindex="-1"\\s*)|(?:\\s*target="_blank"\\s*)){0,3}',d=a.default.multilineRegExp(["(&lt;a ",u,'href="((?:https?://|mailto:)[^"]+?)"',u,"&gt;)","((?:(?!&lt;/a&gt;)[\\s\\S])*)","(&lt;/a&gt;)"],"gi"),p={ALLOWED_TAGS:["span","canvas"],ALLOWED_ATTR:["id","type","data-item-id","class","data-is-animated"]},h={ALLOWED_TAGS:["b","i","s","br","at","ss","h1","h2","h3","h4","h5","h6","span","div","quote","ul","li","ol","em","strong","br","canvas","p","title","description"],ALLOWED_ATTR:["tabindex","title","target","id","type","data-item-id","class","data-is-animated"]},f=function(){function e(){}return e.map=function(e){return l[e]},e.multilineRegExp=function(e,t){return new RegExp(e.join(""),t)},e.modifyLinkAnchorOpening=function(e,t){return e.search(a.default.escapeSpecialChars(t))>-1?e:e.replace(/(<a|&lt;a)/,function(e){return e+" "+t})},e.escapeBrackets=function(e){return e.replace(/([<>])/gi,this.map)},e.unescapeBrackets=function(e){return e.replace(/(&lt;|&gt;)/gi,this.map)},e.unescape=function(e){return e.replace(/(&lt;|&gt;|&amp;|&quot;|&apos;|&#39;|&#96;)/gi,this.map)},e.validateUnescapedLink=function(e){return this.escapeBrackets(e).replace(d,this.validateAnchor)},e.parseTopic=function(t){return t?(t?e.unescape(t):"").replace(/<[^a\/].*?>(.*?)<\/[^a].*?>/gi,"$1").replace(/(<.*?\.{3,})$/,"").trim():t},e.getMessageSanitizedContent=function(e,t){var n={ALLOWED_TAGS:[],ALLOWED_ATTR:[]};return t&&t.noLinks?n=h:t&&t.noFormatting?n=p:(n={ALLOWED_TAGS:h.ALLOWED_TAGS.concat(["a"]),ALLOWED_ATTR:h.ALLOWED_ATTR.concat(["href"])},i.default.get.backend===o.MessagingBackend.TEAMS&&(n.ALLOWED_TAGS.push("img"),n.ALLOWED_ATTR.push("src","style","alt"))),s.default.dompurify.sanitize(e,n)},e.validateAnchor=function(t,n,i,r,o){var s=e.unescapeBrackets(n),a=e.unescapeBrackets(o);return 0!==i.indexOf("mailto:")&&(s=e.modifyLinkAnchorOpening(s,'target="_blank"')),s=e.modifyLinkAnchorOpening(s,'tabindex="-1"'),(s=e.modifyLinkAnchorOpening(s,'title="'+i+'"'))+r+a},e.webify=function(e){return e.replace(/(\r?\n)|(&lt;br\s?\/&gt;)/gm,"<br/>")},e.attachActionToLinks=function(e,t,n,i){if(1===e.nodeType&&e.matches(t))for(var r=e.querySelectorAll("a"),o=0;o<r.length;o++){var s=r[o];if(s.href.indexOf(n)>1){var a=c.default.getQueryParameter(s.href,n);a&&(s.setAttribute("data-swc-payload",a),s.addEventListener("click",i))}}},e.getSenderIdFromUrl=function(e){if(!e)return e;var t=e.match(/\/(\d+:[^?/]*)/);return t&&t[1]?t[1]:(e.match(/(\d+:[^?/]*)/),e)},e.extractMsgContent=function(e){return 0!==e.indexOf(r.default.MSG_DELETED_CLASSIC_SKYPE)?e:e.slice(r.default.MSG_DELETED_CLASSIC_SKYPE.length,e.length)},e}();t.default=f},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=function(){function e(e){var t=this;this._isCanceled=!1,this._status=i.Pending,this.cancel=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t._isCanceled||(t._isCanceled=!0,e[0]=e[0]||{},e[0].isCanceled=!0,t._status=i.Rejected,t._reject.apply(t._promise,e))},this._promise=new Promise(function(n,r){t._resolve=n,t._reject=r,e&&(e.then(function(e){t._isCanceled||(t._status=i.Resolved,n(e))},function(e){t._status=i.Rejected,r(e)}),e.catch(function(e){t._status=i.Rejected,t._isCanceled?r({isCanceled:!0}):r(e)}))})}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCanceled",{get:function(){return this._isCanceled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),e.prototype.resolve=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._status!==i.Resolved&&(this._status=i.Resolved,this._resolve.apply(this._promise,e))},e.prototype.cancelQuitely=function(){this.status===i.Pending&&(this.promise.then(function(){},function(){}),this.cancel())},e}();t.CancelablePromise=r,function(e){e[e.Pending=0]="Pending",e[e.Resolved=1]="Resolved",e[e.Rejected=2]="Rejected"}(i=t.PromiseStatus||(t.PromiseStatus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){var e=this;this.callbacks={},this.subscribe=function(t,n){void 0===e.callbacks[t]&&(e.callbacks[t]=new Array),e.callbacks[t].push(n)},this.unsubscribe=function(t,n){if(void 0!==e.callbacks[t]){var i=e.callbacks[t].indexOf(n);i>-1&&e.callbacks[t].splice(i,1)}},this.publish=function(t,n){void 0!==e.callbacks[t]&&e.callbacks[t].map(function(e){return e}).forEach(function(e){e(n)})}}return e.prototype.dispose=function(){for(var e in this.callbacks)this.callbacks.hasOwnProperty(e)&&(this.callbacks[e]=null);this.callbacks={}},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(39),r=n(0),o=n(92),s={allowedDomains:["swc.cdn.skype.com","latest-swc.cdn.skype.com"]},a=function(){function e(){}return e.combine=function(e,t){return e.lastIndexOf("/")!==e.length-1&&"/"!==t.substring(0,1)?e+"/"+t:this.getAppPath()+e+t},e.getAbsoluteUrl=function(e,t){var n=this.getCompletePath(e,t),o="css"===t?"css/":"";return e===i.PackageName.SDK_LOADER_CHAT?this.combine(r.swc.EcsConfig.loaderUrl,n):e===i.PackageName.CONNECT?this.combine(r.swc.EcsConfig.loaderUrl,n):this.combine(o,n)},e.getCompletePath=function(e,t){var n="";switch(r.swc.EcsConfig.environment){case"df":case"ppe":case"prod":n=".min"}return""+e+n+"."+t},e.setQueryParameters=function(e,t){return e+"?"+this.buildQueryParameters(t)},e.buildQueryParameters=function(e){var t=[];return Object.keys(e).forEach(function(n){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]))}),t.join("&")},e.getHost=function(){try{var e=window.location.hostname;return!e&&e.length>0?e:("file:"===window.location.protocol.toLowerCase()&&(e="local"),e)}catch(e){return null}},e.getVendorPath=function(){return e.getCDNPath()+"/vendors"},e.getConnectPagePath=function(){return e.getAppPath()+"connect.html"},e.getAppPath=function(){var t=0===r.swc.EcsConfig.version.indexOf("fb-")?"fb":"v";return e.getCDNPath()+"/"+t+"/"+r.swc.EcsConfig.version+"/"},e.getCDNPath=function(){var t=r.swc.EcsConfig.domain;return e.validateUriOrDie(t,s),t},e.validateUriOrDie=function(e,t){if(!o.UrlValidator.instance.validate(e,t))throw new Error("Invalid URI!")},e.appendQueryParam=function(e,t,n){return e+(-1===e.indexOf("?")?"?":"&")+encodeURIComponent(t)+"="+encodeURIComponent(n)},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.guid={generate:function(){var e=new Uint16Array(8);(window.crypto||window.msCrypto).getRandomValues(e);var t=0,n=function(){return(4369|e[t++]).toString(16)};return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()},isGuid:function(e){return/^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$/.test(e)}}},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(17),a=n(18),c=n(39),l=n(0),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getServices=function(){if(!l.swc||!l.swc.services)throw new Error("Unable to find services");return l.swc.services},t}(a.default);t.default=u,t.loadServices=function(){return o?o.promise:(o=new s.CancelablePromise,l.swc.services?(o.resolve(l.swc.services),o.promise):(l.swc.scriptLoader.addScript(c.PackageName.SERVICES,!0,function(){var e=l.swc.services;o.resolve(e)}),o.promise))},t.getServices=function(){var e=l.swc.services;if(!e)throw new Error("Services are not found");return e}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.SignedOut=0]="SignedOut",e[e.SigningIn=1]="SigningIn",e[e.SignedIn=2]="SignedIn",e[e.SigningOut=3]="SigningOut"}(t.SigninState||(t.SigninState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r,o,s=n(33),a=n(28),c=n(20),l={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"};!function(e){e.Desktop="Desktop",e.Mobile="Mobile",e.Tablet="Tablet"}(i=t.DeviceType||(t.DeviceType={})),function(e){e.MSIE="MSIE",e.CHROME="Chrome",e.FIREFOX="Firefox",e.SAFARI="Safari",e.EDGE="Edge",e.ELECTRON="Electron",e.SKYPE_SHELL="SkypeShell",e.PHANTOMJS="PhantomJS",e.UNKNOWN="Unknown"}(r=t.BrowserVendor||(t.BrowserVendor={})),function(e){e.WINDOWS="Windows",e.MACOSX="Mac OS X",e.WINDOWS_PHONE="Windows Phone",e.WINDOWS_RT="Windows RT",e.IOS="iOS",e.ANDROID="Android",e.LINUX="Linux",e.UNKNOWN="Unknown"}(o=t.OperatingSystem||(t.OperatingSystem={})),t.UNKNOWN_VERSION="U";var u=function(){function e(){}return e.getDeviceType=function(){return window.navigator.userAgent.match(/(android|ipod|windows phone|wpdesktop|windows ce|blackberry\w*|meego|webos|palm|symbian|pda|\w*?mobile\w*?|\w*?phone\w*?)/i)?i.Mobile:window.navigator.userAgent.match(/tablet|ipad/i)?i.Tablet:i.Desktop},e.getUserAgent=function(){return a.default.getWindow().navigator.userAgent},e.userAgentContainsString=function(e){return this.getUserAgent().indexOf(e)>-1},e.isChrome=function(){return this.userAgentContainsString(r.CHROME)&&!this.userAgentContainsString(r.EDGE)},e.isIe=function(){return this.userAgentContainsString("Trident")},e.isEdge=function(){return this.userAgentContainsString(r.EDGE)},e.isOpera=function(){return this.userAgentContainsString("OPR/")},e.testSupporedList=function(t){if(!t)return!1;t.constructor!==Array&&"string"==typeof t&&(t=[t]);for(var n=e.getBrowserName().toLocaleLowerCase(),i=0;i<t.length;i++)if(t[i].toLowerCase().indexOf(n)>-1)return!0;return!1},e.getBrowserName=function(){return this.isOpera()?r.UNKNOWN:this.userAgentContainsString(r.PHANTOMJS)?r.PHANTOMJS:this.isEdge()?r.EDGE:this.userAgentContainsString(r.ELECTRON)?r.ELECTRON:this.userAgentContainsString(r.CHROME)?r.CHROME:this.userAgentContainsString(r.FIREFOX)?r.FIREFOX:this.userAgentContainsString(r.SAFARI)?r.SAFARI:this.userAgentContainsString(r.SKYPE_SHELL)?r.SKYPE_SHELL:this.isIe()?r.MSIE:r.UNKNOWN},e.getBrowserVersion=function(){var e,n,i,o,s,a=this;return this.isIe()?(o=a.getUserAgent(),(s=o.match(new RegExp(r.MSIE+" ([\\d,.]+)")))?s[1]:(i=o.match(new RegExp("rv:([\\d,.]+)")))?i[1]:void 0):((e=this.getBrowserName())===r.SAFARI&&(e="Version"),(n=a.getUserAgent().match(new RegExp(e+"/([\\d,.]+)")))?n[1]:t.UNKNOWN_VERSION)},e.getScreenInfo=function(){var e=a.default.getWindow(),t=a.default.getWindow().navigator;return{width:a.default.getWindow().screen&&a.default.getWindow().screen.width||0,height:a.default.getWindow().screen&&a.default.getWindow().screen.height||0,pixelRatio:a.default.getWindow().devicePixelRatio||0,colorDepth:a.default.getWindow().screen&&a.default.getWindow().screen.colorDepth||0,isTouchEnabled:Object.prototype.hasOwnProperty.call(e,"ontouchstart")||t.MaxTouchPoints>0}},e.getOsName=function(){var e=this.getUserAgent();return e.match(/windows\sphone\s\d+\.\d+/i)?o.WINDOWS_PHONE:e.match(/ arm;/i)?o.WINDOWS_RT:e.match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?o.IOS:e.match(/android/i)?o.ANDROID:e.match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|cros)/i)?o.LINUX:e.match(/(macintosh|mac os x)/i)?o.MACOSX:e.match(/(windows|win32)/i)?o.WINDOWS:o.UNKNOWN},e.getOsVersion=function(e){var n=this;void 0===e&&(e=!1);var i;return this.getOsName()===o.WINDOWS?function(e){var i=n.getUserAgent().match(new RegExp("Windows NT ([\\d,.]+)"));if(i){if(e)return i[1];if(l[i[1]])return l[i[1]]}return t.UNKNOWN_VERSION}(e):this.getOsName()===o.MACOSX&&(i=n.getUserAgent().match(new RegExp(o.MACOSX+" ([\\d,_,.]+)")))?i[1].replace(/_/g,"."):t.UNKNOWN_VERSION},e.getDeviceId=function(){var e=s.LocalStorage,t=e.getItem("swc-deviceId");return t||(t=c.guid.generate(),e.setItem("swc-deviceId",t)),t},e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return Object.defineProperty(e,"dompurify",{get:function(){var e=window;return e.DOMPurify||(e.DOMPurify=n(68)),e.DOMPurify},enumerable:!0,configurable:!0}),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.PERSON=1]="PERSON",e[e.THREAD=2]="THREAD",e[e.BOT=3]="BOT",e[e.JOIN_URL=4]="JOIN_URL",e[e.DIRECT_LINE_TOKEN=5]="DIRECT_LINE_TOKEN",e[e.PHONE=6]="PHONE"}(t.SDKMode||(t.SDKMode={}))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.getWindow=function(){return window},e.getDocument=function(){return window.document},e.getParentWithClass=function(e,t){for(;e&&!this.hasClass(e,t);)e=e.parentNode;return e},e.isInViewport=function(e){var t=this.getWindow();return e.bottom>0&&e.right>0&&e.top<t.innerHeight&&e.left<t.innerWidth},e.readDataset=function(e,t,n){return e.dataset?e.dataset[t]:e.getAttribute("data-"+n)},e.writeDataset=function(e,t,n,i){e.dataset?e.dataset[t]=i:e.setAttribute("data-"+n,i)},e.hasClass=function(e,t){if(e.classList)return e.classList.contains(t);for(var n=0,i=e.className?e.className.split(" "):[];n<i.length;n++){if(i[n]===t)return!0}return!1},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Skype=8]="Skype",e[e.Agent=28]="Agent",e[e.Pstn=4]="Pstn",e[e.MSA=1]="MSA",e[e.Undefined=0]="Undefined"}(t.ContactType||(t.ContactType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NotSet=0]="NotSet",e[e.Identity=10]="Identity"}(t.PIIType||(t.PIIType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(41),r=n(11),o=n(26),s=n(10),a=function(){function e(){}return e.strip=function(e){var t=e.match(this.idRegExp);return t?t[2]:e},e.detectConversationType=function(e){if(!e)return i.ConversationType.UNDEFINED;if(this.typeMapppings[e])return this.typeMapppings[e];var t,n=e.match(this.idRegExp);if(n&&(t=this.getTypeByPrefix(n[1])),t)return this.typeMapppings[e]=t,t;if(0===e.indexOf("https://join.skype.com/"))return this.typeMapppings[e]=i.ConversationType.JOIN,i.ConversationType.JOIN;if(/^(28:)?[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i.test(e))return this.typeMapppings[e]=i.ConversationType.AGENT,i.ConversationType.AGENT;if(/^(19:)?[\S]+[@]([\S].)?[\S]*thread\.skype/i.test(e))return this.typeMapppings[e]=i.ConversationType.GROUP,i.ConversationType.GROUP;if(/(?:00|\+)?(^[^a-z][^A-Z])(\d+$)/i.test(e.replace(/\s+|[()\-\+]/gi,"")))return this.typeMapppings[e]=i.ConversationType.PHONE,i.ConversationType.PHONE;return/^(99:)?([A-Z]|[a-z][^\.])+([\S])*\.(cwA|dAA)/i.test(e)?(this.typeMapppings[e]=i.ConversationType.DIRECT_LINE,i.ConversationType.DIRECT_LINE):(this.typeMapppings[e]=i.ConversationType.PERSON,i.ConversationType.PERSON)},e.getSdkModeFromId=function(e){switch(this.detectConversationType(e)){case i.ConversationType.PERSON:return o.SDKMode.PERSON;case i.ConversationType.AGENT:return o.SDKMode.BOT;case i.ConversationType.JOIN:return o.SDKMode.JOIN_URL;case i.ConversationType.DIRECT_LINE:return o.SDKMode.DIRECT_LINE_TOKEN;case i.ConversationType.PHONE:return o.SDKMode.PHONE;case i.ConversationType.GROUP:return o.SDKMode.THREAD}return o.SDKMode.UNDEFINED},e.toFullIdentifier=function(e){var t=this.getPrefixForId(e);return 0===e.indexOf(t+":")?e:t?t+":"+e:e},e.addPrefix=function(e,t){return 0===t.indexOf(e+this.SPLITTER)?t:0===t.indexOf(this.SPLITTER)?e+t:e+this.SPLITTER+t},e.getNormalizeId=function(e){return e.match(this.idRegExp)?e.replace(/\d{1,2}:/,""):e},e.isEqual=function(e,t){return this.toFullIdentifier(e).toLowerCase()===this.toFullIdentifier(t).toLowerCase()},e.getPrefixForId=function(e){if(this.hasAlreadyPrefix(e))return"";var t=this.getSdkModeFromId(e);switch(t){case o.SDKMode.PERSON:return"8";case o.SDKMode.BOT:return"28";case o.SDKMode.THREAD:return"19";case o.SDKMode.DIRECT_LINE_TOKEN:return"99";case o.SDKMode.PHONE:return"4";default:r.default.throwError(s.ErrorCodes.ERR_DEFINE_CONVERSATION_PREFIX,"Unable to define conversation prefix",{id:e,sdkMode:t})}return""},e.getTypeByPrefix=function(e){if(!e)return i.ConversationType.UNDEFINED;switch(e.indexOf(":")>-1&&(e=e.replace(":","")),e){case"4":return i.ConversationType.PHONE;case"8":return i.ConversationType.PERSON;case"19":return i.ConversationType.GROUP;case"28":return i.ConversationType.AGENT;case"99":return i.ConversationType.DIRECT_LINE;default:return i.ConversationType.UNDEFINED}},e.hasAlreadyPrefix=function(e){var t=/^\d+:/.exec(e);return!!t&&!!t[0]},e.SPLITTER=":",e.idRegExp=/(\d{1,2}:)([\S]*)/,e.typeMapppings={},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.UNDETERMINED=10]="UNDETERMINED",e[e.GUEST=100]="GUEST",e[e.SKYPE=200]="SKYPE",e[e.DL_TOKEN=300]="DL_TOKEN",e[e.TEAMS=400]="TEAMS"}(t.IdentityType||(t.IdentityType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.getItem=function(e){return this.get().getItem(e)},e.setItem=function(e,t){this.get().setItem(e,t)},e.removeItem=function(e){this.get().removeItem(e)},e.get=function(){if(this._storage)return this._storage;try{"object"==typeof sessionStorage&&(localStorage.setItem("ls","0"),localStorage.removeItem("ls"),this._storage=window.sessionStorage)}catch(e){this._storage=new o}return this._storage},e}();t.default=i;var r=function(){function e(){}return e.getItem=function(e){var t=this.get();return t?t.getItem(e):""},e.setItem=function(e,t){this.get().setItem(e,t)},e.removeItem=function(e){this.get().removeItem(e)},e.get=function(){if(this._storage)return this._storage;try{"object"==typeof localStorage&&(localStorage.setItem("ls","0"),localStorage.removeItem("ls"),this._storage=window.localStorage)}catch(e){this._storage=new o}return this._storage},e}();t.LocalStorage=r;var o=function(){function e(){this._items={}}return Object.defineProperty(e.prototype,"length",{get:function(){return this._items.length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._items.length=0},e.prototype.getItem=function(e){return this._items[e]},e.prototype.key=function(e){return null},e.prototype.removeItem=function(e){delete this._items[e]},e.prototype.setItem=function(e,t){this._items[e]=t},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(24),r={id:"flik",ariaLabelLocKey:"expressionPicker_mruMojiPack_ariaLabel",titleLocKey:"expressionPicker_mruMojiPack_title",mruLimit:10},o=function(){function e(){var e=this;this.CACHE_KEY="swx|pes",this.SAVED_DATA_VERSION="v1.0",this.FEATURED_IN_PREFIX="FeaturedIn-",this.pesCDNAuthentication={skypeServiceHost:"static.asm.skype.com",tokenSourceEndpoint:"/pes/v1/petoken",cdnServiceHost:"static-asm.secure.skypeassets.com",cookieSourceEndpoint:"/token/token_to_cookies",securedPathsPatter:"static[.]asm[.]skype[.]com",cdnTokenTtlMs:3e5,rewriteRules:[{from:"static.asm.skype.com",to:"static-asm.secure.skypeassets.com"},{from:"api.asm.skype.com",to:"static-asm.secure.skypeassets.com"}]},this.itemTypes={typeKeyName:"type",tab:{id:"tab",ariaLabelLocKey:"expressionPicker_mruTab_ariaLabel",titleLocKey:"expressionPicker_mruTab_title"},emoticon:{id:"emoticon",ariaLabelLocKey:"expressionPicker_mruEmoticonPack_ariaLabel",titleLocKey:"expressionPicker_mruEmoticonPack_title",mruLimit:27},moji:r,image:{id:"image"},message:{id:"message"},sticker:{id:"sticker"},flik:r},this.mru={TAB_ID:"mru",PACK_PREFIX:"mru:"},this.bingSearch={TAB_ID:"bing",PACK_PREFIX:"bing:"},this.giphyImageSearch={TAB_ID:"giphyImages",PACK_PREFIX:"giphy-imh:"},this.localSearch={TAB_ID:"localSearch",PACK_PREFIX:"local:",titleLocKey:"expressionPicker_localSearchPack_title",ariaLabelLocKey:"expressionPicker_localSearchPack_ariaLabel"},this.frameHeights={emoticons:{SMALL:20,LARGE:40,EXTRA_LARGE:60,SUPER_LARGE:120},moji:{THUMBNAIL:40,KEYFRAME:80},packs:{TAB:19}},this.profiles={emoticons:{getSmall:function(){return e.highDpi?"default_40_f":"default_20_f"},getLarge:function(){return e.highDpi?"default_80_f":"default_40_f"},getExtraLarge:function(){return e.highDpi?"default_120_f":"default_60_f"},getSuperLarge:function(){return e.highDpi?"default_240_f":"default_120_f"},getSmallAnimated:function(){return e.highDpi?"default_40_anim_f":"default_20_anim_f"},getLargeAnimated:function(){return e.highDpi?"default_80_anim_f":"default_40_anim_f"},getExtraLargeAnimated:function(){return e.highDpi?"default_120_anim_f":"default_60_anim_f"},getSuperLargeAnimated:function(){return e.highDpi?"default_240_anim_f":"default_120_anim_f"}},moji:{thumbnail:"thumbnail",content:"default"}}}return Object.defineProperty(e.prototype,"highDpi",{get:function(){return this._highDpi||(this._highDpi=i.default.getScreenInfo().pixelRatio>1),this._highDpi},enumerable:!0,configurable:!0}),e}();t.default=new o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={"ª":"a","º":"o","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","ÿ":"y","ā":"a","ă":"a","ą":"a","ć":"c","ĉ":"c","ċ":"c","č":"c","ď":"d","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","ĥ":"h","ĩ":"i","ī":"i","ĭ":"i","į":"i","ĳ":"ij","ĵ":"j","ķ":"k","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l·","ń":"n","ņ":"n","ň":"n","ŉ":"ʼn","ō":"o","ŏ":"o","ő":"o","ŕ":"r","ŗ":"r","ř":"r","ś":"s","ŝ":"s","ş":"s","š":"s","ţ":"t","ť":"t","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","ŵ":"w","ŷ":"y","ź":"z","ż":"z","ž":"z","ſ":"s","ơ":"o","ư":"u","ǆ":"dz","ǈ":"Lj","ǉ":"lj","ǋ":"Nj","ǌ":"nj","ǎ":"a","ǐ":"i","ǒ":"o","ǔ":"u","ǖ":"u","ǘ":"u","ǚ":"u","ǜ":"u","ǟ":"a","ǡ":"a","ǧ":"g","ǩ":"k","ǫ":"o","ǭ":"o","ǰ":"j","ǳ":"dz","ǵ":"g","ǹ":"n","ǻ":"a","ȁ":"a","ȃ":"a","ȅ":"e","ȇ":"e","ȉ":"i","ȋ":"i","ȍ":"o","ȏ":"o","ȑ":"r","ȓ":"r","ȕ":"u","ȗ":"u","ș":"s","ț":"t","ȟ":"h","ȧ":"a","ȩ":"e","ȫ":"o","ȭ":"o","ȯ":"o","ȱ":"o","ȳ":"y","ʰ":"h","ʲ":"j","ʳ":"r","ʷ":"w","ʸ":"y","ˡ":"l","ˢ":"s","ˣ":"x"},r=function(){function e(){}return e.toBoolean=function(e){return e?"true"===e.toLowerCase():null},e.wordAt=function(e,t){var n=this.wordBoundariesAt(e,t);return e.substring(n.start,n.end)},e.inject=function(e,t,n,i){return void 0===i&&(i=n),e.substr(0,n)+t+e.substr(i,e.length)},e.wordBoundariesAt=function(e,t){var n=e.substring(0,t).search(/\S+$/),i=e.substring(t).search(/\s/);return-1===n&&(n=t),-1===i?i=e.length:i+=t,{start:n,end:i}},e.b64DecodeUnicode=function(e){return decodeURIComponent(Array.prototype.map.call(atob(e),function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},e.zipString=function(e,t){return 0===e.length?t:0===t.length?e:e[0]+t[0]+this.zipString(e.substr(1),t.substr(1))},e.normalizeString=function(e){if(e=e.toLowerCase(),String.prototype.normalize)return e.normalize("NFKD").replace(/[\u0300-\u036f]/g,"");var t=parseInt("0xD800",16),n=parseInt("0xDBFF",16),r=0,o="",s="",a=void 0;if(!e)return e;for(;r<e.length;)o+=e.charAt(r),((a=e.charCodeAt(r))<t||a>n)&&(s+=i.hasOwnProperty(o)?i[o]:o,o=""),r++;return s},e}();t.default=r},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),s=n(30),a=n(13),c=n(26),l=n(11),u=n(31),d=n(5),p=n(8),h=n(10),f=function(e){function t(t,n){var i=e.call(this,t)||this;i.conversation=n,i._topic=p.NA,i._topic=n.topic;return i._topicUpdateHandler=function(e){i._topic=e}.bind(i),n.subscribe("topic",i._topicUpdateHandler),i}return r(t,e),t.prototype.getCustomProperties=function(){this.conversation.unsubscribe("topic",this._topicUpdateHandler);var e=new Array;return e.push(this.getConversationId()),e.push(d.TelemetryPropertyValue.Create("conversationType",this.conversation.getConversationType())),e.push(this.getSDKMode()),e.push(this.getBackend()),e.push(this.getConversationTopic()),e.push(this.getTrafficProvider()),e.push(this.getTrafficSource()),e},t.prototype.getConversationId=function(){switch(this.conversation.getConversationType()){case o.ConversationType.AGENT:case o.ConversationType.DIRECT_LINE:return d.TelemetryPropertyValue.Create("conversationId",u.default.getNormalizeId(this.conversation.id));default:return d.TelemetryPropertyValue.Create("conversationId",u.default.getNormalizeId(this.conversation.id),s.PIIType.Identity)}},t.prototype.getConversationTopic=function(){var e=p.NA;return this.conversation.getConversationType()!==o.ConversationType.AGENT&&this.conversation.getConversationType()!==o.ConversationType.DIRECT_LINE||(e=this._topic&&""!==this._topic?this._topic:p.NA),d.TelemetryPropertyValue.Create("conversationTopic",e)},t.prototype.getBackend=function(){var e="",t=this.conversation.getBackend();switch(t){case a.MessagingBackend.UNDETERMINED:e=p.NA;break;case a.MessagingBackend.SKYPE:e="Skype";break;case a.MessagingBackend.DIRECT_LINE:e="DirectLine";break;case a.MessagingBackend.UNDEFINED:e=p.NA;break;default:l.default.throwError(h.ErrorCodes.ERR_UNKNOWN_BACKEND,"Unknown backend:"+t)}return d.TelemetryPropertyValue.Create("backend",e)},t.prototype.getSDKMode=function(){var e="",t=u.default.getSdkModeFromId(this.conversation.id);switch(t){case c.SDKMode.BOT:e="bot";break;case c.SDKMode.DIRECT_LINE_TOKEN:e="DirectLine";break;case c.SDKMode.JOIN_URL:e="url";break;case c.SDKMode.PERSON:e="person";break;case c.SDKMode.THREAD:e="thread";break;case c.SDKMode.PHONE:e="phone";break;case c.SDKMode.UNDEFINED:e=p.NA;break;default:l.default.throwError(h.ErrorCodes.ERR_UNDEFINED_IDENTITY_TYPE,"Unknown identityType:"+t)}return d.TelemetryPropertyValue.Create("sdkMode",e)},t.prototype.getTrafficProvider=function(){var e=this.conversation.definition?this.conversation.definition.TrafficProvider:p.NA;return d.TelemetryPropertyValue.Create("provider",e)},t.prototype.getTrafficSource=function(){var e=this.conversation.definition?this.conversation.definition.TrafficSource:p.NA;return d.TelemetryPropertyValue.Create("source",e)},t}(p.TelemetryEvent);t.ConversationDataEvent=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.prototype.transformRawToXml=function(e,t,n,i){var r=[];for(r.push(t);0!==r.length;){var o=r.pop();o.nodeType===Node.TEXT_NODE?this.encodeTextNodeToXml(e,o,n,i):this.isElementAllowed(o)&&this.pushChildNodes(r,o)}},e.prototype.wordMatcher=function(){return/[\w()#:\-=<>;'\|\$"\]\*\^&\+@\{\?Ǝ\/\\!~]+/g},e.prototype.getAllWords=function(e){for(var t,n=this.wordMatcher(),i=new Array;null!==(t=n.exec(e));)i.push(t);return i},e.prototype.encodeTextNodeToXml=function(e,t,n,i){var r=t.parentNode,o=this.encodeWords(e,t,n,i);o&&o.length&&(o.forEach(function(e){r.insertBefore(e,t)}),r.removeChild(t))},e.prototype.encodeWords=function(e,t,n,i){var r=this,o=t.nodeValue,s=0,a=[];return this.getAllWords(o).forEach(function(t){var c=r.wordRawToXml(e,t[0],n,i);0!==c.length&&(s!==t.index&&a.push(e.createTextNode(o.substring(s,t.index))),s=t.index+t[0].length,a=a.concat(c))}),0!==s&&s<o.length&&a.push(e.createTextNode(o.substring(s))),a},e.prototype.pushChildNodes=function(e,t){for(var n=0;n<t.childNodes.length;n++)e.push(t.childNodes[n])},e}();t.WordDomTransformer=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return Object.defineProperty(e,"locale",{get:function(){return this._locale?this._locale:document.documentElement.lang?document.documentElement.lang.toLowerCase():window.navigator.languages&&0!==window.navigator.languages.length?window.navigator.languages[0].toLowerCase():navigator.language.toLowerCase()},set:function(e){e=e||"",this._locale=e.toLowerCase()},enumerable:!0,configurable:!0}),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.DIRECTLINE_CHAT="directline-bundle",e.SDK_LOADER_CHAT="sdk-loader",e.SDK_CORE="sdk-core",e.ASSETS="assets-bundle",e.BUILDER="builder-bundle",e.BUILDER_CORE="builder-core",e.CALLING="calling-bundle",e.CALLING_STANDALONE="callingStandalone-bundle",e.SERVICES="services-bundle",e.CHAT_BUNDLE="chat-bundle",e.RECENTS_BUNDLE="recents-bundle",e.UICOMPONENT_BUNDLE="uicomponent-bundle",e.INDEX_BUILDER="index-builder",e.INDEX_CHAT="lwc-chat-index",e.INDEX_CALLING="calling-index",e.INDEX_RECENTS="recents-index",e.CONNECT="connect",e.HOST_CHAT_PAGE="host-chat",e.HOST_BING_PAGE="host-button",e.HOST_BUILDER_PAGE="host-builder",e.STYLE_BUILDER="swc-builder",e.STYLE_SDK="swc-sdk",e.STYLE_CHAT_SKYPE="swc-chat",e.STYLE_RECENTS_SKYPE="swc-recents",e.STYLE_CHAT_BING="swc-bing",e.STYLE_CHAT_THEME_DARK="swc-dark",e.STYLE_CALLING="swc-calling",e}();t.PackageName=i},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.callbacks=new Array,t.pushObservable=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];e.prototype.push.apply(t,n);var r=new s;return r.newItems=n,t.publish(r),t.length},t.popObservable=function(){var n=e.prototype.pop.call(t);return t.publish(),n},t.shiftObservable=function(){var n=e.prototype.shift.call(t);return t.publish(),n},t.unshiftObservable=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];e.prototype.unshift.apply(t,n);var r=new s;return r.newItems=n,t.publish(r),t.length},t.sortObservable=function(n){var i=e.prototype.sort.call(t,n);return t.publish(),i},t.spliceObservable=function(n,i){for(var r,o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];r=i?o?e.prototype.splice.apply(t,[n,i].concat(o)):e.prototype.splice.call(t,n,i):e.prototype.splice.call(t,n);var c=new s;return c.oldItems=r,t.publish(c),r},t.subscribe=function(e){t.callbacks.push(e)},t.unsubscribe=function(e){var n=t.callbacks.indexOf(e);n>-1&&t.callbacks.splice(n,1)},t.dispose=function(){t.callbacks.forEach(function(e,n){t.callbacks[n]=null}),t.callbacks=[]},t.publish=function(e){e||((e=new s).newItems=new Array),t.callbacks.forEach(function(n){n(t,e)})},t}return r(t,e),t}(Array);t.ObservableCollection=o;var s=function(){function e(){}return Object.defineProperty(e.prototype,"newItems",{get:function(){return this._newItems},set:function(e){this._newItems=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oldItems",{get:function(){return this._oldItems},set:function(e){this._oldItems=e},enumerable:!0,configurable:!0}),e}();t.CollectionChangedEventArgs=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.UNDEFINED="",e.PERSON="person",e.PHONE="phone",e.AGENT="agent",e.JOIN="join",e.GROUP="group",e.DIRECT_LINE="dl"}(t.ConversationType||(t.ConversationType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(29),r=function(){function e(){}return e._personIdRegExp=/(\d+:)([\S]*)/,e.normalizePersonId=function(t){var n=t.match(e._personIdRegExp);return n?n[2]:t},e.parsePersonId=function(t){var n=t.match(e._personIdRegExp);return n?{id:n[2],type:parseInt(n[1],0)}:{id:t,type:null}},e.getContactType=function(e){var t=/\d{0,}[^:]/g.exec(e.mri);return t&&t[0]?parseInt(t[0],0):i.ContactType.Undefined},e.replaceAvatarPath=function(e){return e.indexOf("data:image/jpeg;base64")>-1?e:e=(e=e.replace("URL@","")).indexOf("/views/avatar_fullsize")<0?e+"/views/avatar_fullsize":e},e.resolveConversationAvatar=function(t,n){return n?t?e.replaceAvatarPath(n):n:""},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(29),r=function(){function e(){}return e._personIdRegExp=/(\d+:)([\S]*)/,e.normalizePersonId=function(t){var n=t&&t.match(e._personIdRegExp);return n?n[2]:t},e.parsePersonId=function(t){var n=t.match(e._personIdRegExp);return n?{id:n[2],type:parseInt(n[1],0)}:{id:t,type:null}},e.getContactType=function(e){var t=/\d{0,}[^:]/g.exec(e.mri);return t&&t[0]?parseInt(t[0],0):i.ContactType.Undefined},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.BUTTON_SEND_CLICK=1]="BUTTON_SEND_CLICK",e[e.KEYPRESS_ENTER=2]="KEYPRESS_ENTER",e[e.WELCOME_MESSAGE=3]="WELCOME_MESSAGE",e[e.TYPING=4]="TYPING",e[e.SUGGESTED_ACTION=5]="SUGGESTED_ACTION",e[e.BUTTON_SWIFT_CLICKED=6]="BUTTON_SWIFT_CLICKED",e[e.INVITE=7]="INVITE",e[e.ADDON=8]="ADDON"}(t.ActionTrigger||(t.ActionTrigger={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=n(0),o=n(59),s=function(){function e(){this.requests={}}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!0,configurable:!0}),e.prototype.async=function(e,t,n){var o=this,s=r.swc.API;return this.requests[t]=this.requests[t]||new Promise(function(r,a){var c=n&&setTimeout(a,n),l=function(n){n&&n.refId&&n.refId===t&&(c&&clearTimeout(c),s.unregisterEvent(i.ApiEvents.proxy.resolve,l),r(o.create(e,n)))};s.registerEvent(i.ApiEvents.proxy.resolve,l)}),setTimeout(function(){s.triggerEvent(i.ApiEvents.proxy.request,t)},0),this.requests[t]},e.prototype.create=function(e,t){return new e(t)},e}();t.ProxyFactory=s;var a=function(){return function(e){var t=this;this.data={},this.callCount=0,this.exec=function(e,t){return r.swc.API.triggerEvent(e,t)},this.reg=function(e,t){return r.swc.API.registerEvent(e,t)},this.createCID=function(){return o.hashCode((t.callCount++).toString()+t.refId)},this.refId=e.refId,this.data=e,this.init()}}();t.Proxy=a;var c=function(){function e(){var e=this;this.connections={},this.answer=function(t){var n=e.connections[t];n&&e.events.triggerEvent(i.ApiEvents.proxy.resolve,Object.assign(n,{refId:t}))},this.events=r.swc.API,this.events.registerEvent(i.ApiEvents.proxy.request,this.answer)}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!0,configurable:!0}),e.prototype.connect=function(e,t,n){this.connections[e]||(this.connections[e]=t||{},n&&n(),this.answer(e))},e.prototype.disconnect=function(e){delete this.connections[e]},e}();t.ProxyConnector=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(29),r={caseFirst:"upper"},o=function(){function e(){}return e.mapSearchProfileInfo=function(e){return e&&e.results?e.results.map(function(e){var t=e.nodeProfileData.skypeId,n={skypeid:-1===t.indexOf("8:")?"8:"+t:t,name:e.nodeProfileData.name,avatar:e.nodeProfileData.avatarUrl,type:i.ContactType.Skype,contactType:e.nodeProfileData.contactType,annotation:e.nodeAnnotation,jobTitle:e.nodeProfileData.jobTitle,department:e.nodeProfileData.department,location:e.nodeProfileData.location};return e.nodeConnectionData&&(n.distance=e.nodeConnectionData.distance,n.mutualFriendCount=e.nodeConnectionData.mutualFriendCount),n}):[]},e.getWrappedIdWithMri=function(e){var t=/^\d+:/.exec(e.id);if(t&&t[0])return e.id;var n=e.isAgent?/^28:/:/^8:/;return(e.isAgent?"28:":"8:")+e.id.replace(n,"")},e.sortByName=function(e,t){var n=e.vm.person.displayName.localeCompare(t.vm.person.displayName,void 0,r);return 0===n?e.vm.person.id.localeCompare(t.vm.person.id):n},e.getSortedByRelevance=function(t){var n=t.filter(function(e){return e.vm.mutualFriendCount}).sort(function(e,t){return t.vm.mutualFriendCount-e.vm.mutualFriendCount}),i=t.filter(function(e){return!e.vm.mutualFriendCount}).sort(e.sortByName);return n.concat(i)},e.mapContactVMItems=function(e,t){for(var n=0;n<e.length;n++){var i=e[n].person;e[n]&&(t[i.id]=e[n])}},e.handleParticipantsChanges=function(t,n){Object.keys(t).length&&(n.newItems?e.markAddedParticipants(t,n.newItems):n.oldItems&&e.markRemovedParticipants(t,n.oldItems))},e.markAddedParticipants=function(e,t){for(var n=0;n<t.length;n++){var i=e[t[n].person.id];i&&!i.alreadyParticipant&&(i.alreadyParticipant=!0)}},e.markRemovedParticipants=function(e,t){for(var n=0;n<t.length;n++){var i=e[t[n].person.id];i&&i.alreadyParticipant&&(i.alreadyParticipant=!1)}},e.preloadImage=function(e,t,n){if(e.indexOf("data:image/jpeg;base64")>-1)t&&"function"==typeof t&&t(e);else{var i=new Image,r=encodeURI(decodeURI(e));i.onload=function(){t&&"function"==typeof t&&t(r)},i.onerror=function(e){n&&"function"==typeof n&&n()},i.src=r}},e.replaceAvatarPath=function(e){return e.indexOf("data:image/jpeg;base64")>-1?e:e=(e=e.replace("URL@","")).indexOf("/views/avatar_fullsize")<0?e+"/views/avatar_fullsize":e},e.resolveConversationAvatar=function(t,n){return n?t?e.replaceAvatarPath(n):n:""},e}();t.default=o},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.HideChatWindow="bs:hChat",e.OpenChatWindow="bs:oChat",e.ShowChatWindow="bs:sChat",e.CollapseChatWindow="bs:chat:collapse",e.ExpandChatWindow="bs:chat:expand",e.LoadChatData="bs:sChat:run",e.StartActivation="bs:sChat:startActivation",e.StopActivation="bs:sChat:stopActivation",e.UpdateConversation="swc:chat:update",e.MessageSent="lwc:mSent",e.DockIframe="bs:calling:iframe:dock",e.IframeDocked="bs:calling:iframe:docked",e.UndockIframe="bs:calling:iframe:undock",e.IframeUndocked="bs:calling:iframe:undocked",e.IframeDragging="bs:calling:iframe:drag:dragging",e.IframeDragStart="bs:calling:iframe:drag:start",e.IframeDragStop="bs:calling:iframe:drag:stop",e.TriggerAPI="bs:api:trigger",e.OpenRecentsWindow="swc:recents:open",e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(216),r=n(2),o=n(11),s=n(19),a=n(116),c=n(217),l=n(218),u=n(108),d=n(10),p=function(){try{return window.swc.services.i18n}catch(e){}return null},h=function(){function e(){this._initialized=!1,u.default.set(i),l.default.init(r.default.LOCALE)}return e.prototype.init=function(e){var t=this;e||(e=r.default.LOCALE),this.lang=a.default.getLocale(e.toLowerCase()),this._initialized=!0;try{window.swc.services.i18n=this}catch(e){}return this.lang===r.default.LOCALE?Promise.resolve():c.default.load(s.default.getAppPath()+"resources/i18n",this.lang).then(function(){return l.default.init(t.lang),{}},function(){return t.lang=r.default.LOCALE,l.default.init(r.default.LOCALE),{}})},e.prototype.fetch=function(e,t){if(!this._initialized){if(p())return p().fetch(e,t);o.default.throwError(d.ErrorCodes.ERR_I18N_NOT_INITIALIZED,"You need to initialize I18N before using it")}void 0!==t&&void 0!==t.count&&(e+=l.default.getPluralSuffix(t.count));var n=this._getKeyValueText(e);return this._replaceParams(n,t)},e.prototype._replaceParams=function(e,t){for(var n in void 0===t&&(t={}),t)if(t.hasOwnProperty(n)){var i=t[n].toString(),r="{"+n+"}";e=e.replace(r,i)}return e},e.prototype._getKeyValueText=function(e){var t=u.default.get();return t&&t[e]?t[e]:e},e}(),f=p();f||(f=new h),t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(69),r=n(1),o=n(13),s=n(0),a=n(6),c=n(25),l=n(125),u=n(117),d=n(126),p=n(83),h=n(128),f=n(88),g={LARGE:"large",EXTRA_LARGE:"extraLarge"},m=3,v=function(e){var t;return(r.default.instance.PesManager.config?r.default.instance.PesManager.config.items:[]).forEach(function(n){t||n.id!==e||(t=n)}),t},_=function(){function e(e,t){var n=this;this.outgoingDomTransformers=[],this.incomingDomTransformers=[],this.encode=function(e,t,r){var o=new DOMParser,s=i(e),a=l.default.addFormatting(s),c=o.parseFromString(a,"text/html");if(0!==c.getElementsByTagName("parsererror").length)return s;try{return n.outgoingDomTransformers.forEach(function(e){try{e.transformRawToXml(c,c.body,t,r)}catch(e){}}),n.convertHtmlDomToXmlString(c)}catch(e){return s}},this.decode=function(e){var t,i,s,c=n;a.default.get.backend===o.MessagingBackend.TEAMS&&(e=(e=e.replace(/^<div><div>(.*)<\/div>[\s]?<\/div>$/,"$1")).replace(/<span[^>/]+type="(\([a-z]+\))"[^>]+><img[^>]+itemid="(\w+)"[^>]+><\/span>/g,'<ss type="$2">$1</ss>'));try{var l=n._private.parseXML(n._private.encapsulateInRootElement(e));if(l)return i=l.documentElement,r.default.instance.PesManager.canRenderConfigItems()&&function(e){var n=a.default.get.largeEmoticonClass?g.EXTRA_LARGE:g.LARGE,r=i.getElementsByTagName("ss"),o=[],s=r.length<=m&&r.length>0;if(s)for(t=0;t<i.childNodes.length;++t){var l=0===i.childNodes[t].textContent.replace(" ","").length;s=s&&("ss"===i.childNodes[t].tagName||l)}var u,d,p=r.length>20;for(t=0;t<r.length;++t){var h=c.emoticonEncoder.createHtmlElement(e,r[t].getAttribute("type"),r[t].textContent,s,p,n);h&&o.push([h,r[t]])}for(t=0;t<o.length;++t)u=o[t][0],(d=o[t][1]).parentNode&&d.parentNode.replaceChild(u,d)}(l),(s=i.getElementsByTagName("e_m"))&&0!==s.length&&s[0].parentNode.removeChild(s[0]),n.incomingDomTransformers.forEach(function(e){try{e.transformRawToXml(l,i)}catch(e){}}),c.emoticonEncoder.fixInvalidHtml(n._private.decapsulateFromRootElement(n._private.xmlToString(l)))}catch(e){}return e},this.convertHtmlDomToXmlString=function(e){for(var t=e.implementation.createDocument(e.body.namespaceURI,"message",null);0!==e.body.childNodes.length;)t.childNodes[0].appendChild(e.body.childNodes[0]);var i=t.childNodes[0].outerHTML;return a.default.get.backend===o.MessagingBackend.TEAMS&&(i=n._translateToTeamsEmoticons(i,e,t)),i.replace(/(?:^<message.*?>|<\/message>$)/g,"")},this._translateToTeamsEmoticons=function(e,t,n){var i=e.match(/<ss[^>]+>[^<]+<\/ss>/g),o=i.length===n.firstChild.childNodes.length&&i.length<=m&&i.length>0,s=r.default.instance.PesManager.map;for(var a in i){var c=i[a],l=c.match(/<ss type="([^"]+)">([^<]+)<\/ss>/),u=(l[0],l[1]),d=s[l[2]];d.match(/^\(.*\)$/)||(d="("+d+")");var p=v(u),h=t.implementation.createDocument(t.body.namespaceURI,"emoticon",null),f=h.createElement("span"),g=o?50:20;f.setAttribute("class","animated-emoticon-"+g+"-"+u+" animated-emoticon-flat-"+g+"-"+u),f.setAttribute("title",u),f.setAttribute("type",d),f.setAttribute("style","height:"+g+"px; width:"+g+"px; max-height:"+g+"px; max-width:"+g+"px");var _=h.createElement("img");_.setAttribute("alt",p.description),_.setAttribute("itemid",u),_.setAttribute("itemscope",""),_.setAttribute("itemtype","https://schema.skype.com/Emoji"),_.setAttribute("src","https://statics.teams.microsoft.com/evergreen-assets/funstuff/skype-emoticons-f/"+u+"/default_"+g+".png"),_.setAttribute("style","width:"+g+"px; height:"+g+"px"),f.appendChild(_),h.childNodes[0].appendChild(f);var y=h.childNodes[0].outerHTML.replace(/(?:^<emoticon.*?>|<\/emoticon>$)/g,"");e=e.replace(c,y)}return e},this.addLinkElementTarget=function(e,t,n){return e&&e.tagName&&"a"===e.tagName.toLowerCase()&&(e.hasAttribute("target")||e.setAttribute("target","_blank")),e},this._private={separators:{"   ":!0,"\n":!0,"\r":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0,"　":!0},createFlagElement:function(e,t,n){var i=e.createElement("span");return i.textContent=n,i.setAttribute("class","flag "+t),i.textContent="(flag:"+t+")",i},encapsulateInRootElement:function(e){for(var t;t!==e;)t=e,e=e.replace(/<\s*?root[\s\S]*?>.*?(<\s*?\/\s*?root\s*?>)?/gi,"");return"<root>"+e+"</root>"},decapsulateFromRootElement:function(e){return e.match(/<root ?\/>/)?"":e.length==="</root>".length?"":e.substring("<root>".length,e.length-"</root>".length)},parseXML:function(e){var t;try{if(s.swcWindow.DOMParser){var n=new DOMParser;n.async=!1,t=n.parseFromString(e,"text/xml")}else{var i=new ActiveXObject("Microsoft.XMLDOM");if(i.async=!1,i.loadXML(e))return i}}catch(e){return null}var r=t.parseError;return r&&0!==r.errorCode?null:t.getElementsByTagName("parsererror").length>0?null:t},xmlToString:function(e){var t;try{t=(new XMLSerializer).serializeToString(e)}catch(n){t=e.xml}return t},xmlEscapeMap:{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;"},escapeXml:function(e){var t=this.xmlEscapeMap;return e.replace(/[<>&"']/g,function(e){return t[e]})},unescapeXml:function(e){var t={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};return e.replace(/&lt;|&gt;|&amp;|&quot;|&apos/g,function(e){return t[e]})}},this.emoticonEncoder=new u.default,e?e.forEach(function(e){n.incomingDomTransformers.push(e)}):this.incomingDomTransformers=[new h.NewLineDomTransformer,new d.MentionDomDecoder],t?t.forEach(function(e){n.outgoingDomTransformers.push(e)}):this.outgoingDomTransformers=[new f.URLDomTransformer,new h.NewLineDomTransformer,new p.MentionDomEncoder,this.emoticonEncoder],this.dompurifyConfig={ALLOWED_TAGS:["a","b","i","s","br","at","ss","h1","h2","h3","h4","h5","h6","span","div","quote","ul","li","ol","em","strong","br"],ALLOWED_ATTR:["tabindex","title","href","target","id","type"]},c.default.dompurify.addHook("beforeSanitizeAttributes",this.addLinkElementTarget)}return e.prototype.getDomPurify=function(){return window.DOMPurify},e}();t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(129),r=function(){function e(){}return e.parse=function(e,t){return i.setOptions({renderer:this.renderer,gfm:!0,tables:!1,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1,xhtml:!1}),e=e.replace(/<br\s*\/?><br\s*\/?>/g,"\n\n").replace(/<br\s*\/?>/g,"  \n"),(e=i(e).trim()).replace(/^<p>/,"").replace(/<\/p>$/,"")},e.renderer=new i.Renderer,e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(46),r=n(14),o=["rgb(153, 180, 51)","rgb(107, 165, 231)","rgb(231, 115, 189)","rgb(0, 163, 0)","rgb(30, 113, 69)","rgb(255, 0, 151)","rgb(126, 56, 120)","rgb(96, 60, 186)","rgb(29, 29, 29)","rgb(0, 171, 169)","rgb(45, 137, 239)","rgb(43, 87, 151)","rgb(218, 83, 44)","rgb(185, 29, 71)","rgb(238, 17, 17)"],s=function(){function e(){}return e.isDefaultPublicUrl=function(e){return e.indexOf("/profile/avatar")>-1||e.indexOf("/public")>-1},e._replaceDefaultImage=function(t){var n=t.split("?")[0],i=t.split("?")[1],r=e.isDefaultPublicUrl(t);return i?(t=n+"?"+i,t+=r?"&returnDefaultImage=false":""):t+=r?"?returnDefaultImage=false":"",t},e.getBackgroundColor=function(e){for(var t=0,n=e.length-1;n>=0;n--){var i=e.charCodeAt(n),r=n%8;t^=(i<<r)+(i>>8-r)}return o[t%o.length]},e._filterDisplayName=function(e){return r.default.getMessageSanitizedContent(e).replace(/\s+/gi," ").trim()},e.loadAvatarUri=function(t,n,r){t&&(t.indexOf("?auth_key=")<0&&(t=t.indexOf("?returnDefaultImage")<0?e._replaceDefaultImage(t):t.replace("returnDefaultImage=true","returnDefaultImage=false")),i.default.preloadImage(t,n,r))},e.getInitials=function(t){var n="",i=(t=e._filterDisplayName(t)).split(" ");return i.length>1?(n+=i[0][0]?i[0][0]:"",n+=i[1][0]?i[1][0]:""):i.length&&(n+=i[0][0]?i[0][0]:"",n+=i[0][1]?i[0][1]:""),n.toUpperCase()},e}();t.default=s},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(50),r=n(51),o=n(7),s=n(14),a=n(119),c=function(){function e(){}return e._encoder=new i.default,e.INVALID_VALUE="invalidValue",e.urlPrefixBlacklist=["http","file","smb"],e.filterOutNotValidItems=function(t,n){for(var i=e.mapArray(t,n),r=[],o=0;o<i.length;o++){var s=i[o];s.isValid&&!s.isValid()||r.push(s)}return r},e.filterOutDisabledItems=function(t,n){for(var i=e.mapArray(t,n),r=[],o=0;o<i.length;o++){var s=i[o];s.isDisabled&&s.isDisabled()||r.push(s)}return r},e.getItemIfNotDisabled=function(e){return e.isDisabled&&e.isDisabled()?null:e},e.mapArray=function(e,t){var n=[];if(!e)return n;for(var i=0;i<e.length;i++){var r=e[i];r&&n.push(t(r))}return n},e.mapImages=function(e,t,n,i){var r=[];return e.forEach(function(e){e.url&&r.push(new a.default(e,t,n,i))}),r},e.normalizeText=function(e){return e?s.default.getMessageSanitizedContent(e):null},e.normalizeUrl=function(t,n,i){var r,a=t?s.default.getMessageSanitizedContent(t):e.INVALID_VALUE,c=e.urlPrefixBlacklist;if(!n)switch(i){case o.SwiftCardActionType.openUrl:case o.SwiftCardActionType.showImage:a=function(t){try{var n=document.createElement("a");return n.href=t,["https:"].indexOf(n.protocol)>-1?t:e.INVALID_VALUE}catch(t){return e.INVALID_VALUE}}(a),a=function(t){for(var n=0;n<c.length;n++)if(new RegExp("^"+c[n]+":","i").test(t))return e.INVALID_VALUE;return t}(a=(r=a).match(/^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)?r:e.INVALID_VALUE);break;case o.SwiftCardActionType.signin:a=/^https/i.test(a)?a:e.INVALID_VALUE}return a=function(t){return t===e.INVALID_VALUE?e.INVALID_VALUE:t.match(/^[\s\S]*javascript:/gim)?e.INVALID_VALUE:t}(a)},e.normalizeDestination=function(t){return/^(skype|tel):/i.test(t)?s.default.getMessageSanitizedContent(t):e.INVALID_VALUE},e.normalizeRichText=function(t,n){if(!t)return"";t=n?t:e._encoder.decode(e._encoder.encode(t)),t=s.default.unescapeBrackets(t);var i=r.default.parse(t);return s.default.getMessageSanitizedContent(i)},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.getQueryParameters=function(){var e=window.location.search.substring(1);return this.extractQueryParameters(e)},e.extractQuery=function(e){var t="";return e.indexOf("?")>-1&&(t=e.split("?")[1]),t},e.getQueryParameter=function(e,t){var n=this.extractQuery(e);return n?this.extractQueryParameters(n)[t]:null},e.extractQueryParameters=function(e){var t={};return e.split("&").forEach(function(e){var n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])||""}),t},e.extractProtocol=function(e){var t=null;return e.indexOf("://")>-1&&(t=e.split("://")[0]),t},e.extractHostname=function(e){return(e.indexOf("//")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0]},e.extractPath=function(e){var t="";e.indexOf("//")>-1&&(e=e.split("//")[1]);var n=e.indexOf("/");return n>-1&&(t=e.substring(n)),t=t.split("?")[0]},e}();t.default=i},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hashCode=function(e){var t=0,n=e.length,i=0;if(n>0)for(;i<n;)t=(t<<5)-t+e.charCodeAt(i++)|0;return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.setRectStyle=function(e,t){var n=e.style;n.top=t.top+"px",n.left=t.left+"px",n.width=t.width+"px",n.height=t.height+"px"},e.resetRectStyle=function(e){var t=e.style;t.width=t.height=t.top=t.bottom=t.right=t.left=null},e.isInDom=function(e){if(e)for(;e.parentNode;)if((e=e.parentNode)===document.documentElement)return!0;return!1},e.innerSize=function(t){var n=e.style(t);return{width:t.offsetWidth-parseInt(n.paddingLeft)-parseInt(n.paddingRight),height:t.offsetHeight-parseInt(n.paddingTop)-parseInt(n.paddingBottom)}},e.setStyle=function(e,t){e.setAttribute("style",t)},e.style=function(e){return window.getComputedStyle(e)},e.copyStyle=function(t,n,i){for(var r=e.style(n),o=t.style,s=0,a=i;s<a.length;s++){var c=a[s];o[c]=r[c]}},e.isInIframe=function(){try{return window.self!==window.top}catch(e){return!0}},e.transport=function(t,n,i,r,o,s){var a=t.getBoundingClientRect(),c=function(e){return n.appendChild(e)};!s&&c(t),t.style.transition="all 0.5s ease",e.setRectStyle(t,a),setTimeout(function(){return e.setRectStyle(t,i)},0),setTimeout(function(){o(),t.style.transition=null,s&&c(t)},r)},e}();t.default=i},function(e,t,n){(function(t){(function(){!function(e){"use strict";if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],i=function(e){return e&&DataView.prototype.isPrototypeOf(e)},r=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1};u.prototype.append=function(e,t){e=a(e),t=c(t);var n=this.map[e];n||(n=[],this.map[e]=n),n.push(t)},u.prototype.delete=function(e){delete this.map[a(e)]},u.prototype.get=function(e){var t=this.map[a(e)];return t?t[0]:null},u.prototype.getAll=function(e){return this.map[a(e)]||[]},u.prototype.has=function(e){return this.map.hasOwnProperty(a(e))},u.prototype.set=function(e,t){this.map[a(e)]=[c(t)]},u.prototype.forEach=function(e,t){Object.getOwnPropertyNames(this.map).forEach(function(n){this.map[n].forEach(function(i){e.call(t,i,n,this)},this)},this)},u.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),l(e)},u.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),l(e)},u.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),l(e)},t.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);var o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},g.call(m.prototype),g.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:0,statusText:""});return e.type="error",e};var s=[301,302,303,307,308];_.redirect=function(e,t){if(-1===s.indexOf(t))throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})},e.Headers=u,e.Request=m,e.Response=_,e.fetch=function(e,n){return new Promise(function(i,r){var o=new m(e,n),s=new XMLHttpRequest;s.onload=function(){var e,t,n={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new u,e.split("\r\n").forEach(function(e){var n=e.split(":"),i=n.shift().trim();if(i){var r=n.join(":").trim();t.append(i,r)}}),t)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var r="response"in s?s.response:s.responseText;i(new _(r,n))},s.onerror=function(){r(new TypeError("Network request failed"))},s.ontimeout=function(){r(new TypeError("Network request failed"))},s.open(o.method,o.url,!0),"include"===o.credentials&&(s.withCredentials=!0),"responseType"in s&&t.blob&&(s.responseType="blob"),o.headers.forEach(function(e,t){s.setRequestHeader(t,e)}),s.send(void 0===o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}function a(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function l(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(n[Symbol.iterator]=function(){return n}),n}function u(e){this.map={},e instanceof u?e.forEach(function(e,t){this.append(t,e)},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function d(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function h(e){var t=new FileReader,n=p(t);return t.readAsArrayBuffer(e),n}function f(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&i(e))this._bodyArrayBuffer=f(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!r(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=f(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=d(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(h)}),this.text=function(){var e,t,n,i=d(this);if(i)return i;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=p(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),i=0;i<t.length;i++)n[i]=String.fromCharCode(t[i]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(v)}),this.json=function(){return this.text().then(JSON.parse)},this}function m(e,t){var n,i,r=(t=t||{}).body;if("string"==typeof e)this.url=e;else{if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new u(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new u(t.headers)),this.method=(n=t.method||this.method||"GET",i=n.toUpperCase(),o.indexOf(i)>-1?i:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function v(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),i=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(i),decodeURIComponent(r))}}),t}function _(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new u(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this),e.exports=t.fetch}).call(t)}).call(this,n(22))},function(e,t,n){(function(t){var n="Expected a function",i=NaN,r="[object Symbol]",o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt,u="object"==typeof t&&t&&t.Object===Object&&t,d="object"==typeof self&&self&&self.Object===Object&&self,p=u||d||Function("return this")(),h=Object.prototype.toString,f=Math.max,g=Math.min,m=function(){return p.Date.now()};function v(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function _(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&h.call(e)==r}(e))return i;if(v(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=v(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var n=a.test(e);return n||c.test(e)?l(e.slice(2),n?2:8):s.test(e)?i:+e}e.exports=function(e,t,i){var r,o,s,a,c,l,u=0,d=!1,p=!1,h=!0;if("function"!=typeof e)throw new TypeError(n);function y(t){var n=r,i=o;return r=o=void 0,u=t,a=e.apply(i,n)}function b(e){var n=e-l;return void 0===l||n>=t||n<0||p&&e-u>=s}function w(){var e=m();if(b(e))return C(e);c=setTimeout(w,function(e){var n=t-(e-l);return p?g(n,s-(e-u)):n}(e))}function C(e){return c=void 0,h&&r?y(e):(r=o=void 0,a)}function E(){var e=m(),n=b(e);if(r=arguments,o=this,l=e,n){if(void 0===c)return function(e){return u=e,c=setTimeout(w,t),d?y(e):a}(l);if(p)return c=setTimeout(w,t),y(l)}return void 0===c&&(c=setTimeout(w,t)),a}return t=_(t)||0,v(i)&&(d=!!i.leading,s=(p="maxWait"in i)?f(_(i.maxWait)||0,t):s,h="trailing"in i?!!i.trailing:h),E.cancel=function(){void 0!==c&&clearTimeout(c),u=0,r=l=o=c=void 0},E.flush=function(){return void 0===c?a:C(m())},E}}).call(this,n(22))},,function(e,t,n){var i=window;i.ES6Promise=i.ES6Promise||n(90),!i.Promise&&i.ES6Promise&&i.ES6Promise.polyfill()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.alias=function(t,n,i,r){var o=e.pathToArray(n),s=o.pop(),a=e.build(o,i);return a[s]=r?t:a[s]||t},e.build=function(t,n){var i=n||window;return e.pathToArray(t).forEach(function(e){return i=i[e]=i[e]||{}}),i},e.pathToArray=function(e){return e instanceof Array?e:e.split(".")},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SKYPE_TOKEN_KEY="skype|token",t.SKYPE_REGTOKEN_KEY="skype|registrationtoken",function(e){e.SkypeToken="skype|token",e.RegistrationToken="skype|registrationtoken",e.Endpoint="skype|endpoint",e.EndpointOwner="skype|endpointowner"}(t.SessionStorageKeys||(t.SessionStorageKeys={}))},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n(12),a=n(9),c=n(0),l=n(52);!function(e){e.Online="online",e.Busy="busy",e.Away="away"}(t.PresenceStatusUI||(t.PresenceStatusUI={}));var u=function(e){function t(t){var n=e.call(this,t)||this;return n._onClick=function(e){e.stopPropagation(),n.props.onClick&&n.props.onClick()},n.state={bgColor:"transparent",bgImage:"",initials:"",initialsStyle:{},showBlock:!1,presenceStatus:null},n}return r(t,e),t.prototype.componentDidMount=function(){if(this.setState({initials:l.default.getInitials(this.props.title),bgColor:l.default.getBackgroundColor(this.props.title),showBlock:!!this.props.showBlock,initialsStyle:{display:""},presenceStatus:this.props.presenceStatus}),this.props.avatarUrl){var e=this.props.avatarUrl;this._loadAvatar(e)}},t.prototype._loadAvatar=function(e){var t=this;l.default.loadAvatarUri(e,function(){var n=e.indexOf("data:image/jpeg;base64")>-1?"url('"+e+"')":"url("+e+")";t.setState({bgImage:n}),t.setState({bgColor:"transparent",initialsStyle:{display:"none"}})})},t.prototype.componentWillReceiveProps=function(e){if(this.props.title!==e.title&&this.setState({initials:l.default.getInitials(e.title),bgColor:l.default.getBackgroundColor(e.title)}),this.props.showBlock!==e.showBlock&&this.setState({showBlock:!!e.showBlock}),this.props.presenceStatus!==e.presenceStatus&&this.setState({presenceStatus:e.presenceStatus}),this.props.avatarUrl!==e.avatarUrl&&e.avatarUrl){var t=e.avatarUrl;this._loadAvatar(t)}},t.prototype.render=function(){var e={"tab-index":"0","aria-label":"avatar"},t={backgroundColor:this.state.bgColor},n=this.state.bgImage?{display:"flex",backgroundImage:this.state.bgImage}:{display:"none"},i=["avatar"];this.state.presenceStatus&&i.push(this.state.presenceStatus);var r=c.swc.Assets.SVG;return a.createElement("div",o({className:i.join(" ")},e,{style:t,onClick:this._onClick}),a.createElement("div",o({className:"avatar avatarImage"},e,{style:n})),a.createElement("span",{className:"initials",style:this.state.initialsStyle},this.state.initials),this.state.showBlock&&a.createElement("span",{className:"blocked",dangerouslySetInnerHTML:{__html:r.iconBlocked}}))},t}(s.Component);t.BasicAvatar=u},function(e,t,n){var i;!function(r){"use strict";var o="undefined"==typeof window?null:window;void 0===(i=function(){return function e(t){var n=function(t){return e(t)};if(n.version="0.8.3",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var i=t.document,r=i,o=t.DocumentFragment,s=t.HTMLTemplateElement,a=t.NodeFilter,c=t.NamedNodeMap||t.MozNamedAttrMap,l=t.Text,u=t.Comment,d=t.DOMParser;if("function"==typeof s){var p=i.createElement("template");p.content&&p.content.ownerDocument&&(i=p.content.ownerDocument)}var h=i.implementation,f=i.createNodeIterator,g=i.getElementsByTagName,m=i.createDocumentFragment,v=r.importNode,_={};n.isSupported=void 0!==h.createHTMLDocument&&9!==i.documentMode;var y=function(e,t){for(var n=t.length;n--;)"string"==typeof t[n]&&(t[n]=t[n].toLowerCase()),e[t[n]]=!0;return e},b=function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n},w=null,C=y({},["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr","svg","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","switch","symbol","text","textpath","title","tref","tspan","view","vkern","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmuliscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mpspace","msqrt","mystyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","#text"]),E=null,S=y({},["accept","action","align","alt","autocomplete","background","bgcolor","border","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","coords","datetime","default","dir","disabled","download","enctype","face","for","headers","height","hidden","high","href","hreflang","id","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","multiple","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","rows","rowspan","spellcheck","scope","selected","shape","size","span","srclang","start","src","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns","accent-height","accumulate","additivive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mode","min","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","surfacescale","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","u1","u2","unicode","values","viewbox","visibility","vert-adv-y","vert-origin-x","vert-origin-y","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","y","y1","y2","z","zoomandpan","accent","accentunder","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","display","displaystyle","fence","frame","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),T=null,I=null,x=!0,A=!1,P=!1,k=!1,M=/\{\{[\s\S]*|[\s\S]*\}\}/gm,O=/<%[\s\S]*|[\s\S]*%>/gm,L=!1,R=!1,N=!1,D=!1,Q=!0,U=!0,B=y({},["audio","head","math","script","style","svg","video"]),V=y({},["audio","video","img","source"]),F=y({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),j=null,H=i.createElement("form"),W=function(e){n.removed.push({element:e});try{e.parentNode.removeChild(e)}catch(t){e.outerHTML=""}},z=function(e,t){n.removed.push({attribute:t.getAttributeNode(e),from:t}),t.removeAttribute(e)},G=function(e){return f.call(e.ownerDocument||e,e,a.SHOW_ELEMENT|a.SHOW_COMMENT|a.SHOW_TEXT,function(){return a.FILTER_ACCEPT},!1)},K=function(e){var t,i;if(ee("beforeSanitizeElements",e,null),function(e){if(e instanceof l||e instanceof u)return!1;if("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof c)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute)return!0;return!1}(e))return W(e),!0;if(t=e.nodeName.toLowerCase(),ee("uponSanitizeElement",e,{tagName:t}),!w[t]||T[t]){if(U&&!B[t]&&"function"==typeof e.insertAdjacentHTML)try{e.insertAdjacentHTML("AfterEnd",e.innerHTML)}catch(e){}return W(e),!0}return!P||e.firstElementChild||e.content&&e.content.firstElementChild||!/</g.test(e.textContent)||(n.removed.push({element:e.cloneNode()}),e.innerHTML=e.textContent.replace(/</g,"&lt;")),k&&3===e.nodeType&&(i=(i=(i=e.textContent).replace(M," ")).replace(O," "),e.textContent!==i&&(n.removed.push({element:e.cloneNode()}),e.textContent=i)),ee("afterSanitizeElements",e,null),!1},q=/^data-[\-\w.\u00B7-\uFFFF]/,Y=/^(?:(?:(?:f|ht)tps?|mailto|tel|skype):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,$=/^(?:\w+script|data):/i,Z=/[\x00-\x20\xA0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,X=function(e){var r,o,s,a,c,l,u,d;if(ee("beforeSanitizeAttributes",e,null),l=e.attributes){for(u={attrName:"",attrValue:"",keepAttr:!0},d=l.length;d--;)if(r=l[d],o=r.name,s=r.value,a=o.toLowerCase(),u.attrName=a,u.attrValue=s,u.keepAttr=!0,ee("uponSanitizeAttribute",e,u),s=u.attrValue,"name"===a&&"IMG"===e.nodeName&&l.id?(c=l.id,l=Array.prototype.slice.apply(l),z("id",e),z(o,e),l.indexOf(c)>d&&e.setAttribute("id",c.value)):("id"===o&&e.setAttribute(o,""),z(o,e)),u.keepAttr&&(!Q||"id"!==a&&"name"!==a||!(s in t||s in i||s in H))){if(k&&(s=(s=s.replace(M," ")).replace(O," ")),x&&q.test(a));else{if(!E[a]||I[a])continue;if(F[a]);else if(Y.test(s.replace(Z,"")));else if("src"===a&&0===s.indexOf("data:")&&V[e.nodeName.toLowerCase()]);else if(A&&!$.test(s.replace(Z,"")));else if(s)continue}try{e.setAttribute(o,s),n.removed.pop()}catch(e){}}ee("afterSanitizeAttributes",e,null)}},J=function(e){var t,n=G(e);for(ee("beforeSanitizeShadowDOM",e,null);t=n.nextNode();)ee("uponSanitizeShadowNode",t,null),K(t)||(t.content instanceof o&&J(t.content),X(t));ee("afterSanitizeShadowDOM",e,null)},ee=function(e,t,i){_[e]&&_[e].forEach(function(e){e.call(n,t,i,j)})};return n.sanitize=function(e,i){var s,a,c,l,u;if(e||(e=""),"string"!=typeof e){if("function"!=typeof e.toString)throw new TypeError("toString is not a function");e=e.toString()}if(!n.isSupported)return"object"==typeof t.toStaticHTML||"function"==typeof t.toStaticHTML?t.toStaticHTML(e):e;if(function(e){"object"!=typeof e&&(e={}),w="ALLOWED_TAGS"in e?y({},e.ALLOWED_TAGS):C,E="ALLOWED_ATTR"in e?y({},e.ALLOWED_ATTR):S,T="FORBID_TAGS"in e?y({},e.FORBID_TAGS):{},I="FORBID_ATTR"in e?y({},e.FORBID_ATTR):{},x=!1!==e.ALLOW_DATA_ATTR,A=e.ALLOW_UNKNOWN_PROTOCOLS||!1,P=e.SAFE_FOR_JQUERY||!1,k=e.SAFE_FOR_TEMPLATES||!1,L=e.WHOLE_DOCUMENT||!1,R=e.RETURN_DOM||!1,N=e.RETURN_DOM_FRAGMENT||!1,D=e.RETURN_DOM_IMPORT||!1,Q=!1!==e.SANITIZE_DOM,U=!1!==e.KEEP_CONTENT,k&&(x=!1),N&&(R=!0),e.ADD_TAGS&&(w===C&&(w=b(w)),y(w,e.ADD_TAGS)),e.ADD_ATTR&&(E===S&&(E=b(E)),y(E,e.ADD_ATTR)),U&&(w["#text"]=!0),Object&&"freeze"in Object&&Object.freeze(e),j=e}(i),n.removed=[],!R&&!L&&-1===e.indexOf("<"))return e;if(!(s=function(e){var t,n;try{t=(new d).parseFromString(e,"text/html")}catch(e){}return t&&t.documentElement||(t=h.createHTMLDocument(""),(n=t.body).parentNode.removeChild(n.parentNode.firstElementChild),n.outerHTML=e),"function"==typeof t.getElementsByTagName?t.getElementsByTagName(L?"html":"body")[0]:g.call(t,L?"html":"body")[0]}(e)))return R?null:"";for(l=G(s);a=l.nextNode();)3===a.nodeType&&a===c||K(a)||(a.content instanceof o&&J(a.content),X(a),c=a);if(R){if(N)for(u=m.call(s.ownerDocument);s.firstChild;)u.appendChild(s.firstChild);else u=s;return D&&(u=v.call(r,u,!0)),u}return L?s.outerHTML:s.innerHTML},n.addHook=function(e,t){"function"==typeof t&&(_[e]=_[e]||[],_[e].push(t))},n.removeHook=function(e){_[e]&&_[e].pop()},n.removeHooks=function(e){_[e]&&(_[e]=[])},n.removeAllHooks=function(){_={}},n}(o)}.call(t,n,t,e))||(e.exports=i)}()},function(e,t,n){(function(t){var n=1/0,i="[object Symbol]",r=/[&<>"'`]/g,o=RegExp(r.source),s="object"==typeof t&&t&&t.Object===Object&&t,a="object"==typeof self&&self&&self.Object===Object&&self,c=s||a||Function("return this")();var l,u=(l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},function(e){return null==l?void 0:l[e]}),d=Object.prototype.toString,p=c.Symbol,h=p?p.prototype:void 0,f=h?h.toString:void 0;function g(e){if("string"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&d.call(e)==i}(e))return f?f.call(e):"";var t=e+"";return"0"==t&&1/e==-n?"-0":t}e.exports=function(e){var t;return(e=null==(t=e)?"":g(t))&&o.test(e)?e.replace(r,u):e}}).call(this,n(22))},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(18),a=n(17),c=function(e){function t(){var t=e.call(this)||this;return t._isOnline=navigator.onLine,t.subscribeOnlineHandlers(),t}return r(t,e),Object.defineProperty(t.prototype,"isOnline",{get:function(){return this._isOnline},set:function(e){e!==this._isOnline&&(this._isOnline=e,this.publish("isOnline",e),e&&this._onlinePromise&&this._onlinePromise.status===a.PromiseStatus.Pending&&this._onlinePromise.resolve())},enumerable:!0,configurable:!0}),t.prototype.onceOnline=function(){return this.isOnline?Promise.resolve():(this._onlinePromise&&this._onlinePromise.status===a.PromiseStatus.Pending||(this._onlinePromise=new a.CancelablePromise),this._onlinePromise.promise)},t.prototype.subscribeOnlineHandlers=function(){window.addEventListener("online",this.onlineStatusHandler.bind(this)),window.addEventListener("offline",this.onlineStatusHandler.bind(this))},t.prototype.unsubscribeOnlineHandlers=function(){window.removeEventListener("online",this.onlineStatusHandler),window.removeEventListener("offline",this.onlineStatusHandler)},t.prototype.onlineStatusHandler=function(){this.isOnline=navigator.onLine},t}(s.default);t.get=function(){return o||(o=new c),o}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(83),r=n(1),o=n(44),s=n(7),a=n(56),c="https://www.skype.com/",l="width=600, height=620, menubar=no, status=no, titlebar=no, toolbar=no, rel=noopener noreferrer",u=function(){function e(e,t,n){var u=this;switch(this.type=s.SwiftCardActionType.unknown,this.actions={},this.isValid=function(){return!!u.title||!!u.value||!!u.fallbackUri},this.isDisabled=function(){return!1},this.isSupported=function(){return null!==u.type&&u.type!==s.SwiftCardActionType.unknown},this.action=function(){return u.isValid()&&!u.isCalling()?u.actions[s.SwiftCardActionType[u.type]]().then(function(){}).catch(function(){}):Promise.resolve()},this.openUrl=function(){return u.value.match(/^skype:\?payments/)||u.value.match(/^skype:/),window.open(u.value,"_blank").opener=null,Promise.resolve()},this.imBack=function(){Date.now();return u.conversation.sendSwift({title:u.title,value:u.value}).then(function(){Date.now();return Promise.resolve()}).catch(function(){Date.now()})},this.showImage=function(){var e=u.value||"";return u.conversation.sendMessage(e,o.ActionTrigger.SUGGESTED_ACTION),Promise.resolve()},this.postBack=function(){return u.conversation.sendSwift({title:u.title,value:u.value,image:u.image}),Promise.resolve()},this.payment=function(){var e=u.fallbackUri?u.fallbackUri:u.value;if(e){var t=window.open(e,"_blank",l);return t&&window.focus&&t.focus(),t.opener=null,Promise.resolve()}},this.convertToActionType=function(e){if(!e)return null;try{switch(e.toLowerCase()){case"unsupported":return s.SwiftCardActionType.unsupported;case"openurl":return s.SwiftCardActionType.openUrl;case"imback":return s.SwiftCardActionType.imBack;case"signin":return s.SwiftCardActionType.signin;case"call":return s.SwiftCardActionType.call;case"showimage":return s.SwiftCardActionType.showImage;case"payment":case"anypayment":return s.SwiftCardActionType.payment;case"postback":return s.SwiftCardActionType.postBack;default:return s.SwiftCardActionType.unknown}}catch(e){return s.SwiftCardActionType.unknown}},this.type=this.convertToActionType(e.type),this.isCallActionType=this.type===s.SwiftCardActionType.call,this.title=a.default.normalizeText(e.title),this.value=e.value?a.default.normalizeUrl(e.value,t.isDirectLineBackend()):null,this.isCalling=ko.observable(!1),this.senderId=n,this.tooltip=this.title,this.image=e.image?e.image:null,this.fallbackUri=e.fallback&&e.fallback.uri?a.default.normalizeUrl(e.fallback.uri,t.isDirectLineBackend()):null,this.actions[s.SwiftCardActionType[s.SwiftCardActionType.call]]=this.call,this.actions[s.SwiftCardActionType[s.SwiftCardActionType.imBack]]=this.imBack,this.actions[s.SwiftCardActionType[s.SwiftCardActionType.postBack]]=this.postBack,this.actions[s.SwiftCardActionType[s.SwiftCardActionType.openUrl]]=this.openUrl,this.actions[s.SwiftCardActionType[s.SwiftCardActionType.showImage]]=this.showImage,this.actions[s.SwiftCardActionType[s.SwiftCardActionType.signin]]=this.openUrl,this.actions[s.SwiftCardActionType[s.SwiftCardActionType.payment]]=this.payment,this.type){case s.SwiftCardActionType.call:this.value=a.default.normalizeDestination(this.value);break;case s.SwiftCardActionType.imBack:if(t.isGroup()){var d=this.value,p=n.substring(3),h=function(){var e=new i.MentionDomEncoder,n=e.getMentionUserData(p,t);if(n){var r=e.createXmlElement(document,n).outerHTML;u.value=r+" "+d}};t.participants.filter(function(e){return e.person.id.toLowerCase()===p}).forEach(function(e){e.person.subscribe("displayName",h)}),h()}break;case s.SwiftCardActionType.showImage:this.value&&(this.value=a.default.normalizeUrl(e.value,t.isDirectLineBackend())),this.title||(this.title=r.default.instance.i18n.fetch("s_showImageTitle"));break;case s.SwiftCardActionType.payment:this.value&&(this.value.match(/^skype:\?payments/)?this.value=a.default.normalizeDestination(this.value):this.value=a.default.normalizeUrl(e.value,t.isDirectLineBackend()));break;case s.SwiftCardActionType.openUrl:this.value&&(this.value.match(/^skype:/)?this.value=a.default.normalizeDestination(this.value):this.value=a.default.normalizeUrl(e.value,t.isDirectLineBackend(),s.SwiftCardActionType.openUrl),this.tooltip?this.tooltip+="\n\n"+this.value:this.tooltip=this.value);break;case s.SwiftCardActionType.signin:this.value=a.default.normalizeUrl(e.value,t.isDirectLineBackend(),s.SwiftCardActionType.signin),this.title||(this.title=r.default.instance.i18n.fetch("s_signInTitle"));break;case s.SwiftCardActionType.unsupported:this.type=s.SwiftCardActionType.openUrl,this.title||(this.title=r.default.instance.i18n.fetch("s_unsupported_button")),this.value||(this.value=c);break;case s.SwiftCardActionType.postBack:this.title=a.default.normalizeText(this.title),this.value=a.default.normalizeText(this.value),this.tooltip||(this.tooltip=this.title)}this.conversation=t}return e.prototype.call=function(){return Promise.reject("Calling is not supported")},e}();t.default=u},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),s=n(18),a=n(40),c=n(7),l=function(e){function t(t,n){var i=e.call(this)||this;return i.customType=c.CustomMessageType.Custom,i.supportedAnnotations=[],i.type=c.MessageType.UserMessage,i._isDeleted=!1,i._isEdited=!1,i.timestamp=new Date,i.originalTimestamp=i.timestamp,i._payload=n,i._status=c.DeliveryStatus.Pending,i.suggestedActions=new a.ObservableCollection,t&&(i.type=c.MessageType.SystemMessage),i.supportedAnnotations.push(o.default.MESSAGE_PROPERTIES.PER_USER.EMOTIONS),i.emotions=new a.ObservableCollection,i.files=new a.ObservableCollection,i}return r(t,e),Object.defineProperty(t.prototype,"clientMessageId",{get:function(){return this._clientMessageId},set:function(e){this._clientMessageId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"composeTime",{get:function(){return this._composeTime},set:function(e){e!==this._composeTime&&(this._composeTime=e,this.publish("composeTime",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return this._content},set:function(e){e!==this._content&&(this._content=e,this.publish("content",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this._direction},set:function(e){e!==this._direction&&(this._direction=e,this.publish("direction",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(e){e!==this._id&&(this._id=e,this.publish("id",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageContent",{get:function(){return this._imageContent},set:function(e){e!==this._imageContent&&(this._imageContent=e,this.publish("imageContent",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDeleted",{get:function(){return this._isDeleted},set:function(e){e!==this._isDeleted&&(this._isDeleted=e,this.publish("isDeleted",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEdited",{get:function(){return this._isEdited},set:function(e){e!==this._isEdited&&(this._isEdited=e,this.publish("isEdited",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFirst",{get:function(){return this._isFirst},set:function(e){e!==this._isFirst&&(this._isFirst=e,this.publish("isFirst",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isTranslated",{get:function(){return this._isTranslated},set:function(e){e!==this._isTranslated&&(this._isTranslated=e,this.publish("isTranslated",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this._key},set:function(e){e!==this._key&&(this._key=e,this.publish("key",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"originalTimestamp",{get:function(){return this._originalTimestamp},set:function(e){e!==this._originalTimestamp&&(this._originalTimestamp=e,this.publish("originalTimestamp",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"payload",{get:function(){return this._payload},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"processedContent",{get:function(){return this._processedContent},set:function(e){e!==this._processedContent&&(this._processedContent=e,this.publish("processedContent",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rawMessageType",{get:function(){return this._rawMessageType},set:function(e){this._rawMessageType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sender",{get:function(){return this._sender},set:function(e){e!==this._sender&&(this._sender=e,this.publish("sender",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"senderId",{get:function(){return this._senderId},set:function(e){e!==this._senderId&&(this._senderId=e,this.publish("senderId",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skypeEditedId",{get:function(){return this._skypeEditedId},set:function(e){e!==this._skypeEditedId&&(this._skypeEditedId=e,this.publish("skypeEditedId",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this._status},set:function(e){e!==this._status&&(this._status=e,this.publish("status",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timestamp",{get:function(){return this._timestamp},set:function(e){e!==this._timestamp&&(this._timestamp=e,this.publish("timestamp",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"translation",{get:function(){return this._content},set:function(e){e!==this._translation&&(this._translation=e,this.publish("translation",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},set:function(e){e!==this._version&&(this._version=e)},enumerable:!0,configurable:!0}),t}(s.default);t.default=l},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n(12),a=n(9),c=n(113),l=n(67),u=n(132),d=function(e){function t(t){var n=e.call(this,t)||this;return n._onAvatarUpdate=function(e){n.setState({avatarUrl:e})},n._onTopicUpdate=function(e){n.setState({title:e})},n._onBlockedUpdate=function(e){n.setState({showBlock:e})},n._onPresenceUpdate=function(e){var t;switch(e){case c.PresenceStatus.Online:t=l.PresenceStatusUI.Online;break;case c.PresenceStatus.Busy:case c.PresenceStatus.OnThePhone:t=l.PresenceStatusUI.Busy;break;case c.PresenceStatus.Away:case c.PresenceStatus.Idle:case c.PresenceStatus.OutToLunch:case c.PresenceStatus.BeRightBack:t=l.PresenceStatusUI.Away}n.setState({presenceStatus:t})},n.state={title:"",avatarUrl:"",showBlock:!1,presenceStatus:null},n}return r(t,e),t.prototype.componentDidMount=function(){var e=this.props.person;this._onTopicUpdate(e.displayName||e.id),e.subscribe("displayName",this._onTopicUpdate),this.props.isPstn||(this._onBlockedUpdate(e.isBlocked),e.subscribe("isBlocked",this._onBlockedUpdate),this.props.customAvatar?this._onAvatarUpdate(this.props.customAvatar):(this._onAvatarUpdate(e.avatarData),e.subscribe("avatarData",this._onAvatarUpdate)),this.props.showPresence&&(this._onPresenceUpdate(e.presenceStatus),e.subscribe("presenceStatus",this._onPresenceUpdate)))},t.prototype.componentWillUnmount=function(){var e=this.props.person;e.unsubscribe("avatarData",this._onAvatarUpdate),e.unsubscribe("displayName",this._onTopicUpdate),e.unsubscribe("isBlocked",this._onBlockedUpdate),e.unsubscribe("presenceStatus",this._onPresenceUpdate)},t.prototype.render=function(){return this.props.isPstn?a.createElement(u.PstnAvatar,o({},this.state)):a.createElement(l.BasicAvatar,o({},this.state,{onClick:this.props.onClick}))},t}(s.Component);t.PersonAvatar=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.SEARCH="search",e.CONTACTS="contacts",e.RECENT="recent",e.NEWCHAT="new",e.AVATAR="avatar",e.CONVERSATION_ROSTER="conversationRoster",e.ADD_PARTICIPANTS_TEAMS="addParticipantsTeams",e}();t.default=i},function(e,t){var n,i,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var c,l=[],u=!1,d=-1;function p(){u&&c&&(u=!1,c.length?l=c.concat(l):d=-1,l.length&&h())}function h(){if(!u){var e=a(p);u=!0;for(var t=l.length;t;){for(c=l,l=[];++d<t;)c&&c[d].run();d=-1,t=l.length}c=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new f(e,t)),1!==l.length||u||a(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t){"function"!=typeof Object.assign&&(Object.assign=function(e){"use strict";if(null==e)throw new TypeError;e=Object(e);for(var t=1;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.testOrigin=function(t){return e.origin!==t},e.post=function(t,n){try{e.targets[t].target.postMessage(n,"*")}catch(e){}},e.cast=function(t,n,i,r){var o={name:t,origin:e.origin,payload:n};i?Array.isArray(i)?i.forEach(function(t){return e.post(t,o)}):e.post(i,o):Object.keys(e.targets).forEach(function(t){return r!==e.targets[t].origin&&e.post(t,o)})},e.exists=function(t){return!!e.registry[t]},e.copy=function(t){t&&t.registry&&Object.getOwnPropertyNames(t.registry).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t.registry,n);i&&i.writable&&(e.registry[n]=i.value||e.registry[n])})},e.addTarget=function(t,n,i,r){e.targets[t]=e.targets[t]||{target:r,origin:n,targetDomain:i}},e.removeTarget=function(t){delete e.targets[t]},e.connect=function(t){e.origin=t,e.connected||(window.addEventListener("message",e.receiver),e.connected=!0)},e.disconnect=function(){window.removeEventListener("message",e.receiver),e.connected=!1},e.registerEvent=function(t,n){if(t&&n){var i=e.registry;if(i[t]){if(-1!==i[t].indexOf(n))return}else i[t]=[];i[t].push(n)}},e.unregisterEvent=function(t,n){if(t&&n){var i=e.registry;if(i[t]&&i[t].length){var r=i[t].indexOf(n);-1!==r&&i[t].splice(r,1)}}},e.triggerEvent=function(t,n,i,r,o){void 0===i&&(i=!0),e.connected&&i&&e.cast(t,n,r,o);var s=!1,a=e.registry;return a[t]&&a[t].forEach(function(e){try{e(n),s=!0}catch(e){}}),s},e.dispose=function(){for(var t in e.registry)delete e.registry[t];e.disconnect()},e.targets={},e.receiver=function(t){var n=t.data;n&&n.origin&&e.testOrigin(n.origin)&&n.name&&e.triggerEvent(n.name,n.payload,!0,null,n.origin)},e.registry={},e}();t.default=i},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=n(36),a=n(8),c=function(e){function t(t){var n=e.call(this,"kpi_conversation_load",t)||this;return n.status=200,n.cached=!1,n}return r(t,e),t.prototype.getCustomProperties=function(){var t=e.prototype.getCustomProperties.call(this);return t.push(o.TelemetryPropertyValue.Create("status",this.getProperty(this.status))),t.push(o.TelemetryPropertyValue.Create("timeLoad",this.timeToLoad||0)),t.push(o.TelemetryPropertyValue.Create("timeRender",this.timeToRender||0)),t.push(o.TelemetryPropertyValue.Create("messages",this.messagesCount||a.NA)),t.push(o.TelemetryPropertyValue.Create("cached",this.cached)),t},t.isAvailable=!0,t}(s.ConversationDataEvent);t.ConversationLoadEvent=c},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n(12),a=n(9),c=n(1),l=n(20),u=function(e){function t(t){var n=e.call(this,t)||this;return n._id=l.guid.generate(),n.state=o({isAnimated:!1,textOnly:!1},n._getNewState(t)),t.setUpdateCallback&&t.setUpdateCallback(function(e){n.setState(function(){return n._getNewState(e)})}),n}return r(t,e),t.prototype._getNewState=function(e){var t=c.default.instance.PesManager.emoticonMap,n=e.emoticonId||this.props.emoticonId,i=e.textContent||this.props.textContent,r=e.title||this.props.title;if(!n||!t.hasOwnProperty(n))return{textOnly:!0,textContent:i};var o={textOnly:!1,textContent:i,title:r,emoticonId:n};return!0===e.isAnimated?o.isAnimated=!0:!1===e.isAnimated&&(o.isAnimated=!1),o},t.prototype.componentDidMount=function(){var e=this;this.setState(function(t,n){return e._getNewState(n)})},t.prototype.componentWillReceiveProps=function(e){var t=this;this.setState(function(){return t._getNewState(e)})},t.prototype.render=function(){if(this.state.textOnly)return a.createElement("span",null,this.state.textContent);var e=["emoticon"],t={"data-item-id":this.state.emoticonId,"data-is-animated":this.state.isAnimated,textContent:this.state.textContent,title:this.state.title};return this.props.large&&e.push(this.props.largeEmoticonClass),a.createElement("span",{className:e.join(" ")},a.createElement("canvas",o({},t,{id:this._id})))},t}(s.Component);t.SwcEmoticon=u},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=/(\(|\))/g,s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.isElementAllowed=function(e){return"i"!==e.nodeName.toLowerCase()||-1===e.className.toLowerCase().indexOf("mention")},t.prototype.wordRawToXml=function(e,t,n,i){for(var r,o=[],s=/[\.,_:\-;?]$/,a=t.substring(1),c=this.getMentionUserData(a,n,i);!c&&a.match(s);)r=a.charAt(a.length-1),a=a.substring(0,a.length-1),c=this.getMentionUserData(a,n,i);return c&&(o.push(this.createXmlElement(e,c)),r&&o.push(e.createTextNode(r))),o},t.prototype.getMentionUserData=function(e,t,n){var i,r={defaultDisplayName:"",displayName:"",skypeId:"",type:"",isMePerson:!1};if(!e)return null;var s=0===(e=e.toLowerCase()).indexOf("("),a=s?e.substring(1,e.length-1):"",c=t?t.participants:[];if(r.isMePerson=!!n&&(e===n.id.toLowerCase()||s&&n.displayName.replace(o,"").toLowerCase()===a),r.isMePerson)i=n;else{var l=c.filter(function(t){return t.person.id.toLowerCase()===e||s&&t.person.displayName.replace(o,"").toLowerCase()===a});l.length&&(i=l[0].person)}return i?(r.skypeId=i.id,r.type="28",r.displayName=i.displayName,r.defaultDisplayName||(r.defaultDisplayName=r.displayName),r):null},t.prototype.wordMatcher=function(){return/@([a-z0-9\.,\-_:]+|\(.+?\))/gi},t.prototype.createXmlElement=function(e,t){var n=e.createElement("at");return n.setAttribute("id",t.type+":"+t.skypeId),n.innerText=t.defaultDisplayName,n},t}(n(37).WordDomTransformer);t.MentionDomEncoder=s},,,function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(30),s=n(5),a=n(8),c=function(e){function t(){return e.call(this,"runtimeError")||this}return r(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(s.TelemetryPropertyValue.Create("message",this.message)),e.push(s.TelemetryPropertyValue.Create("shortMessage",this.shortMessage)),e.push(s.TelemetryPropertyValue.Create("stack",this.stack)),e.push(s.TelemetryPropertyValue.Create("code",this.code)),e.push(this.getConversationId()),e},t.prototype.getConversationId=function(){return this.conversationId?0===this.conversationId.indexOf("8:")?s.TelemetryPropertyValue.Create("conversationId",this.conversationId,o.PIIType.Identity):s.TelemetryPropertyValue.Create("conversationId",this.conversationId):s.TelemetryPropertyValue.Create("conversationId",a.NA)},t}(a.TelemetryEvent);t.ErrorEvent=c},function(e,t){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1})},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.isElementAllowed=function(e){return"a"!==e.nodeName.toLowerCase()},t.prototype.wordRawToXml=function(e,t){var n,i=t.match(/^(?:https?:\/\/|mailto:)(.+)$/i),r=i&&i[0],o=r;return r||(r=(i=t.match(/^[^@]+@(?:\w+(?:\.\w+)+)$/i))&&"mailto:"+i[0],o=i&&i[0]),r||(i=t.match(/^(?:www(?:\.\w+){1,}\.(?:com|org|net|edu|gov|mil|aero|arpa|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|pro|tel|travel|[a-z]{2,3}))$/i))&&i[0]&&(n=i.input?i.input.split("?")[1]:"",r="https://"+i[0],o=r=n?r+"?"+n:r),r?[this.createXmlElement(e,r,o)]:[]},t.prototype.wordMatcher=function(){return/\S+/g},t.prototype.createXmlElement=function(e,t,n){var i=e.createElement("a");return i.setAttribute("href",t),i.setAttribute("title",t),i.setAttribute("target","_blank"),i.setAttribute("tabindex","-1"),i.innerText=n,i},t}(n(37).WordDomTransformer);t.URLDomTransformer=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="px",r=25,o=function(){var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.overflow="scroll",e.style.position="absolute",e.style.top="-9999px",e.className="swc-scroll-viewport",e.innerHTML="<style>.swc-scroll-viewport::-webkit-scrollbar{width:0;}</style>",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t}();function s(){return"rtl"===document.dir}var a=function(){function e(e,t){var n=this;this.container=e,this.viewport=t,this.recount=function(){n.vh=n.viewport.offsetHeight,n.sh=n.viewport.scrollHeight,n.vw=n.container.offsetWidth;var e=n.viewport.getBoundingClientRect();n.vpOffsetX=e.left,n.vpOffsetY=e.top,n.vh2sh=n.vh/n.sh,n.sh2vh=n.sh/n.vh;var t=Math.round(n.vh*n.vh2sh),o=n.slider.style;if(t<r){var s=n.vh-r+t;n.vh2sh=s/n.sh,o.height=r+i,n.sliderH=r}else o.height=t+i,n.sliderH=t;n.show(),n.updateSlider()},this.update=function(){n.ticking=!1,n.updateSlider()},this.show=function(){n.sh<=n.vh||!n.active?n.hide():n.visible||(n.rail.style.display="",n.visible=!0)},this.hide=function(){n.visible&&(n.rail.style.display="none",n.viewport.classList.remove("active"),n.visible=!1)},this.updateSlider=function(){var e=n.viewport.scrollTop*n.vh2sh;n.currentTop!==e&&(n.currentTop=e,n.slider.style.top=n.currentTop+i)},this.requestTick=function(e){n.ticking||requestAnimationFrame(n.update),n.ticking=!0},this.bindEvents=function(){n.viewport.addEventListener("scroll",n.requestTick,!1),n.container.addEventListener("mousedown",n.onMouseDown),n.container.addEventListener("mousemove",n.onMouseMove),n.container.addEventListener("mouseenter",n.onMouseEnter),n.container.addEventListener("mouseleave",n.onMouseLeave)},this.unbindEvents=function(){n.viewport.removeEventListener("scroll",n.requestTick,!1),n.container.removeEventListener("mousedown",n.onMouseDown),n.container.removeEventListener("mousemove",n.onMouseMove),n.container.removeEventListener("mouseenter",n.onMouseEnter),n.container.removeEventListener("mouseleave",n.onMouseLeave)},this.onMouseMove=function(e){n.dragging?n.viewport.scrollTop=(e.clientY-n.vpOffsetY)*n.sh2vh:(s()?e.clientX-n.vpOffsetX<=10:e.clientX-n.vpOffsetX>n.vw-10)?(n.rail.classList.add("active"),n.hover=!0):n.hover&&(n.rail.classList.remove("active"),n.hover=!1)},this.onMouseEnter=function(){n.active=!0,n.recount()},this.onMouseLeave=function(){n.active=!1,n.dragging||n.hide()},this.onMouseDown=function(e){var t=e.clientX-n.vpOffsetX,i=e.clientY-n.vpOffsetY;if(s()?t<10:t>=n.vw-10){var r=parseInt(n.slider.style.top,10);i>r&&i<r+n.sliderH?n.startDrag(e):n.viewport.scrollTop=i*n.sh2vh,e.preventDefault(),e.stopPropagation()}},this.handleDrag=function(e){n.viewport.scrollTop=(e.clientY-n.dragOffset)*n.sh2vh},this.startDrag=function(e){n.dragging||(n.viewport.classList.add("scrolling"),n.dragOffset=e.pageY-n.slider.offsetTop,n.dragging=!0,n.container.removeEventListener("mousemove",n.onMouseMove),window.addEventListener("mouseup",n.stopDrag),window.addEventListener("mousemove",n.handleDrag)),e.preventDefault()},this.stopDrag=function(){window.removeEventListener("mousemove",n.handleDrag),window.removeEventListener("mouseup",n.stopDrag),n.container.addEventListener("mousemove",n.onMouseMove),n.viewport.classList.remove("scrolling"),n.dragging=!1},this.container.classList.add("swc-scroll-wrapper"),this.viewport.classList.add("swc-scroll-viewport"),o&&this.viewport.classList.add("swc-scroll-hide"),this.build(),this.init()}return e.prototype.init=function(){this.bindEvents()},e.prototype.build=function(){this.slider=document.createElement("div"),this.slider.className="swc-scroll-slider",this.rail=document.createElement("div"),this.rail.className="swc-scroll-rail",this.rail.appendChild(this.slider),this.rail.style.display="none",this.container.appendChild(this.rail)},e}();t.default=a},function(e,t,n){(function(t,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.4+314e4831
 */var i;i=function(){"use strict";function e(e){return"function"==typeof e}var i=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,o=void 0,s=void 0,a=function(e,t){f[r]=e,f[r+1]=t,2===(r+=2)&&(s?s(g):b())};var c="undefined"!=typeof window?window:void 0,l=c||{},u=l.MutationObserver||l.WebKitMutationObserver,d="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),p="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var e=setTimeout;return function(){return e(g,1)}}var f=new Array(1e3);function g(){for(var e=0;e<r;e+=2){(0,f[e])(f[e+1]),f[e]=void 0,f[e+1]=void 0}r=0}var m,v,_,y,b=void 0;function w(e,t){var n=this,i=new this.constructor(S);void 0===i[E]&&B(i);var r=n._state;if(r){var o=arguments[r-1];a(function(){return Q(r,i,o,n._result)})}else N(n,i,e,t);return i}function C(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(S);return M(t,e),t}d?b=function(){return t.nextTick(g)}:u?(v=0,_=new u(g),y=document.createTextNode(""),_.observe(y,{characterData:!0}),b=function(){y.data=v=++v%2}):p?((m=new MessageChannel).port1.onmessage=g,b=function(){return m.port2.postMessage(0)}):b=void 0===c?function(){try{var e=Function("return this")().require("vertx");return void 0!==(o=e.runOnLoop||e.runOnContext)?function(){o(g)}:h()}catch(e){return h()}}():h();var E=Math.random().toString(36).substring(2);function S(){}var T=void 0,I=1,x=2,A={error:null};function P(e){try{return e.then}catch(e){return A.error=e,A}}function k(t,n,i){n.constructor===t.constructor&&i===w&&n.constructor.resolve===C?function(e,t){t._state===I?L(e,t._result):t._state===x?R(e,t._result):N(t,void 0,function(t){return M(e,t)},function(t){return R(e,t)})}(t,n):i===A?(R(t,A.error),A.error=null):void 0===i?L(t,n):e(i)?function(e,t,n){a(function(e){var i=!1,r=function(e,t,n,i){try{e.call(t,n,i)}catch(e){return e}}(n,t,function(n){i||(i=!0,t!==n?M(e,n):L(e,n))},function(t){i||(i=!0,R(e,t))},e._label);!i&&r&&(i=!0,R(e,r))},e)}(t,n,i):L(t,n)}function M(e,t){var n,i;e===t?R(e,new TypeError("You cannot resolve a promise with itself")):(i=typeof(n=t),null===n||"object"!==i&&"function"!==i?L(e,t):k(e,t,P(t)))}function O(e){e._onerror&&e._onerror(e._result),D(e)}function L(e,t){e._state===T&&(e._result=t,e._state=I,0!==e._subscribers.length&&a(D,e))}function R(e,t){e._state===T&&(e._state=x,e._result=t,a(O,e))}function N(e,t,n,i){var r=e._subscribers,o=r.length;e._onerror=null,r[o]=t,r[o+I]=n,r[o+x]=i,0===o&&e._state&&a(D,e)}function D(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var i=void 0,r=void 0,o=e._result,s=0;s<t.length;s+=3)i=t[s],r=t[s+n],i?Q(n,i,r,o):r(o);e._subscribers.length=0}}function Q(t,n,i,r){var o=e(i),s=void 0,a=void 0,c=void 0,l=void 0;if(o){if((s=function(e,t){try{return e(t)}catch(e){return A.error=e,A}}(i,r))===A?(l=!0,a=s.error,s.error=null):c=!0,n===s)return void R(n,new TypeError("A promises callback cannot return that same promise."))}else s=r,c=!0;n._state!==T||(o&&c?M(n,s):l?R(n,a):t===I?L(n,s):t===x&&R(n,s))}var U=0;function B(e){e[E]=U++,e._state=void 0,e._result=void 0,e._subscribers=[]}var V=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(S),this.promise[E]||B(this.promise),i(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?L(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&L(this.promise,this._result))):R(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===T&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,i=n.resolve;if(i===C){var r=P(e);if(r===w&&e._state!==T)this._settledAt(e._state,t,e._result);else if("function"!=typeof r)this._remaining--,this._result[t]=e;else if(n===F){var o=new n(S);k(o,e,r),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(i(e),t)},e.prototype._settledAt=function(e,t,n){var i=this.promise;i._state===T&&(this._remaining--,e===x?R(i,n):this._result[t]=n),0===this._remaining&&L(i,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;N(e,void 0,function(e){return n._settledAt(I,t,e)},function(e){return n._settledAt(x,t,e)})},e}();var F=function(){function e(t){this[E]=U++,this._result=this._state=void 0,this._subscribers=[],S!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){M(e,t)},function(t){R(e,t)})}catch(t){R(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},e}();return F.prototype.then=w,F.all=function(e){return new V(this,e).promise},F.race=function(e){var t=this;return i(e)?new t(function(n,i){for(var r=e.length,o=0;o<r;o++)t.resolve(e[o]).then(n,i)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},F.resolve=C,F.reject=function(e){var t=new this(S);return R(t,e),t},F._setScheduler=function(e){s=e},F._setAsap=function(e){a=e},F._asap=a,F.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var i=null;try{i=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===i&&!t.cast)return}e.Promise=F},F.Promise=F,F},e.exports=i()}).call(this,n(78),n(22))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(28),r=n(19),o=function(){function e(){}return e.addScript=function(t,n,o,s){var a=n?r.default.getAbsoluteUrl(t,"js"):t;if(-1==e.loaded.indexOf(a)){var c=e.progress;if(c[a])return o&&-1==c[a].success.indexOf(o)&&c[a].success.push(o),void(s&&-1==c[a].failure.indexOf(s)&&c[a].failure.push(s));c[a]={success:[],failure:[]},o&&c[a].success.push(o),s&&c[a].failure.push(s);var l=i.default.getDocument(),u=l.createElement("script");u.type="text/javascript",u.src=a,o&&(u.onload=function(){e.progress[a].success.forEach(function(e){try{e()}catch(e){}}),delete e.progress[a],e.loaded.push(a)}),s&&(u.onerror=function(){e.progress[a].failure.forEach(function(e){try{e()}catch(e){}}),delete e.progress[a]}),l.getElementsByTagName("body")[0].appendChild(u)}else o&&o()},e.hasScript=function(e){for(var t=0;t<document.scripts.length;t++){if(document.scripts[t].src===e)return!0}return!1},e.loaded=[],e.progress={},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={allowedProtocols:["https:"]},r=function(){function e(){this.probe=document.createElement("a")}return Object.defineProperty(e,"instance",{get:function(){return e.init()},enumerable:!0,configurable:!0}),e.init=function(){return e._instance||(e._instance=new e)},e.prototype.validate=function(e,t){if(!e)return!1;var n=Object.assign(i,t||{}),r=function(e,t){if(!t)return!0;for(var n,i=0,r=t;i<r.length;i++){if(n=r[i]===e)break}return n};this.probe.href=e;var o=r(this.probe.protocol,n.allowedProtocols)&&r(this.probe.hostname,n.allowedDomains)&&r(this.probe.port,n.allowedPorts);return this.probe.href="",o},e}();t.UrlValidator=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=function(){function e(e){this.fn=e}return e.prototype.fulfill=function(e){this.fn(e)},e}(),o=function(){function e(e,t,n){this.ns=e,this.name=t,this.method=n,this.defer=this.defer.bind(this)}return e.prototype.defer=function(){var e,t,n=new Promise(function(n,i){e=new r(n),t=new r(i)});return s.calls[this.ns][this.name].push({method:this.method,args:arguments,resolve:e,reject:t}),n},e}(),s=function(){function e(){}return e.execute=function(t,n,i,r){if(t&&t[n]&&t[n].deferred){var o=e.calls[t][n];t[n]=i;var s=Object.keys(i);o.forEach(function(e){if(s.indexOf(e.method)>-1){var i=t[n][e.method].apply(r,e.args);i instanceof Promise?i.then(function(t){return e.resolve.fulfill(t)},function(t){return e.reject.fulfill(t)}):e.resolve.fulfill()}}),delete e.calls[t][n]}},e.deferApi=function(t,n,i){t&&!t[n]&&(t[n]={deferred:!0},i.forEach(function(e){t[n][e]=new o(t,n,e).defer}),e.calls[t]=e.calls[t]||{},e.calls[t][n]=[])},e.calls={},e}();t.default=i.swc.deferrer=i.swc.deferrer||s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.unknown=0]="unknown",e[e.card=1]="card",e[e.carousel=2]="carousel",e[e.signin=3]="signin",e[e.receipt=4]="receipt",e[e.multiline=5]="multiline",e[e.adaptive=6]="adaptive"}(t.SwiftCardType||(t.SwiftCardType={})),function(e){e[e.unknown=0]="unknown",e[e.hero=1]="hero",e[e.thumb=2]="thumb",e[e.receipt=3]="receipt",e[e.signin=4]="signin",e[e.video=5]="video",e[e.audio=6]="audio",e[e.animation=7]="animation",e[e.actionImage=8]="actionImage",e[e.flex=9]="flex",e[e.adaptive=10]="adaptive"}(t.SwiftCardContentType||(t.SwiftCardContentType={})),function(e){e[e.unknown=0]="unknown",e[e.unsupported=1]="unsupported",e[e.openUrl=2]="openUrl",e[e.imBack=3]="imBack",e[e.signin=4]="signin",e[e.call=5]="call",e[e.showImage=6]="showImage",e[e.payment=7]="payment",e[e.postBack=8]="postBack"}(t.SwiftCardActionType||(t.SwiftCardActionType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.UserMessage="UserMessage",e.SwiftCard="SwiftCard",e.SystemMessage="SystemMessage",e.Unsupported="Unsupported",e.SkypeLogo="SkypeLogo",e.Welcome="Welcome",e.Translate="Translate",e.LwcImage="LwcImage",e.LwcFile="LwcFile",e.UnreadSplitter="UnreadSplitter"}(t.MessageType||(t.MessageType={})),function(e){e.CallEnd="CallEndMsg",e.MissedCall="MissedCallMsg",e.MissedGroupCall="MissedGroupCallMsg",e.Call="CallMsg",e.Custom="CustomMsg",e.MeLeftGroup="MeLeftGroupConversation"}(t.CustomMessageType||(t.CustomMessageType={})),function(e){e[e.Incoming=0]="Incoming",e[e.Outgoing=1]="Outgoing"}(t.Direction||(t.Direction={})),function(e){e[e.Pending=0]="Pending",e[e.Sent=1]="Sent",e[e.Failed=2]="Failed"}(t.DeliveryStatus||(t.DeliveryStatus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.addMember="addMember",e.changeTopic="changeTopic",e.changePicture="changePicture",e.kickMember="kickMember",e.editMsg="editMsg",e.callP2P="callP2P",e.sendText="sendText",e.sendSms="sendSms",e.sendFileP2P="sendFileP2P",e.sendContacts="sendContacts",e.sendVideoMsg="sendVideoMsg",e.sendMediaMsg="sendMediaMsg",e.changeModerated="changeModerated"}(t.ParticipantCapabilities||(t.ParticipantCapabilities={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Admin="Admin",e.User="User"}(t.ParticipantRole||(t.ParticipantRole={}))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.multilineRegExp=function(e,t){return new RegExp(e.join(""),t)},e.escapeSpecialChars=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},e}();t.default=i},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="icon videoOn">\r\n    <g fill="#000" fill-rule="nonzero">\r\n        <path d="M22 7c-2.8 0-5 2.2-5 5s2.2 5 5 5v-2c-1.7 0-3-1.3-3-3s1.3-3 3-3V7zM3 5h12c.6 0 1 .4 1 1v12c0 .6-.4 1-1 1H3c-.6 0-1-.4-1-1V6c0-.6.4-1 1-1zm11 2H4v10h10V7z"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="icon videoOff">\r\n    <g fill="#FFF" fill-rule="evenodd">\r\n        <path fill-rule="nonzero" d="M22 7c-2.76 0-5 2.24-5 5s2.24 5 5 5v-2c-1.66 0-3-1.34-3-3s1.34-3 3-3V7z"/>\r\n        <path d="M4 16.6l-1.88 1.87c-.08-.14-.12-.3-.12-.48V6c0-.55.45-1 1-1h11c.43 0 .8.27.94.65L13 7.6V7H4v9.6zm2.4.4H13v-6.6l2-2V18c0 .55-.45 1-1 1H4.4l2-2z"/>\r\n        <path fill-rule="nonzero" d="M21.15 2.15l-19 19 .7.7 19-19"/>\r\n    </g>\r\n</svg>\r\n'},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(79);var i=n(11),r=n(10),o=function(){function e(){}return e.prototype.set=function(e){this._throwIfFalsy(e),this._resourcesLocation=e},e.prototype.merge=function(e){this._throwIfFalsy(e),Object.assign(this._resourcesLocation,e)},e.prototype.get=function(){return this._resourcesLocation},e.prototype._throwIfFalsy=function(e){e||i.default.throwError(r.ErrorCodes.ERR_DESTINATION_NOT_REACHABLE,"[i18n / resources] Specified destination for localizations resources is not reachable")},e}();t.default=new o},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Online="Online",e.Busy="Busy",e.Offline="Offline",e.Undefined="Undefined",e.OnThePhone="OnThePhone",e.Away="Away",e.Idle="Idle",e.OutToLunch="OutToLunch",e.BeRightBack="BeRightBack"}(t.PresenceStatus||(t.PresenceStatus={}))},function(e,t){if("function"!=typeof window.CustomEvent){var n=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n};n.prototype=window.Event.prototype,window.CustomEvent=n}},function(e,t){var n,i,r,o,s;(n||(n={})).version="2.9.0",function(e){!function(e){e[e.BT_STOP=0]="BT_STOP",e[e.BT_STOP_BASE=1]="BT_STOP_BASE",e[e.BT_BOOL=2]="BT_BOOL",e[e.BT_UINT8=3]="BT_UINT8",e[e.BT_UINT16=4]="BT_UINT16",e[e.BT_UINT32=5]="BT_UINT32",e[e.BT_UINT64=6]="BT_UINT64",e[e.BT_FLOAT=7]="BT_FLOAT",e[e.BT_DOUBLE=8]="BT_DOUBLE",e[e.BT_STRING=9]="BT_STRING",e[e.BT_STRUCT=10]="BT_STRUCT",e[e.BT_LIST=11]="BT_LIST",e[e.BT_SET=12]="BT_SET",e[e.BT_MAP=13]="BT_MAP",e[e.BT_INT8=14]="BT_INT8",e[e.BT_INT16=15]="BT_INT16",e[e.BT_INT32=16]="BT_INT32",e[e.BT_INT64=17]="BT_INT64",e[e.BT_WSTRING=18]="BT_WSTRING",e[e.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(e.BondDataType||(e.BondDataType={})),function(e){e[e.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",e[e.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",e[e.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",e[e.JSON_PROTOCOL=21322]="JSON_PROTOCOL",e[e.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",e[e.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"}(e.ProtocolType||(e.ProtocolType={}))}((i=r||(r={})).Bond||(i.Bond={})),function(e){!function(e){!function(e){var t=function(){function e(){this._buffer=[]}return e.prototype.Add=function(e){for(var t=0;t<this._buffer.length&&this._buffer[t]!=e;++t);t==this._buffer.length&&this._buffer.push(e)},e.prototype.Count=function(){return this._buffer.length},e.prototype.GetBuffer=function(){return this._buffer},e}();e.Set=t;var n=function(){function e(){this._buffer=[]}return e.prototype.Add=function(e,t){-1==this._getIndex(e)&&this._buffer.push({Key:e,Value:t})},e.prototype.AddOrReplace=function(e,t){var n=this._getIndex(e);n>=0?this._buffer[n]={Key:e,Value:t}:this._buffer.push({Key:e,Value:t})},e.prototype.Remove=function(e){var t=this._getIndex(e);t>=0&&this._buffer.splice(t,1)},e.prototype.Count=function(){return this._buffer.length},e.prototype.GetBuffer=function(){return this._buffer},e.prototype.ContainsKey=function(e){return this._getIndex(e)>=0},e.prototype.Get=function(e){var t=this._getIndex(e);return t>=0?this._buffer[t].Value:null},e.prototype._getIndex=function(e){for(var t=0,n=-1;t<this._buffer.length;++t)if(this._buffer[t].Key==e){n=t;break}return n},e}();e.Map=n}(e.Collections||(e.Collections={}))}(e.Bond||(e.Bond={}))}(r||(r={})),function(e){!function(t){!function(e){var i=function(){function e(){}return e.GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++n)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t},e}();e.Utf8=i;var r=function(){function e(){}return e.GetString=function(e){var t,n,i,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=[],s=e.length%3,a=function(e){return[r.charAt(e>>18&63),r.charAt(e>>12&63),r.charAt(e>>6&63),r.charAt(63&e)].join("")};for(t=0,i=e.length-s;t<i;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],o.push(a(n));switch(s){case 1:n=e[e.length-1],o.push(r.charAt(n>>2)),o.push(r.charAt(n<<4&63)),o.push("==");break;case 2:n=(e[e.length-2]<<8)+e[e.length-1],o.push(r.charAt(n>>10)),o.push(r.charAt(n>>4&63)),o.push(r.charAt(n<<2&63)),o.push("=")}return o.join("")},e}();e.Base64=r;var o=function(){function e(){}return e.GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},e}();e.Varint=o;var s=function(){function e(){}return e.GetBytes=function(e){for(var t=e.low,n=e.high,i=[];n||4294967168&t;)i.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return i.push(127&t),i},e}();e.Varint64=s;var a=function(){function e(){}return e.GetBytes=function(e){if(t.BrowserChecker.IsDataViewSupport()){var i=new DataView(new ArrayBuffer(4));i.setFloat32(0,e,!0);for(var r=[],o=0;o<4;++o)r.push(i.getUint8(o));return r}return n.ConvertNumberToArray(e,!1)},e}();e.Float=a;var c=function(){function e(){}return e.GetBytes=function(e){if(t.BrowserChecker.IsDataViewSupport()){var i=new DataView(new ArrayBuffer(8));i.setFloat64(0,e,!0);for(var r=[],o=0;o<8;++o)r.push(i.getUint8(o));return r}return n.ConvertNumberToArray(e,!0)},e}();e.Double=c;var l=function(){function e(){}return e.EncodeZigzag16=function(e){return(e=t.Number.ToInt16(e))<<1^e>>15},e.EncodeZigzag32=function(e){return(e=t.Number.ToInt32(e))<<1^e>>31},e.EncodeZigzag64=function(e){var n=e.low,i=e.high,r=i<<1|n>>>31,o=n<<1;2147483648&i&&(r=~r,o=~o);var s=new t.UInt64("0");return s.low=o,s.high=r,s},e}();e.Zigzag=l}(t.Encoding||(t.Encoding={})),function(i){var r=function(){function e(){}return e.GetString=function(e){for(var t=[],n=0;n<e.length;++n){var i=e[n];if(i<=191)t.push(String.fromCharCode(i));else if(i<=223){var r=e[++n];t.push(String.fromCharCode((31&i)<<6|63&r))}else if(i<=239){r=e[++n];var o=e[++n];t.push(String.fromCharCode((15&i)<<12|(63&r)<<6|63&o))}else{i=(7&i)<<18|(63&(r=e[++n]))<<12|(63&(o=e[++n]))<<6|63&e[++n],i-=65536,t.push(String.fromCharCode(55296|i>>10&1023)),t.push(String.fromCharCode(56320|1023&i))}}return t.join("")},e}();i.Utf8=r;var o=function(){function e(){}return e.GetBytes=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],i=0;i<e.length;++i){var r=t.indexOf(e.charAt(i++)),o=t.indexOf(e.charAt(i++)),s=t.indexOf(e.charAt(i++)),a=t.indexOf(e.charAt(i));n.push(r<<2|o>>4),s>=0&&(n.push(o<<4&240|s>>2),a>=0&&n.push(s<<6&192|a))}return n},e}();i.Base64=o;var s=function(){function t(){}return t.GetInt64=function(t){var n=new e.Bond.Int64("0"),i=this._Read(t);return n.low=i[0],i.length>1&&(n.high=i[1]),n},t.GetNumber=function(e){return this._Read(e)[0]},t._Read=function(e){for(var t=[],n=0,i=!0,r=0;i;){if(i=0!=(128&(o=e.shift())),o&=127,!(r<28)){n|=o<<r,t.push(n),n=o>>4,r=3;break}n|=o<<r,r+=7}for(;i;){var o;if(i=0!=(128&(o=e.shift())),n|=(o&=127)<<r,(r+=7)>=32)break}return t.push(n),t},t}();i.Varint=s;var a=function(){function e(){}return e.GetNumber=function(e){if(t.BrowserChecker.IsDataViewSupport()){for(var i=new DataView(new ArrayBuffer(4)),r=0;r<4;++r)i.setUint8(r,e[r]);return i.getFloat32(0,!0)}return n.ConvertArrayToNumber(e,!1)},e}();i.Float=a;var c=function(){function e(){}return e.GetNumber=function(e){if(t.BrowserChecker.IsDataViewSupport()){for(var i=new DataView(new ArrayBuffer(8)),r=0;r<8;++r)i.setUint8(r,e[r]);return i.getFloat64(0,!0)}return n.ConvertArrayToNumber(e,!0)},e}();i.Double=c;var l=function(){function t(){}return t.DecodeZigzag16=function(e){return((65535&e)>>>1^-(1&e))<<16>>16},t.DecodeZigzag32=function(e){return e>>>1^-(1&e)},t.DecodeZigzag64=function(t){var n=1&t.high,i=t.high>>>1,r=1&t.low,o=t.low>>>1;o|=n<<31,r&&(o^=4294967295,i^=4294967295);var s=new e.Bond.UInt64("0");return s.low=o,s.high=i,s},t}();i.Zigzag=l}(t.Decoding||(t.Decoding={}));var n=function(){function e(){}return e.ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?52:23,i=(1<<(t?11:8)-1)-1,r=1-i,o=i,s=e<0?1:0;e=Math.abs(e);for(var a=Math.floor(e),c=e-a,l=2*(i+2)+n,u=new Array(l),d=0;d<l;)u[d++]=0;for(d=i+2;d&&a;)u[--d]=a%2,a=Math.floor(a/2);for(d=i+1;d<l-1&&c>0;)(c*=2)>=1?(u[++d]=1,--c):u[++d]=0;for(var p=0;p<l&&!u[p];++p);var h=i+1-p,f=p+n;if(u[f+1]){for(d=f;d>p&&!(u[d]=1-u[d]);--d);d==p&&++h}if(h>o||a)return s?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(h<r)return t?this._doubleZero:this._floatZero;if(t){var g=0;for(d=0;d<20;++d)g=g<<1|u[++p];for(var m=0;d<52;++d)m=m<<1|u[++p];return[255&m,m>>8&255,m>>16&255,m>>>24,255&(g=s<<31|2147483647&(g|=h+i<<20)),g>>8&255,g>>16&255,g>>>24]}var v=0;for(d=0;d<23;++d)v=v<<1|u[++p];return[255&(v=s<<31|2147483647&(v|=h+i<<23)),v>>8&255,v>>16&255,v>>>24]},e.ConvertArrayToNumber=function(e,n){var i=(1<<(n?11:8)-1)-1,r=0!=(128&e[n?7:3]),o=n?(127&e[7])<<4|(240&e[6])>>4:(127&e[3])<<1|(128&e[2])>>7;if(255==o)throw new t.Exception("Not a valid float/double buffer.");var s=1,a=1;if(n){var c=(15&e[6])<<28|(255&e[5])<<20|(255&e[4])<<12,l=e[3]<<24|(255&e[2])<<16|(255&e[1])<<8|255&e[0];if(!o&&!c&&!l)return 0;for(var u=0;u<20;++u)a/=2,c<0&&(s+=a),c<<=1;for(u=0;u<32;++u)a/=2,l<0&&(s+=a),l<<=1}else{var d=(127&e[2])<<25|(255&e[1])<<17|(255&e[0])<<9;if(!o&&!d)return 0;for(u=0;u<23;++u)a/=2,d<0&&(s+=a),d<<=1}return s*=Math.pow(2,o-i),r?0-s:s},e}();n._floatZero=[0,0,0,0],n._doubleZero=[0,0,0,0,0,0,0,0],n._floatInifinity=[0,0,128,127],n._floatNegInifinity=[0,0,128,255],n._doubleInifinity=[0,0,0,0,0,0,240,127],n._doubleNegInifinity=[0,0,0,0,0,0,240,255]}(e.Bond||(e.Bond={}))}(r||(r={})),function(e){!function(e){!function(t){var n=function(){function t(){this._buffer=[]}return t.prototype.WriteByte=function(t){this._buffer.push(e.Number.ToByte(t))},t.prototype.Write=function(e,t,n){for(;n--;)this.WriteByte(e[t++])},t.prototype.GetBuffer=function(){return this._buffer},t}();t.MemoryStream=n}(e.IO||(e.IO={}))}(e.Bond||(e.Bond={}))}(r||(r={})),function(e){!function(e){var t=function(){return function(e,t){this.Type=e,this.Id=t}}();e.FieldTag=t;var n=function(){return function(e,t){this.ElementType=e,this.Size=t}}();e.ContainerTag=n;var i=function(){return function(e,t,n){this.KeyType=e,this.ValueType=t,this.Size=n}}();e.KeyValueContainerTag=i;var r=function(){return function(){}}();e.Bonded=r;var o=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e),this.low<0&&(this.high=-1)}return e.prototype.Equals=function(t){var n=new e(t);return this.low==n.low&&this.high==n.high},e}();e.Int64=o;var s=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e)}return e.prototype.Equals=function(t){var n=new e(t);return this.low==n.low&&this.high==n.high},e}();e.UInt64=s;var a=function(){function e(){}return e.ToByte=function(e){return this.ToUInt8(e)},e.ToInt8=function(e){return 127&e|(128&e)<<24>>24},e.ToInt16=function(e){return 32767&e|(32768&e)<<16>>16},e.ToInt32=function(e){return 2147483647&e|2147483648&e},e.ToUInt8=function(e){return 255&e},e.ToUInt16=function(e){return 65535&e},e.ToUInt32=function(e){return 4294967295&e},e}();e.Number=a;var c=function(){return function(e){this.Message=e}}();e.Exception=c;var l=function(){return function(){}}();e.KeyValuePair=l;var u=function(){function e(){}return e.IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();e.BrowserChecker=u}(e.Bond||(e.Bond={}))}(r||(r={})),function(e){!function(e){var t=function(){function t(e){this._stream=e}return t.prototype.WriteBlob=function(e){this._stream.Write(e,0,e.length)},t.prototype.WriteBool=function(e){this._stream.WriteByte(e?1:0)},t.prototype.WriteContainerBegin=function(e,t){this.WriteUInt8(t),this.WriteUInt32(e)},t.prototype.WriteMapContainerBegin=function(e,t,n){this.WriteUInt8(t),this.WriteUInt8(n),this.WriteUInt32(e)},t.prototype.WriteContainerEnd=function(){},t.prototype.WriteDouble=function(t){var n=e.Encoding.Double.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteFloat=function(t){var n=e.Encoding.Float.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteFieldBegin=function(e,t,n){t<=5?this._stream.WriteByte(e|t<<5):t<=255?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))},t.prototype.WriteFieldEnd=function(){},t.prototype.WriteFieldOmitted=function(e,t,n){},t.prototype.WriteInt16=function(t){t=e.Encoding.Zigzag.EncodeZigzag16(t),this.WriteUInt16(t)},t.prototype.WriteInt32=function(t){t=e.Encoding.Zigzag.EncodeZigzag32(t),this.WriteUInt32(t)},t.prototype.WriteInt64=function(t){this.WriteUInt64(e.Encoding.Zigzag.EncodeZigzag64(t))},t.prototype.WriteInt8=function(t){this._stream.WriteByte(e.Number.ToInt8(t))},t.prototype.WriteString=function(t){if(""==t)this.WriteUInt32(0);else{var n=e.Encoding.Utf8.GetBytes(t);this.WriteUInt32(n.length),this._stream.Write(n,0,n.length)}},t.prototype.WriteStructBegin=function(e,t){},t.prototype.WriteStructEnd=function(t){this.WriteUInt8(t?e.BondDataType.BT_STOP_BASE:e.BondDataType.BT_STOP)},t.prototype.WriteUInt16=function(t){var n=e.Encoding.Varint.GetBytes(e.Number.ToUInt16(t));this._stream.Write(n,0,n.length)},t.prototype.WriteUInt32=function(t){var n=e.Encoding.Varint.GetBytes(e.Number.ToUInt32(t));this._stream.Write(n,0,n.length)},t.prototype.WriteUInt64=function(t){var n=e.Encoding.Varint64.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteUInt8=function(t){this._stream.WriteByte(e.Number.ToUInt8(t))},t.prototype.WriteWString=function(e){this.WriteUInt32(e.length);for(var t=0;t<e.length;++t){var n=e.charCodeAt(t);this._stream.WriteByte(n),this._stream.WriteByte(n>>>8)}},t}();e.CompactBinaryProtocolWriter=t;var n=function(){return function(){}}();e.CompactBinaryProtocolReader=n}(e.Bond||(e.Bond={}))}(r||(r={})),function(e){var t=function(){function t(){}return t.IsSafari=function(){if(null===t._isSafari)if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();e.indexOf("safari")>=0&&e.indexOf("chrome")<0?t._isSafari=!0:t._isSafari=!1}else t._isSafari=!1;return t._isSafari},t.IsReactNative=function(){return null===t._isReactNative&&("undefined"!=typeof navigator&&navigator.product?t._isReactNative="ReactNative"===navigator.product:t._isReactNative=!1),t._isReactNative},t.IsUint8ArrSupported=function(){return!e.Utils.IsSafari()&&"undefined"!=typeof Uint8Array&&!e.Utils.IsReactNative()},t.ajax=function(e,n){var i=t._createConnection();if(e.headers){var r="qsp=true";for(var o in e.headers)r+="&",r+=encodeURIComponent(o),r+="=",r+=encodeURIComponent(e.headers[o]);e.url.indexOf("?")<0?e.url+="?":e.url+="&",e.url+=r}i.open(e.type,e.url,!n),e.complete&&(i.onload=function(){e.complete(i)},i.ontimeout=function(){e.complete(i)},i.onerror=function(){e.complete(i)},i.onabort=function(){e.complete(i)}),i.send(e.data)},t.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},t.IsUsingXDomainRequest=function(){null==t._usingXDomainRequest&&(void 0===(new XMLHttpRequest).withCredentials&&"undefined"!=typeof XDomainRequest?t._usingXDomainRequest=!0:t._usingXDomainRequest=!1);return t._usingXDomainRequest},t._createConnection=function(){var e=new XMLHttpRequest;return t.IsUsingXDomainRequest()?new XDomainRequest:e},t}();t._isSafari=null,t._isReactNative=null,t._usingXDomainRequest=null,e.Utils=t}(o||(o={})),function(e){!function(e){!function(e){!function(t){var n=function(){function e(){}return e.GetGuid=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)};return[e(),e(),"-",e(),"-",e(),"-",e(),"-",e(),e(),e()].join("")},e.GetTimeStamp=function(){var e=(new Date).getTime(),t=new r.Bond.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},e.GetTimeStampWithValue=function(e){var t=new r.Bond.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},e}();t.utils=n,function(e){e[e.NotSet=0]="NotSet",e[e.Event=1]="Event",e[e.PerformanceCounter=2]="PerformanceCounter",e[e.Anomaly=3]="Anomaly",e[e.Prediction=4]="Prediction",e[e.TraceLog=5]="TraceLog",e[e.EventSourceLog=6]="EventSourceLog",e[e.HttpLog=7]="HttpLog",e[e.PerformanceCounterAzure=8]="PerformanceCounterAzure",e[e.PerformanceCounterGfs=9]="PerformanceCounterGfs"}(t.RecordType||(t.RecordType={})),function(e){e[e.NotSet=0]="NotSet",e[e.O365=1]="O365",e[e.SkypeBI=2]="SkypeBI",e[e.SkypeData=3]="SkypeData"}(t.PIIScrubber||(t.PIIScrubber={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.PIIKind||(t.PIIKind={})),function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"}(t.UserIdType||(t.UserIdType={}));var i=function(){function t(){this.ScrubType=e.datamodels.PIIScrubber.NotSet,this.Kind=e.datamodels.PIIKind.NotSet,this.RawContent=""}return t.prototype.Write=function(e){this.WriteImpl(e,!1)},t.prototype.WriteImpl=function(t,n){t.WriteStructBegin(null,n),this.ScrubType!=e.datamodels.PIIScrubber.NotSet?(t.WriteFieldBegin(r.Bond.BondDataType.BT_INT32,1,null),t.WriteInt32(this.ScrubType),t.WriteFieldEnd()):t.WriteFieldOmitted(r.Bond.BondDataType.BT_INT32,1,null),this.Kind!=e.datamodels.PIIKind.NotSet?(t.WriteFieldBegin(r.Bond.BondDataType.BT_INT32,2,null),t.WriteInt32(this.Kind),t.WriteFieldEnd()):t.WriteFieldOmitted(r.Bond.BondDataType.BT_INT32,2,null),""!=this.RawContent?(t.WriteFieldBegin(r.Bond.BondDataType.BT_STRING,3,null),t.WriteString(this.RawContent),t.WriteFieldEnd()):t.WriteFieldOmitted(r.Bond.BondDataType.BT_STRING,3,null),t.WriteStructEnd(n)},t.prototype.Read=function(e){this.ReadImpl(e,!1)},t.prototype.ReadImpl=function(e,t){},t}();t.PII=i;var o=function(){function t(){this.Id=n.GetGuid(),this.Timestamp=n.GetTimeStamp(),this.Type="",this.EventType="",this.Extension=new r.Bond.Collections.Map,this.RecordType=e.datamodels.RecordType.NotSet,this.PIIExtensions=new r.Bond.Collections.Map}return t.prototype.AddOrReplacePII=function(t,n,i){var r=new e.datamodels.PII;r.RawContent=n,r.Kind=i,r.ScrubType=e.datamodels.PIIScrubber.O365,this.PIIExtensions.AddOrReplace(t,r)},t.prototype.Write=function(e){this.WriteImpl(e,!1)},t.prototype.WriteImpl=function(t,n){if(t.WriteStructBegin(null,n),""!=this.Id?(t.WriteFieldBegin(r.Bond.BondDataType.BT_STRING,1,null),t.WriteString(this.Id),t.WriteFieldEnd()):t.WriteFieldOmitted(r.Bond.BondDataType.BT_STRING,1,null),this.Timestamp.Equals("0")?t.WriteFieldOmitted(r.Bond.BondDataType.BT_INT64,3,null):(t.WriteFieldBegin(r.Bond.BondDataType.BT_INT64,3,null),t.WriteInt64(this.Timestamp),t.WriteFieldEnd()),""!=this.Type?(t.WriteFieldBegin(r.Bond.BondDataType.BT_STRING,5,null),t.WriteString(this.Type),t.WriteFieldEnd()):t.WriteFieldOmitted(r.Bond.BondDataType.BT_STRING,5,null),""!=this.EventType?(t.WriteFieldBegin(r.Bond.BondDataType.BT_STRING,6,null),t.WriteString(this.EventType),t.WriteFieldEnd()):t.WriteFieldOmitted(r.Bond.BondDataType.BT_STRING,6,null),this.Extension.Count()){t.WriteFieldBegin(r.Bond.BondDataType.BT_MAP,13,null),t.WriteMapContainerBegin(this.Extension.Count(),r.Bond.BondDataType.BT_STRING,r.Bond.BondDataType.BT_STRING);for(var i=0;i<this.Extension.GetBuffer().length;++i)t.WriteString(this.Extension.GetBuffer()[i].Key),t.WriteString(this.Extension.GetBuffer()[i].Value);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(r.Bond.BondDataType.BT_MAP,13,null);if(this.RecordType!=e.datamodels.RecordType.NotSet?(t.WriteFieldBegin(r.Bond.BondDataType.BT_INT32,24,null),t.WriteInt32(this.RecordType),t.WriteFieldEnd()):t.WriteFieldOmitted(r.Bond.BondDataType.BT_INT32,24,null),this.PIIExtensions.Count()){t.WriteFieldBegin(r.Bond.BondDataType.BT_MAP,30,null),t.WriteMapContainerBegin(this.PIIExtensions.Count(),r.Bond.BondDataType.BT_STRING,r.Bond.BondDataType.BT_STRUCT);for(var o=0;o<this.PIIExtensions.GetBuffer().length;++o)t.WriteString(this.PIIExtensions.GetBuffer()[o].Key),this.PIIExtensions.GetBuffer()[o].Value.WriteImpl(t,!1);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(r.Bond.BondDataType.BT_MAP,30,null);t.WriteStructEnd(n)},t.prototype.Read=function(e){this.ReadImpl(e,!1)},t.prototype.ReadImpl=function(e,t){},t}();t.Record=o;var s=function(){function e(){this.Source="",this.DataPackageId="",this.Timestamp=new r.Bond.Int64("0"),this.Records=[]}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),""!=this.Source?(e.WriteFieldBegin(r.Bond.BondDataType.BT_STRING,2,null),e.WriteString(this.Source),e.WriteFieldEnd()):e.WriteFieldOmitted(r.Bond.BondDataType.BT_STRING,2,null),""!=this.DataPackageId?(e.WriteFieldBegin(r.Bond.BondDataType.BT_STRING,5,null),e.WriteString(this.DataPackageId),e.WriteFieldEnd()):e.WriteFieldOmitted(r.Bond.BondDataType.BT_STRING,5,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(r.Bond.BondDataType.BT_INT64,6,null):(e.WriteFieldBegin(r.Bond.BondDataType.BT_INT64,6,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),this.Records.length){e.WriteFieldBegin(r.Bond.BondDataType.BT_LIST,8,null),e.WriteContainerBegin(this.Records.length,r.Bond.BondDataType.BT_STRUCT);for(var n=0;n<this.Records.length;++n)this.Records[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(r.Bond.BondDataType.BT_LIST,8,null);e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e}();t.DataPackage=s;var a=function(){function e(){this.DataPackages=[],this.RequestRetryCount=0}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),this.DataPackages.length){e.WriteFieldBegin(r.Bond.BondDataType.BT_LIST,1,null),e.WriteContainerBegin(this.DataPackages.length,r.Bond.BondDataType.BT_STRUCT);for(var n=0;n<this.DataPackages.length;++n)this.DataPackages[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(r.Bond.BondDataType.BT_LIST,1,null);0!=this.RequestRetryCount?(e.WriteFieldBegin(r.Bond.BondDataType.BT_INT32,2,null),e.WriteInt32(this.RequestRetryCount),e.WriteFieldEnd()):e.WriteFieldOmitted(r.Bond.BondDataType.BT_INT32,2,null),e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e}();t.ClientToCollectorRequest=a}(e.datamodels||(e.datamodels={}))}(e.telemetry||(e.telemetry={}))}(e.applications||(e.applications={}))}(s||(s={})),function(e){!function(e){!function(e){!function(t){var i,s;!function(e){e[e.SENT=0]="SENT",e[e.SEND_FAILED=1]="SEND_FAILED"}(i=t.CallbackEventType||(t.CallbackEventType={})),function(e){e[e.DATARV_ERROR_OK=0]="DATARV_ERROR_OK",e[e.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT",e[e.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG",e[e.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES",e[e.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS",e[e.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG"}(s=t.DATARV_ERROR||(t.DATARV_ERROR={}));var a=function(){function e(e){this._errorCode=s.DATARV_ERROR_OK,this._errorCode=e}return e.prototype.ErrorCode=function(){return this._errorCode},e.prototype.toString=function(){switch(this._errorCode){case s.DATARV_ERROR_OK:return"DATARV_ERROR_OK";case s.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";case s.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing.";case s.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES";case s.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized.";case s.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null.";default:return"Unknown error"}},e}();t.Exception=a;var c=function(){return function(){}}();t.TelemetryConfig=c;var l=function(){function e(){}return e.CreateTelemetryManager=function(){return new p},e}();t.TelemetryManagerFactory=l;var u,d=function(){function e(){}return e.MaxPackageSizeInBytes=function(){return 3e6},e.TimeIntervalForNextSendInMS=function(){return 1e3},e}();!function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started"}(u||(u={}));var p=function(){function t(){this._MaxPackageSizeInBytes=d.MaxPackageSizeInBytes(),this._listeners=[],this._status=u.Created,this._etag=null,this._testServerResponseHook=null,this._isPaused=!1}return t.prototype.Initialize=function(e){if(this._status!=u.Created)throw new a(s.DATARV_ERROR_INVALID_STATUS);if(!e||!e.collectorUrl)throw new a(s.DATARV_ERROR_INVALID_CONFIG);this._config=e,this._Reset(),this._status=u.Initialized,this._Verbose("Initialize() done")},t.prototype.AddListener=function(e){if(this._status<u.Initialized)throw new a(s.DATARV_ERROR_INVALID_STATUS);this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t);this._listeners.push(e),this._Verbose("AddListener() done, the new length: "+this._listeners.length)},t.prototype.RemoveListener=function(e){if(this._status<u.Initialized)throw new a(s.DATARV_ERROR_INVALID_STATUS);this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return 1==this._listeners.length?this._listeners=[]:t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop(),void this._Verbose(["this listener has been found, index: ",t,"new length: ",this._listeners.length].join(""));this._Verbose("listener isn't been found, new length"+this._listeners.length)},t.prototype.Start=function(){if(this._status<u.Initialized)throw new a(s.DATARV_ERROR_INVALID_STATUS);this._Verbose(["Start(), status:",this._status,"tag:",t._tag].join(" ")),this._status>=u.Started&&this._Verbose("Start() already, ignore"),++t._tag,this._status=u.Started,this._Verbose(["Start() done, status: ",this._status,"tag: ",t._tag].join(""))},t.prototype.Stop=function(){if(this._status<u.Initialized)throw new a(s.DATARV_ERROR_INVALID_STATUS);return this._Verbose("Stop(), status: "+this._status),this._status==u.Initialized?void this._Verbose("Stop() already, ignore"):(this._Reset(),this._status=u.Initialized,void this._Verbose("Stop() done, status: "+this._status))},t.prototype.Pause=function(){this._isPaused=!0,this._CleanTimer()},t.prototype.Resume=function(){this._isPaused=!1,this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1)},t.prototype.Flush=function(e){this._eventsCache.IsEmpty()||this._WorkThread(e,!0)},t.prototype.SendAsync=function(e,n){if(this._status<u.Initialized)throw new a(s.DATARV_ERROR_INVALID_STATUS);if(this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",e,"count:",n.length].join(" ")),this._status<u.Started)return this._Info("SendAsync(), not started, ignore, return false"),!1;if(!e||!n)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new a(s.DATARV_ERROR_INVALID_ARG);for(var i=0;i<n.length;++i)if(!n[i].Id||!t._eventTypeRegex.test(n[i].EventType)||n[i].Timestamp.Equals("0"))throw this._Error(["eventId:",n[i].Id,"eventType:",n[i].EventType,"timestamp high:",n[i].Timestamp.high,"timestamp low:",n[i].Timestamp.low].join("")),new a(s.DATARV_ERROR_INVALID_EVENT);return this._eventsCache.AddEvents(e,n),this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" ")),this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1),this._Verbose("SendAsync() done"),!0},t.prototype._WorkThread=function(e,i){var s=this;try{if(this._Verbose("_WorkThread, status: "+this._status),this._status<u.Started)return void this._Verbose("_WorkThread, status is not started, return");var a=this._eventsCache.DequeuEvents();if(null==a)return this._Verbose("_WorkThread, No events found, return"),void this._CleanTimer();var c=this._PackEvents(a.tenantToken,a.events);if(this._eventsCache.AddEvents(a.tenantToken,c.remainedEvents),null==c.buffer||0==c.buffer.length)return void(this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1)));if(this._testServerResponseHook){var l=this._testServerResponseHook();return void setTimeout(this._SendCallback(p,a.tenantToken,c.sendEvents,l,!1,null),100)}var d={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+n.version},complete:function(t){return s._SendCallback(p,a.tenantToken,c.sendEvents,t,i,e)}};o.Utils.IsUint8ArrSupported()?(this._Verbose("Uint8Array is defined, send with binary format directly."),d.data=new Uint8Array(c.buffer)):(this._Verbose("Uint8Array is undefined, send with base64 encode."),d.data=r.Bond.Encoding.Base64.GetString(c.buffer),d.headers["content-encoding"]="base64"),a.tenantToken&&(d.headers["x-apikey"]=a.tenantToken);var p=t._tag;this._lastActiveTime=(new Date).getTime(),o.Utils.ajax(d,i),this._Verbose("_Workthread, send via jquery, tag: "+p)}catch(e){this._Error("_WorkThread, exception: "+e)}},t.prototype._PackEvents=function(t,n){this._Verbose("_PackageEvents, total Count: "+n.length);var i=new e.datamodels.ClientToCollectorRequest,r=new e.datamodels.DataPackage;r.Source="JS_default_source",r.DataPackageId=e.datamodels.utils.GetGuid(),r.Timestamp=e.datamodels.utils.GetTimeStamp();var o,s=n;for(n=[];r.Records=[],r.Records.push.apply(r.Records,s),i.DataPackages=[],i.DataPackages.push(r),o=this._Serialize(i),this._Verbose(["_PackageEvents, sendEvents.length:",s.length,"buffer.length:",o.length,"MaxPackageSize:",this._MaxPackageSizeInBytes].join("")),!(o.length<this._MaxPackageSizeInBytes);){if(1==s.length){s=[],o=null;break}var a=s.splice(0,Math.floor(s.length/2));this._Verbose("_PackageEvents, too large, package again"),n.push.apply(n,s),s=a}return this._Verbose(["_PakcageEvents done, sendEventsCount:",s.length,"buffer.length:",null==o?0:o.length,"remained events:",n.length].join("")),{buffer:o,sendEvents:s,remainedEvents:n}},t.prototype._Serialize=function(e){var t=new r.Bond.IO.MemoryStream,n=new r.Bond.CompactBinaryProtocolWriter(t);return e.Write(n),t.GetBuffer()},t.prototype._SendCallback=function(e,n,r,o,s,a){if(this._Verbose(["_SendCallback","tag:",e,"current tag:",t._tag,"tenantToken:",n,"events count:",r.length,"jqXHR:",o].join("")),a&&a(o?o.status:0,n,r),!s){var c=o&&void 0!==o.status&&200===o.status;if(this._status<u.Started||e<t._tag)return void this._Verbose("_SendCallback, is not started, or tag is not the same, return");if(!c)if(o&&void 0!==o.status&&501!==o.status&&505!==o.status&&(o.status<300||o.status>=500||408===o.status)||!o||void 0===o.status)return this._Verbose("retry statusCode: "+(o?o.status:0)),this._eventsCache.AddEvents(n,r),void this._ScheduleTimer(!0);for(var l=0;l<this._listeners.length;++l)this._listeners[l](c?i.SENT:i.SEND_FAILED,o?o.status:0,n,r);this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1))}},t.prototype._CleanTimer=function(){this._Verbose("_CleanTimer(), timer: "+this._timer),this._timer&&(clearTimeout(this._timer),this._timer=null)},t.prototype._ScheduleTimer=function(e){var t=this;if(!this._isPaused)if(this._Verbose("_ScheduleTimer: isRetry: "+e),this._CleanTimer(),e){this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor);var n=Math.floor(5*this._rescheduleFactor*(1+Math.random()));this._timer=setTimeout(function(){return t._WorkThread(null,!1)},1e3*n),this._Verbose("_ScheduleTimer, next try (s): "+n),this._rescheduleFactor<<=1,this._rescheduleFactor>64&&(this._rescheduleFactor=1)}else{n=0;var i=(new Date).getTime()-this._lastActiveTime;n=i>d.TimeIntervalForNextSendInMS()?0:d.TimeIntervalForNextSendInMS()-i,this._timer=setTimeout(function(){return t._WorkThread(null,!1)},n),this._Verbose("_ScheduleTimer, next try: "+n),this._rescheduleFactor=1}},t.prototype._Verbose=function(e){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+e)},t.prototype._Info=function(e){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+e)},t.prototype._Error=function(e){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+e)},t.prototype._Reset=function(){this._Verbose("Reset()"),this._CleanTimer(),this._lastActiveTime=0,this._rescheduleFactor=1,this._sendingEvents=[],this._eventsCache=new h},t.prototype.__GetListenerArray=function(){return this._listeners},t.prototype.__GetTotalEventsCount=function(){return this._eventsCache.GetTotalEventsCount()},t.prototype.__IsScheduled=function(){return null!=this._timer},t.prototype.__ChageMaxPackageSizeInKB=function(e){this._MaxPackageSizeInBytes=1024*e},t.prototype.__SetTestServerResponseHook=function(e){this._testServerResponseHook=e},t}();p._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,p._tag=0;var h=function(){function e(){this._events={},this._tokens=[]}return e.prototype.AddEvents=function(e,t){t.length&&(this._events[e]||(this._events[e]=[],this._tokens.push(e)),this._events[e].push.apply(this._events[e],t))},e.prototype.IsEmpty=function(){return 0==this._tokens.length},e.prototype.DequeuEvents=function(){if(0==this._tokens.length)return null;var e=this._tokens.shift(),t=this._events[e];return delete this._events[e],{tenantToken:e,events:t}},e.prototype.GetTotalEventsCount=function(){var e=0;for(var t in this._events)e+=this._events[t].length;return e},e}()}(e._sender||(e._sender={}))}(e.telemetry||(e.telemetry={}))}(e.applications||(e.applications={}))}(s||(s={})),function(e){!function(t){!function(t){var i=t._sender.TelemetryManagerFactory.CreateTelemetryManager(),r=function(){return function(){this.collectorUrl=null,this.enableAutoUserSession=!1,this.browserOverrides=null,this.disableCookies=!1}}();r.COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",r.COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",r.COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",r.COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",r.COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/",t.LogConfiguration=r;var o=function(){return function(){this.onSaveData=null,this.onGetData=null}}();t.LogConfigurationBrowserOverrides=o;var s,a=function(){function e(){this.value=null,this.pii=null}return e._isPii=function(e){return null!==e&&void 0!==e&&e!==t.datamodels.PIIKind.NotSet&&!isNaN(e)&&void 0!==t.datamodels.PIIKind[e]},e}(),c=function(){function e(){this.name=null,this.timestamp=null,this.properties={},this.eventType=null}return e.prototype.setProperty=function(n,i,r){if(!n||!e._propertyNameRegex.test(n))throw new l(s.INVALID_PROPERTY_NAME);this.properties[n]=r?{value:i,pii:r!=t.datamodels.PIIKind.NotSet?r:null}:{value:i,pii:null}},e}();c._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,t.EventProperties=c,function(e){e[e.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",e[e.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",e[e.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME",e[e.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE",e[e.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL",e[e.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID",e[e.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME",e[e.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE",e[e.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET=10]="INVALID_CONFIGURATION_USE_CUSTOM_GET_SET"}(s=t.TelemetryError||(t.TelemetryError={}));var l=function(){function e(e){this.errorCode=null,this.errorCode=e}return e.prototype.ErrorCode=function(){return this.errorCode},e.prototype.toString=function(){switch(this.errorCode){case s.INVALID_TENANT_TOKEN:return"Invalid tenant token";case s.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case s.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$";case s.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case s.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";case s.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case s.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case s.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";case s.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET:return"Invalid configuration provided during initialization. Both onGetConfigData and onSaveConfigData must be provided together.  These are manditory when running in a non-brower enviornment";default:return"Unknown error"}},e}();t.Exception=l;var u=function(){function n(e){this.contextMap={},this.piiKind=t.datamodels.PIIKind.NotSet,this._allowDeviceInfoFields=!1,this._allowDeviceInfoFields=e}return n.prototype.setAppId=function(e){e&&(this.contextMap["AppInfo.Id"]=e)},n.prototype.setAppVersion=function(e){e&&(this.contextMap["AppInfo.Version"]=e)},n.prototype.setAppLanguage=function(e){e&&(this.contextMap["AppInfo.Language"]=e)},n.prototype.setDeviceId=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.Id"]=e,p.checkAndUpdateDeviceId(e))},n.prototype.setDeviceOsName=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsName"]=e)},n.prototype.setDeviceOsVersion=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsVersion"]=e)},n.prototype.setDeviceBrowserName=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserName"]=e)},n.prototype.setDeviceBrowserVersion=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserVersion"]=e)},n.prototype.setUserId=function(t,n,i){if(t&&(this.contextMap["UserInfo.Id"]=t),i)this.contextMap["UserInfo.IdType"]=i;else{var r;switch(n){case e.applications.telemetry.datamodels.PIIKind.SipAddress:r=e.applications.telemetry.datamodels.UserIdType.SipAddress;break;case e.applications.telemetry.datamodels.PIIKind.PhoneNumber:r=e.applications.telemetry.datamodels.UserIdType.PhoneNumber;break;case e.applications.telemetry.datamodels.PIIKind.SmtpAddress:r=e.applications.telemetry.datamodels.UserIdType.EmailAddress;break;default:r=e.applications.telemetry.datamodels.UserIdType.Unknown}this.contextMap["UserInfo.IdType"]=r}if(n)a._isPii(n)&&(this.piiKind=n);else{var o;switch(i){case e.applications.telemetry.datamodels.UserIdType.Skype:o=e.applications.telemetry.datamodels.PIIKind.Identity;break;case e.applications.telemetry.datamodels.UserIdType.EmailAddress:o=e.applications.telemetry.datamodels.PIIKind.SmtpAddress;break;case e.applications.telemetry.datamodels.UserIdType.PhoneNumber:o=e.applications.telemetry.datamodels.PIIKind.PhoneNumber;break;case e.applications.telemetry.datamodels.UserIdType.SipAddress:o=e.applications.telemetry.datamodels.PIIKind.SipAddress;break;default:o=e.applications.telemetry.datamodels.PIIKind.NotSet}a._isPii(o)&&(this.piiKind=o)}},n.prototype.setUserMsaId=function(e){e&&(this.contextMap["UserInfo.MsaId"]=e)},n.prototype.setUserANID=function(e){e&&(this.contextMap["UserInfo.ANID"]=e)},n.prototype.setUserAdvertisingId=function(e){e&&(this.contextMap["UserInfo.AdvertisingId"]=e)},n.prototype.setUserTimeZone=function(e){e&&(this.contextMap["UserInfo.TimeZone"]=e)},n.prototype.setUserLanguage=function(e){e&&(this.contextMap["UserInfo.Language"]=e)},n}();t.SemanticContext=u;var d,p=function(){function e(){}return e.initialize=function(n,i){this._overrides=n,this._disableCookies=i;var r=e._getAppLanguage();r&&e.semanticContext.setAppLanguage(r);var o=e._getUserLanguage();o&&e.semanticContext.setUserLanguage(o);var s=(new Date).getTimezoneOffset(),a=s%60,c=(s-a)/60,l="+";if(c>0&&(l="-"),e.semanticContext.setUserTimeZone(l+(c<10?"0"+c:c.toString())+":"+(a<10?"0"+a:a.toString())),e._getUserAgent()&&(e.semanticContext.setDeviceBrowserName(e._getBrowserName()),e.semanticContext.setDeviceBrowserVersion(e._getBrowserVersion()),e.semanticContext.setDeviceOsName(e._getOsName()),e.semanticContext.setDeviceOsVersion(e._getOsVersion())),this._disableCookies&&!this._overrides)return e._deleteCookie(e.DEVICE_ID_COOKIE),void e._deleteCookie(e.FIRST_LAUNCH_TIME_COOKIE);var u=e._getData(e.DEVICE_ID_COOKIE);u&&""!=u||(u=t.datamodels.utils.GetGuid()),e.semanticContext.setDeviceId(u)},e.checkAndUpdateDeviceId=function(t){var n=e._getData(e.DEVICE_ID_COOKIE),i=e._getData(e.FIRST_LAUNCH_TIME_COOKIE);n!==t&&(i=(new Date).getTime().toString()),e.firstLaunchTime=parseInt(i),e._saveData(e.DEVICE_ID_COOKIE,t),e._saveData(e.FIRST_LAUNCH_TIME_COOKIE,i)},e._saveData=function(t,n){if(this._overrides)this._overrides.onSaveData(t,n);else if("undefined"!=typeof document&&void 0!==document.cookie&&!e._disableCookies){var i=new Date;i.setTime(i.getTime()+31536e6);var r="expires="+i.toUTCString();document.cookie=t+"="+n+"; "+r}},e._getData=function(t){if(this._overrides)return this._overrides.onGetData(t)||"";if("undefined"!=typeof document&&void 0!==document.cookie&&!e._disableCookies)for(var n=t+"=",i=document.cookie.split(";"),r=0;r<i.length;r++){for(var o=i[r],s=0;" "==o.charAt(s);)s++;if(0==(o=o.substring(s)).indexOf(n))return o.substring(n.length,o.length)}return""},e._getUserAgent=function(){return"undefined"!=typeof navigator&&navigator.userAgent||""},e._getAppLanguage=function(){return"undefined"!=typeof document&&document.documentElement?document.documentElement.lang:null},e._getUserLanguage=function(){return"undefined"!=typeof navigator?navigator.userLanguage||navigator.language:null},e._userAgentContainsString=function(t){return e._getUserAgent().indexOf(t)>-1},e._isIe=function(){return e._userAgentContainsString("Trident")},e._isEdge=function(){return e._userAgentContainsString(e.BROWSERS.EDGE)},e._isOpera=function(){return e._userAgentContainsString("OPR/")},e._getBrowserName=function(){return e._isOpera()?e.BROWSERS.UNKNOWN:e._userAgentContainsString(e.BROWSERS.PHANTOMJS)?e.BROWSERS.PHANTOMJS:e._isIe()?e.BROWSERS.MSIE:e._isEdge()?e.BROWSERS.EDGE:e._userAgentContainsString(e.BROWSERS.ELECTRON)?e.BROWSERS.ELECTRON:e._userAgentContainsString(e.BROWSERS.CHROME)?e.BROWSERS.CHROME:e._userAgentContainsString(e.BROWSERS.FIREFOX)?e.BROWSERS.FIREFOX:e._userAgentContainsString(e.BROWSERS.SAFARI)?e.BROWSERS.SAFARI:e._userAgentContainsString(e.BROWSERS.SKYPE_SHELL)?e.BROWSERS.SKYPE_SHELL:e.BROWSERS.UNKNOWN},e._getBrowserVersion=function(){return e._isIe()?function(){var t,n=e._getUserAgent(),i=n.match(new RegExp(e.BROWSERS.MSIE+" "+e.REGEX_VERSION));return i?i[1]:(t=n.match(new RegExp("rv:"+e.REGEX_VERSION)))?t[1]:void 0}():function(t){var n;return t===e.BROWSERS.SAFARI&&(t="Version"),(n=e._getUserAgent().match(new RegExp(t+"/"+e.REGEX_VERSION)))?n[1]:e.UNKNOWN_VERSION}(e._getBrowserName())},e._getOsName=function(){return e._getUserAgent().match(/windows\sphone\s\d+\.\d+/i)?e.OPERATING_SYSTEMS.WINDOWS_PHONE:e._getUserAgent().match(/ arm;/i)?e.OPERATING_SYSTEMS.WINDOWS_RT:e._getUserAgent().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?e.OPERATING_SYSTEMS.IOS:e._getUserAgent().match(/android/i)?e.OPERATING_SYSTEMS.ANDROID:e._getUserAgent().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i)?e.OPERATING_SYSTEMS.LINUX:e._getUserAgent().match(/(macintosh|mac os x)/i)?e.OPERATING_SYSTEMS.MACOSX:e._getUserAgent().match(/(windows|win32)/i)?e.OPERATING_SYSTEMS.WINDOWS:e.OPERATING_SYSTEMS.UNKNOWN},e._getOsVersion=function(){return e._getOsName()===e.OPERATING_SYSTEMS.WINDOWS?function(){var t=e._getUserAgent().match(new RegExp("Windows NT "+e.REGEX_VERSION));return t&&e.VERSION_MAPPINGS[t[1]]?e.VERSION_MAPPINGS[t[1]]:e.UNKNOWN_VERSION}():e._getOsName()===e.OPERATING_SYSTEMS.MACOSX?function(){var t=e._getUserAgent().match(new RegExp(e.OPERATING_SYSTEMS.MACOSX+" "+e.REGEX_VERSION_MAC));if(t){var n=t[1].replace(/_/g,".");if(n){var i=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null}(n);return i?n.split(i)[0]:n}}return e.UNKNOWN_VERSION}():e.UNKNOWN_VERSION},e}();p.semanticContext=new u(!0),p.firstLaunchTime=-1,p.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},p.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},p.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},p.REGEX_VERSION="([\\d,.]+)",p.REGEX_VERSION_MAC="([\\d,_,.]+)",p.UNKNOWN_VERSION="Unknown",p.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId",p.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime",p._deleteCookie=function(e){"undefined"!=typeof document&&void 0!==document.cookie&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},p._disableCookies=!1,function(e){e[e.STARTED=0]="STARTED",e[e.ENDED=1]="ENDED"}(d=t.SessionState||(t.SessionState={}));var h=function(){function e(){}return e.initialize=function(t,n){if(!e._initialized){if(!t)throw new l(s.INVALID_TENANT_TOKEN);if(e._defaultToken=t,e._tmConfig.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/",e._configuration=n,!("undefined"!=typeof window||n&&n.browserOverrides&&n.browserOverrides.onGetData))throw new l(s.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET);var r=null;if(n)if(n.collectorUrl&&(e._tmConfig.collectorUrl=n.collectorUrl),n.browserOverrides){if(r=new o,n.browserOverrides.onGetData?!n.browserOverrides.onSaveData:n.browserOverrides.onSaveData)throw new l(s.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET);r.onGetData=n.browserOverrides.onGetData,r.onSaveData=n.browserOverrides.onSaveData}else n.disableCookies&&(e._sessionEnabled=!1);i.Initialize(e._tmConfig),i.Start(),p.initialize(r,n.disableCookies),e._initialized=!0,"undefined"!=typeof window&&window.addEventListener&&(n&&n.enableAutoUserSession&&(e._logger=new f,e._logger.logSession(d.STARTED)),window.addEventListener("beforeunload",e._teardown))}},e.pauseTransmission=function(){i.Pause()},e.resumeTransmission=function(){i.Resume()},e.flush=function(e){i.Flush(e)},e.addCallbackListener=function(t){e._initialized&&i.AddListener(t)},e.setContext=function(t,n,i){e._contextProperties.setProperty(t,n,i)},e.isInitialized=function(){return e._initialized},e.getDefaultToken=function(){return e._defaultToken},e.getSemanticContext=function(){return e._semanticContext},e._getInitIdForToken=function(n){return e._initIdMap[n]||(e._initIdMap[n]=t.datamodels.utils.GetGuid()),e._initIdMap[n]},e._getSequenceForToken=function(t){return e._sequenceMap[t]||(e._sequenceMap[t]=0),e._sequenceMap[t]++,e._sequenceMap[t]},e._teardown=function(){e._logger&&e._logger.logSession(d.ENDED),e.flush()},e.__backToUninitialized=function(){e._tmConfig=new t._sender.TelemetryConfig,e._semanticContext=new u(!0),e._contextProperties=new c,e._configuration=null,i=t._sender.TelemetryManagerFactory.CreateTelemetryManager(),e._initialized=!1,e._initIdMap={},e._sequenceMap={}},e}();h._initialized=!1,h._defaultToken=null,h._tmConfig=new t._sender.TelemetryConfig,h._logger=null,h._initIdMap={},h._sequenceMap={},h._configuration=null,h._contextProperties=new c,h._semanticContext=new u(!0),h._sessionEnabled=!0,t.LogManager=h;var f=function(){function e(e){this._initId=null,this._tenantToken=null,this._contextProperties=new c,this._semanticContext=new u(!1),this._sessionStartTime=0,this._sessionId=null,this._tenantToken=e||h.getDefaultToken(),this._initId=h._getInitIdForToken(this._tenantToken)}return e.prototype.logEvent=function(e){if(!e.name)throw new l(s.MISSING_EVENT_PROPERTIES_NAME);var t=this._createEventRecord(e.name,e.eventType);this._addPropertiesAndSendEvent(t,e)},e.prototype.logFailure=function(e,t,n,i,r){if(!e)throw new l(s.MISSING_FAILURE_SIGNATURE);if(!t)throw new l(s.MISSING_FAILURE_DETAIL);var o=this._createEventRecord("failure","failure");o.Extension.Add("Failure.Signature",e),o.Extension.Add("Failure.Detail",t),n&&o.Extension.Add("Failure.Category",n),i&&o.Extension.Add("Failure.Id",i),this._addPropertiesAndSendEvent(o,r)},e.prototype.logPageView=function(e,t,n,i,r,o){if(!e)throw new l(s.MISSING_PAGEVIEW_ID);if(!t)throw new l(s.MISSING_PAGEVIEW_NAME);var a=this._createEventRecord("pageview","pageview");a.Extension.Add("PageView.Id",e),a.Extension.Add("PageView.Name",t),n&&a.Extension.Add("PageView.Category",n),i&&a.Extension.Add("PageView.Uri",i),r&&a.Extension.Add("PageView.ReferrerUri",r),this._addPropertiesAndSendEvent(a,o)},e.prototype.logSession=function(e,n){if(h._sessionEnabled){if(e!==d.STARTED&&e!==d.ENDED)throw new l(s.INVALID_SESSION_STATE);var i=this._createEventRecord("session","session");if(e===d.STARTED){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=t.datamodels.utils.GetGuid(),i.Extension.Add("Session.Id",this._sessionId),i.Extension.Add("Session.State","Started")}else if(e===d.ENDED){if(0==this._sessionStartTime)return;var r=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);i.Extension.Add("Session.Duration",r.toString()),i.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(r)),i.Extension.Add("Session.Id",this._sessionId),i.Extension.Add("Session.State","Ended"),this._sessionId=null,this._sessionStartTime=0}i.Extension.Add("Session.FirstLaunchTime",this._getISOString(new Date(p.firstLaunchTime))),this._addPropertiesAndSendEvent(i,n)}},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.setContext=function(e,t,n){this._contextProperties.setProperty(e,t,n)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},e.prototype._createEventRecord=function(e,i){var r=new t.datamodels.Record;i||(i="custom"),r.EventType=e.toLowerCase(),r.Type=i.toLowerCase(),r.Extension.Add("EventInfo.Source","JS_default_source"),r.Extension.Add("EventInfo.InitId",this._initId),r.Extension.Add("EventInfo.Sequence",h._getSequenceForToken(this._tenantToken).toString()),r.Extension.Add("EventInfo.Name",e.toLowerCase());var o=new Date;return r.Timestamp=t.datamodels.utils.GetTimeStampWithValue(o.getTime()),r.Extension.Add("EventInfo.Time",this._getISOString(o)),r.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+n.version),r},e.prototype._getISOString=function(e){function t(e){return e<10?"0"+e:e.toString()}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+function(e){return e<10?"00"+e:e<100?"0"+e:e.toString()}(e.getUTCMilliseconds())+"Z"},e.prototype._addCustomPropertiesToEvent=function(e,t){this._addSemanticContext(e,p.semanticContext),this._addSemanticContext(e,h._semanticContext),this._addSemanticContext(e,this._semanticContext),this._sessionId&&e.Extension.Add("Session.Id",this._sessionId),this._addEventPropertiesToEvent(e,h._contextProperties),this._addEventPropertiesToEvent(e,this._contextProperties),this._addEventPropertiesToEvent(e,t)},e.prototype._addSemanticContext=function(e,n){if(n&&n.contextMap){var i=n.contextMap;for(var r in n.contextMap)"UserInfo.Id"==r&&n.piiKind!=t.datamodels.PIIKind.NotSet?e.AddOrReplacePII(r,i[r],n.piiKind):e.Extension.AddOrReplace(r,i[r])}},e.prototype._addEventPropertiesToEvent=function(e,n){if(n){n.timestamp&&n.timestamp>=new Date("1/1/2000").getTime()&&(e.Timestamp=t.datamodels.utils.GetTimeStampWithValue(n.timestamp),e.Extension.AddOrReplace("EventInfo.Time",this._getISOString(new Date(n.timestamp)))),n.name&&(e.EventType=n.name.toLowerCase(),e.Extension.AddOrReplace("EventInfo.Name",n.name.toLowerCase()));var i=n.properties;if(i)for(var r in i)r&&(i[r].value||!1===i[r].value||0==i[r].value||""==i[r].value)&&(a._isPii(i[r].pii)?(e.AddOrReplacePII(r,i[r].value.toString(),i[r].pii),e.Extension.Remove(r)):(e.Extension.AddOrReplace(r,i[r].value.toString()),e.PIIExtensions.Remove(r)))}},e.prototype._addPropertiesAndSendEvent=function(e,t){this._addCustomPropertiesToEvent(e,t),h.isInitialized()&&(this._sanitizeName(e),i.SendAsync(this._tenantToken,[e]))},e.prototype._sanitizeName=function(e){var t=e.EventType.replace(/\./g,"_");e.EventType=t,e.Extension.AddOrReplace("EventInfo.Name",t)},e}();t.Logger=f}(t.telemetry||(t.telemetry={}))}(e.applications||(e.applications={}))}(s||(s={})),void 0!==e&&(e.exports=s.applications.telemetry)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=[{language:"ar",defaultLocale:"ar-sa"},{language:"bg",defaultLocale:"bg-bg"},{language:"ca",defaultLocale:"ca-es"},{language:"cs",defaultLocale:"cs-cz"},{language:"da",defaultLocale:"da-dk"},{language:"de",defaultLocale:"de-de"},{language:"el",defaultLocale:"el-gr"},{language:"en-ca",defaultLocale:"en-gb"},{language:"en-au",defaultLocale:"en-gb"},{language:"en-in",defaultLocale:"en-gb"},{language:"en-hk",defaultLocale:"en-gb"},{language:"en-ie",defaultLocale:"en-gb"},{language:"en-pk",defaultLocale:"en-gb"},{language:"en-sg",defaultLocale:"en-gb"},{language:"en-gb",defaultLocale:"en-gb"},{language:"en",defaultLocale:"en-us"},{language:"es-ar",defaultLocale:"es-mx"},{language:"es-uy",defaultLocale:"es-mx"},{language:"es-py",defaultLocale:"es-mx"},{language:"es-co",defaultLocale:"es-mx"},{language:"es-cl",defaultLocale:"es-mx"},{language:"es-pe",defaultLocale:"es-mx"},{language:"es-ec",defaultLocale:"es-mx"},{language:"es-ve",defaultLocale:"es-mx"},{language:"es-cr",defaultLocale:"es-mx"},{language:"es-do",defaultLocale:"es-mx"},{language:"es-pa",defaultLocale:"es-mx"},{language:"es-gt",defaultLocale:"es-mx"},{language:"es-bo",defaultLocale:"es-mx"},{language:"es-ev",defaultLocale:"es-mx"},{language:"es-hn",defaultLocale:"es-mx"},{language:"es-ni",defaultLocale:"es-mx"},{language:"es-pu",defaultLocale:"es-mx"},{language:"es-br",defaultLocale:"es-mx"},{language:"es-419",defaultLocale:"es-mx"},{language:"es-us",defaultLocale:"es-us"},{language:"gl",defaultLocale:"es-es"},{language:"eu",defaultLocale:"es-es"},{language:"es",defaultLocale:"es-es"},{language:"et",defaultLocale:"et-ee"},{language:"fi",defaultLocale:"fi-fi"},{language:"fr",defaultLocale:"fr-fr"},{language:"iw",defaultLocale:"he-il"},{language:"he",defaultLocale:"he-il"},{language:"hi",defaultLocale:"hi-in"},{language:"hr",defaultLocale:"hr-hr"},{language:"hu",defaultLocale:"hu-hu"},{language:"in",defaultLocale:"id-id"},{language:"id",defaultLocale:"id-id"},{language:"it",defaultLocale:"it-it"},{language:"ja",defaultLocale:"ja-jp"},{language:"ko",defaultLocale:"ko-kr"},{language:"lt",defaultLocale:"lt-lt"},{language:"lv",defaultLocale:"lv-lv"},{language:"ms",defaultLocale:"ms-my"},{language:"no",defaultLocale:"nb-no"},{language:"nb",defaultLocale:"nb-no"},{language:"nn",defaultLocale:"nb-no"},{language:"nl",defaultLocale:"nl-nl"},{language:"pl",defaultLocale:"pl-pl"},{language:"pt-pt",defaultLocale:"pt-pt"},{language:"pt-br",defaultLocale:"pt-br"},{language:"pt",defaultLocale:"pt-br"},{language:"ro",defaultLocale:"ro-ro"},{language:"ru",defaultLocale:"ru-ru"},{language:"sk",defaultLocale:"sk-sk"},{language:"sl",defaultLocale:"sl-si"},{language:"sr",defaultLocale:"sr-latn-rs"},{language:"sr-latn",defaultLocale:"sr-latn-rs"},{language:"sv",defaultLocale:"sv-se"},{language:"th",defaultLocale:"th-th"},{language:"tr",defaultLocale:"tr-tr"},{language:"uk",defaultLocale:"uk-ua"},{language:"vi",defaultLocale:"vi-vn"},{language:"zh",defaultLocale:"zh-cn"},{language:"zh-tw",defaultLocale:"zh-tw"},{language:"zh-hant",defaultLocale:"zh-tw"},{language:"zh-cht",defaultLocale:"zh-tw"},{language:"zh-hk",defaultLocale:"zh-tw"},{language:"zh-mo",defaultLocale:"zh-tw"}],r=[{locale:"am-et",pesLocale:"am"},{locale:"ar-sa",pesLocale:"ar"},{locale:"az-latn-az",pesLocale:"az"},{locale:"be-by",pesLocale:"be-BY"},{locale:"bg-bg",pesLocale:"bg"},{locale:"bn-bd",pesLocale:"bn"},{locale:"bn-in",pesLocale:"bn"},{locale:"bs-latn-ba",pesLocale:"bs-Latn-BA"},{locale:"ca-es",pesLocale:"ca"},{locale:"ca-es-valencia",pesLocale:"ca"},{locale:"cs-cz",pesLocale:"cs"},{locale:"cy-gb",pesLocale:"cy-GB"},{locale:"da-dk",pesLocale:"da"},{locale:"de-de",pesLocale:"de"},{locale:"el-gr",pesLocale:"el"},{locale:"en-gb",pesLocale:"en"},{locale:"en-us",pesLocale:"en"},{locale:"es-es",pesLocale:"es"},{locale:"et-ee",pesLocale:"et"},{locale:"eu-es",pesLocale:"eu"},{locale:"fa-ir",pesLocale:"fa"},{locale:"fi-fl",pesLocale:"fi"},{locale:"fil-ph",pesLocale:"fil_PH"},{locale:"fr-fr",pesLocale:"fr"},{locale:"gd-gb",pesLocale:"gd-GB"},{locale:"gl-es",pesLocale:"gl"},{locale:"gu-in",pesLocale:"gu-IN"},{locale:"he-il",pesLocale:"he"},{locale:"hi-in",pesLocale:"hi"},{locale:"hr-hr",pesLocale:"hr"},{locale:"hu-hu",pesLocale:"hu"},{locale:"id-id",pesLocale:"id"},{locale:"is-is",pesLocale:"is"},{locale:"it-it",pesLocale:"it"},{locale:"ja-jp",pesLocale:"ja"},{locale:"ka-ge",pesLocale:"ka-GE"},{locale:"kk-kz",pesLocale:"kk"},{locale:"kn-in",pesLocale:"kn"},{locale:"ko-kr",pesLocale:"ko"},{locale:"ku-arab-iq",pesLocale:"ku-Arab-IQ"},{locale:"lb-lu",pesLocale:"lb-LU"},{locale:"lt-lt",pesLocale:"lt"},{locale:"lv-lv",pesLocale:"lv"},{locale:"mk-mk",pesLocale:"mk"},{locale:"ml-in",pesLocale:"ml"},{locale:"mr-in",pesLocale:"mr-IN"},{locale:"ms-my",pesLocale:"ms"},{locale:"nb-no",pesLocale:"no"},{locale:"nl-nl",pesLocale:"nl"},{locale:"nn-no",pesLocale:"no"},{locale:"or-in",pesLocale:"or-IN"},{locale:"pl-pl",pesLocale:"pl"},{locale:"pt-pt",pesLocale:"pt-PT"},{locale:"pt-br",pesLocale:"pt-BR"},{locale:"ro-ro",pesLocale:"ro"},{locale:"ru-ru",pesLocale:"ru"},{locale:"sk-sk",pesLocale:"sk"},{locale:"sl-sl",pesLocale:"sl"},{locale:"sq-al",pesLocale:"sq"},{locale:"sr-cyrl-ba",pesLocale:"sr"},{locale:"sr-cyrl-rs",pesLocale:"sr"},{locale:"sr-latn-rs",pesLocale:"sr"},{locale:"sv-se",pesLocale:"sv"},{locale:"sw-ke",pesLocale:"sw"},{locale:"ta-in",pesLocale:"ta"},{locale:"te-in",pesLocale:"te"},{locale:"th-th",pesLocale:"th"},{locale:"tr-tr",pesLocale:"tr"},{locale:"uk-ua",pesLocale:"uk"},{locale:"ur-pk",pesLocale:"ur-PK"},{locale:"uz-latn-uz",pesLocale:"uz"},{locale:"vi-vn",pesLocale:"vi"},{locale:"zh-cn",pesLocale:"zh_Hans"},{locale:"zh-tw",pesLocale:"zh_Hant"}],o=function(){function e(){}return e.prototype.getLocale=function(e){var t=this.getMappingByLanguage(e);if(t)return t.defaultLocale;var n=e.lastIndexOf("-");return n>-1?this.getLocale(e.substring(0,n)):e},e.prototype.getPesLocale=function(e){var t,n;return e?(t=this.getPESMapping(e))&&t.pesLocale?t.pesLocale:(n=this.getLocale(e))!==e&&(t=this.getPESMapping(n))?t.pesLocale:"default":"default"},e.prototype.getPESMapping=function(e){for(var t=0;t<r.length;t++)if(r[t].locale.toLowerCase()===e.toLowerCase())return r[t];return null},e.prototype.getMappingByLanguage=function(e){for(var t=0;t<i.length;t++)if(i[t].language.toLowerCase()===e.toLowerCase())return i[t];return null},e}();t.default=new o},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),s=n(9),a=n(1),c=n(82),l=/^\w$/,u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.hasLargeEmoticon=function(e){return/<span(\sxmlns=".*")? class="emoticon\s?\w*\s?(animated)?\s+\w*large"><canvas(\s?(data-[-a-z]*|height|width|id|textcontent)=".*")*?>.*<\/canvas><\/span>/i.test(e)},t.prototype.fixInvalidHtml=function(e){return e.replace(/<canvas((?:\s?(?:data-[-a-z]*|height|width)="[a-z0-9]*")*)\s*\/>/g,"<canvas$1></canvas>")},t.prototype.createHtmlElement=function(e,t,n,i,r,a){var l={large:i,largeEmoticonClass:a,textContent:n,emoticonId:t,isAnimated:!r},u=s.createElement(c.SwcEmoticon,l),d=document.createDocumentFragment();return o.render(u,d),d},t.prototype.isElementAllowed=function(e){return"span"!==e.nodeName.toLowerCase()||-1===e.className.toLowerCase().indexOf("emoticon")},t.prototype.wordRawToXml=function(e,t){var n=[],i=0,r=a.default.instance.PesManager.map;if(!a.default.instance.PesManager.canRenderConfigItems())return n;for(var o=0;o<t.length;o++){for(var s="",c=-1,l=o+1;l<t.length+1;l++){var u=t.substring(o,l),d=r.hasOwnProperty(u)&&r[u];d&&!this.isWordChar(t[l])&&(s=d,c=l)}s&&(i!==o&&n.push(e.createTextNode(t.substring(i,o))),i=c,n.push(this.createXmlElement(e,s,t.substring(o,c))),o=c-1)}return 0!==i&&i<t.length&&n.push(e.createTextNode(t.substring(i))),n},t.prototype.createXmlElement=function(e,t,n){var i=e.createElement("ss");return i.setAttribute("type",t),i.innerText=n,i},t.prototype.isWordChar=function(e){return l.test(e)},t}(n(37).WordDomTransformer);t.default=u},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),s=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.actionType=o.SwiftCardActionType.unknown,r.originalPayload=t,r.actionType=t.type,r.image=t.image||t.image_url||null,r}return r(t,e),t}(n(74).default);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),r=n(1),o=n(7),s=n(11),a=n(130),c=n(74),l=n(56),u=n(10),d=function(){return function(e,t,n,d){var p=this;this.url=ko.observable(),this.destinationSize={narrow:{},default:{},carouselDefault:{},carouselNarrow:{}},this.trustedDomains=[i.default.AMS_HOST_URL,i.default.CDN_SERVICE_HOST],this.shouldProcessThroughAMS=function(e){return p._conversation.isSkypeBackend()&&!p.isTrustedUrl(e)},this.processImage=function(e){p.shouldProcessThroughAMS(e)?p.processViaAMS(e).then(function(e){var t=e.url||e.thumbnail,n=e.thumbnail_meta?e.thumbnail_meta:null;n?(p.url(t),p.naturalSize({height:n.height,width:n.width})):p.loadImageSize(l.default.normalizeUrl(t,p._isDl))},function(e){}):p.loadImageSize(p._conversation.isSkypeBackend()?l.default.normalizeUrl(e,p._isDl):e)},this.hasProcessedUrl=function(){return!!p.url()},this.isTrustedUrl=function(e){var t=!1;return p.trustedDomains.forEach(function(n){t=e.indexOf(n)>-1}),t},this.processViaAMS=function(e){var t=i.default.URLP_SERVICE_URL+"/v1/url/info?url=",n=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),o=new RegExp(n,"g"),s=e.indexOf(t)>0?e.replace(o,""):e;return new Promise(function(e){return r.default.instance.AmsManager.getPictureThumbnail(t+encodeURIComponent(s)).then(e)})},this.loadImageSize=function(e){var t=new Image;t.onload=function(){p.url(e),p.naturalSize({height:t.naturalHeight,width:t.naturalWidth})},t.onerror=function(e){s.default.throwError(u.ErrorCodes.ERR_LOAD_IMG,"Unable to load an image, is dl="+p._isDl,e)},t.src=e},this.getUiSize=function(){var e=a.default.instance.CurrentStyle,t=p.getDestinationSize(p.contentType,e,p.isImageInCarousel()),n=p.naturalSize(),i={height:0,width:0};if(0===n.height||0===n.width||0===t.height)return i;var r=t.width/t.height,s=n.width/n.height;switch(p.contentType){case o.SwiftCardContentType.hero:s<r?(i.width=t.width,i.height=n.height*t.width/n.width,p.bottomAlignment((i.height-t.height)/2)):(i.height=t.height,i.width=n.width*t.height/n.height),p.leftAlignment(i.width/-2);break;case o.SwiftCardContentType.animation:case o.SwiftCardContentType.audio:s<r?(i.width=n.width*t.height/n.height,i.height=n.height*t.height/n.height):(i.height=t.height,i.width=n.width*t.height/n.height);break;case o.SwiftCardContentType.thumb:case o.SwiftCardContentType.actionImage:s<r?(i.height=t.height,i.width=i.height*s):s===r?(i.height=t.height,i.width=n.width*t.height/n.height):(i.width=t.width,i.height=i.width/s),p.bottomAlignment((i.height-t.height)/2),p.leftAlignment(i.width/-2);break;case o.SwiftCardContentType.receipt:s<r?(i.height=t.height,i.width=i.height*s):s===r?(i.height=t.height,i.width=n.width*t.height/n.height):(i.width=t.width,i.height=i.width/s,p.bottomAlignment((i.height-t.height)/2)),p.leftAlignment(i.width/-2);break;case o.SwiftCardContentType.flex:s<=r?(1===s?(i.height=t.height,i.width=t.height):(i.width=n.width*t.height/n.height,i.height=t.height),p.leftAlignment((i.width-t.width)/-2)):(i.height=t.height,i.width=n.width*t.height/n.height,p.leftAlignment((i.width-t.width)/-2))}return i},this.getTitleByType=function(){switch(p.tap.type){case o.SwiftCardActionType.call:case o.SwiftCardActionType.imBack:return p.createImageTitle();case o.SwiftCardActionType.openUrl:return p.createImageTitle()+"\n\n"+p.tap.value;case o.SwiftCardActionType.showImage:return(p.alt?p.alt+" ":"")+p.lowerFirstLetter(p.tap.title)}return""},this.createImageTitle=function(){var e=p.tap.title||"",t=r.default.instance.i18n.fetch("accessibility_swift_action_prefix",{swiftAction:p.lowerFirstLetter(e)});return(p.alt?p.alt+" ":"")+t},this.lowerFirstLetter=function(e){return e?e[0].toLowerCase()+e.substring(1):""},this.getDestinationSize=function(e,t,n){return(t===a.StyleModes.NORMAL?n?p.destinationSize.carouselDefault:p.destinationSize.default:n?p.destinationSize.carouselNarrow:p.destinationSize.narrow)[e]},this._conversation=t,this._isDl=this._conversation.isDirectLineBackend(),this.destinationSize.narrow[o.SwiftCardContentType.hero]={height:105,width:188},this.destinationSize.default[o.SwiftCardContentType.hero]={height:153,width:272},this.destinationSize.carouselDefault[o.SwiftCardContentType.hero]={height:145,width:270},this.destinationSize.carouselNarrow[o.SwiftCardContentType.hero]={height:105,width:188},this.destinationSize.narrow[o.SwiftCardContentType.thumb]={height:76,width:76},this.destinationSize.default[o.SwiftCardContentType.thumb]={height:112,width:112},this.destinationSize.carouselDefault[o.SwiftCardContentType.thumb]={height:112,width:112},this.destinationSize.carouselNarrow[o.SwiftCardContentType.thumb]={height:76,width:76},this.destinationSize.narrow[o.SwiftCardContentType.receipt]={height:76,width:76},this.destinationSize.default[o.SwiftCardContentType.receipt]={height:112,width:112},this.destinationSize.narrow[o.SwiftCardContentType.animation]={height:105,width:172},this.destinationSize.default[o.SwiftCardContentType.animation]={height:153,width:256},this.destinationSize.carouselDefault[o.SwiftCardContentType.animation]={height:145,width:256},this.destinationSize.carouselNarrow[o.SwiftCardContentType.animation]={height:105,width:172},this.destinationSize.narrow[o.SwiftCardContentType.audio]={height:105,width:172},this.destinationSize.default[o.SwiftCardContentType.audio]={height:145,width:256},this.destinationSize.carouselDefault[o.SwiftCardContentType.audio]={height:145,width:256},this.destinationSize.carouselNarrow[o.SwiftCardContentType.audio]={height:105,width:172},this.destinationSize.default[o.SwiftCardContentType.actionImage]={height:20,width:20},this.destinationSize.narrow[o.SwiftCardContentType.actionImage]={height:16,width:16},this.destinationSize.narrow[o.SwiftCardContentType.flex]={height:105,width:188},this.destinationSize.default[o.SwiftCardContentType.flex]={height:153,width:272},this.destinationSize.carouselDefault[o.SwiftCardContentType.flex]={height:145,width:256},this.destinationSize.carouselNarrow[o.SwiftCardContentType.flex]={height:105,width:188},this.contentType=d,this.alt=l.default.normalizeRichText(e.alt,this._isDl),e.url&&this.processImage(e.url),this.tap=null,e.tap&&(this.tap=l.default.getItemIfNotDisabled(new c.default(e.tap,t,n)),this.tap&&this.tap.type===o.SwiftCardActionType.showImage&&!this.tap.value&&(this.tap.value=this.url())),this.naturalSize=ko.observable({height:0,width:0}),this.uiSize=ko.pureComputed(this.getUiSize.bind(this)),this.isValid=ko.pureComputed(this.hasProcessedUrl),this.bottomAlignment=ko.observable(),this.leftAlignment=ko.observable(),this.isImageInCarousel=ko.observable(!1)}}();t.default=d},,function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=function(e){function t(t){var n=e.call(this,"kpi_action")||this;return n.actionType=t,n}return r(t,e),t.prototype.getCustomProperties=function(){var e=[];return e.push(o.TelemetryPropertyValue.Create("type",this.actionType)),e},t}(n(8).TelemetryEvent);t.UserActionEvent=s,function(e){e.StartVideoCall="videocall",e.StartAudioCall="audiocall",e.Feedback="feedback",e.GetHelp="gethelp",e.OpenComposer="openComposer",e.AddParticipant="addParticipant",e.Participants="participants",e.Fullscreen="fullscreen",e.MediaSettings="mediaSettings",e.SwitchToChat="switchToChat",e.MinimizeChat="minimizeChat",e.VideoOn="videoOn",e.VideoOff="videoOff",e.AudioOn="audioOn",e.AudioOff="audioOff",e.ScreenSharingOn="screenSharingOn",e.ScreenSharingOff="screenSharingOff",e.ToggleAudio="toggleAudio",e.StopCall="stopCall",e.ExpressionPicker="expressionPicker",e.FilePicker="filePicker",e.DeleteMessage="deleteMessage",e.DeleteConversation="deleteChat",e.LeaveConversation="leaveChat",e.BlockUser="block",e.UnblockUser="unblock",e.ReactionPicker="reactionPicker"}(t.UserActionType||(t.UserActionType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(4);t.BUBBLE_TYPE={INFO:"infoBubble",MENU_LIST:"menuList",REACTION_PREVIEW:"reactionPreviewBubble",REACTION_PANE:"reactionPaneBubble"},function(e){e.nextToElement="nextToElement",e.onContextMenu="onContextMenu"}(i=t.BubblePosition||(t.BubblePosition={}));var o=function(){function e(){}return e.add=function(n,o,s,a,c){void 0===c&&(c=i.nextToElement);for(var l=e.build(),u=a==t.BUBBLE_TYPE.INFO,d=l.content;d.firstChild;)d.removeChild(d.firstChild);if(d.appendChild(s),l.container.className="swc-bubble "+a,l.arrow.style.display=u?"block":"none",c===i.nextToElement){var p,h=n.getBoundingClientRect(),f=o.getBoundingClientRect(),g=h.top-f.top,m=f.bottom-h.bottom,v=h.left-f.left,_=f.right-h.right,y=u?10:0,b=void 0,w=h.width/2,C=h.bottom-f.top+y;if(v<_)l.container.style.right="",(p=(b=h.left-f.left+w)-90)<0?(l.container.style.left=b-90-p+w+"px",l.arrow.style.left=90-w+p-8+"px"):(l.container.style.left=b-90+w+"px",l.arrow.style.left="82px");else l.container.style.left="",(p=(b=f.right-h.right+w)-90)<0?(l.container.style.right=b-90+w-p+"px",l.arrow.style.left=90+w-p-8+"px"):(l.container.style.right=b-90+w+"px",l.arrow.style.left="82px");g>m?(l.container.style.top="",l.container.style.bottom=C+"px",l.arrow.style.top="",l.arrow.style.bottom="-10px",l.arrow.style.borderBottom="",l.arrow.style.borderTop="10px solid #d8d8d8",l.arrowInner.style.bottom="2px",l.arrowInner.style.borderBottom="",l.arrowInner.style.borderTop="9px solid #fdc856"):(l.container.style.bottom="",l.container.style.top=C+"px",l.arrow.style.bottom="",l.arrow.style.top="-10px",l.arrow.style.borderTop="",l.arrow.style.borderBottom="10px solid #d8d8d8",l.arrow.style.top="-10px",l.arrowInner.style.top="2px",l.arrowInner.style.borderTop="",l.arrowInner.style.borderBottom="9px solid #fdc856"),o.appendChild(l.container)}else{var E=n,S=E.target,T={x:E.clientX,y:E.clientY},I=o.getBoundingClientRect(),x=o.parentElement?o.parentElement.getBoundingClientRect():null;if(!n||!S)return;var A=T.y-x.top,P=x.bottom-T.y,k=T.x-I.left,M=I.right-T.x;l.container.style.visibility="hidden",o.appendChild(l.container),setTimeout(function(){var e=l.container.offsetWidth,t=l.container.offsetHeight,n=M>e?k:k-e,i=P>t?A+x.top-I.top:A+x.top-I.top-t;l.container.style.left=n+"px",l.container.style.right="",l.container.style.top=i+"px",l.container.style.bottom="",l.container.style.visibility="visible"},0)}o.addEventListener("click",e.remove),window.swc.API.registerEvent(r.ApiEvents.hideBubbleWindow,e.remove)},e.remove=function(){if(e.instance&&e.instance.container){var t=e.instance.container.parentElement;t&&(t.removeEventListener("click",e.remove),window.swc.API.unregisterEvent(r.ApiEvents.hideBubbleWindow,e.remove),t.removeChild(e.instance.container))}},e.build=function(){if(!e.instance){var t=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div"),r=document.createElement("div");n.className="swc-content",i.className="swc-arrow",r.className="swc-arrow-inner",i.appendChild(r),t.appendChild(i),t.appendChild(n),e.instance={container:t,content:n,arrow:i,arrowInner:r}}return e.instance},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=n(1),o=n(77),s=n(356),a=n(0),c=n(19),l="/sdk/v1/",u="sdk",d="js",p=function(){function e(){}return e.startChat=function(e,t,n,o,c,l){var u={ConversationId:e||"",Style:t.Style,Title:t.Title,SetConversationTopic:t.SetConversationTopic,NewChatFlag:n};l&&(u.ExecuteCall=l),a.swc.API.triggerEvent(i.ApiEvents.StartChat,u);var d=new s.default;d.actionType=e?s.RecentActionType.OPEN_CHAT:s.RecentActionType.NEW_CHAT,d.origin=o,r.default.instance.TelemetryService.sendEvent(d)},e.startCall=function(t,n,i,r,s,a){var c={calleeId:t,withVideo:i,displayName:r,avatarUrl:s,isGroup:a};e.startChat(t,n,!1,o.default.RECENT,null,c)},e.joinGroupCall=function(t,n,i,r,s){var a={threadId:t,withVideo:i,displayName:r,avatarUrl:s,isGroup:!0,accept:!0};e.startChat(t,n,!1,o.default.RECENT,null,a)},e.closeAllOpenChats=function(){window.swc.API.triggerEvent("closeAllChats")},e._getSDKUrl=function(){return c.default.getCDNPath()+c.default.getCompletePath(l+u,d)},e._callingPopup=null,e}();t.default=p},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=e.call(this)||this;return t.addAgent=function(e){return t._botsService.addAgentToContacts(e)},t.getAgent=function(e){return t._agentsService.getAgentDetails(e)},t._agentsService=t.getServices().agentsService,t._botsService=t.getServices().botsService,t}return r(t,e),t}(n(21).default);t.SkypeAgentsManager=o,t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.addFormatting=function(t){return t=e.addFormattingTags(t,"s",/(\s|^|_|\*|i>|b>|s>)~((?!~\s).)*~(\s|$|_|\*|<)/gi,"~")},e.addFormattingTags=function(t,n,i,r){for(var o=t.match(i);o&&o.length>0&&2!=o[0].trim().length;)o.forEach(function(i){var o=i.trim(),s=(o=o.substring(o.indexOf(r),o.lastIndexOf(r)+1)).substr(1,o.length-2);s=e.createStartTag(n,r)+s+e.createEndTag(n),t=t.replace(o,s)}),o=t.match(i);return t},e.createStartTag=function(e,t){return"<"+e+' raw_pre="'+t+'" raw_post="'+t+'">'},e.createEndTag=function(e){return"</"+e+">"},e}();t.default=i},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.isElementAllowed=function(e){return"i"!==e.nodeName.toLowerCase()||-1===e.className.toLowerCase().indexOf("mention")},t.prototype.xmlNodeToHtml=function(e,t){if("at"===t.nodeName.toLowerCase()&&t.attributes.getNamedItem("id")){var n=e.createElement("i");return n.setAttribute("class","mention"),n.setAttribute("title",t.attributes.getNamedItem("id").value),n.textContent=t.textContent,[n]}return[]},t}(n(127).DomTransformerBase);t.MentionDomDecoder=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.prototype.transformRawToXml=function(e,t,n,i){var r=[];for(r.push(t);0!==r.length;){var o=r.pop();this.encodeTextNodeToXml(e,o,n,i)&&o.nodeType!==Node.TEXT_NODE&&this.isElementAllowed(o)&&this.pushChildNodes(r,o)}},e.prototype.encodeTextNodeToXml=function(e,t,n,i){var r=t.parentNode,o=this.xmlNodeToHtml(e,t,n,i);if(!o||!o.length)return!0;for(var s=0;s<o.length;s++)r.insertBefore(o[s],t);return r.removeChild(t),!1},e.prototype.pushChildNodes=function(e,t){for(var n=0;n<t.childNodes.length;n++)e.push(t.childNodes[n])},e}();t.DomTransformerBase=i},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.isElementAllowed=function(e){return"pre"!==e.nodeName.toLowerCase()},t.prototype.wordRawToXml=function(e,t){return[this.createXmlElement(e)]},t.prototype.getAllWords=function(e){for(var t,n=/\r?\n/g,i=new Array;null!==(t=n.exec(e));)i.push(t);return i},t.prototype.createXmlElement=function(e){return e.createElement("br")},t}(n(37).WordDomTransformer);t.NewLineDomTransformer=o},function(e,t,n){(function(t){(function(){"use strict";var t={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:p,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:p,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:p,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};function n(e){this.tokens=[],this.tokens.links={},this.options=e||f.defaults,this.rules=t.normal,this.options.gfm&&(this.options.tables?this.rules=t.tables:this.rules=t.gfm)}t.bullet=/(?:[*+-]|\d+\.)/,t.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,t.item=c(t.item,"gm")(/bull/g,t.bullet)(),t.list=c(t.list)(/bull/g,t.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+t.def.source+")")(),t.blockquote=c(t.blockquote)("def",t.def)(),t._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",t.html=c(t.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,t._tag)(),t.paragraph=c(t.paragraph)("hr",t.hr)("heading",t.heading)("lheading",t.lheading)("blockquote",t.blockquote)("tag","<"+t._tag)("def",t.def)(),t.normal=h({},t),t.gfm=h({},t.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),t.gfm.paragraph=c(t.paragraph)("(?!","(?!"+t.gfm.fences.source.replace("\\1","\\2")+"|"+t.list.source.replace("\\1","\\3")+"|")(),t.tables=h({},t.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),n.rules=t,n.lex=function(e,t){return new n(t).lex(e)},n.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},n.prototype.token=function(e,n,i){var r,o,s,a,c,l,u,d,p;for(e=e.replace(/^ +$/gm,"");e;)if((s=this.rules.newline.exec(e))&&(e=e.substring(s[0].length),s[0].length>1&&this.tokens.push({type:"space"})),s=this.rules.code.exec(e))e=e.substring(s[0].length),s=s[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?s:s.replace(/\n+$/,"")});else if(s=this.rules.fences.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"code",lang:s[2],text:s[3]||""});else if(s=this.rules.heading.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"heading",depth:s[1].length,text:s[2]});else if(n&&(s=this.rules.nptable.exec(e))){for(e=e.substring(s[0].length),l={type:"table",header:s[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:s[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:s[3].replace(/\n$/,"").split("\n")},d=0;d<l.align.length;d++)/^ *-+: *$/.test(l.align[d])?l.align[d]="right":/^ *:-+: *$/.test(l.align[d])?l.align[d]="center":/^ *:-+ *$/.test(l.align[d])?l.align[d]="left":l.align[d]=null;for(d=0;d<l.cells.length;d++)l.cells[d]=l.cells[d].split(/ *\| */);this.tokens.push(l)}else if(s=this.rules.lheading.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"heading",depth:"="===s[2]?1:2,text:s[1]});else if(s=this.rules.hr.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"hr"});else if(s=this.rules.blockquote.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"blockquote_start"}),s=s[0].replace(/^ *> ?/gm,""),this.token(s,n,!0),this.tokens.push({type:"blockquote_end"});else if(s=this.rules.list.exec(e)){for(e=e.substring(s[0].length),a=s[2],this.tokens.push({type:"list_start",ordered:a.length>1}),r=!1,p=(s=s[0].match(this.rules.item)).length,d=0;d<p;d++)u=(l=s[d]).length,~(l=l.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(u-=l.length,l=this.options.pedantic?l.replace(/^ {1,4}/gm,""):l.replace(new RegExp("^ {1,"+u+"}","gm"),"")),this.options.smartLists&&d!==p-1&&(a===(c=t.bullet.exec(s[d+1])[0])||a.length>1&&c.length>1||(e=s.slice(d+1).join("\n")+e,d=p-1)),o=r||/\n\n(?!\s*$)/.test(l),d!==p-1&&(r="\n"===l.charAt(l.length-1),o||(o=r)),this.tokens.push({type:o?"loose_item_start":"list_item_start"}),this.token(l,!1,i),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(s=this.rules.html.exec(e))e=e.substring(s[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===s[1]||"script"===s[1]||"style"===s[1]),text:s[0]});else if(!i&&n&&(s=this.rules.def.exec(e)))e=e.substring(s[0].length),this.tokens.links[s[1].toLowerCase()]={href:s[2],title:s[3]};else if(n&&(s=this.rules.table.exec(e))){for(e=e.substring(s[0].length),l={type:"table",header:s[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:s[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:s[3].replace(/(?: *\| *)?\n$/,"").split("\n")},d=0;d<l.align.length;d++)/^ *-+: *$/.test(l.align[d])?l.align[d]="right":/^ *:-+: *$/.test(l.align[d])?l.align[d]="center":/^ *:-+ *$/.test(l.align[d])?l.align[d]="left":l.align[d]=null;for(d=0;d<l.cells.length;d++)l.cells[d]=l.cells[d].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(l)}else if(n&&(s=this.rules.paragraph.exec(e)))e=e.substring(s[0].length),this.tokens.push({type:"paragraph",text:"\n"===s[1].charAt(s[1].length-1)?s[1].slice(0,-1):s[1]});else if(s=this.rules.text.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"text",text:s[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var i={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ <>]+(@|:\/)[^ <>]+)>/,url:p,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^<'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)([\s\S]*?[^`])\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:p,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};function r(e,t){if(this.options=t||f.defaults,this.links=e,this.rules=i.normal,this.renderer=this.options.renderer||new o,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=i.breaks:this.rules=i.gfm:this.options.pedantic&&(this.rules=i.pedantic)}function o(e){this.options=e||{}}function s(e){this.tokens=[],this.token=null,this.options=e||f.defaults,this.options.renderer=this.options.renderer||new o,this.renderer=this.options.renderer,this.renderer.options=this.options}function a(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function c(e,t){return e=e.source,t=t||"",function n(i,r){return i?(r=(r=r.source||r).replace(/(^|[^\[])\^/g,"$1"),e=e.replace(i,r),n):new RegExp(e,t)}}function l(e,t){return u[" "+e]||(/^[^:]+:\/*[^/]*$/.test(e)?u[" "+e]=e+"/":u[" "+e]=e.replace(/[^/]*$/,"")),e=u[" "+e],"//"===t.slice(0,2)?e.replace(/:[\s\S]*/,":")+t:"/"===t.charAt(0)?e.replace(/(:\/*[^/]*)[\s\S]*/,"$1")+t:e+t}i._inside=/(?:\[[^\]]*\]|\\[\[\]]|[^\[\]]|\](?=[^\[]*\]))*/,i._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,i.link=c(i.link)("inside",i._inside)("href",i._href)(),i.reflink=c(i.reflink)("inside",i._inside)(),i.normal=h({},i),i.pedantic=h({},i.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),i.gfm=h({},i.normal,{escape:c(i.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:c(i.text)("]|","~]|")("|","|https?://|")()}),i.breaks=h({},i.gfm,{br:c(i.br)("{2,}","*")(),text:c(i.gfm.text)("{2,}","*")()}),r.rules=i,r.output=function(e,t,n){return new r(t,n).output(e)},r.prototype.output=function(e){for(var t,n,i,r,o="";e;)if(r=this.rules.escape.exec(e))e=e.substring(r[0].length),o+=r[1];else if(r=this.rules.autolink.exec(e))e=e.substring(r[0].length),"@"===r[2]?(n=a(":"===r[1].charAt(6)?this.mangle(r[1].substring(7)):this.mangle(r[1])),i=this.mangle("mailto:")+n):i=n=a(r[1]),o+=this.renderer.link(i,null,n);else if(this.inLink||!(r=this.rules.url.exec(e))){if(r=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(r[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(r[0])&&(this.inLink=!1),e=e.substring(r[0].length),o+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):a(r[0]):r[0];else if(r=this.rules.link.exec(e))e=e.substring(r[0].length),this.inLink=!0,o+=this.outputLink(r,{href:r[2],title:r[3]}),this.inLink=!1;else if((r=this.rules.reflink.exec(e))||(r=this.rules.nolink.exec(e))){if(e=e.substring(r[0].length),t=(r[2]||r[1]).replace(/\s+/g," "),!(t=this.links[t.toLowerCase()])||!t.href){o+=r[0].charAt(0),e=r[0].substring(1)+e;continue}this.inLink=!0,o+=this.outputLink(r,t),this.inLink=!1}else if(r=this.rules.strong.exec(e))e=e.substring(r[0].length),o+=this.renderer.strong(this.output(r[2]||r[1]));else if(r=this.rules.em.exec(e))e=e.substring(r[0].length),o+=this.renderer.em(this.output(r[2]||r[1]));else if(r=this.rules.code.exec(e))e=e.substring(r[0].length),o+=this.renderer.codespan(a(r[2].trim(),!0));else if(r=this.rules.br.exec(e))e=e.substring(r[0].length),o+=this.renderer.br();else if(r=this.rules.del.exec(e))e=e.substring(r[0].length),o+=this.renderer.del(this.output(r[1]));else if(r=this.rules.text.exec(e))e=e.substring(r[0].length),o+=this.renderer.text(a(this.smartypants(r[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else e=e.substring(r[0].length),i=n=a(r[1]),o+=this.renderer.link(i,null,n);return o},r.prototype.outputLink=function(e,t){var n=a(t.href),i=t.title?a(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,i,this.output(e[1])):this.renderer.image(n,i,a(e[1]))},r.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},r.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,n="",i=e.length,r=0;r<i;r++)t=e.charCodeAt(r),Math.random()>.5&&(t="x"+t.toString(16)),n+="&#"+t+";";return n},o.prototype.code=function(e,t,n){if(this.options.highlight){var i=this.options.highlight(e,t);null!=i&&i!==e&&(n=!0,e=i)}return t?'<pre><code class="'+this.options.langPrefix+a(t,!0)+'">'+(n?e:a(e,!0))+"\n</code></pre>\n":"<pre><code>"+(n?e:a(e,!0))+"\n</code></pre>"},o.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},o.prototype.html=function(e){return e},o.prototype.heading=function(e,t,n){return"<h"+t+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},o.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},o.prototype.list=function(e,t){var n=t?"ol":"ul";return"<"+n+">\n"+e+"</"+n+">\n"},o.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},o.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},o.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},o.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},o.prototype.tablecell=function(e,t){var n=t.header?"th":"td";return(t.align?"<"+n+' style="text-align:'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"},o.prototype.strong=function(e){return"<strong>"+e+"</strong>"},o.prototype.em=function(e){return"<em>"+e+"</em>"},o.prototype.codespan=function(e){return"<code>"+e+"</code>"},o.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},o.prototype.del=function(e){return"<del>"+e+"</del>"},o.prototype.link=function(e,t,n){if(this.options.sanitize){try{var i=decodeURIComponent((r=e,r.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""}))).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return n}if(0===i.indexOf("javascript:")||0===i.indexOf("vbscript:")||0===i.indexOf("data:"))return n}var r;this.options.baseUrl&&!d.test(e)&&(e=l(this.options.baseUrl,e));var o='<a href="'+e+'"';return t&&(o+=' title="'+t+'"'),o+=">"+n+"</a>"},o.prototype.image=function(e,t,n){this.options.baseUrl&&!d.test(e)&&(e=l(this.options.baseUrl,e));var i='<img src="'+e+'" alt="'+n+'"';return t&&(i+=' title="'+t+'"'),i+=this.options.xhtml?"/>":">"},o.prototype.text=function(e){return e},s.parse=function(e,t,n){return new s(t,n).parse(e)},s.prototype.parse=function(e){this.inline=new r(e.links,this.options,this.renderer),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},s.prototype.next=function(){return this.token=this.tokens.pop()},s.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},s.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},s.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,n,i,r="",o="";for(n="",e=0;e<this.token.header.length;e++)({header:!0,align:this.token.align[e]}),n+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(r+=this.renderer.tablerow(n),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],n="",i=0;i<t.length;i++)n+=this.renderer.tablecell(this.inline.output(t[i]),{header:!1,align:this.token.align[i]});o+=this.renderer.tablerow(n)}return this.renderer.table(r,o);case"blockquote_start":for(o="";"blockquote_end"!==this.next().type;)o+=this.tok();return this.renderer.blockquote(o);case"list_start":o="";for(var s=this.token.ordered;"list_end"!==this.next().type;)o+=this.tok();return this.renderer.list(o,s);case"list_item_start":for(o="";"list_item_end"!==this.next().type;)o+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(o);case"loose_item_start":for(o="";"list_item_end"!==this.next().type;)o+=this.tok();return this.renderer.listitem(o);case"html":var a=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(a);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}};var u={},d=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function p(){}function h(e){for(var t,n,i=1;i<arguments.length;i++)for(n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function f(e,t,i){if(i||"function"==typeof t){i||(i=t,t=null);var r,o,c=(t=h({},f.defaults,t||{})).highlight,l=0;try{r=n.lex(e,t)}catch(e){return i(e)}o=r.length;var u=function(e){if(e)return t.highlight=c,i(e);var n;try{n=s.parse(r,t)}catch(t){e=t}return t.highlight=c,e?i(e):i(null,n)};if(!c||c.length<3)return u();if(delete t.highlight,!o)return u();for(;l<r.length;l++)!function(e){"code"!==e.type?--o||u():c(e.text,e.lang,function(t,n){return t?u(t):null==n||n===e.text?--o||u():(e.text=n,e.escaped=!0,void(--o||u()))})}(r[l])}else try{return t&&(t=h({},f.defaults,t)),s.parse(n.lex(e,t),t)}catch(e){if(e.message+="\nPlease report this to https://github.com/chjj/marked.",(t||f.defaults).silent)return"<p>An error occurred:</p><pre>"+a(e.message+"",!0)+"</pre>";throw e}}p.exec=p,f.options=f.setOptions=function(e){return h(f.defaults,e),f},f.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new o,xhtml:!1,baseUrl:null},f.Parser=s,f.parser=s.parse,f.Renderer=o,f.Lexer=n,f.lexer=n.lex,f.InlineLexer=r,f.inlineLexer=r.output,f.parse=f,e.exports=f}).call(function(){return this||("undefined"!=typeof window?window:t)}())}).call(this,n(22))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(62),o=n(28),s=function(){function e(){var e=this;this.handlers=[],this.dispose=function(){o.default.getWindow().removeEventListener("resize",e.windowResizeHandler)},this.getCurrentStyle=function(){return(e.forcedWidth||o.default.getWindow().innerWidth)<356?i.NARROW:i.NORMAL},this.onResize=function(){e._currentStyle=e.getCurrentStyle();for(var t=0,n=e.handlers;t<n.length;t++){var i=n[t];try{i()}catch(e){}}};this.windowResizeHandler=r(this.onResize,500),o.default.getWindow().addEventListener("resize",this.windowResizeHandler)}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurrentStyle",{get:function(){return this._currentStyle},enumerable:!0,configurable:!0}),e.prototype.forceWidth=function(e){this.forcedWidth=e,this._currentStyle=this.getCurrentStyle()},e.prototype.addResizeHandler=function(e){-1==this.handlers.indexOf(e)&&this.handlers.push(e)},e.prototype.removeResizeHandler=function(e){var t=this.handlers.indexOf(e);-1!=t&&this.handlers.splice(t,1)},e}();t.default=s,function(e){e[e.NARROW=0]="NARROW",e[e.NORMAL=1]="NORMAL"}(i=t.StyleModes||(t.StyleModes={}))},,function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n(12),a=n(9),c=n(0),l=n(52),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){var e={backgroundColor:l.default.getBackgroundColor(this.props.title)||"transparent"},t=c.swc.Assets.SVG;return a.createElement("div",o({className:"avatar",style:e},{"tab-index":"0","aria-label":"avatar"},{dangerouslySetInnerHTML:{__html:t.iconPstnContact}}))},t}(s.Component);t.PstnAvatar=u},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(10),o=n(21),s=n(17),a=n(11),c=n(1),l=function(){function e(){var e=this;this.fetch=function(){return e.mePerson?Promise.resolve(e.mePerson):e._mePersonPromise&&e._mePersonPromise.status===s.PromiseStatus.Pending?e._mePersonPromise.promise:(e._mePersonPromise=new s.CancelablePromise(e._fetchMePerson()),e._mePersonPromise.promise.catch(function(e){a.default.throwError(r.ErrorCodes.ERR_FETCH_ME_PERSON,"Unable to fetch me person",e)}),e._mePersonPromise.promise)}}return e.init=function(){i.swc.MePersonManager=i.swc.MePersonManager||new e},Object.defineProperty(e.prototype,"mePerson",{get:function(){return o.getServices().mePerson},enumerable:!0,configurable:!0}),e.prototype.isMe=function(e){return!!this.mePerson&&(this.mePerson.id===e||this.mePerson.msaId===e||this.mePerson.mri===e)},e.prototype.dispose=function(){this._mePersonPromise&&this._mePersonPromise.status!==s.PromiseStatus.Pending&&(this._mePersonPromise=null),this.mePerson&&this.mePerson.dispose()},e.prototype._fetchMePerson=function(){var e=this;return this.mePerson?Promise.reject("[skypeConversationsManager] mePerson has been already fetched."):c.default.instance.SignInManager.onceSignedIn().then(function(){return e.getDetails(),e.mePerson})},e.prototype.getDetails=function(){},e}();t.default=l},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(28),r=n(19),o=function(){function e(){}return e.addStyle=function(e,t,n){var o=e;if(t&&(o=r.default.getAbsoluteUrl(o,"css")),this.hasStyle(o))n&&n();else{var s=i.default.getDocument(),a=s.createElement("link");a.type="text/css",a.rel="stylesheet",a.href=o,n&&(a.onload=n),s.getElementsByTagName("head")[0].appendChild(a)}},e.hasStyle=function(e){for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].href===e)return!0;return!1},e}();t.default=o},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(){this.skypeLogo=n(158),this.iconSent=n(159),this.iconCross=n(160),this.iconMore=n(161),this.iconMaximize=n(162),this.iconMinimize=n(163),this.iconArrow=n(164),this.iconFileUpload=n(165),this.iconExpressionPicker=n(166),this.iconSearch=n(167),this.iconDownload=n(168),this.iconError=n(169),this.iconMute=n(170),this.iconUnmute=n(171),this.iconExitFullscreen=n(172),this.iconEnterFullscreen=n(173),this.iconPlay=n(174),this.iconPause=n(175),this.iconGroupAvatar=n(176),this.iconGlobus=n(177),this.iconOpenUrl=n(178),this.iconContactAdd=n(179),this.iconContactDelete=n(180),this.iconContact=n(181),this.iconOk=n(182),this.iconCancel=n(183),this.iconNotificationOff=n(184),this.iconPencil=n(185),this.iconDelete=n(186),this.iconDeleteMsg=n(187),this.iconPstnContact=n(188),this.iconCallStart=n(189),this.iconCallEnd=n(190),this.iconVideo=n(191),this.iconSkype=n(192),this.iconChevron=n(193),this.iconMessage=n(194),this.iconSpeaker=n(195),this.iconBlocked=n(196),this.iconGroupPair=n(197),this.iconLogoMicrosoft=n(198),this.iconAudio=n(199),this.iconVideoCall=n(200),this.iconVideoOn=n(100),this.iconVideoOff=n(101),this.iconMuteCall=n(201),this.iconUnmuteCall=n(202),this.iconHangup=n(203),this.iconIncomingVideoOn=n(100),this.iconIncomingVideoOff=n(101),this.iconChat=n(204),this.iconDock=n(205),this.iconUndock=n(206),this.iconSettings=n(207),this.iconFullscreenOn=n(208),this.iconFullscreenOff=n(209),this.iconWatermark=n(210),this.iconImage=n(211),this.iconFile=n(212),this.iconStar=n(213),this.iconChats=n(214)}}();t.SVG=new i},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 80">\r\n    <path d="M90 57.3v-4.9c.6.5 1.2.9 2 1.3s1.6.7 2.5 1c.9.3 1.7.5 2.6.6.9.1 1.7.2 2.4.2 2.5 0 4.4-.5 5.7-1.4 1.3-.9 1.9-2.3 1.9-4.1 0-1-.2-1.8-.6-2.5-.4-.7-1-1.4-1.7-1.9-.7-.6-1.6-1.1-2.6-1.7-1-.5-2.1-1.1-3.2-1.7-1.2-.6-2.4-1.3-3.4-1.9-1.1-.6-2-1.3-2.8-2.1-.8-.8-1.4-1.6-1.9-2.6s-.7-2.1-.7-3.4c0-1.6.4-3 1.1-4.2.7-1.2 1.6-2.2 2.8-2.9 1.1-.8 2.4-1.3 3.9-1.7 1.5-.4 3-.6 4.5-.6 3.5 0 6 .4 7.6 1.3v4.7c-2.1-1.4-4.7-2.2-8-2.2-.9 0-1.8.1-2.7.3-.9.2-1.7.5-2.4.9s-1.3 1-1.7 1.7c-.4.7-.7 1.5-.7 2.5 0 .9.2 1.7.5 2.3.3.7.8 1.3 1.5 1.8s1.5 1.1 2.4 1.6c.9.5 2 1.1 3.2 1.7 1.3.6 2.5 1.3 3.6 2s2.1 1.5 3 2.3c.9.8 1.5 1.8 2 2.8.5 1 .7 2.2.7 3.5 0 1.7-.3 3.2-1 4.4-.7 1.2-1.6 2.2-2.7 2.9-1.2.8-2.5 1.3-4 1.6-1.5.3-3.1.5-4.8.5-.6 0-1.2 0-2.1-.1-.8-.1-1.7-.2-2.5-.4s-1.7-.4-2.4-.6c-1-.4-1.6-.7-2-1m45.7 1.4H130l-11-12.1h-.1v12.1h-4.1V21.3h4.1V45h.1l10.5-11.6h5.3l-11.7 12.2zm23.7-25.3l-11.5 29.3c-2.1 5.2-5 7.8-8.7 7.8-1 0-1.9-.1-2.6-.3v-3.6c.9.3 1.7.4 2.4.4 2 0 3.5-1.2 4.6-3.6l2-4.8-9.8-25.2h4.5l6.8 19.4c.1.2.3.9.5 1.9h.1c.1-.4.2-1 .5-1.9l7.1-19.5h4.1zm6.3 11.5v3.5c0 2.1.7 3.9 2 5.3 1.4 1.5 3.1 2.2 5.1 2.2 2.4 0 4.3-.9 5.7-2.8 1.4-1.9 2.1-4.5 2.1-7.8 0-2.8-.6-5-1.9-6.6-1.3-1.6-3-2.4-5.2-2.4-2.3 0-4.2.8-5.6 2.5-1.5 1.5-2.2 3.6-2.2 6.1m.1 10.1l-.1 15.3h-4V33.4h4v4.4h.1c2-3.4 4.9-5 8.7-5 3.2 0 5.8 1.1 7.6 3.4 1.8 2.3 2.7 5.3 2.7 9.1 0 4.2-1 7.6-3.1 10.1-2 2.5-4.8 3.8-8.4 3.8-3.2.1-5.8-1.3-7.5-4.2M205 43.7c0-2.3-.6-4.2-1.7-5.5-1.1-1.3-2.6-1.9-4.6-1.9-1.9 0-3.5.7-4.8 2-1.3 1.4-2.1 3.1-2.5 5.4H205zm4.1 3.4h-17.7c.1 2.8.8 5 2.3 6.5 1.4 1.5 3.4 2.3 5.9 2.3 2.8 0 5.4-.9 7.8-2.8v3.8c-2.2 1.6-5.1 2.4-8.8 2.4-3.5 0-6.3-1.1-8.4-3.4-2-2.3-3-5.5-3-9.7 0-3.9 1.1-7.1 3.3-9.6 2.2-2.5 5-3.7 8.3-3.7 3.3 0 5.8 1.1 7.6 3.2 1.8 2.1 2.7 5.1 2.7 8.9v2.1zM41.4 59.2c-10.1 0-14.7-5.1-14.7-8.9 0-1.9 1.5-3.3 3.5-3.3 4.3 0 3.2 6.5 11.3 6.5 4.1 0 6.5-2.5 6.5-4.8 0-1.4-.8-3-3.5-3.6l-9-2.3C28.3 41 27 36.9 27 33.2c0-7.7 7.1-10.5 13.8-10.5 6.2 0 13.6 3.4 13.6 8.1 0 2-1.7 3.1-3.6 3.1-3.7 0-3.1-5.2-10.5-5.2-3.7 0-5.6 1.7-5.6 4.1 0 2.4 2.9 3.2 5.4 3.8l6.6 1.5c7.3 1.6 9.2 5.9 9.2 10 0 6.2-4.9 11.1-14.5 11.1m27.9-13.4c.3-1.6.4-3.3.4-5C69.7 25 57 12.2 41.3 12.2c-1.7 0-3.3.1-4.9.4-2.5-1.4-5.3-2.2-8.4-2.2-9.3 0-16.9 7.6-16.9 17 0 3.1.8 5.9 2.2 8.4-.3 1.6-.4 3.3-.4 5 0 15.8 12.7 28.6 28.4 28.6 1.7 0 3.3-.1 4.9-.4 2.5 1.4 5.3 2.2 8.4 2.2 9.3 0 16.9-7.6 16.9-17 0-3-.8-5.9-2.2-8.4"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon-sen" viewBox="0 0 24 24">\r\n    <g fill="none" fill-rule="evenodd" stroke="inherit" stroke-width="2">\r\n        <path d="M4.67 20.4l15.7-8.4-15.7-8.4L6 12l-1.35 8.4z"/>\r\n        <path stroke-linecap="square" d="M6.5 12h13"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 230 180">\r\n    <path d="M1856 1088 Q1882 1088 1901 1069 Q1920 1050 1920 1024 Q1920 998 1901 979 Q1882 960 1856 960 L1088 960 L1088 192 Q1088 166 1069 147 Q1050 128 1024 128 Q998 128 979 147 Q960 166 960 192 L960 960 L192 960 Q166 960 147 979 Q128 998 128 1024 Q128 1050 147 1069 Q166 1088 192 1088 L960 1088 L960 1856 Q960 1882 979 1901 Q998 1920 1024 1920 Q1050 1920 1069 1901 Q1088 1882 1088 1856 L1088 1088 L1856 1088 Z" transform="scale(0.1, -0.1) translate(0, -1800)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 230 180">\r\n    <path d="M341 1195 Q377 1195 408 1181.5 Q439 1168 462 1145 Q485 1122 498.5 1090.5 Q512 1059 512 1024 Q512 989 498.5 958 Q485 927 462 903.5 Q439 880 408 866.5 Q377 853 341 853 Q306 853 275 866.5 Q244 880 221 903.5 Q198 927 184.5 958 Q171 989 171 1024 Q171 1059 184.5 1090.5 Q198 1122 221 1145 Q244 1168 275 1181.5 Q306 1195 341 1195 Z M1024 1195 Q1059 1195 1090.5 1181.5 Q1122 1168 1145 1145 Q1168 1122 1181.5 1090.5 Q1195 1059 1195 1024 Q1195 989 1181.5 958 Q1168 927 1145 903.5 Q1122 880 1090.5 866.5 Q1059 853 1024 853 Q989 853 958 866.5 Q927 880 903.5 903.5 Q880 927 866.5 958 Q853 989 853 1024 Q853 1059 866.5 1090.5 Q880 1122 903.5 1145 Q927 1168 958 1181.5 Q989 1195 1024 1195 Z M1707 1195 Q1742 1195 1773 1181.5 Q1804 1168 1827 1145 Q1850 1122 1863.5 1090.5 Q1877 1059 1877 1024 Q1877 989 1863.5 958 Q1850 927 1827 903.5 Q1804 880 1773 866.5 Q1742 853 1707 853 Q1671 853 1640 866.5 Q1609 880 1586 903.5 Q1563 927 1549.5 958 Q1536 989 1536 1024 Q1536 1059 1549.5 1090.5 Q1563 1122 1586 1145 Q1609 1168 1640 1181.5 Q1671 1195 1707 1195 Z" transform="scale(0.1, -0.1) translate(0, -1800)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200">\r\n    <path d="M1707 939 L1109 939 L1109 341 L939 341 L939 939 L341 939 L341 1109 L939 1109 L939 1707 L1109 1707 L1109 1109 L1707 1109 L1707 939 Z " transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 1.5">\r\n    <title>SWC_Minimize</title>\r\n    <path d="M22.28,18.42a.75.75,0,0,1-.53,1.28H2.25a.75.75,0,0,1,0-1.5h19.5A.73.73,0,0,1,22.28,18.42Z" transform="translate(-1.5 -18.2)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="arrow" viewBox="0 0 24 24">\r\n    <path fill="none" fill-rule="evenodd" stroke="inherit" stroke-linejoin="round" stroke-width="2" d="M7 20.5l8.5-8.5L7 3.5"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" stroke="inherit" class="icon-file" viewBox="0 0 24 24">\r\n    <g fill="none" fill-rule="evenodd" stroke="inherit" stroke-width="2">\r\n        <path d="M7 7c-2.76 0-5 2.24-5 5s2.24 5 5 5M18 7c2.2 0 4 1.57 4 3.5S20.2 14 18 14"/>\r\n        <path d="M7 10c-1.1 0-2 .9-2 2s.9 2 2 2"/>\r\n        <path stroke-linecap="square" d="M8 7h9M8 17h7m-7-7h7m-7 4h9" opacity=".99"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="Layer_1" x="0px" y="0px" class="icon-expression-picker" style="enable-background:new 0 0 40 40" version="1.1" viewBox="0 0 40 40" xml:space="preserve">\r\n    <g>\r\n        <path d="M20,3.3c1.5,0,3,0.2,4.4,0.6c1.4,0.4,2.7,1,4,1.7s2.4,1.6,3.4,2.6c1,1,1.9,2.1,2.6,3.4c0.7,1.2,1.3,2.6,1.7,4   s0.6,2.9,0.6,4.4s-0.2,3-0.6,4.4s-1,2.7-1.7,4c-0.7,1.2-1.6,2.4-2.6,3.4c-1,1-2.1,1.9-3.4,2.6s-2.6,1.3-4,1.7   c-1.4,0.4-2.9,0.6-4.4,0.6s-3-0.2-4.4-0.6c-1.4-0.4-2.7-1-4-1.7c-1.2-0.7-2.4-1.6-3.4-2.6c-1-1-1.9-2.1-2.6-3.4s-1.3-2.6-1.7-4   C3.5,23,3.3,21.5,3.3,20s0.2-3,0.6-4.4c0.4-1.4,1-2.7,1.7-4s1.6-2.4,2.6-3.4c1-1,2.1-1.9,3.4-2.6c1.2-0.7,2.6-1.3,4-1.7   C17,3.5,18.5,3.3,20,3.3z M20,33.3c1.2,0,2.4-0.2,3.5-0.5s2.2-0.8,3.2-1.3c1-0.6,1.9-1.3,2.7-2.1c0.8-0.8,1.5-1.7,2.1-2.7   s1-2.1,1.3-3.2c0.3-1.1,0.5-2.3,0.5-3.5s-0.2-2.4-0.5-3.5c-0.3-1.1-0.8-2.2-1.3-3.2s-1.3-1.9-2.1-2.7c-0.8-0.8-1.7-1.5-2.7-2.1   c-1-0.6-2-1-3.2-1.3c-1.1-0.3-2.3-0.5-3.5-0.5s-2.4,0.2-3.5,0.5c-1.1,0.3-2.2,0.8-3.2,1.3c-1,0.6-1.9,1.3-2.7,2.1s-1.5,1.7-2.1,2.7   c-0.6,1-1,2.1-1.3,3.2S6.7,18.8,6.7,20s0.2,2.4,0.5,3.5s0.8,2.2,1.3,3.2c0.6,1,1.3,1.9,2.1,2.7s1.7,1.5,2.7,2.1s2,1,3.2,1.3   C17.6,33.2,18.8,33.3,20,33.3z M15,19.2c-0.4,0-0.7-0.1-1-0.2s-0.6-0.3-0.8-0.5s-0.4-0.5-0.5-0.8s-0.2-0.6-0.2-1   c0-0.3,0.1-0.7,0.2-1s0.3-0.6,0.5-0.8s0.5-0.4,0.8-0.5s0.6-0.2,1-0.2s0.7,0.1,1,0.2s0.6,0.3,0.8,0.5s0.4,0.5,0.5,0.8s0.2,0.6,0.2,1   c0,0.4-0.1,0.7-0.2,1s-0.3,0.6-0.5,0.8S16.3,18.8,16,19S15.4,19.2,15,19.2z M20,27.5c0.8,0,1.6-0.2,2.3-0.5s1.3-0.7,1.9-1.3   s0.9-1.1,1.3-1.9s0.5-1.5,0.5-2.3h-1.7c0,0.6-0.1,1.1-0.3,1.6s-0.5,1-0.9,1.3s-0.8,0.7-1.3,0.9s-1,0.3-1.6,0.3s-1.1-0.1-1.6-0.3   s-1-0.5-1.3-0.9s-0.7-0.8-0.9-1.3s-0.3-1-0.3-1.6h-1.7c0,0.8,0.2,1.6,0.5,2.3s0.7,1.3,1.3,1.9s1.1,0.9,1.9,1.3S19.2,27.5,20,27.5z    M25,19.2c-0.4,0-0.7-0.1-1-0.2s-0.6-0.3-0.8-0.5s-0.4-0.5-0.5-0.8s-0.2-0.6-0.2-1c0-0.3,0.1-0.7,0.2-1s0.3-0.6,0.5-0.8   s0.5-0.4,0.8-0.5s0.6-0.2,1-0.2s0.7,0.1,1,0.2s0.6,0.3,0.8,0.5s0.4,0.5,0.5,0.8s0.2,0.6,0.2,1c0,0.4-0.1,0.7-0.2,1   s-0.3,0.6-0.5,0.8S26.3,18.8,26,19S25.4,19.2,25,19.2z"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="Layer_1" class="icon-search" version="1.1" viewBox="0 0 20 20" xml:space="preserve">\r\n    <g>\r\n        <path d="M12.2,1c0.5,0,1.1,0.1,1.6,0.2c0.5,0.1,1,0.3,1.4,0.6s0.8,0.6,1.2,0.9c0.4,0.4,0.7,0.8,0.9,1.2s0.5,0.9,0.6,1.4c0.1,0.5,0.2,1,0.2,1.6s-0.1,1.1-0.2,1.6c-0.1,0.5-0.3,1-0.6,1.4s-0.6,0.8-0.9,1.2c-0.4,0.4-0.8,0.7-1.2,0.9s-0.9,0.5-1.4,0.6c-0.5,0.1-1,0.2-1.6,0.2c-0.7,0-1.4-0.1-2-0.3c-0.6-0.2-1.2-0.6-1.7-1l-6.5,6.5C1.8,17.9,1.7,18,1.5,18s-0.3-0.1-0.4-0.2C1.1,17.7,1,17.6,1,17.5s0.1-0.3,0.2-0.4l6.5-6.5c-0.4-0.5-0.8-1.1-1-1.7s-0.3-1.3-0.3-2c0-0.5,0.1-1.1,0.2-1.6s0.3-1,0.6-1.4S7.7,3.1,8,2.7c0.4-0.4,0.8-0.7,1.2-0.9s0.9-0.5,1.4-0.6C11.1,1.1,11.6,1,12.2,1z M12.2,11.6c0.7,0,1.3-0.1,1.9-0.4s1.1-0.6,1.5-1s0.8-0.9,1-1.5c0.3-0.6,0.4-1.2,0.4-1.9S16.8,5.6,16.6,5c-0.3-0.6-0.6-1.1-1-1.5s-0.9-0.8-1.5-1s-1.2-0.4-1.9-0.4s-1.3,0.1-1.9,0.4S9.2,3,8.8,3.5S8,4.4,7.8,5C7.5,5.6,7.4,6.2,7.4,6.8s0.1,1.3,0.4,1.9c0.3,0.6,0.6,1.1,1,1.5s0.9,0.8,1.5,1S11.5,11.6,12.2,11.6z"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon-download" viewbox="0 0 736 960">\r\n    <path fill-rule="evenodd" d="M736 592c0 26.67-9.33 49.33-28 68L440 927c-10.67 10.67-21.67 18.83-33 24.5-11.33 5.67-24.67 8.5-40 8.5-15.33 0-28.5-3-39.5-9s-21.83-14-32.5-24L28 660c-9.33-8.67-16.33-18.83-21-30.5-4.67-11.67-7-24.17-7-37.5 0-12.67 2.5-24.83 7.5-36.5 5-11.67 11.83-22 20.5-31s18.83-16 30.5-21c11.67-5 24.17-7.5 37.5-7.5 26 0 48.67 9.67 68 29l108 107V96c0-26.67 9.33-49.33 28-68s41.33-28 68-28c12.67 0 24.83 2.5 36.5 7.5 11.67 5 22 11.83 31 20.5s16 18.83 21 30.5c5 11.67 7.5 24.17 7.5 37.5v537l108-109c18.67-18.67 41.33-28 68-28s49.33 9.33 68 28 28 41.33 28 68z"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 110 110">\r\n    <path fill-rule="evenodd" d="M107 89.25c0 1.6-.32 3.1-.95 4.53-.63 1.43-1.5 2.67-2.57 3.73-1.08 1.1-2.33 2-3.73 2.6-1.4.7-2.9 1-4.5 1h-83.5c-1.6 0-3.1-.3-4.5-.9-1.4-.6-2.65-1.5-3.73-2.5S1.58 95.4.95 94C.32 92.5 0 90.98 0 89.4c0-2 .47-3.84 1.4-5.6L43.16 6.2c1.02-1.88 2.46-3.38 4.34-4.5C49.38.55 51.38 0 53.5 0s4.12.56 6 1.68c1.88 1.13 3.32 2.63 4.34 4.5l41.75 77.5c.9 1.75 1.4 3.6 1.4 5.57zm-7.84 0c0-.12-.36-.92-1.1-2.4L95.1 81c-1.25-2.44-2.7-5.3-4.38-8.53-1.68-3.25-3.47-6.7-5.4-10.35-1.9-3.65-3.9-7.42-5.93-11.3l-6.1-11.4-5.7-10.66c-1.8-3.37-3.5-6.38-5-9.03-1.5-2.64-2.7-4.83-3.7-6.54-1-1.7-1.7-2.8-2.1-3.3-.5-.6-1-1.1-1.5-1.5-.6-.4-1.2-.6-2-.6-.7 0-1.4.2-2 .5-.7.4-1.1.9-1.5 1.5-.5.9-1.3 2.4-2.4 4.3-1.1 1.92-2.4 4.3-3.9 7.1l-5.05 9.1-5.5 10.6C31 44.5 29 48.17 27 51.9l-5.8 10.8c-1.84 3.5-3.6 6.8-5.2 9.9l-4.3 8.2c-1.2 2.4-2.17 4.3-2.86 5.8-.7 1.5-1.04 2.4-1.04 2.7 0 1.1.4 2 1.18 2.8.7.8 1.7 1.2 2.7 1.2h83.5c1 0 2-.4 2.7-1.18.7-.77 1.1-1.7 1.1-2.75zm-41.74-19.6h-7.84V30.5h7.84v39.18zm1.96 11.76c0 .8-.17 1.6-.5 2.3-.32.7-.75 1.4-1.28 1.9-.53.6-1.15 1-1.87 1.3-.7.4-1.45.5-2.23.5s-1.52-.1-2.23-.5c-.72-.3-1.34-.7-1.87-1.3s-.96-1.1-1.3-1.8c-.3-.7-.48-1.4-.48-2.2 0-.7.17-1.5.5-2.2.32-.7.75-1.3 1.28-1.8s1.15-.9 1.87-1.22c.7-.34 1.45-.5 2.23-.5s1.52.16 2.23.5c.72.3 1.34.74 1.87 1.27.53.56.96 1.18 1.3 1.9.3.7.48 1.46.48 2.2z"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon-media" viewBox="0 0 20 20">\r\n    <g fill-rule="evenodd">\r\n        <path stroke="none" stroke-width="2" d="M6.67 13c.86 1.8 2.48 3 4.33 3V4C9.15 4 7.53 5.2 6.67 7H5c-1.65 0-3 1.34-3 3 0 1.65 1.34 3 3 3h1.67z"/>\r\n        <g>\r\n            <path d="M13.55 12.2c.7-.6 1.15-1.42 1.15-2.34 0-.92-.44-1.75-1.15-2.32m1.75 6.66c1.3-1.06 2.13-2.6 2.13-4.3 0-1.72-.83-3.26-2.14-4.32"/>\r\n            <path d="M17.3 16.32c1.97-1.6 3.2-3.88 3.2-6.43 0-2.57-1.23-4.87-3.2-6.45"/>\r\n        </g>\r\n        <path d="M20.5.5l-19 19"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon-media" viewBox="0 0 20 20">\r\n    <g fill-rule="evenodd">\r\n        <path stroke="none" stroke-width="2" d="M6.67 13c.86 1.8 2.48 3 4.33 3V4C9.15 4 7.53 5.2 6.67 7H5c-1.65 0-3 1.34-3 3 0 1.65 1.34 3 3 3h1.67z"/>\r\n        <g>\r\n            <path d="M13.55 12.2c.7-.6 1.15-1.42 1.15-2.34 0-.92-.44-1.75-1.15-2.32m1.75 6.66c1.3-1.06 2.13-2.6 2.13-4.3 0-1.72-.83-3.26-2.14-4.32"/>\r\n            <path d="M17.3 16.32c1.97-1.6 3.2-3.88 3.2-6.43 0-2.57-1.23-4.87-3.2-6.45"/>\r\n        </g>\r\n        <path stroke="#CAE2EB" stroke-width="2" d="M16 3L1 18"/>\r\n        <path d="M20.5.5l-19 19"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon-media" viewBox="0 0 25 25">\r\n    <path fill-rule="evenodd" d="M0 12c0-.18.07-.34.2-.47.13-.13.3-.2.47-.2H8c.18 0 .34.07.47.2.13.13.2.3.2.47v7.33c0 .18-.07.34-.2.47-.13.13-.3.2-.47.2-.18 0-.34-.07-.47-.2-.13-.13-.2-.3-.2-.47V13.6L1.8 19.15c-.13.13-.3.2-.47.2-.18 0-.33-.07-.47-.2-.13-.14-.2-.3-.2-.47 0-.18.07-.34.2-.47l5.54-5.5H.65c-.18 0-.34-.07-.47-.2-.14-.13-.2-.3-.2-.47zM10.67.67c0-.18.06-.34.2-.47.13-.13.28-.2.46-.2s.34.07.47.2c.13.13.2.3.2.47V6.4L17.53.85c.13-.13.3-.2.47-.2.18 0 .34.07.47.2.13.14.2.3.2.47 0 .18-.07.34-.2.47l-5.52 5.5h6.38c.18 0 .34.07.47.2.13.13.2.3.2.47 0 .17-.07.33-.2.46s-.3.2-.47.2h-8c-.18 0-.33-.07-.47-.2-.13-.13-.2-.3-.2-.47V.66z"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon-media" viewBox="0 0 25 25">\r\n    <path fill-rule="evenodd" d="M0 11.43c0-.2.07-.36.2-.5.15-.15.32-.22.5-.22.2 0 .38.1.52.26.14.14.2.3.2.5v6.13l5.93-5.93c.15-.14.3-.2.5-.2s.37.06.5.2c.15.14.22.3.22.5s-.07.36-.2.5L2.44 18.6H9.3c.18 0 .35.06.5.2.13.14.2.3.2.5s-.07.36-.2.5c-.15.14-.32.2-.5.2H.7c-.18 0-.35-.06-.5-.2-.13-.14-.2-.3-.2-.5v-7.86zM10.7.7c0-.18.08-.35.23-.5.14-.13.3-.2.5-.2h7.86c.15 0 .32.07.5.2.1.15.2.32.2.5v7.87c0 .2-.1.36-.2.5-.18.15-.35.22-.5.22-.2 0-.4-.1-.55-.26-.14-.14-.2-.3-.2-.5v-6.1l-5.93 5.9c-.15.15-.3.2-.5.2s-.37-.05-.5-.2c-.15-.13-.22-.3-.22-.5s.08-.35.2-.5l5.94-5.92H11.4c-.2 0-.35-.07-.5-.2-.14-.15-.2-.32-.2-.52z"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon-media" viewBox="0 0 20 20">\r\n    <path fill-rule="evenodd" stroke-linejoin="round" d="M1 17l14.97-8L1 1z"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon-media" viewBox="0 0 20 20">\r\n    <g fill-rule="evenodd" stroke="none" stroke-width="2" transform="translate(1 1)">\r\n        <rect width="5" height="14" rx="1"/>\r\n        <rect width="5" height="14" x="9" rx="1"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="Layer_1" width="240px" height="240px" x="0px" y="0px" enable-background="new 0 0 240 240" version="1.1" viewBox="0 0 240 240" xml:space="preserve">\r\n    <rect width="240" height="240" fill="none"/>\r\n    <g>\r\n        <path fill="#FFFFFF" d="M90.938,109.86c7.341,0,13.292-7.52,13.292-16.111s-5.951-15-13.292-15s-13.292,6.409-13.292,15   S83.597,109.86,90.938,109.86z"/>\r\n        <path fill="#FFFFFF" d="M131.25,117.958c10.125,0,18.334-10.384,18.334-22.247s-8.208-20.713-18.334-20.713   s-18.334,8.85-18.334,20.713S121.125,117.958,131.25,117.958z"/>\r\n        <path fill="#FFFFFF" d="M109.007,116.737c-1.729-0.848-3.622-1.322-5.609-1.322c-1.17,0-2.306,0.17-3.397,0.477L100,115.884   c-2.208,0.643-5.597,1.755-9.062,1.753c-3.466,0.001-6.854-1.111-9.062-1.753l-0.001,0.009c-1.091-0.307-2.227-0.477-3.397-0.477   c-8.133,0-14.726,7.835-14.726,17.5v2.405c0,1.893,1.521,3.428,3.398,3.428h18.827C89.45,127.406,98.247,118.815,109.007,116.737z"/>\r\n        <path fill="#FFFFFF" d="M157.244,127.981c-2.664-1.511-5.651-2.357-8.806-2.357c-1.575,0-3.102,0.225-4.571,0.624   c-0.038,0.01-0.076,0.017-0.114,0.028l-0.002-0.012c-2.244,0.647-5.374,1.638-8.777,2.116c-0.059,0.008-0.116,0.02-0.175,0.028   c-0.361,0.049-0.73,0.079-1.096,0.115c-0.221,0.022-0.439,0.053-0.662,0.069c-0.288,0.021-0.58,0.021-0.87,0.033   c-0.307,0.012-0.612,0.034-0.919,0.034h-0.001h-0.001c-0.31,0-0.617-0.022-0.926-0.034c-0.288-0.011-0.578-0.011-0.864-0.032   c-0.334-0.024-0.662-0.068-0.992-0.104c-0.254-0.028-0.512-0.046-0.763-0.08c-3.473-0.468-6.672-1.487-8.956-2.144l-0.002,0.012   c-1.505-0.419-3.071-0.652-4.685-0.652c-11.218,0-20.312,10.703-20.312,23.906v3.285c0,2.586,2.098,4.683,4.687,4.683h0.001h65.624   h0.001h0.001c2.589,0,4.687-2.097,4.687-4.683v-3.285C168.75,140.04,164.052,131.842,157.244,127.981z"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12">\r\n    <path fill="#949494" d="M12 6c0-.6 0-1-.2-1.6L11.2 3c-.3-.5-.6-1-1-1.2-.3-.4-.7-.7-1.2-1L7.6.2 6 0c-.6 0-1 0-1.6.2L3 .8c-.5.3-1 .6-1.2 1-.4.3-.7.7-1 1.2L.2 4.4 0 6c0 .6 0 1 .2 1.6L.8 9c.3.5.6 1 1 1.2.3.4.7.7 1.2 1l1.4.6L6 12c.6 0 1 0 1.6-.2l1.4-.6c.5-.3 1-.6 1.2-1 .4-.3.7-.7 1-1.2l.6-1.4L12 6zm-1.4 2.4l-.6 1-.8.6c-.2.3-.5.5-.8.6l-1 .4.5-1.3V8.4h2.3zm-3.2 0v.4l-.2.6-.3.6-.6.6c0 .2-.2.3-.3.4l-.3.2s-.4 0-.5-.2l-.3-.4V10c0-.2 0-.4-.3-.6v-.6l-.2-.4h2.8zM11.2 6c0 .5 0 1-.3 1.6H8V4.4h3V6zm-6.6 5c-.3 0-.6-.2-1-.4-.3 0-.6-.3-1-.6 0-.2-.4-.4-.6-.7l-.6-1h2.4c0 .6.2 1 .3 1.4L5 11zm3-5v1.6h-3l-.2-.8V4.4h3l.2.8V6zm3-2.4H8.2c0-.5-.2-1-.3-1.3L7 1c.3 0 .6.2 1 .4.3 0 .6.3.8.6l1 .7.5 1zm-7 4H1v-.8C.7 6.5.7 6.3.7 6v-.8c0-.3.2-.6.3-.8h2.7v3.2zm3.8-4H4.6v-.4l.2-.6L5 2l.3-.6c0-.2.2-.3.3-.4L6 .8s.3 0 .4.2l.3.4.3.6c0 .2 0 .4.2.6v.6l.2.4zM4.6 1L4 2.3v1.3H1.4l.6-1 .7-.6c.3-.3.6-.5 1-.6l1-.4z"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="17" class="icon-action" viewBox="0 0 24 24">\r\n    <path d="M8,17H4a2.92,2.92,0,0,1-1.17-.23,3,3,0,0,1-1.6-1.6A2.92,2.92,0,0,1,1,14v-4a2.92,2.92,0,0,1,.23-1.17,3,3,0,0,1,1.6-1.6A2.92,2.92,0,0,1,4,6.95H8a2.92,2.92,0,0,1,1.17.23,3,3,0,0,1,1.6,1.6A2.92,2.92,0,0,1,11,9.95H9A1,1,0,0,0,8,9H4a1,1,0,0,0-1,1v4a1,1,0,0,0,1,1H8a1,1,0,0,0,1-1h2a2.92,2.92,0,0,1-.23,1.17,3,3,0,0,1-1.6,1.6A2.92,2.92,0,0,1,8,17Zm-2-4H18V11H6Zm14,4H16a2.92,2.92,0,0,1-1.17-.23,3,3,0,0,1-1.6-1.6A2.92,2.92,0,0,1,13,14h2a1,1,0,0,0,1,1h4a1,1,0,0,0,1-1v-4a1,1,0,0,0-1-1H16a1,1,0,0,0-1,1H13a2.92,2.92,0,0,1,.23-1.17,3,3,0,0,1,1.6-1.6A2.92,2.92,0,0,1,16,6.95h4a2.92,2.92,0,0,1,1.17.23,3,3,0,0,1,1.6,1.6A2.92,2.92,0,0,1,23,9.95v4a2.92,2.92,0,0,1-.23,1.17,3,3,0,0,1-1.6,1.6A2.92,2.92,0,0,1,20,17Z" class="cls-1"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 220 180">\r\n    <path d="M896 1152 Q817 1152 747 1182 Q677 1212 624.5 1264.5 Q572 1317 542 1387 Q512 1457 512 1536 Q512 1616 542 1685.5 Q572 1755 624.5 1807.5 Q677 1860 747 1890 Q817 1920 896 1920 Q976 1920 1045.5 1890 Q1115 1860 1167.5 1807.5 Q1220 1755 1250 1685.5 Q1280 1616 1280 1536 Q1280 1457 1250 1387 Q1220 1317 1167.5 1264.5 Q1115 1212 1045.5 1182 Q976 1152 896 1152 Z M896 1792 Q843 1792 796.5 1772 Q750 1752 715 1717 Q680 1682 660 1635.5 Q640 1589 640 1536 Q640 1483 660 1436.5 Q680 1390 715 1355 Q750 1320 796.5 1300 Q843 1280 896 1280 Q949 1280 995.5 1300 Q1042 1320 1077 1355 Q1112 1390 1132 1436.5 Q1152 1483 1152 1536 Q1152 1589 1132 1635.5 Q1112 1682 1077 1717 Q1042 1752 995.5 1772 Q949 1792 896 1792 Z M2005 1792 L2005 1664 L1792 1664 L1792 1451 L1664 1451 L1664 1664 L1451 1664 L1451 1792 L1664 1792 L1664 2005 L1792 2005 L1792 1792 L2005 1792 Z M896 1024 Q1051 1024 1189 971 Q1327 918 1435 824.5 Q1543 731 1612.5 603.5 Q1682 476 1700 327 L1708 256 L84 256 L93 327 Q110 476 180 603.5 Q250 731 357.5 824.5 Q465 918 603.5 971 Q742 1024 896 1024 Z M232 384 L1560 384 Q1534 495 1472 589 Q1410 683 1322.5 751 Q1235 819 1125.5 857.5 Q1016 896 896 896 Q776 896 666.5 857.5 Q557 819 469.5 751 Q382 683 320 589 Q258 495 232 384 Z" transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 220 180">\r\n    <path d="M1810 1749 L1989 1570 L1928 1510 L1749 1689 L1566 1506 L1506 1566 L1689 1749 L1506 1932 L1566 1993 L1749 1810 L1932 1993 L1993 1932 L1810 1749 Z M341 256 Q341 350 365.5 437.5 Q390 525 434.5 601 Q479 677 541 739 Q603 801 679 845.5 Q755 890 842.5 914.5 Q930 939 1024 939 Q1118 939 1205.5 914.5 Q1293 890 1369 845.5 Q1445 801 1507 739 Q1569 677 1613.5 601 Q1658 525 1682.5 437.5 Q1707 350 1707 256 L1536 256 Q1536 362 1496 455.5 Q1456 549 1386.5 618.5 Q1317 688 1223.5 728 Q1130 768 1024 768 Q918 768 824.5 728 Q731 688 661.5 618.5 Q592 549 552 455.5 Q512 362 512 256 L341 256 Z M853 1365 Q853 1400 866.5 1431 Q880 1462 903 1485.5 Q926 1509 957.5 1522.5 Q989 1536 1024 1536 Q1059 1536 1090 1522.5 Q1121 1509 1144.5 1485.5 Q1168 1462 1181.5 1431 Q1195 1400 1195 1365 Q1195 1330 1181.5 1299 Q1168 1268 1144.5 1245 Q1121 1222 1090 1208.5 Q1059 1195 1024 1195 Q989 1195 957.5 1208.5 Q926 1222 903 1245 Q880 1268 866.5 1299 Q853 1330 853 1365 Z M683 1365 Q683 1294 709.5 1232 Q736 1170 782.5 1124 Q829 1078 891 1051 Q953 1024 1024 1024 Q1094 1024 1156.5 1051 Q1219 1078 1265 1124 Q1311 1170 1338 1232 Q1365 1294 1365 1365 Q1365 1435 1338.5 1497.5 Q1312 1560 1265.5 1606.5 Q1219 1653 1157 1680 Q1095 1707 1024 1707 Q953 1707 891 1680 Q829 1653 783 1606.5 Q737 1560 710 1498 Q683 1436 683 1365 Z " transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 200 200">\r\n    <path d="M1024 1152 Q945 1152 875 1182 Q805 1212 752.5 1264.5 Q700 1317 670 1387 Q640 1457 640 1536 Q640 1616 670 1685.5 Q700 1755 752.5 1807.5 Q805 1860 875 1890 Q945 1920 1024 1920 Q1104 1920 1173.5 1890 Q1243 1860 1295.5 1807.5 Q1348 1755 1378 1685.5 Q1408 1616 1408 1536 Q1408 1457 1378 1387 Q1348 1317 1295.5 1264.5 Q1243 1212 1173.5 1182 Q1104 1152 1024 1152 Z M1024 1792 Q971 1792 924.5 1772 Q878 1752 843 1717 Q808 1682 788 1635.5 Q768 1589 768 1536 Q768 1483 788 1436.5 Q808 1390 843 1355 Q878 1320 924.5 1300 Q971 1280 1024 1280 Q1077 1280 1123.5 1300 Q1170 1320 1205 1355 Q1240 1390 1260 1436.5 Q1280 1483 1280 1536 Q1280 1589 1260 1635.5 Q1240 1682 1205 1717 Q1170 1752 1123.5 1772 Q1077 1792 1024 1792 Z M1828 327 L1836 256 L212 256 L221 327 Q238 476 308 603.5 Q378 731 485.5 824.5 Q593 918 731.5 971 Q870 1024 1024 1024 Q1179 1024 1317 971 Q1455 918 1563 824.5 Q1671 731 1740.5 603.5 Q1810 476 1828 327 Z M360 384 L1688 384 Q1662 495 1600 589 Q1538 683 1450.5 751 Q1363 819 1253.5 857.5 Q1144 896 1024 896 Q904 896 794.5 857.5 Q685 819 597.5 751 Q510 683 448 589 Q386 495 360 384 Z" transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 200 170">\r\n    <path d="M846 392 Q813 392 787 416 L282 898 L400 1021 L840 602 L1641 1557 L1772 1447 L912 423 Q889 395 851 392 L846 392 Z " transform="scale(0.1, -0.1) translate(0, -1800)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-cancel" viewBox="0 0 2048 2048">\r\n    <path d="M1115 1024 L1658 1567 Q1677 1586 1677 1612.5 Q1677 1639 1658 1658 Q1639 1676 1612 1676 Q1587 1676 1567 1658 L1024 1115 L481 1658 Q462 1676 436 1676 Q410 1676 390 1658 Q371 1639 371 1612.5 Q371 1586 390 1567 L934 1024 L390 481 Q371 462 371 435.5 Q371 409 390 390 Q410 372 436 372 Q462 372 481 390 L1024 934 L1567 390 Q1587 372 1612 372 Q1639 372 1658 390 Q1677 409 1677 435.5 Q1677 462 1658 481 L1115 1024 Z "/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 230 180">\r\n    <path d="M128 895 L113 895 Q90 895 69.5 904 Q49 913 33.5 928.5 Q18 944 9 964.5 Q0 985 0 1008 L0 1123 Q0 1146 9 1166.5 Q18 1187 33.5 1202.5 Q49 1218 69.5 1227 Q90 1236 113 1236 L128 1236 L128 1276 Q128 1303 138 1326.5 Q148 1350 166 1368 Q184 1386 207.5 1396 Q231 1406 258 1406 L765 1406 Q794 1406 818 1394 Q853 1398 918 1406 Q983 1414 1064 1428 L912 1276 Q907 1275 903 1274.5 Q899 1274 895 1274 L895 1259 L767 1131 L767 1278 L256 1278 L256 767 L403 767 L275 639 L258 639 Q231 639 207.5 649.5 Q184 660 166 677.5 Q148 695 138 718.5 Q128 742 128 769 L128 895 Z M1854 1726 Q1880 1726 1899 1707 Q1918 1688 1918 1662 L1918 469 Q1918 442 1899 423.5 Q1880 405 1854 405 L1761 405 Q1740 405 1723 417 Q1722 418 1695.5 434.5 Q1669 451 1617 476 Q1565 501 1487.5 530 Q1410 559 1307 584 Q1204 609 1076 626 Q948 643 795 643 Q788 641 781.5 640.5 Q775 640 767 639 L767 390 Q767 362 756.5 337.5 Q746 313 727.5 295 Q709 277 684.5 266.5 Q660 256 632 256 L518 256 Q474 256 440 281 Q406 306 392 344 L130 83 L40 173 L1915 2048 L2005 1958 L1774 1726 L1854 1726 Z M632 384 Q639 384 639 390 L639 591 L511 464 L511 390 Q511 384 518 384 L632 384 Z M1790 533 L1790 1598 Q1727 1530 1635.5 1480 Q1544 1430 1441 1393 L895 847 L895 769 Q1089 761 1241 730 Q1393 699 1504 661 Q1615 623 1684 587 Q1753 551 1781 533 L1790 533 Z" transform="scale(0.1, -0.1) translate(0, -1800)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 200 200">\r\n    <path d="M1691 1420 L1421 1690 L578 847 L849 577 L1691 1420 Z M431 430 L788 517 L519 786 L431 430 Z M1848 1504 Q1866 1486 1875 1464.5 Q1884 1443 1884 1420.5 Q1884 1398 1876 1376.5 Q1868 1355 1851 1339 L876 364 L281 217 Q246 209 228 227 Q210 245 218 280 L365 875 L1340 1850 Q1357 1867 1378.5 1875 Q1400 1883 1422.5 1882.5 Q1445 1882 1466.5 1873 Q1488 1864 1505 1847 L1848 1504 L1848 1504 Z " transform="scale(0.1, -0.1) translate(0, -1800)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 200 200">\r\n    <path d="M512 341 L1536 341 L1536 1280 L512 1280 L512 341 Z M341 1451 L1707 1451 L1707 257 Q1707 221 1682 196 Q1657 171 1621 171 L427 171 Q409 171 393.5 177.5 Q378 184 366.5 196 Q355 208 348 223.5 Q341 239 341 257 L341 1451 Z M1195 1109 L1280 1109 L1280 512 L1195 512 L1195 1109 Z M768 1109 L853 1109 L853 512 L768 512 L768 1109 Z M1877 1707 L1877 1621 L171 1621 L171 1707 L683 1707 L683 1792 Q683 1827 708 1852 Q733 1877 768 1877 L1280 1877 Q1315 1877 1340 1852 Q1365 1827 1365 1792 L1365 1707 L1877 1707 Z " transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 200 200">\r\n    <path d="M1501 1536 Q1535 1536 1564.5 1523 Q1594 1510 1616 1488 Q1638 1466 1651 1436.5 Q1664 1407 1664 1373 L1664 163 Q1664 129 1651 99.5 Q1638 70 1616 48 Q1594 26 1564.5 13 Q1535 0 1501 0 L547 0 Q513 0 483.5 13 Q454 26 432 48 Q410 70 397 99.5 Q384 129 384 163 L384 1373 Q384 1407 397 1436.5 Q410 1466 432 1488 Q454 1510 483.5 1523 Q513 1536 547 1536 L1501 1536 Z M1536 163 L1536 1373 Q1536 1387 1525.5 1397.5 Q1515 1408 1501 1408 L547 1408 Q533 1408 522.5 1397.5 Q512 1387 512 1373 L512 163 Q512 149 522.5 138.5 Q533 128 547 128 L1501 128 Q1515 128 1525.5 138.5 Q1536 149 1536 163 Z M832 1152 Q858 1152 877 1133 Q896 1114 896 1088 L896 448 Q896 422 877 403 Q858 384 832 384 Q806 384 787 403 Q768 422 768 448 L768 1088 Q768 1114 787 1133 Q806 1152 832 1152 Z M1216 1152 Q1242 1152 1261 1133 Q1280 1114 1280 1088 L1280 448 Q1280 422 1261 403 Q1242 384 1216 384 Q1190 384 1171 403 Q1152 422 1152 448 L1152 1088 Q1152 1114 1171 1133 Q1190 1152 1216 1152 Z M1643 1792 Q1669 1792 1688 1773 Q1707 1754 1707 1728 Q1707 1702 1688 1683 Q1669 1664 1643 1664 L405 1664 Q379 1664 360 1683 Q341 1702 341 1728 Q341 1754 360 1773 Q379 1792 405 1792 L729 1792 Q737 1846 763 1893 Q789 1940 828 1974.5 Q867 2009 917.5 2028.5 Q968 2048 1024 2048 Q1080 2048 1130.5 2028.5 Q1181 2009 1220 1974.5 Q1259 1940 1285 1893 Q1311 1846 1319 1792 L1643 1792 Z M859 1792 L1189 1792 Q1182 1820 1166.5 1843.5 Q1151 1867 1129 1884 Q1107 1901 1080.5 1910.5 Q1054 1920 1024 1920 Q994 1920 967.5 1910.5 Q941 1901 919 1884 Q897 1867 881.5 1843.5 Q866 1820 859 1792 Z " transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 200 200">\r\n    <path d="M1856 1344 Q1856 1318 1837 1299 Q1818 1280 1792 1280 L1409 1280 L1354 896 L1728 896 Q1754 896 1773 877 Q1792 858 1792 832 Q1792 806 1773 787 Q1754 768 1728 768 L1335 768 L1279 375 Q1276 352 1257.5 336 Q1239 320 1216 320 Q1190 320 1171 339 Q1152 358 1152 384 Q1152 433 1158 481 Q1164 529 1172.5 577 Q1181 625 1190 672.5 Q1199 720 1206 768 L823 768 L767 375 Q764 352 745.5 336 Q727 320 704 320 Q678 320 659 339 Q640 358 640 384 Q640 433 646 481 Q652 529 660.5 577 Q669 625 678 672.5 Q687 720 694 768 L320 768 Q294 768 275 787 Q256 806 256 832 Q256 858 275 877 Q294 896 320 896 L713 896 L767 1280 L384 1280 Q358 1280 339 1299 Q320 1318 320 1344 Q320 1370 339 1389 Q358 1408 384 1408 L786 1408 L833 1737 Q836 1760 854.5 1776 Q873 1792 896 1792 Q922 1792 941 1773 Q960 1754 960 1728 Q960 1687 955 1647 Q950 1607 943 1567.5 Q936 1528 928.5 1488 Q921 1448 915 1408 L1298 1408 L1345 1737 Q1348 1760 1366.5 1776 Q1385 1792 1408 1792 Q1434 1792 1453 1773 Q1472 1754 1472 1728 Q1472 1687 1467 1647 Q1462 1607 1455 1567.5 Q1448 1528 1440.5 1488 Q1433 1448 1427 1408 L1792 1408 Q1818 1408 1837 1389 Q1856 1370 1856 1344 Z M1279 1280 L897 1280 L842 896 L1225 896 L1279 1280 Z " transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon audiocall" viewBox="0 0 200 200">\r\n    <path d="M1495 112 Q1467 112 1437 120 Q1180 195 969 346.5 Q758 498 604 718 Q450 938 380 1188 Q310 1438 327 1705 Q331 1761 361.5 1806 Q392 1851 443 1874 L552 1923 Q599 1944 646 1944 Q709 1944 765 1911 Q821 1878 851 1818 L895 1731 Q921 1681 938.5 1622 Q956 1563 958 1503 Q960 1443 943 1386.5 Q926 1330 881 1285 L807 1210 Q790 1193 788 1168 Q786 1143 800 1123 L1052 763 Q1062 749 1076.5 741.5 Q1091 734 1108 734 Q1123 734 1136 740 L1229 783 Q1258 794 1283.5 798.5 Q1309 803 1335 803 Q1382 803 1427.5 789.5 Q1473 776 1514 754 Q1555 732 1591 703.5 Q1627 675 1655 645 L1722 574 Q1754 540 1769.5 498.5 Q1785 457 1784.5 414.5 Q1784 372 1767.5 330.5 Q1751 289 1719 256 L1635 171 Q1607 142 1570.5 127 Q1534 112 1495 112 Z M709 791 Q850 590 1044 451 Q1238 312 1473 243 Q1484 240 1495 240 Q1524 240 1544 260 L1627 346 Q1656 375 1656.5 416 Q1657 457 1629 486 L1562 558 Q1540 582 1513 603 Q1486 624 1456.5 640 Q1427 656 1396 665.5 Q1365 675 1335 675 Q1306 675 1280 665 L1190 624 Q1150 606 1108 606 Q1060 606 1018 627.5 Q976 649 947 689 L695 1050 Q674 1079 665.5 1112.5 Q657 1146 660 1179 Q663 1212 677 1243.5 Q691 1275 716 1300 L788 1373 Q815 1400 823.5 1437.5 Q832 1475 828.5 1516 Q825 1557 811.5 1598 Q798 1639 781 1673 L737 1760 Q723 1786 699 1801 Q675 1816 646 1816 Q625 1816 605 1807 L495 1757 Q478 1749 467.5 1733 Q457 1717 455 1697 Q439 1452 503.5 1222.5 Q568 993 709 791 Z" transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon audiocall" viewBox="0 0 200 200">\r\n    <path d="M1766 640 Q1758 640 1750.5 640.5 Q1743 641 1735 642 L1645 655 Q1596 662 1543 679.5 Q1490 697 1442.5 727 Q1395 757 1358.5 799.5 Q1322 842 1307 899 L1289 995 Q1285 1015 1268.5 1028 Q1252 1041 1230 1041 L818 1041 Q796 1041 779.5 1028 Q763 1015 759 995 L742 904 Q731 845 696.5 801.5 Q662 758 614.5 728 Q567 698 511.5 680 Q456 662 404 655 L313 642 Q305 641 297.5 640.5 Q290 640 282 640 Q243 640 207.5 653 Q172 666 143 689 Q114 712 94.5 744 Q75 776 67 814 L46 920 Q36 971 55 1019.5 Q74 1068 116 1100 Q312 1252 542 1330 Q772 1408 1024 1408 Q1276 1408 1506 1330 Q1736 1252 1932 1100 Q1974 1068 1993 1019.5 Q2012 971 2002 920 L1981 814 Q1974 776 1954 744 Q1934 712 1905 689 Q1876 666 1840.5 653 Q1805 640 1766 640 Z M1431 930 Q1440 899 1463.5 873.5 Q1487 848 1519 829.5 Q1551 811 1588 798.5 Q1625 786 1662 781 L1753 769 Q1756 768 1759.5 768 Q1763 768 1766 768 Q1799 768 1824 787.5 Q1849 807 1856 838 L1876 945 Q1882 977 1854 999 Q1674 1138 1464 1209 Q1254 1280 1024 1280 Q794 1280 584 1209 Q374 1138 194 999 Q166 977 172 945 L192 838 Q199 807 224 787.5 Q249 768 282 768 Q285 768 288.5 768 Q292 768 295 769 L386 781 Q421 786 459 797 Q497 808 530 826.5 Q563 845 587 871 Q611 897 617 931 L633 1018 Q639 1051 656 1078.5 Q673 1106 697.5 1126.5 Q722 1147 753 1158 Q784 1169 818 1169 L1230 1169 Q1264 1169 1295 1158 Q1326 1147 1350.5 1126.5 Q1375 1106 1392 1078.5 Q1409 1051 1415 1018 L1431 930 Z " transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon audiocall" viewBox="0 0 200 200">\r\n    <path d="M2048 1472 L2048 619 Q2048 592 2029 573.5 Q2010 555 1984 555 Q1957 555 1938 574 L1650 869 Q1614 905 1596.5 951.5 Q1579 998 1579 1046 Q1579 1094 1596.5 1140 Q1614 1186 1650 1222 L1938 1517 Q1959 1536 1984 1536 Q2010 1536 2029 1517 Q2048 1498 2048 1472 Z M1920 776 L1920 1315 L1742 1133 Q1724 1115 1715.5 1092 Q1707 1069 1707 1045.5 Q1707 1022 1715.5 999 Q1724 976 1742 958 L1920 776 Z M1335 1664 Q1377 1664 1413.5 1648 Q1450 1632 1477 1605 Q1504 1578 1520 1541.5 Q1536 1505 1536 1463 L1536 585 Q1536 543 1520 506.5 Q1504 470 1477 443 Q1450 416 1413.5 400 Q1377 384 1335 384 L329 384 Q287 384 250.5 400 Q214 416 187 443 Q160 470 144 506.5 Q128 543 128 585 L128 1463 Q128 1505 144 1541.5 Q160 1578 187 1605 Q214 1632 250.5 1648 Q287 1664 329 1664 L1335 1664 Z M1408 585 L1408 1463 Q1408 1493 1386.5 1514.5 Q1365 1536 1335 1536 L329 1536 Q299 1536 277.5 1514.5 Q256 1493 256 1463 L256 585 Q256 555 277.5 533.5 Q299 512 329 512 L1335 512 Q1365 512 1386.5 533.5 Q1408 555 1408 585 Z " transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon logo" viewBox="0 0 200 200">\r\n    <path d="M1933 623 Q1933 519 1892.5 426.5 Q1852 334 1783 265 Q1714 196 1621.5 155.5 Q1529 115 1425 115 Q1360 115 1298 131 Q1236 147 1179 179 Q1100 165 1024 165 Q906 165 796.5 196 Q687 227 591.5 283 Q496 339 417.5 417.5 Q339 496 283 591.5 Q227 687 196 796.5 Q165 906 165 1024 Q165 1100 179 1179 Q147 1236 131 1298 Q115 1360 115 1425 Q115 1529 155.5 1621.5 Q196 1714 265 1783 Q334 1852 426.5 1892.5 Q519 1933 623 1933 Q688 1933 750 1917 Q812 1901 869 1869 Q948 1883 1024 1883 Q1142 1883 1251.5 1852 Q1361 1821 1456.5 1765 Q1552 1709 1630.5 1630.5 Q1709 1552 1765 1456.5 Q1821 1361 1852 1251.5 Q1883 1142 1883 1024 Q1883 948 1869 869 Q1901 812 1917 750 Q1933 688 1933 623 Z M1462 807 Q1462 885 1434.5 938.5 Q1407 992 1362 1027 Q1317 1062 1259.5 1083 Q1202 1104 1141.5 1118 Q1081 1132 1023.5 1142.5 Q966 1153 921 1167.5 Q876 1182 848.5 1204.5 Q821 1227 821 1264 Q821 1298 837.5 1321.5 Q854 1345 879.5 1359.5 Q905 1374 935.5 1380.5 Q966 1387 994 1387 Q1044 1387 1080 1375.5 Q1116 1364 1143 1347 Q1170 1330 1190.5 1309.5 Q1211 1289 1229.5 1272 Q1248 1255 1266.5 1243.5 Q1285 1232 1309 1232 Q1329 1232 1349 1238.5 Q1369 1245 1384.5 1257 Q1400 1269 1409.5 1286.5 Q1419 1304 1419 1326 Q1419 1368 1398 1402 Q1377 1436 1342.5 1463 Q1308 1490 1264.5 1510 Q1221 1530 1175.5 1543 Q1130 1556 1086.5 1562.5 Q1043 1569 1010 1569 Q936 1569 861 1552 Q786 1535 725.5 1497 Q665 1459 627 1398.5 Q589 1338 589 1251 Q589 1175 616 1124 Q643 1073 687.5 1039 Q732 1005 789 985 Q846 965 905 950.5 Q964 936 1021 924.5 Q1078 913 1122.5 896.5 Q1167 880 1194 855 Q1221 830 1221 790 Q1221 754 1202 728 Q1183 702 1154.5 685.5 Q1126 669 1092 661 Q1058 653 1028 653 Q972 653 933 667 Q894 681 866 702 Q838 723 817.5 747 Q797 771 778 792 Q759 813 738 827 Q717 841 688 841 Q667 841 649 833.5 Q631 826 617 812.5 Q603 799 595 781 Q587 763 587 742 Q587 692 609 653 Q631 614 666.5 585 Q702 556 748.5 536 Q795 516 844 503.5 Q893 491 941 485.5 Q989 480 1028 480 Q1106 480 1183.5 497 Q1261 514 1323 552.5 Q1385 591 1423.5 653.5 Q1462 716 1462 807 Z " transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon chevron" viewBox="0 0 200 200">\r\n    <path d="M1024 479 Q1007 479 991.5 485 Q976 491 964 504 L240 1228 L360 1349 L1024 685 L1688 1349 L1808 1228 L1084 504 Q1072 491 1056.5 485 Q1041 479 1024 479 Z " transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200">\r\n    <path d="M1792 1366 Q1792 1401 1778.5 1432 Q1765 1463 1741.5 1486 Q1718 1509 1687 1522.5 Q1656 1536 1620 1536 L428 1536 Q392 1536 361 1522.5 Q330 1509 306.5 1486 Q283 1463 269.5 1432 Q256 1401 256 1366 L256 682 Q256 647 269.5 616 Q283 585 306.5 562 Q330 539 361 525.5 Q392 512 428 512 L1792 512 L1792 1366 Z M1621 1707 Q1691 1707 1753.5 1680 Q1816 1653 1862.5 1607 Q1909 1561 1936 1498.5 Q1963 1436 1963 1366 L1963 341 L427 341 Q356 341 294 368 Q232 395 185.5 441 Q139 487 112 549 Q85 611 85 682 L85 1366 Q85 1436 112 1498.5 Q139 1561 185.5 1607 Q232 1653 294 1680 Q356 1707 427 1707 L1621 1707 L1621 1707 Z M512 939 L1024 939 L1024 853 L512 853 L512 939 Z M512 1195 L1536 1195 L1536 1109 L512 1109 L512 1195 Z " transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" height="20" class="icon-media" viewBox="0 0 36 36" width="20">\r\n    <g transform="scale(0.03125 0.03125)">\r\n        <path fill="rgb(0, 175, 240)" d="M719.53 831.53c-12.286 0-24.566-4.686-33.942-14.056-18.744-18.744-18.744-49.136 0-67.882 131.006-131.006 131.006-344.17 0-475.176-18.744-18.746-18.744-49.138 0-67.882 18.744-18.742 49.138-18.744 67.882 0 81.594 81.59 126.53 190.074 126.53 305.466 0 115.39-44.936 223.876-126.53 305.47-9.372 9.374-21.656 14.060-33.94 14.060v0zM549.020 741.020c-12.286 0-24.566-4.686-33.942-14.058-18.746-18.746-18.746-49.134 0-67.88 81.1-81.1 81.1-213.058 0-294.156-18.746-18.746-18.746-49.138 0-67.882s49.136-18.744 67.882 0c118.53 118.53 118.53 311.392 0 429.922-9.372 9.368-21.656 14.054-33.94 14.054z"/>\r\n        <path fill="rgb(0, 175, 240)" d="M416.006 960c-8.328 0-16.512-3.25-22.634-9.374l-246.626-246.626h-114.746c-17.672 0-32-14.326-32-32v-320c0-17.672 14.328-32 32-32h114.746l246.626-246.628c9.154-9.154 22.916-11.89 34.874-6.936 11.958 4.952 19.754 16.622 19.754 29.564v832c0 12.944-7.796 24.612-19.754 29.564-3.958 1.64-8.118 2.436-12.24 2.436z"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 230 180">\r\n    <path d="M2048 1024 Q2048 884 2011 753.5 Q1974 623 1907 509 Q1840 395 1746.5 301.5 Q1653 208 1539 141 Q1425 74 1295 37 Q1165 0 1024 0 Q883 0 752.5 37 Q622 74 508.5 140.5 Q395 207 301 301 Q207 395 140.5 508.5 Q74 622 37 752.5 Q0 883 0 1024 Q0 1165 37 1295 Q74 1425 141 1539 Q208 1653 301.5 1746.5 Q395 1840 509 1907 Q623 1974 753.5 2011 Q884 2048 1024 2048 Q1165 2048 1295 2011 Q1425 1974 1539 1907 Q1653 1840 1746.5 1746.5 Q1840 1653 1907 1539 Q1974 1425 2011 1295 Q2048 1165 2048 1024 Z M1518 1663 Q1412 1744 1285 1788 Q1158 1832 1024 1832 Q913 1832 810 1803 Q707 1774 617.5 1721 Q528 1668 454 1594 Q380 1520 327 1430.5 Q274 1341 245 1238 Q216 1135 216 1024 Q216 890 260 763 Q304 636 385 530 L1518 1663 Z M1832 1024 Q1832 1158 1788 1285 Q1744 1412 1663 1518 L530 385 Q636 304 763 260 Q890 216 1024 216 Q1135 216 1238 245 Q1341 274 1430.5 327 Q1520 380 1594 454 Q1668 528 1721 617.5 Q1774 707 1803 810 Q1832 913 1832 1024 Z " transform="scale(0.1, -0.1) translate(0, -1800)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon mutuals" viewBox="0 0 200 200">\r\n    <path d="M576 1280 Q510 1280 452 1305.5 Q394 1331 350.5 1374.5 Q307 1418 281.5 1476 Q256 1534 256 1600 Q256 1666 281.5 1724.5 Q307 1783 350.5 1826.5 Q394 1870 452 1895 Q510 1920 576 1920 Q642 1920 700.5 1895 Q759 1870 802.5 1826.5 Q846 1783 871 1724.5 Q896 1666 896 1600 Q896 1534 871 1476 Q846 1418 802.5 1374.5 Q759 1331 700.5 1305.5 Q642 1280 576 1280 Z M576 1792 Q536 1792 501 1777 Q466 1762 440 1736 Q414 1710 399 1675 Q384 1640 384 1600 Q384 1560 399 1525 Q414 1490 440 1464 Q466 1438 501 1423 Q536 1408 576 1408 Q616 1408 651 1423 Q686 1438 712 1464 Q738 1490 753 1525 Q768 1560 768 1600 Q768 1640 753 1675 Q738 1710 712 1736 Q686 1762 651 1777 Q616 1792 576 1792 Z M1387 1024 Q1321 1024 1262.5 1049.5 Q1204 1075 1160.5 1118.5 Q1117 1162 1092 1220 Q1067 1278 1067 1344 Q1067 1410 1092 1468.5 Q1117 1527 1160.5 1570.5 Q1204 1614 1262.5 1639 Q1321 1664 1387 1664 Q1453 1664 1511.5 1639 Q1570 1614 1613.5 1570.5 Q1657 1527 1682 1468.5 Q1707 1410 1707 1344 Q1707 1278 1682 1220 Q1657 1162 1613.5 1118.5 Q1570 1075 1511.5 1049.5 Q1453 1024 1387 1024 Z M1387 1536 Q1347 1536 1312 1521 Q1277 1506 1251 1480 Q1225 1454 1210 1419 Q1195 1384 1195 1344 Q1195 1304 1210 1269 Q1225 1234 1251 1208 Q1277 1182 1312 1167 Q1347 1152 1387 1152 Q1427 1152 1462 1167 Q1497 1182 1523 1208 Q1549 1234 1564 1269 Q1579 1304 1579 1344 Q1579 1384 1564 1419 Q1549 1454 1523 1480 Q1497 1506 1462 1521 Q1427 1536 1387 1536 Z M587 1152 Q676 1152 754.5 1118 Q833 1084 892 1025 Q951 966 986.5 886.5 Q1022 807 1024 717 L1024 128 L128 128 L128 706 Q128 798 162.5 879.5 Q197 961 256 1021.5 Q315 1082 395 1117 Q475 1152 565 1152 L587 1152 Z M896 256 L896 706 Q896 772 871.5 829.5 Q847 887 805 930.5 Q763 974 707 999 Q651 1024 587 1024 L565 1024 Q501 1024 445 999 Q389 974 347 930.5 Q305 887 280.5 829.5 Q256 772 256 706 L256 256 L896 256 Z M1398 896 Q1488 896 1568 861.5 Q1648 827 1707 768 Q1766 709 1800.5 629 Q1835 549 1835 459 L1835 128 L1152 128 L1152 256 L1707 256 L1707 459 Q1707 523 1682.5 579 Q1658 635 1616 677 Q1574 719 1518 743.5 Q1462 768 1398 768 L1376 768 Q1310 768 1252 742 Q1194 716 1152 671 L1152 834 Q1202 863 1258 879.5 Q1314 896 1376 896 L1398 896 Z" transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200">\r\n    <path d="M2048 1087 L1087 1087 L1087 2048 L2048 2048 L2048 1087 Z M961 1087 L0 1087 L0 2048 L961 2048 L961 1087 Z M2048 0 L1087 0 L1087 961 L2048 961 L2048 0 Z M961 0 L0 0 L0 961 L961 961 L961 0 Z " transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="icon audio">\r\n    <path fill="#FFF" fill-rule="nonzero" d="M8.8 15.3c1.4 1.4 3.2 2 5 2l2.8-2.7c.3-.4 1-.4 1.4 0l2 2c-3.4 3.6-9 3.6-12.6 0-3.6-3.4-3.6-9 0-12.6l2 2c.5.5.5 1 0 1.5l-2.7 2.8c0 1.8.7 3.6 2 5z"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="icon videoCall">\r\n    <g fill="#FFF" fill-rule="nonzero">\r\n        <path d="M22 7c-2.8 0-5 2.2-5 5s2.2 5 5 5v-2c-1.7 0-3-1.3-3-3s1.3-3 3-3V7zM3 5h12c.6 0 1 .4 1 1v12c0 .6-.4 1-1 1H3c-.6 0-1-.4-1-1V6c0-.6.4-1 1-1zm11 2H4v10h10V7z"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="icon mute">\r\n    <g fill="#000" fill-rule="evenodd">\r\n        <path d="M8 6c0-2.2 1.8-4 4-4s4 1.8 4 4v8c0 2.2-1.8 4-4 4s-4-1.8-4-4V6zm2 0v8c0 1 1 2 2 2s2-1 2-2V6c0-1-1-2-2-2s-2 1-2 2z"/>\r\n        <path fill-rule="nonzero" d="M4 14c0 4.4 3.6 8 8 8s8-3.6 8-8h-2c0 2.7-1.6 6-6 6s-6-3.3-6-6H4z"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="icon unmute">\r\n    <g fill="#000" fill-rule="evenodd">\r\n        <path fill-rule="nonzero" d="M18 14c0 3.3-2.7 6-6 6-2.2 0-4-1-5.2-3l-1.6 1.2c1.5 2.4 4 3.8 6.8 3.8 4.4 0 8-3.6 8-8h-2z"/>\r\n        <path fill-rule="nonzero" d="M21 2L2 21l1 1L22 3"/>\r\n        <path d="M15.8 4.8L14 6.6V6c0-1-1-2-2-2s-2 1-2 2v4.6l-2 2V6c0-2.2 1.8-4 4-4 1.8 0 3.3 1.2 3.8 2.8zm.2 2.6V14c0 2.2-1.8 4-4 4-1.8 0-3.3-1.2-3.8-2.8l1.8-1.8v.6c0 1 1 2 2 2s2-1 2-2V9.4l2-2z"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="icon hangup">\r\n    <path fill="#FFF" fill-rule="nonzero" d="M17 11c-1.3-1.2-3-2-5-2s-3.7.8-5 2v4c0 .6-.4 1-1 1H3c0-5 4-9 9-9s9 4 9 9h-3c-.5 0-1-.5-1-1v-4z"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="white" class="chat" viewBox="0 0 200 200">\r\n    <path d="M1792 1366 Q1792 1401 1778.5 1432 Q1765 1463 1741.5 1486 Q1718 1509 1687 1522.5 Q1656 1536 1620 1536 L428 1536 Q392 1536 361 1522.5 Q330 1509 306.5 1486 Q283 1463 269.5 1432 Q256 1401 256 1366 L256 682 Q256 647 269.5 616 Q283 585 306.5 562 Q330 539 361 525.5 Q392 512 428 512 L1792 512 L1792 1366 Z M1621 1707 Q1691 1707 1753.5 1680 Q1816 1653 1862.5 1607 Q1909 1561 1936 1498.5 Q1963 1436 1963 1366 L1963 341 L427 341 Q356 341 294 368 Q232 395 185.5 441 Q139 487 112 549 Q85 611 85 682 L85 1366 Q85 1436 112 1498.5 Q139 1561 185.5 1607 Q232 1653 294 1680 Q356 1707 427 1707 L1621 1707 L1621 1707 Z M512 939 L1024 939 L1024 853 L512 853 L512 939 Z M512 1195 L1536 1195 L1536 1109 L512 1109 L512 1195 Z " transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="dock" viewBox="0 0 34 34">\r\n    <g fill="white" fill-rule="nonzero">\r\n        <path d="M24.8 9.2c-.1-.1-.3-.3-.5-.4-.2-.1-.4-.1-.7-.1H2c-.2 0-.5 0-.7.1-.1.1-.3.2-.5.4s-.3.3-.4.5c-.1.2-.1.4-.1.7V32c0 .5.2.9.5 1.2.3.3.7.5 1.2.5h21.6c.2 0 .5 0 .7-.1.2-.1.4-.2.5-.4.1-.2.3-.3.4-.5.1-.2.1-.4.1-.7V10.3c0-.2 0-.5-.1-.7-.1-.2-.2-.3-.4-.4zM22 13.7v16.7H3.7V12H22v1.7zM26.9.3h1.7V2h-1.7zM17 .3h1.7V2H17zM20.3.3H22V2h-1.7zM23.6.3h1.7V2h-1.7zM13.7 3.7h1.7v1.7h-1.7zM15.3 2V.3h-.2c-.4 0-.7.1-1 .4-.3.3-.4.6-.4 1V2h1.6zM32 2V.3h-1.7V2H32v1.7h1.7V2M32 5.3h1.7V7H32zM32 8.7h1.7v1.7H32zM32 12h1.7v1.6H32zM32 15.3h1.7V17H32zM28.7 18.7h1.7v1.7h-1.7zM32 18.7v1.7h.2c.4 0 .7-.1 1-.4.3-.3.4-.6.4-1v-.2H32v-.1z"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="undock" viewBox="0 0 24 24">\r\n    <g fill="none" fill-rule="evenodd">\r\n        <path stroke="white" stroke-linecap="square" stroke-width="1" d="M5 5h14M5 19h14M19 5v14M5 5v14"/>\r\n        <path fill="white" stroke="white" stroke-linecap="square" stroke-width="1" d="M12 11h7v7h-7z"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22">\r\n    <path fill="rgba(255,255,255,.8)" d="M19 9.6l-.3-.1-1.9-.3-.4-1a22 22 0 0 1 1-1.4l.1-.3v-.2c-.3-.4-.8-1-1.7-1.8h-.6l-1.4 1.1-1-.4-.3-1.9v-.2H9.7c-.2 0-.3 0-.3.2l-.3 2a6 6 0 0 0-1 .3l-1.4-1-.3-.2-1 .8-1 1v.6l1.1 1.4-.4 1-2 .3h-.1l-.1.3V12.4l.3.1 2 .3.3 1a22 22 0 0 1-1 1.5.4.4 0 0 0 0 .4c.2.4.8 1 1.7 1.8l.2.1h.3l1.4-1.2 1 .4.3 1.9v.2l.3.1h2.4c.2 0 .3 0 .3-.3l.3-2a6 6 0 0 0 1-.3l1.4 1.1.3.1c.1 0 .5-.2 1-.7l1-1.2.1-.2-.1-.3-1.1-1.4.4-1 2-.2.1-.2.1-.2V9.9v-.3M12.8 13c-.5.5-1.2.8-1.9.8s-1.4-.3-1.9-.8-.8-1.2-.8-1.9.3-1.4.8-1.9 1.2-.8 1.9-.8 1.4.3 1.9.8.8 1.2.8 2c0 .6-.3 1.3-.8 1.8"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="enterFullscreen" viewBox="0 0 20 20">\r\n    <path fill="#fff" d="M0 11.43c0-.2.07-.36.2-.5.15-.15.32-.22.5-.22.2 0 .38.1.52.26.14.14.2.3.2.5v6.13l5.93-5.93c.15-.14.3-.2.5-.2s.37.06.5.2c.15.14.22.3.22.5s-.07.36-.2.5L2.44 18.6H9.3c.18 0 .35.06.5.2.13.14.2.3.2.5s-.07.36-.2.5c-.15.14-.32.2-.5.2H.7c-.18 0-.35-.06-.5-.2-.13-.14-.2-.3-.2-.5v-7.86zM10.7.7c0-.18.08-.35.23-.5.14-.13.3-.2.5-.2h7.86c.15 0 .32.07.5.2.1.15.2.32.2.5v7.87c0 .2-.1.36-.2.5-.18.15-.35.22-.5.22-.2 0-.4-.1-.55-.26-.14-.14-.2-.3-.2-.5v-6.1l-5.93 5.9c-.15.15-.3.2-.5.2s-.37-.05-.5-.2c-.15-.13-.22-.3-.22-.5s.08-.35.2-.5l5.94-5.92H11.4c-.2 0-.35-.07-.5-.2-.14-.15-.2-.32-.2-.52z"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="exitFullscreen">\r\n    <g fill="none" fill-rule="evenodd" stroke="white" stroke-width="1">\r\n        <path d="M19 5l-5.5 5.5"/>\r\n        <path stroke-linejoin="round" d="M13 5v6h6"/>\r\n        <g>\r\n            <path d="M5 19l5.5-5.5"/>\r\n            <path stroke-linejoin="round" d="M11 19v-6H5"/>\r\n        </g>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 206 192">\r\n    <path d="M1933 623 Q1933 519 1892.5 426.5 Q1852 334 1783 265 Q1714 196 1621.5 155.5 Q1529 115 1425 115 Q1360 115 1298 131 Q1236 147 1179 179 Q1100 165 1024 165 Q906 165 796.5 196 Q687 227 591.5 283 Q496 339 417.5 417.5 Q339 496 283 591.5 Q227 687 196 796.5 Q165 906 165 1024 Q165 1100 179 1179 Q147 1236 131 1298 Q115 1360 115 1425 Q115 1529 155.5 1621.5 Q196 1714 265 1783 Q334 1852 426.5 1892.5 Q519 1933 623 1933 Q688 1933 750 1917 Q812 1901 869 1869 Q948 1883 1024 1883 Q1142 1883 1251.5 1852 Q1361 1821 1456.5 1765 Q1552 1709 1630.5 1630.5 Q1709 1552 1765 1456.5 Q1821 1361 1852 1251.5 Q1883 1142 1883 1024 Q1883 948 1869 869 Q1901 812 1917 750 Q1933 688 1933 623 Z M1462 807 Q1462 885 1434.5 938.5 Q1407 992 1362 1027 Q1317 1062 1259.5 1083 Q1202 1104 1141.5 1118 Q1081 1132 1023.5 1142.5 Q966 1153 921 1167.5 Q876 1182 848.5 1204.5 Q821 1227 821 1264 Q821 1298 837.5 1321.5 Q854 1345 879.5 1359.5 Q905 1374 935.5 1380.5 Q966 1387 994 1387 Q1044 1387 1080 1375.5 Q1116 1364 1143 1347 Q1170 1330 1190.5 1309.5 Q1211 1289 1229.5 1272 Q1248 1255 1266.5 1243.5 Q1285 1232 1309 1232 Q1329 1232 1349 1238.5 Q1369 1245 1384.5 1257 Q1400 1269 1409.5 1286.5 Q1419 1304 1419 1326 Q1419 1368 1398 1402 Q1377 1436 1342.5 1463 Q1308 1490 1264.5 1510 Q1221 1530 1175.5 1543 Q1130 1556 1086.5 1562.5 Q1043 1569 1010 1569 Q936 1569 861 1552 Q786 1535 725.5 1497 Q665 1459 627 1398.5 Q589 1338 589 1251 Q589 1175 616 1124 Q643 1073 687.5 1039 Q732 1005 789 985 Q846 965 905 950.5 Q964 936 1021 924.5 Q1078 913 1122.5 896.5 Q1167 880 1194 855 Q1221 830 1221 790 Q1221 754 1202 728 Q1183 702 1154.5 685.5 Q1126 669 1092 661 Q1058 653 1028 653 Q972 653 933 667 Q894 681 866 702 Q838 723 817.5 747 Q797 771 778 792 Q759 813 738 827 Q717 841 688 841 Q667 841 649 833.5 Q631 826 617 812.5 Q603 799 595 781 Q587 763 587 742 Q587 692 609 653 Q631 614 666.5 585 Q702 556 748.5 536 Q795 516 844 503.5 Q893 491 941 485.5 Q989 480 1028 480 Q1106 480 1183.5 497 Q1261 514 1323 552.5 Q1385 591 1423.5 653.5 Q1462 716 1462 807 Z" transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 2048 2048">\r\n    <path d="m 128,1192 447,-428 881,900 H 128 Z m 1448,472 -307,-313 204,-203 447,428 v 88 z m -74,-607 q -5,-5 -14,-8.5 -9,-3.5 -16,-3.5 -7,0 -16,4 -9,4 -14,9 L 1210,1290 607,674 q -5,-5 -14,-9 -9,-4 -16,-4 -8,0 -16.5,3.5 Q 552,668 547,673 L 128,1074 V 384 H 1920 V 1458 Z M 0,1792 H 2048 V 256 H 0 Z M 1515,768 q 26,0 45,-19 19,-19 19,-45 0,-26 -19,-45 -19,-19 -45,-19 -27,0 -45.5,19 -18.5,19 -18.5,45 0,26 18.5,45 18.5,19 45.5,19 z"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 2048 2048">\r\n    <path transform="translate(0,2048) scale(1,-1)" d="M1664 192 Q1664 166 1645 147 Q1626 128 1600 128 L448 128 Q422 128 403 147 Q384 166 384 192 L384 1280 L894 1280 L894 1920 L896 1920 L1600 1920 Q1626 1920 1645 1901 Q1664 1882 1664 1856 L1664 192 Z M768 1408 L418 1408 L768 1805 L768 1408 Z M896 2048 Q858 2048 821.5 2034 Q785 2020 757 1989 L312 1481 Q287 1452 271.5 1417.5 Q256 1383 256 1345 L256 192 Q256 152 271 117 Q286 82 312 56 Q338 30 373 15 Q408 0 448 0 L1600 0 Q1640 0 1675 15 Q1710 30 1736 56 Q1762 82 1777 117 Q1792 152 1792 192 L1792 1856 Q1792 1896 1777 1931 Q1762 1966 1736 1992 Q1710 2018 1675 2033 Q1640 2048 1600 2048 L896 2048 Z "/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-star" viewBox="0 0 2048 2048">\r\n    <path transform="translate(0,2048) scale(1,-1)" d="M1950 1230 Q1939 1265 1911.5 1289 Q1884 1313 1847 1318 L1358 1389 L1139 1832 Q1122 1865 1091.5 1884 Q1061 1903 1024 1903 Q987 1903 956.5 1884 Q926 1865 909 1832 L690 1389 L201 1318 Q165 1313 137 1289 Q109 1265 98 1230 Q87 1195 95.5 1160 Q104 1125 130 1099 L484 754 L401 267 Q394 230 408 196.5 Q422 163 452 142 Q484 117 527 117 Q558 117 586 132 L1024 362 L1462 132 Q1491 117 1521 117 Q1563 117 1597 142 Q1626 163 1640 196.5 Q1654 230 1647 267 L1564 754 L1918 1099 Q1944 1125 1953 1160 Q1962 1195 1950 1230 Z "/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="91" height="85" version="1">\r\n\t<path fill-rule="evenodd" d="M17 52v13l11-11v8L11 79V58H0V1h80v23h-6V6H6v46h11zm17-23h57v40H80v15L64 69H34V29zm51 34V35H40v28h27l7 8v-8h11z"/>\r\n</svg>'},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=function(e){function t(t){var n=e.call(this,"visibility_change_qos")||this;return n.action=t?"open":"close",n}return r(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(o.TelemetryPropertyValue.Create("action",this.action)),e.push(o.TelemetryPropertyValue.Create("ttsFromLastActivity",this.getTtsFromLastActivity()+"")),e.push(o.TelemetryPropertyValue.Create("ttsFromSessionStart",this.getTtsFromSessionStart()+"")),e.push(o.TelemetryPropertyValue.Create("actionsNumber",t.actionsNumber+++"")),e.push(o.TelemetryPropertyValue.Create("onStage",this.numberOfVisibleChats)),t.lastChangeTime=Date.now(),e},t.prototype.getTtsFromLastActivity=function(){return t.lastChangeTime?Date.now()-t.lastChangeTime:0},t.prototype.getTtsFromSessionStart=function(){return t.sessionStartTime||(t.sessionStartTime=Date.now()),Date.now()-t.sessionStartTime},t.actionsNumber=0,t.sessionStartTime=Date.now(),t}(n(8).TelemetryEvent);t.VisibilityChangedEvent=s},function(e){e.exports={area_text_insertText:"Type to chat...",search:"Search",search_no_results_found:"No results found",search_results:"{resultscount} RESULTS","_search_results.comment":'{Locked="{resultscount}"}',clear_search_text:"Clear",text_bots:"Bots","_text_bots.comment":"Header for search in bots directory",text_people:"People","_text_people.comment":"Header for search in contacts directory",text_favorites_contacts:"Favorites","_text_favorites_contacts.comment":"Header for Favorites contacts in contact list",text_contacts:"Contacts","_text_contacts.comment":"Header for Contact from Contacts list",text_chats:"Chats",text_all:"All",new_chat_header:"New Chat",new_chat_enter_group_name:"Enter group name...",new_chat_header_select_who_to_chat_with:"SELECT WHO YOU WOULD LIKE TO CHAT WITH",new_chat_header_to:"To:",new_chat_button_confirm_selection:"Done",new_chat_button_remove_selection:"Remove",new_chat_text_start_chat_with:"Start chat with {participant}","_new_chat_text_start_chat_with.comment":'{Locked="{participant}"}',right_now:"Right now",time_minutes_ago:"{minutes} min ago",emoticon_picker_open:"Open Emoticon picker",emoticon_picker_close:"Close Emoticon picker","_area_text_insertText.comment":"Placeholder text in chat input field",area_text_disabled:"Currently unable to chat.","_area_text_disabled.comment":"Text displayed to user in chat input field in case chatting is not possible",action_button_send:"Send","_action_button_send.comment":"? Tooltip for Send (message) button",joinedConversation:"{participant} joined this conversation","_joinedConversation.comment":'System notification in chat {Locked="{participant}"}',unread_messages:"Unread messages","_unread_messages.comment":"System notification in chat about unread messages",wasAdded:"{participant} added {contact} to this conversation","_wasAdded.comment":'System notification in chat {Locked="{participant}"} {Locked="{contact}"}',hasLeftConversation:"{participant} has left this conversation","_hasLeftConversation.comment":'System notification in chat {Locked="{participant}"}  ',wasRemoved:"{participant} has removed {removedParticipant} from this conversation","_wasRemoved.comment":'System notification in chat  {Locked="{participant}"} {Locked="{removedParticipant}"} ',historyClosed:"{participant} has made the chat history visible to everyone","_historyClosed.comment":'System notification in chat {Locked="{participant}"} ',historyDisclosed:"{participant} has hidden the conversation history from new participants","_historyDisclosed.comment":'System notification in chat {Locked="{participant}"} ',joiningEnabled:"{participant} enabled joining this conversation","_joiningEnabled.comment":'System notification in chat {Locked="{participant}"} ',joiningDisabled:"{participant} disabled joining this conversation","_joiningDisabled.comment":'System notification in chat {Locked="{participant}"} ',threadPictureUpdated:"{participant} has changed the conversation picture","_threadPictureUpdated.comment":'System notification in chat {Locked="{participant}"} ',roleUpdated:"{who} updated {whom}'s role to {role}","_roleUpdated.comment":'System notification in chat {Locked="{who}"}{Locked="{whom}"} {Locked="{role}"}  ',topicUpdated:"{participant} has changed the conversation topic to '{topic}'","_topicUpdated.comment":'System notification in chat {Locked="{participant}"} {Locked="{topic}"}',chatBlocked:"Conversation is blocked","_chatBlocked.comment":"System notification in chat",waitingForReply:"You need to wait for {user_name}'s reply to continue chatting.","_waitingForReply.comment":'System notification in chat {Locked="{user_name}"}',ms_service_privacy_agreement:"By chatting below, you agree to the {0}Microsoft services agreement{1} and {2}privacy statement{3}.","_ms_service_privacy_agreement.comment":'terms of use text {Locked="{0}"} {Locked="{1}"} {Locked="{2}"} {Locked="{3}"}',s_title:"Sent you a message","_s_title.comment":"String used for Swift card title in case the card does not have its own",s_card:"Card","_s_card.comment":"Swift card",s_cards:"Cards","_s_cards.comment":"Swift cards",s_vat:"VAT","_s_vat.comment":"VAT in swift cards",s_tax:"Tax","_s_tax.comment":"Tax in swift cards",s_totalPrice:"Total","_s_totalPrice.comment":"Total price in swift cards",s_unsupported:"This card is currently not supported on this version of Skype.","_s_unsupported.comment":"Text displayed when using old version of Skype",s_unsupported_button:"Next","_s_unsupported_button.comment":"Button text displayed when user is using old version of Skype",s_learnMore:"Learn more","_s_learnMore.comment":"Text of the card title displayed when card is unsupported",s_showImageTitle:"Enlarge image","_s_showImageTitle.comment":"Some of pictures in swift cards can be enlarged upon clicking on them. This is a tooltip text for such pictures.",s_signInTitle:"Connect","_s_signInTitle.comment":"Text of the card title displayed for Sign in cards",s_prevCard:"Show previous","_s_prevCard.comment":"Button tooltip for showing previous card in Carousel cards",s_nextCard:"Show next","_s_nextCard.comment":"Button tooltip for showing next card in Carousel cards",s_showAll:"Show all","_s_showAll.comment":"Button text for showing all cards",s_showLess:"Show less","_s_showLess.comment":"Button text for showing less cards",mediaPlayer_play:"Play","_mediaPlayer_play.comment":"Play button in swift media",mediaPlayer_pause:"Pause","_mediaPlayer_pause.comment":"Pause button in swift media",videoPlayer_fullscreen:"Fullscreen","_videoPlayer_fullscreen.comment":"Tooltip on the button to switch to Fullscreen mode on swift card video player",videoPlayer_exitFullscreen:"Exit fullscreen","_videoPlayer_ExitFullscreen.comment":"Tooltip on the button to exit Fullscreen mode on swift card video player",videoPlayer_button_mute:"Mute","_videoPlayer_button_mute.comment":"Tooltip on the button to mute on swift card video player",videoPlayer_button_unmute:"Unmute","_videoPlayer_button_unmute.comment":"Tooltip on the button to unmute on swift card video player",videoPlayer_button_turnOnVideo:"Turn on video","_videoPlayer_button_turnOnVideo.comment":"Tooltip on the video button displayed when my video is off during call",videoPlayer_button_turnOffVideo:"Turn off video","_videoPlayer_button_turnOffVideo.comment":"Tooltip on the video button displayed when my video is on during call",videoPlayer_button_turnOnIncomingVideo:"Turn on incoming video","_videoPlayer_button_turnOnIncomingVideo.comment":"Tooltip on the incoming video button displayed when incoming video is off during call",videoPlayer_button_turnOffIncomingVideo:"Turn off incoming video","_videoPlayer_button_turnOffIncomingVideo.comment":"Tooltip on the incoming video button displayed when incoming video is on during call",videoPlayer_button_endCall:"End call","_videoPlayer_button_endCall.comment":"Tooltip on the end call button during call",videoPlayer_button_startScreenSharing:"Share screen","_videoPlayer_button_startScreenSharing.comment":"(Action) Tooltip on the screen sharing button displayed when screen sharing is off during call",videoPlayer_button_stopScreenSharing:"Stop sharing","_videoPlayer_button_stopScreenSharing.comment":"Tooltip on the screen sharing button displayed when screen sharing is on during call",calling_button_toggleChat:"Toggle chat","_calling_button_toggleChat.comment":"Tooltip on the chat button during call",calling_button_dock:"Dock","_calling_button_dock.comment":"Tooltip on the dock button during call",calling_button_fullscreen:"Fullscreen","_calling_button_fullscreen.comment":"Tooltip on the fullscreen button during call",calling_button_settings:"Settings","_calling_button_settings.comment":"Tooltip on the settings button during call",calling_button_acceptWithAudio:"Accept with audio","_calling_button_acceptWithAudio.comment":"Tooltip on the accept button for incoming call",calling_button_acceptWithVideo:"Accept with video","_calling_button_acceptWithVideo.comment":"Tooltip on the accept button for incoming call",calling_button_reject:"Reject","_calling_button_reject.comment":"Tooltip on the reject button for incoming call",calling_settings_devices:"Devices","_calling_settings_devices.comment":"Title for calling devices settings",calling_settings_cameras:"Cameras","_calling_settings_cameras.comment":"Title for calling cameras select",calling_settings_microphones:"Microphones","_calling_settings_microphones.comment":"Title for calling microphones select",calling_settings_speakers:"Speakers","_calling_settings_speakers.comment":"Title for calling speakers select",calling_participants_close:"Close","_calling_participants_close.comment":"Title for call participants list closing button  (action)",calling_button_startAudio:"Start audio call","_calling_button_startAudio.comment":"Title for start call button (action)",calling_button_startVideo:"Start video call","_calling_button_startVideo.comment":"Title for start call button  (action)",calling_rate_request:"How would you rate the quality of this call?","_calling_rate_request.comment":"Question on call rate screen",accessibility_swift_action_prefix:"Click to {swiftAction}","_accessibility_swift_action_prefix.comment":'Tooltip on the button to unmute on swift card video player {Locked="{swiftAction}"}',header_termsOfUse:"Terms of use","_header_termsOfUse.comment":"Link to Terms of use",header_privacyPolicy:"Privacy policy","_header_privacyPolicy.comment":"Link to Privacy policy",m_unsupported:"This message type is currently not supported. Go to http://web.skype.com for full experience","_m_unsupported.comment":'Text displayed in chat when receiving unsupported message {Locked="http://web.skype.com"}',builder_botId:"Bot ID","_builder_botId.comment":"Bot ID text on Builder page",builder_buttonStyle:"Button style","_builder_buttonStyle.comment":"Button style text on Builder page",builder_buttonImage:"Button image","_builder_buttonImage.comment":"Button image text on Builder page",builder_buttonLabel:"Button label","_builder_buttonLabel.comment":"Button label text on Builder page",builder_colors:"Colors","_builder_colors.comment":"Colors text on Builder page",builder_message:"Message","_builder_message.comment":"Message text on Builder page",builder_theme:"Theme","_builder_theme.comment":"Theme text on Builder page",builder_code:"Code","_builder_code.comment":"Code word on Builder page",builder_copy:"Copy","_builder_copy.comment":"Copy word on the copy button on Builder page",builder_light:"Light","_builder_light.comment":"Light word on the copy button on Builder page",builder_dark:"Dark","_builder_dark.comment":"Dark word on the copy button on Builder page",sending:"Sending","_sending.comment":"Displayed while sending a message to SWC",failed:"Failed","_failed.comment":"Displayed when a message delivery failed",sign_in_welcome:"Please sign in to start chatting","_sign_in_welcome.comment":"Message in chatlog prompting user to sign in when in chat with 1:1",sign_in:"Sign in","_sign_in.comment":"Text on Button when in chat with 1:1",sign_in_cancel:"Cancel","_sign_in_cancel.comment":"Link in chat with 1:1",send_message:"Send message","_send_message.comment":"aria label for send (message) button",send_file:"Send file","_send_file.comment":"aria label for send (file) button",close_window:"Close window","_close_window.comment":"aria label for button which closes window",say_hi_to_a_bot:"Say hi to a bot",hi:"hi","_hi.comment":"message 'hi' sent to bot","_say_hi_to_a_bot.comment":"aria label for the button which when clicked submits say hi message",sign_in_to_save_your_chat:"Sign in to save your chat","_sign_in_to_save_your_chat.comment":"aria label for the button which when clicked submits say hi message",click_here_to_switch_accounts_aria_label:"Click here to switch accounts","_click_here_to_switch_accounts_aria_label.comment":"aria label for the button which when clicked switches accounts",you_cannot_sign_in_when_guest_only_mode_enabled:"You cannot sign in when guest only mode enabled","_you_cannot_sign_in_when_guest_only_mode_enabled.comment":"aria label displayed in guest only mode",say_hi:"Say 'hi'","_say_hi.comment":"Text displayed in chat.",or_text:" or ","_or_text.comment":"Part of Welcome message displayed in chat. The spaces at the beginning and at the end is necessary",sign_in_text:"sign in","_sign_in_text.comment":"Part of Welcome message displayed in chat.",to_save_your_chat:" to save your chat.","_to_save_your_chat.comment":"Part of Welcome message displayed in chat. The space before sentence is necessary",welcome_back:"Welcome back, {displayName}","_welcome_back.comment":'Text which appears in chat after user logs in {Locked="{displayName}"}',welcome_back_text:"Welcome back, ","_welcome_back_text.comment":"Text which appears in chat after user logs in. the space at the end is necessary",click_here_to_switch_account:"{0}Click here{1} to switch accounts","_click_here_to_switch_account.comment":'Text which appears after clicking on username in chat {Locked="{0}"} {Locked="{1}"}',click_here_text:"Click here","_click_here_text.comment":"Text which appears after clicking on username in chat",to_switch_accounts:" to switch accounts.","_to_switch_accounts.comment":"Text which appears after clicking on username in chat. Space at the beginning is necessary.",they_are_speaking:"They are speaking {theirLanguage}","_they_are_speaking.comment":'For example: They are speaking English {Locked="{theirLanguage}"}',you_are_speaking:"You are speaking {myLanguage}","_you_are_speaking.comment":'For example: You are speaking French {Locked="{myLanguage}"}',typingIndicator:"{typingMessage} is responding...","_typingIndicator.comment":'Message displayed after you submit a message to bot. For example: Swift bot is responding... {Locked="{typingMessage}"}',typingIndicatorHuman:"{typingMessage} is typing...","_typingIndicatorHuman.comment":'Message displayed when somebody is writing a message to a chat. For example: Anna is typing... {Locked="{typingMessage}"}',typingIndicatorOnLoad:"Loading...","_typingIndicatorOnLoad.comment":"Message displayed while conversation data is loading",recentlistChats:"Recent chats",recentlistChats_loading:"Loading chats...","_recentlistChats_loading.comment":"Chats loading label before list of chats is loaded",recentlist_new_conversation:"New Conversation",recentList_seeAllInSkype:"See All in Skype",recentList_welcome_heading:"Welcome to the new Skype",recentList_welcome_text_outlook:'Check it out by clicking the "{beforePlus}+{afterPlus}" at the top to start a new chat.',recentList_sorting_select_unread:"Unread","_recentList_sorting_select_unread.comment":"Recenlist select to filter unread items only",recentList_sorting_select_time:"Time","_recentList_sorting_select_time.comment":"Recenlist select to filter based on time",conversation_add_people_to_chat:"Add to group chat",button_add_participants:"Add",button_create_new_chat:"Create",conversation_remove_people_to_chat:"Chat participants",conversation_show_people_in_chat:"Participants","_conversation_show_people_in_chat.comment":"Title for view showing list of participants in conversation",callee_unavailable:"The person you're trying to call may not be available","_callee_unavailable.comment":"Text displayed to user when trying to call unavailable participant",calling_screen_calling:"CALLING...",calling_screen_incoming:"INCOMING CALL",calling_screen_onhold:"CALL ON HOLD...",message_text_ongoingCall:"Ongoing call","_message_text_ongoingCall.comment":"Message displayed to user on ongpoing call",message_text_startedCall:"Call",message_text_startedGroupCall:"Group call",message_text_endedCall:"Call ended",message_text_endedGroupCall:"Group call ended",message_text_missedCall:"Missed call",message_text_missedGroupCall:"Missed group call",message_text_noAnswerCall:"Call, no answer",message_text_noAnswerGroupCall:"Group call, no answer",message_text_hours:"h","_message_text_hours.comment":"Shortcut for hour",message_text_minutes:"m","message_text_minutes.comment":"Shortcut for minute",message_text_seconds:"s","message_text_seconds.comment":"Shortcut for second",message_text_photo:"photo","message_text_photo.comment":"Text displayed in message preview for image",message_text_you_have_left_the_conversation:"You have left the conversation",reactions_see_who_reacted_text:"See who reacted with emoticon {key}",reactions_you_text:"(you)",icon_text_message_was_edited:"This message has been edited",text_cancel_editing_message:"Cancel edit",deviceconsent_legend:"Click allow to give microphone and camera access.","_deviceconsent_legend.comment":"Text explaning the user how to grant access to microphone and camera.",roster_menu_item_create_group:"Create a group",roster_menu_delete_conversation:"Delete conversation",roster_menu_block_contact:"Block contact","_roster_menu_block_contact.comment":"Menu item in pop up to block current contact",roster_menu_unblock_contact:"Unblock contact","_roster_menu_unblock_contact.comment":"Menu item in pop up to unblock current contact",roster_menu_leave_conversation:"Leave conversation",roster_menu_report_a_problem:"Report a problem",roster_menu_get_help:"Get help",roster_menu_send_feedback:"Send feedback",confirm_dialog_delete_conversation_header:"Delete chat",confirm_dialog_delete_conversation_text:"Are you sure you want to delete this chat?",confirm_dialog_leave_conversation_header:"Leave chat",confirm_dialog_leave_conversation_text:"Are you sure you want to leave this chat?",confirm_dialog_delete_msg_header:"Remove message",confirm_dialog_edit_msg_header:"Edit message",confirm_dialog_delete_msg_text:"Are you sure you want to remove this message?",confirm_dialog_block_contact_header:"Block this contact?","_confirm_dialog_block_contact_header.comment":"Ask user if he wants to block current contact",confirm_dialog_block_report_abuse_checkbox:"Report abuse from this person","_confirm_dialog_block_report_abuse_checkbox.comment":"Ask user if he wants to report abuse from this person",confirm_dialog_block_select_abuse_reason:"Select a reason","_confirm_dialog_block_select_abuse_reason.comment":"Ask user to select abude resaon",confirm_dialog_report_abuse_spam_reason_text:"Spam","_confirm_dialog_report_abuse_spam_reason_text.comment":"Report spam as abuse reason",confirm_dialog_report_abuse_pornography_reason_text:"Contains nudity or pornography","_confirm_dialog_report_abuse_pornography_reason_text.comment":"The reason to report abuse is that content from contact contains nudity or pornography",confirm_dialog_report_abuse_child_exploitation_reason_text:"Child exploitation","_confirm_dialog_report_abuse_child_exploitation_reason_text.comment":"The reason to report abuse is child exploitation",confirm_dialog_report_abuse_harassment_reason_text:"Harassment or threats","_confirm_dialog_report_abuse_harassment_reason_text.comment":"he reason to report abuse is that content from contact contains harassment or threats",open_menu_dialog_text:"Open menu",btn_confirm_leave:"Leave",btn_confirm_deletion:"Delete",btn_confirm_removal:"Remove",btn_confirm_blocking:"Block","_btn_confirm_blocking.comment":"Text on the button to block contact",translator_active:"Translator: {0}active{1}","_translator_active.comment":'Message displayed when translator is active {Locked="{0}"} {Locked="{1}"}',scroll_to_bottom:"Scroll to bottom","_scroll_to_bottom.comment":"After user scrolls in chat to the top, a button appears with that text",crMessage:"Hi, I would like to add you to my contacts.","_cr_message.comment":"Message in chat",no_connection:"No connection","_no_connection.comment":"Message displayed in chat when there is no internet connection",message_failed:"Unable to send a message. Please try again later","_message_failed.comment":"Unable to send a message. Service currently is not available",polling_failed:"Service is currently unavailable","_polling_failed.comment":"Service currently is not available. Please try again later",notification_summary:"You have {count} unread conversation",notification_summary_few:"You have {count} unread conversation",notification_summary_few_comment:"Text of notification that appears right after user loggs in if he has unread conversations","_notification_summary.comment":'Text of notification that appears right after user loggs in if he has some unread conversations. {Locked="{count}"}',notification_summary_many:"You have {count} unread conversations","_notification_summary_many.comment":'Text of notification that appears right after user loggs in if he has some unread conversations {Locked="{count}"}',notification_reminder:"Unread chats: {name}","_notification_reminder.comment":'Text of notification when user has more than 2 new unread messages in a chat{Locked="{name}"}',notification_reminder_desc:"{count} unread chat","notification_reminder_desc.comment":'Text of the notification description when user has more than 2 new unread messages in a chat{Locked="{count}"}',notification_reminder_desc_many:"{count} unread chats","notification_reminder_desc_many.comment":'Text of notification when user has more than 2 new unread messages in few chats {Locked="{count}"}',separator:",","_separator.comment":"Separator between words",file_sent:"Sent a file","_file_sent.comment":"Message that showed in notification was a file was sent in conversation",pic_sent:"Sent a picture","_pic_sent.comment":"Message that showed in notification was a picture was sent in conversation",open:"Open","_open.comment":"Open something, for example a chat",open_client_descr:"Open Skype client","_open_client_descr.comment":"Description for Open Skype client button",accept:"Accept","_accept.comment":"Accept a call button",accept_descr:"Accept the call","_accept_descr.comment":"Description to Accept button",ignore:"Ignore","_ignore.comment":"Ignore text",ignore_descr:"Ignore the call","_ignore_descr.comment":"Description for Ignore call button",ignore_summary_notificaton_descr:"Ignore notifications from Skype client for some time","_ignore_summary_notificaton_descr.comment":"Description for Ignore notifications from Skype client button",ignore_reminder_notificaton_descr:"Ignore unread message reminder notification","_ignore_reminder_notificaton_descr.comment":"Description for Ignore current notifications from Skype client button",ignore_unread_notificaton_descr:"Ignore unread message notification","_ignore_unread_notificaton_descr.comment":"Description for Ignore current notifications from Skype client button",msn_signin_screen_title:"Skype on MSN","_msn_signin_screen_title.comment":"MSN sign-in screen - title",msn_signin_screen_contacts:"See who's online","_msn_signin_screen_contacts.comment":"MSN sign-in screen - contacts label",msn_signin_screen_recents:"Notifications and missed messages","_msn_signin_screen_recents.comment":"MSN sign-in screen - recent items label: missed calls, messages...",msn_signin_screen_calling_messaging:"Voice calls and chats","_msn_signin_screen_calling_messaging.comment":"MSN sign-in screen - messaging and calling label",msn_signin_screen_connect:"Start connecting your Skype","_msn_signin_screen_connect.comment":"MSN sign-in screen - connect skype title",msn_signin_screen_connect_description:"Connecting Skype with MSN requires a Microsoft account to get set up.","_msn_signin_screen_connect_description.comment":"MSN sign-in screen - connect description: what is needed to connect Skype",msn_signin_screen_sign_in_has_account:"Already have a Microsoft account?","_msn_signin_screen_sign_in_has_account.comment":"MSN sign-in screen - user already has an account label",msn_signin_screen_sign_in_button:"SIGN IN","_msn_signin_screen_sign_in_button.comment":"MSN sign-in screen - sign in button text",msn_signin_screen_sign_in_no_account:"Don't have a Microsoft account?","_msn_signin_screen_sign_in_no_account.comment":"MSN sign-in screen - user doesn't have an account yet label",msn_signin_screen_create_account_button:"CREATE NOW","_msn_signin_screen_create_account_button.comment":"MSN sign-in screen - create an account button text",date_monday:"Mon",date_tuesday:"Tue",date_wednesday:"Wed",date_thursday:"Thu",date_friday:"Fri",date_saturday:"Sat",date_sunday:"Sun",powered_by_skype:"Powered by Skype",do_not_have_account:"Do not have an account?","_do_not_have_account.comment":"Message showed on the login page for people who want to register.",sign_up:"Sign up!","_sign_up.comment":"Message shown for the action of signing up for a Skype account.",mark_all_conversations_as_read:"Mark all as read","_mark_all_conversations_as_read.comment":"Message displayed on button that marks all the conversations as read.",show_options:"Show options","_show_options.comment":"Message displayed on hover for action of displaying options",confirm_mark_all_as_read_header:"Mark all as read","_confirm_mark_all_as_read_header.comment":"Message for confirmation dialog header.",confirm_mark_all_as_read_text:"Are you sure you want to mark all conversations as read?","_confirm_mark_all_as_read_text.comment":"Confirmation message for marking all as read.",btn_confirm_marking_as_read:"Yes","_btn_confirm_marking_as_read.comment":"Message on marking button.",show_incoming_video_button:"Show incoming video","_show_incoming_video_button.comment":"Message on button that triggers the action of showing incoming videos.",hide_incoming_video_button:"Hide incoming video","_hide_incoming_video_button.comment":"Message on button that triggers the action of hiding incoming videos."}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=n(108),r=function(){function t(){}return t.prototype.load=function(t,n){var r=this,o=(new XMLHttpRequest,t+"/"+n+"/Strings.json");return new Promise(function(t,n){return e(o).then(function(e){return e.json().then(function(e){r._translations=e,i.default.merge(e),t()},n)})})},t}();t.default=new r}).call(this,n(61))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(10),r=n(11),o={af:"af",am:"am",ar:"ar",as:"as",az:"az",be:"be",bg:"bg",bn:"bn",bs:"bs",chr:"chr",ca:"ca",cs:"cs",cy:"cy",da:"da",de:"de",el:"el",en:"en",es:"es",et:"et",eu:"eu",fa:"fa",fi:"fi",fil:"fil",fr:"fr",ga:"ga",gd:"gd",gl:"gl",gu:"gu",ha:"ha",he:"he",hi:"hi",hr:"hr",hu:"hu",hy:"hy",id:"id",ig:"ig",is:"is",it:"it",iw:"iw",ja:"ja",ka:"ka",kk:"kk",km:"km",kn:"kn",ko:"ko",kok:"kok",ku:"ku",ky:"ky",lb:"lb",lt:"lt",lv:"lv",mi:"mi",ml:"ml",mn:"mn",mr:"mr",ms:"ms",ne:"ne",nl:"nl",nn:"nn",nb:"nb",no:"no",nso:"nso",or:"or",pa:"pa",pl:"pl",prs:"prs",pt_br:"pt-br",pt_pt:"pt-pt",qps:"qps",qut:"qut",quz:"quz",ro:"ro",ru:"ru",rw:"rw",sd:"sd",si:"si",sl:"sl",sk:"sk",sq:"sq",sr:"sr",sv:"sv",sw:"sw",ta:"ta",te:"te",tg:"tg",th:"th",ti:"ti",tk:"tk",tn:"tn",tr_tr:"tr-tr",tt:"tt",ug:"ug",uk:"uk",ur:"ur",uz:"uz",vi:"vi",wo:"wo",xh:"xh",yo:"yo",zh:"zh",zu:"zu"},s={group0:{languages:[o.ja,o.id,o.ko,o.tr_tr,o.vi,o.zh,o.az,o.ig,o.fa,o.ka,o.km,o.kn,o.ms,o.prs,o.th,o.tt,o.ug,o.wo,o.yo]},group1:{languages:[o.bg,o.ca,o.cy,o.da,o.de,o.el,o.en,o.es,o.et,o.fi,o.he,o.hu,o.it,o.iw,o.nb,o.nl,o.no,o.pt_pt,o.qps,o.sv,o.af,o.as,o.bn,o.chr,o.eu,o.gl,o.gu,o.ha,o.hy,o.is,o.kk,o.kok,o.ku,o.ky,o.lb,o.mi,o.ml,o.mn,o.mr,o.ne,o.nn,o.or,o.pa,o.qut,o.quz,o.rw,o.sd,o.si,o.sq,o.sw,o.ta,o.te,o.tk,o.tn,o.ur,o.xh,o.zu]},group2:{languages:[o.fr,o.pt_br,o.am,o.fil,o.hi,o.nso,o.tg,o.ti,o.uz]},group3:{languages:[o.lv]},group4:{languages:[o.gd]},group5:{languages:[o.ro]},group6:{languages:[o.lt]},group7:{languages:[o.ru,o.uk,o.hr,o.sr,o.be,o.bs,o.sl]},group8:{languages:[o.cs,o.sk]},group9:{languages:[o.pl]},group11:{languages:[o.ga]},group12:{languages:[o.ar]}},a=function(){function e(){}return e.prototype.init=function(e){void 0===e&&(e=o.en);var t=e.replace("-","_").toLowerCase();if(!o[t]){var n=t.split("_");1===n.length&&r.default.throwError(i.ErrorCodes.ERR_UNSUPPORTED_LANGUAGE,"Unsupported language:"+e),t=n[0]}this._currentLocale=t},e.prototype.getPluralSuffix=function(e){var t,n=null,i="";for(t in s)-1!==s[t].languages.indexOf(this._currentLocale)&&(n=t);switch(n){case"group0":i=1===e?"":"_few";break;case"group1":i=1===e?"":"_many";break;case"group2":i=e>1?"_many":"";break;case"group3":i=e%10==1&&e%100!=11?"":0===e?"_few":"_many";break;case"group4":i=1===e||11===e?"":2===e||12===e?"_few":"_many";break;case"group5":i=1===e?"":0===e||e%100>0&&e%100<20?"_few":"_many";break;case"group6":i=e%10==1&&e%100!=11?"":e%10>=2&&(e%100<10||e%100>=20)?"_many":"_few";break;case"group7":i=e%10==1&&e%100!=11?"":e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?"_few":"_many";break;case"group8":i=1===e?"":e>=2&&e<=4?"_few":"_many";break;case"group9":i=1===e?"":e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?"_few":"_many";break;case"group11":i=1===e?"":e>=2&&e<=10?"_few":"_many";break;case"group12":i=1===e?"":2===e?"_few":"_many";break;default:i=""}return i},e}();t.default=new a},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.implode=function(e){return e.join(",")},e.explode=function(e){return e?e.replace(/\s/g,"").split(","):[]},e.find=function(t,n){return e.explode(t).indexOf(n)>-1},e.add=function(t,n,i){if(!i||!e.find(t,n)){var r=e.explode(t);r.push(n),t=e.implode(r)}return t},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(4),o=n(45),s=n(0);!function(e){e[e.replace=1]="replace"}(i=t.Rule||(t.Rule={}));var a=function(){function e(e,t,n){var i=this;this.pattern=e,this.rule=t,this.replace=function(e){return e.replace(i.pattern,i.replacer)},this.replacer=function(e){for(var t=e.length,n="",r=i.replacement;t--;)n+=r;return n},this.replacement=n}return Object.defineProperty(e.prototype,"replacement",{get:function(){return this.char?String.fromCharCode(this.char):void 0},set:function(e){this.char=e?e.charCodeAt(0):this.char},enumerable:!0,configurable:!0}),e}();t.Mask=a;var c=function(){function e(){var e=this;this.masks=[],this.setupProxy=function(){var t=s.swc.API;t.registerEvent(r.ApiEvents.invoke.registerMask,function(t){e.register(t,i.replace,"#")}),t.registerEvent(r.ApiEvents.invoke.unregisterMask,function(t){e.unregister(t)})},o.ProxyConnector.instance.connect("messageMasking",null,this.setupProxy)}return Object.defineProperty(e,"instance",{get:function(){return e.init()},enumerable:!0,configurable:!0}),e.init=function(){return e._instance||(e._instance=new e)},Object.defineProperty(e.prototype,"empty",{get:function(){return!this.masks.length},enumerable:!0,configurable:!0}),e.prototype.register=function(e,t,n){var i=this.masks.find(function(n){return n.pattern==e&&n.rule==t});i?i.replacement!=n&&(i.replacement=n):this.masks.push(new a(e,t,n))},e.prototype.unregister=function(e,t){this.masks.forEach(function(n,i,r){n.pattern!=e||t&&n.rule!==t||r.splice(i,1)})},e.prototype.shouldMask=function(e){if(this.empty)return!1;for(var t,n=0,i=this.masks;n<i.length;n++){var r=i[n];if(t=e.search(r.pattern)>-1)break}return t},e.prototype.process=function(e){return this.masks.forEach(function(t){return e=t.replace(e)}),e},e}();t.Masks=c},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUMBER_0:48,NUMBER_9:57,NUMPAD_0:96,NUMPAD_9:105,A:65,G:71,H:72,J:74,K:75,L:76,Z:90,F6:117,F10:121}},,function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),s=function(e){function t(){var t=e.call(this,"user_activity_start")||this;return t.send=function(){if(!window.swc.activityStarted){window.swc.activityStarted=!0;var e=function(){t._telemetryService.sendEvent(t)};o.swc.services.signInManager.getSkypeToken().then(e,e)}},t._telemetryService=o.swc.services.telemetryManager,t}return r(t,e),t.prototype.getCustomProperties=function(){return new Array},t}(n(8).TelemetryEvent);t.UserActivityStart=s},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(21),r=n(20),o=function(e){if(e.indexOf("_")>-1){var t=e.split("_");return t[t.length-1]}return e.replace("8:orgid:","")},s=function(e){try{var t=[o(i.getServices().mePerson.mri),o(e)].sort().join("_");return Promise.resolve("19:"+t+"@unq.gbl.spaces")}catch(e){}return Promise.resolve(void 0)};t.generateOneToOneConversationId=function(e){try{if(r.guid.isGuid(e))return function(e){try{var t=i.getServices().contactsService;if(t.getContactByObjectId)return t.getContactByObjectId(e).then(function(e){return s(e.mri)})}catch(e){}return Promise.resolve(void 0)}(e);if(t.isEnterpriseUserMri(e))return s(e)}catch(e){}return Promise.resolve(void 0)},t.isEnterpriseUserMri=function(e){return/^8:orgid:[^@]+$/.test(e)}},,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=n(1),o=n(23),s=n(77),a=n(0),c=n(46),l=n(437),u=n(350),d=function(){function e(e,t){var n=this;this._params=e,this.definition=t,this.contactVMsMap={},this.initialized=ko.observable(!1),this.isInRecents=function(e,t){return e.filter(function(e){return e.id===t}).length>0},this._setVisibilityOfExistingParticipants=function(){var e=n.participants;e&&n.observeExistingParticipants(e,{newItems:e})},this.startChatAction=function(e){"function"==typeof n.actionProvider&&(n.actionProvider(e,s.default.CONTACTS),a.swcWindow.swc.API.triggerEvent(i.SearchEvents.SEARCH_START,{searchMode:!1,id:n.correlationId}),a.swc.API.triggerEvent(i.SearchEvents.EMPTY_QUERY,n.correlationId))},this.hideItem=function(e){n.contactVMsMap[e]&&(n.contactVMsMap[e].visible=!1)},this.hideAllItems=function(){Object.keys(n.contactVMsMap).forEach(function(e){var t=n.contactVMsMap[e];t.visible&&(t.visible=!1)})},this.showAllItems=function(e){Object.keys(n.contactVMsMap).forEach(function(e){n.contactVMsMap[e].visible=!0})},this.showItem=function(e){n.contactVMsMap[e]&&(n.contactVMsMap[e].visible=!0)},this.observeExistingParticipants=function(e,t){c.default.handleParticipantsChanges(n.contactVMsMap,t)},this.createContactsFragment=function(e){for(var t=[],i=[],r=document.createDocumentFragment(),o=0;o<e.length;o++){var s={vm:e[o],view:e[o].getView()};t.push(s.vm),i.push(s)}var a=i.sort(c.default.sortByName);for(o=0;o<a.length;o++)r.appendChild(a[o].view);return c.default.mapContactVMItems(t,n.contactVMsMap),r},this.createContactVM=function(e){return e.map(function(e){var t=r.default.instance.Persons.getPerson(e.skypeid,!0);return new u.default(t,n.startChatAction,e)})},this._setContactsLoaded=function(e,t){n._setVisibilityOfExistingParticipants(),n.initialized(!0),a.swc.API.triggerEvent(i.ScrollEvents.SCROLL_RECOUNT,{id:n.correlationId}),n._sendTelemetryData(e,t)},this.fetchContacts=function(){if(n._fetchingContactsPromise)return n._fetchingContactsPromise;var e=Date.now();return n._fetchingContactsPromise=new Promise(function(t,i){var o=function(i){n._setContactsLoaded(i,e),t(i)},s=function(e){i({contacts:[],blocked:[],groups:[]})};r.default.instance.SignInManager.onceSignedIn().then(function(){return r.default.instance.ContactsManager.fetchMyContacts().then(o,s)})}),n._fetchingContactsPromise},this._sendTelemetryData=function(e,t){var n=new l.default,i=e.contacts?e.contacts:[];n.ttl=Date.now()-t,n.total=i.length,n.person=i.filter(function(e){return 8===e.type}).length,n.agents=i.filter(function(e){return 28===e.type}).length,n.pstn=i.filter(function(e){return 4===e.type}).length,r.default.instance.TelemetryService.sendEvent(n)},this.actionProvider=e.action,this.correlationId=e.id,this.conversation=e.conversation,this.participants=this.conversation?this.conversation.participants:null,this.conversation&&(this.existingParticipantsObserver=this.conversation.participants.subscribe(this.observeExistingParticipants)),r.default.instance.SignInManager.subscribe("state",function(e){e===o.SigninState.SignedOut&&n.hideAllItems()})}return e.prototype.dispose=function(){this.existingParticipantsObserver&&this.existingParticipantsObserver.dispose()},e}();t.default=d},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),s=n(9),a=n(6),c=n(18),l=n(13),u=n(0),d=n(76),p={showInfoRow:!1},h=function(e){function t(t,n,i,r){void 0===r&&(r=p);var c=e.call(this)||this;c.getView=function(){return c._contactItemEl},c._updateItemVisibility=function(){var e=c.isDisplayed()?"flex":"none";c._contactItemEl.style.display=e},c.isDisplayed=function(){return c._visible&&!c._selected&&!c._alreadyParticipant},c.person=t,c.isPstn=t.id.indexOf("4:")>-1,c._visible=!0,c._selected=!1,c._alreadyParticipant=!1,c._alreadyChatting=!1,c._type=i.type,c.mutualFriendCount=i.mutualFriendCount,c.distance=i.distance,c.isFavorite=i.favorite,c._contactItemEl=document.createElement("div"),c._contactItemEl.classList.add("item"),n&&c._contactItemEl.addEventListener("click",n.bind(null,c));var h=document.createElement("div");h.className="info";var f=document.createElement("p");if(f.className="title",f.innerText=c.person.displayName,h.appendChild(f),r.showInfoRow)if(a.default.get.backend!==l.MessagingBackend.TEAMS){var g=u.swc.Assets.SVG,m=document.createElement("div");m.className="contactDetails";var v=document.createElement("span");v.className="left";var _=document.createElement("p");if(_.innerText=c.person.id,v.innerHTML=g.iconSkype,v.appendChild(_),m.appendChild(v),c.mutualFriendCount){(b=document.createElement("p")).innerText=c.mutualFriendCount.toString();var y=document.createElement("span");y.className="right",y.innerHTML=g.iconGroupPair,y.appendChild(b),m.appendChild(y)}h.appendChild(m)}else{var b;(b=document.createElement("p")).className="engineering-title",b.innerText=i.jobTitle||"",h.appendChild(b)}c.person.subscribe("displayName",function(e){f.innerText=e});var w=document.createDocumentFragment(),C={person:c.person,isPstn:c.isPstn},E=s.createElement(d.PersonAvatar,C);return o.render(E,w),c._contactItemEl.appendChild(w),c._contactItemEl.appendChild(h),c._updateItemVisibility(),c}return r(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},set:function(e){e!==this._type&&(this._type=e,this.publish("type",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=e,this.publish("visible",e),this._updateItemVisibility())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alreadyParticipant",{get:function(){return this._alreadyParticipant},set:function(e){e!==this._alreadyParticipant&&(this._alreadyParticipant=e,this.publish("alreadyParticipant",e),this._updateItemVisibility())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alreadyChatting",{get:function(){return this._alreadyChatting},set:function(e){e!==this._alreadyChatting&&(this._alreadyChatting=e,this.publish("alreadyChatting",e),this._updateItemVisibility())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selected",{get:function(){return this._selected},set:function(e){e!==this._selected&&(this._selected=e,this.publish("selected",e),this._updateItemVisibility())},enumerable:!0,configurable:!0}),t}(c.default);t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1);t.findRecentConversationIdForMembers=function(e){return new Promise(function(t,n){return function(e,t,n){i.default.instance.WebApi.fetchRecentConversations().then(function(i){var r;i.conversations.sort(function(e,t){return e.id.localeCompare(t.id)}).some(function(t){var n=2===e.length&&t.isOneOnOne,i=e.length>2&&!t.isOneOnOne;if(t.members&&t.members.length===e.length&&(n||i)){var o=!0;if(e.forEach(function(e){var n;o=o&&(n=e.id,1===t.members.filter(function(e){return e.id===n}).length)}),o)return r=t.id,!0}return!1}),r?t(r):n()})}(e,t,n)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),r=n(9),o=n(4),s=n(1),a=n(77),c=n(444),l=n(445),u=n(0),d=n(350),p=n(123),h=n(46),f=n(35),g=n(360),m="",v="newChatComposerId";t.DEFAULT_SETTINGS={actionOnResult:function(){},showCounter:!1,showHeaders:!0,showContactListAsDefault:!0,placeHolder:!0,isRecentListComponent:!1,showSearchIcon:!1};var _=function(){function e(e,n,_){var y=this;this._params=e,this.recentsDataConfig=n,this.element=_,this.inSearchMode=ko.observable(!1),this.peopleResultsCount=ko.observable(0),this.botsResultsCount=ko.observable(0),this.chatResultsCount=ko.observable(0),this._personsSearchVMsMap={},this._botsSearchVMsMap={},this.hasSomeResults=ko.observable(),this.resultsCountText=ko.observable(),this.searchQuery=ko.observable(m),this.lastSearchQuery=m,this._selectedContactsId=[],this._updateResultsCount=function(){var e=y.peopleResultsCount()+y.botsResultsCount()+y.chatResultsCount(),t=s.default.instance.i18n.fetch("search_results",{resultscount:e});y.resultsCountText(t),y.hasSomeResults(!!e)},this._showContactsMode=function(){var e=y.container.querySelector(".contactListVM .contactsWrapper");e&&e.firstChild&&(y.inSearchMode(!0),u.swc.API.triggerEvent(o.SearchEvents.SEARCH_START,{searchMode:!0,id:y.correlationId}))},this._registerScrollEvents=function(){u.swc.API.registerEvent(o.ParticipantEvents.SELECTED_PARTICIPANTS_CHANGE,function(e){y.correlationId===e.id&&(y._selectedContactsId=[],e.selectedContacts.forEach(function(e){y._selectedContactsId.push(e.person.id)}),u.swc.API.triggerEvent(o.ScrollEvents.SCROLL_RECOUNT,{id:y.correlationId}))})},this.startChatAction=function(e,t){if("function"==typeof y.actionProvider){t!==a.default.CONTACTS&&(t=a.default.SEARCH),y.actionProvider(e,t),y.searchQuery(m),y._setSearchVisibility(!1),u.swc.API.triggerEvent(o.SearchEvents.EMPTY_QUERY,y.correlationId);var n=new l.default;n.actionType=l.ActionType.OpenChat,n.openItemType=e.type,s.default.instance.TelemetryService.sendEvent(n)}},this._setSearchVisibility=function(e){y.settings.showContactListAsDefault||y.inSearchMode(e)},this._searchPeople=function(e){var t=[],n=[],i=document.createDocumentFragment();s.default.instance.SearchManager.searchSkypeDirectory(e).then(function(e){for(var r=h.default.mapSearchProfileInfo(e),a=0;a<r.length;a++){var c=s.default.instance.Persons.getPerson(r[a].skypeid),l=new d.default(c,y.startChatAction,r[a],{showInfoRow:!0}),p=!1;if(y._selectedContactsId&&y._selectedContactsId.length>0&&(p=y._selectedContactsId.indexOf(c.id)>=0),!p){var f={vm:l,view:l.getView()};t.push(f.vm),n.push(f)}}var g=h.default.getSortedByRelevance(n);for(a=0;a<g.length;a++)i.appendChild(g[a].view);h.default.mapContactVMItems(t,y._personsSearchVMsMap),y.searchPeopleContainer.appendChild(i),y.peopleResultsCount(n.length),y._updateResultsCount(),y.conversation&&y.conversation.participants&&h.default.handleParticipantsChanges(y._personsSearchVMsMap,{newItems:y.conversation.participants}),u.swc.API.triggerEvent(o.ScrollEvents.SCROLL_RECOUNT,{id:y.correlationId})},function(e){})},this._searchBots=function(e){var t=[],n=[],i=document.createDocumentFragment();s.default.instance.SearchManager.searchAgents(e).then(function(e){for(var r=0;r<e.length;r++){var a=s.default.instance.Persons.getPerson(e[r].skypeid),c=new d.default(a,y.startChatAction,e[r]),l={vm:c,view:c.getView()};n.push(l.vm),t.push(l)}var p=t.sort(h.default.sortByName);for(r=0;r<p.length;r++)i.appendChild(p[r].view);h.default.mapContactVMItems(n,y._botsSearchVMsMap),y.searchBotsContainer.appendChild(i),y.botsResultsCount(t.length),y._updateResultsCount(),y.conversation&&y.conversation.participants&&h.default.handleParticipantsChanges(y._botsSearchVMsMap,{newItems:y.conversation.participants}),u.swc.API.triggerEvent(o.ScrollEvents.SCROLL_RECOUNT,{id:y.correlationId})})},this.selectRecent=function(e){p.default.startChat(e,y.recentsDataConfig,!1,a.default.SEARCH),y.searchQuery(m),y._setSearchVisibility(!1)},this._searchChats=function(e){if(e=e?f.default.normalizeString(e):"",y._params.recentListVM&&e){var t=0;(y._recentsModel?y._recentsModel.items:[]).forEach(function(n){var o=(n.topic&&f.default.normalizeString(n.topic)).indexOf(e)>-1||n.id.indexOf(e)>-1;if(!n.isBlocked&&o){var s={item:n,action:y.selectRecent.bind(null,n.id)},a=r.createElement(g.default,s),c=document.createDocumentFragment();i.render(a,c),y.searchChatsContainer.appendChild(c),t++}}),y.chatResultsCount(t),y._updateResultsCount(),u.swc.API.triggerEvent(o.ScrollEvents.SCROLL_RECOUNT,{id:y.correlationId})}},this.startSearching=function(e){y._searchPeople(e),y.settings.isRecentListComponent&&y._searchChats(e),y._searchBots(e),s.default.instance.TelemetryService.sendEvent(new c.default(e))},this._removeChatResults=function(){if(y.searchChatsContainer){for(;y.searchChatsContainer.firstChild;)y.searchChatsContainer.removeChild(y.searchChatsContainer.firstChild);y.chatResultsCount(0),y._updateResultsCount()}},this._removeBotsResults=function(){if(y.searchBotsContainer){for(;y.searchBotsContainer.firstChild;)y.searchBotsContainer.removeChild(y.searchBotsContainer.firstChild);y._botsSearchVMsMap={},y.botsResultsCount(0),y._updateResultsCount()}},this._removePeopleResults=function(){if(y.searchPeopleContainer){for(;y.searchPeopleContainer.firstChild;)y.searchPeopleContainer.removeChild(y.searchPeopleContainer.firstChild);y._personsSearchVMsMap={},y.peopleResultsCount(0),y._updateResultsCount()}},this._recentsModel=this._params.recentListVM?this._params.recentListVM._recentlistModel:null,this._recentsContainerEl=e.recentListVM?e.recentListVM.element:null,this.botsText=s.default.instance.i18n.fetch("text_bots"),this.peopleText=s.default.instance.i18n.fetch("text_people"),this.chatsText=s.default.instance.i18n.fetch("text_chats"),this.container=_&&_.querySelector(".searchResultsWrapper"),this.searchPeopleContainer=this.container.querySelector(".contactsPeopleWrapper"),this.searchBotsContainer=this.container.querySelector(".contactsBotWrapper"),this.searchChatsContainer=this.container.querySelector(".chatResultsWrapper"),this.conversation=e.conversation,this.settings=e.settings||t.DEFAULT_SETTINGS,this.correlationId=e.id,this.actionProvider=e.settings.actionOnResult,u.swc.API.registerEvent(o.SearchEvents.SHOW_CONTACTS,this._showContactsMode),u.swc.API.registerEvent(o.ApiEvents.onControlClose,function(e){e.id===v&&(y._selectedContactsId=[])}),u.swc.API.registerEvent(o.SearchEvents.TOGGLE_RESULTS_COMPONENT,function(e){e.id===y.correlationId&&y.inSearchMode(e.val)}),u.swc.API.registerEvent(o.SearchEvents.UPDATE_SEARCH_RESULTS,function(e){e.id===y.correlationId&&(y.emptyResults(),e.query&&y.startSearching(e.query))}),u.swc.API.registerEvent(o.SearchEvents.EMPTY_RESULTS,function(e){e.id===y.correlationId&&y.emptyResults()})}return e.prototype.emptyResults=function(){this._removePeopleResults(),this._removeChatResults(),this._removeBotsResults()},e.prototype.dispose=function(){this.existingParticipantsObserver&&this.existingParticipantsObserver.dispose(),this.emptyResults(),this._selectedContactsId=[]},e}();t.default=_},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.NONE="none",e.UIONLY="uionly",e.FULL="full",e.HIDDEN="hidden",e}();t.PreloadType=i},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=function(e){function t(){return e.call(this,"recents_action")||this}return r(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(o.TelemetryPropertyValue.Create("action",this.actionType)),e.push(o.TelemetryPropertyValue.Create("origin",this.origin)),e},t}(n(8).TelemetryEvent);t.default=s;var a=function(){function e(){}return e.NEW_CHAT="newChat",e.OPEN_CHAT="openChat",e.OPEN_SEARCH="openSearch",e.START_VIDEO="startVideoCall",e.START_AUDIO="startAudioCall",e.SCROLL_FOR_FETCH="scrollToFetch",e}();t.RecentActionType=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),r=n(19),o=function(){function e(){}return e.isDomainIn=function(e){var t=window.swc.EcsConfig[e];if(!t)return!1;var n=this.getHost();return Array.isArray(t)?t.some(function(e){return e.toLowerCase()===n.toLowerCase()}):"true"===t.toLowerCase},e.getHost=function(){return i.default.get.host?i.default.get.host:r.default.getHost()},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.add=function(t,n){if(t&&n){for(var i=e.build(),r=i.container;r.firstChild;)r.removeChild(r.firstChild);r.appendChild(n),t.insertBefore(i.container,t.firstChild)}},e.remove=function(){if(e.instance&&e.instance.container){var t=e.instance.container.parentElement;t&&t.removeChild(e.instance.container)}},e.build=function(){if(!e.instance){var t=document.createElement("div");t.className="swc-confirmation-dialog",e.instance={container:t}}return e.instance},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),r=n(9),o=function(){return function(e,t){var n=this;this.getView=function(){return n._view};var o={dialogContent:e},s=r.createElement(t,o),a=document.createDocumentFragment();i.render(s,a),this._view=a.firstElementChild}}();t.default=o},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n(12),a=n(9),c=n(1),l=n(0),u=n(439),d=n(440),p=n(441),h=n(442),f=function(e){function t(t){var n=e.call(this,t)||this;return n._trackedItemFields=["isUnread","isBlocked","alertsOff","topic","lastMessage"],n._onItemUpdate=function(){n._updateState()},n._shouldShowCallBackButton=function(e,t){return!t&&"SystemMessage"===e.type&&"MissedCallMsg"===e.customType},n._shouldShowJoinCallButton=function(e){var t=e.lastMessage;return!e.isPstn&&e.isGroup&&"SystemMessage"===t.type&&"CallMsg"===t.customType},n._onItemClick=function(e){n.props.action&&n.props.action(),n.props.item.action&&n.props.item.action(n.props.item),e.stopPropagation()},n._onCallBackBtnClick=function(e){n.props.item.startAudioCall(),n.setState(function(e){return{showCallBackBtn:!1,itemClassMap:o({},e.itemClassMap,{callback:!1})}}),e.preventDefault()},n._onJoinBtnClick=function(e){n.props.item.joinGroupAudioCall(),n.setState(function(e){return{showJoinBtn:!1,itemClassMap:o({},e.itemClassMap,{callback:!1})}}),e.preventDefault()},n._onChatClick=function(){var e=n.props.item;e.startChat&&e.startChat()},n._onAudioClick=function(){n.props.item.startAudioCall()},n._onVideoClick=function(){n.props.item.startVideoCall()},n.state={topic:"",timestamp:null,showCallBackBtn:!1,showJoinBtn:!1,itemClassMap:{item:!0},alertsOffClassMap:{alerts:!0}},n}return r(t,e),t.prototype.componentDidMount=function(){var e=this;this._updateState();var t=this.props.item;this._trackedItemFields.forEach(function(n){return t.subscribe(n,e._onItemUpdate)}),t.isPerson&&c.default.instance.WebApi.subscribeContactPresence(t.id)},t.prototype.componentWillUnmount=function(){var e=this,t=this.props.item;this._trackedItemFields.forEach(function(n){return t.unsubscribe(n,e._onItemUpdate)}),t.isPerson&&c.default.instance.WebApi.unsubscribeContactPresence(t.id)},t.prototype._updateState=function(){var e=this.props.item,t=e.lastMessage,n=t.isDeleted?null:t.timestamp,i=this._shouldShowCallBackButton(t,e.isPstn),r=this._shouldShowJoinCallButton(e);this.setState(function(t){return{topic:e.topic,timestamp:n,showCallBackBtn:i,showJoinBtn:r,itemClassMap:o({},t.itemClassMap,{callback:i||r,unread:e.isUnread,muted:e.alertsOff,blocked:e.isBlocked}),alertsOffClassMap:o({},t.alertsOffClassMap,{off:e.alertsOff})}})},t.prototype.render=function(){var e=l.swc.Assets.SVG;return a.createElement("div",{onClick:this._onItemClick,className:this._getClassNameFromMap(this.state.itemClassMap)},a.createElement(u.RecentAvatar,{item:this.props.item}),a.createElement("div",{className:"info"},a.createElement("p",{className:"title"},this.state.topic),a.createElement(p.MessagePreview,{message:this.props.item.lastMessage}),this.state.showCallBackBtn&&a.createElement("button",{className:"callback",onClick:this._onCallBackBtnClick},"Call back"),this.state.showJoinBtn&&a.createElement("button",{className:"callback",onClick:this._onJoinBtnClick},"Join")),a.createElement("div",{className:"infoContainer"},a.createElement("div",{className:"time"},a.createElement(h.default,{date:this.state.timestamp})),a.createElement("div",{className:this._getClassNameFromMap(this.state.alertsOffClassMap),dangerouslySetInnerHTML:{__html:e.iconNotificationOff}})),a.createElement(d.default,{onChatClick:this._onChatClick,onAudioClick:this._onAudioClick,onVideoClick:this._onVideoClick}))},t.prototype._getClassNameFromMap=function(e){var t=[];for(var n in e){if(e.hasOwnProperty(n))e[n]&&t.push(n)}return t.join(" ")},t}(s.Component);t.default=f},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),s=n(9),a=n(1),c=n(76),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){var e=a.default.instance.Persons.getPerson(this.props.personId);return s.createElement(c.PersonAvatar,{person:e,isPstn:this.props.isPstn,customAvatar:this.props.customAvatar,showPresence:this.props.showPresence,onClick:this.props.onClick})},t}(o.Component);t.PersonIdAvatar=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.isWithinLastDay=function(e){var t=new Date;return t.setHours(0,0,0,0),e>t.getTime()},e.isWithinLastWeek=function(e){return e>new Date(Date.now()-6048e5).getTime()},e.isWithinLastHour=function(e){var t=new Date(e),n=new Date(Date.now()-354e4);return t.getTime()>n.getTime()},e.getDifferenceForLastHour=function(e){var t=new Date(e),n=Math.round((Date.now()-t.getTime())/60/1e3);return n<0?0:n},e.toStringMesssageDate=function(e,t){var n=!!t&&t.dateWithTime,i=new Date(e),r=(new Date).getFullYear()>i.getFullYear();if(this.isWithinLastDay(i.getTime()))return i.toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"});if(this.isWithinLastWeek(i.getTime()))return n?i.toLocaleTimeString(navigator.language,{weekday:"short",hour:"2-digit",minute:"2-digit"}):i.toLocaleDateString(navigator.language,{weekday:"short"});var o=r?{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}:{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"},s=r?{day:"numeric",month:"short",year:"numeric"}:{day:"numeric",month:"short"};return i.toLocaleDateString(navigator.language,n?o:s)},e}();t.default=i},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getContentElement=function(){return o.createElement("p",null,this.props.dialogContent.text)},t}(n(364).Dialog);t.TextDialog=s},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),s=n(9),a=n(0),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onConfirmClick=function(e){e.stopPropagation(),t.confirmAction()},t._onCancelClick=function(e){e.stopPropagation(),t.props.dialogContent.cancel.action()},t}return r(t,e),t.prototype.confirmAction=function(){this.props.dialogContent.confirm.action()},t.prototype.render=function(){var e=a.swc.Assets.SVG,t=this.props.dialogContent.cancel.title,n=this.props.dialogContent.confirm.title,i=this.props.dialogContent.title;return s.createElement("div",{className:"swc-dialog"},s.createElement("div",{className:"swc-dialog-controls"},s.createElement("button",{title:t,onClick:this._onCancelClick,dangerouslySetInnerHTML:{__html:e.iconCancel}})),s.createElement("div",{className:"swc-dialog-content"},s.createElement("h1",null,i),this.getContentElement()),s.createElement("div",{className:"buttons"},s.createElement("button",{className:"action confirm",title:n,"aria-label":n,onClick:this._onConfirmClick},n),s.createElement("button",{className:"action cancel",title:t,"aria-label":t,onClick:this._onCancelClick},t)))},t}(o.Component);t.Dialog=c},,,function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(4),a=n(0),c=n(45),l=s.ApiEvents.conversationProxy;!function(e){e.Bridged="bridged",e.Unbridged="unbridged"}(t.DeliveryMode||(t.DeliveryMode={})),function(e){e[e.CONFIRMED=0]="CONFIRMED",e[e.CANCELED=1]="CANCELED"}(o=t.DialogResult||(t.DialogResult={}));var u=function(e){function t(t){var n=e.call(this,t)||this;return n.isInputDisabled=!1,n.dialogs={},n.actions={},n}return r(t,e),t.prototype.init=function(){this.conversationId=this.data.conversationId},t.prototype.sendMessageToBot=function(e){var t=this.createCID(),n={botId:this.conversationId,content:e,botMessageId:t},i=new Promise(function(e,n){var i=function(r){t===r.botMessageId&&(a.swc.API.unregisterEvent(s.ApiEvents.invoke.sendMessageToBotResponse,i),r.success?e():n())};a.swc.API.registerEvent(s.ApiEvents.invoke.sendMessageToBotResponse,i)});return this.exec(s.ApiEvents.invoke.sendMessageToBot,n),i},t.prototype.openEmoticonPicker=function(){this.isInputDisabled||this.exec(l.toggleEmoticonPicker,{id:this.conversationId,open:!0})},t.prototype.closeEmoticonPicker=function(){this.exec(l.toggleEmoticonPicker,{id:this.conversationId,open:!1})},t.prototype.openFilePicker=function(){this.exec(l.openFilePicker,this.conversationId)},t.prototype.setInputPlaceholder=function(e){this.exec(l.setInputPlaceholder,{id:this.conversationId,text:e})},t.prototype.setInputText=function(e){this.exec(l.setInputText,{id:this.conversationId,text:e})},t.prototype.setMessageProperties=function(e){var t={deliveryMode:e?e.deliveryMode:"",tag:e?e.tag:""};this.exec(l.setMessageProperties,{id:this.conversationId,props:t})},t.prototype.connect=function(){this.exec(l.connected,{id:this.conversationId,connected:!0})},t.prototype.disconnect=function(){this.exec(l.connected,{id:this.conversationId,connected:!1})},t.prototype.setActionBar=function(e){for(var t=this,n=[],i=0,r=e;i<r.length;i++){var o=r[i],s=this.createCID();this.actions[s]=o.handler,n.push({CID:s,name:o.name,className:o.className,title:o,text:o.text})}this.exec(l.setActionBar,{id:this.conversationId,definition:n}),this.reg(l.resActionBar,function(e){t.actions[e]&&t.actions[e]()})},t.prototype.showConfirmationDialog=function(e){var t=this,n=this.createCID();this.dialogs[n]=e;this.reg(l.resShowConfirmationDialog,function(e){t.resolveDialog(e.CID,e.res)}),this.exec(l.showConfirmationDialog,{id:this.conversationId,dialog:{CID:n,title:e.title,description:e.description,confirmationButtonTitle:e.confirmationButtonTitle,cancelButtonTitle:e.cancelButtonTitle}})},t.prototype.disableInput=function(){this.isInputDisabled=!0,this.exec(l.disableInput,{id:this.conversationId,disable:!0})},t.prototype.enableInput=function(){this.isInputDisabled=!1,this.exec(l.disableInput,{id:this.conversationId,disable:!1})},t.prototype.expand=function(){this.exec(l.expand,{id:this.conversationId})},t.prototype.focusInput=function(){this.exec(l.focusInput,{id:this.conversationId})},t.prototype.onUnreadCount=function(e){var t=this;this.exec(l.regUnreadCount,{id:this.conversationId,refId:this.refId}),this.reg(l.unreadCount,function(n){n.refId===t.refId&&e(n.count)})},t.prototype.onMessageReceived=function(e){var t=this;this.exec(l.regMessageReceived,{id:this.conversationId,refId:this.refId}),this.reg(l.messageReceived,function(n){n.refId===t.refId&&e(n.message)})},t.prototype.onFileDownload=function(e){var t=this;this.exec(l.regDownload,{id:this.conversationId,refId:this.refId}),this.reg(l.resDownload,function(n){n.refId===t.refId&&e(n.url)})},t.prototype.resolveDialog=function(e,t){var n=this.dialogs[e];n&&(t===o.CONFIRMED?n.onConfirm():n.onCancel(),delete this.dialogs[e])},t}(c.Proxy);t.ConversationProxy=u},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=n(6),o=n(1),s=n(23),a=n(10),c=n(0),l=n(11),u=function(){function e(e){var t=this;this._element=e,this.init=function(e){void 0===e&&(e=!0),e&&(o.default.instance.SignInManager.unsubscribe("isSignedIn",t.init),o.default.instance.MePersonManager.fetch().then(function(e){c.swc.Calling.init(t._element,e.id,null,null,{onCallStatusChange:t._onCallStatusChange,onRegistryUpdate:t._onRegistryUpdate},r.default,null,null,r.default.get.selectedDevices||null).then(function(){var e;r.default.get.callingReady=!0,e=!r.default.get.standaloneCalling||!c.swc.CallingControl||{threadId:c.swc.CallingControl.threadId},c.swc.API.triggerEvent(i.ApiEvents.CallingReady,e),c.swc.API.registerEvent(i.ApiEvents.StartCall,t._startCall),c.swc.API.registerEvent(i.ApiEvents.AcceptCall,t._acceptCall),c.swc.API.registerEvent(i.ApiEvents.RejectCall,t._rejectCall),c.swc.API.registerEvent(i.ApiEvents.UpdateCallingScreen,t._updateCallingScreen),c.swc.API.registerEvent(i.ApiEvents.OnCallEnd,t._endCall),t._ready=!0},function(){return c.swc.API.triggerEvent(i.ApiEvents.CallingReady,!1)})}))},this._onCallStatusChange=function(e){return t._callState=e},this._onRegistryUpdate=function(e){return t._disableTransition()},this._disableTransition=function(){t._element.parentElement&&t._element.parentElement.classList.add("no-transition")},this._endCall=function(){var e=!r.default.get.standaloneCalling&&c.swc.ChatContent;e&&t._activeCallMri&&e.getConversationTuple(t._activeCallMri).then(function(e){e?(e.alwaysOnStage=!1,e.container.removeChild(t._element)):l.default.throwError(a.ErrorCodes.ERR_HIDE_CALLING_SCREEN,"Unable to hide calling screen - no such conversation")})},this._updateCallingScreen=function(e){t._activeCallMri=e;var n=!r.default.get.standaloneCalling&&c.swc.ChatContent;n&&n.getConversationTuple(e).then(function(e){e.alwaysOnStage=!0,e.container.appendChild(t._element),t._disableTransition()}).catch(function(){l.default.throwError(a.ErrorCodes.ERR_UPDATE_CALLING_SCREEN,"Unable to update calling screen - no such conversation")})},this._startCall=function(e){if(t._ready){t._updateCallingScreen(e.calleeId);var n=function(){c.swc.Calling.startCall(e.calleeId,e.withVideo,{avatarURI:e.avatarUrl,displayName:e.displayName},e.isGroup)};t._callState&&7!==t._callState||(e.isGroup?n():o.default.instance.WebApi.getUsersPresence([e.calleeId]).then(function(t){var i=t.Responses;i&&"Online"===i[0].Payload.availability||c.swc.API.triggerEvent("calleeUnavailable",{mri:e.calleeId,withVideo:e.withVideo});n()}))}},this._rejectCall=function(e){t._ready&&c.swc.Calling.rejectCallById(e.id)},this._acceptCall=function(e){t._ready&&(e.threadId?t._joinGroupCall(e):(t._updateCallingScreen(e.callerMri),c.swc.Calling.acceptCallById(e.id)))},this._element.innerHTML="";var n=o.default.instance.SignInManager;n.state===s.SigninState.SignedIn?this.init():n.subscribe("isSignedIn",this.init)}return e.prototype._joinGroupCall=function(e){this._updateCallingScreen(e.threadId),c.swc.Calling.acceptCallByThreadId(e.threadId)||c.swc.Calling.startCall(e.threadId,e.withVideo,{avatarURI:e.avatarUrl,displayName:e.displayName},e.isGroup)},e}();t.CallingView=u},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(13),a=n(0),c=n(6),l=n(32),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.init=function(){a.swc.MePersonManager=a.swc.MePersonManager||new t},t.prototype.getDetails=function(){var e=this;this._getDetailsPromise||o.default.instance.SignInManager.userIdentityType!==l.IdentityType.GUEST&&(o.default.instance.WebApi.fetchMeProperties().then(function(t){e.fillDetails(t)}),o.default.instance.WebApi.getMyPresence().then(function(t){t&&t.status&&(e.mePerson.presenceStatus=t.status)}),this.mePerson.fetchDisplayNameAndAvatar())},t.prototype.fillDetails=function(e){if(e)if(c.default.get.backend===s.MessagingBackend.TEAMS){var t=e.userDetails?JSON.parse(e.userDetails):{},n=e.personalFileSite?JSON.parse(e.personalFileSite):{};n&&(this.mePerson.personalFileSite=n),t.name&&(this.mePerson.displayName=t.name),t.avatarUrl&&(this.mePerson.avatarData=t.avatarUrl),this.mePerson.msaId=t.upn}else this.mePerson.msaId=e.cid},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._getDetailsPromise=null},t}(n(134).default);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),r=n(2),o=n(1),s=n(48),a=n(32),c=n(434),l=n(215),u=n(0),d=n(435),p=function(){function e(e,t,n){var r=this;this.componentConfig=t,this.element=n,this.signinEnabled=ko.observable(!1),this.cannot_sign_in=ko.observable(o.default.instance.i18n.fetch("you_cannot_sign_in_when_guest_only_mode_enabled")),this.sign_in_welcome=ko.observable(o.default.instance.i18n.fetch("sign_in_welcome")),this.sign_in=ko.observable(o.default.instance.i18n.fetch("sign_in")),this.sign_in_cancel=ko.observable(o.default.instance.i18n.fetch("sign_in_cancel")),this.do_not_have_account=ko.observable(o.default.instance.i18n.fetch("do_not_have_account")),this.sign_up=ko.observable(o.default.instance.i18n.fetch("sign_up")),this.signIn=function(){r.signinEnabled()&&o.default.instance.SignInManager.login(function(e){r.isSignedIn(!!e)})},this.isSignedIn=e.isSignedIn,this.isGuestOnlyMode=i.default.get.isGuestOnlyMode,this.isConversationWithPerson=e.isConversationWithPerson,this.explicitSignInRequired=e.explicitSignInRequired,this.signinEnabled(o.default.instance.isCleared||this.explicitSignInRequired||this.isConversationWithPerson&&o.default.instance.SignInManager.userIdentityType===a.IdentityType.GUEST),o.default.instance.subscribe("isCleared",this.applicationClearedHandler.bind(this));var s=new d.default(this),l="msn"===t.Style?this.signInTemplateMSN():this.signInTemplate();s.render(l,n),o.default.instance.TelemetryService.sendEvent(new c.default)}return e.prototype.close=function(){i.default.get.frameless?u.swc.SDK.Chat.resolveMessage({origin:r.default.ORIGIN,action:s.default.HideChatWindow}):parent&&parent.postMessage({origin:r.default.ORIGIN,action:s.default.HideChatWindow},document.referrer||"*");var e=new l.VisibilityChangedEvent(!1);o.default.instance.TelemetryService.sendEvent(e)},e.prototype.applicationClearedHandler=function(){this.signinEnabled(o.default.instance.isCleared)},e.prototype.signInTemplate=function(){var e=i.default.get.isTeams()?"<icon-chats></icon-chats>":"<skype-logo></skype-logo>";return'\n            <div class="sign-in-wrapper">\n                <div class="sign-in-row close">\n                '+(this.componentConfig.CanClose?'<button tabindex="0" class="sign-in-cancel" onClick={close}>\n                        <icon-cancel class="svg-icon"></icon-cancel>\n                      </button>':"")+'\n                </div>\n                <div class="sign-in-content">\n                    '+e+"\n\n                    "+(this.isGuestOnlyMode?'\n                            <div tabindex="0" aria-label="'+this.cannot_sign_in()+'" data-bind="text: \''+this.cannot_sign_in()+'\'">\n                                You cannot signin when "guestonly" mode enabled.\n                            </div>':'\n                            <div tabindex="0" aria-label="'+this.sign_in_welcome()+'" data-bind="text: \''+this.sign_in_welcome()+'\'">\n                                Please sign in to start chatting.\n                            </div>\n                            <button tabindex="0" data-bind="text: \''+this.sign_in()+'\'" class="sign-in-button" onClick={signIn}>Sign in</button> ')+'\n                </div>\n                <div class="sign-in-row signup">\n                    <div tabindex="0" aria-label="'+this.do_not_have_account()+' " data-bind="text: \''+this.do_not_have_account()+'\'">\n                        Don\'t have an account? \n                    </div>\n                    <a href="https://go.skype.com/signup?client_id=578134&redirect_uri=https%3A%2F%2Fweb.skype.com" target="_blank" data-bind="text: \''+this.sign_up()+"'\">Sign up</a>\n                </div>\n            </div>\n        "},e.prototype.signInTemplateMSN=function(){var e=u.swc.Assets.SVG;return'\n            <div class="sign-in-wrapper msn">\n                <div class="sign-in-section top">\n                    <div class="sign-in-section title">'+o.default.instance.i18n.fetch("msn_signin_screen_title")+'</div>\n                    <ul class="sign-in list">\n                        <li>\n                            <div class="icon">'+e.iconContact+'</div>\n                            <div class="text">'+o.default.instance.i18n.fetch("msn_signin_screen_contacts")+'</div>\n                        </li>\n                        <li>\n                            <div class="icon">'+e.iconOk+'</div>\n                            <div class="text">'+o.default.instance.i18n.fetch("msn_signin_screen_recents")+'</div>\n                        </li>\n                        <li>\n                            <div class="icon">'+e.iconCallStart+'</div>\n                            <div class="text">'+o.default.instance.i18n.fetch("msn_signin_screen_calling_messaging")+'</div>\n                        </li>\n                    </ul>\n                </div>\n\n                <div class="sign-in-section bottom">\n                    <div class="sign-in-row title">'+o.default.instance.i18n.fetch("msn_signin_screen_connect")+'</div>\n\n                    <div class="sign-in-row microsoft">\n                        <div class="icon">\n                            <div class="cubes">\n                                <span class="cube"></span>\n                                <span class="cube"></span>\n                            </div>\n                            <div class="cubes">\n                                <span class="cube"></span>\n                                <span class="cube"></span>\n                            </div>\n                        </div>\n                        <div class="text">'+o.default.instance.i18n.fetch("msn_signin_screen_connect_description")+'</div>\n                    </div>\n\n                    <div class="sign-in-row actions">\n                        <div class="signin">\n                            <div>'+o.default.instance.i18n.fetch("msn_signin_screen_sign_in_has_account")+'</div>\n                            <button href="#" class="action" onClick={signIn}>'+o.default.instance.i18n.fetch("msn_signin_screen_sign_in_button")+'</button>\n                        </div>\n\n                        <div class="signup">\n                            <div>'+o.default.instance.i18n.fetch("msn_signin_screen_sign_in_no_account")+'</div>\n                            <button><a class="action" href="https://go.skype.com/signup?client_id=578134&redirect_uri=https%3A%2F%2Fweb.skype.com" target="_blank">'+o.default.instance.i18n.fetch("msn_signin_screen_create_account_button")+"</a></button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        "},e}();t.default=p},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(5),a=function(e){function t(){return e.call(this,"kpi_authpage_landing")||this}return r(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(s.TelemetryPropertyValue.Create("reason",this.getReason())),e},t.prototype.getReason=function(){switch(o.default.instance.SignInManager.lastAuthSource){case 50:return"userLogout";default:return"authFailure"}},t}(n(8).TelemetryEvent);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.attributeMap={onClick:"click"},this.context=e}return e.prototype.processEventAttribute=function(e,t){var n=new RegExp(e+"={(.*[^}])}","g");return t.replace(n,'data-swc-event-attribute="'+this.attributeMap[e]+'-$1"')},e.prototype.render=function(e,t){for(var n in this.attributeMap)e=this.processEventAttribute(n,e);t.innerHTML=e;for(var i=t.querySelectorAll("[data-swc-event-attribute]"),r=0;r<i.length;r++){var o=i[r].getAttribute("data-swc-event-attribute").split("-");try{var s=o[0],a=this.context[o[1]];i[r].addEventListener(s,a)}catch(e){}}},e}();t.default=i},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s=n(1),a=n(42),c=n(0),l=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r.showContacts=ko.observable(!1),r.showSpinner=ko.observable(!1),r._onLoaded=function(e){if(r.mainContainer&&e.contacts.length){var t=r.createContactsFragment(r.createContactVM(e.contacts));r.mainContainer.appendChild(t),r.showSpinner(!1),e.contacts.length&&r.showContacts(!0)}},r._onError=function(e){r.showSpinner(!1)},r._executeLastSearchQuery=function(e){e&&r._lastSearchQuery&&r._startSearchingInService(r._lastSearchQuery)},r._onSearchResults=function(e,t,n){r.showSpinner(!1);for(var i=!1,o=0;o<e.length;o++){var s=e[o],c=a.default.normalizePersonId(s.skypeid).toLowerCase(),l=s.name.toLowerCase();(c.indexOf(t)>-1||l.indexOf(t)>-1)&&(n&&n.items&&r.isInRecents(n.items,s.skypeid)?r.hideItem(c):s.favorite||(r.showItem(c),i=!0))}r.showContacts(i)},r._startSearchingInService=function(e,t){r.hideAllItems(),r.showContacts(!1),s.default.instance.SearchManager.searchInContacts(e).then(function(n){return r._onSearchResults(n,e,t)},function(){r.showSpinner(!1)})},r._searchContacts=function(e){if(e.id===r.correlationId){if(!e.key)return r.showAllItems(e.recents),void r.showContacts(!0);r.initialized()?r._startSearchingInService(e.key,e.recents):r._lastSearchQuery=e.key}},r.contactsText=s.default.instance.i18n.fetch("text_contacts"),r.mainContainer=i.querySelector(".contactListVM .contactsWrapper"),c.swcWindow.swc.API.registerEvent(o.SearchEvents.SEARCH_START,r._searchContacts),c.swcWindow.swc.API.registerEvent(o.SearchEvents.EMPTY_QUERY,function(e){e===r.correlationId&&(r.showAllItems(),r.showContacts(!0))}),r.initialized.subscribe(r._executeLastSearchQuery),r.fetchContacts().then(r._onLoaded,r._onError),r}return r(t,e),t}(n(349).default);t.default=l},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=function(e){function t(){return e.call(this,"contacts_load")||this}return r(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(o.TelemetryPropertyValue.Create("total",this.total)),e.push(o.TelemetryPropertyValue.Create("pstn",this.pstn)),e.push(o.TelemetryPropertyValue.Create("person",this.person)),e.push(o.TelemetryPropertyValue.Create("agents",this.agents)),e.push(o.TelemetryPropertyValue.Create("ttl",this.ttl)),e},t}(n(8).TelemetryEvent);t.default=s},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s=n(1),a=n(42),c=n(0),l=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r.showFavorites=ko.observable(!1),r._favoritesList=[],r._onLoaded=function(e){var t=e.contacts.filter(function(e){return e.favorite});if(t.length&&r.favoritesContainer){var n=r.createContactsFragment(r.createContactVM(t));r.favoritesContainer.appendChild(n),r._hasSomeFavorites=!!t.length,r.showFavorites(r._hasSomeFavorites),c.swc.API.triggerEvent(o.ScrollEvents.SCROLL_RECOUNT,{id:r.correlationId})}},r._executeLastSearchQuery=function(e){e&&r._lastQuery&&r._searchInFavorites(r._lastQuery)},r._showAllItems=function(e){Object.keys(r.contactVMsMap).forEach(function(e){r.contactVMsMap[e].visible=!0})},r._starSearchInFavorites=function(e){if(e.id===r.correlationId){if(!e.key)return r._showAllItems(),void r.showFavorites(r._hasSomeFavorites);r.initialized()?r._searchInFavorites(e.key,e.recents):r._lastQuery=e.key}},r._searchInFavorites=function(e,t){if(e){var n=!1;r.hideAllItems(),r.showFavorites(!1),Object.keys(r.contactVMsMap).forEach(function(i){var o=r.contactVMsMap[i],s=o.person.mri.toLowerCase(),c=a.default.normalizePersonId(o.person.mri),l=o.person.displayName.toLowerCase();(s.indexOf(e)>-1||l.indexOf(e)>-1)&&(t&&t.items&&r.isInRecents(t.items,s)?r.hideItem(c):o.alreadyParticipant||(r.showItem(c),n=!0))}),r.showFavorites(n)}},r.participants=r.conversation?r.conversation.participants:null,r.favoritesText=s.default.instance.i18n.fetch("text_favorites_contacts"),r.favoritesContainer=i.querySelector(".favoritesWrapper"),c.swcWindow.swc.API.registerEvent(o.SearchEvents.SEARCH_START,r._starSearchInFavorites),c.swcWindow.swc.API.registerEvent(o.SearchEvents.EMPTY_QUERY,function(e){e===r.correlationId&&(r.showAllItems(),r.showFavorites(r._hasSomeFavorites))}),r.initialized.subscribe(r._executeLastSearchQuery),r.fetchContacts().then(r._onLoaded,function(){}),r}return r(t,e),t}(n(349).default);t.default=l},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),s=n(9),a=n(67),c=n(361),l=n(132),u=function(e){function t(t){var n=e.call(this,t)||this;return n._onAvatarUpdate=function(e){n.setState({avatarUrl:e})},n._onTopicUpdate=function(e){n.setState({title:e})},n.state={title:"",avatarUrl:"",isPerson:!1,isPstn:!1},n}return r(t,e),t.prototype.componentDidMount=function(){var e=this.props.item;this.setState({isPerson:e.isPerson,isPstn:e.isPstn}),e.isPerson||(this._onTopicUpdate(e.topic),e.subscribe("topic",this._onTopicUpdate),e.isPstn||(this._onAvatarUpdate(e.avatar),e.subscribe("avatar",this._onAvatarUpdate)))},t.prototype.componentWillUnmount=function(){var e=this.props.item;e.unsubscribe("avatar",this._onAvatarUpdate),e.unsubscribe("topic",this._onTopicUpdate)},t.prototype.render=function(){return this.state.isPstn?s.createElement(l.PstnAvatar,{title:this.state.title}):this.state.isPerson?s.createElement(c.PersonIdAvatar,{personId:this.props.item.id,showPresence:!0}):s.createElement(a.BasicAvatar,{title:this.state.title,avatarUrl:this.state.avatarUrl})},t}(o.Component);t.RecentAvatar=u},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),s=n(9),a=n(0),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onChatClick=function(e){t.props.onChatClick&&t.props.onChatClick(),e.preventDefault()},t._onAudioClick=function(e){t.props.onAudioClick&&t.props.onAudioClick(),e.preventDefault()},t._onVideoClick=function(e){t.props.onVideoClick&&t.props.onVideoClick(),e.preventDefault()},t}return r(t,e),t.prototype.render=function(){var e=a.swc.Assets.SVG;return s.createElement("div",{className:"inlineactions"},s.createElement("button",{className:"action chat",onClick:this._onChatClick,dangerouslySetInnerHTML:{__html:e.iconMessage}}),s.createElement("button",{className:"action audiocall",onClick:this._onAudioClick,dangerouslySetInnerHTML:{__html:e.iconCallStart}}),s.createElement("button",{className:"action videocall",onClick:this._onVideoClick,dangerouslySetInnerHTML:{__html:e.iconVideo}}))},t}(o.Component);t.default=c},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),s=n(9),a=n(1),c=n(7),l=n(0),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){var e,n,i=l.swc.Assets.SVG,r=this.props.message;if(r.isDeleted)e="",n="";else switch(r.type){case c.MessageType.UserMessage:t._isCallMessage(r.customType)?(e=i.iconCallEnd,n=r.content):r.imageContent?(e=i.iconImage,n=a.default.instance.i18n.fetch("message_text_photo")):n=r.content;break;case c.MessageType.LwcImage:e=i.iconImage,n=a.default.instance.i18n.fetch("message_text_photo");break;case c.MessageType.LwcFile:e=i.iconFile,n=r.content;break;default:n=r.content}return s.createElement("div",{className:"lastMessageContainer"},e&&s.createElement("span",{className:"messageIcon",dangerouslySetInnerHTML:{__html:e}}),s.createElement("p",{className:"lastMessage",dangerouslySetInnerHTML:{__html:n}}))},t._isCallMessage=function(e){return[c.CustomMessageType.CallEnd,c.CustomMessageType.MissedCall,c.CustomMessageType.MissedGroupCall].indexOf(e)>-1},t}(o.Component);t.MessagePreview=u},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),s=n(9),a=n(1),c=n(362),l=function(e){function t(t){var n=e.call(this,t)||this;return n.state={timestamp:""},n}return r(t,e),t.prototype.componentWillReceiveProps=function(e){this.setState({timestamp:t._resolveTimestamp(e.date)})},t.prototype.componentDidMount=function(){var e=this;this._updateTimestampInterval=setInterval(function(){e.setState({timestamp:t._resolveTimestamp(e.props.date)})},6e4)},t.prototype.componentWillUnmount=function(){this._updateTimestampInterval&&clearInterval(this._updateTimestampInterval)},t.prototype.render=function(){return s.createElement("p",null,this.state.timestamp)},t._resolveTimestamp=function(e){if(!e)return"";var t=e.getTime();if(c.default.isWithinLastHour(t)){var n=c.default.getDifferenceForLastHour(t);return 0===n?a.default.instance.i18n.fetch("right_now"):a.default.instance.i18n.fetch("time_minutes_ago",{minutes:n})}return c.default.toStringMesssageDate(t)},t}(o.Component);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(62),r=n(4),o=n(1),s=n(0),a=n(243),c=n(352),l="",u=400,d=function(){function e(e,t,n){var d=this;this._params=e,this.recentsDataConfig=t,this.element=n,this.inSearchMode=ko.observable(!1),this.searchQuery=ko.observable(l),this.lastSearchQuery=l,this.onQueryChanged=function(e){if(e=(e||"").trim().toLowerCase(),d._setSearchVisibility(!!e),s.swc.API.triggerEvent(r.SearchEvents.SEARCH_START,{key:e,searchMode:d.inSearchMode(),id:d.correlationId}),!e)return s.swc.API.triggerEvent(r.SearchEvents.EMPTY_RESULTS),void(d.lastSearchQuery=l);d.searchDebounceTimeout(e)},this.cleanQuery=function(e){e===d.correlationId&&(d.emptySearchInput(),d.inSearchMode(!1))},this.focusSearchArea=function(){d._searchInput&&window.setTimeout(function(){return d._searchInput.focus()},100)},this._createContactListVM=function(e){e===d.correlationId&&(d.inSearchMode(!0),s.swc.API.triggerEvent(r.SearchEvents.TOGGLE_RESULTS_COMPONENT,{val:!0,id:d.correlationId}),s.swc.API.triggerEvent(r.SearchEvents.SEARCH_START,{searchMode:d.inSearchMode(),id:d.correlationId}))},this.onClick=function(e,t){d.inSearchMode()||d._createContactListVM(d.correlationId),t.preventDefault(),t.stopPropagation()},this._setSearchVisibility=function(e){d.settings.showContactListAsDefault||(d.inSearchMode(e),s.swc.API.triggerEvent(r.SearchEvents.TOGGLE_RESULTS_COMPONENT,{val:e,id:d.correlationId}))},this.onCancelingSearch=function(e,t){d._escapeFromSearchMode(),t.preventDefault(),t.stopPropagation()},this._escapeFromSearchMode=function(){d.emptySearchInput(),s.swc.API.triggerEvent(r.SearchEvents.EMPTY_RESULTS,{id:d.correlationId}),d._setSearchVisibility(!1),s.swc.API.triggerEvent(r.SearchEvents.SEARCH_START,{searchMode:d.inSearchMode(),id:d.correlationId})},this.onKeyDown=function(e,t){var n=t.which||t.keyCode;return n===a.default.ESCAPE?(d.inSearchMode()&&(d._escapeFromSearchMode(),t.preventDefault(),t.stopPropagation()),!1):n!==a.default.BACKSPACE||d.searchQuery()?n!==a.default.ENTER:(t.preventDefault(),!1)},this.cancelSearchViewText=o.default.instance.i18n.fetch("sign_in_cancel"),this.searchText=o.default.instance.i18n.fetch("search"),this.settings=e.settings||c.DEFAULT_SETTINGS,this.correlationId=e.id,this._searchInput=n.querySelector?n.querySelector("input.searchContactsInput"):null,this.searchQuery.subscribe(function(e){return d.onQueryChanged(e)}),s.swc.API.registerEvent(r.SearchEvents.EMPTY_QUERY,this.cleanQuery),s.swc.API.registerEvent(r.SearchEvents.SEARCH_CREATE_CONTACTLIST,this._createContactListVM),s.swc.API.registerEvent(r.SearchEvents.FOCUS_SEARCH_INPUT,function(e){e===d.correlationId&&d.focusSearchArea()}),this.searchDebounceTimeout=i(function(e){e!==d.lastSearchQuery&&(s.swc.API.triggerEvent(r.SearchEvents.UPDATE_SEARCH_RESULTS,{query:e,id:d.correlationId}),d.lastSearchQuery=e)},u,{leading:!0}),this.focusSearchArea()}return e.prototype.emptySearchInput=function(){this.searchQuery(l),this.lastSearchQuery=l,this.focusSearchArea()},e.prototype.dispose=function(){this.emptySearchInput()},e}();t.default=d},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=function(e){function t(t){var n=e.call(this,"contacts_search")||this;return n.keywordsLength=t.trim().length,n.keywords=t.trim().split(/\s+/).length,n}return r(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(o.TelemetryPropertyValue.Create("keywords",this.keywords)),e.push(o.TelemetryPropertyValue.Create("keywordsLength",this.keywordsLength)),e},t}(n(8).TelemetryEvent);t.default=s},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=function(e){function t(){return e.call(this,"kpi_search_action")||this}return r(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(o.TelemetryPropertyValue.Create("total",this.total)),e.push(o.TelemetryPropertyValue.Create("actionType",this.actionType)),e.push(o.TelemetryPropertyValue.Create("openItemType",this.openItemType)),e},t}(n(8).TelemetryEvent);t.default=s;var a=function(){function e(){}return e.OpenChat="openChat",e.Cancel="cancel",e}();t.ActionType=a},function(e,t){e.exports="\r\n"},function(e,t){e.exports='<div class="searchInput">\r\n    <span class="searchInputWrapper">\r\n        \x3c!-- ko if: settings.showSearchIcon --\x3e\r\n        <swc-recents-icon-search></swc-recents-icon-search>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        <input class="searchContactsInput" data-bind="\r\n            textInput: searchQuery,\r\n            attr: {\r\n                placeholder: settings.placeHolder ? searchText : \'\'\r\n            },\r\n            event: { keydown: onKeyDown, click: onClick }" />\r\n    </span>\r\n\r\n    \x3c!-- ko if: settings.isRecentListComponent --\x3e\r\n    <button class="iconClose" tabindex="0" data-bind="click: onCancelingSearch, visible: inSearchMode(),\r\n        attr: { title: cancelSearchViewText, \'aria-label\': cancelSearchViewText}">\r\n        <swc-recents-icon-cancel class="icon close"></swc-recents-icon-cancel>\r\n    </button>\r\n    \x3c!-- /ko --\x3e\r\n</div>'},function(e,t){e.exports='<div class="searchResultsWrapper">\r\n    <div class="favoritesListVM" data-bind="\r\n        visible: inSearchMode(),\r\n        component: {\r\n            name: \'favorites-list\',\r\n            params: { action: startChatAction, id: correlationId, conversation: conversation }\r\n        }"></div>\r\n    <div data-bind="visible: inSearchMode()">\r\n        \x3c!-- ko if: chatResultsCount() > 0 --\x3e\r\n        <div class="searchHeader" data-bind="visible: settings.showHeaders">\r\n            <h3 data-bind="text: chatsText"></h3>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        <div class="chatResultsWrapper"></div>\r\n\r\n        <div class="contactListVM" data-bind="component: {\r\n            name: \'contact-list\',\r\n            params: { action: startChatAction, id: correlationId, conversation: conversation }\r\n        }"></div>\r\n\r\n        <div class="searchHeader" data-bind="visible: settings.showCounter && hasSomeResults">\r\n            <h3 data-bind="text: resultsCountText()"></h3>\r\n        </div>\r\n\r\n        \x3c!-- ko if: peopleResultsCount() > 0 --\x3e\r\n        <div class="searchHeader" data-bind="visible: settings.showHeaders">\r\n            <h3 data-bind="text: peopleText"></h3>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        <div class="contactsPeopleWrapper"></div>\r\n\r\n        \x3c!-- ko if: botsResultsCount() > 0 --\x3e\r\n        <div class="searchHeader" data-bind="visible: settings.showHeaders">\r\n            <h3 data-bind="text: botsText"></h3>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        <div class="contactsBotWrapper"></div>\r\n    </div>\r\n</div>'},function(e,t){e.exports='<div class="contactsHeader" data-bind="visible: showContacts()">\r\n    <h3 data-bind="text: contactsText"></h3>\r\n</div>\r\n\r\n<div class="spinner" data-bind="visible: showSpinner()"><div class="wheel"></div></div>\r\n\r\n<div class="contactsWrapper"></div>'},function(e,t){e.exports='<div class="contactsHeader" data-bind="visible: showFavorites()">\r\n    <h3 data-bind="text: favoritesText"></h3>\r\n</div>\r\n\r\n<div class="favoritesWrapper" data-bind="visible: showFavorites()"></div>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(459),r="no-transition",o=function(){function e(){var e=this;this.players=function(){return e._players},this.terminatedMedia=function(){return e._terminatedMedia},this.pauseAll=function(){e.players().forEach(function(e){e.pause(),e.mute&&e.mute(!0)})},this.registerPlayer=function(e){var t={id:e.id,isInFullscreen:e.isInFullscreen,pause:e.pause,play:e.play,mute:e.mute?e.mute:null,type:e.mediaType,isPlaying:e.isPlaying,autoplay:e.autoplay,isQueuedForPlaying:e.isQueuedForPlaying,triggeredByUser:e.triggeredByUser};this.players().push(t)},this.removePlayer=function(t){var n=e.getPlayerById(t);n&&e.players().splice(e.players().indexOf(n),1)},this.getPlayerById=function(t){var n;return e.players().forEach(function(e){e.id===t&&(n=e)}),n},this.getPlayingMedia=function(){var t;return e.players().forEach(function(e){(e.isPlaying()||e.isQueuedForPlaying())&&(t=e)}),t},this.onEnteringFullscreen=function(t){e.mainComponentElement&&e.mainComponentElement.classList.add(r),e.playerInFullscreen=t},this.onLeavingFullscreen=function(){e.mainComponentElement&&e.mainComponentElement.classList.remove(r),e.playerInFullscreen=null},this.onFullScreenChanged=function(t){if(!(t.target&&(t.target.id&&"yt_msg_"===t.target.id.substring(0,7)||t.target.activeElement&&t.target.activeElement.id&&"yt_msg_"===t.target.activeElement.id.substring(0,7)))){var n=document,i=!!(n.fullscreenElement||n.mozFullScreenElement||n.webkitFullscreenElement||n.msFullscreenElement);e.playerInFullscreen&&e.playerInFullscreen.isInFullscreen(i),i||e.onLeavingFullscreen()}},this.onClientBlurred=function(){var t=e.getPlayingMedia();t&&!t.triggeredByUser()&&(t.pause(),e.terminatedMedia=t)},this.onClientFocused=function(){e.terminatedMedia&&e.terminatedMedia().play&&(e.terminatedMedia().play(),e.terminatedMedia=null)},this.dispose=function(){document.removeEventListener("webkitfullscreenchange",e.onFullScreenChanged),document.removeEventListener("mozfullscreenchange",e.onFullScreenChanged),document.removeEventListener("MSFullscreenChange",e.onFullScreenChanged),document.removeEventListener("fullscreenchange",e.onFullScreenChanged),document.removeEventListener(i.default.events.browser.BLUR,e.onClientBlurred),document.removeEventListener(i.default.events.browser.FOCUS,e.onClientFocused)}}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e,e._instance.init()),e._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this._players=[],this._terminatedMedia=null,this.mainComponentElement=document.querySelector(".swc.main-component"),document.addEventListener("webkitfullscreenchange",this.onFullScreenChanged),document.addEventListener("mozfullscreenchange",this.onFullScreenChanged),document.addEventListener("MSFullscreenChange",this.onFullScreenChanged),document.addEventListener("fullscreenchange",this.onFullScreenChanged),document.addEventListener(i.default.events.browser.BLUR,this.onClientBlurred),document.addEventListener(i.default.events.browser.FOCUS,this.onClientFocused)},Object.defineProperty(e.prototype,"playerInFullscreen",{get:function(){return this._playerInFullscreen},set:function(e){e!==this._playerInFullscreen&&(this._playerInFullscreen=e)},enumerable:!0,configurable:!0}),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),r=n(9),o=n(1),s=n(0),a=n(76),c=function(){return function(e,t,n,c){var l=this;this.element=t,this.selectedForRemoval=ko.observable(),this.removeParticipantText=o.default.instance.i18n.fetch("new_chat_button_remove_selection"),this.person=e,this.containerElement=t,this.participantEl=document.createElement("div"),this.participantEl.classList.add("actionItem"),n&&this.participantEl.addEventListener("click",n.bind(null,this)),c?(c()&&(this.participantEl.classList.add("canRemove"),this.participantEl.setAttribute("aria-label",this.removeParticipantText),this.participantEl.setAttribute("title",this.removeParticipantText)),c.subscribe(function(e){var t="";e&&(l.participantEl.classList.add("canRemove"),t=l.removeParticipantText),l.participantEl.setAttribute("aria-label",t),l.participantEl.setAttribute("title",t)})):(this.participantEl.setAttribute("aria-label",this.removeParticipantText),this.participantEl.setAttribute("title",this.removeParticipantText));var u=document.createDocumentFragment(),d={person:this.person},p=r.createElement(a.PersonAvatar,d);i.render(p,u);var h=document.createElement("p");h.className="title",h.innerText=this.person.displayName,this.person.subscribe("displayName",function(e){h.innerText=e});var f=s.swc.Assets.SVG,g=document.createElement("button");g.className="cancel",g.innerText=this.removeParticipantText,g.innerHTML=f.iconCancel,g.setAttribute("aria-label",this.removeParticipantText),g.setAttribute("title",this.removeParticipantText),this.participantEl.appendChild(u),this.participantEl.appendChild(h),this.participantEl.appendChild(g),this.containerElement.appendChild(this.participantEl)}}();t.default=c},,,,function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),s=n(9),a=n(516),c=n(361),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){return this.props.conversation.isGroup()?s.createElement(a.GroupAvatar,{group:this.props.conversation,customAvatar:this.props.customAvatar,customTitle:this.props.customTitle}):s.createElement(c.PersonIdAvatar,{personId:this.props.conversation.id,showPresence:!0,customAvatar:this.props.customAvatar})},t}(o.Component);t.ConversationAvatar=l},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(2),a=n(1),c=n(24),l=n(41),u=n(30),d=n(5),p=n(8);!function(e){e.downloadClick="DownloadClick",e.downloadRetryClick="DownloadRetryClick",e.downloadCancelClick="DownloadCancelClick",e.downloadFailure="DownloadFailure",e.openClick="open_click"}(o=t.FileActions||(t.FileActions={}));var h=function(e){function t(t,n,i){var r=e.call(this,"file_action")||this;r.message=t,r.conversation=n,r.fileName=i,r.action=o.downloadClick;var s=n.getConversationType();return r.conversationId=s===l.ConversationType.PERSON?"":n.id,r.isBotConversation=s===l.ConversationType.AGENT,r}return r(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(d.TelemetryPropertyValue.Create("FileType",this.getFileType())),e.push(d.TelemetryPropertyValue.Create("Action",this.action)),e.push(d.TelemetryPropertyValue.Create("ClientMessageId",this.message.clientMessageId)),e.push(d.TelemetryPropertyValue.Create("MessageType",this.getMessageTypeName())),e.push(d.TelemetryPropertyValue.Create("MessageCorrelationId",this.getMessageCorrelationId(),u.PIIType.Identity)),e.push(d.TelemetryPropertyValue.Create("IsBotConversation",this.isBotConversation)),e.push(d.TelemetryPropertyValue.Create("ConversationId",this.conversationId)),e.push(d.TelemetryPropertyValue.Create("ConversationMembersCount",this.conversation.participants.length)),e.push(d.TelemetryPropertyValue.Create("IsGroupConversation",this.conversation.isGroup())),e.push(d.TelemetryPropertyValue.Create("IsEncryptedConversation",!1)),e.push(d.TelemetryPropertyValue.Create("IsHighlights",!1)),e.push(d.TelemetryPropertyValue.Create("DeviceInfo.BrowserName",c.default.getBrowserName())),e.push(d.TelemetryPropertyValue.Create("DeviceInfo.BrowserVersion",c.default.getBrowserVersion())),e.push(d.TelemetryPropertyValue.Create("DeviceInfo.OsName",c.default.getOsName())),e.push(d.TelemetryPropertyValue.Create("DeviceInfo.OsVersion",c.default.getOsVersion())),e.push(d.TelemetryPropertyValue.Create("AppInfo_Version",s.default.getUiVersion())),e.push(d.TelemetryPropertyValue.Create("Platform_Id",s.default.getPlatformId())),e},t.prototype.getFileType=function(){var e=this.fileName&&this.fileName.match(/\.(.*)$/i);return e&&e[1]?e[1]:""},t.prototype.getMessageTypeName=function(){var e="";switch(this.message.rawMessageType){case"RichText/Media_GenericFile":e="File"}return e},t.prototype.getMessageCorrelationId=function(){var e=this.conversation.id;return this.conversation.isPerson&&a.default.instance.MePersonManager.isMe(this.message.sender.id)&&(e=this.message.sender.mri),this.message.sender.mri+"|"+e+"|"+this.message.clientMessageId},t}(p.TelemetryEvent);t.default=h},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(28),a=n(451),c=n(460),l=s.default.getDocument(),u=60,d=".timeline",p=function(e){function t(t,n){var i=e.call(this,t)||this;return i.isInFullscreen=ko.observable(!1),i.play=function(){i.queuedForPlaying=!i.isLoaded,i.isLoaded?(i.player.play(),i.isPlaying(!0),i.onLoadedActionHandler=null):i.onLoadedActionHandler=i.play},i.pause=function(){i.queuedForPlaying=!1,i.touchedByUser=!1,i.isLoaded?(i.player.pause(),i.isPlaying(!1),i.onLoadedActionHandler=null):i.onLoadedActionHandler=i.pause},i.togglePlay=function(){i.player.paused||i.player.ended?(a.default.instance.pauseAll(),i.play(),i.mute(!1),i.touchedByUser=!0):i.pause()},i.getCurrentTime=function(){return i.formatTime(i.currentTimeUnformatted())},i.getTotalTime=function(){return i.formatTime(i.totalTimeUnformatted())},i.getPlayButtonText=function(){var e=i.isPlaying()?"mediaPlayer_pause":"mediaPlayer_play";return o.default.instance.i18n.fetch(e)},i.formatTime=function(e){var t=Math.round(e),n=0;return t>=u&&(t-=(n=parseInt((t/u).toString(),10))*u),i.addLeadingZero(n)+":"+i.addLeadingZero(t)},i.onTimeUpdated=function(){i.currentTimeUnformatted(i.player.currentTime),i.setProgress(i.currentTimeUnformatted()/i.totalTimeUnformatted()*100)},i.isQueuedForPlaying=function(){return i.queuedForPlaying},i.triggeredByUser=function(){return i.touchedByUser},i.dispose=function(){i.currentTime.dispose(),i.totalTime.dispose(),i.playButtonText.dispose(),a.default.instance.removePlayer(i.id)},i.isPlaying=ko.observable(!1),i.currentProgress=ko.observable("0"),i.progressBar=t.querySelector(d),i.currentTime=ko.computed(i.getCurrentTime),i.totalTime=ko.computed(i.getTotalTime),i.playButtonText=ko.computed(i.getPlayButtonText),i.mediaType=n,i}return r(t,e),t.prototype.mute=function(e){this.player&&this.isMuted&&(this.player.muted=e,this.isMuted(e))},t.prototype.addLeadingZero=function(e){return 1===e.toString().length?"0"+e:e},t.prototype.setProgress=function(e){this.currentProgress("width: "+e+"%")},t.prototype.updateRange=function(e){var t=this.progressBar.offsetWidth,n=this.progressBar.getBoundingClientRect().left,i=e.pageX-n;this.player.currentTime=this.player.duration*(i/t),this.setProgress(i/t*100)},t.prototype.onTimelineClick=function(e,t){this.updateRange(t)},t.prototype.onHandleStartDrag=function(e,t){this.updateRange(t),l.addEventListener("mousemove",this.updateRange),l.addEventListener("mouseup",function(){l.removeEventListener("mousemove",this.updateRange),l.removeEventListener("mouseup",this.onMouseUp)})},t}(c.default);t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={events:{browser:{FOCUS:"focus",BLUR:"blur",KEYDOWN:"keydown",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup"}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=".player",r=function(){function e(e){var t=this;this.element=e,this.canPlay=ko.observable(),this.isLoading=ko.observable(),this.failed=ko.observable(),this.onMetadataLoaded=function(){t.isLoaded=!0,t.onLoadedActionHandler&&t.onLoadedActionHandler(),t.currentTimeUnformatted(t.player.currentTime),t.totalTimeUnformatted(t.player.duration)},this.canPlay=ko.observable(!1),this.isLoading=ko.observable(!0),this.failed=ko.observable(!1),this.isLoaded=!1,this.currentTimeUnformatted=ko.observable(0),this.totalTimeUnformatted=ko.observable(0),this.player=e.querySelector(i)}return e.prototype.onError=function(){this.canPlay(!1),this.isLoading(!1),this.failed(!0)},e.prototype.onReady=function(){this.canPlay(!0),this.isLoading(!1),this.failed(!1)},e}();t.default=r},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(7),a=n(74),c=n(526),l=n(119),u=n(527),d=n(528),p=n(56),h="9:16",f="portrait",g="landscape",m=function(){return function(){this.unsupportedText=o.default.instance.i18n.fetch("s_unsupported"),this.vatText=o.default.instance.i18n.fetch("s_vat"),this.taxText=o.default.instance.i18n.fetch("s_tax"),this.totalPriceText=o.default.instance.i18n.fetch("s_totalPrice"),this.areButtonsMultiLine=!1,this.mainSection=null}}();t.BaseContent=m;var v=function(e){function t(n,i,r,o){var c=e.call(this)||this;c.computeButtonsLimit=function(){if(c.type===s.SwiftCardContentType.thumb)return 3;var e=3;return 0===c.mainSection.images.length&&(e+=2),c.mainSection.text||(e++,c.mainSection.title||e++,c.mainSection.subtitle||e++),Math.min(e,6)},c.isValid=function(){return 0!==c.buttons.length?c.buttons.every(function(e){return e.isValid()}):c.mainSection.isValid()},c.isSupported=function(){var e=c.buttons.every(function(e){return e.isSupported()});return c.isValid()&&e},c.type=o,c.buttons=p.default.filterOutDisabledItems(n.buttons,function(e){return new a.default(e,i,r)}),c.tap=n.tap?p.default.getItemIfNotDisabled(new a.default(n.tap,i,r)):null,c.mainSection=new d.default(n,i,r,o);var l=c.computeButtonsLimit();return c.buttons.length>l&&(c.buttons=c.buttons.slice(0,l)),c.areButtonsMultiLine=t.areButtonsMultiLine(c.buttons),c}return r(t,e),t.areButtonsMultiLine=function(e){switch(e.length){case 2:return!e.every(function(e){return e.title.length<=11});case 3:return!e.every(function(e){return e.title.length<=5})}return!0},t}(m);t.default=v;var _=function(e){function t(t,n,i){var r=e.call(this)||this;r.isValid=function(){return 0!==r.buttons.length&&!!r.text},r.isSupported=function(){return r.isValid()},r.find=function(e,t){var n;for(n=0;n<e.length;++n)if(t(e[n],n,e))return e[n]},r._conversation=n,r.type=s.SwiftCardContentType.signin,r.buttons=p.default.filterOutDisabledItems(t.buttons,function(e){return new a.default(e,n,i)});var o=r.find(r.buttons,function(e){return e.type===s.SwiftCardActionType.signin});return r.buttons=o?[o]:[],r.text=p.default.normalizeRichText(t.text,r._conversation.isDirectLineBackend()),r}return r(t,e),t}(m);t.SignInContent=_;var y=function(e){function t(t,n,i,r){var o=e.call(this)||this;return o.hasUrl=function(){return!!o.image&&!!o.image.url},o.hasTitle=function(){return!!o.title||!!o.subtitle},o.isValid=function(){return!!o.media&&!!o.media.isValid()},o.isSupported=function(){return o.isValid()},o._isDl=n.isDirectLineBackend(),o.type=r,o.autoloop=t.autoloop,o.autostart=t.autostart,o.shareable=t.shareable,o.subtitle=t.subtitle?p.default.normalizeRichText(t.subtitle,o._isDl):null,o.title=t.title?p.default.normalizeRichText(t.title,o._isDl):null,o.image=new l.default(t.image||{},n,i,r),o.aspect=t.aspect&&t.aspect===h?f:g,o.hasThumbnail=ko.computed(o.hasUrl),o.hasTextInfo=ko.computed(o.hasTitle),o.media=t.media&&t.media.length?new u.default(t.media[0],n,i,r):null,o.buttons=p.default.filterOutDisabledItems(t.buttons,function(e){return new a.default(e,n,i)}),o.buttons.length>3&&(o.buttons=o.buttons.slice(0,3)),o.areButtonsMultiLine=v.areButtonsMultiLine(o.buttons),o}return r(t,e),t}(m);t.MediaContent=y;var b=function(e){function t(n,i,r){var l=e.call(this)||this;return l.itemsForInitialDisplay=[],l.triggerFoldAction=function(){l.isCollapsed(!l.isCollapsed()),l.isCollapsed()?l.collapseItems():(l.displayedItems(l.items),l.foldButtonText(o.default.instance.i18n.fetch("s_showLess")))},l.isValid=function(){var e=l.buttons.every(function(e){return e.isValid()});return!!l.total&&e},l.isSupported=function(){var e=l.buttons.every(function(e){return e.isSupported()});return l.isValid()&&e},l.collapseItems=function(){l.displayedItems(l.itemsForInitialDisplay),l.foldButtonText(o.default.instance.i18n.fetch("s_showAll"))},l.getItemsForInitialDisplay=function(){for(var e=0,n=0;n<l.items.length;n++){if(e>=t.MAX_ITEMS_NUMBER_TO_DISPLAY)return;l.itemsForInitialDisplay.push(l.items[n]),l.items[n].images.length>0?e+=t.IMAGE_ITEM_COUNTER:e++}l.itemsForInitialDisplay=[]},l._conversation=i,l._isDl=i.isDirectLineBackend(),l.type=s.SwiftCardContentType.receipt,l.buttons=p.default.filterOutDisabledItems(n.buttons,function(e){return new a.default(e,i,r)}),l.buttons.length>3&&(l.buttons=l.buttons.slice(0,3)),l.areButtonsMultiLine=v.areButtonsMultiLine(l.buttons),l.tap=n.tap?new a.default(n.tap,i,r):null,l.title=p.default.normalizeRichText(n.title,l._isDl),l.total=p.default.normalizeText(n.total),l.tax=p.default.normalizeText(n.tax),l.vat=p.default.normalizeText(n.vat),l.facts=p.default.filterOutNotValidItems(n.facts,function(e){return new c.default(e,l._isDl)}),l.items=p.default.filterOutNotValidItems(n.items,function(e){return new d.default(e,i,r,s.SwiftCardContentType.thumb)}),l.displayedItems=ko.observableArray(),l.showFoldButton=ko.observable(!1),l.isCollapsed=ko.observable(!1),l.foldButtonText=ko.observable(),l.getItemsForInitialDisplay(),l.itemsForInitialDisplay.length>0?(l.showFoldButton(!0),l.isCollapsed(!0),l.collapseItems()):l.displayedItems(l.items),l}return r(t,e),t.MAX_ITEMS_NUMBER_TO_DISPLAY=5,t.IMAGE_ITEM_COUNTER=3,t}(m);t.ReceiptContent=b;var w=function(e){function t(t,n,i,r){var o=e.call(this)||this;o.expandedText=function(){return o.title&&o.subtitle?"":o.title||o.subtitle?"expandedTextOnce":"expandedTextTwice"},o.isValid=function(){return!!o.title||!!o.subtitle||!!o.text||0!==o.images.length},o.isSupported=function(){return o.isValid()},o.computeButtonsLimit=function(){if(o.type===s.SwiftCardContentType.thumb)return 3;var e=3;return 0===o.images.length&&(e+=2),o.text||(e++,o.title||e++,o.subtitle||e++),Math.min(e,6)},o._conversation=n,o._isDl=n.isDirectLineBackend(),o.type=r,o.buttons=p.default.filterOutDisabledItems(t.buttons,function(e){return new a.default(e,n,i)}),o.title=t.title?p.default.normalizeRichText(t.title,o._isDl):null,o.subtitle=t.subtitle?p.default.normalizeRichText(t.subtitle,o._isDl):null,o.text=t.text?p.default.normalizeRichText(t.text,o._isDl):null,o.tap=t.tap?p.default.getItemIfNotDisabled(new a.default(t.tap,n,i)):null,o.images=t.images?p.default.mapImages(t.images,n,i,o.type):[];var c=o.computeButtonsLimit();return o.buttons.length>c&&(o.buttons=o.buttons.slice(0,c)),o.areButtonsMultiLine=v.areButtonsMultiLine(o.buttons),o}return r(t,e),t}(m);t.FlexContent=w},function(e,t){e.exports='<div class="lwx-message" role="listitem">\r\n    \x3c!-- ko if: !imageContent()  --\x3e\r\n        <div class="content" data-bind="style:{\r\n                backgroundColor: messageColor,\r\n                background: messageColor\r\n            },\r\n            event: {contextmenu: $parent.openMessageActions},\r\n            css: { sticker: isExtraLargeEmoticon, bot: isAgent, withReactions: $parent.hasReactions}">\r\n            \x3c!-- ko if: content --\x3e\r\n                <span class="text" data-bind="html: content"></span>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!-- ko if: $parent.reactionsPaneEnabled && !$parent.messageFromMe --\x3e\r\n            <button class="reactionsBtn" data-bind="click: $parent.openReactionsPane,\r\n            attr: {title: $parent.openReactionsPaneText}">\r\n                <icon-expression-picker></icon-expression-picker>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n            <reactions-bar class="reactionsBar" params="message: message, messageListElement: messageList"></reactions-bar>\r\n\r\n            \x3c!-- ko foreach: message.files --\x3e\r\n                <LwcSharepointFile params="file: $data, conversation: $parent.conversation, message: $parent.message"></LwcSharepointFile>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n\r\n        \x3c!-- ko if: isTranslated --\x3e\r\n            <div class="translation-globe">\r\n                <icon-globus></icon-globus>\r\n            </div>   \r\n        \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: imageContent() --\x3e\r\n        <div class="content image" data-bind="html: imageContent,\r\n        style:{backgroundColor: messageColor}"></div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: $parent.showEditedIcon --\x3e\r\n    <button class="messageBtn edit" data-bind="attr:{\'aria-label\': $parent.editedMessageText, title: $parent.editedMessageText}">\r\n        <icon-pencil></icon-pencil>\r\n    </button>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: $parent.showMessageActions --\x3e\r\n    <div class="actionsContainer">\r\n        <button class="messageBtn deleteAction" data-bind="click: $parent.openDeleteMsgConfirmationDialog,\r\n        attr: {title: $parent.deleteMessageHeader}">\r\n            <icon-delete-message class="icon"></icon-delete-message>\r\n        </button>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),r=n(2),o=n(1),s=n(48),a=n(0),c=n(14),l=n(70),u=n(560),d="swc:action:click",p=".message",h=function(){return function(e,t){var n=this;this._element=t,this.messagesList=ko.observableArray(),this.clientHeight=ko.observable("100%"),this.languages=ko.observableArray(),this.showSuggestedActions=ko.observable(!1),this.hasSuggestedActionOnLeft=ko.observable(!0),this.hasSuggestedActionOnRight=ko.observable(!0),this.translatorActive=ko.observable(!1),this.translator_active=ko.observable(o.default.instance.i18n.fetch("translator_active",{0:"<strong>",1:"</strong>"})),this.isConnected=ko.observable(!0),this.no_connection=ko.observable(o.default.instance.i18n.fetch("no_connection")),this.showJumpArrow=ko.observable(!1),this.label_scrollToBottom=ko.observable(o.default.instance.i18n.fetch("scroll_to_bottom")),this._isScrollAnimating=!1,this._lastScrollPositionFromBottomBeforeFetching=-1,this.invokeSuggestedAction=function(e){e&&"function"==typeof e.action&&e.action()},this.suggestionChanged=function(){var e;e=0!==n._suggestionArea.scrollLeft,n.hasSuggestedActionOnLeft(e),e=n._suggestionArea.scrollLeft!==n._suggestionArea.scrollWidth-n._suggestionArea.clientWidth,n.hasSuggestedActionOnRight(e)},this.scrollSuggestionsToBeginning=function(){n._scrollSuggestedArea(0)},this.scrollSuggestionsToLeft=function(){n._scrollSuggestedArea(n._suggestionArea.scrollLeft-n._suggestionArea.clientWidth)},this.scrollSuggestionsToRight=function(){n._scrollSuggestedArea(n._suggestionArea.scrollLeft+n._suggestionArea.clientWidth)},this.newMessageAddeded=function(e){Object.keys(a.swcWindow.swc.API.registry).length&&c.default.attachActionToLinks(e,p,d,n._swcClickEventHandler)},this.newMessageRendered=function(e){if(n.conversation.definition.MessageContentLimit&&e&&0!==e.length){var t=e[0].nextElementSibling;if(t&&t.classList.contains("message")&&t.classList.contains("other")&&!t.querySelector(".swift")){var i=t.getBoundingClientRect();n._shouldLimit(i.height)&&(t.classList.add("limited"),t.classList.add("less"),t.querySelector(".bubble").style.maxHeight=n.conversation.definition.MessageContentLimit)}}},this._shouldLimit=function(e){var t=!!n.conversation.definition.MessageContentLimit;if(!t)return!1;var i=parseInt(n.conversation.definition.MessageContentLimit.replace("px",""),10);return t&&i<e},this.jumpToBottom=function(){return n._scrollToBottom()},this._scrollToBottom=function(){n.viewport.scrollTop=n.viewport.scrollHeight},this._scrollToLast=function(){-1!==n._lastScrollPositionFromBottomBeforeFetching&&(n.viewport.scrollTop=n.viewport.scrollHeight-n._lastScrollPositionFromBottomBeforeFetching,n._lastScrollPositionFromBottomBeforeFetching=-1)},this._swcClickEventHandler=function(e){var t=e.target.getAttribute("data-swc-payload"),n=e.target.getAttribute("href");i.default.get.frameless?t&&a.swcWindow.swc.API.triggerEvent("click",t):parent&&parent.postMessage({origin:r.default.ORIGIN,action:s.default.TriggerAPI,name:"click",payload:t},"*"),n.toLowerCase().indexOf("swc:preventdefault=false")<0&&e.preventDefault()},this._processSuggestedActions=function(e){e&&e.suggestedActions.length?(n.suggestedActions(e.suggestedActions),n.showSuggestedActions(!0),n.suggestionChanged(),n.scrollSuggestionsToBeginning(),setTimeout(function(){return n._scrollToBottom()},250)):(n.suggestedActions([]),n.showSuggestedActions(!1))},this._scrollSuggestedArea=function(e){u.scrollTo(e,250,"scrollLeft",n._suggestionArea,function(){return n.suggestionChanged()})},this.viewport=this._element.querySelector(".swc-scroll-viewport"),this.conversation=e,this.isDirectLine=this.conversation.isDirectLineBackend(),this._suggestionArea=t.querySelector(".suggestionArea"),this.suggestedActions=ko.observableArray([]),window.addEventListener("resize",function(){n.suggestionChanged()}),l.get().subscribe("isOnline",this.isConnected)}}();t.default=h},function(e,t){e.exports='<div class="down-arrow" data-bind="css: {\'show-down-arrow\': showJumpArrow()}, click: jumpToBottom">\r\n    <div class="down-btn" aria-role="button" data-bind="attr: {tabindex: showJumpArrow() ? 0 : undefined}, text: label_scrollToBottom"></div>\r\n</div>\r\n<div class="swc-scroll-viewport">\r\n    <div class="messages">\r\n        \x3c!-- ko foreach: {data: messagesList, afterAdd:newMessageAddeded, afterRender: newMessageRendered} --\x3e\r\n            \x3c!-- ko component: {\r\n                name: \'messageitem\',\r\n                params: {\r\n                    message: $data,\r\n                    conversation: $parent.conversation,\r\n                    conversationContainer: $parent.convContainerNode,\r\n                    meUserName: $parent.meUserName,\r\n                    suggestedActions: $parent.suggestedActions\r\n                }\r\n            } --\x3e\r\n            \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n        <div class="branding" aria-hidden="true" tabindex="-2" data-bind="css: {emptyBottomMargin: showSuggestedActions()}">\r\n            <typing-indicator params="conversation: conversation"></typing-indicator>\r\n            <div class="translate" data-bind="css: { isTranslating: translatorActive}">\r\n                <div class="translation-globe">\r\n                    <icon-globus></icon-globus>\r\n                </div>\r\n                    <div data-bind="html: translator_active()">\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="suggested-actions" data-bind="css: {\'show-suggested-actions\': showSuggestedActions()}">\r\n            \x3c!-- ko if: showSuggestedActions() --\x3e\r\n            <div class="navBtnWrapper" data-bind="click: scrollSuggestionsToLeft, css: { disabled: !hasSuggestedActionOnLeft()}">\r\n                <div class="left" role="button" aria-role="button" data-bind="attr: {tabindex: hasSuggestedActionOnLeft() ? 0 : undefined}">\r\n                    <icon-arrow class="icon"></icon-arrow>\r\n                </div>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            <div class="suggestionArea actionItems" data-bind="foreach: {data: suggestedActions}, scroll: suggestionsChanged">\r\n                <button class="actionItem" data-bind="click: $parent.invokeSuggestedAction, attr: {title: actionType === \'openUrl\' ? value : \'\'}, css: {image: $parent.isDirectLine && $data.image, icon: !$parent.isDirectLine && (actionType === \'openUrl\' || actionType === \'call\') }">\r\n                    \x3c!-- ko if: $parent.isDirectLine--\x3e\r\n                        \x3c!-- ko if: $data.title --\x3e\r\n                        <p class="swc-title" data-bind="text: title, visible: !$data.image"></p>\r\n                        \x3c!-- /ko --\x3e\r\n\r\n                        \x3c!-- ko if: $data.image --\x3e\r\n                        <img class="image" data-bind="attr:{src: image}" />\r\n                        \x3c!-- /ko --\x3e\r\n                    \x3c!-- /ko --\x3e\r\n\r\n                    \x3c!-- ko if: !$parent.isDirectLine--\x3e\r\n                        \x3c!-- ko if: actionType === \'openUrl\' --\x3e\r\n                        <icon-open-url class="icon"></icon-open-url>\r\n                        \x3c!-- /ko --\x3e\r\n                        \x3c!-- ko if: actionType === \'call\' --\x3e\r\n                        <icon-call-start class="icon"></icon-call-start>\r\n                        \x3c!-- /ko --\x3e\r\n                        <p data-bind="html: title"></p>\r\n                    \x3c!-- /ko --\x3e\r\n                </button>\r\n            </div>\r\n            \x3c!-- ko if: showSuggestedActions() --\x3e\r\n            <div class="navBtnWrapper" data-bind="click: scrollSuggestionsToRight, css: { disabled: !hasSuggestedActionOnRight()}">\r\n                <div role="button" aria-role="button" data-bind="attr: {tabindex: hasSuggestedActionOnRight() ? 0 : undefined}">\r\n                    <icon-arrow class="icon"></icon-arrow>\r\n                </div>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        <div class="status-msg" data-bind="css: {\'show-status\': !isConnected()}">\r\n            <div class="down-btn" data-bind="attr: {tabindex: isConnected() ? undefined : 0}, text: no_connection()"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<script type="text/html" id="swiftUnsupported">\r\n    <div class="lwx-message">\r\n        <div class="card unsupported">\r\n            <div class="text">\r\n                <div data-bind="text: unsupportedText"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftSingleCard">\r\n<div class="lwx-message" role="listitem">\r\n    \x3c!-- ko template: { name: \'contentSection\' } --\x3e\x3c!-- /ko --\x3e\r\n    <div class="card" data-bind="template: { name: cards[0].getContentTypeName() === \'hero\' || cards[0].getContentTypeName() === \'thumb\' ? \'swiftCard\' : \'swiftCard-\' + cards[0].getContentTypeName(), data: cards[0]}, css: cards[0].getContentTypeName()"></div>\r\n</div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftMultilineCard">\r\n    <div class="lwx-message multiline">\r\n        \x3c!-- ko template: { name: \'contentSection\' } --\x3e\x3c!-- /ko --\x3e\r\n        <div class="carouselContainer" data-bind="css: { multiLine: areButtonsMultiLine },\r\n                                          foreach: {\r\n                                              data: cards,\r\n                                              as: \'card\'\r\n                                          }">\r\n            <div class="card" data-bind="template: { name: card.getContentTypeName() === \'hero\' || card.getContentTypeName() === \'thumb\' ? \'swiftCard\' : \'swiftCard-\' + card.getContentTypeName(), data: card },\r\n                                        css: card.getContentTypeName()"></div>\r\n\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCarouselCard">\r\n    <div class="lwx-message carousel" data-bind="css: { first: isFirst, last: isLast, multiple: isMultiple, double: cards.length == 2, triple: cards.length == 3 }">\r\n        \x3c!-- ko template: { name: \'contentSection\' } --\x3e\x3c!-- /ko --\x3e\r\n        <div class="carouselContainer" data-bind="css: { multiLine: areButtonsMultiLine },\r\n                                          foreach: {\r\n                                              data: cards,\r\n                                              as: \'card\',\r\n                                              afterRender: function(e, card) { e[1].addEventListener(\'focus\', function() { moveToCard(card); }, true); }\r\n                                          },\r\n                                          style: { left: carouselLeftPosition() }">\r\n            <div class="card" data-bind="template: { name: card.getContentTypeName() === \'hero\' || card.getContentTypeName() === \'thumb\' ? \'swiftCard\' : \'swiftCard-\' + card.getContentTypeName(), data: card },\r\n                                        css: card.getContentTypeName()"></div>\r\n\r\n        </div>\r\n        <div class="prev" data-bind="click: prevCard, enterKey: prevCard, attr: { title: prevCardTitle }">\r\n            <icon-arrow class="button" role="button" tabindex="0"></icon-arrow>\r\n        </div>\r\n        <div class="next" data-bind="click: nextCard, enterKey: nextCard, attr: {title: nextCardTitle}">\r\n            <icon-arrow class="button" role="button" tabindex="0"></icon-arrow>\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCard">\r\n    <div class="cardContent" data-bind="attr: { tabindex: (content.tap && content.tap.isValid()) ? -1 : null, role: (content.tap && content.tap.isValid()) ? \'presentation\' : null, title: (content.tap && content.tap.isValid()) ? content.tap.tooltip : null },\r\n                                              css: { tap: content.tap && content.tap.isValid() },\r\n                                              enterKey: (content.tap && content.tap.isValid()) ? content.tap.action : null,\r\n                                              click: (content.tap && content.tap.isValid()) ? content.tap.action : null, clickBubble: false">\r\n        \x3c!-- ko if: content.mainSection.isValid() --\x3e\r\n        \x3c!-- ko template: { name: \'swiftSection\', data: content.mainSection } --\x3e\x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n        <div class="buttons" data-bind="foreach: { data: content.buttons, as: \'button\' }, css: { multiLine: content.areButtonsMultiLine}">\r\n            \x3c!-- ko template: { name: \'swiftButton\', data: button } --\x3e\x3c!-- /ko --\x3e\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCard-flex">\r\n    <div class="cardContent" data-bind="attr: { tabindex: (content.tap && content.tap.isValid()) ? -1 : null, role: (content.tap && content.tap.isValid()) ? \'presentation\' : null, title: (content.tap && content.tap.isValid()) ? content.tap.tooltip : null },\r\n                                              css: { tap: content.tap && content.tap.isValid() },\r\n                                              enterKey: (content.tap && content.tap.isValid()) ? content.tap.action : null,\r\n                                              click: (content.tap && content.tap.isValid()) ? content.tap.action : null, clickBubble: false">\r\n        <div class="section">\r\n            \x3c!-- ko if: content.title || content.subtitle || content.text --\x3e\r\n            <div class="textContent">\r\n                \x3c!-- ko if: content.subtitle --\x3e\r\n                <h2 data-bind="html: content.subtitle, attr: { title: $element.textContent }"></h2>\r\n                \x3c!-- /ko --\x3e\r\n                \x3c!-- ko if: content.title --\x3e\r\n                <h1 data-bind="html: content.title, attr: { title: $element.textContent }"></h1>\r\n                \x3c!-- /ko --\x3e\r\n                \x3c!-- ko if: content.text --\x3e\r\n                <p class="normal" data-bind="html: content.text, attr: { title: $element.textContent }, css: content.expandedText() "></p>\r\n                \x3c!-- /ko --\x3e\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: content.images.length > 0 --\x3e\r\n            \x3c!-- ko with: content.images[0] --\x3e\r\n            <div class="image" data-bind="attr: { tabindex: (tap && tap.isValid()) ? 0 : null, role: (tap && tap.isValid()) ? \'button\' : null, title: (tap && tap.isValid()) ? getTitleByType() : null },\r\n                                              css: { tap: tap && tap.isValid() },\r\n                                              enterKey: (tap && tap.isValid()) ? tap.action : null,\r\n                                              click: (tap && tap.isValid()) ? tap.action : null, clickBubble: false">\r\n\r\n                <img data-bind="attr: { src: url(), alt: alt, width: uiSize().width, height: uiSize().height }" />\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- ko if: content.buttons.length > 0 --\x3e\r\n        <div class="buttons" data-bind="foreach: { data: content.buttons, as: \'button\' }, css: { multiLine: content.areButtonsMultiLine}">\r\n            \x3c!-- ko template: { name: \'swiftButton\', data: button } --\x3e\x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n\r\n\r\n<script type="text/html" id="swiftCard-receipt">\r\n    <div data-bind="attr: { tabindex: (content.tap && content.tap.isValid()) ? 0 : null, role: (content.tap && content.tap.isValid()) ? \'button\' : null, title: (content.tap && content.tap.isValid()) ? content.tap.tooltip : null },\r\n                                              css: { tap: content.tap && content.tap.isValid() },\r\n                                              enterKey: (content.tap && content.tap.isValid()) ? content.tap.action : null,\r\n                                              click: (content.tap && content.tap.isValid()) ? content.tap.action : null, clickBubble: false">\r\n        \x3c!-- ko if: content.title --\x3e\r\n        <h1 data-bind="html: content.title"></h1>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: content.facts.length !== 0 --\x3e\r\n        <div class="facts" role="list" data-bind="foreach: { data: content.facts, as: \'fact\' }">\r\n            \x3c!-- ko template: { name: \'swiftFact\', data: fact } --\x3e\x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: content.displayedItems().length !== 0 --\x3e\r\n        <div class="items" role="list" data-bind="foreach: { data: content.displayedItems, as: \'item\' }">\r\n            <div class="item" role="listitem">\r\n                \x3c!-- ko template: { name: item.images.length !== 0 ? \'swiftSection\' : \'swiftItem\', data: item } --\x3e\x3c!-- /ko --\x3e\r\n            </div>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: content.showFoldButton --\x3e\r\n        <div class="button fold" data-bind="attr: { tabindex: -1, role: \'button\', title: content.foldButtonText() },\r\n                                   enterKey: content.triggerFoldAction,\r\n                                   click: content.triggerFoldAction, clickBubble: false">\r\n            <span class="normal" data-bind="text: content.foldButtonText()"></span>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        <div class="summary">\r\n            \x3c!-- ko if: content.vat --\x3e\r\n            <div class="line">\r\n                <span class="key normal" data-bind="text: content.vatText"></span>\r\n                <span class="value normal" data-bind="text: content.vat"></span>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: content.tax --\x3e\r\n            <div class="line">\r\n                <span class="key normal" data-bind="text: content.taxText"></span>\r\n                <span class="value normal" data-bind="text: content.tax"></span>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            <div class="line">\r\n                <span class="key normal" data-bind="text: content.totalPriceText"></span>\r\n                <span class="value normal" data-bind="text: content.total"></span>\r\n            </div>\r\n        </div>\r\n        <div class="buttons" data-bind="foreach: { data: content.buttons, as: \'button\' }, css: { multiLine: content.areButtonsMultiLine}">\r\n            \x3c!-- ko template: { name: \'swiftButton\', data: button } --\x3e\x3c!-- /ko --\x3e\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCard-signin">\r\n    <div class="text" data-bind="html: content.text"></div>\r\n    <div class="buttons" data-bind="foreach: { data: content.buttons, as: \'button\' }">\r\n        \x3c!-- ko template: { name: \'swiftButton\', data: button } --\x3e\x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftSection">\r\n    <div class="section" data-bind="attr: { tabindex: (tap && tap.isValid()) ? 0 : null, role: (tap && tap.isValid()) ? \'presentation\' : null, title: (tap && tap.isValid()) ? getTitleByType() : null },\r\n                css: { tap: tap && tap.isValid() },\r\n                enterKey: (tap && tap.isValid()) ? tap.action : null,\r\n                click: (tap && tap.isValid()) ? tap.action : null, clickBubble: false">\r\n        \x3c!-- ko if: subtitle || title || price || text --\x3e\r\n        <div class="textContent">\r\n            \x3c!-- ko if: subtitle --\x3e\r\n                <h2 data-bind="html: subtitle, attr: { title: $element.textContent }"></h2>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: title --\x3e\r\n                <h1 data-bind="html: title, attr: { title: $element.textContent }"></h1>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: price --\x3e\r\n                <span class="price normal" data-bind="html: price, attr: { title: $element.textContent }"></span>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: text --\x3e\r\n                <p class="normal" data-bind="html: text, attr: { title: $element.textContent }, css: { expandedText: expandedText() }"></p>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: images.length > 0 --\x3e\r\n            \x3c!-- ko with: images[0] --\x3e\r\n                \x3c!-- ko if: isValid() && url() --\x3e\r\n                <div class="image" data-bind="attr: { tabindex: (tap && tap.isValid()) ? 0 : null, role: (tap && tap.isValid()) ? \'button\' : null, title: (tap && tap.isValid()) ? getTitleByType() : null },\r\n                                              css: { tap: tap && tap.isValid() },\r\n                                              enterKey: (tap && tap.isValid()) ? tap.action : null,\r\n                                              click: (tap && tap.isValid()) ? tap.action : null, clickBubble: false">\r\n\r\n                    <img data-bind="attr: { src: url(), alt: alt, width: uiSize().width, height: uiSize().height },\r\n                                    style: { bottom: bottomAlignment() + \'px\'}" />\r\n                </div>\r\n                \x3c!-- /ko --\x3e\r\n            \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftButton">\r\n    <div class="lwx-message button" data-bind="attr: { tabindex: isValid() ? -1 : null, role: isValid() ? \'button\' : null, title: tooltip },\r\n                                   enterKey: isValid() ? action : null,\r\n                                   click: isValid() && !isCallActionType ? action : null, clickBubble: false">\r\n\r\n            \x3c!--  ko if: !isCallActionType --\x3e\r\n            <span class="normal" data-bind="text: title"></span>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!--  ko if: isCallActionType && value --\x3e\r\n            <a data-bind="text: title, attr: { href: value }"></a>\r\n            \x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftFact">\r\n    <div class="fact" role="listitem">\r\n        <span class="key normal" data-bind="html: key"></span>\r\n        <span class="value normal" data-bind="html: value"></span>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftItem">\r\n    <span class="swc-title" data-bind="html: title"></span>\r\n    <span class="price normal" data-bind="text: price"></span>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCard-video">\r\n    <div class="cardContent" data-bind="css: content.aspect">\r\n        <div class="videoCard">\r\n            <videoplayer params="media: content.media.video, thumbnail: content.image.url, autoplay: content.autostart, muted: true, autoloop: false, displayMuteButton: true, messageId: $component.message.id, title: content.title, subtitle: content.subtitle"></videoplayer>\r\n        </div>\r\n        <div data-bind="template: \'mediaCardSection\', data: $data"></div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCard-audio">\r\n    <div class="cardContent">\r\n        <div class="audioCard">\r\n            <div class="audio-message" data-bind="css: {thumbnail: content.hasThumbnail()}">\r\n                <div class="media-holder">\r\n                    <div class="media-content">\r\n                        <audioplayer params="media: content.media.audio, autoplay: content.autostart, messageId: $component.message.id, coverImage: content.image"></audioplayer>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div data-bind="template: \'mediaCardSection\', data: $data"></div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCard-animation">\r\n    <div class="cardContent">\r\n        <div class="animationCard">\r\n            <gifplayer params="media: content.media.animation, coverImage: content.image"></gifplayer>\r\n        </div>\r\n        <div data-bind="template: \'mediaCardSection\', data: $data"></div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="contentSection">\r\n    \x3c!-- ko if: content --\x3e\r\n    <div class="card" data-bind="css: cards[0].getContentTypeName()">\r\n        <div class="cardContent">\r\n            <div class="section">\r\n                <div class="textContent">\r\n                    <p class="normal" data-bind="html: content"></p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n<\/script>\r\n\r\n<script type="text/html" id="mediaCardSection">\r\n    \x3c!-- ko if: content.hasTextInfo() --\x3e\r\n    <div class="section">\r\n        <div class="textContent">\r\n            \x3c!-- ko if: content.title --\x3e\r\n            <h1 data-bind="text: content.title, attr: { title: content.title }"></h1>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: content.subtitle --\x3e\r\n            <h2 data-bind="text: content.subtitle, attr: { title: content.subtitle }"></h2>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: content.media --\x3e\r\n                \x3c!-- ko if: content.media.sourceDomain --\x3e\r\n                <h3 class="domain" data-bind="text: content.media.sourceDomain, attr: { title: content.media.sourceDomain }"></h3>\r\n                \x3c!-- /ko --\x3e\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    <div class="buttons" data-bind="foreach: { data: content.buttons, as: \'button\' }, css: { multiLine: content.areButtonsMultiLine}">\r\n        \x3c!-- ko template: { name: \'swiftButton\', data: button } --\x3e\x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCard-adaptive">\r\n    <adaptivecard params="content: content, conversation: _conversation"></adaptivecard>\r\n<\/script>\r\n\r\n'},function(e,t){e.exports='<div class="textInputContainer" data-bind="css: tag">\r\n\r\n    \x3c!-- ko if: canSendEmoticons --\x3e\r\n    <button class="send expressionPickerBtn" data-bind="click: toggleExpressionPicker,\r\n        attr: { \'aria-label\': openPickerText, title: openPickerText },\r\n        disable: !isChatEnabled()">\r\n        <icon-expression-picker />\r\n    </button>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <textarea data-bind="event: {click: hideExpressionPicker, keydown: onKeyDown, input: handleInput},\r\n        attr: {\'placeholder\': isChatEnabled() ? placeholder : \'\', \'maxlength\':maxLength},\r\n        disable: !isChatEnabled() || disableTextArea" autofocus></textarea>\r\n\r\n    \x3c!-- ko if: inputHasValue() || !chatConfig.CanUploadFile --\x3e\r\n        <button class="send" data-bind="click: sendButtonHandler,\r\n            attr:{\'disabled\': !isChatEnabled() || !onSendMessageEnabled(),\r\n                \'aria-label\': sendMessageText, title: sendMessageText},\r\n                visible: !showCancelEditButton()">\r\n            <icon-sent />\r\n        </button>\r\n        <button class="cancel" data-bind="click: cancelEditingMode, visible: showCancelEditButton,\r\n            attr: { \'aria-label\': cancelEditingText, title: cancelEditingText }">\r\n            <icon-cancel class="icon" />\r\n        </button>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: chatConfig.CanUploadFile && isChatEnabled() --\x3e\r\n        <input id="myFiles" multiple type="file" data-bind="event: {change: sendFile}"></input>\r\n\r\n        \x3c!-- ko if: !inputHasValue() --\x3e\r\n        <button class="send file-picker" tabindex="0" data-bind="click: selectFile,\r\n            attr:{ \'disabled\': !isFileTransferEnabled(), \'aria-label\': sendFileText, title: sendFileText}">\r\n            <icon-file-img />\r\n        </button>\r\n        \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(4),o=n(45);!function(e){e[e.submit=0]="submit",e[e.change=1]="change"}(i=t.CommandMode||(t.CommandMode={}));var s=function(){function e(){var e=this;this.commands=[],this.mode=i.change,this.setupProxy=function(){e.events.registerEvent(r.ApiEvents.cmd.reg,function(t){return e.register(t)}),e.events.registerEvent(r.ApiEvents.cmd.unreg,function(t){return e.unregister(t)})},this.events=window.swc.API,o.ProxyConnector.instance.connect("commands",null,this.setupProxy)}return Object.defineProperty(e,"instance",{get:function(){return e.init()},enumerable:!0,configurable:!0}),e.init=function(){return e._instance||(e._instance=new e)},e.prototype.register=function(e){e&&-1==this.commands.indexOf(e)&&this.commands.push(e)},e.prototype.unregister=function(e){var t=this.commands.indexOf(e);-1!=t&&this.commands.splice(t,1)},e.prototype.evaluate=function(e,t){var n;if("/"!=e.charAt(0)||!this.commands.length)return n;var i=e.substr(1).split(" ")[0];return(n=-1!=this.commands.indexOf(i))&&this.events.triggerEvent(r.ApiEvents.cmd.exec,{command:i,conversationId:t,data:e.substr(i.length+2)}),n},e}();t.Commands=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(35),r=function(){function e(e){this.textArea=e}return e.prototype.applySuggestion=function(){var e=this.textArea.value,t=i.default.wordBoundariesAt(e,this.textArea.selectionStart),n=this.getReplacer(),r=e.slice(t.end);""===r&&(n+=" "),e=e.slice(0,t.start)+n+r,this.textArea.value=e,this.textArea.blur(),this.textArea.focus(),this.textArea.selectionStart=t.start+n.length,this.textArea.selectionEnd=this.textArea.selectionStart},e}();t.Suggestion=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(69),r=n(4),o=n(6),s=n(2),a=n(1),c=n(48),l=n(13),u=n(77),d=n(7),p=n(583),h=n(584),f=n(0),g=n(123),m=n(20),v=n(31),_="",y="newChatComposerId",b=function(){return function(e,t){var n=this;this._definition=e,this._element=t,this.selectedParticipantsCount=ko.observable(0),this.correlationId=m.guid.generate(),this.onSelectedParticipantsChange=function(e){n.selectedParticipantsCount(e)},this.isCreatingGroupChat=function(){return n.selectedParticipantsCount()>1},this.focusTitleInput=function(){n._titleInput&&n._titleInput.focus()},this.closeNewChatWindow=function(){o.default.get.frameless?f.swc.SDK.Chat.resolveMessage({origin:s.default.ORIGIN,action:c.default.HideChatWindow}):parent&&parent.postMessage({origin:s.default.ORIGIN,action:c.default.HideChatWindow},document.referrer||"*"),n._clearViewModelData();var e={id:y,container:n._container};window.swc.API.triggerEvent(r.ApiEvents.onControlClose,e)},this.cancel=function(e){var t=new p.default;t.action=p.NewChatAction.CANCEL,t.participants=e.length,t.isTopicSet=!!n._titleInput.value,t.ttc=Date.now()-n.timeStarted,a.default.instance.TelemetryService.sendEvent(t),n.closeNewChatWindow()},this.confirmAddParticipants=function(e){if(n._mePersonId||(n._mePersonId=a.default.instance.MePersonManager.mePerson.id),o.default.get.backend!==l.MessagingBackend.TEAMS&&1===e.length){var t=new p.default;t.action=p.NewChatAction.OK,t.participants=e.length,t.isTopicSet=!!n._titleInput.value,t.ttc=Date.now()-n.timeStarted,a.default.instance.TelemetryService.sendEvent(t),g.default.startChat(e[0].id,n.definition,!1,u.default.NEWCHAT)}else n._createConversation(e);n.closeNewChatWindow()},this._createConversation=function(e){var t={id:v.default.toFullIdentifier(n._mePersonId),role:d.ParticipantRole.Admin},r=n._titleInput.value?i(n._titleInput.value.trim()):"";e.push(t);var o=Date.now();a.default.instance.WebApi.createThread(e).then(function(t){var i=t.headers.get("location").match(/threads\/(19:.*)$/)[1];r&&(n.definition.Title=r,n.definition.SetConversationTopic=!0);var s=new p.default;s.action=p.NewChatAction.OK,s.participants=e.length,s.isTopicSet=!!r,s.ttc=Date.now()-n.timeStarted,a.default.instance.TelemetryService.sendEvent(s);var c=new h.default;c.participants=e.length,c.isTopicSet=!!r,c.ttc=Date.now()-o,a.default.instance.TelemetryService.sendEvent(c),g.default.startChat(i,n.definition,!1,u.default.NEWCHAT)},function(e){}),n._clearViewModelData()},this._clearViewModelData=function(){n._titleInput.value=_,n.selectedParticipantsCount(0)},this.definition=e,this._container=t,this._parentContainer=t.parentElement,this.newChatText=a.default.instance.i18n.fetch("new_chat_header"),this.enterGroupNameText=a.default.instance.i18n.fetch("new_chat_enter_group_name"),this.cancelText=a.default.instance.i18n.fetch("sign_in_cancel"),this.closeText=a.default.instance.i18n.fetch("close_window"),this.newChatSelectItemsText=a.default.instance.i18n.fetch("new_chat_header_select_who_to_chat_with"),this._titleInput=t.querySelector("input.newChatInput"),this.timeStarted=Date.now(),setTimeout(function(){window.swc.API.triggerEvent(r.SearchEvents.SEARCH_CREATE_CONTACTLIST,n.correlationId)},100)}}();t.default=b},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i=this;Object.defineProperty(t,"__esModule",{value:!0});var r=n(80),o=n(65),s=n(157);n(114),n(87),n(64);var a=n(0),c=n(513),l=n(93),u=n(60);a.swcWindow.DOMPurify=a.swcWindow.DOMPurify||n(68),a.swcWindow.ariaTelemetry=a.swcWindow.ariaTelemetry||n(115),t.default=(o.default.alias(s.SVG,"Assets.SVG",a.swc),a.swc.API&&a.swc.API.deferred?l.default.execute(a.swc,"API",r.default,i):o.default.alias(r.default,"API",a.swc),u.default.isInIframe()&&(a.swc.API.connect("chat"),parent&&a.swc.API.addTarget("core","core","*",parent)),a.swc.ChatContent&&a.swc.ChatContent.deferred?l.default.execute(a.swc,"ChatContent",new c.default,i):a.swc.ChatContent=a.swc.ChatContent||new c.default,void o.default.alias(a.swc.ChatContent,"swc.Chat",null,!0))},function(e,t,n){"use strict";var i=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var r=n(69),o=n(4),s=n(2),a=n(1),c=n(23),l=n(432),u=n(21),d=n(17),p=n(48),h=n(44),f=n(10),g=n(32),m=n(39),v=n(355),_=n(26),y=n(45),b=n(33),w=n(7),C=n(81),E=n(215),S=n(0),T=n(514),I=n(554),x=n(556),A=n(562),P=n(340),k=n(11),M=n(20),O=n(31),L=n(31),R=n(466),N=n(60),D=n(38),Q=n(241),U=n(14),B=n(153),V=n(24),F=n(19),j=n(6),H=n(369),W=n(598),z="newChatComposerId",G=function(){function e(t){var n=this;this.element=t,this._chatInstances={},this._stylesReady=!1,this._callingInitialized=!1,this._initializing=!1,this.isInitialized=!1,this._loadConversation=function(e,t,i){e&&(n._createConversationID(e),n._topic=t,n._avatar=i)},this._hideConversation=function(e){var t=e===z?e:L.default.toFullIdentifier(e),i=n._chatInstances[t];n._setActive(i,!1),n._triggerChatVisibilityChange(!1,t),i&&(i.view.parentElement.style.display="none")},this._updateConversation=function(e,t){for(var i in n._chatInstances){if(i===(e.chatConfig.ConversationId===z?z:L.default.toFullIdentifier(e.chatConfig.ConversationId))){var r=n._chatInstances[i];r.model.definition=e.chatConfig,n._setActive(r,!0),n._triggerChatVisibilityChange(!0,i),t&&n.setContainerByMri(i,t),n._chatDataConfig.ExecuteCall&&n._executeCall(n._chatDataConfig.ExecuteCall)}else if(!j.default.get.isParallelView){var o=!!n._chatInstances[i].model.isActive;n._setActive(n._chatInstances[i],!1),o&&n._triggerChatVisibilityChange(!1,i)}}},this._focusNewChatSearch=function(e){var t=e.querySelector("input.searchContactsInput");t&&t.focus()},this._getNewChatNode=function(){var e=document.createElement("div");return e.innerHTML='<div class="swc conversation skype-conversation" data-bind="component: \'new-chat\'"></div>',e.firstElementChild.cloneNode(!0)},this._initNewChatWindow=function(e){var t=n._chatInstances[z];if(!t){var i=n._getNewChatNode();e.appendChild(i),t=n._chatInstances[z]={view:i,model:{},container:e},ko.applyBindings(null,i),n._setActive(t,!0),j.default.get.isParallelView&&(n._CM.add(z,{alwaysOnStage:!0,view:i,model:{}}),j.default.get.isParallelView&&n.createContainer(z))}(n._stylesReady||n._isModule)&&n._openChatWindow(),n._focusNewChatSearch(t.view)},this._runChat=function(t){n._CM.baseParent||(n._CM.baseParent=t.data&&t.data.placeholder?t.data.placeholder:t.element),n._stylesReady||(n._CM.baseParent.style.display="none");var i=t.element||n._CM.baseParent;t.id&&e._getConversationIdAsync(t.id).then(function(e){var r,o=L.default.detectConversationType(n._chatDataConfig.ConversationId)===w.ConversationType.DIRECT_LINE,s=!1;for(var a in n._chatInstances){var c=n._chatInstances[a];e===a?(s=!0,r=c.model):!j.default.get.isParallelView&&c.model.isActive&&n._triggerChatVisibilityChange(!1,a),n._setActive(c,e===a)}if(t.data&&t.data.chatConfig&&t.data.chatConfig.NewChatFlag)n._initNewChatWindow(i);else{if(s)r.isDisposed&&r.start(),r.markAsRead();else{var l=t.data&&t.data.chatConfig?t.data.chatConfig.RefId:null;n._setupConversation(o,i,l)}(n._stylesReady||n._isModule)&&n._openChatWindow();var u=n._chatDataConfig.ExecuteCall;u&&n._executeCall(u)}})},this._forceExpandChat=function(e){return S.swc.API.triggerEvent(o.ApiEvents.ForceExpandChat,e)},this._openChatWindow=function(){j.default.get.frameless?S.swc.SDK.Chat.resolveMessage({origin:s.default.ORIGIN,action:p.default.ShowChatWindow}):parent&&parent.postMessage({origin:s.default.ORIGIN,action:p.default.ShowChatWindow},"*"),n._triggerChatVisibilityChange(!0,n._conversationId)},this.signinStateChangedHandler=function(e){switch(e){case c.SigninState.SignedOut:n.disposeConversationsOnSkypeLogout(),n.resetSkypeBackend();break;case c.SigninState.SigningIn:n.disposeConversationsOnSkypeLogout();break;case c.SigninState.SignedIn:!n._chatDataConfig.EnableCalling||j.default.get.callingReady&&n._callingInitialized||n.setupCalling(),a.default.instance.AmsManager.authenticate();break;case c.SigninState.SigningOut:}},this.resetSkypeBackend=function(){C.ConversationLoadEvent.isAvailable=!0;return a.default.instance.isCleared=!1,a.default.instance.WebApi.reset().then(function(){if(a.default.instance.dispose(),a.default.instance.SignInManager.reloginContext.canRelogin){var e=function(){a.default.instance.MePersonManager.fetch(),a.default.instance.restoreLastConversation()};a.default.instance.SignInManager.reloginContext.execCallback().then(e,e)}else a.default.instance.isCleared=!0})},this.setup=function(e){window.onbeforeunload=function(){a.default.instance.WebApi.reset(),n.disposeConversations()},n._loadCss(),T.default.register(n._chatDataConfig),x.default.register(n._chatDataConfig),A.default.register(n._chatDataConfig);var t=L.default.getSdkModeFromId(n._chatDataConfig.ConversationId);a.default.instance.SignInManager.activeConversationSdkMode=t,e.data&&n._chatDataConfig&&n._chatDataConfig.EnableCalling&&V.default.testSupporedList(s.default.ECS.callingSupportedBrowsers)&&t!==_.SDKMode.DIRECT_LINE_TOKEN&&a.default.instance.MePersonManager.fetch();var i=function(){var t=n._chatDataConfig.Title?U.default.parseTopic(n._chatDataConfig.Title):"";e.id&&n._loadConversation(r(e.id),t,r(n._chatDataConfig.Avatar)),n.enable()&&n._runChat(e)};L.default.detectConversationType(n._chatDataConfig.ConversationId)===w.ConversationType.PHONE?n._callingInitialized&&S.swc.API.triggerEvent(o.ApiEvents.StartCall,{calleeId:"4:"+e.id,withVideo:!1,avatarUrl:null,displayName:e.id}):e.data&&e.data.switchConversation||n.isInitialized?i():u.loadServices().then(function(e){e.initPromise.then(i)})},this._loadCss=function(){if(!n._isModule){var e,t;if(n._chatDataConfig.Style){var i=/https:\/\/[\S]+.css/g.test(n._chatDataConfig.Style);e=i?m.PackageName.STYLE_CHAT_SKYPE:"swc-chat-"+n._chatDataConfig.Style,i&&(t=n._chatDataConfig.Style,e=m.PackageName.STYLE_CHAT_SKYPE)}else e=m.PackageName.STYLE_CHAT_SKYPE;if(n._stylesReady||B.default.addStyle(e,!0,function(){n._openChatWindow(),n._stylesReady=!0,n._CM.baseParent&&(n._CM.baseParent.style.display="")}),t&&B.default.addStyle(n._chatDataConfig.Style),n._chatDataConfig.Theme){var r="swc-"+n._chatDataConfig.Theme;B.default.addStyle(r,!0),n._CM.baseParent.classList.add(n._chatDataConfig.Theme)}n._chatDataConfig.CssUrl&&B.default.addStyle(n._chatDataConfig.CssUrl)}},this._onMessageReceived=function(e){e.data.origin===s.default.ORIGIN&&/^(bs:[so]Chat.*)|(swc:chat:)|(swc:calling:)/.test(e.data.action)&&n.resolveMessage(e.data)},this.signIn=function(e,t,i){n._applicationInitialized.promise.then(function(){a.default.instance.SignInManager.setExternalCallbacks(e,t),a.default.instance.SignInManager.getSkypeToken()})},this.signOut=function(){return n._applicationInitialized.promise.then(function(){return a.default.instance.SignInManager.logout("external")})},this.setAad=function(e){var t=n._chatInstances[n._conversationId];t.model.contextAad=e},this.getTokenExpirationTime=function(){return a.default.instance.SignInManager.getTokenExpirationTime()},this.onOpenedChatWindow=function(){if(n.isClientVisible()){var e=n._chatInstances[n._conversationId];e&&e.model&&e.model.sdkMode!==_.SDKMode.DIRECT_LINE_TOKEN&&e.model.markAsRead&&e.model.markAsRead(),n.sendChatVisibilityChangeTelemetry()}},this.sendChatVisibilityChangeTelemetry=function(){var e=0;n._CM.forEach(function(t){t.onStage&&e++});var t=new E.VisibilityChangedEvent(!0);t.numberOfVisibleChats=e,a.default.instance.TelemetryService.sendEvent(t)},this.onClientFocused=function(){(a.default.instance.isFocused=!0,n.isClientVisible())&&(n._chatInstances[n._conversationId].model.sdkMode!==_.SDKMode.DIRECT_LINE_TOKEN&&(S.swc.API.triggerEvent(o.ApiEvents.onFocused,!0),n.sendInappActivityStart("Foregrounded")));n._CM&&n._CM.forEach(function(e){e.onStage&&e.model&&e.model.markAsRead&&e.model.markAsRead()})},this.onClientBlurred=function(){a.default.instance.isFocused=!1,S.swc.API.triggerEvent(o.ApiEvents.onFocused,!1)},this.bindTheme=function(){j.default.get.subscribe("theme",function(e){for(var t in n._chatInstances){var i=n._chatInstances[t].container.classList;n._theme&&i.remove(n._theme),e&&i.add(e)}n._theme=e})},this.setupMessagingProxy=function(){var e=S.swc.API,t=function(t){return e.triggerEvent(o.ApiEvents.messagingProxy.disconnected,t)};e.registerEvent(o.ApiEvents.messagingProxy.disconnect,function(){return a.default.instance.WebApi.reset().then(function(){return t(!0)},function(){return t(!1)})})},window.addEventListener("message",this._onMessageReceived),this._applicationInitialized=new d.CancelablePromise}return e.prototype.init=function(e){var t=this;if(!this._initializing&&!this.isInitialized){var n;this._initializing=!0,e.data&&e.data.chatConfig&&(D.default.locale=e.data.chatConfig.Locale,n=e.data.chatConfig.ChatMinWidth),a.default.initServices({skypeTokenProvider:e.tokenProvider,initialSkypeTokenData:e.initialSkypeTokenData,tokenType:e.tokenType,fileSharing:e.data.fileSharing}),a.default.initPesManager(),S.swc.API.registerEvent(o.ApiEvents.onControlClose,function(e){return t._hideConversation(e.id)});var i=this.element||document.querySelector("#main.swc");this._CM=new I.default({container:i,minWidth:n}),a.default.instance.SignInManager.subscribe("state",this.signinStateChangedHandler),a.default.instance.setRestoreOfLastConversation(this.restoreLastConversation.bind(this));var r=function(){return l.default.init()};r(),a.default.instance.setManagersInit(r),this._applicationInitialized.resolve(),a.default.instance.SignInManager.state===c.SigninState.SignedIn&&this.signinStateChangedHandler(a.default.instance.SignInManager.state),S.swc.API.registerEvent(o.ApiEvents.invoke.sendMessageToBot,function(e){return t.sendMessageToBot(e.content,e.botId,e.botMessageId)}),S.swc.API.registerEvent(o.ApiEvents.invoke.signOut,function(e){return t.signOut()}),S.swc.API.registerEvent(o.ApiEvents.invoke.setAad,function(e){return t.setAad(e.aad)}),S.swc.API.registerEvent("closeAllChats",function(e){return t.closeAllChats()}),R.Commands.init(),Q.Masks.init(),this.bindTheme()}},e.prototype.dispose=function(){a.default.instance.SignInManager.unsubscribe("state",this.signinStateChangedHandler),this.enable(!1),ko.cleanNode(this._CM.baseParent),this.disposeConversations(),a.default.instance.SignInManager.state=c.SigninState.SignedOut,this._CM.baseParent=null},e.prototype.disposeConversations=function(){for(var e in this._chatInstances){var t=this._chatInstances[e].model;t&&t.dispose&&t.dispose(),delete this._chatInstances[e]}},e.prototype._createConversationID=function(e){this._conversationId=e===z?z:L.default.toFullIdentifier(e)},e.prototype._setActive=function(e,t){if(e){var n=e.view.classList;t?n.add("conversation-active"):n.remove("conversation-active"),e.model.isActive=t}t&&this._CM.baseParent&&this._stylesReady&&(this._CM.baseParent.style.display="")},e.prototype.createContainer=function(e){var t=document.createElement("div");t.className="swc chat "+j.default.get.currentLocale,this.setContainer(e,t),j.default.get.theme&&(this._theme=j.default.get.theme,t.classList.add(this._theme))},e.prototype.setContainerByMri=function(e,t){this._chatInstances[e]&&(this._CM.setContainer(e,t),t.appendChild(this._chatInstances[e].view),this._chatInstances[e].container=t)},e.prototype.isOnStage=function(e){var t=this._CM.get(e);return t&&t.onStage},e.prototype.setContainer=function(e,t){e===z?this.setContainerByMri(e,t):this.setContainerByMri(L.default.toFullIdentifier(e),t)},e.prototype.getContainer=function(e){return e===z?this.getContainerByMri(e):this.getContainerByMri(L.default.toFullIdentifier(e))},e.prototype.getConversationTuple=function(t){var n=this;return e._getConversationIdAsync(t).then(function(e){return n._CM.getAsync(e)})},e.prototype.getContainerByMri=function(e){var t;return this._chatInstances[e]&&(t=j.default.get.isParallelView?this._chatInstances[e].view:this._chatInstances[e].container),t||this._CM.baseParent},e._getConversationIdAsync=function(e){var t=L.default.toFullIdentifier(e);return P.isEnterpriseUserMri(t)?P.generateOneToOneConversationId(t):Promise.resolve(t)},e.prototype._executeCall=function(e){var t=S.swc.API;j.default.get.callingReady?e.accept?t.triggerEvent(o.ApiEvents.AcceptCall,e):t.triggerEvent(o.ApiEvents.StartCall,e):e.accept?t.registerEvent(o.ApiEvents.CallingReady,function(){return t.triggerEvent(o.ApiEvents.AcceptCall,e)}):t.registerEvent(o.ApiEvents.CallingReady,function(){return t.triggerEvent(o.ApiEvents.StartCall,e)}),this._chatDataConfig.ExecuteCall=null},e.prototype._setupConversation=function(e,t,n){var i=this,r=u.getServices().conversations.get(this._conversationId,this._chatDataConfig);r.topic="null"===this._topic?"":this._topic,r.avatar=this._avatar?this._avatar:r.avatar;var o=e?"dl":"skype",s=W.default.getView(o);t.appendChild(s),this._chatInstances[this._conversationId]={view:s,model:r,container:t},this.enable(!0),ko.applyBindings({conversation:r,enable:this.enable},s),r.start(),y.ProxyConnector.instance.connect(n,{conversationId:this._conversationId}),this._chatDataConfig.SetConversationTopic&&r.isGroup()&&r.topic&&r.setTopic(r.topic),this._setActive(this._chatInstances[this._conversationId],!0),this._chatDataConfig.WelcomeMessage&&a.default.instance.MePersonManager.fetch().then(function(){a.default.instance.MePersonManager.mePerson.fetchDisplayNameAndAvatar().then(function(){return r.sendMessage(i._chatDataConfig.WelcomeMessage,h.ActionTrigger.WELCOME_MESSAGE)},function(e){})},function(e){}),this._CM.add(this._conversationId,{view:s,model:r,container:t,displayedAt:Date.now(),onStage:!1,vm:ko.dataFor(s.firstChild)}),j.default.get.isParallelView&&this.createContainer(this._conversationId),this._chatDataConfig.GroupWith&&"none"!==this._chatDataConfig.GroupWith&&r.addBotToThread(this._chatDataConfig.GroupWith)},e.prototype._triggerChatVisibilityChange=function(e,t){var n=this,i=L.default.getSdkModeFromId(t),r=i===_.SDKMode.BOT||i===_.SDKMode.DIRECT_LINE_TOKEN,s={type:e?"show":"hide",container:null,isVisible:e,conversationId:r?t:"n/a",key:t};j.default.get.frameless&&(s.container=this.getContainerByMri(t)),S.swc.API.triggerEvent(o.ApiEvents.OnVisibilityChange,s),e&&t&&i!==_.SDKMode.DIRECT_LINE_TOKEN&&a.default.instance.SignInManager.getSkypeToken().then(function(){n.sendInappActivityStart("Opened")},function(){}).catch(function(){})},e.prototype.restoreLastConversation=function(){if(this._conversationId){var e=this._chatInstances[this._conversationId];e&&(e.model.start(),this.isClientVisible()&&e.model.sdkMode!==_.SDKMode.DIRECT_LINE_TOKEN&&a.default.instance.WebApi.startEndpointActivation())}},e.prototype.disposeConversationsOnSkypeLogout=function(){for(var e in this._CM.disposeSkype(),this._chatInstances){var t=this._chatInstances[e].model;t.sdkMode!==_.SDKMode.DIRECT_LINE_TOKEN&&(t.dispose&&t.dispose())}a.default.instance.WebApi.stopEndpointActivation()},e.prototype.setupCalling=function(){var e=this;V.default.testSupporedList(s.default.ECS.callingSupportedBrowsers)&&(this._callingInitialized=!0,this._isModule||B.default.addStyle(m.PackageName.STYLE_CALLING,!0),S.swc.scriptLoader.addScript(m.PackageName.CALLING,!0,function(){S.swc.API.registerEvent("callingReady",function(){L.default.detectConversationType(e._chatDataConfig.ConversationId)===w.ConversationType.PHONE&&setTimeout(function(){return S.swc.API.triggerEvent(o.ApiEvents.StartCall,{calleeId:"4:"+e._chatDataConfig.ConversationId,withVideo:!1,avatarUrl:null,displayName:e._chatDataConfig.ConversationId.substr(2)})},1e3)});var t=document.createElement("div");t.style.display="none",e._callingComponent=new H.CallingView(t)}))},e.prototype._setupECS=function(e){e.data&&e.data.ecs&&(s.default.ECS=e.data.ecs,this._ECSConfig=s.default.ECS,S.swc.EcsConfig=s.default.ECS)},e.prototype._setupChatConfig=function(e){if(e.data&&e.data.chatConfig){var t=e.data;this._chatDataConfig=t.chatConfig||this._chatDataConfig,j.default.get.inputPlaceholderOverride=j.default.get.inputPlaceholderOverride||this._chatDataConfig.InputPlaceholder,j.default.get.style=j.default.get.style||this._chatDataConfig.Style,j.default.get.suppressBackgroundRinging=j.default.get.suppressBackgroundRinging||this._chatDataConfig.SuppressBackgroundRinging||"outlook"===j.default.get.style,j.default.get.isParallelView=j.default.get.isParallelView||this._chatDataConfig.ParallelView,j.default.get.isGuestOnlyMode=!!t.chatConfig.GuestOnly,j.default.get.sessionId=t.chatConfig.SessionId||j.default.get.sessionId||M.guid.generate(),j.default.get.parentProtocol=t.chatConfig.Protocol||e.data.chatConfig.Protocol||j.default.get.parentProtocol,j.default.get.correlationId=e.correlationId,j.default.get.isSkypeOnly=!!t.chatConfig.SkypeOnly,t.chatConfig.ForceAuthentication&&this._clearSessionData()}},e.prototype._clearSessionData=function(){b.default.get().removeItem(s.default.SKYPE_TOKEN_KEY),b.default.get().removeItem(s.default.SKYPE_REGTOKEN_KEY),b.default.get().removeItem("skype|epid"),b.default.get().removeItem("skype|hasHistory")},e.prototype._initChat=function(e){this.init(e||{}),j.default.get.host=e.host||j.default.get.host||"n/a",this._isModule=e.isModule;var t=window.location.hostname.replace("www.","");j.default.get.frameless=this._isModule||!N.default.isInIframe()&&t&&s.default.ECS.frameless.indexOf(t)>-1,j.default.get.callStartMode=this._chatDataConfig.CallStartMode,j.default.get.displayDeviceGuide=this._chatDataConfig.DisplayDeviceGuide,j.default.get.translatorEnabled=this._chatDataConfig.EnableTranslator,a.default.instance.TelemetryService.setCommonProperty("correlationId",j.default.get.correlationId),this.enable(this._chatDataConfig.Preload!==v.PreloadType.UIONLY),this.setup(e),this.isInitialized||(this.isInitialized=!0,S.swc.API.triggerEvent(o.ApiEvents.Ready,!0))},e.prototype.resolveMessage=function(e){var t=this;switch(e.action){case p.default.StartActivation:this.onClientFocused();break;case p.default.StopActivation:this.onClientBlurred();break;case p.default.ExpandChatWindow:break;case p.default.UpdateConversation:this._setupChatConfig(e),this._updateConversation(e.data,e.element);break;case p.default.LoadChatData:this.enable()||this._runChat(e),this._stylesReady&&(this._CM.baseParent.style.display="");break;case p.default.ShowChatWindow:if(this._setupECS(e),this._setupChatConfig(e),!e.data||!e.data.chatConfig)break;e.tokenString&&(e.tokenProvider=function(){return Promise.resolve(e.tokenString)});var n=function(){t.enable=ko.observable();var n=L.default.getSdkModeFromId(e.data.id),r=e.data.chatConfig.ConversationId,o=O.default.detectConversationType(r);if(e.data.id&&n===_.SDKMode.THREAD&&e.data.chatConfig.GuestOnly)u.loadServices().then(function(){a.default.instance.wx.join(e.data.id,"").then(function(n){n?(e.initialSkypeTokenData={skypeToken:n.skypetoken,isGuest:!0,expiresAt:828e5},t._initChat(e)):k.default.throwError(f.ErrorCodes.ERR_CREATE_GROUP_WITH_GUEST,"Unable to create group conversation with a guest")},function(e){k.default.throwError(f.ErrorCodes.ERR_CREATE_GROUP_WITH_GUEST,"Unable to create group conversation with a guest",e)})});else if(e.data.chatConfig.GroupWith.length>0&&e.data.chatConfig.GuestOnly)u.loadServices().then(function(){a.default.instance.wx.auth().then(function(n){n?(e.id=n.ThreadId,e.initialSkypeTokenData={skypeToken:n.SkypeToken,isGuest:!0,expiresAt:828e5},t._initChat(e)):k.default.throwError(f.ErrorCodes.ERR_CREATE_GROUP_WITH_GUEST,"Unable to create group conversation with a guest")},function(e){k.default.throwError(f.ErrorCodes.ERR_CREATE_GROUP_WITH_GUEST,"Unable to create group conversation with a guest",e)})});else if(e.data.chatConfig.GroupWith.length>0&&e.data.chatConfig.SkypeOnly){u.loadServices().then(function(){t.init(e),a.default.instance.SignInManager.getSkypeToken().then(function(){var n;n=new Array,e.data.chatConfig.GroupWith.split(",").forEach(function(e){n.push({role:w.ParticipantRole.User,id:L.default.toFullIdentifier(e)})}),0!==n.length&&(n.push({role:w.ParticipantRole.Admin,id:L.default.toFullIdentifier(a.default.instance.SignInManager.currentUserName)}),a.default.instance.WebApi.createThread(n).then(function(n){var i=n.headers.get("location").match(/threads\/(19:.*)$/)[1];e.id=i,a.default.instance.WebApi.enableJoining(i),a.default.instance.WebApi.discloseHistory(i),t._initChat(e)},function(){}))})})}else!r||w.ConversationType.PERSON!==o&&w.ConversationType.AGENT!==o||!P.isEnterpriseUserMri(r)&&!M.guid.isGuid(r)?u.loadServices().then(function(){return t._initChat(e)}):u.loadServices().then(function(t){try{return a.default.instance.SignInManager.onceSignedIn().then(function(){return a.default.instance.SignInManager.userIdentityType===g.IdentityType.TEAMS?P.generateOneToOneConversationId(e.data.chatConfig.ConversationId).then(function(t){var n=i({},e);return n.id=t,n.data.id=t,n.data.chatConfig.ConversationId=t,n}):e})}catch(t){return e}}).then(function(e){return t._initChat(e)})};y.ProxyConnector.instance.connect("messaging",null,this.setupMessagingProxy);var r=F.default.getVendorPath()+"/knockout-latest.js";S.swcWindow.ko?n():S.swc.scriptLoader.addScript(r,null,function(){return n()});break;case p.default.OpenChatWindow:this._forceExpandChat(this._conversationId),this.onOpenedChatWindow(),window.setTimeout(function(){return S.swc.API.triggerEvent(o.ApiEvents.ChatOpen,!0)},5)}},e.prototype.sendMessageToBot=function(e,t,n){if(t&&0!==t.length){var i=L.default.toFullIdentifier(t),r=this._chatInstances[i];if(r&&r.model)return r.model.sendDataToBot({payload:e}).then(function(e){return S.swc.API.triggerEvent(o.ApiEvents.invoke.sendMessageToBotResponse,{success:!0,botMessageId:n})},function(e){return S.swc.API.triggerEvent(o.ApiEvents.invoke.sendMessageToBotResponse,{success:!1,botMessageId:n})});var s="Unable to send message the bot - wrong chat id";return k.default.throwError(f.ErrorCodes.ERR_SENDING_MESSAGE_TO_BOT,s),Promise.reject(s)}},e.prototype.closeAllChats=function(){var e=this._chatInstances[this._conversationId];e&&(e.view.parentElement.style.display="none"),this.disposeConversations(),this._CM.dispose(),this._conversationId=""},e.prototype.isClientVisible=function(){if(!this._conversationId)return!1;var e=this._chatInstances[this._conversationId];return!!e&&e.model.isActive},e.prototype.sendInappActivityStart=function(e){a.default.instance.SignInManager.currentUserName&&S.swc.API.triggerEvent(o.ApiEvents.InappActivityStarted,e)},e}();t.default=G},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(515),o=n(517),s=n(518),a=n(519),c=n(520),l=n(521),u=n(522),d=n(523),p=n(529),h=n(530),f=n(531),g=n(532),m=n(534),v=n(536),_=n(537),y=function(){function e(){}return e.register=function(e){if(!this.isInitialized){g.default.register(),ko.components.isRegistered("conversations-list")||ko.components.register("conversations-list",{viewModel:{createViewModel:function(e,t){return new r.default(e.conversations,t.element)}},template:n(538),synchronous:!0}),ko.components.register("messageitem",{viewModel:{createViewModel:function(e,t){return new m.default(e.message,e.conversation,e.conversationContainer,t.element)}},template:n(539),synchronous:!0}),ko.components.register("usermessage",{viewModel:{createViewModel:function(t,n){return new u.default(t.message,t.conversation,t.messageListElement,n.element,e)}},template:n(462),synchronous:!0}),ko.components.register("systemmessage",{viewModel:{createViewModel:function(e,t){return new u.default(e.message,e.conversation,e.messageListElement,t.element)}},template:n(462),synchronous:!0}),ko.components.register("swiftcard",{viewModel:{createViewModel:function(e,t){return new d.default(e,t.element)}},template:n(540),synchronous:!0}),ko.components.register("adaptivecard",{viewModel:{createViewModel:function(e,t){return new p.default(e.content,e.conversation,t.element)}},template:n(541),synchronous:!0}),ko.components.register("lwcimage",{viewModel:{createViewModel:function(e,t){return new s.default(e.message,e.conversation,e.messageListElement,t.element)}},template:n(542),synchronous:!0}),ko.components.register("lwcfile",{viewModel:{createViewModel:function(e,t){return new o.default(e.message,e.conversation,e.messageListElement,t.element)}},template:n(543),synchronous:!0}),ko.components.register("lwcsharepointfile",{viewModel:{createViewModel:function(e){return new _.default(e.file,e.conversation,e.message)}},template:n(544),synchronous:!0}),ko.components.register("welcome",{viewModel:{createViewModel:function(e){return new f.default(e.message,e.conversation)}},template:n(545),synchronous:!0}),ko.components.register("skypelogo",{template:n(546),synchronous:!0}),ko.components.register("unreadsplitter",{template:n(547),synchronous:!0}),ko.components.register("unsupported",{viewModel:{createViewModel:function(t,n){return new u.default(t.message,t.conversation,t.messageListElement,n.element,e)}},template:n(548),synchronous:!0}),ko.components.register("translate",{viewModel:{createViewModel:function(e){return new h.default(e.message,e.conversation)}},template:n(549),synchronous:!0}),ko.components.register("audioplayer",{viewModel:{createViewModel:function(e,t){return new a.default(e,t.element)}},template:n(550),synchronous:!0}),ko.components.register("videoplayer",{viewModel:{createViewModel:function(e,t){return new l.default(e,t.element)}},template:n(551),synchronous:!0}),ko.components.register("gifplayer",{viewModel:{createViewModel:function(e,t){return new c.default(e,t.element)}},template:n(552),synchronous:!0}),ko.components.isRegistered("menu-list")||ko.components.register("menu-list",{viewModel:{createViewModel:function(e,t){return new v.default(e,t.element)}},template:n(553),synchronous:!0});var t=i.swc.Assets.SVG;ko.components.register("skype-logo",{template:t.skypeLogo}),ko.components.register("icon-chats",{template:t.iconChats}),ko.components.register("icon-sent",{template:t.iconSent}),ko.components.register("icon-minimize",{template:t.iconMinimize}),ko.components.register("icon-maximize",{template:t.iconMaximize}),ko.components.register("icon-arrow",{template:t.iconArrow}),ko.components.register("icon-file-img",{template:t.iconFileUpload}),ko.components.register("icon-expression-picker",{template:t.iconExpressionPicker}),ko.components.register("icon-search",{template:t.iconSearch}),ko.components.register("icon-download",{template:t.iconDownload}),ko.components.register("icon-error",{template:t.iconError}),ko.components.register("icon-mute",{template:t.iconMute}),ko.components.register("icon-unmute",{template:t.iconUnmute}),ko.components.register("icon-exit-fullscreen",{template:t.iconExitFullscreen}),ko.components.register("icon-enter-fullscreen",{template:t.iconEnterFullscreen}),ko.components.register("icon-play",{template:t.iconPlay}),ko.components.register("icon-pause",{template:t.iconPause}),ko.components.register("icon-group-avatar",{template:t.iconGroupAvatar}),ko.components.register("icon-globus",{template:t.iconGlobus}),ko.components.register("icon-call-start",{template:t.iconCallStart}),ko.components.register("icon-open-url",{template:t.iconOpenUrl}),ko.components.register("icon-delete",{template:t.iconDelete}),ko.components.register("icon-delete-message",{template:t.iconDeleteMsg}),ko.components.register("icon-pencil",{template:t.iconPencil}),ko.components.register("icon-ok",{template:t.iconOk}),ko.components.register("icon-cancel",{template:t.iconCancel}),ko.components.register("icon-contact",{template:t.iconContact}),ko.components.register("icon-contact-add",{template:t.iconContactAdd}),ko.components.register("icon-contact-delete",{template:t.iconContactDelete}),ko.components.register("icon-pstn-contact",{template:t.iconPstnContact}),ko.components.register("icon-video",{template:t.iconVideo}),ko.components.register("icon-chevron",{template:t.iconChevron}),ko.components.register("icon-speaker",{template:t.iconSpeaker}),ko.components.register("icon-more",{template:t.iconMore}),this.isInitialized=!0}},e.unregister=function(){for(var e=0,t=["contactrequest","usermessage","systemmessage","menu-list","swiftcard","adaptivecard","lwcimage","lwcfile","icon-sent","icon-expression-picker","icon-search","icon-file-img","icon-download","icon-error","icon-mute","icon-unmute","icon-exit-fullscreen","icon-enter-fullscreen","icon-play","icon-pause","audioplayer","videoplayer","gifplayer","icon-group-avatar","icon-call-start","icon-open-url","skype-logo","icon-delete","icon-delete-message","icon-pencil","icon-ok","icon-cancel","icon-contact","icon-contact-add","icon-contact-delete","icon-pstn-contact","icon-video","icon-chevron","icon-maximize","icon-minimize","icon-speaker","icon-more"];e<t.length;e++){var n=t[e];ko.components.unregister(n)}this.isInitialized=!1},e.isInitialized=!1,e}();t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),r=n(9),o=n(456),s=function(){return function(e,t){var n=this;this.conversations=e,this.element=t,this.count=ko.observable(0),this.expanded=ko.observable(!1),this.toggleExpand=function(){n.expanded(!n.expanded())},this.appendAvatarVM=function(e,t,n){if(e&&e.nodeType===Node.ELEMENT_NODE){var s=document.createDocumentFragment(),a={customAvatar:n.chatDataConfig.Avatar,customTitle:n.chatDataConfig.Title,conversation:n.conversation},c=r.createElement(o.ConversationAvatar,a);i.render(c,s),e.insertBefore(s,e.firstChild)}},this.conversationsList=this.conversations.conversationsList,this.conversationsList.subscribe(function(){n.count(n.conversationsList().length)})}}();t.default=s},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n(12),a=n(9),c=n(67),l=function(e){function t(t){var n=e.call(this,t)||this;return n._onAvatarUpdate=function(e){n.setState({avatarUrl:e})},n._onTopicUpdate=function(e){n.setState({title:e})},n.state={title:"",avatarUrl:""},n}return r(t,e),t.prototype.componentDidMount=function(){var e=this.props.group;this.props.customTitle?this._onTopicUpdate(this.props.customTitle):(this._onTopicUpdate(e.topic),e.subscribe("topic",this._onTopicUpdate)),this.props.customAvatar?this._onAvatarUpdate(this.props.customAvatar):(this._onAvatarUpdate(e.avatar),e.subscribe("avatar",this._onAvatarUpdate))},t.prototype.componentWillUnmount=function(){var e=this.props.group;e.unsubscribe("avatar",this._onAvatarUpdate),e.unsubscribe("topic",this._onTopicUpdate)},t.prototype.render=function(){return a.createElement(c.BasicAvatar,o({},this.state))},t}(s.Component);t.GroupAvatar=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(0),o=n(457),s=function(){return function(e,t,n,s){var a=this;this.url=ko.observable(),this.originalName=ko.observable(),this.downloaded=ko.observable(!1),this.downloadFile=function(){a._conversation.download(a.url())||i.default.instance.AmsManager.downloadFile(a.url()).then(function(e){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(e,a.originalName());else{var t=window.URL||r.swcWindow.webkitURL,n=t.createObjectURL(e),s=document.createElement("a");document.body.appendChild(s),s.href=n,s.setAttribute("download",a.originalName()),s.click(),t.revokeObjectURL(n)}a.downloaded(!0);var c=new o.default(a.message,a._conversation,a.originalName());c.action=o.FileActions.downloadClick,i.default.instance.TelemetryService.sendEvent(c)})},this.computeDisplaySize=function(e){for(var t=0;e>=1024;)e/=1024,t++;return Math.floor(e)+" "+["Bytes","KB","MB","GB"][t]},this.computeCssClasses=function(){var e={done:a.downloaded()};return e[a.extension]=!0,e},this.parse=function(){if(a.documentId=a.retrieveDocumentId(a.message.content),a.documentId&&null!==a.documentId){var e=a.message.content.match(/<LwcFile[^>]*?\ssize=\"([\d]+?)\"/i);a.size=e&&parseInt(e[1],10)||0;var t=a.message.content.match(/<LwcFile[^>]*?\soriginalName=\"([^"]+?)\"/i);a.originalName(t?t[1]:null);var n=a.message.content.match(/<LwcFile[^>]*?\surl=\"([^"]+?)\"/i);a.url(n?n[1]:null)}},this.retrieveDocumentId=function(e){var t=e.match(/<LwcFile[^>]*?\surl=\"([^"]+?)\"/i);if(!t)return null;var n=t[1];return n.substr(n.lastIndexOf("/")+1)},this.message=e,this.messageList=n,this.parse(),this.displaySize=this.computeDisplaySize(this.size),this.extension=(this.originalName()||"").match(/[0-9a-z]+$/i)[0].toLowerCase(),this.iconClasses=ko.computed(this.computeCssClasses),this._conversation=t}}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(0),o=function(){return function(e,t,n,o){var s=this;this.thumbnailUrl=ko.observable(),this.pictureUrl=ko.observable(),this.parse=function(){var e=s.retrieveDocumentId(s.message.content);e&&null!==e&&i.default.instance.AmsManager.downloadPictureThumbnail(e).then(function(e){var t=(window.URL||r.swcWindow.webkitURL).createObjectURL(e);s.thumbnailUrl(t)})},this.retrieveDocumentId=function(e){var t=e.match(/<LwcImage[^>]*?\surl=\"([^"]+?)\"/i);if(!t)return null;var n=t[1];return n.substr(n.lastIndexOf("/")+1)},this.retrieveDocumentUrl=function(e){var t=e.match(/<LwcImage[^>]*?\surl=\"([^"]+?)\"/i);return t?t[1]:null},this.retrieveFilename=function(e){var t=e.match(/<LwcImage[^>]*?\sfilename=\"([^"]+?)\"/i);if(!t)return null;var n=t[1];return n.substr(n.lastIndexOf("/")+1)},this.downloadImage=function(){var e=null,t=!!navigator.msSaveOrOpenBlob,n=s.retrieveDocumentId(s.message.content),r=s.retrieveDocumentUrl(s.message.content);r&&-1===r.indexOf("/views/imgpsh_fullsize")?r+="/views/imgpsh_fullsize":r="https://api.asm.skype.com/v1/objects/"+n+"/views/imgpsh_fullsize",s._conversation.download(r)||(t||(e=window.open("","_blank")),i.default.instance.AmsManager.downloadPicture(n).then(function(n){t?navigator.msSaveOrOpenBlob(n,s.retrieveFilename(s.message.content)):e.location.href=r}))},this.message=e,this.messageList=n,this.parse(),this._conversation=t}}();t.default=o},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),s=n(458),a=n(451),c=function(e){function t(t,n){var i=e.call(this,n,o.SwiftCardContentType.audio)||this;return i._params=t,i._element=n,i.shouldShowCover=function(){return!(!i.coverImage||!i.coverImage.url)},i.onAudioEnded=function(){i.isPlaying(!1)},i.dispose=function(){i.showCoverImage.dispose()},i.coverImage=t.coverImage,i.media=t.media,i.autoloop=t.autoloop,i.id=t.messageId,i.showLoadingInfo=t.showLoadingInfo||!0,i.showCoverImage=ko.computed(i.shouldShowCover),a.default.instance.registerPlayer(i),i}return r(t,e),t}(s.default);t.default=c},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){var i=e.call(this,n)||this;return i._params=t,i._element=n,i.shouldShowCover=function(){return!(!i.coverImage||!i.coverImage.url||i.canPlay())},i.dispose=function(){i.showCoverImage.dispose()},i.media=t.media,i.coverImage=t.coverImage,i.showCoverImage=ko.computed(i.shouldShowCover),i.showLoadingInfo=t.showLoadingInfo||!0,i}return r(t,e),t}(n(460).default);t.default=o},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(7),a=n(458),c=n(451),l=".videoPlayer",u=function(e){function t(t,n){var i=e.call(this,n,s.SwiftCardContentType.video)||this;return i._params=t,i._element=n,i.thumbnail=ko.observable(),i.toggleMuteText=function(){var e=i.isMuted()?"videoPlayer_button_unmute":"videoPlayer_button_mute";return o.default.instance.i18n.fetch(e)},i.onVideoEnded=function(){i.touchedByUser=!1,i.isPlaying(!1)},i.getFullscreenButtonText=function(){var e=i.isInFullscreen()?"videoPlayer_exitFullscreen":"videoPlayer_fullscreen";return o.default.instance.i18n.fetch(e)},i.enterFullscreen=function(){i.playerHolder.requestFullscreen?i.playerHolder.requestFullscreen():i.playerHolder.mozRequestFullScreen?i.playerHolder.mozRequestFullScreen():i.playerHolder.webkitRequestFullScreen?i.playerHolder.webkitRequestFullScreen():i.playerHolder.msRequestFullscreen&&i.playerHolder.msRequestFullscreen()},i.onProgress=function(e){},i.exitFullscreen=function(){var e=document;e.exitFullscreen?e.exitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.msExitFullscreen&&e.msExitFullscreen()},i.toggleFullscreen=function(){i.touchedByUser=i.isPlaying(),i.isInFullscreen()?i.exitFullscreen():(i.enterFullscreen(),c.default.instance.onEnteringFullscreen(i),i.trackFullscreenAction())},i.trackSeekingAction=function(){i.wasSeeked||(i.wasSeeked=!0)},i.trackFullscreenAction=function(){i.wasInFullscreen||(i.wasInFullscreen=!0)},i.dispose=function(){i.fullscreenButtonText.dispose()},i.thumbnail=t.thumbnail?t.thumbnail.url:ko.observable(),i.media=t.media,i.autoplay=t.autoplay,i.autoloop=t.autoloop,i.id=t.messageId,i.showLoadingInfo=t.showLoadingInfo||!0,i.title=t.title,i.subtitle=t.subtitle,i.displayCurrentTime=t.displayCurrentTime,i.displayTotalTime=t.displayTotalTime,i.displayMuteButton=t.displayMuteButton,i.isMuted=ko.observable(t.muted),i.playerHolder=n.querySelector(l),i.isFullscreenSupported=!!(i.playerHolder.requestFullscreen||i.playerHolder.mozRequestFullScreen||i.playerHolder.webkitRequestFullScreen||i.playerHolder.msRequestFullscreen),i.fullscreenButtonText=ko.computed(i.getFullscreenButtonText),i.player&&(i.player.muted=t.muted),t.autoplay&&(c.default.instance.pauseAll(),i.play()),c.default.instance.registerPlayer(i),i}return r(t,e),t.prototype.toggleMute=function(){this.touchedByUser=!0,this.isMuted()?this.mute(!1):this.mute(!0)},t}(a.default);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(117),r=n(1),o=n(7),s=function(){return function(e,t,n,s,a){var c=this;this.message=e,this.conversation=t,this.content=ko.observable(),this.imageContent=ko.observable(),this.isAgent=ko.observable(),this.showStatus=ko.observable(),this.messageColor=ko.observable(),this.isTranslated=ko.observable(),this.isExtraLargeEmoticon=ko.observable(),this.dispose=function(){c.message.unsubscribe("content",c.content),c.message.unsubscribe("imageContent",c.imageContent)},this.messageList=n,"waiting_for_replay"===e.content?this.content(r.default.instance.i18n.fetch("waitingForReply",{user_name:t.topic})):e.processedContent?this.content(e.processedContent):this.content(e.content),this.imageContent(e.imageContent),e.isTranslated||e.subscribe("content",function(e){return c.content(e)}),e.subscribe("imageContent",function(e){return c.imageContent(e)}),this.isTranslated(e.isTranslated),e.subscribe("isTranslated",function(e){c.isTranslated(e),e&&c.message.unsubscribe("content",c.content)}),this.isAgent(this.conversation.isAgent()),a&&a.ColorMessage&&e.direction===o.Direction.Incoming&&this.messageColor(a.ColorMessage),this.isExtraLargeEmoticon(i.default.hasLargeEmoticon(this.content()))}}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),r=n(25),o=n(524),s=/(<swiftcard>?[\s\S]*<\/swiftcard>)/i,a=/(?:<swiftcard[\s]+swift=\")([\s\S]*)(?:\">)/i,c=-1,l=function(){return function(e,t){var n=this;this.element=t,this.isDisjoined=!0,this.unsupportedText="Swift is not supported",this.parse=function(e,t,l){var u;if(!/^<swiftcard/i.test(e.content))return c;n.content=e.content;var d=e.content.match(s);if(!d||0===d.length)return c;var p=d[0].replace("><",">$$$<").split("$$$"),h=n.find(p,function(e){return a.test(e)});if(!h)return c;var f,g=h.match(a)[1];try{u=JSON.parse(g)}catch(t){return f=e.content,r.default.dompurify.sanitize(f,{ALLOWED_TAGS:[]})}n.swift=new o.default(u,t,e,l),n.customMessageClasses="swiftCard "+(n.swift.isSupported()?i.SwiftCardType[n.swift.type].toLowerCase():"unsupported")+(n.swift.isValid()?"":" invalid")},this.find=function(e,t){var n;for(n=0;n<e.length;++n)if(t(e[n],n,e))return e[n]},this.message=e.message,this.conversation=e.conversation,this.parse(e.message,e.conversation,this.element)===c&&(this.content=this.unsupportedText,this.swift=new o.default({},e.conversation,e.message,this.element))}}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(50),r=n(1),o=n(7),s=n(130),a=n(74),c=n(525),l=n(118),u=n(56),d=function(){return function(e,t,n,d){var p=this;if(this._encoder=new i.default,this.CAROUSEL_WIDTH_DEFAULT=288,this.CAROUSEL_WIDTH_NARROW=204,this.selectedCard=ko.observable(0),this.unsupportedText=r.default.instance.i18n.fetch("s_unsupported"),this.types={Unknown:o.SwiftCardType.unknown,Card:o.SwiftCardType.card,Carousel:o.SwiftCardType.carousel,SignIn:o.SwiftCardType.signin,Receipt:o.SwiftCardType.receipt},this.carouselLeftPosition=function(){var e=p.CAROUSEL_WIDTH_DEFAULT;return s.default.instance.CurrentStyle===s.StyleModes.NARROW&&(e=p.CAROUSEL_WIDTH_NARROW),p.isFirst()?"0px":p.isLast()?"calc("+p.selectedCard()*-e+"px + (100% - "+e+"px))":"calc("+p.selectedCard()*-e+"px + (100% - "+e+"px) / 2)"},this.isSupported=function(){var e=p.cards.every(function(e){return e.isSupported()});return p.isValid()&&p.type!==o.SwiftCardType.unknown&&e},this.isValid=function(){var e=p.cards.every(function(e){return e.isValid()});return!!p.type&&0!==p.cards.length&&e},this.isCarousel=function(){return p.type===o.SwiftCardType.carousel},this.isMultilineCard=function(){return p.type===o.SwiftCardType.multiline},this.nextCard=function(){p.moveTo(p.selectedCard()+1)},this.prevCard=function(){p.moveTo(p.selectedCard()-1)},this.moveTo=function(e){e<0||e>=p.cards.length||(p.selectedCard(e),p.isFirst(0===e),p.isLast(e===p.cards.length-1))},this.moveToCard=function(e){p.moveTo(p.cards.indexOf(e))},this._isDl=t.isDirectLineBackend(),this.types["message/card"]=o.SwiftCardType.card,this.types["message/card.carousel"]=o.SwiftCardType.carousel,this.types["message/card.signin"]=o.SwiftCardType.signin,this.types["message/card.receipt"]=o.SwiftCardType.receipt,this.types["message/card.multiline"]=o.SwiftCardType.multiline,this.content=e.content?u.default.normalizeRichText(e.content,this._isDl):null,this.summary=u.default.normalizeText(e.summary),this.type=e.type?this.types[e.type]:null,this.cards=u.default.mapArray(e.attachments,function(e){return new c.default(e,t,n.senderId,d)}),e.suggestedActions&&e.suggestedActions.actions&&e.suggestedActions.actions.forEach(function(e){e.title&&(e.title=p._encoder.decode(p._encoder.encode(e.title))),n.suggestedActions.pushObservable(new l.default(e,t,n.senderId))}),this.isValid()){if(this.isSupported()||(this.button=new a.default({type:o.SwiftCardActionType.unsupported,title:r.default.instance.i18n.fetch("s_learnMore")},t,n.senderId)),this.areButtonsMultiLine=!this.cards.every(function(e){return e.content&&e.isValid()&&!1===e.content.areButtonsMultiLine}),this.isFirst=ko.observable(!0),this.isLast=ko.observable(1===this.cards.length),this.selectedCard=ko.observable(0),this.isMultiple=ko.observable(this.cards.length>1),this.isMultiple())for(var h=0;h<this.cards.length;h++){var f=this.cards[h];if(f.isValid()&&f.content&&f.content.mainSection)for(var g=0;g<f.content.mainSection.images.length;g++)f.content.mainSection.images[g].isImageInCarousel(!0)}this.prevCardTitle=r.default.instance.i18n.fetch("s_prevCard"),this.nextCardTitle=r.default.instance.i18n.fetch("s_nextCard")}else this.button=new a.default({type:o.SwiftCardActionType.unsupported,title:r.default.instance.i18n.fetch("s_learnMore")},t,n.senderId)}}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),r=n(461),o=function(){return function(e,t,n,o){var s=this;if(this.contentType=i.SwiftCardContentType.unknown,this.content=null,this.isValid=function(){return s.contentType===i.SwiftCardContentType.adaptive||s.contentType!==i.SwiftCardContentType.unknown&&s.content&&s.content.isValid&&s.content.isValid()||s.contentType===i.SwiftCardContentType.unknown},this.isSupported=function(){return s.contentType===i.SwiftCardContentType.adaptive||s.contentType!==i.SwiftCardContentType.unknown&&(!s.content||!!s.content.isSupported&&s.content.isSupported())},this.getContentTypeName=function(){return i.SwiftCardContentType[s.contentType].toLowerCase()},this.convertToCardContentType=function(e,t){if(!e)return i.SwiftCardContentType.unknown;var n=t&&t.media&&t.media[0]&&t.media[0].profile;try{switch(e.toLowerCase()){case"application/vnd.microsoft.card.hero":return i.SwiftCardContentType.hero;case"application/vnd.microsoft.card.thumbnail":return i.SwiftCardContentType.thumb;case"application/vnd.microsoft.card.receipt":return i.SwiftCardContentType.receipt;case"application/vnd.microsoft.card.signin":return i.SwiftCardContentType.signin;case"application/vnd.microsoft.card.video":return i.SwiftCardContentType.video;case"application/vnd.microsoft.card.audio":return i.SwiftCardContentType.audio;case"application/vnd.microsoft.card.flex":return i.SwiftCardContentType.flex;case"application/vnd.microsoft.card.animation":return"video"===n?i.SwiftCardContentType.video:i.SwiftCardContentType.animation;case"application/vnd.microsoft.card.adaptive":return i.SwiftCardContentType.adaptive;default:return i.SwiftCardContentType.unknown}}catch(e){return i.SwiftCardContentType.unknown}},this.contentType=this.convertToCardContentType(e.contentType,e.content),this.content=null,this._conversation=t,e.content)switch(this.contentType){case i.SwiftCardContentType.hero:case i.SwiftCardContentType.thumb:this.content=new r.default(e.content,t,n,this.contentType);break;case i.SwiftCardContentType.signin:this.content=new r.SignInContent(e.content,t,n);break;case i.SwiftCardContentType.receipt:this.content=new r.ReceiptContent(e.content,t,n);break;case i.SwiftCardContentType.audio:case i.SwiftCardContentType.video:case i.SwiftCardContentType.animation:this.content=new r.MediaContent(e.content,t,n,this.contentType);break;case i.SwiftCardContentType.flex:this.content=new r.FlexContent(e.content,t,n,this.contentType);break;case i.SwiftCardContentType.adaptive:this.content=e.content}}}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(56),r=function(){return function(e,t){var n=this;this.isValid=function(){return!!n.key||!!n.value},this.key=i.default.normalizeRichText(e.key,t),this.value=i.default.normalizeRichText(e.value,t)}}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),r=n(119),o=n(56),s=function(){return function(e,t,n,s){var a=this;if(this.isValid=function(){return!!(a.video||a.audio||a.animation||a.animation.url)},this.getSourceDomain=function(e){var t=e.replace(/^(https?:\/\/)?(w*\.)?/i,"");return t?t.split("/")[0]:null},this.url=e.url?o.default.normalizeUrl(e.url,t.isDirectLineBackend()):null,this.url)switch(s){case i.SwiftCardContentType.video:this.video=this.url;break;case i.SwiftCardContentType.audio:this.audio=this.url;break;case i.SwiftCardContentType.animation:this.animation=new r.default(e||{},t,n,s)}this.sourceDomain=this.url?this.getSourceDomain(this.url):null}}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(7),o=n(74),s=n(119),a=n(56),c=n(56),l=function(){return function(e,t,n,l){var u=this;this.expandedText=function(){return""===u.subtitle||""===u.title},this.isValid=function(){return!!u.title||!!u.subtitle||!!u.text||!!u.buttons&&0!==u.buttons.length||u.images&&0!==u.images.length},this.getTitleByType=function(){switch(u.tap.type){case r.SwiftCardActionType.call:case r.SwiftCardActionType.imBack:return u.createSectionTitle();case r.SwiftCardActionType.openUrl:return u.createSectionTitle()+"\n\n"+u.tap.value}return""},this.createSectionTitle=function(){return i.default.instance.i18n.fetch("accessibility_swift_action_prefix",{swiftAction:u.lowerFirstLetter(u.tap.title)})},this.lowerFirstLetter=function(e){return e?e[0].toLowerCase()+e.substring(1):""};var d=new s.default(e.image||{},t,n,l);this._conversation=t,this._isDl=this._conversation.isDirectLineBackend(),this.title=a.default.normalizeRichText(e.title,this._isDl),this.subtitle=a.default.normalizeRichText(e.subtitle,this._isDl),this.text=a.default.normalizeRichText(e.text,this._isDl),this.price=a.default.normalizeText(e.price),this.images=e.images?c.default.mapImages(e.images,t,n,l):[],0===this.images.length&&e.image&&e.image.url&&this.images.push(d),this.buttons=c.default.filterOutDisabledItems(e.buttons,function(e){return new o.default(e,t,n)}),this.tap=e.tap?c.default.getItemIfNotDisabled(new o.default(e.tap||{},t,n)):null}}();t.default=l},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s=n(51),a=n(7),c=n(0),l=n(19),u="/adaptivecardsv2.min.js",d=/swc:addon:open=([^&]*)/g,p={supportsInteractivity:!0,fontFamily:"Segoe UI",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{fontColors:{default:{normal:"#333333",subtle:"#EE333333"},accent:{normal:"#2E89FC",subtle:"#882E89FC"},good:{normal:"#54a254",subtle:"#DD54a254"},warning:{normal:"#c3ab23",subtle:"#DDc3ab23"},attention:{normal:"#FF0000",subtle:"#DDFF0000"}},backgroundColor:"#FFFFFF"},emphasis:{fontColors:{default:{normal:"#333333",subtle:"#EE333333"},accent:{normal:"#2E89FC",subtle:"#882E89FC"},good:{normal:"#54a254",subtle:"#DD54a254"},warning:{normal:"#c3ab23",subtle:"#DDc3ab23"},attention:{normal:"#FF0000",subtle:"#DDFF0000"}},backgroundColor:"#08000000"}},spacing:{small:3,default:8,medium:20,large:30,extraLarge:40,padding:10},separator:{lineThickness:1,lineColor:"#EEEEEE"},actions:{maxActions:5,spacing:"Default",buttonSpacing:20,showCard:{actionMode:"Inline",inlineTopMargin:16,style:"Emphasis"},preExpandSingleShowCardAction:!1,actionsOrientation:"Horizontal",actionAlignment:"Left"},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:"Medium",maxImageHeight:"maxImageHeight"},factSet:{title:{size:"Default",color:"Default",isSubtle:!1,weight:"Bolder",warp:!0},value:{size:"Default",color:"Default",isSubtle:!1,weight:"Default",warp:!0},spacing:10}},h=function(e){function t(t,n,i){var r=e.call(this)||this;r.element=i,r._actionHandlers={},r._mapSupportedActionTypes=function(){r._actionHandlers["Action.OpenUrl"]=r.openUrl,r._actionHandlers["Action.ShowCard"]=r.showCard,r._actionHandlers["Action.Http"]=r.httpAction,r._actionHandlers["Action.Submit"]=r.submit,r._actionHandlers.Submit=r.submit},r._processNodes=function(e,t){for(var n=0;n<e.length;n++){var i=e[n];if("p"===i.nodeName)r._processNodes(i.childNodes,t),t.push(250);else if("s"===i.nodeName)r._processNodes(i.childNodes,t),t.push(100);else if("break"===i.nodeName)if(i.attributes.strength){var o=i.attributes.strength.nodeValue;"weak"===o||("medium"===o?t.push(50):"strong"===o?t.push(100):"x-strong"===o&&t.push(250))}else i.attributes.time&&t.push(JSON.parse(i.attributes.time.value));else"audio"===i.nodeName?i.attributes.src&&t.push(i.attributes.src.value):"say-as"===i.nodeName?r._processNodes(i.childNodes,t):"w"===i.nodeName?r._processNodes(i.childNodes,t):"phoneme"===i.nodeName?r._processNodes(i.childNodes,t):t.push(i.nodeValue)}},r._renderContent=function(){r._element.parentElement.insertBefore(r._content,r._element),c.swc.API.triggerEvent(o.ApiEvents.scrollToBottom,r._conversation.id)},r._playSpeech=function(e,t){if(t<e.length){var n=e[t];if("number"==typeof n)setTimeout(function(){r._playSpeech(e,t+1)},n);else if(0===n.indexOf("http"))r._audioContainer.autoplay=!0,r._audioContainer.src=n,r._audioContainer.onended=function(){return r._playSpeech(e,t+1)},r._audioContainer.onerror=function(){return r._playSpeech(e,t+1)},r._audioContainer.play();else{var i=new(0,window.SpeechSynthesisUtterance);if(!c.swcWindow.speechSynthesis||!i)return;i.text=n,i.lang="en-US",i.onerror=function(n){r._playSpeech(e,t+1)},i.onend=function(n){r._playSpeech(e,t+1)},c.swcWindow.speechSynthesis.speak(i)}}},r._renderSpeech=function(){if(r._speechString&&r._speechString.length){var e=document.createElement("div");e.setAttribute("style","text-align: right; padding: 5px");var t=document.createElement("button");t.innerHTML=c.swc.Assets.SVG.iconSpeaker,t.setAttribute("style","background: transparent; border: 0; cursor: pointer"),t.className="button";var n=new Array;if("<"===r._speechString[0]){0!==r._speechString.indexOf("<speak")&&(r._speechString="<speak>\n"+r._speechString+"\n</speak>\n");var i=(new DOMParser).parseFromString(r._speechString,"text/xml"),o=i.documentElement.childNodes;r._processNodes(o,n);var s=new XMLSerializer;r._speechString=s.serializeToString(i)}else n.push(r._speechString);t.addEventListener("click",function(){r._playSpeech(n,0)}),e.appendChild(t),e.appendChild(r._audioContainer),r._element.parentElement.insertBefore(e,r._element)}},r.executeAction=function(e){if(e&&!e.stop){var t=e.type||e.title,n=r._actionHandlers[t];!n&&e.url&&(n=r._actionHandlers["Action.OpenUrl"]),n&&"function"==typeof n&&n(e)}},r.openUrl=function(e){if(e.url){if(e.url.match(/^skype:\?payments/));else{if(e.url.match(d))return void("overlay"===d.exec(e.url)[1]&&c.swc.API.triggerEvent("swc:addon:open",{id:r._conversation.id,url:e.url}));e.url.match(/^skype:/)}window.open(e.url,"_blank").opener=null}},r.submit=function(e){if(!e.data)return null;var t={value:JSON.stringify({userSubmitData:e.data}),title:""};return r._conversation.sendSwift(t).then(function(){return Promise.resolve()}).catch(function(){})},r.isValid=function(){return!!r._content},r.isSupported=function(){return r.isValid()},r.renderOptions={hostConfig:p,onExecuteAction:r.executeAction},r._element=i,r._conversation=n,r._audioContainer=document.createElement("audio");var s=l.default.getVendorPath()+u;return c.swcWindow.AdaptiveCards?(r._adaptiveCard=c.swcWindow.AdaptiveCards,r._render(t)):c.swc.scriptLoader.addScript(s,null,function(){r._adaptiveCard=c.swcWindow.AdaptiveCards,r._render(t)}),r}return r(t,e),t.prototype._render=function(e){e&&this._adaptiveCard&&(e.version=e.version||"1.0",e.body&&(e.body=e.body.filter(function(e){return e.text&&(e.text=s.default.parse(e.text)),e})),this._content=this._adaptiveCard.renderCard(e,this.renderOptions),this.type=a.SwiftCardContentType.adaptive,this._mapSupportedActionTypes(),this._renderContent())},t.prototype.showCard=function(e){},t.prototype.httpAction=function(e){},t.ready=!1,t}(n(461).BaseContent);t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),r=n(1),o=function(){function e(e,t){this.myLanguage=ko.observable(),this.theirLanguage=ko.observable(),this.callToAction=ko.observable(),this.they_are_speaking=ko.observable(r.default.instance.i18n.fetch("they_are_speaking",{theirLanguage:this.theirLanguage()})),this.you_are_speaking=ko.observable(r.default.instance.i18n.fetch("you_are_speaking",{myLanguage:this.myLanguage()})),this.myLanguage(i.default.get.translationLanguages[navigator.language.split("-")[0]].name),this.theirLanguage(i.default.get.translationLanguages[i.default.get.translationLanguage].name),this.callToAction("Start translation?")}return e.prototype.activateTranslation=function(){this.callToAction("")},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),r=n(1),o=n(23),s=n(44),a=n(32),c=function(){function e(e,t){var n=this;this.loggedIn=ko.observable(),this.nameClicked=ko.observable(!1),this.isAgent=ko.observable(!0),this.isGuest=ko.observable(!0),this.displayName=ko.observable(),this.say_hi=ko.observable(r.default.instance.i18n.fetch("say_hi")),this.or_text=ko.observable(r.default.instance.i18n.fetch("or_text")),this.sign_in_text=ko.observable(r.default.instance.i18n.fetch("sign_in_text")),this.to_save_your_chat=ko.observable(r.default.instance.i18n.fetch("to_save_your_chat")),this.welcome_back_text=ko.observable(r.default.instance.i18n.fetch("welcome_back_text")),this.click_here_text=ko.observable(r.default.instance.i18n.fetch("click_here_text")),this.to_switch_accounts=ko.observable(r.default.instance.i18n.fetch("to_switch_accounts")),this.title=ko.observable(),this.disableLogout=ko.observable(),this.dispose=function(){r.default.instance.SignInManager.unsubscribe("isSignedIn",n.onAppReadyStateChange),r.default.instance.MePersonManager.mePerson&&r.default.instance.MePersonManager.mePerson.unsubscribe("displayName",n.onDisplayNameChange)},this.onDisplayNameChange=function(){n.setGreetingMessage()},this.onAppReadyStateChange=function(){n.welcomeMsgHandler()},this.isGuestOnlyMode=i.default.get.isGuestOnlyMode,this._conversation=t,this.say_hi_to_bot_aria=r.default.instance.i18n.fetch("say_hi_to_a_bot"),this.sign_in_to_save_chat_aria=r.default.instance.i18n.fetch("sign_in_to_save_your_chat"),this.click_here_to_switch_accounts_aria=r.default.instance.i18n.fetch("click_here_to_switch_accounts_aria_label"),this.msg_hi=r.default.instance.i18n.fetch("hi"),r.default.instance.SignInManager.subscribe("isSignedIn",this.onAppReadyStateChange),r.default.instance.MePersonManager.mePerson.subscribe("displayName",this.onDisplayNameChange),this.isAgent(t.isAgent()),this.isGuest(r.default.instance.MePersonManager.mePerson.isGuest),this.welcomeMsgHandler(),this.setGreetingMessage(),this.getConversationTitle(),this.disableLogout(this._conversation.definition.DisableLogout)}return e.prototype.getConversationTitle=function(){var e=this;if(""!==this._conversation.topic||this._conversation.isGroup())this.title(this._conversation.topic),this._conversation.subscribe("topic",function(t){e.title(t)});else{var t=r.default.instance.Persons.getPerson(this._conversation.id,!0);t.displayName===t.id&&r.default.instance.SignInManager.getSkypeToken().then(function(n){r.default.instance.SignInManager.state===o.SigninState.SignedIn&&e._subscribeToDisplayName(t)}).catch(function(n){r.default.instance.SignInManager.state===o.SigninState.SignedIn?e._subscribeToDisplayName(t):r.default.instance.SignInManager.subscribe("state",function(){r.default.instance.SignInManager.state===o.SigninState.SignedIn&&(e._subscribeToDisplayName(t),t.fetchDisplayNameAndAvatar())})})}},e.prototype._subscribeToDisplayName=function(e){var t=this;e.displayName&&this._handleDisplayName(e),e.subscribe("displayName",function(){return t._handleDisplayName(e)})},e.prototype._handleDisplayName=function(e){this.title(e.displayName===e.id?"":e.displayName)},e.prototype.signin=function(){r.default.instance.SignInManager.login()},e.prototype.sendHi=function(){this._conversation.sendMessage(this.msg_hi,s.ActionTrigger.WELCOME_MESSAGE)},e.prototype.nameClick=function(){this._conversation.definition.DisableLogout||this.nameClicked(!0)},e.prototype.signout=function(){this.nameClicked(!1),r.default.instance.SignInManager.logout("welcome")},e.prototype.welcomeMsgHandler=function(){r.default.instance.SignInManager.userIdentityType!==a.IdentityType.GUEST?this.loggedIn(r.default.instance.SignInManager.state!==o.SigninState.SignedOut):this.loggedIn(!1)},e.prototype.setGreetingMessage=function(){var e=r.default.instance.MePersonManager.mePerson;this.displayName(e.displayName)},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(459),r=n(533),o=n(243);t.default={register:function(){var e="tabindex";ko.bindingHandlers.keyboardNavigation={init:function(t,n){var s,a=!1,c={persistSelection:!0,selectLastItem:n().selectLastItem,itemSelector:n().itemSelector||""},l=function(){return a=!0},u=function(){return a=!1};function d(){p().forEach(_)}function p(){var e,n=t.querySelectorAll(c.itemSelector);return e=n,Array.prototype.slice.call(e)}function h(e){var n;y(e.target)&&(n=p()).length&&(_(t),d(),a?a=!1:-1!==n.indexOf(s)?m(s):c.selectLastItem?m(n[n.length-1]):m(n[0]))}function f(e){var n=e.target;window.setTimeout(function(){var e=p();y(n)||-1!==e.indexOf(document.activeElement)||v(t)},1)}function g(e){var t,n=r.default.getKeyCode(e);if(function(e){var t=r.default.getKeyCode(e);return e.shiftKey&&t===o.default.F10}(e))!function(e){var t=document.createEvent("MouseEvents"),n=e.target.getBoundingClientRect();e.preventDefault(),e.stopPropagation(),t.initMouseEvent("contextmenu",!0,!1,window,0,0,0,n.right,n.top,!1,!1,!0,!1,2,null),e.target.dispatchEvent(t)}(e);else if(n!==o.default.ENTER&&n!==o.default.SPACE||document.activeElement!==s||s.click(),function(e){return[o.default.LEFT,o.default.UP,o.default.RIGHT,o.default.DOWN,o.default.HOME,o.default.END].indexOf(e)>-1}(n))return t=p(),d(),e.preventDefault(),e.stopPropagation(),n===o.default.LEFT||n===o.default.UP?i(-1):n===o.default.RIGHT||n===o.default.DOWN?i(1):n===o.default.HOME?m(t[0]):n===o.default.END&&m(t[t.length-1]),!1;function i(n){var i=t[t.indexOf(e.target)];do{if(!(i=t[t.indexOf(i)+n]))break;m(i)}while(document.activeElement!==i)}}function m(e){e.focus&&e.focus(),c.persistSelection&&(s=e)}function v(t){t.setAttribute(e,0)}function _(t){t.setAttribute(e,-1)}function y(e){return e===t}v(t),d(),t.addEventListener(i.default.events.browser.FOCUS,h,!0),t.addEventListener(i.default.events.browser.BLUR,f,!0),t.addEventListener(i.default.events.browser.KEYDOWN,g),t.addEventListener(i.default.events.browser.MOUSEDOWN,l),t.addEventListener(i.default.events.browser.MOUSEUP,u),ko.utils.domNodeDisposal.addDisposeCallback(t,function(){t.removeEventListener(i.default.events.browser.FOCUS,h,!0),t.removeEventListener(i.default.events.browser.BLUR,f,!0),t.removeEventListener(i.default.events.browser.KEYDOWN,g),t.removeEventListener(i.default.events.browser.MOUSEDOWN,l),t.removeEventListener(i.default.events.browser.MOUSEUP,u)})}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(243).default,r={96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"};function o(){}function s(e){return e.which||e.keyCode}function a(e){var t=s(e);return t>=i.NUMPAD_0&&t<=i.NUMPAD_9}o.prototype.emit=function(){},o.prototype.done=function(){},t.default={swallow:function(e){e.preventDefault()},getKeyCode:s,getNumpadKey:function(e){return!!a(e)&&r[s(e)]},isActivation:function(e){var t=s(e);return t===i.ENTER||t===i.SPACE},isAlphaNumericKey:function(e){var t=s(e);return t>=i.NUMBER_0&&t<=i.NUMBER_9||t>=i.A&&t<=i.Z},isNumPadKey:a,isDeactivation:function(e){return s(e)===i.ESCAPE}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),r=n(9),o=n(4),s=n(6),a=n(2),c=n(1),l=n(13),u=n(77),d=n(26),p=n(89),h=n(351),f=n(7),g=n(535),m=n(121),v=n(0),_=n(123),y=n(362),b=n(43),w=n(122),C=n(358),E=n(359),S=n(363),T=n(82),I=n(76),x=n(357),A={FILE:"filemessage ",IMAGE:"imagemessage ",SWIFT:"swiftContainer ",WELCOME:"welcome "},P={ME:"me ",OTHER:"other ",NEW:"new ",FIRST:"isFirst ",GROUP:"group ",LESS:"less "},k={USER:"UserMessage",SWIFT:"SwiftCard",SYSTEM:"SystemMessage",WELCOME:"Welcome",TRANSLATE:"Translate",IMAGE:"LwcImage",FILE:"LwcFile"},M={dateWithTime:!0},O=", ",L="tag-",R=function(){function e(e,t,n,R){var N=this;if(this.message=e,this.conversation=t,this.messageFromMe=!1,this.author=ko.observable(),this.showAuthor=ko.observable(!1),this.isGroup=!1,this.showStatus=ko.observable(!1),this.status=ko.observable(),this.isNew=ko.observable(!0),this.type=f.MessageType.UserMessage,this.showMessageInfo=ko.observable(!1),this.showTimestamp=ko.observable(!1),this.showEditedIcon=ko.observable(!1),this.isDeletedMessage=ko.observable(!1),this.showMessageActions=!1,this.hasReactions=ko.observable(!1),this.reactionsPaneEnabled=!1,this.reactionsPaneItems=[],this.isContentExpanded=ko.observable(),this.contentLimitValue=ko.observable(""),this._addReactionsToFragment=function(){if(!(N._mapReactionPaneItems.length<1)){N._reactionElement=document.createElement("div"),N._reactionElement.className="swc-scroll-wrapper";var e=document.createElement("div");e.className="swc-scroll-viewport";var t=document.createElement("div");t.className="reactionsPane";for(var n=document.createDocumentFragment(),o=function(e){var t=N.reactionsPaneItems[e],o=document.createElement("div");o.className="reaction",t.selected&&o.classList.add("selected");var s={callback:function(){}},a={large:!0,largeEmoticonClass:"large",emoticonId:t.id,title:t.title,isAnimated:t.selected,setUpdateCallback:function(e){s.callback=e}},c=r.createElement(T.SwcEmoticon,a),l=document.createDocumentFragment();i.render(c,l),o.addEventListener("mouseover",function(){s.callback({isAnimated:!0})}),o.addEventListener("mouseout",function(){s.callback({isAnimated:!1})}),o.appendChild(l);var u=document.createElement("span");u.className="selectedPoint",o.appendChild(u),o.addEventListener("click",function(e){t.selected?(N._removeReactionOnMessage(t,e),o.classList.remove("selected")):(N._setReactionOnMessage(t,e),o.classList.add("selected")),s.callback({isAnimated:!t.selected})}),n.appendChild(o)},s=0;s<N.reactionsPaneItems.length;s++)o(s);t.appendChild(n),e.appendChild(t),N._reactionElement.appendChild(e),N.reactionScrollBar=new p.default(N._reactionElement,N._reactionElement.firstChild)}},this._setAttributeOnElement=function(e,t){e&&t.forEach(function(t){var n=t.key,i=t.val;e.setAttribute(n,i)})},this._mapReactionPaneItems=function(e){for(var t=[],n=0;n<N.ecsReactionsPack.length;n++){var i=e[N.ecsReactionsPack[n]];i&&t.push({id:i.id,title:i.description||i.id,selected:!1})}return t},this._setReactionSelectedState=function(e){for(var t=function(t){for(var n=e[t],i=!1,r=0;r<n.users.length;r++)if(n.users[r].person.id===N._mePersonId){i=!0;break}i&&N.reactionsPaneItems.forEach(function(e){n.key===e.id&&(e.selected=!0)})},n=0;n<e.length;n++)t(n)},this._isUserMessage=function(){return"UserMessage"===N.message.type},this.triggerEditMessageAction=function(){v.swcWindow.swc.API.triggerEvent(o.ApiEvents.RequestEditingMessage,{convId:N.conversation.id,message:N.message})},this.openDeleteMsgConfirmationDialog=function(){C.default.add(N._conversationElement,N.removeMessageConfirmation.getView())},this._getMenuActionItems=function(){var e=N.message.type===k.USER,t=[];return N.messageFromMe&&(e&&t.push({title:N.editMessageTitle,group:1,action:N.triggerEditMessageAction}),t.push({title:N.deleteMessageHeader,group:1,action:N.openDeleteMsgConfirmationDialog})),t},this._setReactionOnMessage=function(e,t){e.id&&(t.preventDefault(),N.conversation.setMessageProperty(N.conversation.id,N.message.id,a.default.MESSAGE_PROPERTIES.PER_USER.EMOTIONS,{key:e.id}).then(function(){e.selected=!0,c.default.instance.TelemetryService.sendEvent(new g.default(e.id))}))},this._removeReactionOnMessage=function(e,t){e.id&&N.conversation.removeMessageProperty(N.conversation.id,N.message.id,a.default.MESSAGE_PROPERTIES.PER_USER.EMOTIONS,{key:e.id}).then(function(){e.selected=!1})},this.openReactionsPane=function(e,t){N._reactionElement&&N.reactionsPaneItems.length&&(t.preventDefault(),t.stopPropagation(),w.default.add(t,N.messageListElement,N._reactionElement,w.BUBBLE_TYPE.REACTION_PANE,w.BubblePosition.onContextMenu),N.reactionScrollBar&&N.reactionScrollBar.recount(),c.default.instance.TelemetryService.sendEvent(new m.UserActionEvent(m.UserActionType.ReactionPicker)))},this.openMessageActions=function(e,t){if(t.target){var n=N._msgActionsNode;if(!N._msgActionsMenuBound){var i=N._getMenuActionItems();if(!i.length)return;n.classList.add("menuList","msgActionsMenuList"),n.setAttribute("data-bind","component: {\n                name: 'menu-list',\n                params: { list: items }\n            }"),ko.applyBindings({items:i},n),N._msgActionsMenuBound=!0}t.preventDefault(),t.stopPropagation(),w.default.add(t,N.messageListElement,n,w.BUBBLE_TYPE.MENU_LIST,w.BubblePosition.onContextMenu),N._conversationElement&&N._conversationElement.addEventListener("click",N._removeBubbleListener)}},this._removeBubbleListener=function(){w.default.remove(),N._conversationElement&&N._conversationElement.removeEventListener("click",N._removeBubbleListener)},this._setAvatarVM=function(e,t){var n=e?e.nextElementSibling:null;if(N._avatarContainer=n?n.querySelector(".headerAvatar"):null,N._avatarContainer){var o=document.createDocumentFragment(),s={person:t},a=r.createElement(I.PersonAvatar,s);i.render(a,o),N._avatarContainer.appendChild(o)}},this._showAuthor=function(){return!N.messageFromMe&&"Welcome"!==N.message.type},this.mapMessageTypeClassName=function(){switch(N.type){case k.FILE:return A.FILE;case k.WELCOME:return A.WELCOME;case k.IMAGE:return A.IMAGE;case k.SWIFT:return A.SWIFT;default:return""}},this.setClassNames=function(){var e=N.isContentExpanded(),t="";return t+=N.messageFromMe?P.ME:P.OTHER,t+=N.isNew()?P.NEW:"",t+=N.showAuthor()?P.FIRST:"",t+=N.isGroup?P.GROUP:"",t+=N.messageTypeClassName,t+=e?"":P.LESS,t+=N.message&&N.message.senderId&&0===N.message.senderId.indexOf("28:")?"bot":"",(t+=N.tag?L+N.tag:"").trim()},this._startChatFromContactTeams=function(e,t){var n=[{role:"Admin",id:c.default.instance.MePersonManager.mePerson.mri},{role:"Admin",id:e}],i=function(e){var n=e.headers.get("location").match(/threads\/(19:.*)$/)[1];_.default.startChat(n,N.conversation.definition,!1,t)},r=function(e){};h.findRecentConversationIdForMembers(n).then(function(e){_.default.startChat(e,N.conversation.definition,!1,t)}).catch(function(e){c.default.instance.WebApi.createThread(n).then(i,r)})},this.navigateToChat=function(e){s.default.get.backend===l.MessagingBackend.TEAMS?N._startChatFromContactTeams(e,u.default.AVATAR):_.default.startChat(e,N.conversation.definition,!1,u.default.AVATAR)},this.dispose=function(){N.message.senderId&&N.updateDisplayName&&N._isSkypeRelated&&c.default.instance.Persons.getPerson(N.message.senderId).unsubscribe("displayName",N.updateDisplayName);N.message.unsubscribe("isFirst",N.updateMessageInfo),N.message.unsubscribe("status",N.subscribeToDeliveryStatus)},this.updateDisplayName=function(){var e=c.default.instance.Persons.getPerson(N.message.senderId);e.displayName&&N.author(e.displayName+O)},this.updateMessageInfo=function(e){N.showAuthor(N._showAuthor()&&e),N.showTimestamp(e),N.showMessageInfo((N.showAuthor()||N.showTimestamp())&&N.conversation.isSkypeBackend()&&"SystemMessage"!==N.message.type&&"UnreadSplitter"!==N.message.type&&"SkypeLogo"!==N.message.type&&"Welcome"!==N.message.type)},this.ecsReactionsPack=a.default.ECS.reactionPacks||[],this.reactionsPaneEnabled=!x.default.isDomainIn("disableSendingReactions")&&"SystemMessage"!==e.type&&"UnreadSplitter"!==e.type&&!!this.ecsReactionsPack.length,this.isContentExpanded(!1),this._element=R,this.messageListElement=R.parentNode,this._conversationElement=n,this._mePersonId=c.default.instance.MePersonManager.mePerson.id,this.openMenuText=c.default.instance.i18n.fetch("open_menu_dialog_text"),this.editMessageTitle=c.default.instance.i18n.fetch("confirm_dialog_edit_msg_header"),this.editedMessageText=c.default.instance.i18n.fetch("icon_text_message_was_edited"),this.deleteMessageHeader=c.default.instance.i18n.fetch("confirm_dialog_delete_msg_header"),this.deleteMessageText=c.default.instance.i18n.fetch("confirm_dialog_delete_msg_text"),t.definition.MessageContentLimit=t.definition.MessageContentLimit?"130px":"",this.reactionsPaneItems=this._mapReactionPaneItems(c.default.instance.PesManager.emoticonMap),this._setReactionSelectedState(e.emotions),this._addReactionsToFragment(),this.type=e.type,this.senderId=e.senderId,this._isSkypeRelated=t.sdkMode!==d.SDKMode.DIRECT_LINE_TOKEN,this.timestamp=y.default.toStringMesssageDate(this.message.timestamp.getTime(),M),this.messageTypeClassName=this.mapMessageTypeClassName(),this._msgActionsNode=document.createElement("div"),"SystemMessage"!==e.type&&"UnreadSplitter"!==e.type){if(e.subscribe("isFirst",this.updateMessageInfo),this.message.senderId){var D=c.default.instance.Persons.getPerson(this.message.senderId,!0);D.subscribe("displayName",function(e){e&&N.author(e+O)});var Q=this.message.senderId;this._isSkypeRelated&&(Q=D.displayName,this._setAvatarVM(R,D)),Q&&this.author(Q+O);var U=c.default.instance.MePersonManager.isMe(b.default.normalizePersonId(e.senderId));this.messageFromMe=!!e.senderId&&U}else this.messageFromMe=e.direction===f.Direction.Outgoing;this.showAuthor(this._showAuthor())}this.showMessageActions=this.messageFromMe&&!t.definition.HideMessageActionsMenu,this.isGroup=t.isGroup(),this.subscribeToDeliveryStatus(e),e.isEdited&&e.type!==f.MessageType.SystemMessage&&this.showEditedIcon(this._isUserMessage()),e.subscribe("isEdited",function(t){e.type!==f.MessageType.SystemMessage&&N.showEditedIcon(t)}),this.isDeletedMessage(e.isDeleted),e.subscribe("isDeleted",function(e){N.isDeletedMessage(e)}),this.classNames=ko.pureComputed(this.setClassNames),this.removeMessageConfirmation=new E.default({title:this.deleteMessageHeader,text:this.deleteMessageText,confirm:{title:c.default.instance.i18n.fetch("btn_confirm_removal"),action:function(){c.default.instance.TelemetryService.sendEvent(new m.UserActionEvent(m.UserActionType.DeleteMessage)),N.conversation.deleteMessage(N.message),C.default.remove()}},cancel:{title:c.default.instance.i18n.fetch("sign_in_cancel"),action:C.default.remove}},S.TextDialog),this.hasReactions(!!e.emotions&&!!e.emotions.length),e.emotions&&e.emotions.subscribe(function(e,t){N.hasReactions(!!e.length)})}return Object.defineProperty(e.prototype,"properties",{get:function(){var e,t=this.message.payload,n=t?t.properties:null;if(n)try{e=JSON.parse(n)}catch(e){}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tag",{get:function(){return this.properties?this.properties.tag:null},enumerable:!0,configurable:!0}),e.prototype.seeMore=function(){this.isContentExpanded(!0),this.contentLimitValue("inherit"),v.swc.API.triggerEvent(o.ApiEvents.onMessageExpand)},e.prototype.seeLess=function(){this.isContentExpanded(!1),this.contentLimitValue(this.conversation.definition.MessageContentLimit),v.swc.API.triggerEvent(o.ApiEvents.onMessageCollapse)},e.prototype.subscribeToDeliveryStatus=function(e){function t(){switch(e.status){case 0:this.status(c.default.instance.i18n.fetch("sending")),this.showStatus(!0);break;case 1:this.status(c.default.instance.i18n.fetch("sent")),this.showStatus(!1);break;case 2:this.status(c.default.instance.i18n.fetch("failed")),this.showStatus(!0);break;default:this.status(""),this.showStatus(!1)}}this.conversation.isDirectLineBackend()||"SystemMessage"===this.message.type||"UnreadSplitter"===this.message.type||(e.subscribe("status",t.bind(this)),t.bind(this)())},e}();t.default=R},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=function(e){function t(t){var n=e.call(this,"kpi_reaction_set")||this;return n.iconName=t,n}return r(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(o.TelemetryPropertyValue.Create("name",this.iconName)),e},t}(n(8).TelemetryEvent);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var n=this;this._params=e,this._element=t,this.group1=[],this.group2=[],this._createListItem=function(e){var t=document.createElement("li");return t.textContent=e.title,t.setAttribute("aria-label",e.title),t.setAttribute("title",e.title),t.addEventListener("click",e.action),t},this.element=t,this._add(e.list);var i=this.element.querySelector("ul.first"),r=this.element.querySelector(".line"),o=this.element.querySelector("ul.second");this.group1.forEach(function(e){i.appendChild(n._createListItem(e))}),this.group2.length>0&&(r.style.display="block",o.style.display="block"),this.group2.forEach(function(e){o.appendChild(n._createListItem(e))})}return e.prototype._add=function(e){for(var t=0;t<e.length;t++){var n=e[t];switch(n.group){case 1:this.group1.push(n);break;case 2:this.group2.push(n)}}},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(21),o=n(457),s=n(0),a=function(){return function(e,t,n){var a=this;this.file=e,this.conversation=t,this.message=n,this.downloaded=ko.observable(!1),this.fileUrl="",this.type=function(){var e;switch(a.file.fileType){case"jpeg":case"jpg":case"gif":case"png":case"bmp":case"tiff":case"jfif":e="image";break;default:e="file"}return e},this.previewUrl=function(){var e="";return"file"===a.type()?e:e=a.file.filePreview&&a.file.filePreview.previewUrl?a.file.filePreview.previewUrl:a.fileUrl},this.computeCssClasses=function(){var e={};return e[a.file.fileType]=!0,e},this.downloadFile=function(){r.getServices().sharepointService.downloadFile(a.file).then(function(e){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(e,a.file.fileName);else{var t=window.URL||s.swcWindow.webkitURL,n=t.createObjectURL(e),r=document.createElement("a");document.body.appendChild(r),r.href=n,r.setAttribute("download",a.file.fileName),r.click(),t.revokeObjectURL(n)}a.downloaded(!0);var c=new o.default(a.message,a.conversation,a.file.fileName);c.action=o.FileActions.downloadClick,i.default.instance.TelemetryService.sendEvent(c)})},this.downloadImage=function(){a.fileUrl&&(window.open(a.fileUrl,"_blank").opener=null)},this.iconClasses=ko.computed(this.computeCssClasses),this.file.fileInfo&&(this.fileUrl=this.file.fileInfo.fileUrl)}}();t.default=a},function(e,t){e.exports='<div class="conversationsList" data-bind="visible: count()">\r\n    <ul data-bind="foreach: { data: conversationsList, as: \'item\', afterAdd: appendAvatarVM },\r\n        visible: expanded, click: toggleExpand">\r\n        <li data-bind="click: show">\r\n            <p class="title" data-bind="text: item.title()"></p>\r\n        </li>\r\n    </ul>\r\n    <span class="expand" data-bind="click: toggleExpand, css: {expanded: expanded()}">\r\n        <span >+<span class="title" data-bind="text: count()"></span></span>\r\n    </span>\r\n</div>\r\n'},function(e,t){e.exports='\x3c!-- ko if: !isDeletedMessage() --\x3e\r\n    <div class="message" role="presentation" data-bind="css: classNames,\r\n    attr: {\'data-messageType\': type}">\r\n        <div class="headerAvatar" aria-label="avatar" tabindex="0"\r\n        data-bind="click: navigateToChat.bind(null, senderId), visible: showAuthor()"></div>\r\n        <div class="authorAndContent">\r\n            <div class="messageInfo" data-bind="visible: showMessageInfo">\r\n                <span class="author" data-bind="text: author, visible: showAuthor()"></span>\r\n                <span class="timestamp"\r\n                    data-bind="text: timestamp, visible: !showStatus() && showTimestamp()"></span>\r\n            </div>\r\n            <div class="bubble" data-bind="style:{ \'max-height\': contentLimitValue }">\r\n                <div class="messageType" data-bind="component: {\r\n                    name: type.toLowerCase(),\r\n                    params: {\r\n                        message: $data.message,\r\n                        conversation: $data.conversation,\r\n                        meUserName: $parent.meUserName,\r\n                        suggestedActions: $parent.suggestedAction,\r\n                        messageListElement: messageListElement\r\n                    }\r\n                }"></div>\r\n            </div>\r\n            <div class="buttons">\r\n                <button class="button seemore" data-bind="click: seeMore">\r\n                    <span class="normal">See All </span>\r\n                    <icon-chevron class="chevron down"></icon-chevron>\r\n                </button>\r\n                <button class="button seeless" data-bind="click: seeLess">\r\n                    <span class="normal">See Less </span>\r\n                    <icon-chevron class="chevron up"></icon-chevron>\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <div class="sendingStatus" data-bind="text: status(), visible: showStatus(),\r\n            css: { sending: showStatus() }"></div>\r\n    </div>\r\n\x3c!-- /ko --\x3e\r\n'},function(e,t){e.exports="<div class=\"swift\">\r\n    \x3c!-- ko if: !swift.isSupported() --\x3e\r\n        \x3c!-- ko template: { name: 'swiftUnsupported', data: swift } --\x3e\r\n        \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: swift.isSupported() --\x3e\r\n        \x3c!-- ko if: swift.isCarousel() --\x3e\r\n            \x3c!-- ko template: { name: 'swiftCarouselCard', data: swift } --\x3e\r\n            \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: !swift.isCarousel() && !swift.isMultilineCard()--\x3e\r\n            \x3c!-- ko template: { name: 'swiftSingleCard', data: swift } --\x3e\r\n            \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: swift.isMultilineCard() --\x3e\r\n        \x3c!-- ko template: { name: 'swiftMultilineCard', data: swift } --\x3e\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n"},function(e,t){e.exports="\x3c!-- DO NOT REMOVE - Adaptive Card template holder --\x3e\r\n"},function(e,t){e.exports='<div class="lwx-message">\r\n    <div class="PictureWrapper">\r\n        <div class="PictureSharing" data-bind="event: {contextmenu: $parent.openMessageActions}">\r\n            <a class="thumbnailHolder" data-bind="click: downloadImage" target="_blank" tabindex="-1">\r\n                \x3c!-- ko if: thumbnailUrl --\x3e\r\n                <span class="thumbnail" data-bind="style: {backgroundImage: \'url(\\\'\' + thumbnailUrl() + \'\\\')\'}"></span>\r\n                \x3c!-- /ko --\x3e\r\n\r\n                \x3c!-- ko ifnot: thumbnailUrl --\x3e\r\n                <span class="thumbnail" style="display:none"></span>\r\n                \x3c!-- /ko --\x3e\r\n            </a>\r\n        </div>\r\n        <reactions-bar class="reactionsBar" params="message: message, messageListElement: messageList"></reactions-bar>\r\n    </div>\r\n    \x3c!-- ko if: $parent.showEditedIcon --\x3e\r\n    <button class="edit messageBtn" data-bind="attr:{\'aria-label\': $parent.editedMessageText, title: $parent.editedMessageText}">\r\n        <icon-pencil></icon-pencil>\r\n    </button>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: $parent.showMessageActions --\x3e\r\n    <div class="actionsContainer">\r\n        <button class="messageBtn deleteAction" data-bind="click: $parent.openDeleteMsgConfirmationDialog,\r\n        attr: {title: $parent.deleteMessageHeader}">\r\n            <icon-delete-message class="icon"></icon-delete-message>\r\n        </button>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>'},function(e,t){e.exports='<div class="lwx-message" data-bind="event: {contextmenu: $parent.openMessageActions}">\r\n    <div class="FileWrapper">\r\n        <div class="previewWithMeta">\r\n            <div class="file" data-bind="css: iconClasses">\r\n                <button aria-label="download file" class="download" data-bind="click: downloadFile">\r\n                    <icon-download />\r\n                </button>\r\n            </div>\r\n            <div class="meta">\r\n                <div class="name" data-bind="text: originalName, attr: {title: originalName}"></div>\r\n                <div class="size" data-bind="text: displaySize, attr: {title: displaySize}"></div>\r\n            </div>\r\n        </div>\r\n\r\n        <reactions-bar class="reactionsBar" params="message: message, messageListElement: messageList"></reactions-bar>\r\n    </div>\r\n\r\n    \x3c!-- ko if: $parent.showEditedIcon --\x3e\r\n    <button class="edit messageBtn" data-bind="attr:{\'aria-label\': $parent.editedMessageText, title: $parent.editedMessageText}">\r\n        <icon-pencil></icon-pencil>\r\n    </button>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: $parent.showMessageActions --\x3e\r\n    <div class="actionsContainer">\r\n        <button class="messageBtn deleteAction" data-bind="click: $parent.openDeleteMsgConfirmationDialog,\r\n        attr: {title: $parent.deleteMessageHeader}">\r\n            <icon-delete-message class="icon"></icon-delete-message>\r\n        </button>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>'},function(e,t){e.exports='\r\n<div class="SharepointFileWrapper">\r\n    \x3c!-- ko if: previewUrl() --\x3e\r\n    <div class="image">\r\n        <div class="wrapper">\r\n            <a class="thumbnailHolder" data-bind="click: downloadImage" target="_blank" tabindex="-1">\r\n                <span class="thumbnail" data-bind="style: {backgroundImage: \'url(\\\'\' + previewUrl() + \'\\\')\'}"></span>\r\n            </a>\r\n        </div>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: !previewUrl() --\x3e\r\n    <div class="previewWithMeta">\r\n        <div class="file" data-bind="css: iconClasses">\r\n            <button aria-label="download file" class="download" data-bind="click: downloadFile">\r\n                <icon-download/>\r\n            </button>\r\n        </div>\r\n        <div class="meta">\r\n            <div class="name" data-bind="text: file.fileName, attr: {title: file.fileName}"></div>\r\n        </div>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'},function(e,t){e.exports='<div class="action">\r\n    \x3c!-- ko ifnot: loggedIn --\x3e\r\n        <div class="callToAction">\r\n            \x3c!-- ko if: isAgent --\x3e\r\n            <button class="sayhi" tabindex="0" data-bind="click: sendHi,\r\n            text: say_hi,\r\n            attr: {\'aria-label\': say_hi_to_bot_aria}"></button>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!-- ko ifnot: isGuestOnlyMode --\x3e\r\n            <span data-bind="text: or_text()"></span>\r\n            <span class="signin">\r\n            <button tabindex="0" data-bind="click: signin,\r\n                text: sign_in_text,\r\n                attr: {\'aria-label\': sign_in_to_save_chat_aria}"></button>\r\n                <span data-bind="text: to_save_your_chat"></span>\r\n            </span>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: loggedIn --\x3e\r\n        <div>\r\n            <span data-bind="text: welcome_back_text"></span><button data-bind="attr:{\'aria-label\':displayName}, text:displayName, click: nameClick, css: {nameClicked: nameClicked, disableLogout: disableLogout}" tabindex="0"></button>!\r\n        </div>\r\n        \x3c!-- ko if: nameClicked --\x3e\r\n        <div>\r\n        <button class="signin" tabindex="0" data-bind="click: signout,\r\n        text: click_here_text,\r\n        attr: {\'aria-label\': click_here_to_switch_accounts_aria}"></button>\r\n        <span data-bind="text: to_switch_accounts"></span>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'},function(e,t){e.exports='<div class="skypeLogo">\r\n    <skype-logo></skype-logo>\r\n</div>\r\n'},function(e,t){e.exports='<div class="unread-splitter">\r\n    <svg>\r\n        <line x1="0" y1="50%" x2="100%" y2="50%" />\r\n    </svg>\r\n    <div class="unread-splitter-text" data-bind="html: message.content"></div>\r\n    <svg>\r\n        <line x1="0" y1="50%" x2="100%" y2="50%" />\r\n    </svg>\r\n</div>\r\n'},function(e,t){e.exports='<div class="lwx-message" role="listitem">\r\n    <div class="content" data-bind="html: content,\r\n        style:{ backgroundColor:messageColor, background: messageColor },\r\n        css: { sticker: isExtraLargeEmoticon, bot: isAgent }"></div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="message welcome">\r\n\t<skype-logo></skype-logo>\r\n<div data-bind="html: they_are_speaking()">\r\n  </div>\r\n<div data-bind="html: you_are_speaking()">\r\n  </div>\r\n  <div>\r\n    <a data-bind="click:activateTranslation, text: callToAction"></a>\r\n  </div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="audioPlayer">\r\n    \x3c!-- ko if: showCoverImage() --\x3e\r\n    <div class="coverHolder">\r\n        <img class="thumbnail" data-bind="attr: { src: coverImage.url, alt: coverImage.alt, width: coverImage.uiSize().width, height: coverImage.uiSize().height },\r\n                style: { left: coverImage.leftAlignment() + \'px\', bottom: coverImage.bottomAlignment() + \'px\' }" />\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: showLoadingInfo --\x3e\r\n    <div class="loader" data-bind="visible: isLoading()"></div>\r\n    <div class="error" data-bind="visible: failed()">\r\n        <icon-error />\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <div class="controlsOverlay" data-bind="click: togglePlay"></div>\r\n\r\n    <audio class="player" data-bind="attr: { src: media, loop: autoloop}, click: togglePlay,\r\n            event: {canplay: onReady, error: onError, loadedmetadata: onMetadataLoaded, timeupdate: onTimeUpdated, ended: onAudioEnded}"></audio>\r\n\r\n    <div class="playerControls" data-bind="visible: canPlay">\r\n\r\n        <button data-bind="click: togglePlay, attr: {title: playButtonText}"\r\n                class="button" type="button">\r\n            \x3c!-- ko if: isPlaying() --\x3e\r\n            <icon-pause></icon-pause>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: !isPlaying() --\x3e\r\n            <icon-play></icon-play>\r\n            \x3c!-- /ko --\x3e\r\n        </button>\r\n\r\n        <div class="timeline" data-bind="click: onTimelineClick">\r\n            <div class="timers">\r\n                <div class="currentTime" data-bind="text: currentTime"></div>\r\n                <div class="totalTime" data-bind="text: totalTime"></div>\r\n            </div>\r\n            <div class="totalProgress"></div>\r\n\r\n            <div class="progress" data-bind="attr: {style: currentProgress}">\r\n                <div class="handle" data-bind="event: {mousedown: onHandleStartDrag}"></div>\r\n            </div>\r\n\r\n        </div>\r\n\r\n    </div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="videoPlayer">\r\n\r\n    <div class="fullsreenInfo" data-bind="visible: isInFullscreen">\r\n        \x3c!-- ko if: subtitle --\x3e\r\n        <h2 data-bind="text: subtitle, attr: { title: subtitle }"></h2>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: title --\x3e\r\n        <h1 data-bind="text: title, attr: { title: title }"></h1>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n\r\n    \x3c!-- ko if: showLoadingInfo --\x3e\r\n    <div class="loader" data-bind="visible: isLoading()"></div>\r\n    <div class="error" data-bind="visible: failed()">\r\n        <icon-error />\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <div class="controlsOverlay" data-bind="click: togglePlay"></div>\r\n\r\n    <video class="player" data-bind="attr: { src: media, loop: autoloop, autoplay: autoplay}, click: togglePlay,\r\n            event: {onprogress: onProgress, canplay: onReady, error: onError, loadedmetadata: onMetadataLoaded, timeupdate: onTimeUpdated, ended: onVideoEnded}">\r\n    </video>\r\n\r\n    <div class="playerControls" data-bind="visible: canPlay">\r\n\r\n        <button data-bind="click: togglePlay, attr: {title: playButtonText}"\r\n                class="button" type="button">\r\n            \x3c!-- ko if: isPlaying() --\x3e\r\n            <icon-pause></icon-pause>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: !isPlaying() --\x3e\r\n            <icon-play></icon-play>\r\n            \x3c!-- /ko --\x3e\r\n        </button>\r\n\r\n        \x3c!-- ko if: displayCurrentTime --\x3e\r\n        <div class="currentTime" data-bind="text: currentTime"></div>\r\n        \x3c!-- /ko  --\x3e\r\n\r\n        <div class="timeline" data-bind="click: onTimelineClick">\r\n            <div class="totalProgress"></div>\r\n            <div class="progress" data-bind="attr: {style: currentProgress}">\r\n                <div class="handle" data-bind="event: {mousedown: onHandleStartDrag}"></div>\r\n            </div>\r\n        </div>\r\n\r\n        \x3c!-- ko if: displayTotalTime --\x3e\r\n        <div class="totalTime" data-bind="text: totalTime"></div>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: displayMuteButton --\x3e\r\n        <button data-bind="click: toggleMute, attr: {title: toggleMuteText()}"\r\n                class="button" type="button">\r\n            \x3c!-- ko if: isMuted() --\x3e\r\n            <icon-unmute></icon-unmute>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: !isMuted() --\x3e\r\n            <icon-mute></icon-mute>\r\n            \x3c!-- /ko --\x3e\r\n        </button>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: isFullscreenSupported --\x3e\r\n        <button data-bind="click: toggleFullscreen, attr: {title: fullscreenButtonText}"\r\n                class="button toggleFullscreen" type="button">\r\n            \x3c!-- ko if: isInFullscreen() --\x3e\r\n            <icon-exit-fullscreen></icon-exit-fullscreen>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: !isInFullscreen() --\x3e\r\n            <icon-enter-fullscreen></icon-enter-fullscreen>\r\n            \x3c!-- /ko --\x3e\r\n        </button>\r\n        \x3c!-- /ko --\x3e\r\n\r\n    </div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="gifPlayer">\r\n    \x3c!-- ko if: showCoverImage() --\x3e\r\n    <div class="coverHolder">\r\n        <img class="thumbnail" data-bind="attr: { src: coverImage.url(), alt: coverImage.alt, width: coverImage.uiSize().width, height: coverImage.uiSize().height },\r\n                style: { left: coverImage.leftAlignment() + \'px\', bottom: coverImage.bottomAlignment() + \'px\' }" />\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: showLoadingInfo --\x3e\r\n    <div class="loader" data-bind="visible: isLoading()"></div>\r\n    <div class="error" data-bind="visible: failed()">\r\n        <icon-error />\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: media --\x3e\r\n    <img data-bind="visible: canPlay(),\r\n            attr: { src: media.url,\r\n                alt: media.alt,\r\n                width: media.uiSize().width,\r\n                height: media.uiSize().height\r\n            }, style: { left: media.leftAlignment(),\r\n                bottom: media.bottomAlignment()\r\n            },\r\n            event: { load: onReady, error: onError }" />\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'},function(e,t){e.exports='<ul class="first"></ul>\r\n<div class="line"></div>\r\n<ul class="second"></ul>\r\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(62),r=n(4),o=n(1),s=n(26),a=n(0),c=n(555),l=function(){function e(){this._resolveCallbacks=[],this._rejectCallbacks=[]}return e.prototype.add=function(e,t){this._resolveCallbacks.push(e),this._rejectCallbacks.push(t)},e.prototype.resolve=function(e){this._resolveCallbacks.forEach(function(t){return t(e)})},e.prototype.reject=function(){this._rejectCallbacks.forEach(function(e){return e()})},e}(),u=function(){function e(e){var t=this;this._conversations={},this._asyncConversationRequests={},this._stageCapacity=1,this._minWidth=1,this._activeCount=0,this._maxStageCapacity=4,this._onVisibilityChange=function(e){var n=t.get(e.key);if(n){var i=e.isVisible&&n.onStage;!n.alwaysOnStage&&n.stashed&&t._pop(e.key),e.isVisible?i||t._moveToStage(n):t._removeFromStage(e.key),i||t._recountStage()}},this._onResize=function(){t._recountStage()},this._removeFromStage=function(e,n){var i,r;e?r=e:t.forEach(function(e,t){!e.alwaysOnStage&&e.onStage&&(i?e.displayedAt<=i&&(i=e.displayedAt,r=t):(i=e.displayedAt,r=t))});var o=t.get(r);return o.onStage=!1,t._activeCount--,o.model.isActive=!1,o},this._pop=function(e){if(!t._conversationsList)return null;var n,i=e;if(i||t.forEach(function(e,t){e.stashed&&(n?e.displayedAt>=n&&(n=e.displayedAt,i=t):(n=e.displayedAt,i=t))}),i){var r=t.get(i);return r.stashed=!1,r.container.style.display="flex",t._conversationsList.remove(r.vm),r}return null},this._stash=function(e){if(!t._conversationsList){t._conversationsList=new c.default;var n=document.createElement("div");n.innerHTML="\x3c!-- ko component: {name: 'conversations-list', params: {conversations: conversations}} --\x3e\x3c!-- /ko --\x3e";var i=t._container||document.body;ko.applyBindings({conversations:t._conversationsList},n),i.insertBefore(n.firstElementChild,i.childNodes[0])}e.stashed=!0,e.container.style.display="none",t._conversationsList.add(e.vm)},this._toggleCollapse=function(e){var n=t.get(e),i=n&&n.container;if(i){var r=i.classList;r.contains("collapsed")?r.remove("collapsed"):r.add("collapsed")}},this._container=e.container,this._minWidth=e.minWidth,a.swc.API.registerEvent(r.ApiEvents.OnVisibilityChange,this._onVisibilityChange),this._addListeners()}return Object.defineProperty(e.prototype,"baseParent",{get:function(){return this._container},set:function(e){this._container=e,this._recountStage()},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e){for(var t in this._conversations)if(this._conversations.hasOwnProperty(t)){var n=this._conversations[t];e.call(n,n,t)}},e.prototype.add=function(e,t){var n=this;if(!this._conversations[e]){this._conversations[e]=t;var i=this._asyncConversationRequests[e];i&&(i.resolve(t),delete this._asyncConversationRequests[e])}var r=t.vm;r&&r.isCollapsed.subscribe(function(){return n._toggleCollapse(e)})},e.prototype.get=function(e){return this._conversations[e]},e.prototype.getAsync=function(e){var t=this;return new Promise(function(n,i){var r=t.get(e);r?n(r):(t._asyncConversationRequests[e]||(t._asyncConversationRequests[e]=new l),t._asyncConversationRequests[e].add(n,i),setTimeout(function(){var n=t._asyncConversationRequests[e];n&&(delete t._asyncConversationRequests[e],n.reject())},6e4))})},e.prototype.setContainer=function(e,t){var n=this.get(e);n&&(n.container=t)},e.prototype.disposeSkype=function(){var e=this;this.forEach(function(t,n){var i=t.model;i.sdkMode!==s.SDKMode.DIRECT_LINE_TOKEN&&(t.stashed?e._pop(n):e._removeFromStage(n),i&&i.dispose(),delete e._conversations[n])})},e.prototype.dispose=function(){var e=this;this.forEach(function(t,n){var i=t.model;i&&i.dispose(),delete e._conversations[n]})},e.prototype._addListeners=function(){this._windowResizeHandler=i(this._onResize,200),window.addEventListener("resize",this._windowResizeHandler),o.default.instance.NotificationsManager.setOpenedConversations(this._conversations)},e.prototype._moveToStage=function(e){e&&(this._currentConversation=e,e.onStage||(e.onStage=!0,this._activeCount++,e.model.isActive=!0),e.displayedAt=Date.now(),this._container&&(e.container.style.display="",this._container.contains(e.container)||this._container.appendChild(e.container),window.swc.API.triggerEvent("viewRestored",e.model.id)))},e.prototype._getOuterWidth=function(e){var t=e.offsetWidth,n=window.getComputedStyle(e,null),i=parseInt(n.maxWidth,10)||0;return(t=t<i?i:t)+(parseInt(n.marginLeft,10)||0)+(parseInt(n.marginRight,10)||0)},e.prototype._recountStage=function(){if(this._conversations&&this._activeCount){if(this._container){var e=this._container.clientWidth;this._stageCapacity=e/(this._minWidth||this._getOuterWidth(this._currentConversation.container))}var t=this._maxStageCapacity?Math.min(this._stageCapacity,this._maxStageCapacity):this._stageCapacity,n=Math.floor(t)-this._activeCount;if(n<0)for(var i=0;i>n;i--)this._stash(this._removeFromStage());else if(n>0)for(i=0;i<n;i++)this._moveToStage(this._pop())}},e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.conversationsList=ko.observableArray()}return e.prototype.add=function(e){return this.conversationsList.push(e)},e.prototype.remove=function(e){return this.conversationsList.remove(e)},e.prototype.shift=function(){return this.conversationsList.shift()},e.prototype.isStashed=function(e){return-1!==this.conversationsList.indexOf(e)},Object.defineProperty(e.prototype,"count",{get:function(){return this.conversationsList().length},enumerable:!0,configurable:!0}),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(557),r=n(558),o=n(559),s=function(){function e(){}return e.register=function(e){this.isInitialized||(ko.components.register("dl-messages-list",{viewModel:{createViewModel:function(e,t){return new o.default(e,t.element)}},template:n(464),synchronous:!0}),ko.components.register("dl-chat-input",{viewModel:{createViewModel:function(t,n){return new i.default(t,n.element,e)}},template:n(465),synchronous:!0}),ko.components.register("dl-conversation",{viewModel:{createViewModel:function(t){return new r.default(t,e)}},template:n(561),synchronous:!0}),this.isInitialized=!0)},e.unregister=function(){ko.components.unregister("dl-messages-list"),ko.components.unregister("dl-chat-input"),ko.components.unregister("dl-conversation"),this.isInitialized=!1},e.isInitialized=!1,e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(44),o=function(){function e(e,t,n){var r=this;this._params=e,this.element=t,this.chatConfig=n,this.isChatEnabled=ko.observable(!0),this.isUnderQuarantine=ko.observable(!1),this.isSendingEnabled=ko.observable(!1),this.expressionPickerEnabled=ko.observable(!1),this.pesConfigInitialized=ko.observable(!1),this.placeholder=i.default.instance.i18n.fetch("area_text_insertText"),this.openPickerText=i.default.instance.i18n.fetch("emoticon_picker_open"),this.sendMessageText=i.default.instance.i18n.fetch("send_message"),this.sendFileText=i.default.instance.i18n.fetch("send_file"),this.maxLength=2e3,this.onTextAreaEnabled=function(){return!1},this.onSendMessageEnabled=function(){return r.inputHasValue()&&r.isChatEnabled()},this._conversation=e.conversation,this._textarea=t.querySelector("textarea"),this.inputHasValue=ko.observable(!1),this._textarea.addEventListener("input",function(e){r.isSendingEnabled(!0),r.inputHasValue(!!r._textarea.value)}),this.isFileTransferEnabled=ko.computed(function(){return!1}),this.isSendMessageEnabled=ko.computed(this.onSendMessageEnabled),this.addValueToTextarea(this._conversation.definition.Prefill),this._conversation.subscribe("definition",function(e){r.addValueToTextarea(e.Prefill)}),this.canSendEmoticons=ko.pureComputed(this.canSendEmoticonsHandler),this.disableTextArea=ko.pureComputed(this.onTextAreaEnabled)}return e.prototype.addValueToTextarea=function(e){e&&(this._textarea.value=this._conversation.definition.Prefill,this.inputHasValue(!0))},e.prototype.sendMessage=function(e){var t=this._textarea.value.trim().replace(/&#96;/g,"`");t&&(this._conversation.sendMessage(t,e),this._textarea.value="",this.inputHasValue(!1))},e.prototype.canSendEmoticonsHandler=function(){return!1},e.prototype.hideExpressionPicker=function(){},e.prototype.sendFile=function(){},e.prototype.selectFile=function(){},e.prototype.onKeyDown=function(e,t){return 13!==(t.keyCode||t.which)||(!!t.shiftKey||(t.preventDefault(),this.sendMessage(r.ActionTrigger.KEYPRESS_ENTER),!1))},e.prototype.handleInput=function(e,t){},e.prototype.sendButtonHandler=function(){this.sendMessage(r.ActionTrigger.BUTTON_SEND_CLICK)},e.prototype.toggleExpressionPicker=function(){},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=n(6),o=n(2),s=n(1),a=n(48),c=n(25),l=n(0),u=function(){function e(e,t){var n=this;this._params=e,this.chatDataConfig=t,this.conversationId=ko.observable(),this.showComponent=ko.observable(!0),this.isCollapsed=ko.observable(!1),this.title=ko.observable(),this.avatarUrl=ko.observable(""),this.signedIn=ko.observable(!0),this.isAgent=ko.observable(!0),this.isChatEnabled=ko.observable(!0),this.showContactRequest=ko.observable(!1),this.privacyStatement=ko.observable(),this.termOfUse=ko.observable(),this.showTermsOfUse=ko.observable(!1),this.showPrivacyStatement=ko.observable(!1),this.userMessageSent=ko.observable(!0),this.isGuest=ko.observable(!0),this.showPrivacyAgreement=ko.observable(),this.termOfUseText=s.default.instance.i18n.fetch("header_termsOfUse"),this.ms_service_privacy_agreement=ko.observable(""),this.enable=this._params.enable,this.conversation=e.conversation;var r=encodeURIComponent(this.chatDataConfig.Locale||o.default.LOCALE);this.setContent(r),this.setTitle(),this.setAvatar(),l.swcWindow.swc.API.registerEvent(i.ApiEvents.ForceExpandChat,function(){return n.isCollapsed(!1)})}return e.prototype.close=function(){l.swcWindow.swc.API.triggerEvent(i.ApiEvents.onControlClose,{id:this.conversationId}),this.conversation.definition.EnableCustomOnCloseHandler||(r.default.get.frameless?l.swc.SDK.Chat.resolveMessage({origin:o.default.ORIGIN,action:a.default.HideChatWindow}):parent&&parent.postMessage({origin:o.default.ORIGIN,action:a.default.HideChatWindow},document.referrer||"*"))},e.prototype.toggleChatSize=function(){if(this.chatDataConfig.CanCollapse){this.isCollapsed(!this.isCollapsed());var e=this.isCollapsed()?a.default.CollapseChatWindow:a.default.ExpandChatWindow;r.default.get.frameless?l.swc.SDK.Chat.resolveMessage({origin:o.default.ORIGIN,action:e}):parent&&parent.postMessage({origin:o.default.ORIGIN,action:e},document.referrer||"*")}},e.prototype.setTitle=function(){var e=this;this.chatDataConfig.Title?this.title(this.chatDataConfig.Title):this.conversation.subscribe("topic",function(t){e.title(e.conversation.topic)})},e.prototype.setAvatar=function(){var e=this.chatDataConfig.Avatar?this.chatDataConfig.Avatar:this.conversation.avatar;this.avatarUrl(e)},e.prototype.setContent=function(e){this.privacyStatementText=s.default.instance.i18n.fetch("header_privacyPolicy"),this.termOfUseText=s.default.instance.i18n.fetch("header_termsOfUse");var t=c.default.dompurify.sanitize(s.default.instance.i18n.fetch("ms_service_privacy_agreement",{0:'<a href="https://www.microsoft.com/'+e+'/servicesagreement/" target="_blank">',1:"</a>",2:'<a href="https://privacy.microsoft.com/'+e+'/privacystatement" target="_blank">',3:"</a>"}),{ALLOWED_TAGS:["a"],ALLOWED_ATTR:["target","href"]});this.ms_service_privacy_agreement=ko.observable(t)},e}();t.default=u},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(89),s=n(7),a=n(75),c=function(e){function t(t,n){var i=e.call(this,t.conversation,n)||this;return i._params=t,i._blockScroll=!0,i._initConversationMessagesList=function(){var e;i.conversation.messages.length>0&&((e=i.messagesList).push.apply(e,i.conversation.messages),setTimeout(i._scrollToBottom,0)),i.conversation.messages.subscribe(i._onNewMessages)},i.dispose=function(){i.conversation&&i.conversation.messages.unsubscribe(i._onNewMessages),i.messagesList().forEach(function(e){e.dispose()})},i._onNewMessages=function(e,t){var n;(n=i.messagesList).push.apply(n,t.newItems),i._processSuggestedActions(t.newItems[0]),i.scroll.recount(),i._scrollToBottom()},i._initConversationMessagesList(),i._addLogo(),i.scroll=new o.default(i._element,i.viewport),i}return r(t,e),t.prototype._addLogo=function(){var e=new a.default(!1);e.type=s.MessageType.SkypeLogo,this.messagesList.push(e)},t}(n(463).default);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scrollTo=function(e,n,i,r,o){var s="scrollLeft"===i?r.scrollLeft:r.scrollTop,a=(e-s)/n*10;setTimeout(function(){var c=s+a;"scrollLeft"===i?r.scrollLeft=c:r.scrollTop=c,n-=10,c===e||n<=0?o&&o():t.scrollTo(e,n,i,r,o)},10)}},function(e,t){e.exports='\x3c!-- ko if: showComponent && signedIn --\x3e\r\n    \x3c!-- ko if: chatDataConfig.ShowHeader --\x3e\r\n    <div class="swc-header">\r\n        \x3c!-- ko if: avatarUrl --\x3e\r\n        <div class="headerAvatar" aria-label="avatar" tabindex="0"  data-bind="css: {bot: isAgent}, style: {backgroundImage: \'url(\\\'\' + avatarUrl() + \'\\\')\'}">\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        <div class="topic" data-bind="click:toggleChatSize">\r\n            <div class="swc-title" tabindex="0" data-bind="attr:{\'aria-label\':title}, text: title"></div>\r\n            <div class="terms">\r\n                \x3c!-- ko if: showTermsOfUse --\x3e\r\n                <a class="termsOfUse" data-bind="attr:{href:termOfUse}, text: termOfUseText" target="_blank"></a>\r\n                \x3c!-- /ko --\x3e\r\n\r\n                \x3c!-- ko if: showPrivacyStatement --\x3e\r\n                <a class="privacy" data-bind="attr:{href:privacyStatement}, text: privacyStatementText" target="_blank"></a>\r\n                \x3c!-- /ko --\x3e\r\n            </div>\r\n        </div>\r\n        \x3c!-- ko if: chatDataConfig.CanCollapse--\x3e\r\n            <button aria-label="minimize window" data-bind="click:toggleChatSize, css: { collapsed: isCollapsed()}" class="collapse">\r\n                <icon-maximize class="svg-icon"></icon-maximize>\r\n                <icon-minimize class="svg-icon"></icon-minimize>\r\n                <span data-bind="css: { collapsed: isCollapsed()}"></span>\r\n            </button>\r\n        \x3c!--/ko  --\x3e\r\n\r\n        \x3c!-- ko if: chatDataConfig.CanClose --\x3e\r\n            <button aria-label="close window" data-bind="click:close" class="close">\r\n                <icon-cancel class="svg-icon"></icon-cancel>\r\n            </button>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n<dl-messages-list role="list" aria-live="polite" data-bind="keyboardNavigation: { itemSelector: \'.lwx-message, .actionItem, .container\', selectLastItem: true }, css: {\'no-header\': !chatDataConfig.ShowHeader, \'collapsed\': isCollapsed()}"  params="conversation: conversation, userMessageSent: userMessageSent, enable: enable"></dl-messages-list>\r\n    \x3c!-- ko if: isGuest() && !userMessageSent() --\x3e\r\n        <div class="msa-privacy">\r\n             <div data-bind="html: ms_service_privacy_agreement" class="text"></div>\r\n        </div>\r\n    \x3c!-- /ko --\x3e\r\n    <dl-chat-input params="conversation: conversation, enable: enable" data-bind="css: {collapsed: isCollapsed()}"></dl-chat-input>\r\n\x3c!-- /ko --\x3e\r\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),r=n(13),o=n(563),s=n(572),a=n(578),c=n(579),l=n(580),u=n(581),d=n(433),p=n(436),h=n(438),f=n(582),g=n(468),m=n(585),v=n(586),_=n(587),y=n(588),b=n(443),w=n(352),C=function(){function e(){}return e.register=function(e){this.isInitialized||(ko.components.register("messages-list",{viewModel:{createViewModel:function(e,t){return new c.default(e,t.element)}},template:n(464),synchronous:!0}),ko.components.register("typing-indicator",{viewModel:{createViewModel:function(e){return new a.default(e.conversation)}},template:n(589),synchronous:!0}),ko.components.register("chat-input",{viewModel:{createViewModel:function(t,n){return new o.default(t,n.element,e)}},template:n(465),synchronous:!0}),ko.components.register("expression-picker",{viewModel:{createViewModel:function(e,t){return new l.default(e,t.element)}},template:n(590),synchronous:!0}),ko.components.register("items-picker",{viewModel:{createViewModel:function(e,t){return new u.default(e,t.element)}},template:n(591),synchronous:!0}),ko.components.register("conversation",{viewModel:{createViewModel:function(t,n){return new s.default(t,e,n.element)}},template:n(592),synchronous:!0}),ko.components.register("lwc-signin",{viewModel:{createViewModel:function(t,n){return new d.default(t,e,n.element)}},template:n(446),synchronous:!0}),ko.components.register("new-chat",{viewModel:{createViewModel:function(t,n){return i.default.get.backend===r.MessagingBackend.TEAMS?new m.default(e,n.element):new g.default(e,n.element)}},template:n(593),synchronous:!0}),ko.components.register("add-participants",{viewModel:{createViewModel:function(e,t){return new f.default(e,t.element)}},template:n(594),synchronous:!0}),ko.components.register("remove-participants",{viewModel:{createViewModel:function(e,t){return new v.default(e,t.element)}},template:n(595),synchronous:!0}),ko.components.register("show-participants",{viewModel:{createViewModel:function(e,t){return new _.default(e,t.element)}},template:n(596),synchronous:!0}),ko.components.register("chat-search-input",{viewModel:{createViewModel:function(t,n){return new b.default(t,e,n.element)}},template:n(447),synchronous:!0}),ko.components.register("chat-search-results",{viewModel:{createViewModel:function(t,n){return new w.default(t,e,n.element)}},template:n(448),synchronous:!0}),ko.components.register("reactions-bar",{viewModel:{createViewModel:function(e,t){return new y.default(e.message,e.messageListElement,t.element)}},template:n(597),synchronous:!0}),ko.components.isRegistered("contact-list")||ko.components.register("contact-list",{viewModel:{createViewModel:function(t,n){return new p.default(t,e,n.element)}},template:n(449),synchronous:!0}),ko.components.isRegistered("favorites-list")||ko.components.register("favorites-list",{viewModel:{createViewModel:function(t,n){return new h.default(t,e,n.element)}},template:n(450),synchronous:!0}),this.isInitialized=!0)},e.unregister=function(){ko.components.unregister("messages-list"),ko.components.unregister("chat-input"),ko.components.unregister("conversation"),ko.components.unregister("expression-picker"),ko.components.unregister("items-picker"),ko.components.unregister("new-chat"),ko.components.unregister("chat-search-input"),ko.components.unregister("chat-search-results"),ko.components.unregister("add-participants"),ko.components.unregister("remove-participants"),ko.components.unregister("contact-list"),ko.components.unregister("reactions-bar"),this.isInitialized=!1},e.isInitialized=!1,e}();t.default=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),r=n(9),o=n(62),s=n(4),a=n(6),c=n(2),l=n(1),u=n(44),d=n(7),p=n(75),h=n(25),f=n(121),g=n(0),m=n(46),v=n(240),_=n(564),y=n(466),b=n(243),w=n(60),C=n(70),E=n(35),S=n(565),T=n(566),I=n(571),x="max-width: 0; max-height: 0; position: absolute; overflow: hidden;",A="position: absolute; word-wrap: break-word; white-space: pre-wrap;",P=150,k="isChatEnabled",M="isUnderQuarantine",O=1e3,L=" ",R=function(){function e(e,t,n){var i=this;this._params=e,this.element=t,this.chatConfig=n,this.showCancelEditButton=ko.observable(!1),this.inputHasValue=ko.observable(!1),this.expressionPickerEnabled=ko.observable(!1),this.pesConfigInitialized=ko.observable(!1),this.placeholder=ko.observable(""),this.tag=ko.observable(""),this.isFileTransferEnabled=ko.observable(!1),this.maxLength=c.default.MSG_MAX_LENGTH,this._isInEditingMessageMode=!1,this._isPickerClosed=!1,this.initOnEnabled=function(e){e&&i.init()},this.init=function(){i._setAcceptedFiles(),-1===i._params.conversation.id.indexOf("https")&&(i._textarea.addEventListener("input",function(e){i.inputHasValue(i._textarea.value.trim().length>0)}),i._onQuarantineHandlerSubscripion=i.onQuarantineHandler.bind(i),i.conversation.subscribe(M,i._onQuarantineHandlerSubscripion),i.conversation.subscribe(k,function(e){return i.isChatEnabled(e)})),i.suggestionList=new T.default,i.initSuggestionPicker(),i.isFileTransferEnabled=ko.computed(i.onFileTransferEnabled),i.isSendMessageEnabled=ko.computed(i.onSendMessageEnabled),i.canSendEmoticons=ko.pureComputed(i.canSendEmoticonsHandler),i.disableTextArea=ko.pureComputed(i.onTextAreaEnabled)},this.onTextAreaEnabled=function(){return!!i.conversation.isWithMe()||i.isUnderQuarantine()},this.onFileTransferEnabled=function(){return!i.conversation.isWithMe()&&i.chatConfig.CanUploadFile},this.onSendMessageEnabled=function(){return!i.conversation.isWithMe()&&i.inputHasValue()},this.canSendEmoticonsHandler=function(){return!i.conversation.definition.DisableSendingEmoticons&&(i.pesConfigInitialized()||l.default.instance.PesManager.isInitialized)&&i.expressionPickerEnabled()},this._byTimestamp=function(e,t){return t.originalTimestamp.getTime()>e.originalTimestamp.getTime()?-1:1},this._getLastMesssage=function(){var e=i.conversation.messages?i.conversation.messages.filter(function(e){return e.type===d.MessageType.UserMessage&&e.direction===d.Direction.Outgoing}).sort(i._byTimestamp):[];return e.length?e[e.length-1]:null},this.requestEditingMessage=function(e){if(e.convId===i.conversation.id&&(i.editedMessage=e.message||i._getLastMesssage(),i.editedMessage)){var t=i.editedMessage.content.replace(/<br\s*\/?><br\s*\/?>/g,"\n\n").replace(/<br\s*\/?>/g,"  \n"),n=h.default.dompurify.sanitize(t,{ALLOWED_TAGS:[],ALLOWED_ATTR:[]});if(n){var r=i._textarea.selectionStart;i._isInEditingMessageMode=!0,i.contentBeforeEditing=n,i._textarea.value=n,i.inputHasValue(!0),i.showCancelEditButton(!0),i.setCursorAt(r+n.length),i._textarea.focus()}}},this._emptyTextArea=function(){i._textarea.value="",i.inputHasValue(!1)},this.setCursorAt=function(e){i._textarea.selectionStart=e,i._textarea.selectionEnd=e},this.isActualConversation=function(e){return i.conversation.id===e},this.insertAtCursor=function(e){var t,n=i._textarea.selectionStart,r=i._textarea.value,o=e.template&&e.template.shortcuts&&e.template.shortcuts.length?e.template.shortcuts[0]+L:"";o&&i.isActualConversation(e.convId)&&(t=E.default.inject(r,o,n),i._textarea.value=t,i.inputHasValue(!!i._textarea.value),i.setCursorAt(n+o.length),i._textarea.focus())},this.setProbe=function(e){i.probe=document.createElement("div"),i.mirror=document.createElement("div"),w.default.setStyle(i.probe,x),w.default.setStyle(i.mirror,A),w.default.copyStyle(i.mirror,e,["fontSize","fontWeight","fontFamily"]),i.updateProbeSize(),i.probe.appendChild(i.mirror),i.element.appendChild(i.probe),window.addEventListener("resize",i.updateProbeSize)},this.updateProbeSize=function(){var e=i._textarea,t=w.default.innerSize(e).height;i.maxHeight=P+e.offsetHeight-t,i.mirror.style.width=e.offsetWidth+"px",i.mirror.style.minHeight=t+"px"},this.handleInput=function(e,t){var n=i._textarea.value,r=y.Commands.instance;r.mode===y.CommandMode.change&&r.evaluate(n,i.conversation.id),i.probe||i.setProbe(i._textarea),i.mirror.textContent=n;var o=i.mirror.offsetHeight;o!==i.lastHeight&&(o<i.maxHeight?(i._textarea.style.height=o+"px",i.lastHeight=o):o<parseInt(i.mirror.style.minHeight,10)&&(i._textarea.style.height="",i.lastHeight=0)),i.inputHasValue(!!n),i._isInEditingMessageMode&&(n?n===i.contentBeforeEditing?i.showCancelEditButton(!0):i.showCancelEditButton(!1):(i._isInEditingMessageMode=!1,i.showCancelEditButton(!1))),i.suggestionList.handleInput(e._textarea,e.conversation)},this.cancelEditingMode=function(){i._isInEditingMessageMode=!1,i.editedMessage=null,i._emptyTextArea(),i.showCancelEditButton(!1),i.suggestionList.clear()},this.dispose=function(){window.removeEventListener("resize",i.updateProbeSize),i.conversation&&i.conversation.unsubscribe(M,i._onQuarantineHandlerSubscripion)},this.setupProxy=function(){var e=function(e){return e===i.conversation.id},t=g.swc.API,n=s.ApiEvents.conversationProxy;t.registerEvent(n.openFilePicker,function(t){return e(t)&&i.selectFile()}),t.registerEvent(n.disableInput,function(t){return e(t.id)&&i.isChatEnabled(!t.disable)}),t.registerEvent(n.focusInput,function(t){return e(t.id)&&i._textarea.focus()}),t.registerEvent(n.setInputPlaceholder,function(t){return e(t.id)&&i.placeholder(t.text)}),t.registerEvent(n.setMessageProperties,function(t){e(t.id)&&(t.props?(i.messageProperties=t.props,i.tag(t.props.tag||"")):i.messageProperties=null)}),t.registerEvent(n.setActionBar,function(r){if(e(r.id)){var o=r.definition.map(function(e){return{name:e.name,text:e.text,title:e.title,handler:function(){return t.triggerEvent(n.resActionBar,e.CID)},className:e.className}});i.initActionBar(o)}}),t.registerEvent(n.setInputText,function(t){e(t.id)&&(i.conversation.definition.Prefill=t.text,i.addValueToTextarea(t.text))})},this.conversation=e.conversation,this.placeholder(l.default.instance.i18n.fetch("area_text_insertText")),this.openPickerText=ko.observable(l.default.instance.i18n.fetch("emoticon_picker_open")),this.sendMessageText=l.default.instance.i18n.fetch("send_message"),this.sendFileText=l.default.instance.i18n.fetch("send_file"),this.cancelEditingText=l.default.instance.i18n.fetch("text_cancel_editing_message"),this._textarea=t.querySelector("textarea"),this._fileSelector=t.querySelector("#myFiles"),this.isChatEnabled=ko.observable(!0),this.isUnderQuarantine=ko.observable(!1),this.expressionPickerEnabled(!this.conversation.isDirectLineBackend()&&!!c.default.ECS.expressionPickerEnabled),this._params.enable()?this.init():this._params.enable.subscribe(this.initOnEnabled);this._typingIndicator=o(function(){i.conversation.setIsTyping(i._textarea.value.length>0&&C.get().isOnline)},O,{maxWait:O}),this.addValueToTextarea(this.conversation.definition.Prefill),this.conversation.subscribe("definition",function(e){i.addValueToTextarea(e.Prefill)}),l.default.instance.PesManager.isInitialized?this.pesConfigInitialized(!0):g.swc.API.registerEvent(s.ApiEvents.PesConfigInitialized,function(){i.pesConfigInitialized(!0)});var r=this.conversation.definition.InputPlaceholder||a.default.get.inputPlaceholderOverride;r&&this.placeholder(r),g.swc.API.registerEvent(s.ApiEvents.RequestEditingMessage,this.requestEditingMessage),g.swc.API.registerEvent(s.ExpressionPickerEvents.ITEM_SEND_REQUEST,this.insertAtCursor),this.setupProxy()}return e.prototype.addValueToTextarea=function(e){e&&(this._textarea.value=this.conversation.definition.Prefill,this.inputHasValue(!0))},e.prototype.initSuggestionPicker=function(){var e=r.createElement(I.SuggestionPickerComponent,{suggestionList:this.suggestionList}),t=document.createDocumentFragment();i.render(e,t),this.element.appendChild(t)},e.prototype.initActionBar=function(e){var t=r.createElement(S.ActionBar,{actions:e}),n=document.createDocumentFragment();i.render(t,n),this.element.parentElement.insertBefore(n,this.element)},e.prototype._setAcceptedFiles=function(){var e=this.chatConfig;this._fileSize=parseFloat(e.FileSize),this._extensions=v.default.explode(e.FileExtensions),this._types=v.default.explode(e.FileTypes),this._accepted=v.default.implode(this._extensions.concat(this._types))},e.prototype.sendMessage=function(e){var t=y.Commands.instance,n=this._textarea.value.trim();if(n&&!(n.length>c.default.MSG_MAX_LENGTH))if(t.mode===y.CommandMode.submit&&t.evaluate(n,this.conversation.id))this._emptyTextArea();else{0!==this._textarea.value.toLowerCase().indexOf("skypesearch:")?this._isInEditingMessageMode&&this.editedMessage?this.contentBeforeEditing!==this._textarea.value&&(this.conversation.editMessage(this.editedMessage,n),this.cancelEditingMode()):(e=e===u.ActionTrigger.UNDEFINED?u.ActionTrigger.BUTTON_SEND_CLICK:e,this.conversation.sendMessage(n,e,this.messageProperties),this._emptyTextArea(),this._textarea.style.height=""):this.search(n.substr("skypesearch:".length).trim())}},e.prototype.search=function(e){var t=this;l.default.instance.SearchManager.searchSkypeDirectory(e).then(function(e){m.default.mapSearchProfileInfo(e).forEach(function(e){var n=new p.default(!1);n.content=e.name,n.direction=d.Direction.Incoming,n.status=-1,t.conversation.messages.pushObservable(n)})}),this._emptyTextArea()},e.prototype.sendButtonHandler=function(){this.isChatEnabled()&&(this.suggestionList.clear(),this.sendMessage(u.ActionTrigger.BUTTON_SEND_CLICK))},e.prototype.toggleExpressionPicker=function(){this._isPickerClosed?this.openPickerText(l.default.instance.i18n.fetch("emoticon_picker_open")):this.openPickerText(l.default.instance.i18n.fetch("emoticon_picker_close")),this._isPickerClosed=!this._isPickerClosed,g.swc.API.triggerEvent(s.ApiEvents.ToggleExpressionPicker,this.conversation.id)},e.prototype.selectFile=function(){this.openFileSelector(this._accepted||"")},e.prototype.openFileSelector=function(e){this._fileSelector&&(this._fileSelector.value="",this._fileSelector.accept=e,this._fileSelector.click(),l.default.instance.TelemetryService.sendEvent(new f.UserActionEvent(f.UserActionType.FilePicker)))},e.prototype.sendFile=function(){if(this._fileSelector&&0!==this._fileSelector.files.length){for(var e=this._fileSelector.files,t=0;t<e.length;t++){var n=e[t];_.default.check(n,{size:this._fileSize,extensions:this._extensions,types:this._types})&&l.default.instance.AmsManager.sendFile(this.conversation,n)}this._textarea.focus()}},e.prototype.onKeyDown=function(e,t){this._typingIndicator();var n=t.keyCode||t.which;return!!this.suggestionList.handleKeyDown(t,n)&&(n===b.default.UP&&""===this._textarea.value?(this.requestEditingMessage({convId:this.conversation.id}),!0):n===b.default.ESCAPE?(this.cancelEditingMode(),!0):n!==b.default.ENTER||(!!t.shiftKey||(this.isChatEnabled()?(t.preventDefault(),this.sendMessage(u.ActionTrigger.KEYPRESS_ENTER),this.hideExpressionPicker(),this.suggestionList.handleInput(e._textarea,e.conversation),!1):void 0)))},e.prototype.hideExpressionPicker=function(){g.swc.API.triggerEvent(s.ApiEvents.HideExpressionPicker,this.conversation.id)},e.prototype.onQuarantineHandler=function(){this.isUnderQuarantine(this.conversation.isUnderQuarantine),this.conversation.isUnderQuarantine?(this.placeholder(l.default.instance.i18n.fetch("area_text_disabled")),this._textarea.value=""):this.placeholder(l.default.instance.i18n.fetch("area_text_insertText"))},e}();t.default=R},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.check=function(e,t){if(!t)return!0;var n=isNaN(t.size)||e.size/1048576<=t.size,i=e.name.split("."),r=i.length>1&&"."+i.pop(),o=function(e,t){return!t||!t.length||e&&t.indexOf(e)>-1};return n&&o(r,t.extensions)&&o(e.type,t.types)},e}();t.default=i},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),s=n(9),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){var e=this.props.actions;return s.createElement("div",{className:"swc-action-bar"},e.map(function(e){return s.createElement("button",{key:e.name,className:"swc-action "+e.className,onClick:e.handler,title:e.title},e.text)}))},t}(o.Component);t.ActionBar=a},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(18),s=n(35),a=n(567),c=n(569),l=function(e){function t(){var t=e.call(this)||this;return t._suggestionEngines=[],t._selectedIndex=-1,t._suggestions=[],t._getWord=function(e){var t=e.selectionStart;return s.default.wordAt(e.value,t).toLocaleLowerCase()},t._processSuggestions=function(e){var n=e.length?e.reduce(function(e,t){return e.concat(t)}):[];t.setSuggestions(n),0===t.suggestions.length?t.setSelectedIndex(-1):(-1===t.selectedIndex||t.selectedIndex>t.suggestions.length)&&t.setSelectedIndex(0)},t._suggestionEngines.push(c.default),t._suggestionEngines.push(a.default),t}return r(t,e),Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this._selectedIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"suggestions",{get:function(){return this._suggestions},enumerable:!0,configurable:!0}),t.prototype.setSelectedIndex=function(e){e!==this._selectedIndex&&(this._selectedIndex=e,this.publish("selectedIndex",e))},t.prototype.setSuggestions=function(e){e!==this._suggestions&&(this._suggestions=e,this.publish("suggestions",e))},t.prototype.handleInput=function(e,t){var n=this,i=[];this._suggestionEngines.forEach(function(r){var o=n._getWord(e);r.shouldCreateSuggestion(o)&&i.push(new Promise(function(n,i){r.getSuggestions(e,o,t).then(function(e){n(e.slice(0,5))})}))}),Promise.all(i).then(this._processSuggestions)},t.prototype.clear=function(){this.setSuggestions([]),this.setSelectedIndex(-1)},t.prototype.applyItem=function(e){e<0||e>=this.suggestions.length?this.clear():(this.suggestions[e].applySuggestion(),this.clear())},t.prototype.handleKeyDown=function(e,t){if(0===this.suggestions.length||-1===[38,40,13,9].indexOf(t))return!0;switch(t){case 38:case 40:if(this.suggestions.length<2)return!0;var n=38===t?-1:1;this.setSelectedIndex((this.selectedIndex+this.suggestions.length+n)%this.suggestions.length);break;case 13:case 9:if(e.shiftKey)return!0;this.applyItem(this.selectedIndex)}return!1},t}(o.default);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(568),o=2,s=function(){function e(){var e=this;this.isEnabled=!0,this.suggestHidden=!0,this.shouldCreateSuggestion=function(t){return!!e.isEnabled&&!(0!==t.indexOf("(")||t.length<o)}}return e.prototype.getSuggestions=function(e,t,n){var i=this;return new Promise(function(n,r){i.filterEmoticons(t,e).then(function(e){1===e.length&&i.hasExactMatch("("+t,e[0].emoticon)&&(e=[]),n(e)})})},e.prototype.filterEmoticons=function(e,t){var n=this.suggestHidden;return i.default.instance.PesManager.getConfiguration().then(function(i){return function(i){var o=i.reduce(function(i,o){if("emoticon"!==o.type||!o.visible&&!n)return i;var s=o.shortcuts.filter(function(t){return 0===t.indexOf(e.toLocaleLowerCase())});if(s.length){var a=new r.EmoticonSuggestion(o,s[0],t);return i.push(a),i}return i},[]);return o.sort(function(e,t){var n=e.shortcut,i=t.shortcut;return n.length>i.length?1:n.length<i.length?-1:0}),o}(i.items)})},e.prototype.hasExactMatch=function(e,t){return!!t.shortcuts.filter(function(t){return t===e}).length},e}();t.EmoticonSuggestionEngine=s,t.default=new s},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n,i){var r=e.call(this,i)||this;return r.emoticon=t,r.shortcut=n,r}return r(t,e),t.prototype.getReplacer=function(){return this.shortcut},t}(n(467).Suggestion);t.EmoticonSuggestion=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(570),r=function(){function e(){this.shouldCreateSuggestion=function(e){return!(e.length<1||"@"!==e.charAt(0))}}return e.prototype.getSuggestions=function(e,t,n){return new Promise(function(r,o){t.slice(1);r(n.participants.map(function(t){return new i.MentionSuggestion(t,e)}))})},e}();t.default=new r},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){var i=e.call(this,n)||this;return i.participant=t,i.templateName="suggestion-item-mention",i.displayName=ko.observable(t.person.displayName),t.person.subscribe("displayName",i.displayName),i}return r(t,e),t.prototype.dispose=function(){this.participant.person.unsubscribe("displayName",this.displayName)},t.prototype.getReplacer=function(){var e=this.participant.person;return"@"+(e.isAgent?"("+e.displayName.replace(/(\(|\))/g,"")+")":e.id)},t}(n(467).Suggestion);t.MentionSuggestion=o},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),s=n(9),a=n(82),c=function(e){function t(t){var n=e.call(this,t)||this;return n.propNames=["suggestions","selectedIndex"],n._setNewState=function(){n.setState({suggestions:n.props.suggestionList.suggestions,selectedIndex:n.props.suggestionList.selectedIndex})},n._clickHandler=function(e){n.props.suggestionList.applyItem(e)},n.state={suggestions:[],selectedIndex:-1},n}return r(t,e),t.prototype.componentDidMount=function(){var e=this;this.propNames.forEach(function(t){e.props.suggestionList.subscribe(t,e._setNewState)})},t.prototype.componentWillUnmount=function(){var e=this;this.propNames.forEach(function(t){e.props.suggestionList.unsubscribe(t,e._setNewState)})},t.prototype.render=function(){var e=this;return s.createElement("ul",{className:"suggestionPicker"},this.state.suggestions.map(function(t,n){var i="suggestionPickerItem"+(e.state.selectedIndex===n?" selected":"");return s.createElement("li",{key:t.emoticon.id,className:i,onClick:o.linkEvent(n,e._clickHandler)},s.createElement(a.SwcEmoticon,{emoticonId:t.emoticon.id,isAnimated:!0}),s.createElement("span",{className:"shortcut"},t.shortcut))}))},t}(o.Component);t.SuggestionPickerComponent=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=n(6),o=n(2),s=n(1),a=n(23),c=n(48),l=n(32),u=n(13),d=n(77),p=n(26),h=n(351),f=n(49),g=n(7),m=n(12),v=n(9),_=n(25),y=n(573),b=n(574),w=n(121),C=n(245),E=n(215),S=n(0),T=n(575),I=n(123),x=n(357),A=n(44),P=n(10),k=n(367),M=n(11),O=n(20),L=n(31),R=n(24),N=n(19),D=n(122),Q=n(358),U=n(359),B=n(576),V=n(363),F=n(456),j="swc-calling",H="./calling-popup.html",W="width=640, height=480, menubar=no, status=no, titlebar=no, toolbar=no, rel=noopener noreferrer",z="/sdk/v1/",G="sdk",K="js",q={first:1,second:2},Y=function(){function e(e,t,n){var a=this;this._params=e,this.chatDataConfig=t,this._element=n,this.showComponent=ko.observable(!1),this.isCollapsed=ko.observable(!1),this.title=ko.observable(),this.isPopUp=!!window.opener,this.avatarUrl=ko.observable(""),this.brandMessage=ko.observable(""),this.showBrand=ko.observable(!0),this.isAgent=ko.observable(!1),this.signedIn=ko.observable(!0),this.showLoginPage=ko.observable(!1),this.privacyStatement=ko.observable(),this.termOfUse=ko.observable(),this.showTermsOfUse=ko.observable(),this.showPrivacyStatement=ko.observable(),this.showPrivacyAgreement=ko.observable(),this.expressionPickerEnabled=ko.observable(!1),this.isPickerVisible=ko.observable(!1),this.pesConfigInitialized=ko.observable(!1),this.userMessageSent=ko.observable(!1),this.isGuest=ko.observable(!0),this.showCalling=ko.observable(!1),this.showOtherActions=ko.observable(!0),this.suppressCallingControls=ko.observable(!1),this.showDeepLinks=ko.observable(!1),this.audioEnabled=ko.observable(!0),this.videoEnabled=ko.observable(!0),this.animateLoginScreen=ko.observable(!0),this.canAddParticipants=ko.observable(!0),this.showAddParticipants=ko.observable(!1),this.showRemoveParticipants=ko.observable(!1),this.showShowParticipants=ko.observable(!1),this.isMePersonGuest=ko.observable(!0),this.unreadMessageCounter=ko.observable(0),this.participantsCount=ko.observable(""),this.titleColor=ko.observable(""),this.titleBackground=ko.observable(""),this.correlationId=O.guid.generate(),this.ms_service_privacy_agreement=ko.observable(""),this.renderPES=ko.observable(!1),this._callingPopup=null,this._isMyselfParticipant=function(e){return e.some(function(e){return e.person.mri===s.default.instance.MePersonManager.mePerson.mri})},this._enableChatIfAddedMyself=function(e){a._isMyselfParticipant(e)&&(a.conversation.isChatEnabled=!0,a.setCallingCapabilities())},this.onClicked=function(){return S.swc.API.triggerEvent(i.ApiEvents.hideBubbleWindow),!0},this._createMenuItem=function(e,t,n){return{title:s.default.instance.i18n.fetch(e),group:n||q.first,action:t}},this._getMenuActionItems=function(){var e={p:o.default.getPlatformId(),v:o.default.ECS.version,lang:r.default.get.currentLocale||"",e:o.default.getPlatformName()};r.default.get.correlationId&&(e.tcg=r.default.get.correlationId);var t=N.default.setQueryParameters("https://go.skype.com/feedback.sor",e),n=[];a.conversation.isGroup()?a._isMyselfParticipant(a.conversation.participants)&&n.push(a._createMenuItem("roster_menu_leave_conversation",a.openLeaveConversation)):a.conversation.isBlocked?n.push(a._createMenuItem("roster_menu_unblock_contact",a.openUnblockContact)):n.push(a._createMenuItem("roster_menu_block_contact",a.openBlockContact)),n.push(a._createMenuItem("roster_menu_delete_conversation",a.openDeleteConversation));var i=n.length?q.second:q.first;return n.push(a._createMenuItem("roster_menu_get_help",function(){window.open(o.default.GET_HELP_URL,"_blank"),s.default.instance.TelemetryService.sendEvent(new w.UserActionEvent(w.UserActionType.GetHelp))},i)),n.push(a._createMenuItem("roster_menu_send_feedback",function(){window.open(t,"_blank"),s.default.instance.TelemetryService.sendEvent(new w.UserActionEvent(w.UserActionType.Feedback))},i)),n},this._removeMeParticipantFromModel=function(){for(var e=0;e<a.conversation.participants.length;e++){a.conversation.participants[e].person.id===s.default.instance.MePersonManager.mePerson.id&&a.conversation.participants.spliceObservable(e,1)}},this._removeMeParticipant=function(){return a.conversation.removeParticipant(s.default.instance.MePersonManager.mePerson.mri).then(function(){a.conversation.isChatEnabled=!1,a.showCalling(!1),a._removeMeParticipantFromModel();var e=s.default.instance.i18n.fetch("message_text_you_have_left_the_conversation");s.default.instance.WebApi.sendLocalSystemMessage(a.conversation.id,e,g.CustomMessageType.MeLeftGroup),s.default.instance.TelemetryService.sendEvent(new w.UserActionEvent(w.UserActionType.LeaveConversation))},function(e){})},this.openDeleteConversation=function(e){var t=s.default.instance.i18n.fetch("confirm_dialog_delete_conversation_header"),n=s.default.instance.i18n.fetch("confirm_dialog_delete_conversation_text"),r=s.default.instance.i18n.fetch("btn_confirm_deletion"),o=s.default.instance.i18n.fetch("sign_in_cancel"),c={actionConfirm:function(){var e=Date.now();a.conversation.deleteConversation().then(function(t){S.swc.API.triggerEvent(i.ApiEvents.RemoveAllMessagesFromUi,a.conversation.id);var n=new b.ConversationRemoveEvent("delete",a.conversation);n.ttc=Date.now()-e,n.status=t.status,s.default.instance.TelemetryService.sendEvent(n),s.default.instance.TelemetryService.sendEvent(new w.UserActionEvent(w.UserActionType.DeleteConversation))},function(e){}).then(function(){a.conversation.isGroup()?a._removeMeParticipant().then(function(){Q.default.remove(),a.close()}):(S.swc.API.triggerEvent(i.ApiEvents.OnConversationDelete,a.conversation.id),a.conversation.messages.spliceObservable(0,a.conversation.messages.length),Q.default.remove(),a.close())})},actionCancel:function(){}};Q.default.add(a._element,a.createConfirmationDialog(t,n,r,o,c).getView())},this.openLeaveConversation=function(e){var t=s.default.instance.i18n.fetch("sign_in_cancel"),n={actionConfirm:function(){a._removeMeParticipant().then(Q.default.remove)},actionCancel:function(){}};Q.default.add(a._element,a.createConfirmationDialog(a.deleteConversationTitle,a.deleteConversationText,a.deleteConversationConfirmTitle,t,n).getView())},this.openBlockContact=function(e){var t=s.default.instance.i18n.fetch("confirm_dialog_block_contact_header"),n=s.default.instance.i18n.fetch("are_you_sure"),i=s.default.instance.i18n.fetch("btn_confirm_blocking");Q.default.add(a._element,a.createReportAbuse(t,n,i,function(e,t){var n=Date.now();s.default.instance.ContactsManager.blockContact(a.conversation.id,e,t).then(function(i){var r=new y.ContactBlockEvent("block");r.ttc=Date.now()-n,r.status=i.status,r.isReportAbuse=e,r.reason=t,s.default.instance.TelemetryService.sendEvent(r),Q.default.remove(),s.default.instance.TelemetryService.sendEvent(new w.UserActionEvent(w.UserActionType.BlockUser))},function(e){})}).getView())},this.openUnblockContact=function(e){var t=Date.now();s.default.instance.ContactsManager.unblockContact(a.conversation.id).then(function(e){var n=new y.ContactBlockEvent("unblock");n.ttc=Date.now()-t,n.status=e.status,s.default.instance.TelemetryService.sendEvent(n),s.default.instance.TelemetryService.sendEvent(new w.UserActionEvent(w.UserActionType.BlockUser))},function(e){})},this.openMoreActions=function(e,t){var n=document.createElement("div"),i=a._getMenuActionItems();n.classList.add("menuList","rosterMenuList"),n.setAttribute("data-bind","component: {\n            name: 'menu-list',\n            params: { list: items }\n        }"),ko.applyBindings({items:i},n),a._actionsMenuBound=!0,t.stopPropagation(),D.default.add(a._element.querySelector(".rosterMenuListBtn"),a._element,n,D.BUBBLE_TYPE.MENU_LIST)},this._setAvatarUri=function(e){a.avatarUrl(e)},this.onUnreadMessageCount=function(e){a.conversation.alertsOff||(a.unreadMessageCounter(e),S.swc.API.triggerEvent(i.ApiEvents.UpdateUnreadMessageCounter,{convId:a.convId,count:e}))},this.controlShowHandler=function(e){e.currentConversationId&&L.default.toFullIdentifier(e.currentConversationId)===a.conversation.id?(a.conversation.isControlOpen=!0,a.conversation.unreadMessagesCount=0):a.conversation.isControlOpen=!1},this.openAddon=function(e){var t={"swc:addon:close":function(e){e.message&&a.conversation.sendMessage(e.message,A.ActionTrigger.ADDON),e.invokeData&&a.conversation.sendDataToBot(e.invokeData)}};new T.default(a._element,e.url,t).show()},this.canSendEmoticonsHandler=function(){return!a.conversation.definition.DisableSendingEmoticons&&(a.pesConfigInitialized()||s.default.instance.PesManager.isInitialized)&&a.expressionPickerEnabled()},this.onCalleeUnavailable=function(e){if(e.mri===a.conversation.id){var t=e.withVideo?".actionsbar .calling.video":".actionsbar .calling.audio",n=document.createElement("span");n.textContent=f.default.fetch("callee_unavailable"),D.default.add(a._element.querySelector(t),a._element,n,D.BUBBLE_TYPE.INFO)}},this.callStatusChangedHandler=function(e){a.suppressCallingControls(7!==e.status),e.mri===a.conversation.id&&7!==e.status?a.canClose(!1):a.canClose(a.chatDataConfig.CanClose)},this.controlHideHandler=function(e){e.currentConversationId===a.conversation.id&&(a.conversation.isControlOpen=!1)},this.openAddParticipantsView=function(){s.default.instance.TelemetryService.sendEvent(new w.UserActionEvent(w.UserActionType.AddParticipant)),a.showAddParticipants(!0),a._addParticipantsNode&&a._addParticipantsNode.firstChild&&!a._addParticipantsVM&&(a._addParticipantsVM=ko.dataFor(a._addParticipantsNode.firstChild)),a._addParticipantsVM&&a._addParticipantsVM.triggerFocusToSearch(),S.swc.API.triggerEvent(i.SearchEvents.SEARCH_CREATE_CONTACTLIST,a.correlationId)},this.closeAddParticipantsView=function(){a.showAddParticipants(!1)},this._joinOrCreateConversation=function(e){var t=function(e){I.default.startChat(e,a.chatDataConfig,!1,d.default.ADD_PARTICIPANTS_TEAMS)},n=function(e){var n=e.headers.get("location").match(/threads\/(19:.*)$/)[1];t(n),a.closeAddParticipantsView()},i=function(e){},r=e.concat(a.conversation.members);h.findRecentConversationIdForMembers(r).then(function(e){t(e),a.closeAddParticipantsView()}).catch(function(e){s.default.instance.WebApi.createThread(r).then(n,i)})},this._addToExistingConversation=function(e){e.forEach(function(e){e.id&&a.conversation.addParticipant(e.id)}),a.closeAddParticipantsView()},this.addParticipantsToConversation=function(e){r.default.get.backend===u.MessagingBackend.TEAMS&&a.conversation.isOneOnOne?a._joinOrCreateConversation(e):a._addToExistingConversation(e)},this.openShowParticipantsView=function(){a.showShowParticipants(!0),s.default.instance.TelemetryService.sendEvent(new w.UserActionEvent(w.UserActionType.Participants))},this.closeShowParticipantsView=function(){a.showShowParticipants(!1)},this.openRemoveParticipantsView=function(){a.showRemoveParticipants(!0),s.default.instance.TelemetryService.sendEvent(new w.UserActionEvent(w.UserActionType.Participants))},this.closeRemoveParticipantsView=function(){a.showRemoveParticipants(!1)},this.removeParticipantsFromConversation=function(e){e.forEach(function(e){a.conversation.removeParticipant(e)}),a.closeRemoveParticipantsView()},this.editConversationTitle=function(){},this._callingAllowed=function(){},this.init=function(){var e=function(){a.isGuest(s.default.instance.SignInManager.userIdentityType===l.IdentityType.GUEST),a.updateSignedInState(),a.setCallingCapabilities()};s.default.instance.SignInManager.subscribe("state",e),S.swc.API.registerEvent(i.ApiEvents.ForceExpandChat,function(e){(!r.default.get.isParallelView||r.default.get.isParallelView&&e===a.conversation.id)&&(a.isCollapsed(!1),a.conversation.sdkMode!==p.SDKMode.DIRECT_LINE_TOKEN&&s.default.instance.WebApi.startEndpointActivation())}),e(),a._initConversation()},this.onDragEnter=function(e,t){var n=a._canProcessDropEvent(t);return a._handleDragEventEvent(t,n)},this.onDragOver=function(e,t){return a._handleDragEventEvent(t,a._canProcessDropEvent(t))},this.onDragLeave=function(){},this.onDrop=function(e,t){if(a._canProcessDropEvent(t)){var n=[];t.dataTransfer&&t.dataTransfer.files?n=t.dataTransfer.files:t.originalEvent.dataTransfer&&(n=t.originalEvent.dataTransfer.files);for(var i=0;i<n.length;i++){var r=n[i];s.default.instance.AmsManager.sendFile(a.conversation,r)}}return a._allowCustomHandling(t)},this.dispose=function(){a._idSubscription&&a._idSubscription.dispose()},this._isJoinLink=function(e){return e.indexOf("https")>-1},this._initConversation=function(){a._isJoinLink(a.conversation.id)||a._changeConversation(a.conversation)},this.subscribeToAvatar=function(e,t){a.conversation.isGroup()?a.conversation.subscribe("avatar",a._setAvatarUri):(e.avatarData&&a._setAvatarUri(e.avatarData),e&&e.subscribe("avatarData",function(e){t===a.conversation.id&&a._setAvatarUri(e)}))},this.setupProxy=function(){var e=function(e){return e===a.conversation.id},t=S.swc.API;t.registerEvent(i.ApiEvents.conversationProxy.expand,function(t){e(t.id)&&a.toggleChatSize(null,null,!0)}),t.registerEvent(i.ApiEvents.conversationProxy.showConfirmationDialog,function(n){var r=function(e){t.triggerEvent(i.ApiEvents.conversationProxy.resShowConfirmationDialog,{CID:n.dialog.CID,res:e})};if(e(n.id)){var o={actionConfirm:function(){r(k.DialogResult.CONFIRMED)},actionCancel:function(){r(k.DialogResult.CANCELED)}};Q.default.add(a._element,a.createConfirmationDialog(n.dialog.title,n.dialog.description,n.dialog.confirmationButtonTitle,n.dialog.cancelButtonTitle,o).getView())}}),t.registerEvent(i.ApiEvents.conversationProxy.regUnreadCount,function(n){e(n.id)&&(a.refId=a.refId||n.refId,a.conversation.subscribe("unreadMessagesCount",function(e){t.triggerEvent(i.ApiEvents.conversationProxy.unreadCount,{refId:a.refId,count:e})}))})},this.isSupportedBrowser=R.default.testSupporedList(o.default.ECS.callingSupportedBrowsers),this.isIeEngine=R.default.isIe(),this.conversation=this._params.conversation,this.convId=L.default.getNormalizeId(this.conversation.id),this.deepLinkAudioCall="skype:"+this.convId+"?call",this.deepLinkVideoCall=this.deepLinkAudioCall+"&video=true",this.enable=this._params.enable,this._avatarContainer=n.querySelector(".swc-header .headerAvatar"),this.canClose=ko.observable(t.CanClose),t.TitleColor&&this.titleColor(t.TitleColor),t.TitleBackground&&this.titleBackground(t.TitleBackground);var c=encodeURIComponent(this.chatDataConfig.Locale||o.default.LOCALE);this._setContent(c),this._params.enable()?this.init():this._params.enable.subscribe(function(e){return e&&a.init()}),!r.default.get.callingReady&&this.chatDataConfig.EnableCalling&&S.swc.API.registerEvent("callingReady",function(){a.setCallingCapabilities()}),this.conversation.subscribe("unreadMessagesCount",this.onUnreadMessageCount),this.conversation.subscribe("alertsOff",function(e){e?a.unreadMessageCounter(-1):a.unreadMessageCounter(a.conversation.unreadMessagesCount)});var m=function(){return setTimeout(function(){return a.renderPES(!0)},0)},v=S.swc.API;s.default.instance.PesManager.isInitialized?(this.pesConfigInitialized(!0),m()):v.registerEvent(i.ApiEvents.PesConfigInitialized,function(){a.pesConfigInitialized(!0),m()}),window.participants=this.conversation.participants,this.showBrand(!x.default.isDomainIn("hideLogoOnHosts")),this.expressionPickerEnabled(!this.conversation.isDirectLineBackend()&&!!o.default.ECS.expressionPickerEnabled),this.canSendEmoticons=ko.pureComputed(this.canSendEmoticonsHandler),v.registerEvent(i.ApiEvents.onControlShow,this.controlShowHandler),v.registerEvent(i.ApiEvents.onControlHide,this.controlHideHandler),v.registerEvent(i.ApiEvents.CallStatusChanged,this.callStatusChangedHandler),v.registerEvent("calleeUnavailable",this.onCalleeUnavailable),v.registerEvent("swc:addon:open",function(e){e.id===a.conversation.id&&a.openAddon(e)}),this.animateLoginScreen(!t.DisableInOutAnimation),this.isGroupConversation=ko.observable(this.conversation.isGroup()),this.isOneOnOneConversation=ko.observable(this.conversation.isOneOnOne),this._addParticipantsNode=n.querySelector(".addParticipants"),this.conversation.isGroup()&&this.conversation.participants.subscribe(function(e){a.participantsCount(e.length>0?e.length.toString():""),a._enableChatIfAddedMyself(e)}),s.default.instance.MePersonManager.fetch().then(function(e){a.isMePersonGuest(e.isGuest)}),this.isParticipantControlEnabled=ko.computed(function(){return t.EnableParticipantsControl&&a.isGroupConversation()&&!a.isMePersonGuest()}),this.showActionsBar=ko.computed(function(){return a.isParticipantControlEnabled()||a.showDeepLinks()||a.showCalling()&&!a.suppressCallingControls()||a.showOtherActions()}),this.conversation.subscribe("isOneOnOne",this.isOneOnOneConversation),this.isParticipantRemovalControlEnabled=ko.computed(function(){return r.default.get.backend!==u.MessagingBackend.TEAMS}),this.isShowParticipantsControlEnabled=ko.computed(function(){var e=r.default.get.isTeams(),t=a.isOneOnOneConversation();return e&&!t}),this.conversation.subscribe("isBlocked",function(e){if(e?a.showCalling(!1):a.setCallingCapabilities(),a.conversation.isChatEnabled=!e,!a.conversation.isGroup()){var t=s.default.instance.Persons.getPerson(a.conversation.id,!1,a.isAgent());t&&(t.isBlocked=e)}}),(new C.UserActivityStart).send(),this.setupProxy()}return e.prototype._setContent=function(e){this.privacyStatementText=s.default.instance.i18n.fetch("header_privacyPolicy"),this.termOfUseText=s.default.instance.i18n.fetch("header_termsOfUse"),this.editConversationTitleText=s.default.instance.i18n.fetch("edit_conversation_title_text"),this.deleteConversationTitle=s.default.instance.i18n.fetch("confirm_dialog_leave_conversation_header"),this.deleteConversationText=s.default.instance.i18n.fetch("confirm_dialog_leave_conversation_text"),this.deleteConversationConfirmTitle=s.default.instance.i18n.fetch("btn_confirm_leave"),this.brandMessage(s.default.instance.i18n.fetch("powered_by_skype"));var t=_.default.dompurify.sanitize(s.default.instance.i18n.fetch("ms_service_privacy_agreement",{0:'<a href="https://www.microsoft.com/'+e+'/servicesagreement/" target="_blank">',1:"</a>",2:'<a href="https://privacy.microsoft.com/'+e+'/privacystatement" target="_blank">',3:"</a>"}),{ALLOWED_TAGS:["a"],ALLOWED_ATTR:["target","href"]});this.ms_service_privacy_agreement(t)},e.prototype.createConfirmationDialog=function(e,t,n,i,r){return new U.default({title:e,text:t,confirm:{title:n,action:function(){r.actionConfirm(),Q.default.remove()}},cancel:{title:i,action:function(){r.actionCancel(),Q.default.remove()}}},V.TextDialog)},e.prototype.createReportAbuse=function(e,t,n,i){return new U.default({title:e,text:t,confirm:{title:n,action:function(e,t){i(e,t),Q.default.remove()}},cancel:{title:s.default.instance.i18n.fetch("sign_in_cancel"),action:Q.default.remove}},B.BlockDialog)},e.prototype.startVideoCall=function(e,t){t.stopPropagation(),this._startCall(!0),s.default.instance.TelemetryService.sendEvent(new w.UserActionEvent(w.UserActionType.StartVideoCall))},e.prototype.startAudioCall=function(e,t){t.stopPropagation(),this._startCall(!1),s.default.instance.TelemetryService.sendEvent(new w.UserActionEvent(w.UserActionType.StartAudioCall))},e.prototype.startVideoCallDeeplink=function(e,t){t.stopPropagation(),this._startCallDeeplink(!0),s.default.instance.TelemetryService.sendEvent(new w.UserActionEvent(w.UserActionType.StartVideoCall))},e.prototype.startAudioCallDeeplink=function(e,t){t.stopPropagation(),this._startCallDeeplink(!1),s.default.instance.TelemetryService.sendEvent(new w.UserActionEvent(w.UserActionType.StartAudioCall))},e.prototype.loginCss=function(){return{anim:!0}},e.prototype.setCallingCapabilities=function(){var e=this;if(r.default.get.callingReady){if(this.conversation.isWithMe())return this.showCalling(!1),this.videoEnabled(!1),void this.audioEnabled(!1);var t=!1,n=!1,i=!1;if(this.chatDataConfig.EnableCalling){if(!this.isSupportedBrowser)return void this.showDeepLinks(!0);if(this.conversation.getConversationType()===g.ConversationType.PHONE)return this.videoEnabled(!1),this.audioEnabled(!0),void this.showCalling(!0);if(this.conversation.isGroup()||!this.isGuest()&&!this.conversation.isAgent())t=n=i=!0;else if(this._capabilities){var o=function(t){return e._capabilities.indexOf(t)>-1};n=o("video.send"),i=o("audio.send"),t=n||i}this.showCalling(t)}this.videoEnabled(n),this.audioEnabled(i)}},e.prototype.updateSignedInState=function(){var e=s.default.instance.SignInManager;if(this.conversation.sdkMode!==p.SDKMode.BOT||r.default.get.isSkypeOnly)if(this.conversation.getConversationType()===g.ConversationType.PERSON&&e.userIdentityType===l.IdentityType.GUEST)this.showLoginPage(!0),this.showComponent(!1),this.signedIn(!1);else if(this.conversation.getConversationType()===g.ConversationType.GROUP&&r.default.get.isGuestOnlyMode)this.showLoginPage(!1),this.showComponent(!0),this.signedIn(!0);else{this.showLoginPage(e.state===a.SigninState.SignedOut||e.state===a.SigninState.SigningOut);var t=e.state===a.SigninState.SignedIn||this.conversation.isGroup()||!this.isGuest()&&this.conversation.isPerson();this.signedIn(e.state!==a.SigninState.SignedOut&&t),this.showComponent(!1),this.showLoginPage()||this.signedIn()!==this.showLoginPage()||M.default.throwError(P.ErrorCodes.DBG_EMPTY_CHAT_SHOWN,"Empty chat is shown","",this.conversation.id)}else this.showLoginPage(!1),this.showComponent(!0),this.signedIn(e.state!==a.SigninState.SignedOut)},e.prototype.close=function(e,t){t&&t.stopPropagation();var n={id:this.conversation.id},a={origin:o.default.ORIGIN,action:c.default.HideChatWindow,data:n};if(S.swc.API.triggerEvent(i.ApiEvents.onControlClose,n),!this.conversation.definition.EnableCustomOnCloseHandler){r.default.get.frameless?S.swc.SDK.Chat.resolveMessage(a):parent&&parent.postMessage(a,document.referrer||"*");var l=new E.VisibilityChangedEvent(!1);s.default.instance.TelemetryService.sendEvent(l)}},e.prototype.toggleChatSize=function(e,t,n){if(this.chatDataConfig.CanCollapse){this.isCollapsed(!(n||this.isCollapsed()));var s=this.isCollapsed()?c.default.CollapseChatWindow:c.default.ExpandChatWindow;r.default.get.frameless?S.swc.SDK.Chat.resolveMessage({origin:o.default.ORIGIN,action:s}):parent&&parent.postMessage({origin:o.default.ORIGIN,action:s},document.referrer||"*"),this.conversation.isControlOpen=!this.isCollapsed(),this.conversation.isControlOpen&&(this.conversation.unreadMessagesCount=0);var a=this.conversation.sdkMode===p.SDKMode.BOT||this.conversation.sdkMode===p.SDKMode.DIRECT_LINE_TOKEN,l={type:this.isCollapsed()?"collapse":"expand",isVisible:!this.isCollapsed(),conversationId:a?this.conversation.id:"n/a"};S.swc.API.triggerEvent(i.ApiEvents.OnVisibilityChange,l),this.isCollapsed()||this.conversation.markAsRead()}},e.prototype._startCallDeeplink=function(e){var t=e?this.deepLinkVideoCall:this.deepLinkAudioCall;window.open(t,"_self").opener=null},e.prototype._startCall=function(e){var t=this,n=this.conversation.isGroup(),o=this.conversation.id;r.default.get.isTeams()&&this.conversation.isOneOnOne&&(n=!1,o=this.conversation.members.filter(function(e){return!s.default.instance.MePersonManager.isMe(e.id)}).shift().id),"https:"===r.default.get.parentProtocol?S.swc.API.triggerEvent(i.ApiEvents.StartCall,{calleeId:o,withVideo:e,avatarUrl:this.avatarUrl(),displayName:this.title(),isGroup:n}):null===this._callingPopup||this._callingPopup.closed?S.swc.services.signInManager.getSkypeToken().then(function(n){var i={token:n,convId:o,convType:L.default.detectConversationType(o),withVideo:e,SDKUrl:t._getSDKUrl(),env:S.swc.EcsConfig.environment};t._callingPopup=window.open(N.default.setQueryParameters(H,i),j,W)}):this._callingPopup.focus()},e.prototype._getSDKUrl=function(){return N.default.getCDNPath()+N.default.getCompletePath(z+G,K)},e.prototype._allowCustomHandling=function(e){return e.preventDefault(),e.stopPropagation(),this.isIeEngine&&(e.returnValue=!1),!1},e.prototype._handleDragEventEvent=function(e,t){var n=e.dataTransfer||e.originalEvent.dataTransfer;return n&&(n.dropEffect=t?"copy":"none"),this._allowCustomHandling(e)},e.prototype._containsType=function(e,t){var n=e.dataTransfer||e.originalEvent.dataTransfer;return Array.prototype.some.call(n.types,function(e){return e===t})},e.prototype._canProcessDropEvent=function(e){return this.chatDataConfig.CanUploadFile&&this._containsType(e,"Files")},e.prototype.show=function(){S.swc.SDK.Chat.startChat({ConversationId:this.conversation.id}),this.isCollapsed(!1)},e.prototype._subscribeToDisplayName=function(e){var t=this;e.displayName&&this._handleDisplayName(e),e.subscribe("displayName",function(){return t._handleDisplayName(e)})},e.prototype._handleDisplayName=function(e){var t=e.isAgent&&e.displayName===e.id?"":e.displayName;this.title(t),this.conversation.topic=e.displayName},e.prototype._changeConversation=function(e){var t=this,n=s.default.instance.SignInManager;this.isGuest(n.userIdentityType===l.IdentityType.GUEST||n.state!==a.SigninState.SignedIn),this.conversation=e,this.conversation.sdkMode===p.SDKMode.BOT?this.showLoginPage(!1):this.updateSignedInState(),this.isAgent(this.conversation.isAgent());var i,r=document.createDocumentFragment(),o={customAvatar:this.chatDataConfig.Avatar,customTitle:this.chatDataConfig.Title,conversation:this.conversation},c=v.createElement(F.ConversationAvatar,o);if(m.render(c,r),this._avatarContainer.appendChild(r),this.isAgent&&this._avatarContainer.classList.add("bot"),this.conversation.isGroup()||(i=s.default.instance.Persons.getPerson(this.conversation.id,!0,this.isAgent()),s.default.instance.WebApi.subscribeContactPresence(i.id)),this.conversation.topic||this.conversation.isGroup()){var u=this.conversation.topic;this.chatDataConfig.Title||this.conversation.subscribe("topic",function(e){t.title(e)}),this.title(u)}else n.getSkypeToken().then(function(e){n.state===a.SigninState.SignedIn&&t._subscribeToDisplayName(i)}).catch(function(e){n.state===a.SigninState.SignedIn?t._subscribeToDisplayName(i):n.subscribe("state",function(){n.state===a.SigninState.SignedIn&&(t._subscribeToDisplayName(i),i.fetchDisplayNameAndAvatar())})});var d=this.chatDataConfig.Avatar;d?this._setAvatarUri(d):this.conversation.avatar&&this._setAvatarUri(this.conversation.avatar),d||this.subscribeToAvatar(i,this.conversation.id),this.conversation.sdkMode===p.SDKMode.BOT&&i&&s.default.instance.AgentsManager.getAgent(i.id).then(function(e){if(e&&e.agentDescriptions&&1===e.agentDescriptions.length){var n=e.agentDescriptions[0],i=t.conversation.definition.PrivacyUri||n.privacyStatement,r=t.conversation.definition.TermsOfUseUri||n.tos;t.privacyStatement(i),t.termOfUse(r),t.showPrivacyStatement(n.privacyStatement&&n.privacyStatement.length>0),t.showTermsOfUse(n.tos&&n.tos.length>0),n.capabilities&&(t._capabilities=n.capabilities,t.setCallingCapabilities())}})},e}();t.default=Y},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=function(e){function t(t){var n=e.call(this,"kpi_contact_block")||this;return n.action=t,n}return r(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(o.TelemetryPropertyValue.Create("action",this.action)),e.push(o.TelemetryPropertyValue.Create("ttc",this.ttc)),e.push(o.TelemetryPropertyValue.Create("status",this.status)),"block"===this.action&&(e.push(o.TelemetryPropertyValue.Create("isReportAbuse",this.isReportAbuse)),e.push(o.TelemetryPropertyValue.Create("reason",this.reason))),e},t}(n(8).TelemetryEvent);t.ContactBlockEvent=s},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=function(e){function t(t,n){var i=e.call(this,"kpi_conversation_remove",n)||this;return i.action=t,i._conversation=n,i}return r(t,e),t.prototype.getSharedCustomProperties=function(){var t=e.prototype.getCustomProperties.call(this);return t.push(o.TelemetryPropertyValue.Create("action",this.action)),t.push(o.TelemetryPropertyValue.Create("ttc",this.ttc)),t.push(o.TelemetryPropertyValue.Create("status",this.status)),t.push(o.TelemetryPropertyValue.Create("participants",this._conversation.participants.length)),this._conversation.consumptionHorizon&&t.push(o.TelemetryPropertyValue.Create("lastActive",Date.now()-this._conversation.consumptionHorizon.lastReadMessageTimestamp)),t},t.prototype.getCustomProperties=function(){return this.getSharedCustomProperties()},t}(n(36).ConversationDataEvent);t.ConversationRemoveEvent=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,n){var i=this;this.onClose=function(){i.frame.contentWindow.postMessage("swc:addon:userClosed","*"),window.setTimeout(function(){i.hide(),i.destroy()},5)},this.handlers={},this.onmessage=function(e){var t=e.data;if(t&&t.action)switch(t.action){case"swc:addon:close":(0,i.handlers["swc:addon:close"])(t),i.hide(),i.destroy()}},this.handlers=n,this.wrapper=document.createElement("div"),this.close=document.createElement("div"),this.frame=document.createElement("iframe");this.frame.style;this.wrapper.setAttribute("style","position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 5; background: #fff");this.frame.setAttribute("style","width: 100%; height: 100%; border: none;"),this.frame.setAttribute("allow","camera; microphone;"),this.frame.src=encodeURI(t);this.close.textContent="close",this.close.setAttribute("style","position: absolute; z-index: 10; right: 5px; top: 5px; font-size: 9px;"),this.close.addEventListener("click",this.onClose),this.hide(),this.listen(),this.wrapper.appendChild(this.frame),this.wrapper.appendChild(this.close),e.appendChild(this.wrapper)}return e.prototype.listen=function(){window.addEventListener("message",this.onmessage)},e.prototype.show=function(){this.wrapper.style.display="block"},e.prototype.hide=function(){this.wrapper.style.display="none"},e.prototype.destroy=function(){window.removeEventListener("message",this.onmessage),this.close.removeEventListener("click",this.onClose);var e=this.wrapper.parentElement;this.wrapper.removeChild(this.frame),e.removeChild(this.wrapper)},e}();t.default=i},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),s=n(1),a=n(577),c=function(e){function t(t){var n=e.call(this,t)||this;return n._translations={confirm_dialog_report_abuse_spam_reason_text:s.default.instance.i18n.fetch("confirm_dialog_report_abuse_spam_reason_text"),confirm_dialog_report_abuse_pornography_reason_text:s.default.instance.i18n.fetch("confirm_dialog_report_abuse_pornography_reason_text"),confirm_dialog_report_abuse_child_exploitation_reason_text:s.default.instance.i18n.fetch("confirm_dialog_report_abuse_child_exploitation_reason_text"),confirm_dialog_report_abuse_harassment_reason_text:s.default.instance.i18n.fetch("confirm_dialog_report_abuse_harassment_reason_text"),confirm_dialog_block_report_abuse_checkbox:s.default.instance.i18n.fetch("confirm_dialog_block_report_abuse_checkbox")},n._onReasonChange=function(e){n.setState({value:e.target.value})},n._onCheckChange=function(e){n.setState({reportAbuseCheckBox:e.target.checked})},n.state={reportAbuseCheckBox:!1,value:a.AbuseTypes.Spam},n}return r(t,e),t.prototype.getContentElement=function(){return o.createElement("div",null,o.createElement("label",{className:"blockLabel"},o.createElement("input",{className:"blockCheckBox",type:"checkbox",onChange:this._onCheckChange,checked:this.state.reportAbuseCheckBox}),o.createElement("p",{className:"blockText"},this._translations.confirm_dialog_block_report_abuse_checkbox)),this.state.reportAbuseCheckBox&&o.createElement("select",{value:this.state.value,onChange:this._onReasonChange,className:"abuseOptions"},o.createElement("option",{selected:this.state.value===a.AbuseTypes.Spam,value:a.AbuseTypes.Spam},this._translations.confirm_dialog_report_abuse_spam_reason_text),o.createElement("option",{selected:this.state.value===a.AbuseTypes.Pornography,value:a.AbuseTypes.Pornography},this._translations.confirm_dialog_report_abuse_pornography_reason_text),o.createElement("option",{selected:this.state.value===a.AbuseTypes.ChildExploitation,value:a.AbuseTypes.ChildExploitation},this._translations.confirm_dialog_report_abuse_child_exploitation_reason_text),o.createElement("option",{selected:this.state.value===a.AbuseTypes.Harassment,value:a.AbuseTypes.Harassment},this._translations.confirm_dialog_report_abuse_harassment_reason_text)))},t.prototype.confirmAction=function(){var e=this.state.reportAbuseCheckBox,t=this.state.value;this.props.dialogContent.confirm.action(e,t)},t}(n(364).Dialog);t.BlockDialog=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Spam="spam",e.Pornography="pornography",e.ChildExploitation="child-exploitation",e.Harassment="harassment"}(t.AbuseTypes||(t.AbuseTypes={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(31),o=function(){function e(e){var t=this;this.conversation=e,this.isLoading=!0,this.typingIndicator=ko.observable(i.default.instance.i18n.fetch("typingIndicatorOnLoad")),this.isTyping=ko.observable(!1),this._typingParticipants={},this.conversation.participants.subscribe(this._onParticipantsChange.bind(this)),this.conversation.subscribe("isTyping",this._onTypingIndicator.bind(this)),this.boundConversationLoadedHandler=this._onConversationLoadedHandler.bind(this),e.isLoaded?this.setup():(this.isTyping(!0),this.conversation.subscribe("isLoaded",this.boundConversationLoadedHandler)),e.isDirectLineBackend()&&(this.typingIndicator(i.default.instance.i18n.fetch("typingIndicator",{typingMessage:this.adjustBotName("")})),e.subscribe("topic",function(e){t.typingIndicator(i.default.instance.i18n.fetch("typingIndicator",{typingMessage:t.adjustBotName(e)}))}))}return e.prototype.setup=function(){var e=this;if(this.conversation.isGroup())this.typingIndicator(i.default.instance.i18n.fetch("typingIndicatorHuman",{typingMessage:"somebody"}));else{var t=i.default.instance.Persons.getPerson(this.conversation.id,!0);this.typingIndicator(i.default.instance.i18n.fetch("typingIndicator",{typingMessage:this.adjustBotName(t.displayName)})),t.subscribe("displayName",function(t){e.typingIndicator(i.default.instance.i18n.fetch("typingIndicator",{typingMessage:e.adjustBotName(t)}))})}},e.prototype._onParticipantsChange=function(e,t){var n=this;e.length&&t.newItems&&t.newItems.length&&t.newItems.forEach(function(e){var t=n._typingDetector.bind(n,e);e.subscribe("isTyping",t)})},e.prototype._onConversationLoadedHandler=function(){this.isTyping(!1),this.setup()},e.prototype._onTypingIndicator=function(e){if(this.isTyping(!!e),this.timeoutId&&clearTimeout(this.timeoutId),e){var t=this;this.timeoutId=setTimeout(function(){t.isTyping(!1),t.timeoutId=void 0},5e3)}},e.prototype._typingDetector=function(e,t){var n=this,r=e.person.id;t?this._typingParticipants[r]=e:delete this._typingParticipants[r];var o=Object.keys(this._typingParticipants),s="";o.length?(this.conversation.isGroup()&&(o.forEach(function(e){var t=n._typingParticipants[e].person.displayName;s+=""===s?t:", "+t}),this.typingIndicator(i.default.instance.i18n.fetch("typingIndicatorHuman",{typingMessage:s}))),this.isTyping(!0)):this.isTyping(!1)},e.prototype.adjustBotName=function(e){return e&&e!==r.default.getNormalizeId(this.conversation.id)?e:this.conversation.isAgent()?"Bot":"Person"},e.prototype.dispose=function(){this.conversation.unsubscribe("isLoaded",this.boundConversationLoadedHandler)},e}();t.default=o},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s=n(6),a=n(2),c=n(1),l=n(10),u=n(89),d=n(7),p=n(75),h=n(0),f=n(19),g=n(122),m=n(11),v=n(130),_="isUnderQuarantine",y="isBlocked",b="swift-narrow",w=function(e){function t(n,i){var r=e.call(this,n.conversation,i)||this;return r._params=n,r._canMarkNewMessage=!1,r._fetchingInProgress=!1,r._isFirstLoad=!0,r._crMessage=null,r._unreadSplitter=null,r._blockedChatMsg=null,r.lastScrollStartTime=0,r.init=function(){r.conversation.subscribe(_,r._onQuarantineHandlerSubscripion),r.conversation.subscribe(y,r._onBlockedHandlerSubscripion),c.default.instance.MePersonManager.fetch().then(function(e){r.meUserName=e.id,r._initConversationMessagesList(),r._addBotGreetingMessage(),r._addWelcomeMessage(),r._updateUnreadSplitter(),r._scrollToBottom(),r._setMinHeight(),r.viewport.addEventListener("scroll",r._onScroll),r._messagesEl=r._element.querySelector(".messages");var t=v.default.instance;t.forceWidth(r._messagesEl.offsetWidth),t.addResizeHandler(r._onResize),t.CurrentStyle===v.StyleModes.NARROW&&r._messagesEl.classList.add(b),h.swc.API.registerEvent("viewRestored",function(e){e===r.conversation.id&&(r._updateUnreadSplitter(!0),setTimeout(r._scrollToBottom,0))})},function(e){m.default.throwError(l.ErrorCodes.ERR_FETCH_ME_PERSON_IN_LIST,"Unable to fetch me person in messages list VM")}),h.swc.API.registerEvent(o.ApiEvents.RemoveAllMessagesFromUi,r.removeAllMessagesFromUI),h.swc.API.registerEvent(o.ApiEvents.scrollToBottom,function(e){return e===r.conversation.id&&r._scrollToBottom()}),r.scroll=new u.default(r._element,r.viewport)},r.removeAllMessagesFromUI=function(e){e===r.conversation.id&&r._removeAllMessagesFromUI()},r._onResize=function(){r.scroll.recount()},r._onScroll=function(){r.lastScrollStartTime=Date.now(),r.isScrolling=!0,r.messagesList().length&&r.viewport.scrollTop<4e3&&!r._fetchingInProgress&&(r._fetchingInProgress=!0,-1===r._lastScrollPositionFromBottomBeforeFetching&&(r._lastScrollPositionFromBottomBeforeFetching=r.viewport.scrollHeight-r.viewport.scrollTop),r.conversation.loadMoreMessages().then(function(){return r._fetchingInProgress=!1})),r.viewport.scrollTop<r.viewport.scrollHeight-r.viewport.offsetHeight-500&&r.showJumpArrow(!0),r.viewport.scrollTop+250>=r.viewport.scrollHeight-r.viewport.offsetHeight&&r.showJumpArrow(!1),r.scrollingTimer||(r.scrollingTimer=setTimeout(function(){Date.now()-500>r.lastScrollStartTime&&(r.isScrolling=!1,r.lastScrollStartTime=0,r.scrollingTimer=null)},500)),g.default.remove()},r.dispose=function(){r.conversation&&r.conversation.messages&&(r.conversation.messages.unsubscribe(r._onNewMessages),r.conversation.messages.spliceObservable(0,r.conversation.messages.length)),r.messagesList().forEach(function(e){e.dispose()}),r.viewport.removeEventListener("scroll",r._onScroll),v.default.instance.removeResizeHandler(r._onResize),r.messagesList.removeAll(),r.conversation.unsubscribe(_,r._onQuarantineHandlerSubscripion),r.conversation.unsubscribe(y,r._onBlockedHandlerSubscripion)},r._initConversationMessagesList=function(){if(r.conversation.messages.length>0){r._canMarkNewMessage=!0,t.initTelemetrySent||(t.initTelemetrySent=!0);for(var e=0,n=r.conversation.messages;e<n.length;e++){var i=n[e];if(r._checkUserMessageSent(i))break}r._addMessagesToUI(r.conversation.messages),setTimeout(r._scrollToBottom,0)}r.conversation.messages.subscribe(r._onNewMessages.bind(r))},r.addMessage=function(e){var t=new p.default(!1);t.type=d.MessageType.UserMessage,t.direction=d.Direction.Incoming,t.content=e,t.status=-1,r.conversation.messages.pushObservable(t)},r._checkUserMessageSent=function(e){return!!r._params.userMessageSent()||("UserMessage"===e.type&&e.direction===d.Direction.Outgoing&&(r._params.userMessageSent(!0),r._setMinHeight()),!1)},r._onNewMessages=function(e,n){r._canMarkNewMessage||(r._canMarkNewMessage=!0),t.initTelemetrySent||(t.initTelemetrySent=!0);var i,o=r.messagesList().length-1,s=r.messagesList()[o]?r.messagesList()[o].timestamp.getTime():0,a=[],c=[];if(n.newItems?n.newItems.forEach(function(e){e&&e.content;r._checkUserMessageSent(e),e.isDeleted||r.conversation.definition.HideSystemMessages&&"SystemMessage"===e.type||(e.content||0!==e.files.length)&&(s>e.timestamp.getTime()?c:a).push(e)}):n.oldItems&&r._removeMessagesFromUI(n.oldItems),r._isFirstLoad&&setTimeout(r._scrollToBottom,0),c.length){for(var l=r.messagesList()[0],u=[],d=r.viewport.scrollTop-r.viewport.scrollHeight,p=function(e){for(var t=r.messagesList().length-1;t>=0;t--)if(r.messagesList()[t].timestamp.getTime()<e.timestamp.getTime())return t;return-1},h=0;h<c.length;h++){var f=c[h];if(l&&f.timestamp<=l.timestamp)u.push(f);else{var g=p(f)+1;r.messagesList.splice(g,0,f),r.adjustAuthorInfo(g,g+1)}}u.length&&((i=r.messagesList).unshift.apply(i,u),r.adjustAuthorInfo(0,c.length)),r.viewport.scrollTop=r.viewport.scrollHeight+d}if(a.length){r._addMessagesToUI(a);var m=r.messagesList().length-a.length,v=m>0?m-1:0;r.adjustAuthorInfo(v,r.messagesList().length),setTimeout(r._scrollToBottom,0)}(r._isFirstLoad&&e.length||a.length)&&(r._processSuggestedActions(e[e.length-1]),r._isFirstLoad=!1),r._updateUnreadSplitter(),r.scroll.recount()},r._onMessageDeleted=function(e){e&&r._updateUnreadSplitter()},r.convContainerNode=i.parentElement,r._onQuarantineHandlerSubscripion=r.onQuarantineHandler.bind(r),r._onBlockedHandlerSubscripion=r.onBlockedHandler.bind(r),r._params.enable()?r.init():r._params.enable.subscribe(function(e){return e&&r.init()}),r}return r(t,e),t.prototype._addMessagesToUI=function(e){var t,n=this;e.forEach(function(e){e.subscribe("isDeleted",n._onMessageDeleted)}),(t=this.messagesList).push.apply(t,e)},t.prototype._removeMessagesFromUI=function(e){var t=this;e.forEach(function(e){e.unsubscribe("isDeleted",t._onMessageDeleted)}),this.messagesList.removeAll(e)},t.prototype._removeAllMessagesFromUI=function(){var e=this;this.messagesList().forEach(function(t){t.unsubscribe("isDeleted",e._onMessageDeleted)}),this.messagesList.removeAll()},t.prototype._cancelEvent=function(e){e.preventDefault(),e.stopPropagation(),e.returnValue=!1},t.prototype._setMinHeight=function(){this.clientHeight(this.viewport.clientHeight?this.viewport.clientHeight+"px":"100%")},t.prototype._addWelcomeMessage=function(){var e=a.default.ECS.hideWelcomeOnHosts;if(e&&e.some(function(e){return f.default.getHost()===e||s.default.get.host===e}))return;var t=new p.default(!1);t.type=d.MessageType.Welcome,t.status=d.DeliveryStatus.Sent,this.messagesList.push(t)},t.prototype._addTranslationMessage=function(){var e=new p.default(!1);e.type=d.MessageType.Translate,this.messagesList.push(e)},t.prototype.onQuarantineHandler=function(){if(this.conversation.isUnderQuarantine&&!this._crMessage){this._crMessage=new p.default(!0),this._crMessage.type=d.MessageType.SystemMessage;var e="";!this.person&&this.conversation.isPerson()&&(this.person=c.default.instance.Persons.getPerson(this.conversation.id),e=this.person.displayName||this.person.id),this._crMessage.content=c.default.instance.i18n.fetch("waiting_for_replay",{user_name:e}),this.messagesList.push(this._crMessage)}else!this.conversation.isUnderQuarantine&&this._crMessage&&(this.messagesList.remove(this._crMessage),this._crMessage=null)},t.prototype.onBlockedHandler=function(){var e=this.messagesList().length-1;if(this.messagesList()[e]===this._blockedChatMsg&&!this.conversation.isBlocked)return this.messagesList.splice(e,1),void(this._blockedChatMsg=null);this.conversation.isBlocked&&(this._blockedChatMsg=new p.default(!0),this._blockedChatMsg.type=d.MessageType.SystemMessage,this._blockedChatMsg.content=c.default.instance.i18n.fetch("area_text_disabled"),this.messagesList.push(this._blockedChatMsg))},t.prototype._addBotGreetingMessage=function(){var e=this;this.conversation.isAgent()&&(void 0!==this.conversation.isNew?this.conversation.isNew&&this.person&&(this.person.description&&this.addMessage(this.person.description),this.person.subscribe("description",function(t){e.addMessage(t)})):this.conversation.subscribe("isNew",function(t){e._addBotGreetingMessage()}))},t.prototype.adjustAuthorInfo=function(e,t){var n;e>0?n=this.messagesList()[e-1]:(n=this.messagesList()[e],e++);for(var i=e;i<t;i++){var r=this.messagesList()[i];if(!n)return;var o=r.timestamp.getTime()-n.timestamp.getTime();r.isFirst=r.senderId!==n.senderId||o>12e4,n=r}},t.prototype._updateUnreadSplitter=function(e){if(void 0===e&&(e=!1),!this._unreadSplitter){var t=new p.default(!1);t.content=c.default.instance.i18n.fetch("unread_messages"),t.type=d.MessageType.UnreadSplitter,this._unreadSplitter=t}e&&this.messagesList.remove(this._unreadSplitter);var n=this.messagesList();if(!e){var i=this.messagesList.indexOf(this._unreadSplitter);if(this._shouldRemoveSplitter(n,i))return void this.messagesList.remove(this._unreadSplitter);if(i>-1)return}var r=this._getAddSplitterIndex(n);r>-1&&this.messagesList.splice(r,0,this._unreadSplitter)},t.prototype._shouldRemoveSplitter=function(e,t){if(t<0)return!1;if(t===e.length-1)return!0;for(var n=!0,i=t+1;i<e.length;i++){var r=e[i];if(c.default.instance.MePersonManager.isMe(r.senderId))return!0;var o=r.type===d.MessageType.UserMessage,s=r.type===d.MessageType.SystemMessage;(o||s)&&(n=n&&r.isDeleted)}return n},t.prototype._getAddSplitterIndex=function(e){for(var t=this.conversation.consumptionHorizon,n=e.length-1,i=0;i<e.length;i++){var r=e[i];t.lastReadMessageId===r.key&&(n=i)}var o=!1;for(i=n+1;i<e.length;i++){var s=(r=e[i]).type===d.MessageType.UserMessage,a=r.type===d.MessageType.SystemMessage;!s&&!a||r.isDeleted||(o=!0),c.default.instance.MePersonManager.isMe(r.senderId)&&(o=!1)}return o?n+1:-1},t.initTelemetrySent=!1,t}(n(463).default);t.default=w},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),r=n(9),o=n(4),s=n(1),a=n(121),c=n(0),l=n(28),u=n(243),d=n(82),p={id:"smile",shortcut:":)",descriptionUpperCase:"SMILE"},h={click:"click"},f="expressionPicker",g="expressionPickerBtn",m="",v=200,_=function(){function e(e,t,n){var _=this;this._params=e,this.element=t,this.chatConfig=n,this.activePreviewItem=ko.observable(),this.searchPlaceholderText=s.default.instance.i18n.fetch("search"),this.searchQuery=ko.observable(m),this.closePickerText=s.default.instance.i18n.fetch("emoticon_picker_close"),this.isPendingSearchResult=!1,this.setActivePreviewItem=function(e){_.conversation.id===e.convId&&_.updatePreviewItem(e.template)},this.hideExpressionPicker=function(){_.isPickerVisible()&&(_.isPickerVisible(!1),_.clearSubscriptions())},this.hideExpressionPickerHandler=function(e){_.isActualConversation(e)&&_.hideExpressionPicker()},this.toggleExpressionPickerHandler=function(e,t){_.isActualConversation(e)&&!_.isPickerVisible()?(_.isPickerVisible(!0),_.openPickerWindow(),s.default.instance.TelemetryService.sendEvent(new a.UserActionEvent(a.UserActionType.ExpressionPicker))):t||_.isPickerVisible(!1)},this.clearSubscriptions=function(){document.body.removeEventListener(h.click,_.clickHandler,!0)},this.clickHandler=function(e){var t=e.target,n=!!l.default.getParentWithClass(t,f),i=!!l.default.getParentWithClass(t,g);n||i||_.hideExpressionPicker()},this.debounceSearchQuery=function(e){var t={query:e,convId:_.conversation.id};_.isPendingSearchResult=!0,_.searchDebounceTimeout=setTimeout(function(){c.swcWindow.swc.API.triggerEvent(o.ExpressionPickerEvents.SEARCH_QUERY_CHANGED,t),_.isPendingSearchResult=!1},v)},this.searchQueryHandler=function(e){_.isPendingSearchResult&&clearTimeout(_.searchDebounceTimeout),(e=(e||"").trim().toLowerCase())?_.debounceSearchQuery(e):c.swcWindow.swc.API.triggerEvent(o.ExpressionPickerEvents.CLEAR_SEARCH_RESULTS)},this.onKeyDown=function(e,t){var n=t.which||t.keyCode;return n===u.default.ESCAPE&&(_.searchQuery()?_.emptySearchInput():_.hideExpressionPicker()),n!==u.default.BACKSPACE||_.searchQuery()?n!==u.default.ENTER:(t.preventDefault(),!1)},this.focusSearchArea=function(){_._input.focus()},this.conversation=e.conversation,this.isPickerVisible=e.pickerVisibilityObservable,this._input=t.querySelector("input.searchInput"),s.default.instance.PesManager.getConfiguration().then(function(e){_.config=e,_.updatePreviewItem(_.config.emoticonPreviewItem)}),this.updatePreviewItem(p),c.swcWindow.swc.API.registerEvent(o.ExpressionPickerEvents.ITEM_SELECT_REQUEST,this.setActivePreviewItem),c.swcWindow.swc.API.registerEvent(o.ApiEvents.ToggleExpressionPicker,this.toggleExpressionPickerHandler),c.swcWindow.swc.API.registerEvent(o.ApiEvents.HideExpressionPicker,this.hideExpressionPickerHandler),this.setupProxy(),this.searchQuery.subscribe(function(e){return _.searchQueryHandler(e)});var y={large:!0,largeEmoticonClass:"extraLarge",title:this.activePreviewItem().description,emoticonId:this.activePreviewItem().id,isAnimated:!0,setUpdateCallback:function(e){_._emoticonUpdateCallback=e}},b=r.createElement(d.SwcEmoticon,y),w=this.element.querySelector(".ExpressionPickerItemPreview"),C=document.createDocumentFragment();i.render(b,C),w.insertBefore(C,w.firstChild)}return e.prototype.isActualConversation=function(e){return this.conversation.id===e},e.prototype.updatePreviewItem=function(e){this.activePreviewItem(e),this._emoticonUpdateCallback&&this._emoticonUpdateCallback({title:e.description,emoticonId:e.id})},e.prototype.emptySearchInput=function(){this.searchQuery(m),this.focusSearchArea()},e.prototype.hidePickerWindow=function(){this.searchQuery(m),this.hideExpressionPicker()},e.prototype.openPickerWindow=function(){document.body.addEventListener(h.click,this.clickHandler,!0),this.focusSearchArea()},e.prototype.setupProxy=function(){var e=this,t=c.swc.API,n=o.ApiEvents.conversationProxy;t.registerEvent(n.toggleEmoticonPicker,function(t){t.open?e.toggleExpressionPickerHandler(t.id,t.open):e.hideExpressionPickerHandler(t.id)})},e}();t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=n(1),o=n(34),s="e6a2194043654a10b081028546390dd8",a="c31911f4054c48e39c3139bd0f2a456e",c=function(){return function(e,t){var n=this;this._params=e,this.element=t,this.emoticonsMap={},this.showNoResults=ko.observable(!1),this.noResultsText=r.default.instance.i18n.fetch("search_no_results_found").toUpperCase(),this._searchResults=[],this._lastSearchQuery="",this.addPacksToDom=function(){var e=document.createElement("div");e.className="emoticonPacks",e.setAttribute("tabindex","-1");var t=!1;n.emoticonPacks.forEach(function(i){var r=document.createElement("div");if(r.className="packItems",r.setAttribute("data-name",i.id),r.setAttribute("aria-label",i.ariaLabel),i.title){var o=document.createElement("div");o.className="packTitle",o.innerHTML='<span class="tileName"><h4></h4></span>',o.querySelector("h4").innerText=i.title,e.appendChild(o)}i.items.forEach(function(e){var i=document.createElement("span");i.className="packItem",i.setAttribute("role","listitem");var o=document.createElement("span");o.title=e.description,o.setAttribute("aria-label",e.description||e.id),o.setAttribute("data-item-id",e.id),o.className=e.type+" "+(e.htmlClass&&e.htmlClass()||""),o.style.backgroundImage="url("+e.background+")",i.appendChild(o),e.views?e.views.push(i):e.views=[i],e.visible&&(t=!0),n.emoticonsMap[e.id]=e,r.appendChild(i)}),e.appendChild(r)}),t||n.showNoResults(!0),n._parentElement.querySelector(".ItemsPicker").appendChild(e)},this.filterEmoticonPacksOnly=function(){var e={},t=[];return n.config?(n.config.tabs&&n.config.tabs.forEach(function(t){t.sections&&t.sections.forEach(function(t){t.pack&&(e[t.pack]=t)})}),n.config.packs&&(t=n.config.packs.filter(function(t){var n=!1;if(!e[t.id])return!1;if(!t.title||t.id===s||t.id===a)return!1;t.title=t.title.toUpperCase();for(var i=0;i<t.items.length;i++)if(t.items[i].type===o.default.itemTypes.emoticon.id){n=!0;break}return n})),t):t},this.itemMatches=function(e,t){var n=[e.keywords||[],e.shortcuts||[],e.description.split(/\s/),(e.copyright||"").split(/\s/),(e.pickerTitle||"").split(/\s/),(e.transcript||"").split(/\s/)].reduce(function(e,t){return e.concat(t)},[]).filter(function(e){return void 0!==e&&""!==e&&null!==e}).map(function(e){return e.toLowerCase()});return t=t.toLowerCase(),n.find(function(e){return e.indexOf(t)>-1})},this.showAll=function(){for(var e=0;e<n.emoticonPacks.length;e++)for(var t=n.emoticonPacks[e],i=0;i<t.items.length;i++)t.items[i].views.forEach(function(e){return e.style.display=""});n._lastSearchQuery=""},this.handleSearchQuery=function(e){if(n.conversation.id===e.convId&&e.query&&e.query!==n._lastSearchQuery){n._lastSearchQuery=e.query;for(var t=0;t<n.emoticonPacks.length;t++)for(var i=n.emoticonPacks[t],r=function(t){var r=i.items[t],o=n.itemMatches(r,e.query)?"":"none";r.views.forEach(function(e){return e.style.display=o})},o=0;o<i.items.length;o++)r(o)}},this.getDataIdAttribute=function(e){return e.target?e.target.getAttribute("data-item-id"):null},this.handleMouseEvent=function(e,t){var r=n.getDataIdAttribute(t);if(r){var o=n.emoticonsMap[r];o&&o.type&&o.id&&window.swc.API.triggerEvent(i.ExpressionPickerEvents.ITEM_SELECT_REQUEST,{template:o,convId:n.conversation.id})}},this.handleClickEvent=function(e,t){var r=n.getDataIdAttribute(t);if(r){var o=n.emoticonsMap[r],s={template:o,convId:n.conversation.id};o&&o.type&&o.id&&window.swc.API.triggerEvent(i.ExpressionPickerEvents.ITEM_SEND_REQUEST,s)}},this._parentElement=t,this.conversation=e.conversation,r.default.instance.PesManager.getConfiguration().then(function(e){n.config=e,n.emoticonPacks=n.filterEmoticonPacksOnly(),n.emoticonPacks.length?n.addPacksToDom():n.showNoResults(!0)}),window.swc.API.registerEvent(i.ExpressionPickerEvents.SEARCH_QUERY_CHANGED,this.handleSearchQuery),window.swc.API.registerEvent(i.ExpressionPickerEvents.CLEAR_SEARCH_RESULTS,this.showAll)}}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=n(1),o=n(89),s=n(7),a=n(31),c=n(452),l=function(){function e(e,t){var n=this;this._params=e,this.element=t,this.addButtonText=r.default.instance.i18n.fetch("button_add_participants"),this.createButtonText=r.default.instance.i18n.fetch("button_create_new_chat"),this.addPeopleToChat=r.default.instance.i18n.fetch("conversation_add_people_to_chat"),this.participantsToText=r.default.instance.i18n.fetch("new_chat_header_to"),this.cancelText=r.default.instance.i18n.fetch("sign_in_cancel"),this.confirmNewChatText=r.default.instance.i18n.fetch("new_chat_button_confirm_selection"),this.settings={},this.selectedParticipants=ko.observableArray([]),this._selectedContactVMs=[],this.hasSelectedParticipants=function(){return n.selectedParticipants().length>0},this.addParticipant=function(e){var t=!1;if(n.selectedParticipants().forEach(function(n){n.person.id===e.person.id&&(t=!0)}),!t){var r=new c.default(e.person,n.selectedParticipantsList,n.removeParticipant);n.selectedParticipants.push(r),n._notifyParentOnParticipantChanges(),e.selected=!0,n._selectedContactVMs.push(e),window.swc.API.triggerEvent(i.ParticipantEvents.SELECTED_PARTICIPANTS_CHANGE,{id:n.correlationId}),n.scrollParticipants.recount(),n.scrollSearch.recount()}},this.removeParticipant=function(e){n.selectedParticipants.remove(e),e.containerElement.removeChild(e.participantEl);for(var t=0;t<n._selectedContactVMs.length;t++){var r=n._selectedContactVMs[t];r.person.id===e.person.id&&(r.selected=!1,n._selectedContactVMs.splice(t,1))}n._notifyParentOnParticipantChanges(),window.swc.API.triggerEvent(i.ParticipantEvents.SELECTED_PARTICIPANTS_CHANGE,{id:n.correlationId,selectedContacts:n._selectedContactVMs}),n.scrollParticipants.recount(),n.scrollSearch.recount()},this.triggerFocusToSearch=function(){window.swc.API.triggerEvent(i.SearchEvents.FOCUS_SEARCH_INPUT,n.correlationId)},this._notifyParentOnParticipantChanges=function(){n.triggerFocusToSearch(),n.addParticipantParentAction&&n.addParticipantParentAction(n.selectedParticipants().length)},this._getSelectedParticipants=function(){for(var e=[],t=n.selectedParticipants(),i=0;i<t.length;i++){var o=t[i]?t[i].person.id:null;if(!o||r.default.instance.MePersonManager.isMe(o))break;e.push({id:a.default.toFullIdentifier(o),role:s.ParticipantRole.User})}return e},this.confirmParticipantsView=function(){var e=n._getSelectedParticipants();n.confirmAction&&n.confirmAction(e),n.emptyVMData()},this.dispose=function(){n.selectedParticipants([]),n._selectedContactVMs=[]},this.emptyVMData=function(){for(n._selectedContactVMs.forEach(function(e){e.selected=!1}),n._selectedContactVMs=[],n.selectedParticipants([]);n.selectedParticipantsList.firstChild;)n.selectedParticipantsList.removeChild(n.selectedParticipantsList.firstChild);window.swc.API.triggerEvent(i.SearchEvents.EMPTY_QUERY,n.correlationId)},this.searchSettings={actionOnResult:this.addParticipant,showHeaders:!1,showCounter:!0,placeHolder:!0,showContactListAsDefault:!0,isRecentListComponent:!1,showSearchIcon:!1},this.selectedParticipantsList=t.querySelector(".addParticipants-selectedItems"),this.participantsContainer=t&&t.querySelector(".participants-scrollArea"),this.participantsViewport=this.participantsContainer&&this.participantsContainer.querySelector(".swc-scroll-viewport"),this.searchContainer=t&&t.querySelector(".search-scrollArea"),this.searchViewPort=this.searchContainer&&this.searchContainer.querySelector(".swc-scroll-viewport"),this.definition=e.definition,this.conversation=e.conversation,this.cancelAction=e.controlActions.cancel,this.confirmAction=e.controlActions.confirm,this.settings.showTitle=e.settings?e.settings.showTitle:null,this.correlationId=e.settings?e.settings.id:null,this._isNewChatControl=e.settings.isNewChatControl,this.addParticipantParentAction=e.controlActions.add,this.triggerFocusToSearch(),window.swc.API.registerEvent(i.ApiEvents.onControlClose,function(){n._isNewChatControl&&n.emptyVMData()}),this.scrollParticipants=new o.default(this.participantsContainer,this.participantsViewport),this.scrollSearch=new o.default(this.searchContainer,this.searchViewPort)}return e.prototype.cancelParticipantsView=function(){var e=this._getSelectedParticipants();this.cancelAction&&this.cancelAction(e),this.emptyVMData()},e}();t.default=l},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=n(8),a=function(e){function t(){return e.call(this,"chat_composer_action")||this}return r(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(o.TelemetryPropertyValue.Create("action",this.action||s.NA)),e.push(o.TelemetryPropertyValue.Create("participants",this.participants)),e.push(o.TelemetryPropertyValue.Create("isTopicSet",this.isTopicSet)),e.push(o.TelemetryPropertyValue.Create("ttc",this.ttc)),e},t}(s.TelemetryEvent);t.default=a;var c=function(){function e(){}return e.OK="ok",e.CANCEL="cancel",e}();t.NewChatAction=c;var l=function(){function e(){}return e.BUTTON="button",e.KEY="key",e.CLOSE="close",e}();t.NewChatActionOrigin=l},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=function(e){function t(){return e.call(this,"chat_composer_qos")||this}return r(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(o.TelemetryPropertyValue.Create("participants",this.participants)),e.push(o.TelemetryPropertyValue.Create("isTopicSet",this.isTopicSet)),e.push(o.TelemetryPropertyValue.Create("ttc",this.ttc)),e},t}(n(8).TelemetryEvent);t.default=s},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=n(77),a=n(351),c=n(123),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.confirmAddParticipants=function(e){t._mePersonId||(t._mePersonId=o.default.instance.MePersonManager.mePerson.id);var n={role:"Admin",id:o.default.instance.MePersonManager.mePerson.mri};e.push(n),a.findRecentConversationIdForMembers(e).then(function(e){c.default.startChat(e,t.definition,!1,s.default.NEWCHAT),t.closeNewChatWindow()}).catch(function(n){t._createConversation(e),t.closeNewChatWindow()})},t}return r(t,e),t}(n(468).default);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(89),o=n(7),s=n(46),a=n(452),c=function(){function e(e,t){var n=this;this._params=e,this.element=t,this.cancelText=i.default.instance.i18n.fetch("sign_in_cancel"),this.removeButtonText=i.default.instance.i18n.fetch("button_remove_participants"),this.removePeopleFromChat=i.default.instance.i18n.fetch("conversation_remove_people_to_chat"),this.removeParticipantText=i.default.instance.i18n.fetch("new_chat_button_remove_selection"),this.confirmRemovingParticipantsText=i.default.instance.i18n.fetch("new_chat_button_confirm_selection"),this.existingParticipants=ko.observableArray([]),this.canRemoveParticipants=ko.observable(!1),this.defaultAvatar="",this._setSelfParticipantPropeties=function(){var e=n.conversation.selfParticipant;e.role===o.ParticipantRole.Admin?n.canRemoveParticipants(!0):n.canRemoveParticipants(e.capabilities.indexOf(o.ParticipantCapabilities.kickMember)>-1)},this._updateAndSubscribeSelfParticipant=function(){n._setSelfParticipantPropeties(),n.conversation.selfParticipant.subscribe("role",n._setSelfParticipantPropeties),n.conversation.selfParticipant.subscribe("capabilities",n._setSelfParticipantPropeties)},this._createParticipant=function(e){return new a.default(e,n.existingParticipantsList,n.toggleAddForRemoval,n.canRemoveParticipants)},this.addExisting=function(e){var t=!1,r=e.person;if(!i.default.instance.MePersonManager.isMe(r.id)&&(n.existingParticipants().forEach(function(e){e.person.id===r.id&&(t=!0)}),!t)){var o=n._createParticipant(r);n.existingParticipants.push(o),n.scroll.recount()}},this.removeExisting=function(e){for(var t=0;t<n.existingParticipants().length;t++){var i=n.existingParticipants()[t];e.person.id===i.person.id&&(n.existingParticipants.splice(t,1),n._removeParticipantNode(i))}n.scroll.recount()},this.observeExistingParticipants=function(e,t){t.newItems?t.newItems.forEach(n.addExisting):t.oldItems&&t.oldItems.forEach(n.removeExisting)},this.toggleAddForRemoval=function(e){n.canRemoveParticipants()&&(e.selectedForRemoval(!e.selectedForRemoval()),e.participantEl&&e.participantEl.classList.toggle("selected"))},this._removeParticipantNode=function(e){e.containerElement&&e.containerElement.removeChild(e.participantEl)},this._getSelectedIds=function(){for(var e=[],t=n.existingParticipants(),i=0;i<t.length;i++){var r=t[i];r.selectedForRemoval()&&e.push(s.default.getWrappedIdWithMri(r.person))}return e},this.confirmRemovingParticipants=function(){var e=n._getSelectedIds();n.confirmAction&&n.confirmAction(e),n.unSelectAll()},this.unSelectAll=function(){n.existingParticipants().forEach(function(e){e.selectedForRemoval(!1),e.participantEl&&e.participantEl.classList.remove("selected")})},this.dispose=function(){n.existingParticipants([]),n.existingParticipantsObserver.dispose(),n.hasSelectedItems.dispose()},this.definition=e.definition,this.conversation=e.conversation,this.cancelAction=e.controlActions.cancel,this.confirmAction=e.controlActions.confirm,this.existingParticipantsObserver=this.conversation.participants.subscribe(this.observeExistingParticipants),this.hasSelectedItems=ko.computed(function(){var e=!1;return n.existingParticipants().forEach(function(t){t.selectedForRemoval()&&(e=!0)}),e}),this.conversation.isGroup&&this.conversation.subscribe("selfParticipant",this._updateAndSubscribeSelfParticipant),this.existingParticipantsList=t.querySelector(".removeParticipants-list"),this.container=t&&this.element.querySelector(".swc-scroll-wrapper"),this.viewport=t&&this.element.querySelector(".swc-scroll-viewport"),this.scroll=new r.default(this.container,this.viewport)}return e.prototype.cancelParticipantsView=function(){this.cancelAction&&this.cancelAction(),this.unSelectAll()},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(89),o=n(452),s=function(){function e(e,t){var n=this;this._params=e,this.element=t,this.cancelText=i.default.instance.i18n.fetch("sign_in_cancel"),this.showPeopleInChat=i.default.instance.i18n.fetch("conversation_show_people_in_chat"),this.existingParticipants=ko.observableArray([]),this.canRemoveParticipants=ko.observable(!1),this.defaultAvatar="",this._setSelfParticipantPropeties=function(){n.conversation.selfParticipant},this._updateAndSubscribeSelfParticipant=function(){n._setSelfParticipantPropeties(),n.conversation.selfParticipant.subscribe("role",n._setSelfParticipantPropeties),n.conversation.selfParticipant.subscribe("capabilities",n._setSelfParticipantPropeties)},this._createParticipant=function(e){return new o.default(e,n.existingParticipantsList,void 0,n.canRemoveParticipants)},this.addExisting=function(e){var t=!1,r=e.person;if(!i.default.instance.MePersonManager.isMe(r.id)&&(n.existingParticipants().forEach(function(e){e.person.id===r.id&&(t=!0)}),!t)){var o=n._createParticipant(r);n.existingParticipants.push(o),n.scroll.recount()}},this.observeExistingParticipants=function(e,t){t.newItems&&t.newItems.forEach(n.addExisting)},this.dispose=function(){n.existingParticipants([]),n.existingParticipantsObserver&&n.existingParticipantsObserver.dispose()},this.definition=e.definition,this.conversation=e.conversation,this.cancelAction=e.controlActions.cancel,this.existingParticipantsObserver=this.conversation.participants.subscribe(this.observeExistingParticipants),this.conversation.isGroup&&this.conversation.subscribe("selfParticipant",this._updateAndSubscribeSelfParticipant),this.existingParticipantsList=t.querySelector(".removeParticipants-list"),this.container=t&&this.element.querySelector(".swc-scroll-wrapper"),this.viewport=t&&this.element.querySelector(".swc-scroll-viewport"),this.scroll=new r.default(this.container,this.viewport)}return e.prototype.cancelParticipantsView=function(){this.cancelAction&&this.cancelAction()},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),r=n(9),o=n(1),s=n(34),a=n(122),c=n(82),l=n(76),u="https://"+s.default.pesCDNAuthentication.cdnServiceHost+"/pes/v1/emoticons/",d=s.default.profiles.emoticons.getSmall(),p=function(){function e(e,t,n){var u=this;this.element=n,this.reactions=ko.observableArray([]),this.showReactionsBar=ko.observable(!1),this._removeItems=function(e){e.forEach(function(e){for(var t=0;t<u.reactions().length;t++){var n=u.reactions()[t];e.key===n.id&&u.reactions().splice(t,1)}})},this._addItems=function(e){e.forEach(function(e){var t=null,n=u._pesEmoticonMap[e.key];if(n){for(var i=0;i<u.reactions().length;i++){var r=u.reactions()[i];e.key===r.id&&(t=r)}var o;t?t.users=e.users:(o=u.reactions).push.apply(o,[u._mapEmoticonToReactionItem(n,e)])}})},this._mapEmoticonToReactionItem=function(e,t){var n=e.description||e.id;return{id:e.id,url:u.getEmoticonUrl(e.id),users:t.users,title:o.default.instance.i18n.fetch("reactions_see_who_reacted_text",{key:n})}},this.getEmoticonUrl=function(e){return e?'url("'+u._getUrl(e)+'")':""},this.getUserListNames=function(e){var t="",n=null,i=[];return u.reactions().forEach(function(t){t.id===e&&(n=t)}),n&&n.users.forEach(function(e){var t=e.person.displayName||e.person.id;i.push(t)}),i.length>0&&(t=i.join("\n")),t},this._getDisplayName=function(e){var t=e.displayName||e.id;return e.id===u._mePersonId&&(t+=" "+u._reactionsYouText),t},this.showReactionPreview=function(e,t){var n=document.createElement("div");n.className="reactionPreviewWrapper";var o=document.createElement("div");o.classList.add("reactionPreviewArea");var s={large:!0,largeEmoticonClass:"extraLarge",emoticonId:e.id,title:e.title,isAnimated:!0},d=r.createElement(c.SwcEmoticon,s),p=document.createDocumentFragment();if(i.render(d,p),o.appendChild(p),n.appendChild(o),e.users&&e.users.length){var h=document.createElement("div");h.className="reactionPreviewUsers",e.users.forEach(function(e){var t=document.createElement("div");t.className="userItem";var n=document.createDocumentFragment(),o={person:e.person},s=r.createElement(l.PersonAvatar,o);i.render(s,n),t.appendChild(n);var a=document.createElement("span");a.className="name",a.innerText=u._getDisplayName(e.person),t.appendChild(a),h.appendChild(t)}),n.appendChild(h)}t.preventDefault(),t.stopPropagation(),a.default.add(t,u._messageList,n,a.BUBBLE_TYPE.REACTION_PREVIEW,a.BubblePosition.onContextMenu)},this._messageList=t,this._pesEmoticonMap=o.default.instance.PesManager.emoticonMap,this.showHighDpiClass=s.default.highDpi,this._addItems(e.emotions),this.showReactionsBar(!!this.reactions().length),this._reactionsYouText=o.default.instance.i18n.fetch("reactions_you_text"),this._mePersonId=o.default.instance.MePersonManager.mePerson.id,e.emotions.subscribe(function(e,t){t.newItems?u._addItems(t.newItems):t.oldItems&&u._removeItems(t.oldItems),u.showReactionsBar(!!u.reactions().length)})}return e.prototype._getUrl=function(e){return u+e+"/views/"+d},e}();t.default=p},function(e,t){e.exports='<div class="typingIndicator" data-bind="css: {isTyping: isTyping()}">\r\n        <div class="bubble">\r\n        </div>\r\n        <div class="bubble">\r\n        </div>\r\n        <div class="bubble">\r\n        </div>\r\n        <div>\r\n            <span data-bind="text: typingIndicator"></span>\r\n        </div>\r\n    </div>'},function(e,t){e.exports='<div class="ExpressionPickerSearch">\r\n    <span class="searchIcon">\r\n        <icon-search class="icon" data-bind="click: focusSearchArea,\r\n            attr: { title: searchPlaceholderText, \'aria-label\': searchPlaceholderText}"></icon-search>\r\n    </span>\r\n    <input class="searchInput" type="text" data-bind="\r\n            textInput: searchQuery,\r\n            event: { keydown: onKeyDown },\r\n            attr: {\r\n                placeholder: searchPlaceholderText\r\n            }" />\r\n    <button class="closeIcon" tabindex="0" data-bind="click: hidePickerWindow,\r\n            attr: { title: closePickerText, \'aria-label\': closePickerText}">\r\n        <icon-cancel class="icon"></icon-cancel>\r\n    </button>\r\n</div>\r\n\r\n<div class="ExpressionPickerItemsList">\r\n    <div class="ExpressionPickerItemPreview">\r\n        \x3c!-- emoticon is here --\x3e\r\n        <span class="description">\r\n            <h4 data-bind="text: activePreviewItem().descriptionUpperCase"></h4>\r\n        </span>\r\n        \x3c!-- ko if: activePreviewItem().shortcuts && activePreviewItem().shortcuts.length --\x3e\r\n        <span class="shortcut">\r\n            <h4 data-bind="text: activePreviewItem().shortcuts[0]"></h4>\r\n        </span>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n    <div class="ExpressionPickerItems">\r\n        <items-picker params="conversation: conversation"></items-picker>\r\n    </div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="ItemsPicker" data-bind="event: {mouseover: handleMouseEvent, click: handleClickEvent}">\r\n    \x3c!-- ko if: showNoResults --\x3e\r\n    <div class="packTitle">\r\n        <span class="emptyPack">\r\n            <h4 data-bind="text: noResultsText"></h4>\r\n        </span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'},function(e,t){e.exports='<div class="dragAndDropContainer" data-bind="event: {\r\n        click: onClicked,\r\n        dragenter: onDragEnter,\r\n        dragover: onDragOver,\r\n        dragleave: onDragLeave,\r\n        drop: onDrop\r\n     }, visible: !showAddParticipants() && !showRemoveParticipants() && !showShowParticipants()">\r\n    \x3c!-- ko if: showLoginPage --\x3e\r\n    <lwc-signin params="isSignedIn: signedIn, isConversationWithPerson: conversation.isPerson()" data-bind="css:{anim:animateLoginScreen}"></lwc-signin>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: signedIn --\x3e\r\n    \x3c!-- ko if: chatDataConfig.ShowHeader --\x3e\r\n    <div class="swc-header" data-bind="style: {background: titleBackground }">\r\n        <div class="titlebar" data-bind="css:{unread:unreadMessageCounter()>0}, style: {background: titleBackground }, click: toggleChatSize">\r\n            <div class="headerAvatar" aria-label="avatar" tabindex="0"></div>\r\n            <div class="topic">\r\n                <div class="swc-title" tabindex="0" data-bind="attr:{\'aria-label\':title}, style:{color:titleColor}, text: title"></div>\r\n                <div class="terms">\r\n                    \x3c!-- ko if: showTermsOfUse --\x3e\r\n                    <a class="termsOfUse" data-bind="attr:{href:termOfUse}, text: termOfUseText" target="_blank"></a>\r\n                    \x3c!-- /ko --\x3e\r\n\r\n                    \x3c!-- ko if: showPrivacyStatement --\x3e\r\n                    <a class="privacy" data-bind="attr:{href:privacyStatement}, text: privacyStatementText" target="_blank"></a>\r\n                    \x3c!-- /ko --\x3e\r\n                </div>\r\n            </div>\r\n            <div class="counter">\r\n                <p data-bind="text:unreadMessageCounter"></p>\r\n            </div>\r\n            \x3c!-- ko if: showDeepLinks() --\x3e\r\n            <button aria-label="open calling" data-bind="if: videoEnabled(), click: startVideoCallDeeplink" class="calling">\r\n                <icon-video></icon-video>\r\n            </button>\r\n            <button aria-label="open calling" data-bind="if: audioEnabled(), click: startAudioCallDeeplink" class="calling">\r\n                <icon-call-start></icon-call-start>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: showCalling() --\x3e\r\n            <button aria-label="open calling" data-bind="if: videoEnabled(), click: startVideoCall" class="calling">\r\n                <icon-video></icon-video>\r\n            </button>\r\n            <button aria-label="open calling" data-bind="if: audioEnabled(), click: startAudioCall" class="calling">\r\n                <icon-call-start></icon-call-start>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n\r\n             \x3c!-- ko if: chatDataConfig.CanCollapse--\x3e\r\n            <button aria-label="minimize window" data-bind="css: { collapsed: isCollapsed()}" class="minimize collapse">\r\n                <icon-maximize class="svg-icon"></icon-maximize>\r\n                <icon-minimize class="svg-icon"></icon-minimize>\r\n            </button>\r\n            \x3c!--/ko  --\x3e\r\n\r\n            \x3c!-- ko if: canClose() --\x3e\r\n            <button aria-label="close window" data-bind="click:close" class="close">\r\n                <icon-cancel class="svg-icon"></icon-cancel>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- ko if: showActionsBar() --\x3e\r\n        <div class="actionsbar">\r\n            \x3c!-- ko if: isParticipantControlEnabled() --\x3e\r\n                \x3c!-- ko if: isParticipantRemovalControlEnabled() --\x3e\r\n                    <button aria-label="open removeparticipants" data-bind="click: openRemoveParticipantsView" >\r\n                        <icon-contact class="svg-icon"></icon-contact>\r\n                        <span data-bind="text: participantsCount"></span>\r\n                    </button>\r\n                    <div class="separator"></div>\r\n                \x3c!-- /ko  --\x3e\r\n                \x3c!-- ko if: isShowParticipantsControlEnabled() --\x3e\r\n                    <button aria-label="open showparticipants" data-bind="click: openShowParticipantsView" >\r\n                        <icon-contact class="svg-icon"></icon-contact>\r\n                        <span data-bind="text: participantsCount"></span>\r\n                    </button>\r\n                    <div class="separator"></div>\r\n                \x3c!-- /ko  --\x3e\r\n                <button aria-label="open addparticipants" data-bind="click: openAddParticipantsView, visible: canAddParticipants" >\r\n                    <icon-contact-add class="svg-icon"></icon-contact-add>\r\n                </button>\r\n            \x3c!-- /ko  --\x3e\r\n            \x3c!-- ko if: showDeepLinks() --\x3e\r\n            <button aria-label="open calling" data-bind="if: videoEnabled(), click: startVideoCallDeeplink" class="calling">\r\n                <icon-video></icon-video>\r\n            </button>\r\n            <button aria-label="open calling" data-bind="if: audioEnabled(), click: startAudioCallDeeplink" class="calling">\r\n                <icon-call-start></icon-call-start>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: showCalling() && !suppressCallingControls() --\x3e\r\n            <button aria-label="open calling" data-bind="if: videoEnabled(), click: startVideoCall" class="calling video">\r\n                <icon-video></icon-video>\r\n            </button>\r\n            <button aria-label="open calling" data-bind="if: audioEnabled(), click: startAudioCall" class="calling audio">\r\n                <icon-call-start></icon-call-start>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: showOtherActions() --\x3e\r\n            <button aria-label="other actions" class="rosterMenuListBtn" data-bind="click: openMoreActions">\r\n                <icon-more></icon-more>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <messages-list role="list" aria-live="polite" class="swc-scroll-wrapper" data-bind="keyboardNavigation: { itemSelector: \'.lwx-message, .actionItem, .button, a\', selectLastItem: true }, css: {\'no-header\': !chatDataConfig.ShowHeader, \'collapsed\': isCollapsed()}"  params="conversation: conversation, userMessageSent: userMessageSent, enable: enable"></messages-list>\r\n\r\n    \x3c!-- ko if: isGuest() && !userMessageSent() --\x3e\r\n    <div class="msa-privacy">\r\n        <div data-bind="html: ms_service_privacy_agreement" class="text"></div>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: canSendEmoticons() && renderPES() --\x3e\r\n        <expression-picker params="conversation: conversation, pickerVisibilityObservable: isPickerVisible" data-bind="visible: isPickerVisible" class="expressionPicker"></expression-picker>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <chat-input params="conversation: conversation, enable: enable" data-bind="css: {collapsed: isCollapsed()}"></chat-input>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: showBrand --\x3e\r\n    <div class="skypeBrandMessage" data-bind="text:brandMessage"></div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n\r\n\x3c!-- ko if: isParticipantControlEnabled() --\x3e\r\n    <add-participants class="addParticipants" params="definition: chatDataConfig,\r\n        controlActions: {\r\n             confirm: addParticipantsToConversation,\r\n             cancel: closeAddParticipantsView\r\n        },\r\n        settings: { showTitle: true, id: correlationId },\r\n        conversation: conversation" data-bind="visible: showAddParticipants()"></add-participants>\r\n    \x3c!-- ko if: isParticipantRemovalControlEnabled() --\x3e\r\n    <remove-participants class="removeParticipants" params="definition: chatDataConfig,\r\n        controlActions: {\r\n             confirm: removeParticipantsFromConversation,\r\n             cancel: closeRemoveParticipantsView\r\n        },\r\n        conversation: conversation" data-bind="visible: showRemoveParticipants()"></remove-participants>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: isShowParticipantsControlEnabled() --\x3e\r\n    <show-participants class="removeParticipants" params="definition: chatDataConfig,\r\n        controlActions: {\r\n             cancel: closeShowParticipantsView\r\n        },\r\n        conversation: conversation" data-bind="visible: showShowParticipants()"></show-participants>\r\n    \x3c!-- /ko --\x3e\r\n\x3c!-- /ko --\x3e\r\n'},function(e,t){e.exports='<div class="swc-header newChat">\r\n    <div class="titlebar">\r\n        <div class="textField">\r\n            <input class="newChatInput swc-title" type="text" data-bind="\r\n                attr: { placeholder: isCreatingGroupChat()\r\n                ? enterGroupNameText : newChatText },\r\n                enable: isCreatingGroupChat(), css: {editable: isCreatingGroupChat()}"/>\r\n            <button class="edit" data-bind="click: focusTitleInput,\r\n                visible: isCreatingGroupChat(),\r\n                attr:{\'aria-label\': enterGroupNameText, title: enterGroupNameText}">\r\n                <icon-pencil></icon-pencil>\r\n            </button>\r\n        </div>\r\n        <button class="close" data-bind="click: cancel,\r\n            attr:{\'aria-label\': cancelText, title: cancelText}">\r\n            <icon-cancel class="svg-icon"></icon-cancel>\r\n        </button>\r\n    </div>\r\n</div>\r\n\r\n<add-participants class="addParticipants" params="definition: definition,\r\n    controlActions: {\r\n        confirm: confirmAddParticipants,\r\n        add: onSelectedParticipantsChange\r\n},\r\nsettings: { showTitle: false, isNewChatControl: true, id: correlationId}"></add-participants>\r\n'},function(e,t){e.exports='\r\n<div class="addParticipantsHeader" data-bind="visible: settings.showTitle">\r\n    <h3 class="header" data-bind="text: addPeopleToChat"></h3>\r\n    <button class="cancel" tabindex="0" data-bind="click: cancelParticipantsView,\r\n            attr: { title: cancelText, \'aria-label\': cancelText}">\r\n        <icon-cancel class="svg-icon"></icon-cancel>\r\n    </button>\r\n</div>\r\n\r\n\x3c!--<p class="-participants-to" data-bind="text: participantsToText"></p>--\x3e\r\n\r\n<div class="participants-scrollArea swc-scroll-wrapper" data-bind="visible: hasSelectedParticipants()">\r\n    <div class="addParticipants-selectedItems swc-scroll-viewport" data-bind="foreach: selectedParticipants"></div>\r\n</div>\r\n\r\n<chat-search-input class="searchInputComponent"\r\n    params="settings: searchSettings, id: correlationId, conversation: conversation"></chat-search-input>\r\n<div class="search-scrollArea swc-scroll-wrapper">\r\n        <chat-search-results class="searchResultsComponent swc-scroll-viewport"\r\n        params="settings: searchSettings, id: correlationId, conversation: conversation"></chat-search-results>\r\n</div>\r\n\r\n<div class="addParticipantsFooter" data-bind="visible: hasSelectedParticipants()">\r\n    \x3c!-- For New Chat only --\x3e\r\n    <button class="confirm create" data-bind="click: confirmParticipantsView,\r\n            text: createButtonText,\r\n            enable: hasSelectedParticipants(),\r\n            attr:{\'aria-label\': createButtonText, title: createButtonText}">\r\n    </button>\r\n    \x3c!-- For New Chat only --\x3e\r\n\r\n    \x3c!-- For Add to group conversation flow only --\x3e\r\n    <button class="confirm add" data-bind="click: confirmParticipantsView,\r\n            text: addButtonText,\r\n            enable: hasSelectedParticipants(),\r\n            attr:{\'aria-label\': addButtonText, title: addButtonText}">\r\n    </button>\r\n    \x3c!-- For Add to group conversation flow only --\x3e\r\n</div>\r\n'},function(e,t){e.exports='<div class="removeParticipantsHeader">\r\n    <h3 class="header" data-bind="text: removePeopleFromChat"></h3>\r\n    <button class="cancel" tabindex="0" data-bind="\r\n            click: cancelParticipantsView,\r\n            attr: { title: cancelText, \'aria-label\': cancelText}">\r\n        <icon-cancel class="svg-icon"></icon-cancel>\r\n    </button>\r\n</div>\r\n\r\n<div class="removeParticipants swc-scroll-wrapper">\r\n    <div class="removeParticipants-list swc-scroll-viewport"></div>\r\n</div>\r\n\r\n<div class="removeParticipantsFooter" data-bind="visible: hasSelectedItems()">\r\n    <button class="confirm" data-bind="click: confirmRemovingParticipants,\r\n            text: removeParticipantText,\r\n            enable: hasSelectedItems(),\r\n            attr:{\'aria-label\': removeParticipantText, title: removeParticipantText},\r\n            css: { \'disabled\': !hasSelectedItems() }">\r\n    </button>\r\n</div>\r\n'},function(e,t){e.exports='<div class="removeParticipantsHeader">\r\n    <h3 class="header" data-bind="text: showPeopleInChat"></h3>\r\n    <button class="cancel" tabindex="0" data-bind="\r\n            click: cancelParticipantsView,\r\n            attr: { title: cancelText, \'aria-label\': cancelText}">\r\n        <icon-cancel class="svg-icon"></icon-cancel>\r\n    </button>\r\n</div>\r\n\r\n<div class="removeParticipants swc-scroll-wrapper">\r\n    <div class="removeParticipants-list swc-scroll-viewport"></div>\r\n</div>\r\n\r\n'},function(e,t){e.exports='\r\n\x3c!-- ko if: showReactionsBar --\x3e\r\n<ul class="reactionsItems" data-bind="foreach: { data: reactions(), as: \'reaction\' }">\r\n    <li class="reactionItem" data-bind="click: $parent.showReactionPreview">\r\n        <span class="emoticon" data-bind="attr:\r\n            { title: reaction.title, \'aria-label\': reaction.title },\r\n            style: { \'background-image\' : $parent.getEmoticonUrl(reaction.id) },\r\n            css: { highDpi: $parent.showHighDpiClass }">\r\n        </span>\r\n        <span class="counter" data-bind="text: reaction.users.length"></span>\r\n    </li>\r\n</ul>\r\n\x3c!-- /ko --\x3e\r\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.getView=function(t){var n=e.views[t];if(!n){var i=document.createElement("div");i.innerHTML=e.templates[t],n=e.views[t]=i}return n.firstElementChild.cloneNode(!0)},e.views={},e.templates={skype:'\n            <div class="conversation skype-conversation" data-bind="component: {\n                name: \'conversation\',\n                params: {\n                    conversation: conversation,\n                    enable: enable\n                }\n            }"></div>\n        ',dl:'\n            <div class="conversation directline-conversation" data-bind="component: {\n                name: \'dl-conversation\',\n                params: {\n                    conversation: conversation,\n                    enable: enable\n                }\n            }"></div>\n        '},e}();t.default=i}]);