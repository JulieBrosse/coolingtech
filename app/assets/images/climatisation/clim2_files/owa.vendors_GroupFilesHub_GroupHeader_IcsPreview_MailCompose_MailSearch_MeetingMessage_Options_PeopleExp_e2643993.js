window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.vendors~GroupFilesHub~GroupHeader~IcsPreview~MailCompose~MailSearch~MeetingMessage~Options~PeopleExp~e2643993.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[3],{1379:function(e,t,n){"use strict";var r=n(369),o=n(55),i=n(883),a=n(161);function s(e,t){if(t){var n=t.displayName?t.displayName+"<"+t.smtpAddress+">":t.smtpAddress;return e?"&"+e+"="+n:n}return""}function u(e,t){return t?"&"+e+"="+t:""}function c(e){if(!e.to||!e.to.smtpAddress)return"";var t=a.parse(Object(o.a)().search.substr(1));return t.mailtolink=function(e){if(!e.to||!e.to.smtpAddress)return"";var t="mailto:"+s(null,e.to),n="";return n+=s("cc",e.cc),n+=s("bcc",e.bcc),n+=u("subject",e.subject),(n+=u("body",e.body))?t+"?"+n.slice(1):t}(e),Object(i.a)(r.e,r.b,"?"+a.stringify(t))}n.d(t,"a",function(){return c})},1441:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(369),o=n(55),i=n(883);function a(e){return e?Object(i.a)(r.e,r.f+"/"+encodeURIComponent(e),Object(o.a)().search):""}},2213:function(e,t,n){"use strict";var r=n(4),o=n(0),i=n(799),a=n(338),s=n(400);function u(e,t){var n=Object(i.a)(e.Smtp);t(n?Object(a.b)(n,s.c.regular):Object(a.a)(e.Smtp,void 0,!0))}var c=n(18),l=n(81),f=n(7),d="ows/api/beta/subscriptions/brands/{0}";function p(e,t,n){return o.__awaiter(this,void 0,void 0,function(){var e,r,i,a;return o.__generator(this,function(o){switch(o.label){case 0:f.c.info("[getBrandUnsubscribeInfo] targetBrandSatoriId: "+t),e=Object(c.format)(d,t),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,Object(l.b)(e)];case 2:return(r=o.sent())&&r.subscriptions?(i=r.subscriptions.map(function(e){var t=e.brand?e.brand.brandName:e.smtpInfo.displayName;return{smtp:e.smtpInfo.smtpAddress,smtpIdentifier:e.smtpInfo.smtpIdentifier,smtpDisplayName:t,unsubscribeSilentUri:e.unsubscribeSilentUris,unsubscribeHttpUri:e.unsubscribeHttpUris}}),n(i,void 0)):n(void 0,"Call to get brand info returned empty response"),[3,4];case 3:return a=o.sent(),f.c.info("[getBrandUnsubscribeInfo] exception from network request: "+a),n(void 0,a),[3,4];case 4:return[2]}})})}var h=n(1209);function g(e,t){return Object(h.c)(e,t),{onSuccess:h.i,onFailure:h.h}}function v(e,t){return Object(h.j)(e,t),{onSuccess:h.i,onFailure:h.h}}function b(e,t){return Object(h.e)(e,t),{onSuccess:h.i,onFailure:h.h}}function m(e,t){return Object(h.d)(e,t),{onSuccess:h.i,onFailure:h.h}}function y(e,t){return Object(h.f)(e,t),{onSuccess:h.i,onFailure:h.h}}function w(e,t){Object(h.b)(e,t)}function C(e,t){Object(h.a)(e,t)}var k=n(2961);function _(e,t){if(t&&t.profilePhotoDataUrl){var n=e.EmailAddresses&&e.EmailAddresses[0]?e.EmailAddresses[0].EmailAddress:void 0,r=e.PersonaId?e.PersonaId.Id:void 0;if(Object(k.a)(n,r),n){var o=Object(i.a)(n),u=o?Object(a.b)(o,s.c.regular):Object(a.a)(n);fetch(u,{headers:{"Cache-Control":"no-cache"},credentials:"include"})}}}var T=n(61),A="ows/api/beta/subscriptions/{0}/unsubscribe";function P(e,t,n){return o.__awaiter(this,void 0,void 0,function(){var e,r,i;return o.__generator(this,function(o){switch(o.label){case 0:if(f.c.info("[unsubscribeFromBrand] target brand smtp identifier: "+t.smtpIdentifier),e=Object(c.format)(A,t.smtpIdentifier),!(t.unsubscribeSilentUri&&t.unsubscribeSilentUri.length>0))return[3,5];r={unsubscribeSilentUris:t.unsubscribeSilentUri},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,Object(l.d)(e,r,null,!0)];case 2:return o.sent(),n(!0),[3,4];case 3:return i=o.sent(),f.c.info("[unsubscribeFromBrand] exception from network request: "+i),n(!1,i),[3,4];case 4:return[3,6];case 5:t.unsubscribeHttpUri&&t.unsubscribeHttpUri.length>0?(window.open(t.unsubscribeHttpUri[0],"_blank"),n(!0,"Opened unsubscribe URI in new tab")):n(!1,"No unsubscribe URIs provided"),o.label=6;case 6:return[2]}})})}var x=n(2492),O=n.n(x),I=n(2493),j=n.n(I),E=n(30),L=n(2401),S=n.n(L),M=n(29),F=n.n(M),R=n(178),U=n.n(R),q=n(108),D=n.n(q);function N(e){return O()({request:{Header:Object(E.getJsonRequestHeader)(),Body:(t=e,n=U()({BaseFolderId:D()({Id:"contacts"})}),r=j()({PersonaId:null,PersonTypeString:"Person",PropertyUpdates:[],ParentFolderId:n}),t&&t.length>0&&t.forEach(function(e){r.PropertyUpdates.push(S()({Path:F()({FieldURI:e.name}),OldValue:e.oldValue,NewValue:e.newValue}))}),r)}});var t,n,r}var B=n(1208),G=n(3805),z=n.n(G),V=n(3365),H=n.n(V);function W(e){return z()({getNotesForPersonaRequest:H()({PersonaId:e,MaxBytesToFetch:512e3})}).then(function(e){return e.PersonaWithNotes})}var J=n(3806),X=n.n(J),Y=n(152),$=n.n(Y),K=n(1257),Z=n.n(K);function Q(e){var t=X()({PersonaId:$()({Id:e})});return Z()({Header:Object(E.getJsonRequestHeader)(),Body:t}).then(function(e){if(e.Body&&"NoError"===e.Body.ResponseCode)return e.Body.Persona;throw new Error("GetPersona failed")})}var ee=n(8),te=n(9),ne=n(87),re=n(1251),oe=n(2962),ie=n.n(oe),ae=n(2964),se=n.n(ae);function ue(e,t){return ie()({request:{Header:Object(E.getJsonRequestHeader)(),Body:(n=e,r=t,o=se()({PersonaId:$()({Id:n}),PersonTypeString:"Person",PropertyUpdates:[]}),r&&r.length>0&&r.forEach(function(e){e.newValue!==e.oldValue&&o.PropertyUpdates.push(S()({Path:F()({FieldURI:e.name}),OldValue:e.oldValue,NewValue:e.newValue}))}),o)}});var n,r,o}var ce=n(2298),le=n(1379),fe="left=0,top=0,height=600,width=800,location=0,menubar=0,resizable=1,scrollbars=0,status=0,toolbar=0";function de(e,t){var n=e;t&&(n=n.replace("gulp&","").replace("gulp",""));var r=window.open(n||"about:blank","Deeplink",fe);r&&t&&(r.opener=null)}var pe,he=n(1441);function ge(e){var t=Object(B.a)();return pe=pe||new Promise(function(n,r){Object(ce.b)(function(e,t){var n=function(e,t){var n={readMail:ve,composeMail:(r=e,o=t,function(e,t,n,i,a){o?o(e,e):r.actionCallbacks&&r.actionCallbacks.composeMail?r.actionCallbacks.composeMail(e,t,n):de(Object(le.a)({to:{smtpAddress:e,displayName:function(e){if(e){if(e.personaDisplayName)return e.personaDisplayName;if(e.recipientDisplayName)return e.recipientDisplayName}}(i)}}),!0),window.LPC.dismissCard()}),meetingActionCallbacks:{onAcceptingMeeting:g,onTentativelyAcceptingMeeting:v,onDecliningMeeting:b,onCancelingMeeting:m,onDeletingMeeting:y,joinOnlineMeeting:w,editMeeting:C},onPersonaUpdated:_,openMeeting:me};var r,o;Object(ee.c)("rp-brandCardsUnsubscribe")&&(n.unsubscribeFromBrand=P);e.actionCallbacks&&(e.actionCallbacks.toggleFavoritePerson&&(n.toggleFavoritePerson=e.actionCallbacks.toggleFavoritePerson),e.actionCallbacks.favoritePersona&&(n.favoritePersona=e.actionCallbacks.favoritePersona),e.actionCallbacks.unfavoritePersona&&(n.unfavoritePersona=e.actionCallbacks.unfavoritePersona),e.actionCallbacks.readMail&&(n.readMail=e.actionCallbacks.readMail),e.actionCallbacks.toggleSubscribeToGroup&&(n.toggleSubscribeToGroup=e.actionCallbacks.toggleSubscribeToGroup),e.actionCallbacks.editGroup&&(n.editGroup=e.actionCallbacks.editGroup),e.actionCallbacks.addGroupMembers&&(n.addGroupMembers=e.actionCallbacks.addGroupMembers));return n}(e,t),r=function(e){var t={getAndPrefetchPersonaImageUri:u,getPersonaInfo:be};e.dataCallbacks&&e.dataCallbacks.getIsPersonFavorited&&(t.getIsPersonFavorited=e.dataCallbacks.getIsPersonFavorited);e.dataCallbacks&&e.dataCallbacks.getIsPersonaFavorited&&(t.getIsPersonaFavorited=e.dataCallbacks.getIsPersonaFavorited);Object(ee.c)("rp-brandCardsUnsubscribe")&&(t.getBrandUnsubscribeInfo=p);return t}(e),i={updateOwsPersona:ue,getOwsPersona:Q,getNotesForPersona:W,createOwsPersona:N};a=Object(ee.c)("doc-consumerUrl"),s=T.a.userConfiguration.SessionSettings.UserCulture,c=T.a.userConfiguration.SessionSettings.TenantGuid,l=Object(ne.b)(),f=Object(ee.c)("peo-lokiDogfood"),Object(ce.c)({culture:s,isConsumer:a,useDogfood:f,logger:function(e,t){Object(te.n)(e,t)},tenantId:c,clientCorrelationId:l});var a,s,c,l,f;var d=Object(ce.a)(),h=T.a.userConfiguration.UserOptions.TimeFormat,k=T.a.userConfiguration.UserOptions.DateFormat,A=h&&-1===h.indexOf("tt");return o.__assign({},d,{actionCallbacks:n,dataCallbacks:r,privateDataCallbacks:i,options:{isLinkedInIntegrationEnabled:!1,timeFormat:h,dateFormat:k,is24HourFormat:A}})}(t,e),function(){n()},function(e){r(e)})})}function ve(e){de(Object(he.a)(e),!0)}function be(e,t){"Meeting"===e.PersonaType&&Object(re.c)(e,t)}function me(e){window.LPC.dismissCard(),Object(re.d)(e)}var ye=n(148),we=n(2),Ce=n(793);function ke(e){ye.a.livePersonaCardInitializationStatus={state:e,timestamp:Date.now()},ye.a.isLivePersonaCardInitialized=e===Ce.a.Initialized}var _e=12e4,Te=new we.c(function(){return n.e(167).then(n.t.bind(null,5583,7))}),Ae=Object(r.action)("handleLivePersonaCardInitialized")(function(){ke(Ce.a.Initialized)}),Pe=Object(r.action)("handleLivePersonaCardFailedToInitialize")(function(e){ke(Ce.a.Failed),f.c.error(e)});t.a=Object(r.action)("initializeLivePersonaCard")(function(e){(ye.a.livePersonaCardInitializationStatus.state===Ce.a.NotInitialized||ye.a.livePersonaCardInitializationStatus.state===Ce.a.Failed&&Date.now()-ye.a.livePersonaCardInitializationStatus.timestamp>_e)&&(ke(Ce.a.Initializing),Te.import(),ge(e).then(Ae).catch(function(e){return Pe(e)}))})},2298:function(e,t,n){"use strict";var r=n(3807),o=n(104),i=n(213),a=!1,s=void 0,u=void 0,c=void 0,l=void 0,f=!1,d=!1,p=void 0,h="72f988bf-86f1-41af-91ab-2d7cd011db47",g="626bd560-f1d8-4cf1-a7fa-91aae03cc409";function v(e){if(a)throw new Error("initializeLoki can be called only once!");if(!e)throw new Error("Loki config object is mandatory!");u=2===Object(i.b)()?"OwaCalendar":"OwaMail",c=e.isConsumer?"OwaConsumer":"OwaEnterprise",l=e.culture,e.isConsumer,f=e.useDogfood,p=e.logger;var t=e.tenantId&&e.tenantId.toLowerCase();d=t===h||t===g,s=e.clientCorrelationId||Object(o.getGuid)(),a=!0}var b=n(0),m=n(2558),y=n.n(m),w=n(517),C=n(2559),k=n.n(C),_="94c63fef-13a3-47bc-8074-75af8c65887a";var T=void 0;function A(e,t){(function(){return b.__awaiter(this,void 0,void 0,function(){var e,t;return b.__generator(this,function(n){switch(n.label){case 0:e={Header:Object(w.getJsonRequestHeader)(),Body:k()({TokenRequests:[{__type:"TokenRequest:#Exchange",Id:_,TokenType:"Loki"}]})},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,y()(e)];case 2:return(t=n.sent())&&"Success"==t.Body.ResponseMessages.Items[0].ResponseClass?[2,t.Body.ResponseMessages.Items[0].Token.TokenValue]:[2,null];case 3:return n.sent(),[2,null];case 4:return[2]}})})})().then(function(n){var o,i=s;n?(T=o=n,Object(r.setAuthToken)(s,o),e(n,i)):t("Failed to get auth token from Loki",i)})}function P(){if(!a)throw new Error("You must call initializeLoki!");return{culture:l,region:function(e,t){if(e)return"df";if(t)return"msit";return""}(f,d),clientType:u,clientContextType:c,clientCorrelationId:s,logMessage:function(e,t,n){p(e,[t,n])},getAuthToken:A,authToken:T}}var x=n(2966);n.d(t,"a",function(){return P}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return v}),n.d(t,"b",function(){return x.initializeLivePersonaCard})},2401:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"PersonaPropertyUpdate:#Exchange"},e)}},2492:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),o=n(2649);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=o.default(e.request)),r.makeServiceRequest("CreatePersona",e,t)}},2493:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CreatePersonaRequest:#Exchange"},e)}},2558:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),o=n(2650);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetClientAccessToken",e,t)}},2559:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetClientAccessTokenRequest:#Exchange"},e)}},2649:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CreatePersonaJsonRequest:#Exchange"},e)}},2650:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetClientAccessTokenJsonRequest:#Exchange"},e)}},2961:function(e,t,n){"use strict";var r=n(4),o=n(148),i=n(805);t.a=Object(r.action)("refreshPersonaPhoto")(function(e,t){o.a.viewStates.forEach(function(n){(e&&n.emailAddress===e||t&&n.personaId===t)&&Object(i.a)(n,!0)})})},2962:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),o=n(2963);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=o.default(e.request)),r.makeServiceRequest("UpdatePersona",e,t)}},2963:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdatePersonaJsonRequest:#Exchange"},e)}},2964:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdatePersonaRequest:#Exchange"},e)}},2965:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3808);t.isLokiEndpoint=r.isLokiEndpoint;var o=n(3809);t.Base64=o;var i=n(3810);t.Functional=i;var a=n(3811);t.StorageUtils=a;var s=n(3367);t.StringUtils=s;var u=n(3814);t.getUrlParameter=u.getUrlParameter},2966:function(e,t,n){
/*! Version: 1.5.2; Third Party Notices: https://go.microsoft.com/fwlink/?linkid=855968 */
e.exports=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=22)}([function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e,t,n,r,o){this.type=e,this.message=t,this.rootCorrelationId=n,this.statusCode=r,this.numberOfRetries=o}},function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r,o=n(3),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(i=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,o=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],o=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,o,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},s=n(20),u=function(){function e(e){this.bootstrapperConfig=e,this.ariaCdnUrl="https://res.delve.office.com/lpc/versionless/aria-webjs-sdk-1.6.0.min.js",this.logManager=void 0,this.loggers=new Map}return e.getOrCreate=function(t){return r||(r=new e(t)),r},e.prototype.logEventAsync=function(e,t){return i(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n.sent().logEvent(e),[4,this.getLogManagerAsync()];case 2:return n.sent().flush(this.noOp),[3,4];case 3:return n.sent(),[3,4];case 4:return[2]}})})},e.prototype.updateContextWithLokiDataAsync=function(e,t){return i(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(n=r.sent()).setContext("LokiUrl",e.LokiUrl),n.setContext("tenantAadObjectId",e.TenantAadObjectId),n.setContext("userAadObjectId",e.UserAadObjectId),n.setContext("userPuid",e.UserPuid),[2,n];case 2:throw r.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}})})},e.prototype.getLoggerAsync=function(e){return i(this,void 0,void 0,function(){var t,n;return a(this,function(r){switch(r.label){case 0:return(t=this.loggers.get(e))?[3,2]:[4,this.getLogManagerAsync()];case 1:n=r.sent(),t=n.getLogger(e),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion",s),r.label=2;case 2:return[2,t]}})})},e.prototype.getLogManagerAsync=function(){return i(this,void 0,void 0,function(){var e,t;return a(this,function(n){switch(n.label){case 0:return e=this,(t=this.logManager||this.bootstrapperConfig.awtLogManager||window.AWTLogManager)?[3,2]:[4,this.getLogManagerFromCdnAsync()];case 1:t=n.sent(),n.label=2;case 2:return e.logManager=t,[2,this.logManager]}})})},e.prototype.getLogManagerFromCdnAsync=function(){return i(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,n.i(o.a)(this.ariaCdnUrl)];case 1:return t.sent(),window.AWTLogManager.initialize(e.AriaLPCBootstrapperTenantToken),[2,window.AWTLogManager]}})})},e.prototype.noOp=function(){},e}();u.AriaLPCBootstrapperTenantToken="e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257"},function(e,t,n){"use strict";t.a=function(e,t){return new Promise(function(i,s){e?(n.i(r.a)(a,e),i(e)):t(function(e,t){e?(n.i(r.a)(a,e),i(e)):s(new o.a("GetAuthTokenError","Auth token is undefined",t))},function(e,t){s(new o.a("GetAuthTokenError",e,t))})})},t.b=function(e){if(!e)throw Error("Empty AuthToken");var t=i(e);return{tenantId:t.tid,userAadId:t.oid,userPuid:t.puid,expirationTimeEpoch:t.exp}};var r=n(16),o=n(0),i=n(8),a=(n.n(i),"LokiAuthToken")},function(e,t,n){"use strict";t.a=function e(t){return o(this,void 0,void 0,function(){var n;return i(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,6]),[4,function(e){return new Promise(function(t,n){var o=document.createElement("script");o.type="text/javascript",o.crossOrigin="anonymous",o.src=e,o.addEventListener("load",function(){t()}),o.addEventListener("error",function(){n(new r.a("LoadScriptError","Unexpected error while loading script on page."))}),document.body.appendChild(o)})}(t)];case 1:return o.sent(),[3,6];case 2:return n=o.sent(),s<a?(s++,[4,e(t)]):[3,4];case 3:return o.sent(),[3,5];case 4:throw n.numberOfRetries=s,n;case 5:return[3,6];case 6:return[2]}})})};var r=n(0),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(i=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,o=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],o=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,o,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},a=2,s=0},function(e,t,n){"use strict";function r(e){var t={};return Object.keys(e).forEach(function(n){t["Perf_"+n]=e[n].toString()}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.initializeLivePersonaCard=function(e,t,o){if(!h&&p)return p;var v=f.a.getOrCreate(e);return h=!1,(p=new Promise(function(p,h){try{var g,b,m=new l.a;n.i(c.a)(e).then(function(){return n.i(a.a)(e.authToken,e.getAuthToken)}).then(function(t){return m.measureFromStart(l.b.getAuthToken),b=n.i(a.b)(t),e.tenantAadObjectId=b.tenantId,e.userAadObjectId=b.userAadId,e.userPuid=b.userPuid,n.i(i.a)(t,e)}).then(function(e){return m.measureFromStart(l.b.getLokiConfig),g=e,v.updateContextWithLokiDataAsync(g,f.a.AriaLPCBootstrapperTenantToken).catch(function(){})}).then(function(){return n.i(u.a)(g)}).then(function(){return m.measureFromStart(l.b.getLpcBundles),n.i(s.a)(g,e,m)}).then(function(){var e=r(m.getAllTimings());e.RootCorrelationId=g.RootCorrelationId,v.logEventAsync({name:"initializeLivePersonaCard_success",properties:e},f.a.AriaLPCBootstrapperTenantToken),t&&t(),p()}).catch(function(e){var t=r(m.getAllTimings());v.logEventAsync({name:"initializeLivePersonaCard_failure",properties:d({},function(e){return{ErrorType:e.type,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}(e),t)},f.a.AriaLPCBootstrapperTenantToken),o&&o("Failed to initialize Live Persona Card: "+e.type),h("Failed to initialize Live Persona Card: "+e.type)})}catch(e){v.logEventAsync({name:"initializeLivePersonaCard_failure",properties:{IsCatastrophic:!0,Reason:e.toString()}},f.a.AriaLPCBootstrapperTenantToken),o&&o("Failed to initialize Live Persona Card: "+e.name+" "+e.message),h("Failed to initialize Live Persona Card: "+e.name+" "+e.message)}})).catch(function(){setTimeout(function(){h=!0},g)}),p},t.fetchLokiConfig=function(e){return n.i(a.a)(e.authToken,e.getAuthToken).then(function(t){return n.i(i.a)(t,e)})};var o=n(5),i=(n.n(o),n(10)),a=n(2),s=n(12),u=n(11),c=n(18),l=n(15),f=n(1),d=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};n.i(o.polyfill)();var p,h=!1,g=3e5},function(e,t,n){(function(t,r){e.exports=function(){"use strict";function e(e){return"function"==typeof e}function o(){var e=setTimeout;return function(){return e(i,1)}}function i(){for(var e=0;e<x;e+=2)(0,R[e])(R[e+1]),R[e]=void 0,R[e+1]=void 0;x=0}function a(e,t){var n=arguments,r=this,o=new this.constructor(u);void 0===o[q]&&y(o);var i,a=r._state;return a?(i=n[a-1],j(function(){return m(a,o,i,r._result)})):g(r,o,e,t),o}function s(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(u);return f(t,e),t}function u(){}function c(e){try{return e.then}catch(e){return G.error=e,G}}function l(t,n,r){var o,i,u,c;n.constructor===t.constructor&&r===a&&n.constructor.resolve===s?(u=t,(c=n)._state===N?p(u,c._result):c._state===B?h(u,c._result):g(c,void 0,function(e){return f(u,e)},function(e){return h(u,e)})):r===G?(h(t,G.error),G.error=null):void 0===r?p(t,n):e(r)?(o=n,i=r,j(function(e){var t=!1,n=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(i,o,function(n){t||(t=!0,o!==n?f(e,n):p(e,n))},function(n){t||(t=!0,h(e,n))},e._label);!t&&n&&(t=!0,h(e,n))},t)):p(t,n)}function f(e,t){var n;e===t?h(e,new TypeError("You cannot resolve a promise with itself")):"function"==typeof(n=t)||"object"==typeof n&&null!==n?l(e,t,c(t)):p(e,t)}function d(e){e._onerror&&e._onerror(e._result),v(e)}function p(e,t){e._state===D&&(e._result=t,e._state=N,0!==e._subscribers.length&&j(v,e))}function h(e,t){e._state===D&&(e._state=B,e._result=t,j(d,e))}function g(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+N]=n,o[i+B]=r,0===i&&e._state&&j(v,e)}function v(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,a=0;a<t.length;a+=3)r=t[a],o=t[a+n],r?m(n,r,o,i):o(i);e._subscribers.length=0}}function b(){this.error=null}function m(t,n,r,o){var i=e(r),a=void 0,s=void 0,u=void 0,c=void 0;if(i){if((a=function(e,t){try{return e(t)}catch(e){return z.error=e,z}}(r,o))===z?(c=!0,s=a.error,a.error=null):u=!0,n===a)return void h(n,new TypeError("A promises callback cannot return that same promise."))}else a=o,u=!0;n._state!==D||(i&&u?f(n,a):c?h(n,s):t===N?p(n,a):t===B&&h(n,a))}function y(e){e[q]=V++,e._state=void 0,e._result=void 0,e._subscribers=[]}function w(e,t){this._instanceConstructor=e,this.promise=new e(u),this.promise[q]||y(this.promise),P(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?p(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&p(this.promise,this._result))):h(this.promise,new Error("Array Methods must be provided an Array"))}function C(e){this[q]=V++,this._result=this._state=void 0,this._subscribers=[],u!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof C?function(e,t){try{t(function(t){f(e,t)},function(t){h(e,t)})}catch(t){h(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}var k,_,T,A,P=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},x=0,O=void 0,I=void 0,j=function(e,t){R[x]=e,R[x+1]=t,2===(x+=2)&&(I?I(i):U())},E="undefined"!=typeof window?window:void 0,L=E||{},S=L.MutationObserver||L.WebKitMutationObserver,M="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),F="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,R=new Array(1e3),U=void 0;U=M?function(){return t.nextTick(i)}:S?(_=0,T=new S(i),A=document.createTextNode(""),T.observe(A,{characterData:!0}),function(){A.data=_=++_%2}):F?((k=new MessageChannel).port1.onmessage=i,function(){return k.port2.postMessage(0)}):void 0===E?function(){try{var e=n(21);return void 0!==(O=e.runOnLoop||e.runOnContext)?function(){O(i)}:o()}catch(e){return o()}}():o();var q=Math.random().toString(36).substring(16),D=void 0,N=1,B=2,G=new b,z=new b,V=0;return w.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===D&&n<e;n++)this._eachEntry(t[n],n)},w.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===s){var o=c(e);if(o===a&&e._state!==D)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===C){var i=new n(u);l(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},w.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===D&&(this._remaining--,e===B?h(r,n):this._result[t]=n),0===this._remaining&&p(r,this._result)},w.prototype._willSettleAt=function(e,t){var n=this;g(e,void 0,function(e){return n._settledAt(N,t,e)},function(e){return n._settledAt(B,t,e)})},C.all=function(e){return new w(this,e).promise},C.race=function(e){var t=this;return new t(P(e)?function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)}:function(e,t){return t(new TypeError("You must pass an array to race."))})},C.resolve=s,C.reject=function(e){var t=new this(u);return h(t,e),t},C._setScheduler=function(e){I=e},C._setAsap=function(e){j=e},C._asap=j,C.prototype={constructor:C,then:a,catch:function(e){return this.then(null,e)}},C.polyfill=function(){var e=void 0;if(void 0!==r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=C},C.Promise=C,C}()}).call(t,n(9),n(19))},function(e,t){function n(e){this.message=e}var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=new Error,n.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var o,i,a=0,s=0,u="";i=t.charAt(s++);~i&&(o=a%4?64*o+i:i,a++%4)?u+=String.fromCharCode(255&o>>(-2*a&6)):0)i=r.indexOf(i);return u}},function(e,t,n){var r=n(6);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return decodeURIComponent(r(t).replace(/(.)/g,function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}catch(e){return r(t)}}},function(e,t,n){"use strict";function r(e){this.message=e}var o=n(7);r.prototype=new Error,r.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new r("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(o(e.split(".")[n]))}catch(e){throw new r("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=r},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function i(){h&&d&&(h=!1,d.length?p=d.concat(p):g=-1,p.length&&a())}function a(){if(!h){var e=o(i);h=!0;for(var t=p.length;t;){for(d=p,p=[];++g<t;)d&&d[g].run();g=-1,t=p.length}d=null,h=!1,function(e){if(l===clearTimeout)return clearTimeout(e);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}(e)}}function s(e,t){this.fun=e,this.array=t}function u(){}var c,l,f=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(e){c=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(e){l=r}}();var d,p=[],h=!1,g=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new s(e,t)),1!==p.length||h||o(a)},s.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=u,f.addListener=u,f.once=u,f.off=u,f.removeListener=u,f.removeAllListeners=u,f.emit=u,f.prependListener=u,f.prependOnceListener=u,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(e,t,n){"use strict";function r(e,t){return new Promise(function(r,s){var u=new XMLHttpRequest,c=function(e){var t=n.i(o.a)(h)||e.culture;return"ppe"===e.region||"df"===e.region||"msit"===e.region?l.replace("{0}",e.region).replace("{1}",e.clientType).replace("{2}",t):f.replace("{0}",e.clientType).replace("{1}",t)}(t);u.open("GET",c,!0),u.setRequestHeader("authToken",e),u.setRequestHeader("Accept","application/json");var g=n.i(i.a)();u.setRequestHeader("X-RootCorrelationId",g),u.setRequestHeader("X-CorrelationId",g),u.setRequestHeader("X-ClientCorrelationId",t.clientCorrelationId),u.setRequestHeader("X-ClientType",t.clientType);var v=n.i(o.a)(p);v&&u.setRequestHeader(p,v),u.addEventListener("load",function(){if(200===u.status)try{var e=JSON.parse(u.response);e.RootCorrelationId=g,e.LokiVersion=u.getResponseHeader("x-serverversion")||"",r(e)}catch(e){s(new a.a("GetLokiConfigError","Failed to parse initialization config.",g))}else s(new a.a("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+u.status,g,u.status))}),u.addEventListener("error",function(){s(new a.a("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",g))}),u.addEventListener("timeout",function(){s(new a.a("GetLokiConfigError","Loki config request timed out after "+d+" ms.",g))}),u.timeout=d,u.send()})}t.a=function e(t,o){return u(this,void 0,void 0,function(){var i,a;return c(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,8]),[4,r(t,o)];case 1:return i=u.sent(),[3,8];case 2:return(a=u.sent()).statusCode&&401===a.statusCode?[4,n.i(s.a)(void 0,o.getAuthToken)]:[3,4];case 3:t=u.sent(),u.label=4;case 4:return v<g?(v++,[4,e(t,o)]):[3,6];case 5:return i=u.sent(),[3,7];case 6:throw a.numberOfRetries=v,a;case 7:return[3,8];case 8:return[2,i]}})})};var o=n(14),i=n(13),a=n(0),s=n(2),u=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(i=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,o=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],o=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,o,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},l="https://{0}.loki.delve.office.com/api/v1/configuration/{1}/{2}",f="https://loki.delve.office.com/api/v1/configuration/{0}/{1}",d=6e4,p="LivePersonaCardVersionOverride",h="LivePersonaCardCultureOverride",g=2,v=0},function(e,t,n){"use strict";t.a=function(e){var t,s=e.Resources[a];return t="OwaPeopleHub"===e.Workload?e.Resources[i]:e.Resources[o],Promise.all([n.i(r.a)(s),n.i(r.a)(t)])};var r=n(3),o="livepersonacard_with-react",i="livepersonacard_without-react",a="livepersonacardstrings"},function(e,t,n){"use strict";t.a=function(e,t,n){return new Promise(function(i,a){setTimeout(function(){window.LPC||a(new r.a("StartLivePersonaCardError","window.LPC is undefined.")),window.LivePersonaCardStrings&&window.LivePersonaCardStrings.strings||a(new r.a("StartLivePersonaCardError","window.LivePersonaCardStrings is undefined."));try{var s=function(e,t,n){return{refreshAuthToken:function(e){return function(t){e.getAuthToken(function(e,n){t(e,"",n)},function(e,n){t("",e,n)})}}(t),logToExternalApplication:t.logMessage,logToExternalAria:function(e,n){o.a.getOrCreate(t).logEventAsync(e,n)},contextType:t.clientContextType,strings:window.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId,activeFlights:e.Flights,performanceTimings:n.getAllTimings(),isDebug:!1,region:t.region,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,privateActionCallbacks:t.privateActionCallbacks,options:t.options?t.options:{isLinkedInIntegrationEnabled:!1,hideDocumentFilter:!1},lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:t.tenantAadObjectId,userAadObjectId:t.userAadObjectId,userPuid:t.userPuid}}(e,t,n);window.LPC.start(s),i()}catch(e){a(new r.a("StartLivePersonaCardError",e.name+" "+e.message))}},0)})};var r=n(0),o=n(1)},function(e,t,n){"use strict";t.a=function(){return r.replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)})};var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx"},function(e,t,n){"use strict";t.a=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}},function(e,t,n){"use strict";var r,o;n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i}),(o=r||(r={})).getAuthToken="GetAuthTokenFromStartDuration",o.getLokiConfig="GetLokiConfigFromStartDuration",o.getLpcBundles="GetLpcBundlesFromStartDuration";var i=function(){function e(){this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.getAllTimings=function(){var e=this;if(window.performance&&"function"==typeof window.performance.getEntriesByType){var t=window.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=!1;-1!==n.indexOf("authtoken/loki")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacard_")?(n="LpcBundleRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?(n="LpcStringsRequestDuration",r=!0):-1!==n.indexOf("/api/v1/configuration/")&&(n="InitConfigRequestDuration",r=!0),r&&(e.timings[n]=Math.round(t.duration))}})}return this.timings},e.prototype.getCurrentTime=function(){return window.performance&&"function"==typeof window.performance.now?performance.now():Date.now()},e}()},function(e,t,n){"use strict";t.a=function(e,t){try{sessionStorage&&sessionStorage.setItem&&sessionStorage.setItem(e,t)}catch(e){}}},function(e,t,n){"use strict";t.a=function(e){return void 0===e||"string"!=typeof e||""===e||null===e},t.b=function(e){return void 0===e||"function"!=typeof e}},function(e,t,n){"use strict";t.a=function(e){return new Promise(function(t,a){var s=function(e){var t="";if(e){var o=[];n.i(r.a)(e.culture)&&o.push("culture"),n.i(r.a)(e.clientType)&&o.push("clientType"),n.i(r.a)(e.clientContextType)&&o.push("clientContextType"),n.i(r.a)(e.clientCorrelationId)&&o.push("clientCorrelationId"),n.i(r.b)(e.logMessage)&&o.push("logMessage"),n.i(r.b)(e.getAuthToken)&&o.push("getAuthToken"),o.length>0&&(t="Invalid required parameter(s): "+o.join(", ")+". Check the values and types you're passing."),e.region&&-1===i.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+i.join(", ")+" for pre-production environments.")}else t="Config must be defined.";return t}(e);s?a(new o.a("ValidateBootstrapperConfigError",s)):t()})};var r=n(17),o=n(0),i=["msit","df","ppe"]},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports="1.5.2"},function(e,t){},function(e,t,n){e.exports=n(4)}])},3365:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetNotesForPersonaRequest:#Exchange"},e)}},3366:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2965),o=n(2965),i="AuthTokenParseError",a=function(){function e(e,t,n){this.value=e,this.scopeName=t,this.logger=n}return e.prototype.isValid=function(){if(!this.value)return!1;var e=this.extractAuthTokenExpiration();return e<=0?(this.logger&&this.logger.logError("InvalidTokenExpirationValue",this.scopeName,{expiryTime:e.toString()}),!1):!(Date.now()>1e3*e-3e5)||(this.logger&&this.logger.logEvent("CachedTokenExpired",this.scopeName),!1)},e.prototype.getValue=function(){return this.value},e.prototype.refresh=function(e){var t=this;return new Promise(function(n,o){var i=window.setTimeout(function(){o("GetAuthTokenTimeout")},1e4);e(function(e,a,s){window.clearTimeout(i),r.StringUtils.isNullOrEmpty(a)?(t.value=e,n(t)):o("Couldn't retrieve token! authRequestCorrelationId: "+s)})})},e.prototype.getLoggableProps=function(){var e=1e3*this.extractAuthTokenExpiration();return{expirationTime:e,expiresIn:e-Date.now()}},e.prototype.getLoggablePropsAsString=function(){return JSON.stringify(this.getLoggableProps())},e.prototype.getTokenLifetimeBuffer=function(){return 3e5},e.prototype.extractAuthTokenOid=function(){var e=this.extractPayload();return e?e.oid:""},e.prototype.extractAuthTokenExpiration=function(){var e=this.extractPayload();return e?e.exp:0},e.prototype.extractPayload=function(){if(!this.value)return null;var e=this.value.split(".");if(3!==e.length)return this.logger&&this.logger.logError(i,this.scopeName,{partsCount:e.length.toString()}),null;try{return JSON.parse(o.Base64.decode(e[1]))}catch(e){return this.logger&&this.logger.logError(i,this.scopeName,{error:e}),null}},e}();t.AuthToken=a},3367:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="",o="00000000-0000-0000-0000-000000000000",i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function a(e){return null===e||void 0===e||e===r}t.isNullOrEmpty=a,t.isNullOrWhitespace=function(e){return null===e||void 0===e||e.trim()===r},t.isGuidNullOrEmpty=function(e){return a(e)||e===o};var s=/(?:[\u3400-\u9FFF\uF900-\uFAFF]|[\uD840-\uD868][\uDC00-\uDFFF]|\uD869[\uDC00-\uDEDF]|\uD87E[\uDC00-\uDE1F])/;t.isCJK=function(e){return s.test(e)},t.generateGuid=function(){return i.replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)})},t.createCommaDelimitedParamStringFromObject=function(e){if("[object Object]"!==Object.prototype.toString.call(e))throw new TypeError("Param data must be a valid object");for(var t=[],n=0,r=Object.keys(e);n<r.length;n++){var o=r[n];t.push(o+"="+e[o])}return t.join(",")},t.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!e)return r;if(null!=t&&t.length>0)for(var o=0;o<t.length;o++){var i=t[o],a=null===i||void 0===i?r:i.toString(),s=new RegExp("\\{"+o+"\\}","g");e=e.replace(s,a)}return e},t.toUTF8=function(e){return unescape&&encodeURIComponent?unescape(encodeURIComponent(e)):e},t.fromUTF8=function(e){return decodeURIComponent&&escape?decodeURIComponent(escape(e)):e}},3368:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2965),o=r.StorageUtils.getItem,i=r.StorageUtils.setItem,a=r.StorageUtils.removeItem,s="LokiAuthToken";t.setAuthTokenOnUrl=function(e,t){return t&&r.isLokiEndpoint(e)?e+(e.indexOf("?")>-1?"&":"?")+"AuthToken="+t:e},t.getAuthToken=function(e){return o(s,e||"")||""},t.setAuthToken=function(e,t){t&&i(s,t,e||"")},t.clearAuthToken=function(e){a(s,e||"")},t.removeAuthTokenFromUrl=function(e){return e?e.replace(/AuthToken=[\w-.]*[&$]?/,""):e}},369:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"h",function(){return s}),n.d(t,"g",function(){return u}),n.d(t,"f",function(){return c}),n.d(t,"d",function(){return l}),n.d(t,"e",function(){return f}),n.d(t,"a",function(){return d});var r=n(0),o=n(210),i="deeplink",a="compose",s="reply",u="replyall",c="read",l="group",f="/"+r.__spread(["mail"],Object(o.a)().split("/").slice(1)).join("/")+i+"/",d="/"+r.__spread(["calendar"],Object(o.a)().split("/").slice(1)).join("/")+i+"/"},3805:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),o=n(3365);t.default=function(e,t){return void 0===e.getNotesForPersonaRequest||e.getNotesForPersonaRequest.__type||(e.getNotesForPersonaRequest=o.default(e.getNotesForPersonaRequest)),r.makeServiceRequest("GetNotesForPersona",e,t)}},3806:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetPersonaRequest:#Exchange"},e)}},3807:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3366);t.AuthToken=r.AuthToken;var o=n(3815);t.AuthTokenProvider=o.AuthTokenProvider;var i=n(3368);t.getAuthToken=i.getAuthToken,t.setAuthToken=i.setAuthToken,t.setAuthTokenOnUrl=i.setAuthTokenOnUrl,t.clearAuthToken=i.clearAuthToken,t.removeAuthTokenFromUrl=i.removeAuthTokenFromUrl},3808:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3367);t.isLokiEndpoint=function(e){return!r.isNullOrEmpty(e)&&new RegExp("^https://.+.loki.delve.office.com/.*","i").test(e)}},3809:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=/<%= spaceCharacters %>/g;function i(e){throw new Error(e).name="InvalidCharacterError",new Error(e)}t.decode=function(e){var t=(e=String(e).replace(o,"")).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^+a-zA-Z0-9/]/.test(e))&&i("Invalid character: the string to be decoded is not correctly encoded.");for(var n,a=0,s=0,u="",c=-1;++c<t;)n=r.indexOf(e.charAt(c)),s=a%4?64*s+n:n,a++%4&&(u+=String.fromCharCode(255&s>>(-2*a&6)));return u},t.encode=function(e){e=String(e),/[^\0-\xFF]/.test(e)&&i("The string to be encoded contains characters outside of the 'Latin1 range.");for(var t,n=e.length%3,o="",a=-1,s=e.length-n;++a<s;)t=(e.charCodeAt(a)<<16)+(e.charCodeAt(++a)<<8)+e.charCodeAt(++a),o+=r.charAt(t>>18&63)+r.charAt(t>>12&63)+r.charAt(t>>6&63)+r.charAt(63&t);return 2===n?(t=(e.charCodeAt(a)<<8)+e.charCodeAt(++a),o+=r.charAt(t>>10)+r.charAt(t>>4&63)+r.charAt(t<<2&63)+"="):1===n&&(t=e.charCodeAt(a),o+=r.charAt(t>>2)+r.charAt(t<<4&63)+"=="),o}},3810:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filterOutNull=function(e){return e.filter(function(e){return null!==e&&void 0!==e})},t.omitEmpty=function(e){return function(e,t){if(void 0===e||null===e)return e;for(var n={},r=0,o=Object.keys(e);r<o.length;r++){var i=o[r];t(e[i])&&(n[i]=e[i])}return n}(e,function(e){return void 0!==e&&null!==e&&""!==e&&(!(e instanceof Array)||e.length>0)})},t.updateWith=function(e,t){return Object.assign({},e,t)}},3811:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3812),o=n(3813);t.clear=function(e){r.clear(e),o.clear()},t.setItem=function(e,t,n){r.setItem(e,t,n),o.setItem(e,t)},t.getItem=function(e,t){var n=o.getItem(e);return void 0!==n?n:r.getItem(e,t)},t.removeItem=function(e,t){r.removeItem(e,t),o.removeItem(e)}},3812:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new Map;t.clear=function(e){r.delete(e)},t.setItem=function(e,t,n){var o=r.get(n)||new Map;o.set(e,t),r.set(n,o)},t.getItem=function(e,t){var n=r.get(t);return n?n.get(e):void 0},t.removeItem=function(e,t){var n=r.get(t);n&&n.delete(e)}},3813:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clear=function(){if(window.sessionStorage)try{window.sessionStorage.clear()}catch(e){}},t.setItem=function(e,t){if(window.sessionStorage)try{window.sessionStorage.setItem(e,t)}catch(e){}},t.getItem=function(e){if(window.sessionStorage)try{var t=window.sessionStorage.getItem(e);return null===t?void 0:t}catch(e){}},t.removeItem=function(e){if(window.sessionStorage)try{window.sessionStorage.removeItem(e)}catch(e){}}},3814:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUrlParameter=function(e,t){void 0===t&&(t=window.location.search);var n=t.substr(1).split("&").map(function(e){return e.split("=").map(function(e){return decodeURIComponent(e)})}).filter(function(t){return t[0]===e});return n[0]&&n[0][1]}},3815:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3366),o=n(3368),i=function(){function e(e,t,n,o,i,a){void 0===i&&(i=r.AuthToken),void 0===a&&(a="RESTAuthToken"),this.getAppId=e,this.refreshAuthToken=t,this.logger=n,this.runWithLogMonitor=o,this.authTokenType=i,this.loggingFeature=a,this.getAuthToken()}return e.prototype.getAuthToken=function(){var e=this;return this.authToken&&this.authToken.isValid()?Promise.resolve(this.authToken):(this.authToken=new this.authTokenType(o.getAuthToken(this.getAppId()),this.loggingFeature,this.logger),this.authToken.isValid()?Promise.resolve(this.authToken):(this.authPromise=this.authPromise||new Promise(function(t,n){e.runWithLogMonitor?e.runWithLogMonitor({scenarioName:"LokiGetAuthToken",feature:e.loggingFeature,operation:function(){return e.authToken.refresh(e.refreshAuthToken)},successAction:function(n){e.onRefreshAuthTokenSuccess(n),t(n)},errorAction:function(t){e.onRefreshAuthTokenError(t),n(t)},treatAsExpectedError:function(e){return!!navigator&&!navigator.onLine}}):e.authToken.refresh(e.refreshAuthToken).then(function(n){e.onRefreshAuthTokenSuccess(n),t(n)}).catch(function(t){e.onRefreshAuthTokenError(t),n(t)})}),this.authPromise))},e.prototype.onRefreshAuthTokenSuccess=function(e){this.authPromise=void 0,o.setAuthToken(this.getAppId(),e.getValue()||"")},e.prototype.onRefreshAuthTokenError=function(e){this.authPromise=void 0,this.logger&&this.logger.logError("LokiGetAuthTokenFailed",this.loggingFeature,{message:e})},e}();t.AuthTokenProvider=i},883:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(25),o=n(138),i=n(369);function a(e,t,n){var a=Object(r.h)("fwk-pathBasedRouter")?{pathname:e+t,search:n}:{pathname:e,search:n,hash:"/"+i.c+"/"+t};return o.format(a)}}}]);
//# sourceMappingURL=owa.vendors~GroupFilesHub~GroupHeader~IcsPreview~MailCompose~MailSearch~MeetingMessage~Options~PeopleExp~e2643993.js.map
window.scriptsLoaded['owa.vendors~GroupFilesHub~GroupHeader~IcsPreview~MailCompose~MailSearch~MeetingMessage~Options~PeopleExp~e2643993.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.vendors~GroupFilesHub~GroupHeader~IcsPreview~MailCompose~MailSearch~MeetingMessage~Options~PeopleExp~e2643993.js'] = (new Date()).getTime();