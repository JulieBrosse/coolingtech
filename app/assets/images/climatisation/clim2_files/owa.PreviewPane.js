window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.PreviewPane.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[69],{1210:function(e,t,a){"use strict";var r,n;a.d(t,"a",function(){return r}),(n=r||(r={}))[n.NoOp=0]="NoOp",n[n.AlwaysHidden=1]="AlwaysHidden",n[n.CopyMailReadingPaneContainer=2]="CopyMailReadingPaneContainer",n[n.LoadConversationReadingPane=3]="LoadConversationReadingPane",n[n.LoadItemReadingPane=4]="LoadItemReadingPane"},1213:function(e,t,a){"use strict";a.d(t,"a",function(){return n});var r=a(3),n=Object(r.action)("exitSearch",function(e){return{actionSource:e}})},1223:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var r=a(27),n=a(6);function i(e){var t=r.a.conversations.get(e);if(t){var a=Object(n.a)().UserOptions.ConversationSortOrderReact;return t.conversationNodeIds.length>0&&!t.loadingState.hasLoadFailed&&t.conversationSortOrder==a}return!1}},1234:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var r=a(18),n=a(276);function i(e){switch(e.__type){case n.e:return 0;case n.m:return 1;case n.g:return 2;case n.h:var t=e;return Object(r.isStringNullOrWhiteSpace)(t.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+e.__type)}}},1348:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var r=a(136),n=a(139);function i(){return Object(r.b)("doc-SxS-printPdf")&&!Object(n.d)()}},1553:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(0);t.default=function(e){return r.__assign({__type:"DeleteItemRequest:#Exchange"},e)}},1554:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(38),n=a(1732);t.default=function(e,t){return void 0===e||e.__type||(e=n.default(e)),r.makeServiceRequest("DeleteItem",e,t)}},1732:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(0);t.default=function(e){return r.__assign({__type:"DeleteItemJsonRequest:#Exchange"},e)}},2279:function(e,t,a){"use strict";a.d(t,"a",function(){return o});var r=a(0),n=a(2095),i=a(2393);function o(e){return r.__awaiter(this,void 0,void 0,function(){var t,a;return r.__generator(this,function(r){switch(r.label){case 0:return t=Object(i.a)(e.AttachLongPathName),[4,Object(n.h)(t)];case 1:return[2,(a=r.sent()).result&&a.result.thumbnailLink||null]}})})}},2302:function(e,t,a){"use strict";var r=a(2398),n=a(2234),i=a(278),o=a(256),l=a(379),s=a(9),c=a(4);t.a=Object(c.select)({previewPaneStore:function(){return o.a}})(Object(c.action)("setReadingPaneDisplay")(function(e,t,a){if(a.previewPaneStore.readingPaneDisplay=e,Object(r.a)(),t){var o=n.a.SxSShowHideEmail.datapoint,c=o.name,u=o.customData;Object(s.n)(c,u(e===i.a.Show,Object(l.a)()))}}))},2393:function(e,t,a){"use strict";function r(e){var t=e.indexOf("/d/");return e.substring(t+3,e.indexOf("/",t+3))}a.d(t,"a",function(){return r})},2396:function(e,t,a){"use strict";var r=a(0),n=a(595),i=a(276),o=a(2279),l=a(617),s=a(657),c=a(8),u=a(4);t.a=Object(u.action)("refreshThumbnailImageUrl")(function(e,t,a,u){return void 0===a&&(a=!1),void 0===u&&(u=Object(c.c)("doc-consumerUrl")),r.__awaiter(this,void 0,void 0,function(){var c,d;return r.__generator(this,function(r){switch(r.label){case 0:if(c=Object(n.a)(e),!Object(l.b)(c.model))return[3,7];switch(c.model.ProviderType){case i.f:return[3,1]}return[3,5];case 1:return r.trys.push([1,3,,4]),[4,Object(o.a)(c.model)];case 2:return d=r.sent(),c.thumbnailImage.url=d,[3,4];case 3:return r.sent(),c.thumbnailImage.url=null,[3,4];case 4:case 5:return[3,6];case 6:return[3,8];case 7:d=Object(s.b)(e,c.model,2,Object(l.b)(c.model),t,a,u),c.thumbnailImage.url=d,r.label=8;case 8:return[2]}})})})},2398:function(e,t,a){"use strict";var r=a(2399),n=a(278),i=a(256),o=a(34),l=a(4);t.a=Object(l.select)({previewPaneStore:function(){return i.a},documentWidth:function(){return Math.max(document.documentElement.clientWidth,o.e)}})(Object(l.action)("updateReadingPaneSize")(function(e){var t=e.previewPaneStore.readingPaneSize&&e.previewPaneStore.readingPaneDisplay!==n.a.Initial?e.previewPaneStore.readingPaneSize/100:o.i/100;e.previewPaneStore.readingPaneDisplay===n.a.Initial&&(e.previewPaneStore.readingPaneDisplay=n.a.Default),Object(r.a)(e.documentWidth*(1-t),e.documentWidth*t,{previewPaneStore:e.previewPaneStore})}))},2399:function(e,t,a){"use strict";var r=a(278),n=a(256),i=a(82),o=a(4),l=a(34);t.a=Object(o.select)({previewPaneStore:function(){return n.a}})(Object(o.action)("setReadingPaneSize")(function(e,t,a){if(a.previewPaneStore.state){var n=e+t,o=l.f+l.j;switch(a.previewPaneStore.haveSpaceForReadingPane=n>=o,a.previewPaneStore.readingPaneDisplay===r.a.Initial&&(a.previewPaneStore.readingPaneDisplay=r.a.Default),a.previewPaneStore.readingPaneDisplay){case r.a.Default:a.previewPaneStore.haveSpaceForReadingPane?u():c();break;case r.a.AlwaysHide:case r.a.Hide:c();break;case r.a.Show:if(e>l.c&&Math.round(t)<l.d){var s=e-l.c;e-=s,t+=s}u();break;default:Object(i.a)(a.previewPaneStore.readingPaneDisplay)}}function c(){a.previewPaneStore.hideReadingPane=!0,a.previewPaneStore.readingPaneSize=0,a.previewPaneStore.previewPaneSizePixels=n,a.previewPaneStore.readingPaneSizePixels=0}function u(){a.previewPaneStore.hideReadingPane=!1;var r=100*t/(t+e);a.previewPaneStore.readingPaneSize=r,a.previewPaneStore.previewPaneSizePixels=e,a.previewPaneStore.readingPaneSizePixels=t}}))},2489:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(0);t.default=function(e){return r.__assign({__type:"GetWacInfoRequest:#Exchange"},e)}},250:function(e,t,a){"use strict";var r=a(1213),n=a(286),i=a(528),o=a(6),l=a(74),s=a(4),c=Object(s.action)("initializeShowReadingPane")(function(){switch(Object(o.a)().UserOptions.GlobalReadingPanePositionReact){case l.a.Off:Object(n.a)(!1);break;case l.a.Right:case l.a.Bottom:Object(n.a)(!0);break;default:i.b.importAndExecute(l.a.Off)}}),u=a(394),d=Object(s.action)("onNewMessage")(function(e){e||(Object(n.a)(!0),Object(u.a)(Object(o.a)().UserOptions.GlobalReadingPanePositionReact!==l.a.Off))}),h=Object(s.action)("onPrintRow")(function(){Object(o.a)().UserOptions.GlobalReadingPanePositionReact===l.a.Off&&(Object(n.a)(!0),Object(u.a)(!1))}),m=a(0),f=a(16),p=a(5),v=a(509),b=a(73),w=a(43),g=a(32),S=a(57),k=a(27),y=a(1223),x=a(54);function P(e,t,a,r,i,o,l,s){var c=Promise.resolve(),d=!1,h=!0;switch(o){case S.a.MailListItemBody:case S.a.CommandBarArrows:case S.a.KeyboardEnter:case S.a.MailListItemExpansion:case S.a.MailListItemRichPreview:case S.a.ImmersiveReadingPaneDelete:case S.a.SearchSuggestionClick:d=!0,h=!1;break;case S.a.MailListItemTwisty:c=function(e){if(Object(y.a)(e.Id))return Promise.resolve();return Object(x.j)(e,"LoadConversationReadingPane")}(e),d=!1,h=!0;break;case S.a.KeyboardUpDown:case S.a.MailListItemCheckbox:case S.a.MailListItemContextMenu:case S.a.NewConversation:case S.a.Reset:case S.a.RouteHandler:case S.a.RowRemoval:default:d=!1,h=!0}if(d)switch(t){case 0:c=b.h.importAndExecute(e,i,l,a,r);break;case 1:c=b.j.importAndExecute(e,i,l,s)}return Object(n.a)(d),Object(u.a)(h),c}var I=Object(s.action)("onListViewSelectionChange")(Object(s.select)({listViewStore:function(){return p.F}})(function(e,t,a,r){return m.__awaiter(this,void 0,void 0,function(){var i,s,c,d,h,y,x,I,_,O,C,j,B;return m.__generator(this,function(m){return a==S.a.MessageAd?[2]:(i=Promise.resolve(),s=e.selectedRowKeys.size,c=Object(o.a)().UserOptions.GlobalReadingPanePositionReact,0==s?(A=c,Object(u.a)(!0),A===l.a.Off?Object(n.a)(!1):Object(n.a)(!0)):1==s?(d=e.selectedRowKeys.keys()[0],h=p.b.getRowClientItemId(d,e),y=p.b.getIsDraft(d,e),x=p.b.getIsSubmitted(d,e),I=e.tableQuery,_=Object(p.C)(I)||Object(w.m)(I),O=y&&!x&&!_,C=Object(v.a)([d],e)[0],j=p.b.getCategories(d,e),B=0==I.listViewType?r.listViewStore.conversationItems.get(h.Id).subject:k.a.items.get(h.Id).Subject,Object(f.a)("sea-qf")&&C&&g.t.importAndExecute(C.traceId,C.referenceKey,new Date,C.index),_||(c==l.a.Right||c==l.a.Bottom?i=function(e,t,a,r,i,o,l,s){switch(Object(n.a)(!0),Object(u.a)(!0),t){case 0:return b.h.importAndExecute(e,i,l,a,r);case 1:return b.j.importAndExecute(e,i,l,s);default:return Promise.resolve()}}(h,I.listViewType,B,j,t,0,C,O):c==l.a.Off&&(i=P(h,I.listViewType,B,j,t,a,C,O)))):c==l.a.Off&&(Object(n.a)(!1),Object(u.a)(!0)),[2,i]);var A})})})),_=a(2),O=a(28),C=(a(34),a(64));a.d(t,"c",function(){return B}),a.d(t,"d",function(){return A}),a.d(t,"e",function(){return D}),a.d(t,"g",function(){return E}),a.d(t,"h",function(){return T}),a.d(t,"f",function(){return N}),a.d(t,"b",function(){return c}),a.d(t,"j",function(){return d}),a.d(t,"i",function(){return I}),a.d(t,"k",function(){return h}),a.d(t,"a",function(){return r.a});var j=new _.c(function(){return Promise.all([a.e(226),a.e(66)]).then(a.bind(null,5645))}),B=new _.a(j,function(e){return e.closeImmersiveReadingPane}),A=new _.a(j,function(e){return e.onCloseCompose}),D=new _.a(j,function(e){return e.onReplyOrReplyAllOrForwardMessage}),E=new _.a(j,function(e){return e.onSelectingFolder}),T=new _.b(j,function(e){return e.onSxSPreviewPaneClose}),L=new _.a(j,function(e){return e.onReadingPanePositionOptionSaved}),N=new _.a(j,function(e){return e.onSelectMessageAd});Object(O.c)(function(){Object(C.subscribe)("saveReadingPanePositionOptionStitchName",function(e){return L.importAndExecute(e)})})},2556:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(38),n=a(2489);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=n.default(e.request)),r.makeServiceRequest("GetWacInfo",e,t)}},2565:function(e,t,a){"use strict";var r=a(2234),n=a(256),i=a(3374),o=a(379),l=a(9),s=a(4);t.a=Object(s.select)({previewPaneStore:function(){return n.a}})(Object(s.action)("closePreview")(function(e,t,a){void 0===t&&(t=null);var n=a.previewPaneStore;if(n.state&&(!t||!n.state.itemId||t.Id===n.state.itemId.Id)){Object(i.a)(n.state),Object(i.a)(n.pendingState),n.conversation=null,n.state=null,n.pendingState=null;var s=r.a.SxSClose.datapoint,c=s.name,u=s.customData;Object(l.n)(c,u(Object(o.a)(),e))}}))},2640:function(e,t,a){"use strict";var r=a(595),n=a(4);t.a=Object(n.action)("setPreviewImageUrl")(function(e,t){Object(r.a)(e).previewImage.url=t})},2641:function(e,t,a){"use strict";var r=a(0),n=a(2640),i=a(595),o=a(276),l=a(2279),s=a(617),c=a(657),u=a(8),d=a(4);t.a=Object(d.action)("refreshPreviewImageUrl")(function(e,t,a,d){return void 0===a&&(a=!1),void 0===d&&(d=Object(u.c)("doc-consumerUrl")),r.__awaiter(this,void 0,void 0,function(){var u,h,m;return r.__generator(this,function(f){switch(f.label){case 0:return u=Object(i.a)(e),Object(s.b)(u.model)&&u.model.ProviderType===o.f?[4,function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(a){switch(a.label){case 0:return[4,Object(l.a)(e)];case 1:if(null==(t=a.sent()))throw new Error("URL not available");return[2,t+"2"]}})})}(u.model)]:[3,2];case 1:return h=f.sent(),Object(n.a)(e,h),[3,3];case 2:Object(s.b)(u.model)&&u.model.ProviderType!==o.k&&u.model.ProviderType!==o.l||(m=Object(c.b)(e,u.model,1,1===u.type,t,a,d),Object(n.a)(e,m)),f.label=3;case 3:return[2]}})})})},2648:function(e,t,a){"use strict";var r=a(256),n=a(4);t.a=Object(n.select)({previewPaneStore:function(){return r.a}})(Object(n.action)("updatePreviewPaneState")(function(e,t){null!=t.previewPaneStore.state&&(t.previewPaneStore.state=e)}))},2658:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(38),n=a(2659);t.default=function(e,t){return void 0===e||e.__type||(e=n.default(e)),r.makeServiceRequest("GetAttachmentTextPreview",e,t)}},2659:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(0);t.default=function(e){return r.__assign({__type:"GetAttachmentTextPreviewRequest:#Exchange"},e)}},286:function(e,t,a){"use strict";var r=a(27),n=a(4),i=a(126),o=a(113);t.a=Object(n.action)("setShowReadingPane")(function(e){r.a.mailModule.showReadingPane=e,Object(i.a)()&&o.e.importAndExecute(o.i)})},2985:function(e,t,a){"use strict";var r=a(4);t.a=Object(r.action)("setImageLoaded")(function(e){e.imageLoaded=!1,e.isImageLoading=!1})},2986:function(e,t,a){"use strict";a.d(t,"a",function(){return s});var r=a(0),n=a(2095),i=a(2393),o="download",l="open";function s(e){return r.__awaiter(this,void 0,void 0,function(){var t,a;return r.__generator(this,function(r){switch(r.label){case 0:return t=Object(i.a)(e.AttachLongPathName),[4,Object(n.h)(t)];case 1:return[2,(a=r.sent()).result&&a.result.webContentLink&&(c=a.result.webContentLink,c.lastIndexOf(o,c.length-o.length)>-1)?(s=a.result.webContentLink,s.slice(0,-o.length)+l):null]}var s,c})})}},2987:function(e,t,a){"use strict";a.d(t,"a",function(){return c});var r=a(0),n=a(2658),i=a.n(n),o=a(985),l=a.n(o),s=a(7);function c(e,t,a){return r.__awaiter(this,void 0,void 0,function(){var n,o,c,u,d,h,m;return r.__generator(this,function(r){switch(r.label){case 0:n={error:null,errorMessage:"Something went wrong while the document preview was being created. Please try again later."},r.label=1;case 1:return r.trys.push([1,3,,4]),a&&(o="getAttachmentTextPreview"+a,(c=new Headers).set("X-OWA-ActionName",o),u={headers:c},t=t?l()(t,u):u),[4,i()({AttachmentId:e},t)];case 2:if((d=r.sent())&&0===d.Status)return[2,d.Content];switch(h=d&&d.Status||1){case 2:n.errorMessage="The attachment has been moved or deleted.";break;case 3:n.errorMessage="Something went wrong while the document preview was being created. Please try again later.";break;case 1:default:n.errorMessage="Something went wrong while the document preview was being created. Please try again later."}return n.error=new Error("getAttachmentTextPreview failed with status: "+h),[3,4];case 3:return m=r.sent(),s.c.warn("getAttachmentTextPreview failed with error: "+m),n.error=m,[3,4];case 4:throw n}})})}},3094:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(0);t.default=function(e){return r.__assign({__type:"SynchronizeWacAttachmentRequest:#Exchange"},e)}},3104:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(38),n=a(3105);t.default=function(e,t){return void 0===e||e.__type||(e=n.default(e)),r.makeServiceRequest("GetAttachment",e,t)}},3105:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(0);t.default=function(e){return r.__assign({__type:"GetAttachmentJsonRequest:#Exchange"},e)}},3335:function(e,t,a){"use strict";var r=a(2648),n=a(2234),i=a(519),o=a(720),l=a(256),s=a(3374),c=a(379),u=a(0),d=a(2985),h=a(9),m=a(149),f=a(144),p=a(2641),v=a(595),b=a(2986),w=a(617),g=a(657),S=a(11),k=a.n(S),y=a(7),x=a(2987),P=a(2444),I=a(34),_=a(93),O=a(141),C=a(678),j=a(666),B=a.n(j),A=a(2565);function D(e,t){return u.__awaiter(this,void 0,void 0,function(){var a,r;return u.__generator(this,function(n){switch(n.label){case 0:if(!(a=t.attachmentId))return[2,null];switch(t.type){case m.b.Image:return[3,1];case m.b.Wac:return[3,3];case m.b.NativeView:return[3,5];case m.b.Text:return[3,7];case m.b.CalendarEvent:return[3,9]}return[3,11];case 1:return[4,function(e){return u.__awaiter(this,void 0,void 0,function(){var t,a,r,n;return u.__generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),t=e,(a=Object(v.a)(e.attachmentId))?(e.mode=i.a.PendingUrl,[4,Object(p.a)(e.attachmentId,!e.isDraft)]):[3,2];case 1:o.sent(),r=a.previewImage.url,t=u.__assign({},e,{previewUrl:r,mode:i.a.View}),o.label=2;case 2:return[2,t];case 3:return n=o.sent(),Object(d.a)(e),[2,T(e,k.a.errorImageAttachment,n)];case 4:return[2]}})})}(t)];case 2:return r=n.sent(),[3,12];case 3:return[4,function(e,t){return u.__awaiter(this,void 0,void 0,function(){var a,r,n;return u.__generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),e.mode=i.a.PendingUrl,[4,Object(P.a)(e.attachmentId,!1,I.h[t])];case 1:return a=o.sent(),[2,u.__assign({},e,{wacUrl:a,mode:i.a.View})];case 2:return r=o.sent(),n=r,y.c.warn("Something went wrong while getting the attachment state: "+n),[2,T(e,n.errorMessage,n.error)];case 3:return[2]}})})}(t,e.previewSelectionSource)];case 4:return r=n.sent(),[3,12];case 5:return[4,function(e){return u.__awaiter(this,void 0,void 0,function(){var t,a;return u.__generator(this,function(r){switch(r.label){case 0:return t=Object(v.a)(e.attachmentId),Object(w.b)(t.model)&&t.model.ProviderType===f.a.providers.GDRIVE?[4,function(e){return u.__awaiter(this,void 0,void 0,function(){var t,a,r;return u.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=Object(v.a)(e.attachmentId),[4,Object(b.a)(t.model)];case 1:return(a=n.sent())?[2,u.__assign({},e,{previewUrl:a,printUrl:null,mode:i.a.View})]:[2,T(e,k.a.errorGetWacUrlAttachmentDataProviderError,null)];case 2:return r=n.sent(),[2,T(e,k.a.errorGetWacUrlAttachmentDataProviderError,r)];case 3:return[2]}})})}(e)]:[3,2];case 1:return[2,r.sent()];case 2:return a=Object(g.b)(e.attachmentId,t.model,3,Object(w.b)(t.model),!0),[2,u.__assign({},e,{previewUrl:t.download.url+"&isDocumentPreview=True#toolbar=0",printUrl:a,mode:i.a.View})]}})})}(t)];case 6:return r=n.sent(),[3,12];case 7:return[4,function(e){return u.__awaiter(this,void 0,void 0,function(){var t,a,r;return u.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Object(x.a)(e.attachmentId.Id,e.attachmentId.mailboxInfo&&e.attachmentId.mailboxInfo.requestOptions)];case 1:return t=n.sent(),[2,u.__assign({},e,{textContent:t,mode:i.a.View})];case 2:return a=n.sent(),[2,T(e,(r=a).errorMessage,r.error)];case 3:return[2]}})})}(t)];case 8:return r=n.sent(),[3,12];case 9:return[4,function(e){return u.__awaiter(this,void 0,void 0,function(){return u.__generator(this,function(t){switch(t.label){case 0:return[4,C.d.import()];case 1:return t.sent()(e.attachmentId,e.size,E(k.a.AddToCalendarSizeLimitExceedsError,"IcsErrorPreviewPaneDialog"),E(B.a.ICSFileErrorText,"IcsErrorPreviewPaneDialog"),e),[2,e]}})})}(t)];case 10:return r=n.sent(),[3,12];case 11:return[2,null];case 12:return l=a,[2,(o=e).state&&Object(_.c)(o.state.attachmentId,l)?r:null]}var o,l})})}function E(e,t){var a=this;return function(){return u.__awaiter(a,void 0,void 0,function(){return u.__generator(this,function(a){switch(a.label){case 0:return[4,Object(O.b)("",e,!1,{hideCancelButton:!0}).then(function(){Object(A.a)(t)})];case 1:return a.sent(),[2]}})})}}function T(e,t,a){return e.perfDatapoint&&e.perfDatapoint.endWithError(h.a.ServerError,a),u.__assign({},e,{errorMessage:t,mode:i.a.Error,perfDatapoint:null})}var L=a(4);t.a=Object(L.select)({previewPaneStore:function(){return l.a}})(Object(L.action)("showPreview")(function(e,t){var a=t.previewPaneStore;if(a.state&&a.state.mode===i.a.Saving)Object(s.a)(a.pendingState),a.pendingState=e;else{if(Object(s.a)(a.state),a.pendingNavigationAttachmentId=null,!a.state){var l=n.a.SxSOpen.datapoint,u=l.name,d=l.customData;Object(h.n)(u,d(Object(c.a)(),o.a[a.previewSelectionSource]))}a.state=e,D(a,e).then(function(e){e&&Object(r.a)(e)})}}))},3374:function(e,t,a){"use strict";function r(e){e&&e.perfDatapoint&&(e.perfDatapoint.addCustomData({userTerminated:"1"}),e.perfDatapoint.end())}a.d(t,"a",function(){return r})},3375:function(e,t,a){"use strict";var r=a(256),n=a(519),i=a(4);t.a=Object(i.select)({previewPaneStore:function(){return r.a}})(Object(i.action)("closeWacEdit")(function(e){e.previewPaneStore.state.wacUrl=null,e.previewPaneStore.state.mode=n.a.Saving,e.previewPaneStore.state.savingAttachmentId=e.previewPaneStore.state.attachmentId}))},3454:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(38),n=a(3094);t.default=function(e,t){return void 0===e||e.__type||(e=n.default(e)),r.makeServiceRequest("SynchronizeWacAttachment",e,t)}},3458:function(e,t,a){var r=a(4490),n=a(33);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)n.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},3459:function(e,t,a){"use strict";a.d(t,"b",function(){return i}),a.d(t,"a",function(){return o}),a.d(t,"c",function(){return l});a(9);var r=a(2),n=new r.c(function(){return Promise.all([a.e(27),a.e(189)]).then(a.bind(null,5568))}),i=new r.a(n,function(e){return e.renderPdfPreview}),o=new r.a(n,function(e){return e.printPdf}),l=new r.a(n,function(e){return e.setCurrentPdfForPrinting})},379:function(e,t,a){"use strict";function r(){var e=window.location.pathname;"/"===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1));var t=e.lastIndexOf("/");return-1===t?e:e.substr(t+1)}a.d(t,"a",function(){return r})},389:function(e,t,a){"use strict";var r=a(0);var n={AttachmentRefreshDownloadToken:{datapoint:{name:"AttachmentRefreshDownloadToken",customData:function(e){return[e]}}}},i=a(943),o=a.n(i),l=a(6),s=a(9),c=a(93),u=a(8),d=a(18),h=a(7);a.d(t,"a",function(){return p}),a.d(t,"c",function(){return v}),a.d(t,"b",function(){return b});var m=function(e){var t;void 0===e&&(e={}),(t=e).timeBetweenRetryInMS=t.timeBetweenRetryInMS||function(){return 6e4};var a=e.maximumAttempts,r=e.timeBetweenRetryInMS;return function(e){var t=0,n=!1,i=function(o,l){n?l(new Error("The function retry was cancelled")):(t++,e().then(o).catch(function(e){a&&t>=a?l(e):setTimeout(function(){return i(o,l)},r(t))}))};return{retriableFunc:function(){return new Promise(function(e,t){return i(e,t)})},cancel:function(){return n=!0}}}}({timeBetweenRetryInMS:function(){return 3e4}}),f=function(){function e(e,t,a,i){var l=this;this.downloadTokenRefreshMinutes=e,this.downloadUrlBase=t,this.mailboxAddress=a,this.refreshDownloadTokenAndRetryInCaseOfFailure=function(){return r.__awaiter(l,void 0,void 0,function(){var e,t,a,i,l=this;return r.__generator(this,function(c){switch(c.label){case 0:if(this.isRefreshingDownloadToken)return[3,4];this.isRefreshingDownloadToken=!0,e=0,t=m(function(){return r.__awaiter(l,void 0,void 0,function(){var t;return r.__generator(this,function(a){switch(a.label){case 0:return e++,t=this,[4,function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,o()()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),h.c.warn("Unable to get the download token "+e),e;case 3:return[2]}})})}()];case 1:return t.downloadToken=a.sent(),this.isRefreshingDownloadToken=!1,[2]}})})}).retriableFunc,a=new s.d(n.AttachmentRefreshDownloadToken.datapoint.name),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,t()];case 2:return c.sent(),a.addCustomData(n.AttachmentRefreshDownloadToken.datapoint.customData(e)),a.end(),[3,4];case 3:return i=c.sent(),h.c.warn("Retry to refresh token failed: "+i),a.addCustomData(n.AttachmentRefreshDownloadToken.datapoint.customData(e)),a.endWithError(s.a.ServerError,i),this.isRefreshingDownloadToken=!1,[3,4];case 4:return[2]}})})},this.useDownloadUrlBase=!Object(d.isStringNullOrWhiteSpace)(this.downloadUrlBase)&&!Object(d.isStringNullOrWhiteSpace)(this.mailboxAddress)&&Object(u.c)("doc-attachment-downloadDomain"),this.downloadToken=i,this.downloadTokenRefreshMinutes<1&&(this.downloadTokenRefreshMinutes=1),this.useDownloadUrlBase&&setInterval(this.refreshDownloadTokenAndRetryInCaseOfFailure,6e4*this.downloadTokenRefreshMinutes)}return e.getInstance=function(){if(!e.instance){var t=Object(l.a)(),a=Object(c.b)().mailboxId,r=t.ApplicationSettings;e.instance=new e(r.DownloadTokenRefreshMinutes,r.DownloadUrlBase,a,r.FirstDownloadToken)}return e.instance},e.resetInstanceForTesting=function(){e.instance=null},e.prototype.getDownloadToken=function(){return this.downloadToken},e.prototype.getUseDownloadUrlBase=function(){return this.useDownloadUrlBase},e.prototype.getDownloadUrlBase=function(){return this.downloadUrlBase},e}();function p(){return f.getInstance().getDownloadToken()}function v(){return f.getInstance().getUseDownloadUrlBase()}function b(){return f.getInstance().getDownloadUrlBase()}},390:function(e,t,a){"use strict";var r=a(939);a.d(t,"a",function(){return r.a}),a.d(t,"b",function(){return r.b});var n=a(389);a.d(t,"c",function(){return n.a})},394:function(e,t,a){"use strict";var r=a(27),n=a(4);t.a=Object(n.action)("setShowListPane")(function(e){r.a.mailModule.showListPane=e})},4488:function(e,t,a){var r=a(4489),n=a(33);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)n.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},4489:function(e,t,a){(t=e.exports=a(35)(!1)).push([e.i,'._38dy7ygQUmycZjK91vzHXb{position:absolute;top:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;height:100%;width:100%}html[dir] ._38dy7ygQUmycZjK91vzHXb{text-align:center}html[dir=ltr] ._38dy7ygQUmycZjK91vzHXb{left:0}html[dir=rtl] ._38dy7ygQUmycZjK91vzHXb{right:0}.Z02Q_vZDkcxW7CjnnH-bN{width:400px;font-size:17px;font-weight:300}.jL4P6KKzGbdAv-kNAaw79{color:"[theme:white, default:#ffffff]"}',""]),t.locals={messageContainer:"_38dy7ygQUmycZjK91vzHXb",messageText:"Z02Q_vZDkcxW7CjnnH-bN",highContrastMessageText:"jL4P6KKzGbdAv-kNAaw79"}},4490:function(e,t,a){(t=e.exports=a(35)(!1)).push([e.i,'.F91MRR9_u9lIoJwVS5hW6{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);height:100%;width:100%}html[dir] .F91MRR9_u9lIoJwVS5hW6{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white);text-align:center;background:"[theme:black, default:#000000]"}.F91MRR9_u9lIoJwVS5hW6 audio,.F91MRR9_u9lIoJwVS5hW6 video{display:inline-block;vertical-align:middle;max-width:100%;max-height:100%}.F91MRR9_u9lIoJwVS5hW6 span{display:inline-block;height:100%;vertical-align:middle}',""]),t.locals={container:"F91MRR9_u9lIoJwVS5hW6"}},4491:function(e,t,a){var r=a(4492),n=a(33);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)n.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},4492:function(e,t,a){(t=e.exports=a(35)(!1)).push([e.i,"._26eWP6fphPDvi2g08qfg3h{position:relative}.LPPqtHRnxN-aYFZFZWBg2{height:100%;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}._2_8wsluzT4PkdpJfjPzdsG{position:absolute;top:0;height:100%;width:100%}html[dir=ltr] ._2_8wsluzT4PkdpJfjPzdsG{left:0}html[dir=rtl] ._2_8wsluzT4PkdpJfjPzdsG{right:0}._2yFij4J67mu42E6PxNwM7j{display:none}",""]),t.locals={main:"_26eWP6fphPDvi2g08qfg3h",container:"LPPqtHRnxN-aYFZFZWBg2",preview:"_2_8wsluzT4PkdpJfjPzdsG",hideSpinner:"_2yFij4J67mu42E6PxNwM7j"}},4493:function(e,t,a){var r=a(4494),n=a(33);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)n.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},4494:function(e,t,a){(t=e.exports=a(35)(!1)).push([e.i,'._1vn2vYJNVGsqN-ZJiHliUu{position:absolute;bottom:0;width:100%;visibility:hidden}._1vn2vYJNVGsqN-ZJiHliUu._3FFn7MPS84pP8C0ReW1Fvt{visibility:visible}._1dq-ngGl_Onw63O8153Got{width:100%;opacity:.5}html[dir] ._1dq-ngGl_Onw63O8153Got{background-color:transparent;-webkit-transform-origin:50% 90%;transform-origin:50% 90%;-webkit-transform:scale(.25);transform:scale(.25);margin:5px 0;padding:5px 0;-webkit-transition:opacity 367ms,background-color 367ms,-webkit-transform 367ms;transition:opacity 367ms,background-color 367ms,-webkit-transform 367ms;transition:transform 367ms,opacity 367ms,background-color 367ms;transition:transform 367ms,opacity 367ms,background-color 367ms,-webkit-transform 367ms;-webkit-transition-timing-function:cubic-bezier(.17,.17,0,1);transition-timing-function:cubic-bezier(.17,.17,0,1)}._1vn2vYJNVGsqN-ZJiHliUu:hover ._1dq-ngGl_Onw63O8153Got{opacity:1}html[dir] ._1vn2vYJNVGsqN-ZJiHliUu:hover ._1dq-ngGl_Onw63O8153Got{background-color:rgba(0,0,0,.7);-webkit-transform:scale(1);transform:scale(1)}.WUg7BirOQl6eJCs5GaV5-{overflow-x:hidden;overflow-y:hidden;white-space:nowrap}html[dir] .WUg7BirOQl6eJCs5GaV5-{margin-top:5px;text-align:center}html[dir=ltr] .WUg7BirOQl6eJCs5GaV5-,html[dir=rtl] .WUg7BirOQl6eJCs5GaV5-{margin-left:46px;margin-right:46px}html[dir] .WUg7BirOQl6eJCs5GaV5->div{-webkit-transition:-webkit-transform 367ms;transition:-webkit-transform 367ms;transition:transform 367ms;transition:transform 367ms,-webkit-transform 367ms;-webkit-transition-timing-function:cubic-bezier(.17,.17,0,1);transition-timing-function:cubic-bezier(.17,.17,0,1)}.yYUBD7kd2XLw5cx9Y8Ox5{display:inline-block;cursor:pointer}html[dir] .yYUBD7kd2XLw5cx9Y8Ox5{border:transparent solid 2px}html[dir] .yYUBD7kd2XLw5cx9Y8Ox5._2UV8seCAjhg39B5c03mj5g{border-color:"[theme:white, default:#ffffff]"}html[dir] .dYmgO7XIj2b9gnN6AdNdf,html[dir] .dYmgO7XIj2b9gnN6AdNdf:active,html[dir] .dYmgO7XIj2b9gnN6AdNdf:hover{background-color:transparent}._1hfj4pssBsbBhnRAlMuK4N{color:"[theme:white, default:#ffffff]";font-size:28px;line-height:129px;cursor:pointer;opacity:1}html[dir] ._1hfj4pssBsbBhnRAlMuK4N{-webkit-transition:opacity 367ms;transition:opacity 367ms;-webkit-transition-timing-function:cubic-bezier(.17,.17,0,1);transition-timing-function:cubic-bezier(.17,.17,0,1)}._1hfj4pssBsbBhnRAlMuK4N._2u1zVJEE0FgqroXR5PsS4p{opacity:0}.xgRqkl1x8ucPWJOBd3Wuv{position:absolute;top:0}html[dir=ltr] .xgRqkl1x8ucPWJOBd3Wuv{left:9px}html[dir=rtl] .xgRqkl1x8ucPWJOBd3Wuv{right:9px}.ln9aH5pf_ZX0yxBzlhojh{position:absolute;top:0}html[dir=ltr] .ln9aH5pf_ZX0yxBzlhojh{right:9px}html[dir=rtl] .ln9aH5pf_ZX0yxBzlhojh{left:9px}',""]),t.locals={main:"_1vn2vYJNVGsqN-ZJiHliUu",show:"_3FFn7MPS84pP8C0ReW1Fvt",filmStrip:"_1dq-ngGl_Onw63O8153Got",scrollArea:"WUg7BirOQl6eJCs5GaV5-",thumbnail:"yYUBD7kd2XLw5cx9Y8Ox5",selected:"_2UV8seCAjhg39B5c03mj5g",arrowButtonContainer:"dYmgO7XIj2b9gnN6AdNdf",arrowButton:"_1hfj4pssBsbBhnRAlMuK4N",hidden:"_2u1zVJEE0FgqroXR5PsS4p",leftArrowContainer:"xgRqkl1x8ucPWJOBd3Wuv",rightArrowContainer:"ln9aH5pf_ZX0yxBzlhojh"}},4495:function(e,t,a){var r=a(4496),n=a(33);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)n.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},4496:function(e,t,a){(t=e.exports=a(35)(!1)).push([e.i,'._2PVcRslzaLFlapxB_A3btz{position:absolute;width:100%;height:100%;top:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}html[dir] ._2PVcRslzaLFlapxB_A3btz{border:0}html[dir=ltr] ._2PVcRslzaLFlapxB_A3btz{left:0}html[dir=rtl] ._2PVcRslzaLFlapxB_A3btz{right:0}._2pkaaM13Ghk0j0HtFdQTKd{font-size:12px;font-weight:400;color:"[theme:neutralSecondary, default:#666666]"}html[dir] ._2pkaaM13Ghk0j0HtFdQTKd{padding-top:20px}',""]),t.locals={messageContainer:"_2PVcRslzaLFlapxB_A3btz",messageText:"_2pkaaM13Ghk0j0HtFdQTKd"}},4497:function(e,t,a){var r=a(4498),n=a(33);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)n.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},4498:function(e,t,a){(t=e.exports=a(35)(!1)).push([e.i,'.NK8HHvDjL3XqeeGf4ROzS{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);position:relative}html[dir] .NK8HHvDjL3XqeeGf4ROzS{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white)}.NK8HHvDjL3XqeeGf4ROzS:fullscreen{width:100%;height:100%}.NK8HHvDjL3XqeeGf4ROzS:fullscreen ._2Ldwbu5-0CvJjz4k7vywSx{display:block}.NK8HHvDjL3XqeeGf4ROzS:-ms-fullscreen{width:100%;height:100%}.NK8HHvDjL3XqeeGf4ROzS:-ms-fullscreen ._2Ldwbu5-0CvJjz4k7vywSx{display:block}.NK8HHvDjL3XqeeGf4ROzS:-webkit-full-screen{width:100%;height:100%}.NK8HHvDjL3XqeeGf4ROzS:-webkit-full-screen ._2Ldwbu5-0CvJjz4k7vywSx{display:block}.NK8HHvDjL3XqeeGf4ROzS:-moz-full-screen{width:100%;height:100%}.NK8HHvDjL3XqeeGf4ROzS:-moz-full-screen ._2Ldwbu5-0CvJjz4k7vywSx{display:block}._3E-S6ObxP_NAE7uvvtCr4r{height:100%;width:100%}html[dir] ._3E-S6ObxP_NAE7uvvtCr4r{text-align:center;background:"[theme:black, default:#000000]"}._3E-S6ObxP_NAE7uvvtCr4r img{display:inline-block;max-height:96%;max-width:96%;vertical-align:middle}._3E-S6ObxP_NAE7uvvtCr4r span{display:inline-block;height:100%;vertical-align:middle}._3E-S6ObxP_NAE7uvvtCr4r .ms-Spinner{display:inline-block}._1ChAJvE1PaVvDht8KswEsw{visibility:hidden;width:1px;height:1px}._2mcOya1Mfi6MAcLftUdHIh{position:absolute;cursor:pointer;height:100%;width:33%;top:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center}html[dir] ._2mcOya1Mfi6MAcLftUdHIh,html[dir] ._2mcOya1Mfi6MAcLftUdHIh:active,html[dir] ._2mcOya1Mfi6MAcLftUdHIh:hover{background-color:transparent}._3zjHwJDaHKQAT2Od6wtGSW{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start}html[dir=ltr] ._3zjHwJDaHKQAT2Od6wtGSW{left:0;text-align:left}html[dir=rtl] ._3zjHwJDaHKQAT2Od6wtGSW{right:0;text-align:right}._1ZStNOco_hi4vcHj7-xbEF{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}html[dir=ltr] ._1ZStNOco_hi4vcHj7-xbEF{right:0;text-align:right}html[dir=rtl] ._1ZStNOco_hi4vcHj7-xbEF{left:0;text-align:left}._2mcOya1Mfi6MAcLftUdHIh:hover ._3iFkHGYA7-D0OA0rVzlmeB{visibility:visible}._3iFkHGYA7-D0OA0rVzlmeB{font-size:35px;color:"[theme:white, default:#ffffff]";visibility:hidden}html[dir=rtl] ._3iFkHGYA7-D0OA0rVzlmeB{-webkit-transform:scaleX(-1);transform:scaleX(-1)}._2Ldwbu5-0CvJjz4k7vywSx,._2Ldwbu5-0CvJjz4k7vywSx:hover{display:none;position:absolute;opacity:.7;top:10px;color:"[theme:white, default:#ffffff]"}html[dir=ltr] ._2Ldwbu5-0CvJjz4k7vywSx,html[dir=ltr] ._2Ldwbu5-0CvJjz4k7vywSx:hover{right:20px}html[dir=rtl] ._2Ldwbu5-0CvJjz4k7vywSx,html[dir=rtl] ._2Ldwbu5-0CvJjz4k7vywSx:hover{left:20px}._2Ldwbu5-0CvJjz4k7vywSx ._1LZRGooEqNE-vi_3ftVSuP,._2Ldwbu5-0CvJjz4k7vywSx:hover ._1LZRGooEqNE-vi_3ftVSuP{color:"[theme:white, default:#ffffff]"}',""]),t.locals={main:"NK8HHvDjL3XqeeGf4ROzS",exitFullScreenButton:"_2Ldwbu5-0CvJjz4k7vywSx",imageContainer:"_3E-S6ObxP_NAE7uvvtCr4r",imageLoading:"_1ChAJvE1PaVvDht8KswEsw",arrowContainer:"_2mcOya1Mfi6MAcLftUdHIh",prevArrowContainer:"_3zjHwJDaHKQAT2Od6wtGSW",nextArrowContainer:"_1ZStNOco_hi4vcHj7-xbEF",arrowButton:"_3iFkHGYA7-D0OA0rVzlmeB",exitFullScreenIcon:"_1LZRGooEqNE-vi_3ftVSuP"}},4499:function(e,t,a){var r=a(4500),n=a(33);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)n.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},4500:function(e,t,a){(t=e.exports=a(35)(!1)).push([e.i,'._3wQsqm7zPblRbaPP3rLurJ{height:100%}html[dir=ltr] ._3wQsqm7zPblRbaPP3rLurJ{border-right:1px solid "[theme:neutralLight, default:#eaeaea]"}html[dir=rtl] ._3wQsqm7zPblRbaPP3rLurJ{border-left:1px solid "[theme:neutralLight, default:#eaeaea]"}._3wQsqm7zPblRbaPP3rLurJ>*{height:100%}',""]),t.locals={container:"_3wQsqm7zPblRbaPP3rLurJ"}},4501:function(e,t,a){var r=a(4502),n=a(33);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)n.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},4502:function(e,t,a){(t=e.exports=a(35)(!1)).push([e.i,".p7uuZNLHXqxwPEtzjwt-X{position:relative}._3Ol4eNLFy0Zw_Hvqss4kkL{height:100%;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}._2cxdSlYQlMpY7yjlU5pG31{position:absolute;top:0;height:100%;width:100%}html[dir=ltr] ._2cxdSlYQlMpY7yjlU5pG31{left:0}html[dir=rtl] ._2cxdSlYQlMpY7yjlU5pG31{right:0}",""]),t.locals={main:"p7uuZNLHXqxwPEtzjwt-X",container:"_3Ol4eNLFy0Zw_Hvqss4kkL",object:"_2cxdSlYQlMpY7yjlU5pG31"}},4503:function(e,t,a){var r=a(4504),n=a(33);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)n.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},4504:function(e,t,a){(t=e.exports=a(35)(!1)).push([e.i,"._2VdHIUVpFq-JNn04uIeEp-{overflow:auto}html[dir] ._2VdHIUVpFq-JNn04uIeEp-{padding:0 10px}._1OuW7DNnjd8dvtvUZKAaY5{white-space:pre-wrap}",""]),t.locals={main:"_2VdHIUVpFq-JNn04uIeEp-",textContent:"_1OuW7DNnjd8dvtvUZKAaY5"}},4505:function(e,t,a){var r=a(4506),n=a(33);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)n.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},4506:function(e,t,a){(t=e.exports=a(35)(!1)).push([e.i,".kABp2eEOxCQKphT-BRPuv iframe{width:100%;height:100%}html[dir] .kABp2eEOxCQKphT-BRPuv iframe{border:0}._17FPHgimZXW5-urOGilPf6 iframe{visibility:hidden}",""]),t.locals={iframeContainer:"kABp2eEOxCQKphT-BRPuv",iframeSaving:"_17FPHgimZXW5-urOGilPf6"}},4507:function(e,t,a){var r=a(4508),n=a(33);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)n.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},4508:function(e,t,a){(t=e.exports=a(35)(!1)).push([e.i,'._1gJeWJGIpH0WCe1r51m-ZZ{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}._28G6ftSs65A7bh-LjoaviO{-webkit-box-flex:0;-ms-flex:0 0 40px;flex:0 0 40px}html[dir=ltr] ._28G6ftSs65A7bh-LjoaviO .ms-CommandBar,html[dir=rtl] ._28G6ftSs65A7bh-LjoaviO .ms-CommandBar{padding-left:12px;padding-right:12px}html[dir=ltr] .F0jFoYFiV9b16KtrolsHx .ms-CommandBar{padding-left:0;padding-right:12px}html[dir=rtl] .F0jFoYFiV9b16KtrolsHx .ms-CommandBar{padding-right:0;padding-left:12px}._2Vq5DLJWUwuXtkBcFnSv8g{position:relative;height:calc(100% - 40px);-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}._3yfN3bvTDn6iN1D2ucbGPM{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary)}html[dir] ._3yfN3bvTDn6iN1D2ucbGPM{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white)}._3yfN3bvTDn6iN1D2ucbGPM .ms-CommandBar{color:"[theme:white, default:#ffffff]"}html[dir] ._3yfN3bvTDn6iN1D2ucbGPM .ms-CommandBar,html[dir] ._3yfN3bvTDn6iN1D2ucbGPM .ms-CommandBarItem-link{background:"[theme:black, default:#000000]"}._3yfN3bvTDn6iN1D2ucbGPM .ms-CommandBarItem-link:hover:not([disabled]) .ms-Button-icon,._3yfN3bvTDn6iN1D2ucbGPM .ms-CommandBarItem-link:hover:not([disabled]) .ms-Button-textContainer,._3yfN3bvTDn6iN1D2ucbGPM .ms-CommandBarItem-link:not([disabled]) .ms-Button-icon,._3yfN3bvTDn6iN1D2ucbGPM .ms-CommandBarItem-link:not([disabled]) .ms-Button-textContainer{color:"[theme:white, default:#ffffff]"}html[dir] ._3yfN3bvTDn6iN1D2ucbGPM .ms-CommandBarItem-link:hover,html[dir] ._3yfN3bvTDn6iN1D2ucbGPM .ms-CommandBarItem:hover{background:"[theme:neutralDark, default:#212121]"}._3yfN3bvTDn6iN1D2ucbGPM .ms-CommandBarItem-link:disabled,._3yfN3bvTDn6iN1D2ucbGPM .ms-CommandBarItem-link[disabled] .ms-CommandBarItem-iconColor{color:"[theme:neutralSecondary, default:#666666]"}.owaSxS{top:48px;bottom:0;position:fixed;z-index:2;display:-webkit-box;display:-ms-flexbox;display:flex}html[dir] .owaSxS{background:"[theme:white, default:#ffffff]"}html[dir=ltr] .owaSxS,html[dir=rtl] .owaSxS{left:0;right:0}html[dir=ltr] .owaSxS .ms-CommandBar-primaryCommands{margin-left:-4px}html[dir=rtl] .owaSxS .ms-CommandBar-primaryCommands{margin-right:-4px}html[dir=ltr] .owaSxS .ms-CommandBar-sideCommands{padding-right:0;margin-right:-4px}html[dir=rtl] .owaSxS .ms-CommandBar-sideCommands{padding-left:0;margin-left:-4px}.owaSxSLeftPane{height:100%}.owaSxSLeftPane.hideReadingPane{width:100%;min-width:auto}.owaSxSRightPane{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;position:relative}html[dir=ltr] .owaSxSRightPane{border-left:1px solid "[theme:neutralLight, default:#eaeaea]"}html[dir=rtl] .owaSxSRightPane{border-right:1px solid "[theme:neutralLight, default:#eaeaea]"}.owaSxSConversation{height:calc(100% - 40px);-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;position:relative}html[dir] .owaSxSConversation{background:"[theme:white, default:#ffffff]"}._3T7Tky5hZbbqicTCA15cuI.ms-CommandBarItem-link:hover:not([disabled]) .ms-Button-icon,._3T7Tky5hZbbqicTCA15cuI.ms-CommandBarItem-link:hover:not([disabled]) .ms-Button-textContainer,._3T7Tky5hZbbqicTCA15cuI.ms-CommandBarItem-link:not([disabled]) .ms-Button-icon,._3T7Tky5hZbbqicTCA15cuI.ms-CommandBarItem-link:not([disabled]) .ms-Button-textContainer{color:"[theme:white, default:#ffffff]"}html[dir] ._3T7Tky5hZbbqicTCA15cuI.ms-Button.ms-CommandBarItem-link{background:"[theme:themeDark, default:#0D62AA]"}html[dir=ltr] ._3T7Tky5hZbbqicTCA15cuI.ms-Button.ms-CommandBarItem-link,html[dir=rtl] ._3T7Tky5hZbbqicTCA15cuI.ms-Button.ms-CommandBarItem-link{padding-left:16px;padding-right:16px}html[dir] ._3T7Tky5hZbbqicTCA15cuI.ms-Button.ms-CommandBarItem-link:hover,html[dir] ._3T7Tky5hZbbqicTCA15cuI.ms-Button.ms-CommandBarItem:hover{background:"[theme:themeDarker, default:#004578]"}._2_XVIGxUff3AgiyrGlhZHY{cursor:default;pointer-events:none}',""]),t.locals={previewPane:"_1gJeWJGIpH0WCe1r51m-ZZ",commandBar:"_28G6ftSs65A7bh-LjoaviO",commandBarWithHeroMenuItem:"F0jFoYFiV9b16KtrolsHx",contentPreview:"_2Vq5DLJWUwuXtkBcFnSv8g",highContrastCommandBar:"_3yfN3bvTDn6iN1D2ucbGPM",heroMenuItem:"_3T7Tky5hZbbqicTCA15cuI",disabledMenuItem:"_2_XVIGxUff3AgiyrGlhZHY"}},509:function(e,t,a){"use strict";a.d(t,"a",function(){return n});var r=a(244);function n(e,t){return e.map(function(e){return Object(r.getInstrumentationContext)(e,t)}).filter(function(e){return e})}},520:function(e,t,a){"use strict";a.d(t,"c",function(){return l}),a.d(t,"e",function(){return s}),a.d(t,"f",function(){return c}),a.d(t,"g",function(){return u}),a.d(t,"h",function(){return d}),a.d(t,"i",function(){return h}),a.d(t,"j",function(){return m}),a.d(t,"d",function(){return f});var r=a(1210);a.d(t,"b",function(){return r.a});var n=a(2),i=a(34);a.d(t,"a",function(){return i.h});var o=new n.c(function(){return Promise.all([a.e(6),a.e(7),a.e(25),a.e(34),a.e(57)]).then(a.bind(null,1739))}),l=new n.a(o,function(e){return e.clickAttachment}).importAndExecute,s=new n.a(o,function(e){return e.previewAttachment}),c=new n.a(o,function(e){return e.previewAttachmentInNewSxS}),u=new n.a(o,function(e){return e.previewAttachmentInSxS}),d=new n.a(o,function(e){return e.previewImageInNewSxS}),h=new n.a(o,function(e){return e.previewImageInSxS}),m=new n.a(o,function(e){return e.previewLinkInNewSxS}),f=new n.b(o,function(e){return e.downloadAttachment})},5612:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a(1),i=a(4488),o=a(90).bind(i),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return n.createElement("div",{className:i.messageContainer},n.createElement("div",{className:o(i.messageText,this.props.isHighContrast&&i.highContrastMessageText)},this.props.message))},t}(n.Component),s=a(14),c=a(9),u=a(34),d=a(2648),h=a(11),m=a.n(h),f=a(3458),p=a(90).bind(f),v=function(e){function t(t){var a=e.call(this,t)||this;return a.onLoad=function(){a.props.viewState.perfDatapoint&&a.props.viewState.perfDatapoint.end()},a.onError=function(){a.props.viewState.perfDatapoint&&a.props.viewState.perfDatapoint.endWithError(c.a.ServerError,new Error("Audio fails to load")),Object(d.a)(r.__assign({},u.y.state,{mode:u.g.Error}))},a.state={hasError:!1},a}return r.__extends(t,e),t.prototype.render=function(){var e=p(this.props.mainCssClass,f.container);return n.createElement("div",{className:e},n.createElement("span",null),!this.state.hasError&&n.createElement("audio",{src:this.props.viewState.downloadUrl,controls:!0,autoPlay:!0,onError:this.onError,onLoad:this.onLoad}),this.state.hasError&&n.createElement(l,{message:m.a.errorMediaAttachment}))},t=r.__decorate([s.observer],t)}(n.Component),b=a(1889),w=a(567),g=a(4491),S=a(90).bind(g),k=function(e){function t(t){var a=e.call(this,t)||this;return a.onLoad=function(){a.props.viewState.perfDatapoint&&a.props.viewState.perfDatapoint.end(),a.setState({hideSpinner:!0})},a.state={hideSpinner:!1},a}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=S(this.props.className,g.main);return n.createElement("div",{className:t},n.createElement("div",{className:g.container},n.createElement(b.a,{type:w.b.large,className:S({hideSpinner:this.state.hideSpinner})})),n.createElement("iframe",{className:g.preview,src:this.props.viewState.previewUrl,ref:function(t){e.iframeElement=t}}))},t.prototype.componentDidMount=function(){this.iframeElement&&(this.iframeElement.onload=this.onLoad)},t=r.__decorate([s.observer],t)}(n.Component),y=a(1823),x=a(1587),P=a(73),I=a(2234),_=a(519),O=a(2641),C=a(595),j=a(191),B=a(2985),A=a(4),D=Object(A.action)("setImageFromGalleryItem")(function(e,t,a){var r=new c.c(I.a.SetImageFromGalleryItem.datapoint.name),n=e.previewUrl===t.previewUrl&&e.imageLoaded;e.attachmentId=t.attachmentId,e.name=t.name,e.size=t.size,e.downloadUrl=t.downloadUrl,e.isDownloadDisabled=t.isDownloadDisabled,e.saveToCloudStatus=t.isSaveToCloudEnabled?_.b.available:_.b.disabled,e.previewUrl=t.previewUrl,e.imageLoaded=n,e.isImageLoading=!n,e.itemId=t.parentItemId,e.isCloudy=t.isCloudy,e.perfDatapoint=r;var i=Object(j.b)(t.name||"")||"";r.addCustomData(I.a.SetImageFromGalleryItem.datapoint.customData(i,t.isCloudy?"cloudy":"classic",a));var o=Object(C.a)(t.attachmentId);o&&Object(O.a)(t.attachmentId,!0).then(function(){var t=o.previewImage.url;e.previewUrl=t},function(t){r.endWithError(c.a.ServerError,t),Object(B.a)(e)})}),E=a(246),T=a(524),L=a(93),N=a(4493),R=a(90).bind(N),U=164,G=function(e){function t(t){var a=e.call(this,t)||this;return a.onScrollRegionElementUpdated=function(e){a.scrollRegion=e,a.delayedUpdateArrowVisibility()},a.onResize=function(){a.delayedUpdateArrowVisibility()},a.delayedUpdateArrowVisibility=function(){a.updateArrowVisibilityTimeoutHandle&&clearTimeout(a.updateArrowVisibilityTimeoutHandle),a.updateArrowVisibilityTimeoutHandle=setTimeout(function(){a.updateArrowVisibility()},100)},a.updateArrowVisibility=function(e){void 0===e&&(e=a.state.scrollPosition),a.updateArrowVisibilityTimeoutHandle=null;var t=!0,r=!0;if(a.scrollRegion){if(t=!1,r=!1,e<0)e=0;else{var n=(a.props.imageGallery&&a.props.imageGallery.length)*U;n<a.scrollRegion.clientWidth?e=0:e+a.scrollRegion.clientWidth>n&&(e=n-a.scrollRegion.clientWidth)}0===e&&(t=!0);var i=(a.props.imageGallery&&a.props.imageGallery.length)*U;e+a.scrollRegion.clientWidth>=i&&(r=!0)}a.state.leftArrowHidden===t&&a.state.rightArrowHidden===r&&a.state.scrollPosition===e||a.setState({leftArrowHidden:t,rightArrowHidden:r,scrollPosition:e})},a.onLeftButtonClicked=function(){a.setScrollPosition(a.state.scrollPosition-a.GetDistanceToScroll())},a.onRightButtonClicked=function(){a.setScrollPosition(a.state.scrollPosition+a.GetDistanceToScroll())},a.onThumbnailClicked=function(e){D(a.props.viewState,e,"filmStrip"),e.parentItemId&&P.n.importAndExecute(e.parentItemId.Id)},a.state={leftArrowHidden:!0,rightArrowHidden:!0,scrollPosition:0},a}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=R(N.main,this.props.imageGallery&&this.props.imageGallery.length>1&&N.show),a=N.leftArrowContainer,r=R(N.arrowButton,this.state.leftArrowHidden&&N.hidden),i=N.rightArrowContainer,o=R(N.arrowButton,this.state.rightArrowHidden&&N.hidden),l={transform:"translate3d(-"+this.state.scrollPosition+"px,0px,0px)"};return n.createElement("div",{className:t},n.createElement("div",{className:N.filmStrip},n.createElement(T.IconButton,{className:a,onClick:this.onLeftButtonClicked,iconProps:{iconName:"CaretLeftSolid8",styles:{root:r}},styles:{root:N.arrowButtonContainer}}),n.createElement(T.IconButton,{className:i,onClick:this.onRightButtonClicked,iconProps:{iconName:"CaretRightSolid8",styles:{root:o}},styles:{root:N.arrowButtonContainer}}),n.createElement("div",{className:N.scrollArea,ref:this.onScrollRegionElementUpdated},n.createElement("div",{style:l},this.props.imageGallery&&this.props.imageGallery.map(function(t){return n.createElement(y.a,{key:t.attachmentId.Id,src:t.thumbnailUrl,width:160,height:120,className:R(N.thumbnail,Object(L.c)(t.attachmentId,e.props.viewState.attachmentId)&&N.selected),imageFit:x.b.cover,onClick:function(){return e.onThumbnailClicked(t)}})})))))},t.prototype.componentWillUpdate=function(e,t){(this.props.readingPaneHidden!==e.readingPaneHidden||!this.props.imageGallery&&e.imageGallery||this.props.imageGallery&&e.imageGallery&&this.props.imageGallery.length!==e.imageGallery.length||this.props.viewState.attachmentId!==e.viewState.attachmentId)&&this.delayedUpdateArrowVisibility()},t.prototype.componentDidUpdate=function(){var e=this;this.props.imageGallery&&this.props.viewState.attachmentId&&!Object(L.c)(this.previousAttachmentId,this.props.viewState.attachmentId)&&this.props.imageGallery.forEach(function(t,a){if(Object(L.c)(e.props.viewState.attachmentId,t.attachmentId)){var r=a*U,n=r+U,i=e.scrollRegion.clientWidth,o=e.state.scrollPosition,l=o+i;o>r?e.setScrollPosition(r):l<n&&e.setScrollPosition(n-i)}},this),this.previousAttachmentId=this.props.viewState.attachmentId},t.prototype.componentDidMount=function(){document.addEventListener("fullscreenchange",this.onResize),document.addEventListener("webkitfullscreenchange",this.onResize),document.addEventListener("mozfullscreenchange",this.onResize),document.addEventListener("MSFullscreenChange",this.onResize),document.addEventListener("fullscreenChange",this.onResize),E.b.importAndExecute(this.onResize)},t.prototype.componentWillUnmount=function(){document.removeEventListener("fullscreenchange",this.onResize),document.removeEventListener("webkitfullscreenchange",this.onResize),document.removeEventListener("mozfullscreenchange",this.onResize),document.removeEventListener("MSFullscreenChange",this.onResize),document.removeEventListener("fullscreenChange",this.onResize),E.d.importAndExecute(this.onResize)},t.prototype.setScrollPosition=function(e){e!==this.state.scrollPosition&&this.updateArrowVisibility(e)},t.prototype.GetDistanceToScroll=function(){return this.scrollRegion.clientWidth-U},t=r.__decorate([s.observer],t)}(n.Component),H=a(4495),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return n.createElement("div",{className:H.messageContainer},n.createElement("div",null,n.createElement(b.a,{type:w.b.large})),n.createElement("div",{className:H.messageText},this.props.message))},t}(n.Component),F=a(149),z=[F.b.Image],V=null;function W(e){V=e}function q(e){return e?e.requestFullscreen||e.msRequestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen:null}function J(){var e=document;document.exitFullscreen?document.exitFullscreen():e.msExitFullscreen?e.msExitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():e.mozCancelFullScreen&&e.mozCancelFullScreen()}var Z,K,X=a(541),Q=Object(A.action)("setImageLoaded")(function(e){e.imageLoaded=!0,e.isImageLoading=!1}),Y=a(4497),$=a(90).bind(Y),ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.currentIndex=-1,t.onImageLoad=function(e){e.end(),t.props.viewState.perfDatapoint&&t.props.viewState.perfDatapoint.end(),Q(t.props.viewState)},t.onError=function(e){var a=new Error("Image fails to load");e.endWithError(c.a.ServerError,a),t.props.viewState.perfDatapoint&&t.props.viewState.perfDatapoint.endWithError(c.a.ServerError,a),Object(B.a)(t.props.viewState)},t.onKeyDown=function(e){var a="keyboardNav";switch(e.which){case 37:if(t.props.imagePreviewUseExternalArrowCallback)t.props.onImagePreviewPreviousButtonClicked&&t.props.onImagePreviewPreviousButtonClicked(null);else if(t.props.imageGallery)if(t.currentIndex>0){var r=t.props.imageGallery[t.currentIndex-1];t.setCurrentGalleryItem(r,a)}else if(0===t.currentIndex){var n=t.props.imageGallery[t.props.imageGallery.length-1];t.setCurrentGalleryItem(n,a)}e.preventDefault(),e.stopPropagation();break;case 39:if(t.props.imagePreviewUseExternalArrowCallback)t.props.onImagePreviewNextButtonClicked&&t.props.onImagePreviewNextButtonClicked(null);else if(t.props.imageGallery&&t.currentIndex>=0)if(t.currentIndex<t.props.imageGallery.length-1){var i=t.props.imageGallery[t.currentIndex+1];t.setCurrentGalleryItem(i,a)}else{var o=t.props.imageGallery[0];t.setCurrentGalleryItem(o,a)}e.preventDefault(),e.stopPropagation()}},t.setCurrentGalleryItem=function(e,a){D(t.props.viewState,e,a),e.parentItemId&&P.n.importAndExecute(e.parentItemId.Id)},t}return r.__extends(t,e),t.prototype.componentWillUnmount=function(){W(null)},t.prototype.render=function(){var e=this,t=$(this.props.mainCssClass,Y.main),a=$(Y.arrowContainer,Y.prevArrowContainer),r=$(Y.arrowContainer,Y.nextArrowContainer),i=null,o=null;if(this.props.imagePreviewUseExternalArrowCallback)i=this.props.onImagePreviewNextButtonClicked,o=this.props.onImagePreviewPreviousButtonClicked;else if(this.props.imageGallery){this.currentIndex=-1;for(var s=0;s<this.props.imageGallery.length;s++)if(Object(L.c)(this.props.imageGallery[s].attachmentId,this.props.viewState.attachmentId)){this.currentIndex=s;break}if(-1!==this.currentIndex){if(this.currentIndex>0){var u=this.props.imageGallery[this.currentIndex-1];o=function(){return e.setCurrentGalleryItem(u,"arrowButton")}}if(this.currentIndex<this.props.imageGallery.length-1){var d=this.props.imageGallery[this.currentIndex+1];i=function(){return e.setCurrentGalleryItem(d,"arrowButton")}}}}var h=new c.c(I.a.SxSImagePreviewLoadTime.datapoint.name);return n.createElement("div",{ref:function(e){return W(e)},className:t},n.createElement("div",{className:Y.imageContainer,ref:function(t){return e.imageDiv=t},onKeyDown:this.onKeyDown,"data-is-focusable":!0,tabIndex:0},n.createElement("span",null),(this.props.viewState.previewUrl||!this.props.viewState.isImageLoading)&&n.createElement("img",{className:!this.props.viewState.imageLoaded||this.props.viewState.isImageLoading?Y.imageLoading:null,src:this.props.viewState.previewUrl,onError:function(){return e.onError(h)},onLoad:function(){return e.onImageLoad(h)}}),this.props.viewState.isImageLoading&&n.createElement(M,{message:null}),!this.props.viewState.isImageLoading&&!this.props.viewState.imageLoaded&&n.createElement(l,{message:m.a.errorImageAttachment,isHighContrast:!0})),o&&n.createElement(T.IconButton,{onClick:o,iconProps:{iconName:"ChevronLeft",styles:{root:Y.arrowButton}},styles:{root:a}}),i&&n.createElement(T.IconButton,{onClick:i,iconProps:{iconName:"ChevronRight",styles:{root:Y.arrowButton}},styles:{root:r}}),n.createElement(X.a,{onClick:J,className:Y.exitFullScreenButton,iconProps:{iconName:"Cancel",styles:{root:Y.exitFullScreenIcon}},text:m.a.exitFullScreen}),!this.props.imagePreviewUseExternalArrowCallback&&n.createElement(G,{imageGallery:this.props.imageGallery,readingPaneHidden:this.props.readingPaneHidden,viewState:this.props.viewState}))},t.prototype.focus=function(){this.imageDiv&&this.imageDiv.focus()},t=r.__decorate([s.observer],t)}(n.Component),te=a(773),ae=a(27),re=a(1378),ne=a(4499),ie=a(90).bind(ne),oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lastPerfDatapoint=null,t}return r.__extends(t,e),t.prototype.render=function(){var e=ie(this.props.className,ne.container);return n.createElement("div",{className:e},this.props.item||this.props.itemViewState&&this.props.itemViewState.loadingState&&this.props.itemViewState.loadingState.hasLoadFailed?n.createElement(te.b,{itemId:this.props.viewState.attachmentId,isItemAttachment:!0,itemReadingPaneViewState:this.props.itemViewState,storePrintItemReadingPaneViewState:P.r}):n.createElement(M,{message:null}))},t.prototype.componentDidUpdate=function(){this.props.item&&this.props.viewState.perfDatapoint&&this.props.viewState.perfDatapoint!==this.lastPerfDatapoint&&(this.lastPerfDatapoint=this.props.viewState.perfDatapoint,this.props.viewState.perfDatapoint.end())},t=r.__decorate([Object(re.reactive)({item:function(e){return Object(ae.c)().items.get(e.viewState.attachmentId.Id)},itemViewState:function(){return P.q.itemPreviewPaneViewState}}),s.observer],t)}(n.Component),le=a(4501),se=a(90).bind(le),ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.previousPerfDataPoint=null,t}return r.__extends(t,e),t.prototype.render=function(){var e=se(this.props.mainCssClass,le.main);return this.props.viewState.perfDatapoint&&this.props.viewState.mode===_.a.View&&this.previousPerfDataPoint!==this.props.viewState.perfDatapoint&&(this.previousPerfDataPoint=this.props.viewState.perfDatapoint,this.previousPerfDataPoint.end()),n.createElement("div",{className:e},this.shouldShowActivityIndicator()&&n.createElement(M,{message:""}),this.props.viewState.mode===_.a.View&&n.createElement("object",{key:this.props.viewState.previewUrl,className:le.object,data:this.props.viewState.previewUrl,type:this.props.viewState.mediaType}),this.props.viewState.mode===_.a.Error&&n.createElement(l,{message:this.props.viewState.errorMessage}))},t.prototype.shouldShowActivityIndicator=function(){return this.props.viewState.mode===_.a.PendingUrl||this.props.viewState.mode===_.a.View},t=r.__decorate([s.observer],t)}(n.Component),ue=a(4503),de=a(90).bind(ue),he=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.previousPerfDataPoint=null,t}return r.__extends(t,e),t.prototype.render=function(){var e=de(this.props.className,ue.main);return this.props.viewState.perfDatapoint&&this.props.viewState.mode===_.a.View&&null!==this.props.viewState.textContent&&this.previousPerfDataPoint!==this.props.viewState.perfDatapoint&&(this.previousPerfDataPoint=this.props.viewState.perfDatapoint,this.previousPerfDataPoint.end()),n.createElement("div",{className:e,"data-is-focusable":!0,tabIndex:0},this.props.viewState.mode===_.a.View&&null===this.props.viewState.textContent&&n.createElement(M,{message:""})||n.createElement("pre",{className:de(ue.textContent,"allowTextSelection")},this.props.viewState.textContent),this.props.viewState.mode===_.a.Error&&n.createElement(l,{message:this.props.viewState.errorMessage}))},t=r.__decorate([s.observer],t)}(n.Component),me=a(3458),fe=a(90).bind(me),pe=function(e){function t(t){var a=e.call(this,t)||this;return a.onVideoElementChanged=function(e){e&&(e.addEventListener("error",a.onError),e.addEventListener("loadeddata",a.onLoad))},a.onLoad=function(){a.props.viewState.perfDatapoint&&a.props.viewState.perfDatapoint.end()},a.onError=function(){a.props.viewState.perfDatapoint&&a.props.viewState.perfDatapoint.endWithError(c.a.ServerError,new Error("Video fails to load")),Object(d.a)(r.__assign({},u.y.state,{mode:u.g.Error}))},a.state={hasError:!1},a}return r.__extends(t,e),t.prototype.render=function(){var e=fe(this.props.className,me.container);return n.createElement("div",{className:e},n.createElement("span",null),!this.state.hasError&&n.createElement("video",{src:this.props.viewState.downloadUrl,controls:!0,autoPlay:!0,ref:this.onVideoElementChanged}),this.state.hasError&&n.createElement(l,{message:m.a.errorMediaAttachment}))},t=r.__decorate([s.observer],t)}(n.Component),ve=a(82),be=a(3095),we=a(2565),ge=a(3335),Se=a(256),ke=Object(A.select)({previewPaneStore:function(){return Se.a}})(Object(A.action)("setPreviewPaneFinishedSaving")(function(e){var t=e.previewPaneStore.pendingState;e.previewPaneStore.state.mode=_.a.NoUrl,Object(ge.a)(t)})),ye=a(2835),xe=a(7),Pe=a(4505),Ie=a(90).bind(Pe),_e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.endPerfDatapointForCloudyDoc=function(){t.props.viewState.isCloudy&&t.props.viewState.mode===_.a.View&&t.props.viewState.perfDatapoint&&t.props.viewState.perfDatapoint.end()},t.onReceivePostMessage=function(e){if(t.currentWacUrl&&0===t.currentWacUrl.toLowerCase().indexOf(e.origin.toLowerCase())){var a=null;try{a=JSON.parse(e.data)}catch(t){xe.c.warn("Unable to parse post message data: "+e.data)}if(a&&"App_LoadingStatus"===a.MessageId){t.props.viewState.mode===_.a.View&&t.props.viewState.perfDatapoint&&t.props.viewState.perfDatapoint.end();var r=0,n=0;try{r=window.performance.timing.fetchStart,n=window.performance.navigation.redirectCount}catch(e){xe.c.warn("FetchStart or RedirectCount is not supported by the browser.")}a.MessageId="Host_PerfTiming",a.SendTime=(new Date).getTime(),a.Values={Click:t.props.viewState.clickTime,Iframe:t.iframeCreationTime,HostFrameFetchStart:r,RedirectCount:n};try{t.iframeElement.contentWindow.postMessage(JSON.stringify(a),e.origin)}catch(e){xe.c.warn("PostMessage to WAC iframe resulted in an exception: "+e)}}}},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t={iframeSaving:this.props.viewState.mode===_.a.Saving||this.props.viewState.mode===_.a.Copying};return n.createElement("div",{ref:function(t){return e.containerDiv=t},className:Ie(this.props.mainCssClass,Pe.iframeContainer,t)},this.shouldShowActivityIndicator()&&n.createElement(M,{message:this.getBusyLabel(this.props.viewState.mode)}),this.props.viewState.mode===_.a.Error&&n.createElement(l,{message:this.props.viewState.errorMessage}))},t.prototype.componentDidMount=function(){window.addEventListener("message",this.onReceivePostMessage,!1),this.componentDidUpdate()},t.prototype.componentDidUpdate=function(){switch(this.props.viewState.mode){case _.a.NoUrl:this.iframeElement&&(this.iframeElement.src="about:blank");break;case _.a.Copying:case _.a.Error:case _.a.PendingUrl:this.iframeElement&&(this.iframeElement.src="about:blank");break;case _.a.View:this.props.viewState.wacUrl&&(this.createIframeIfNeeded(),Object(be.a)(this.iframeElement,this.props.viewState.wacUrl[0],this.props.viewState.wacUrl[1],this.endPerfDatapointForCloudyDoc),this.currentWacUrl=this.props.viewState.wacUrl[0]);break;case _.a.Edit:this.createIframeIfNeeded(),Object(be.a)(this.iframeElement,this.props.viewState.wacEditUrl[0],this.props.viewState.wacEditUrl[1],this.endPerfDatapointForCloudyDoc),this.currentWacUrl=this.props.viewState.wacEditUrl[0];break;case _.a.Saving:this.iframeElement&&(this.iframeElement.onload=this.OnLoadForSaving.bind(this),this.iframeElement.src="about:blank");break;default:Object(ve.a)(this.props.viewState.mode)}},t.prototype.componentWillUnmount=function(){window.removeEventListener("message",this.onReceivePostMessage,!1)},t.prototype.createIframeIfNeeded=function(){if(!this.iframeElement){this.iframeCreationTime=(new Date).getTime();var e=document.createElement("iframe");this.containerDiv.appendChild(e),this.iframeElement=e}},t.prototype.shouldShowActivityIndicator=function(){return this.props.viewState.mode===_.a.NoUrl||this.props.viewState.mode===_.a.Saving||this.props.viewState.mode===_.a.Copying||this.props.viewState.mode===_.a.PendingUrl},t.prototype.OnLoadForSaving=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,a;return r.__generator(this,function(r){switch(r.label){case 0:return this.iframeElement.onload=null,e=this.props.viewState.attachmentId,t=e.Id,a=e.mailboxInfo,[4,Object(ye.b)(t,a&&a.requestOptions)];case 1:return r.sent(),this.props.hasPendingState?ke():Object(we.a)("wacEdit"),[2]}})})},t.prototype.getBusyLabel=function(e){switch(e){case _.a.Copying:return this.props.viewState.isCloudy?m.a.EditingInTheCloudMessage:m.a.MakingACopyMessage;case _.a.Saving:return this.props.viewState.isCloudy?m.a.SavingToCloudLabel:m.a.SavingLabel;default:return""}},t=r.__decorate([s.observer],t)}(n.Component),Oe=a(379);function Ce(e){var t=I.a.SxSPrint.datapoint,a=t.name,r=t.customData;Object(c.n)(a,r(e,Object(Oe.a)()))}(K=Z||(Z={})).NativeViewableDocument="NativeViewableDocument",K.Image="Image";var je=a(136),Be=a(1348),Ae=a(520),De=a(91),Ee=a(678),Te=a(3375),Le=a(3455),Ne=a(2794),Re=a(2397),Ue=a(1548),Ge=a(198),He=Object(A.select)({previewPaneStore:function(){return Se.a}})(Object(A.action)("editInDraftItem")(function(e,t,a,n){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return n=n,Object(Le.a)(n.previewPaneStore.state.attachmentId,0,u.h[Se.a.previewSelectionSource]),n.previewPaneStore.state.mode=_.a.PendingUrl,[4,Fe(e,t,!1,a,null,n.previewPaneStore)];case 1:return r.sent(),[2]}})})})),Me=Object(A.select)({previewPaneStore:function(){return Se.a}})(Object(A.action)("editAndReply")(function(e,t,a,n,i){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(r){switch(r.label){case 0:i=i,Object(Le.a)(t,1,u.h[Se.a.previewSelectionSource]),i.previewPaneStore.state.mode=_.a.Copying,e=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n()];case 2:return e=r.sent(),[3,4];case 3:return r.sent(),i.previewPaneStore.state.mode=_.a.Error,i.previewPaneStore.state.errorMessage=m.a.EditAndReplyErrorText,[2];case 4:return[4,Fe(e,t,!0,a,function(){var t;t=e,Object(Ge.d)("deleteItemFromReadingPane",m.a.errorDeletingItem,function(){return Object(Ue.a)([t],"HardDelete")})},i.previewPaneStore)];case 5:return r.sent(),[2]}})})}));function Fe(e,t,a,n,i,o){return r.__awaiter(this,void 0,void 0,function(){var l;return r.__generator(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,function e(t,a,n){return r.__awaiter(this,void 0,void 0,function(){var i,o;return r.__generator(this,function(l){switch(l.label){case 0:return[4,Object(Re.a)(t.Id,!0,a?a.Id:null,t.mailboxInfo&&t.mailboxInfo.requestOptions,n)];case 1:if(!(i=l.sent())||!i.IsConversion||0!==i.Status)return[3,7];o=document.createElement("iframe"),l.label=2;case 2:return l.trys.push([2,,4,5]),o.style.borderWidth="0",o.style.position="absolute",o.style.width=o.style.height="1px",document.body.appendChild(o),Object(be.a)(o,i.WacUrl,i.Token),[4,Object(ye.b)(i.AttachmentId.Id,t.mailboxInfo&&t.mailboxInfo.requestOptions)];case 3:return l.sent(),[3,5];case 4:return document.body.removeChild(o),[7];case 5:return[4,e(r.__assign({},i.AttachmentId,{mailboxInfo:t.mailboxInfo}),null,n)];case 6:i=l.sent(),l.label=7;case 7:return[2,i]}})})}(t,a?e:null,u.h[o.previewSelectionSource])];case 1:return 0!==(l=s.sent()).Status?(ze(o,i,l.Status),[2]):[3,3];case 2:return s.sent(),ze(o,i,1),[2];case 3:return o.state=r.__assign({},o.state,{attachmentId:r.__assign({},l.AttachmentId,{mailboxInfo:t.mailboxInfo}),itemId:e,mode:_.a.Edit,wacEditUrl:[l.WacUrl,l.Token]}),[4,n(e)];case 4:return s.sent(),[2]}})})}function ze(e,t,a){t&&t(),e.state.mode=_.a.Error,e.state.errorMessage=Object(Ne.a)(a)}var Ve=Object(A.action)("setSaveToCloudStatus")(function(e,t,a,r){if(Object(L.c)(t.attachmentId,a)&&(t.saveToCloudStatus=e),r)for(var n=0,i=r;n<i.length;n++){var o=i[n];Object(L.c)(o.attachmentId,a)&&(o.isSaveToCloudEnabled=!1)}}),We=a(2792),qe=a(2620);var Je=a(2302),Ze=a(3459),Ke=a(666),Xe=a.n(Ke),Qe=a(278);function Ye(e,t){var a="";null!=t.state.isCloudy&&(a=t.state.isCloudy?"Cloudy":"Classic"),Object(c.n)("FilePreviewActionClicked",{Action:e,FileExtensionType:F.b[t.state.type],PreviewSource:u.h[t.previewSelectionSource],FileType:a})}function $e(e,t,a,n,i,o,l,s){return void 0===a&&(a=[]),void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===l&&(l=null),[function(){var e=this,a=function(){switch(t.state.addToCalendarStatus){case 1:return m.a.AddToCalendarText;case 2:return Xe.a.ImportingText;case 3:return m.a.AddToCalendarSuccessMessgaeWithIcon;case 4:return Xe.a.ICSFileErrorText;default:return""}}();return new De.b(a,"Add",function(){return r.__awaiter(e,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return 1!==t.state.addToCalendarStatus?[3,2]:[4,Ee.c.import()];case 1:e.sent()(t.state,null),e.label=2;case 2:return[2]}})})},function(){return t.state.type===F.b.CalendarEvent&&0!==t.state.addToCalendarStatus},null,null,null,null,null,null,a,null,1!==t.state.addToCalendarStatus?i:null)}(),(h=new De.b(m.a.EditButtonLabel,"Edit",function(){Ye("edit",t),He(e,t.state.attachmentId,o)},function(){return t.state.type===F.b.Wac&&t.state.editAllowed&&t.state.mode===_.a.View&&t.state.isDraft&&!t.conversation&&null!=e},null,null,null,null,null,null,m.a.EditButtonLabel),h.className=n,h),(d=new De.b(m.a.EditAndReplyButtonLabel,"PencilReply",function(){Ye("editAndReply",t),Me(e,t.state.attachmentId,o,function(){return l(e)})},function(){return t.state.type===F.b.Wac&&t.state.editAllowed&&t.state.mode===_.a.View&&!t.state.isDraft&&!t.conversation&&null!=e},null,null,null,null,null,null,m.a.EditAndReplyButtonLabel),d.className=n,d),function(){var e=function(){if(t.state.type!==F.b.GoogleDoc)return null;switch(t.state.contentType){case"application/vnd.google-apps.document":return m.a.openInGoogleDocs;case"application/vnd.google-apps.spreadsheet":return m.a.openInGoogleSheets;case"application/vnd.google-apps.presentation":return m.a.openInGoogleSlides;default:throw new Error("Unexpected value of Google contentType")}}();return new De.b(e,"OpenInNewWindow",function(){Ye("openInGoogle",t),window.open(t.state.downloadUrl)},function(){return t.state.type===F.b.GoogleDoc},null,null,null,null,null,null,e)}(),new De.b(m.a.downloadText,"Download",function(){Ye("download",t),Ae.d.import().then(function(e){e(t.state.downloadUrl,t.previewSelectionSource==u.h.GroupFilesHub)})},function(){return!t.state.isDownloadDisabled},null,null,null,null,null,null,m.a.downloadText),new De.b(m.a.fullScreen,"FullScreen",function(){var e;Ye("fullScreen",t),(e=q(V))&&e.call(V)},function(){return e=t.state.type,-1!=z.indexOf(e)&&!!q(document.createElement("div"));var e}),new De.b(m.a.showEmail,"RedEye",function(){Ye("showEmail",t),Object(Je.a)(Qe.a.Show,!0)},function(){return t.readingPaneDisplay===Qe.a.Hide||t.hideReadingPane&&(t.readingPaneDisplay===Qe.a.Default||t.readingPaneDisplay===Qe.a.Show)},null,null,null,null,null,null,m.a.showEmail),new De.b(m.a.hideEmail,"Hide",function(){Ye("HideEmail",t),Object(Je.a)(Qe.a.Hide,!0)},function(){return(t.readingPaneDisplay===Qe.a.Default||t.readingPaneDisplay===Qe.a.Show)&&!t.hideReadingPane},null,null,null,null,null,null,m.a.hideEmail),new De.b(m.a.printAttachment,null,function(){Ye("printAttachment",t),t.state.type===F.b.PdfJs&&Ze.a.importAndExecute()},function(){return t.state.type===F.b.PdfJs&&!t.state.isDownloadDisabled}),new De.b(m.a.printAttachment,"Print",function(){Ye("printDocument",t),window.open(t.state.printUrl,"_blank"),Ce("NativeViewableDocument")},function(){return Object(Be.a)()&&t.state.type===F.b.NativeView&&null!==t.state.printUrl},null,null,null,null,null,null,m.a.printAttachment),new De.b(m.a.printAttachment,"Print",function(){Ye("printImage",t),s(),Ce("Image")},function(){return Object(je.b)("doc-SxS-printImage")&&t.state.type===F.b.Image&&null!==t.state.previewUrl},null,null,null,null,null,null,m.a.printAttachment),new De.b(null,"Cancel",function(){t.state.mode===_.a.View||t.state.mode===_.a.PendingUrl||t.state.mode===_.a.Error?Object(we.a)("commandBarButton"):Object(Te.a)()},null,1,!(t.state.mode===_.a.View||t.state.mode===_.a.Edit||t.state.mode===_.a.PendingUrl||t.state.mode===_.a.Error),null,null,null,null,m.a.CloseText)].concat(a).concat(function(){var a=function(){switch(t.state.saveToCloudStatus){case _.b.available:var a=e&&e.mailboxInfo&&e.mailboxInfo.type===L.a.GroupMailbox;return a?m.a.SaveOneFileToGroupFilesText:m.a.SaveOneFileToOneDriveConsumerText;case _.b.saving:return m.a.SavingLabel;case _.b.succeeded:return m.a.SavedOneFileToOneDriveSxSText;case _.b.failed:return m.a.FailedSaveToOneDriveSxSText;default:return""}}();return new De.b(a,null,function(){Ye("saveToCloud",t),t.state.saveToCloudStatus===_.b.available&&function(e,t,a){r.__awaiter(this,void 0,void 0,function(){var n,i,o,l;return r.__generator(this,function(r){switch(r.label){case 0:return n=new c.c(I.a.SxSSaveToCloud.datapoint.name),i=e.attachmentId,o=function(r){return n.addCustomData(I.a.SxSSaveToCloud.datapoint.customData(e.size,r.ResultCode,a)),0===r.ResultCode?(Ve(_.b.succeeded,e,i,t),Object(We.a)(i,r.Item.Location),n.end()):(Ve(_.b.failed,e,i,t),n.endWithError(c.a.ServerError,new Error(r.Exception))),!0},l=function(r){Ve(_.b.failed,e,i,t),n.addCustomData(I.a.SxSSaveToCloud.datapoint.customData(e.size,1,a)),n.endWithError(c.a.ServerError,new Error(r))},Ve(_.b.saving,e,i,t),[4,Object(qe.b)(e.attachmentId,null,o,l)];case 1:return r.sent(),[2]}})})}(t.state,t.imageGallery,u.h[t.previewSelectionSource])},function(){return Object(je.b)("doc-SxS-saveToCloud")&&t.state.saveToCloudStatus!==_.b.disabled},null,null,null,null,null,null,a,null,t.state.saveToCloudStatus!==_.b.available?i:null)}());var d,h}var et=[".odp",".pot",".potm",".potx",".pps",".ppsm",".ppsx",".ppt",".pptm",".pptx"];var tt=a(162),at=a(250),rt=a(54),nt=Object(A.select)({conversations:function(){return ae.a.conversations},conversationNodes:function(){return ae.a.conversationNodes},items:function(){return ae.a.items}})(function(e,t,a){var r=a.conversations.get(e);if(!e||!r)return null;for(var n=0,i=r.conversationNodeIds;n<i.length;n++)for(var o=i[n],l=0,s=a.conversationNodes.get(o).itemIds;l<s.length;l++){var c=s[l],u=a.items.get(c);if(u.Attachments)for(var d=0,h=u.Attachments;d<h.length;d++){if(h[d].AttachmentId.Id===t)return u.ItemId}}return null}),it=Object(A.select)({previewPaneStore:function(){return Se.a}})(Object(A.action)("associatePreviewPaneWithItem")(function(e,t){return r.__awaiter(this,void 0,void 0,function(){var a,n,i,o;return r.__generator(this,function(l){switch(l.label){case 0:return!t.previewPaneStore.state||t.previewPaneStore.state.itemId?[2]:(a=t.previewPaneStore.state.attachmentId,n=a.Id,i=a.mailboxInfo,[4,nt(e,n)]);case 1:return(o=l.sent())&&(t.previewPaneStore.state.itemId=r.__assign({},o,{mailboxInfo:i})),[2]}})})})),ot=a(2),lt=new ot.c(function(){return Promise.all([a.e(27),a.e(189)]).then(a.bind(null,5696))}),st=Object(ot.d)(lt,function(e){return e.PdfJsPreview}),ct=a(1331),ut=a(64),dt=a(4507),ht=a(90).bind(dt);Object(ut.subscribe)(rt.b,function(e){return it(e)});var mt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.print=function(){ct.a.importAndExecute(t.getImageHtmlString(),t.getImageCSSString())},t.getImageHtmlString=function(){var e=t.props.viewState.previewUrl,a=document.createElement("div"),r=document.createElement("img");return r.src=e,a.appendChild(r),a.innerHTML},t.getImageCSSString=function(){return"img {max-width: 100%; max-height: 100%; width: auto;  }"},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.imagePreview&&this.imagePreview.focus(),this.props.didMountCallback&&this.props.didMountCallback()},t.prototype.componentDidUpdate=function(){this.imagePreview&&this.imagePreview.focus()},t.prototype.componentWillUnmount=function(){at.h.import().then(function(e){e(Se.a.previewSelectionSource)})},t.prototype.render=function(){var e=this;if(!this.props.viewState)return null;var t=this.props.viewState.itemId;!t&&P.q.conversationReadingPaneViewState&&it(P.q.conversationReadingPaneViewState.conversationId.Id);var a=this.props.viewState&&this.props.viewState.type,r=$e(t,Se.a,this.props.customFilterableMenuItems,dt.heroMenuItem,dt.disabledMenuItem,this.props.loadDraftToCompose,this.props.createReply,this.print),i=ht(dt.commandBar,function(e){if(e){if(e.type==F.b.Image||e.type==F.b.Audio)return!0;if(e.type==F.b.Wac&&e.name){var t=e.name.lastIndexOf(".");if(t>=0){var a=e.name.substr(t).toLowerCase();return et.indexOf(a)>=0}}}return!1}(this.props.viewState)&&dt.highContrastCommandBar,function(e,t){for(var a=0,r=e;a<r.length;a++){var n=r[a];if(n.shouldShow())return n.className===t}return!1}(r,dt.heroMenuItem)&&dt.commandBarWithHeroMenuItem);return n.createElement("div",{className:ht(this.props.mainCssClass,dt.previewPane),"data-min-width":u.c,style:this.props.style},n.createElement(De.a,{className:i,filterableItems:r,elipisisAriaLabel:m.a.previewPaneEllipsisAriaLabelText}),a===F.b.Image&&n.createElement(ee,{ref:function(t){return e.imagePreview=t},imagePreviewUseExternalArrowCallback:this.props.imagePreviewUseExternalArrowCallback,mainCssClass:dt.contentPreview,onImagePreviewNextButtonClicked:this.props.onImagePreviewNextButtonClicked,onImagePreviewPreviousButtonClicked:this.props.onImagePreviewPreviousButtonClicked,viewState:this.props.viewState,readingPaneHidden:Se.a.hideReadingPane,imageGallery:Se.a.imageGallery}),a===F.b.GoogleDoc&&n.createElement(k,{className:dt.contentPreview,viewState:this.props.viewState}),a===F.b.Wac&&n.createElement(_e,{mainCssClass:dt.contentPreview,viewState:this.props.viewState,hasPendingState:!!Se.a.pendingState}),a===F.b.NativeView&&n.createElement(ce,{mainCssClass:dt.contentPreview,viewState:this.props.viewState}),a===F.b.Audio&&n.createElement(v,{mainCssClass:dt.contentPreview,viewState:this.props.viewState}),a===F.b.PdfJs&&n.createElement(st,{className:dt.contentPreview,viewState:this.props.viewState}),a===F.b.ItemAttachment&&n.createElement(oe,{className:dt.contentPreview,viewState:this.props.viewState}),a===F.b.Text&&n.createElement(he,{className:dt.contentPreview,viewState:this.props.viewState}),a===F.b.Video&&n.createElement(pe,{className:dt.contentPreview,viewState:this.props.viewState}),a===F.b.CalendarEvent&&n.createElement(Ee.b,{className:dt.contentPreview,viewState:this.props.viewState}))},t.prototype.onClose=function(e){Object(we.a)("keyboard")},r.__decorate([Object(tt.a)("escape")],t.prototype,"onClose",null),t=r.__decorate([s.observer],t)}(n.Component);a.d(t,"PreviewPane",function(){return mt})},5654:function(e,t,a){"use strict";a.r(t);var r=a(2565),n=a(0),i=a(256),o=a(599),l=a(149),s=a(2396),c=a(595),u=a(24),d=a(18),h=a(7),m=a(4),f=Object(m.select)({listViewStore:function(){return u.a},previewPaneStore:function(){return i.a}})(Object(m.action)("createImageGalleryFromAttachmentViewStateIds")(function(e,t){return n.__awaiter(this,void 0,void 0,function(){var a,r,i,u;return n.__generator(this,function(n){if((a=t.previewPaneStore.state)&&a.type===l.b.Image){for(r=[],i=function(a){var n=t.listViewStore.attachmentViewStates.get(e[a]),i=Object(c.a)(n.attachmentId),l=i.model,u=Object(o.e)(i.model,n.isCloudy,n.isReadOnly)&&Object(d.isStringNullOrWhiteSpace)(i.model.AttachmentOriginalUrl),m={attachmentId:n.attachmentId,name:l.Name,size:l.Size,downloadUrl:i.download.url,isDownloadDisabled:!i.info||!i.info.allowDownload,isSaveToCloudEnabled:u,previewUrl:i.previewImage.url,thumbnailUrl:null,parentItemId:n.parentItemId,isCloudy:n.isCloudy};r.push(m),Object(s.a)(n.attachmentId,n.isReadOnly).then(function(){var e=Object(c.a)(n.attachmentId).thumbnailImage.url;m.thumbnailUrl=e},function(e){return h.c.warn("Unable to refresh thumbnail image for "+n.attachmentId+". Got error "+e)})},u=0;u<e.length;u++)i(u);t.previewPaneStore.imageGallery=r}return[2]})})})),p=a(34),v=Object(m.select)({previewPaneStore:function(){return p.y}})(Object(m.action)("createImageGalleryFromImageCollection")(function(e,t){e&&e.length>0&&(t.previewPaneStore.imageGallery=e.slice(0))})),b=a(2302),w=a(2399),g=a(3335),S=a(2398),k=a(3),y=Object(k.mutatorAction)("clearPendingNavigation",function(){Object(i.b)().pendingNavigationAttachmentId=null}),x=Object(k.mutatorAction)("previewFromNavigation",function(e,t){var a=Object(i.b)();t&&(a.conversation&&a.conversation.conversationId&&a.conversation.conversationId.Id===t||(a.conversation={conversationId:{Id:t,mailboxInfo:null},conversationSubject:"",conversationCategories:null})),a.pendingNavigationAttachmentId={Id:e,mailboxInfo:null},a.pendingNavigationTime=(new Date).getTime()}),P=a(3375),I=a(519),_=a(20);function O(){return new Promise(function(e,t){if(!i.a.state||i.a.state.mode!==I.a.Saving&&i.a.state.mode!==I.a.Edit)e(!0);else var a=Object(_.reaction)(function(){return i.a.state},function(t){switch(t&&t.mode){case I.a.Saving:break;case I.a.Edit:Object(P.a)();break;default:a(),e(!0)}},!0)})}var C=Object(k.mutatorAction)("setConversation",function(e,t,a,r){e.conversation={conversationId:t,conversationSubject:a,conversationCategories:r}});a.d(t,"closePreview",function(){return r.a}),a.d(t,"createImageGalleryFromAttachmentViewStateIds",function(){return f}),a.d(t,"createImageGalleryFromImageCollection",function(){return v}),a.d(t,"setReadingPaneDisplay",function(){return b.a}),a.d(t,"setReadingPaneSize",function(){return w.a}),a.d(t,"showPreview",function(){return g.a}),a.d(t,"updateReadingPaneSize",function(){return S.a}),a.d(t,"clearPendingNavigation",function(){return y}),a.d(t,"previewFromNavigation",function(){return x}),a.d(t,"canClosePreviewPane",function(){return O}),a.d(t,"setConversation",function(){return C})},5687:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a(3104),i=a.n(n),o=a(30),l=a(313);var s=a(9),c=a(73),u=a(27),d=a(7),h=a(4),m=Object(h.action)("loadItemAttachment")(function(e,t){return r.__awaiter(this,void 0,void 0,function(){var a=this;return r.__generator(this,function(n){switch(n.label){case 0:return[4,c.i.import()];case 1:return[4,n.sent()(e,null,function(e){c.q.itemPreviewPaneViewState=e},!1,!0,function(e){return r.__awaiter(a,void 0,void 0,function(){return r.__generator(this,function(a){return[2,f(e,t)]})})})];case 2:return n.sent(),[2]}})})}),f=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var a,n,c;return r.__generator(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,function(e,t){return r.__awaiter(this,void 0,void 0,function(){var a,n;return r.__generator(this,function(r){switch(r.label){case 0:return a=Object(o.getJsonRequestHeader)(),[4,i()({Header:a,Body:{AttachmentIds:[{Id:e}],ShapeName:"ItemAttachment",AttachmentShape:{BaseShape:"IdOnly",FilterHtmlContent:!0,BlockExternalImagesIfSenderUntrusted:!0,BlockContentFromUnknownSenders:!1,AddBlankTargetToLinks:!0,ClientSupportsIrm:!0,InlineImageCustomDataTemplate:l.a,InlineImageUrlOnLoadTemplate:l.b,InlineImageUrlTemplate:l.c,FilterInlineSafetyTips:!0,MaximumBodySize:0,BodyType:"HTML"}}},t)];case 1:return n=r.sent(),[2,n.Body.ResponseMessages.Items[0].Attachments[0]]}})})}(e.Id,e.mailboxInfo&&e.mailboxInfo.requestOptions)];case 1:return a=u.sent(),(n=r.__assign({},a.Item,{MailboxInfo:e.mailboxInfo,SmartReplyData:null,SmartTimeDataCollection:null,AttachmentSuggestions:null,shouldShowAttachmentPreviews:!1})).ItemId||(n.ItemId={Id:e.Id}),n.ParentFolderId||(n.ParentFolderId={Id:"null"}),p(e,n),[2,n];case 2:return c=u.sent(),d.c.warn(c),t&&t.endWithError(s.a.ServerError,c),[3,3];case 3:return[2,null]}})})},p=Object(h.action)("setItemToMailStore")(function(e,t){Object(u.c)().items.set(e.Id,t)});a.d(t,"loadItemAttachment",function(){return m})},617:function(e,t,a){"use strict";a.d(t,"a",function(){return n}),a.d(t,"b",function(){return i});var r=a(1234);function n(e){return o(e.type)}function i(e){return o(Object(r.a)(e))}function o(e){return 1===e}},657:function(e,t,a){"use strict";var r=a(82),n=a(8),i=a(390),o=a(192);function l(e,t,a,n){void 0===n&&(n=!0);var o=e,l=o.AttachmentId,s=o.Name,c=o.OriginalPermissionType,u=o.PermissionType,d=o.AttachLongPathName;switch(t){case 0:case 3:return i.b(l,d,t,a,u,c,n,s);case 1:return e.AttachmentPreviewUrl?e.AttachmentPreviewUrl:i.b(l,d,1,a,u,c,n,s);case 2:return e.AttachmentThumbnailUrl;default:return Object(r.a)(t)}}function s(e,t,a,r,o){return void 0===a&&(a=!1),void 0===r&&(r=Object(n.c)("doc-consumerUrl")),void 0===o&&(o=!0),i.a(e.mailboxInfo&&e.mailboxInfo.mailboxId,e,t,a,r,o)}function c(e,t,a,r,c,u){void 0===c&&(c=!1),void 0===u&&(u=Object(n.c)("doc-consumerUrl"));var d=a?l(t,1,r,!1):s(e,1,c,u,!1);if(a)return{url:d,init:{credentials:"include"}};var h=Object(i.c)(),m=new Headers;return m.set("X-Token",h),m.set("X-OWA-CANARY",Object(o.getOwaCanaryCookie)()),{url:d,init:{headers:m}}}function u(e,t,a,r,i,o,c){return void 0===o&&(o=!1),void 0===c&&(c=Object(n.c)("doc-consumerUrl")),r?l(t,a,i):s(e,a,o,c)}a.d(t,"b",function(){return u}),a.d(t,"c",function(){return s}),a.d(t,"d",function(){return c}),a.d(t,"a",function(){return"/owa/"})},939:function(e,t,a){"use strict";var r=a(389),n=a(18),i=a(192),o="/owa/",l="service.svc/s/GetFileAttachment?id={0}",s="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",c="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",d="service.svc/s/GetAttachmentThumbnail?id={0}",h="pdfprint.aspx?id={0}",m="pdfprint.aspx?id={0}&location={1}";var f=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var p=a(82),v=a(8);function b(e,t,a,r,l,c,d,h){var v;switch(void 0===l&&(l=0),void 0===c&&(c=0),void 0===d&&(d=!0),void 0===h&&(h=null),a){case 0:v=s;break;case 3:v=m;break;case 1:if(!function(e){if(!e)return!1;var t=null,a=e.lastIndexOf(".");return a>0&&(t=e.substr(a).toLowerCase()),!!t&&f.indexOf(t.toLowerCase())>=0}(h))return null;v=u;break;default:Object(p.a)(a)}var b=r?c:l;!b&&l&&(b=l);var w=Object(n.format)("{0}{1}&permissionLevel={2}",o,Object(n.format)(v,encodeURIComponent(e.Id),encodeURIComponent(t)),b);d&&(w=w+"&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)());return w}function w(e,t,a,s,u,m){var f;switch(void 0===s&&(s=!1),void 0===u&&(u=Object(v.c)("doc-consumerUrl")),void 0===m&&(m=!0),a){case 0:f=l;break;case 1:f=c;break;case 2:f=d;break;case 3:f=h;break;default:return Object(p.a)(a)}return Object(n.isStringNullOrWhiteSpace)(f)?null:Object(n.format)("{0}{1}{2}",function(e,t,a,l,s,c){if(void 0===c&&(c=!1),!t||!t.Id)return null;var u=Object(n.format)(a,encodeURIComponent(t.Id));if(!Object(r.c)()||c)return o+u+"&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)();var d="{0}{1}/{2}&owa={3}&scriptVer={4}";l&&(d+="&isc=1");var h="unofficial";window.bootstrapDiagnostics&&!Object(n.isStringNullOrWhiteSpace)(window.bootstrapDiagnostics.scriptVer)&&(h=window.bootstrapDiagnostics.scriptVer);var m=Object(n.format)(d,Object(r.b)(),e,u,window.location.hostname,h);return s&&(m+="&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)(),m+="&token="+Object(r.a)()),m}(e,t,f,u,m,3===a),s?"&isDownload=true":"","&animation=true")}a.d(t,"b",function(){return b}),a.d(t,"a",function(){return w})},943:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(38);t.default=function(e){return r.makeServiceRequest("GetAttachmentDownloadToken",{},e)}}},0,[6,7,25,34,57,0,3,4,9,52,1,2,51,223,56,218,225,232]]);
//# sourceMappingURL=owa.PreviewPane.js.map
window.scriptsLoaded['owa.PreviewPane.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.PreviewPane.js'] = (new Date()).getTime();