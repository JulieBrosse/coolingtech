window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.Addins.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[96],{1187:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a});var r=n(1262),i=function(e){return[e.toRecipientWell,e.ccRecipientWell,e.bccRecipientWell]},o=function(e){var t=i(e);return Object(r.a)(t).map(function(e){return e.persona.EmailAddress.EmailAddress})},a=function(e){var t=i(e);return Object(r.a)(t).map(function(e){return e.persona.EmailAddress})}},1245:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(152),i=n.n(r);function o(e){return e?i()({Id:e.Id,ChangeKey:e.ChangeKey}):null}},1392:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r,i,o=n(9),a=n(396);function s(e,t){if(t){var n=null;switch(e){case 0:n=a.a.SmartReplySendMessage;break;case 1:n=a.a.SmartReplySaveMessage;break;case 2:n=a.a.SmartReplyDiscardMessage}var r=n.datapoint,i=r.name,s=r.customData;Object(o.n)(i,s(t))}}(i=r||(r={}))[i.Send=0]="Send",i[i.Save=1]="Save",i[i.Discard=2]="Discard"},1398:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var r=n(1559),i=n.n(r),o=n(1576),a=n.n(o),s=n(177),c=n.n(s),u=n(29),l=n.n(u),d=n(277),p=n(30);function m(e,t,n,r,o,s){var u,m,h,f,g,y,v,b=(u=e,m=t,h=n,f=r,g=o,y=s,v=a()({ClientSupportsIrm:!0,ComposeOperation:"newMail",MessageDisposition:h?"SendAndSaveCopy":"SaveOnly",OutboundCharset:"AutoDetect",Items:[u],TimeFormat:f,SendOnNotFoundError:!0,ItemShape:c()({BaseShape:"IdOnly",AdditionalProperties:[l()({FieldURI:"ItemLastModifiedTime"})]})}),y&&y.IsOwner&&(v.ComplianceId=y.RmsTemplateId?y.RmsTemplateId.toUpperCase():"0"),h?g&&(v.ItemShape.ReturnOnlyInternetMessageId=!0):(v.ItemShape=Object(d.b)(m),v.ShapeName="MailCompose"),v);return i()({Header:Object(p.getJsonRequestHeader)(),Body:b}).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}},1399:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n(277),i=n(320),o=n(1617),a=n.n(o),s=n(177),c=n.n(s),u=n(29),l=n.n(u),d=n(1618),p=n.n(d),m=n(30);function h(e,t,n,o,s,u){var d,h,f,g,y,v,b,E=(d=e,h=t,f=n,g=o,y=s,v=u,b=a()({ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:g?"SendAndSaveCopy":"SaveOnly",OutboundCharset:"AutoDetect",Items:[h],TimeFormat:y,ItemShape:c()({BaseShape:"IdOnly",AdditionalProperties:[l()({FieldURI:"ItemLastModifiedTime"})]})}),g?v&&(b.ItemShape.ReturnOnlyInternetMessageId=!0):(b.ItemShape=Object(r.b)(f),b.ShapeName="MailCompose"),Object(i.b)("grp-consumerGroupPassSmtpAddressForCreateResponse")&&(b.GroupSmtpAddress=d),b);return p()({Header:Object(m.getJsonRequestHeader)(),Body:E}).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}},1403:function(e,t,n){"use strict";var r=n(0),i=n(392),o=n(1385),a=n.n(o),s=n(1398),c=n(1245),u=n(1399),l=new RegExp("<img[^>]*\\s+src=[\"']data:image\\/[^<]+;base64,[a-zA-Z0-9+\\/=&#;]+[\"'][^>]*>","gi");var d=n(1),p=n(335),m=n(10),h=n.n(m),f=n(11),g=n.n(f);var y=n(522),v=n(6),b=n(885),E=n.n(b),I=n(1619),C=n.n(I),M=n(1620),x=n.n(M),S=n(177),R=n.n(S),O=n(29),T=n.n(O),w=n(30);function j(e,t,n,r,i){var o,a,s,c,u,l=(o=e,a=t,s=r,c=i,u=x()({ModernGroupEmailAddress:{EmailAddress:o,MailboxType:"GroupMailbox"},ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:"SendAndSaveCopy",OutboundCharset:"AutoDetect",Items:[a],TimeFormat:s,ItemShape:R()({BaseShape:"IdOnly",AdditionalProperties:[T()({FieldURI:"ItemLastModifiedTime"})]})}),c&&(u.ItemShape.ReturnOnlyInternetMessageId=!0),u);return C()({Header:Object(w.getJsonRequestHeader)(),Body:l}).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}var _=new RegExp('<IMG[^>]+?ORIGINALSRC\\s*=\\s*"[\\s\\S]+?"[\\s\\S]*?>',"gim"),P=new RegExp('\\sSRC\\s*=\\s*"[\\s\\S]+?"',"im");var A=n(1408),D=n.n(A),k=n(1409),B=n.n(k),U=n(492),N=n.n(U),H=n(620),L=n.n(H),F=n(159),V=n.n(F),W=n(976),z=n.n(W);var G=n(493),q=n(490),K=n.n(q),X=n(152),Q=n.n(X),J=n(491),Z=n.n(J);function Y(e,t,n){var r=[Object(G.a)("ToRecipients",e.ToRecipients),Object(G.a)("CcRecipients",e.CcRecipients),Object(G.a)("BccRecipients",e.BccRecipients),Object(G.a)("Subject",e.Subject),Object(G.a)("Body",e.Body),Object(G.a)("Importance",e.Importance),Object(G.a)("IsReadReceiptRequested",e.IsReadReceiptRequested),Object(G.a)("IsDeliveryReceiptRequested",e.IsDeliveryReceiptRequested)];e.From&&r.push(Object(G.a)("From",e.From)),e.MentionsEx&&r.push(Object(G.a)("MentionsEx",e.MentionsEx)),e.Sensitivity&&r.push(Object(G.a)("Sensitivity",e.Sensitivity)),e.ExtendedProperty&&e.ExtendedProperty.map(function(e){var t;r.push((t=e,z()({Path:V()(t.ExtendedFieldURI),Item:E()({ExtendedProperty:[L()(t)]})})))});var i=K()({Updates:r,ItemId:Q()({Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey})}),o=N()({ItemChanges:[i],ConflictResolution:"AlwaysOverwrite",ClientSupportsIrm:!0,SendCalendarInvitationsOrCancellations:"SendToNone",MessageDisposition:t?"SendAndSaveCopy":"SaveOnly",SuppressReadReceipts:!1,ComposeOperation:"newMail",OutboundCharset:"AutoDetect",PromoteInlineAttachments:!1,SendOnNotFoundError:!0,ItemShape:R()({BaseShape:"IdOnly",AdditionalProperties:[T()({FieldURI:"ItemLastModifiedTime"})]})});return n&&n.IsOwner&&(o.ComplianceId=n.RmsTemplateId?n.RmsTemplateId.toUpperCase():"0"),o}var $=n(1462),ee=n.n($),te=35356;var ne=n(1454),re=n(625),ie=n(938),oe=n(4),ae=Object(oe.action)(ie.d)(function(e,t,n){}),se=n(656),ce=n(18),ue="InternetHeaders",le="X-Ms-Exchange-Organization-Dlp-FalsePositive";var de=n(1565),pe=n(318);n.d(t,"a",function(){return he}),n.d(t,"e",function(){return ye}),n.d(t,"d",function(){return ve}),n.d(t,"c",function(){return be}),n.d(t,"b",function(){return Ee});var me='<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css" style="display:none;"> P {{margin-top:0;margin-bottom:0;}} </style></head><body dir="{0}">{1}</body></html>',he="ErrorSendCanceled";function fe(e){var t,n=e.content;if("HTML"==e.bodyType){var i=e.explicitTextDirection||(Object(v.a)().SessionSettings.IsUserCultureRightToLeft?ne.a.RTL:ne.a.LTR);n=(t=n)?t.replace(_,function(e){return e.replace(P,"")}):t,n=Object(ce.format)(me,i,n)}var o=a()({BodyType:e.bodyType,Value:n});o.DataUriCount=function(e){var t=0;if(e){var n=e.match(l);t=n?n.length:0}return t}(e.content);var s,u=Object(c.a)(e.itemId),d=Object(c.a)(e.referenceItemId),p=Object(y.a)(e.toRecipientWell),m=Object(y.a)(e.ccRecipientWell),h=Object(y.a)(e.bccRecipientWell),f={Subject:e.subject||"",Importance:e.importance,IsReadReceiptRequested:e.isReadReceiptRequested,IsDeliveryReceiptRequested:e.isDeliveryReceiptRequested,ToRecipients:p,CcRecipients:m,BccRecipients:h,Sensitivity:e.sensitivity};e.useSmartResponse?s=(2==e.operation?D.a:B.a)(r.__assign({},f,{UpdateResponseItemId:u,ReferenceItemId:d,ReferenceItemDocumentId:e.referenceItemDocumentId||0,NewBodyContent:o})):(s=E()(r.__assign({},f,{Body:o})),e.itemId&&(s.ItemId=e.itemId));return e.fromViewState&&function(e,t){var n=e.from;if(n){var r=!1,i=Object(v.a)().SessionSettings.ConnectedAccountInfos;if(i)for(var o=0;o<i.length;o++){var a=i[o];if(a.EmailAddress==n.email.EmailAddress){r=!0;var s=L()({Value:a.SubscriptionGuid,ExtendedFieldURI:V()({PropertyId:te,DistinguishedPropertySetId:"Sharing",PropertyType:"CLSID"})});t.ExtendedProperty?t.ExtendedProperty.push(s):t.ExtendedProperty=[s],t.From=ee()({Mailbox:{MailboxType:n.email.MailboxType,RoutingType:"SMTP",EmailAddress:n.email.EmailAddress,Name:a.DisplayName}});break}}r||(t.From=ee()({Mailbox:n.email}))}}(e.fromViewState,s),s}function ge(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,i,o,a,c;return r.__generator(this,function(l){switch(l.label){case 0:return n=fe(e),t&&function(e){var t=[];if(e.isReportedFalsePositive){var n={ExtendedFieldURI:{PropertyName:le,PropertyType:"String",DistinguishedPropertySetId:ue},Value:""};t.push(n)}return t}(e.policyTipsViewState).map(function(e){return r=e,void(null==(t=n).ExtendedProperty?t.ExtendedProperty=[r]:t.ExtendedProperty.push(r));var t,r}),[4,function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var i,o,a,s,c,u,l,d,p;return r.__generator(this,function(r){switch(r.label){case 0:return(i=Object(se.b)(e))&&(i.atMentionsPlugin&&i.atMentionsPlugin.isImported()||i.editorPickerPlugin&&i.editorPickerPlugin.isImported())?i.atMentionsPlugin?[4,i.atMentionsPlugin.getPlugin()]:[3,2]:[3,8];case 1:return a=r.sent(),[3,3];case 2:a=null,r.label=3;case 3:return(o=a)?(t?(l=Object(v.a)().SessionSettings,(d=o.getMentionsWrappersForSend({MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:l.UserEmailAddress,Name:l.UserDisplayName}))&&d.length>0&&(n.MentionsEx=d)):(p=o.getPendingTagsForSave()).length>0&&(n.PendingSocialActivityTagIds=p),[3,8]):[3,4];case 4:return i.editorPickerPlugin?[4,i.editorPickerPlugin.getPlugin()]:[3,6];case 5:return c=r.sent(),[3,7];case 6:c=null,r.label=7;case 7:(s=c)&&(u=s.dataProvider,t?(l=Object(v.a)().SessionSettings,(d=u.getMentionsWrappersForSend({MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:l.UserEmailAddress,Name:l.UserDisplayName}))&&d.length>0&&(n.MentionsEx=d)):(p=u.getPendingTagsForSave()).length>0&&(n.PendingSocialActivityTagIds=p)),r.label=8;case 8:return[2]}})})}(e,t,n)];case 1:return l.sent(),i=Object(v.a)().UserOptions.TimeFormat,[4,function(e,t,n,i){return r.__awaiter(this,void 0,void 0,function(){var o,a,c;return r.__generator(this,function(r){switch(r.label){case 0:return(o=e).groupId&&Object(pe.c)(o)?i&&3!=e.operation?[4,j(o.groupId,t,e.bodyType,n,e.isInlineCompose)]:[3,2]:[3,4];case 1:return[2,r.sent()];case 2:return a=1==e.operation||2==e.operation,!e.itemId&&a||e.useSmartResponse?[4,Object(u.a)(o.groupId,t,e.bodyType,!1,n,e.isInlineCompose)]:[3,4];case 3:return[2,r.sent()];case 4:return!e.useSmartResponse&&e.itemId?[3,6]:[4,Object(s.a)(t,e.bodyType,i,n,e.isInlineCompose,e.IRMData)];case 5:return c=r.sent(),[3,8];case 6:return[4,(l=t,d=i,p=e.IRMData,m=Y(l,d,p),Z()({Header:Object(w.getJsonRequestHeader)(),Body:m}).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))];case 7:c=r.sent(),r.label=8;case 8:return[2,c]}var l,d,p,m})})}(e,n,i,t)];case 2:return o=l.sent(),(a=o&&o.ResponseMessages&&o.ResponseMessages.Items?o.ResponseMessages.Items[0]:null)&&"Success"==a.ResponseClass?[2,Promise.resolve(a)]:(Object(de.d)(o,e),c=void 0,a?(c=new Error(a.ResponseCode)).messageText=a.MessageText:c=new Error("Unrecognized response"),[2,Promise.reject(c)])}})})}function ye(e){return ge(e,!0)}function ve(e){return ge(e,!1)}function be(e,t){if(e&&e.Items){var n=e.Items[0];n&&(n.ItemId&&Object(re.a)(t,n.ItemId.Id,n.ItemId.ChangeKey,n.LastModifiedTime),n.InternetMessageId&&ae(t.conversationId,t.itemId?t.itemId.Id:null,n.InternetMessageId))}}function Ee(e,t,n){if(e.message!=he){var r,o=function(e,t){if(e){if(e.indexOf("500")>=0)return"error500";if(e.indexOf("503")>=0)return"error503";if(e.indexOf("Failed to fetch")>=0)return"errorFailedToFetch"}switch(e){case"ErrorSessionTimeout":return"errorSessionTimeout";case"ErrorMailboxStoreUnavaiable":return"errorMailboxStoreUnavailable";case"ErrorSendAsDenied":return"errorMessageNoPermissionToSendAs";case"ErrorRightsManagementPermanentException":return null;case"ErrorSubmissionQuotaExceeded":return"errorMessageSubmissionQuotaExceededMessageCanNotBeSent";case"ErrorAccountSuspend":return"errorMessageAccountSuspend";case"ErrorExceededMaxRecipientLimit":return"errorMessageExceededMaxRecipientLimit";case"ErrorExceededMessageLimit":return"errorMessageExceededMessageLimit";case"ErrorExceededHourlyMessageLimit":return"errorMessageExceededHourlyMessageLimit";case"ErrorMessageBlocked":return"errorMessageMessageBlocked";case"ErrorMessageSubmissionBlocked":return"errorMessageMessageSubmissionBlocked";case"ErrorAccountSuspendShowTierUpgrade":return"errorMessageAccountSuspendShowTierUpgrade";case"ErrorExceededMaxRecipientLimitShowTierUpgrade":return"errorMessageExceededMaxRecipientLimitShowTierUpgrade";case"ErrorExceededMessageLimitShowTierUpgrade":return"errorMessageExceededMessageLimitShowTierUpgrade";case"ErrorMessageTimeout":return"errorMessageTimeout";case"ErrorMessageThrottled":return"errorMessageThrottled";case"ErrorMessageTransientError":return"errorMessageTransientError";case"ErrorItemNotFound":return t?"errorMessageItemNoLongerExistToSend":"errorMessageItemNoLongerExistToSave";case"ErrorAccessDenied":return"warningMessageNoPermissionToPerformAction";case"ErrorQuotaExceeded":return t?"errorMessageQuotaExceededMessageCanNotBeSent":"errorMessageQuotaExceededMessageCanNotBeSaved";default:return t?"errorMessageMessageCanNotBeSent":"errorMessageMessageCanNotBeSaved"}}(e?e.message:null,n);"errorMessageMessageCanNotBeSent"==o&&e.messageText?Object(i.a)(t,"errorMessageErrorWithDetail",(r=e.messageText,function(){return{key:"errorMessageErrorWithDetail",source:p.c.Compose,rank:p.b.Error,messageParts:[h.a.errorMessageMessageCanNotBeSent,{showDetailsText:g.a.moreDetailsNotificationLabel,hideDetailsText:null,detailsElement:d.createElement("span",null,r)}]}})):Object(i.a)(t,o)}}},1454:function(e,t,n){"use strict";var r,i;(i=r||(r={})).LTR="ltr",i.RTL="rtl",t.a=r},1545:function(e,t,n){"use strict";var r=n(0),i=n(371),o=n(4),a=Object(o.action)("setNumberOfWaitingAttachments")(function(e,t){t<0||(e.numberOfWaitingAttachments=t)}),s=n(508),c=n(195),u=n(93),l=n(887),d=n(16),p=n(888);function m(e,t,n,o,m,h,f,g,y){return r.__awaiter(this,void 0,void 0,function(){var v,b;return r.__generator(this,function(E){switch(E.label){case 0:v=!1,Object(d.b)("cmp-upgradeCompose")&&!n.itemId&&(v=!0,a(n,n.numberOfWaitingAttachments+1)),E.label=1;case 1:return E.trys.push([1,,6,7]),(b=!n.itemId)?[4,Object(s.e)(n)]:[3,3];case 2:b=!E.sent(),E.label=3;case 3:return b?[4,Object(s.b)(n)]:[3,5];case 4:E.sent(),E.label=5;case 5:return I=e,C=t,M=n,x=o,S=m,R=h,O=f,T=g,w=function(e){y&&y(e),Object(p.a)()&&Object(l.a)(n,8)},c.e.import().then(function(e){var t=e(M.attachmentWell,r.__assign({},M.itemId,{mailboxInfo:Object(u.b)()}),I,O||Object(i.a)(M),T||Object(i.c)(M),C,x,S,w);if(C)for(var n=t.length,o=M.attachmentWell.inlineAttachments.length,a=0;a<n;a++){var s=M.attachmentWell.inlineAttachments[o-n+a];R&&R(s.placeholderId,t[a])}}),[3,7];case 6:return v&&a(n,n.numberOfWaitingAttachments-1),[7];case 7:return[2]}var I,C,M,x,S,R,O,T,w})})}n.d(t,"a",function(){return m})},1547:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(1611),i=n.n(r),o=n(1615),a=n.n(o);function s(e){var t=e.policyMatchDetails,n=t.filter(function(e){return 0!=e.MatchPriority});return n.length>0?a()(n,function(e){return e.MatchPriority}):i()(t,function(e){return function(e){switch(e){case 1:return 0;case 4:case 2:case 3:return 1;case 5:return 2;default:return 3}}(e.Action)})}},1558:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade","errorMessageExceededHourlyMessageLimit","errorMessageExceededMaxRecipientLimit","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimit","errorMessageExceededMessageLimitShowTierUpgrade","errorMessageMessageSubmissionBlocked","errorMessageMessageBlocked","errorMessageTimeout","errorMessageThrottled","errorMessageTransientError","errorMessageItemNoLongerExistToSave","errorMessageItemNoLongerExistToSend","errorMessageQuotaExceededMessageCanNotBeSaved","errorMessageQuotaExceededMessageCanNotBeSent","errorMessageSubmissionQuotaExceededMessageCanNotBeSent","errorMessageMessageCanNotBeSaved","errorMessageMessageCanNotBeSent","errorMessageNoPermissionToSendAs","errorMessageNoRecipentsMailCanNotBeSend","warningMessageMaxRecipientsExceed","warningMessageNoPermissionToPerformAction","error500","error503","errorFailedToFetch","errorSessionTimeout","errorMailboxStoreUnavailable","errorMessageErrorWithDetail"]},1565:function(e,t,n){"use strict";n.d(t,"d",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"b",function(){return p}),n.d(t,"a",function(){return m});var r=n(10),i=n.n(r),o=n(393),a=n(508),s="",c="",u="/owa/owahipcontrol.aspx?compose=1";function l(e,t){if(e){e.WasclUpgradeToPremiumUrl&&(s=e.WasclUpgradeToPremiumUrl),e.AccountRecoveryFlowUrl&&(c=e.AccountRecoveryFlowUrl);var n=e.ResponseMessages&&e.ResponseMessages.Items?e.ResponseMessages.Items[0]:null;!n||"ErrorExceededMessageLimit"!=n.ResponseCode&&"ErrorExceededHourlyMessageLimit"!=n.ResponseCode&&"ErrorExceededMessageLimitShowTierUpgrade"!=n.ResponseCode||Object(a.b)(t,!0)}}function d(e){return{text:i.a.errorMessageUpgradeToPremium,action:function(){Object(o.a)(e,["errorMessageExceededMessageLimit","errorMessageExceededMaxRecipientLimit"]),window.open(s)}}}function p(e){return{text:i.a.errorMessageVerify,action:function(){Object(o.a)(e,["errorMessageMessageSubmissionBlocked","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimitShowTierUpgrade"]),window.open(u)}}}function m(e){return{text:i.a.errorMessageVerify,action:function(){Object(o.a)(e,["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade"]),window.open(c)}}}},1835:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"MAX_REGEX_MATCHES",function(){return v}),n.d(r,"MAX_BODY_REGEX_ACTIVATION_LENGTH",function(){return b}),n.d(r,"MAX_REGEX_MATCH_LENGTH",function(){return E});var i=n(1217),o=n(2776),a=n(2693),s=n(0),c=n(2768),u=n(664),l=n(2150),d=function(){function e(e){this.collectionRule=e}return e.prototype.Evaluate=function(e,t){var n,r,i=this.GetInitialEvaluationResult();try{for(var o=s.__values(this.collectionRule.Rules),a=o.next();!a.done;a=o.next()){var c=R(a.value).Evaluate(e,t);i=this.UpdateEvaluationResult(i,c)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i},e.prototype.ItemIsReadyForEvaluation=function(e){var t,n;try{for(var r=s.__values(this.collectionRule.Rules),i=r.next();!i.done;i=r.next()){if(!R(i.value).ItemIsReadyForEvaluation(e))return!1}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!0},e.prototype.GetInitialEvaluationResult=function(){if("AND"==this.collectionRule.Mode.toUpperCase())return!0;if("OR"==this.collectionRule.Mode.toUpperCase())return!1;throw new Error("Invalid mode for a Collection rule: "+this.collectionRule.Mode)},e.prototype.UpdateEvaluationResult=function(e,t){return!("AND"==this.collectionRule.Mode.toUpperCase()&&!t)&&(!("OR"!=this.collectionRule.Mode.toUpperCase()||!t)||e)},e}(),p=function(){function e(e){}return e.prototype.Evaluate=function(e,t){return!!e.HasAttachments},e.prototype.ItemIsReadyForEvaluation=function(e){return!0},e}();function m(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/\n[\s]*/g,"[\n]+")}var h=n(484),f="MeetingString",g=function(){function e(e){this.itemHasKnownEntityRule=e}return e.prototype.Evaluate=function(e,t){if(!e.EntityExtractionResult)return!1;switch(this.itemHasKnownEntityRule.EntityType){case 3:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Addresses,"Address");case 7:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Contacts,"ContactString");case 6:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.EmailAddresses,"EmailAddress");case 1:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.MeetingSuggestions,f);case 5:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.PhoneNumbers,"OriginalPhoneString");case 2:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.TaskSuggestions,"TaskString");case 4:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Urls,"Url");default:throw new Error("Unexpected known entity: "+this.itemHasKnownEntityRule.EntityType)}},e.prototype.EvaluateForEntityType=function(e,t,n,r){var i,o;if(!n)return!1;var a=[],c=!1,u=0;try{for(var l=s.__values(n),d=l.next();!d.done;d=l.next()){var p=d.value;if(this.EvaluateRegExForTerm(p[r])){c=!0,-1===t.evaluationResult.matchedKnownEntityTypes.indexOf(this.itemHasKnownEntityRule.EntityType)&&t.evaluationResult.matchedKnownEntityTypes.push(this.itemHasKnownEntityRule.EntityType),2!==this.itemHasKnownEntityRule.Highlight&&"Subject"!==p.Position&&(t.terms.push(y(p,r)),u++);var m=h({},p);a.push(m)}}}catch(e){i={error:e}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}if(this.itemHasKnownEntityRule.FilterName&&this.itemHasKnownEntityRule.RegExFilter&&this.SaveRegexMatches(a,t.evaluationResult),u>0){var f=t.highlightableEntities[this.itemHasKnownEntityRule.EntityType];(!f||u>f)&&(t.highlightableEntities[this.itemHasKnownEntityRule.EntityType]=u)}return c},e.prototype.EvaluateRegExForTerm=function(e){var t=this.itemHasKnownEntityRule.IgnoreCase,n=this.itemHasKnownEntityRule.RegExFilter;if(!n)return!0;var r=Object(l.i)(e,n,t);return r&&r.length>0},e.prototype.ItemIsReadyForEvaluation=function(e){return!!e.EntityExtractionResult||!this.ItemHasEntityOnServer(e)},e.prototype.ItemHasEntityOnServer=function(e){if(!e.PropertyExistence)return!1;switch(this.itemHasKnownEntityRule.EntityType){case 3:return e.PropertyExistence.ExtractedAddresses;case 7:return e.PropertyExistence.ExtractedContacts;case 6:return e.PropertyExistence.ExtractedEmails;case 1:return e.PropertyExistence.ExtractedMeetings;case 5:return e.PropertyExistence.ExtractedPhones;case 2:return e.PropertyExistence.ExtractedTasks;case 4:return e.PropertyExistence.ExtractedUrls;default:return!1}},e.prototype.SaveRegexMatches=function(e,t){switch(this.itemHasKnownEntityRule.EntityType){case 3:t.filteredEntityMatches.Addresses||(t.filteredEntityMatches.Addresses={}),t.filteredEntityMatches.Addresses[this.itemHasKnownEntityRule.FilterName]=e;break;case 7:t.filteredEntityMatches.Contacts||(t.filteredEntityMatches.Contacts={}),t.filteredEntityMatches.Contacts[this.itemHasKnownEntityRule.FilterName]=e;break;case 6:t.filteredEntityMatches.EmailAddresses||(t.filteredEntityMatches.EmailAddresses={}),t.filteredEntityMatches.EmailAddresses[this.itemHasKnownEntityRule.FilterName]=e;break;case 1:t.filteredEntityMatches.MeetingSuggestions||(t.filteredEntityMatches.MeetingSuggestions={}),t.filteredEntityMatches.MeetingSuggestions[this.itemHasKnownEntityRule.FilterName]=e;break;case 5:t.filteredEntityMatches.PhoneNumbers||(t.filteredEntityMatches.PhoneNumbers={}),t.filteredEntityMatches.PhoneNumbers[this.itemHasKnownEntityRule.FilterName]=e;break;case 2:t.filteredEntityMatches.TaskSuggestions||(t.filteredEntityMatches.TaskSuggestions={}),t.filteredEntityMatches.TaskSuggestions[this.itemHasKnownEntityRule.FilterName]=e;break;case 4:t.filteredEntityMatches.Urls||(t.filteredEntityMatches.Urls={}),t.filteredEntityMatches.Urls[this.itemHasKnownEntityRule.FilterName]=e}},e}();function y(e,t){return t===f?function(e,t){var n=e[t];if(!e.TimeStringLength)return m(n);var r=n.slice(e.TimeStringBeginIndex,e.TimeStringBeginIndex+e.TimeStringLength),i=n.slice(e.TimeStringBeginIndex+e.TimeStringLength,n.length);if(0==i.length)return m(r);return m(r)+"(?="+m(i)+")"}(e,t):m(e[t])}var v=50,b=5e5,E=10240,I=n(82);function C(e){return 0===e.indexOf("ipm.note")||0===e.indexOf("ipm.schedule")||0===e.indexOf("ipm.sharing")}function M(e){return 0===e.indexOf("ipm.appointment")||"ipm.ole.class.{00061055-0000-0000-c000-000000000046}"==e}var x=function(){function e(e){this.itemIsRule=e}return e.prototype.Evaluate=function(e,t){return this.EvaluateItemType(e)&&this.EvaluateItemClass(e)},e.prototype.EvaluateItemType=function(e){var t=e.ItemClass;return!(1!=this.itemIsRule.ItemType||!t||!C(t.toLowerCase()))||(!(2!=this.itemIsRule.ItemType||!t||!M(t.toLowerCase()))||!this.itemIsRule.ItemType)},e.prototype.EvaluateItemClass=function(e){var t=e.ItemClass;return!this.itemIsRule.ItemClass||(this.itemIsRule.IncludeSubClasses?t&&0===t.toLowerCase().indexOf(this.itemIsRule.ItemClass.toLowerCase()):t&&this.itemIsRule.ItemClass.toLowerCase()===t.toLowerCase())},e.prototype.ItemIsReadyForEvaluation=function(e){return!0},e}(),S=function(){function e(e,t){this.itemHasRegularExpressionMatchRule=e,this.limits=t||r}return e.prototype.Evaluate=function(e,t){var n,r,i=this.GetPropertyForEvaluation(e,t),o=this.itemHasRegularExpressionMatchRule.RegExValue,a=this.itemHasRegularExpressionMatchRule.IgnoreCase,c=null;if(null!=i&&(c=Object(l.i)(i,o,a)),null==c)return t.evaluationResult.regExMatches[this.itemHasRegularExpressionMatchRule.RegExName]=[],!1;var u=this.removeDuplicatesAndApplyMatchLimits(c);if(t.evaluationResult.regExMatches[this.itemHasRegularExpressionMatchRule.RegExName]=u,2===this.itemHasRegularExpressionMatchRule.Highlight)return!0;if(2==this.itemHasRegularExpressionMatchRule.PropertyName)try{for(var d=s.__values(u),p=d.next();!p.done;p=d.next()){var h=p.value;t.terms.push(m(h))}}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}return!0},e.prototype.ItemIsReadyForEvaluation=function(e){return!0},e.prototype.removeDuplicatesAndApplyMatchLimits=function(e){var t,n,r={},i=0;try{for(var o=s.__values(e),a=o.next();!a.done;a=o.next()){var c=a.value;if(i>=this.limits.MAX_REGEX_MATCHES)break;c.length<=this.limits.MAX_REGEX_MATCH_LENGTH&&(r[c]=1,i++)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return Object.keys(r)},e.prototype.GetPropertyForEvaluation=function(e,t){switch(this.itemHasRegularExpressionMatchRule.PropertyName){case 1:return e.Subject;case 4:return this.GetSenderSMTPAddress(e);case 3:return this.GetBodyWithLimits(e);case 2:if(t.plainTextBody)return t.plainTextBody;var n=this.GetBodyWithLimits(e);return t.plainTextBody=Object(l.e)(n),t.plainTextBody;default:return Object(I.a)(this.itemHasRegularExpressionMatchRule.PropertyName),""}},e.prototype.GetSenderSMTPAddress=function(e){if(C(e.ItemClass)){var t=e;if(t.Sender&&t.Sender.Mailbox)return t.Sender.Mailbox.EmailAddress}if(M(e.ItemClass)){var n=e;if(n.Organizer&&n.Organizer.Mailbox)return n.Organizer.Mailbox.EmailAddress}return null},e.prototype.GetBodyWithLimits=function(e){var t=this.GetBody(e);return null!=t&&t.length>this.limits.MAX_BODY_REGEX_ACTIVATION_LENGTH?null:t},e.prototype.GetBody=function(e){var t;e.NormalizedBody?t=e.NormalizedBody:e.UniqueBody?t=e.UniqueBody:e.Body&&(t=e.Body);var n=this.itemHasRegularExpressionMatchRule.PropertyName;return!t||"Text"===t.BodyType&&3===n?null:t.Value},e}();function R(e){if("ItemIs"==e.Type)return new x(e);if("ItemHasAttachment"==e.Type)return new p(e);if("ItemHasKnownEntity"==e.Type)return new g(e);if("ItemHasRegularExpressionMatch"==e.Type)return new S(e);if("Collection"==e.Type)return new d(e);throw new Error("Rule type not supported: "+e.Type)}var O=n(21);function T(e,t,n){var r,i={};e.length>0&&e.forEach(function(e){var o,a,c,l;c=r,l={evaluationResult:Object(u.f)(),highlightableEntities:{},terms:[]},c&&(l.plainTextBody=c.plainTextBody,l.highlightableEntities=c.highlightableEntities);var d=function(e,t,n){try{return function(e,t,n){if(R(e).Evaluate(t,n))return n.terms;return[]}(e.detectedEntity.Rule,t,n)}catch(e){return[]}}(e,t,r=l);try{for(var p=s.__values(d),m=p.next();!m.done;m=p.next()){var h=m.value;i[h]?i[h].push(e):i[h]=[e]}}catch(e){o={error:e}}finally{try{m&&!m.done&&(a=p.return)&&a.call(p)}finally{if(o)throw o.error}}d.length>0&&(n[e.extension.Id]=r.evaluationResult)});return new O.a(i)}function w(e,t){try{return n=e.detectedEntity.Rule,r=t,R(n).ItemIsReadyForEvaluation(r)}catch(e){return!0}var n,r}function j(e,t){return s.__awaiter(this,void 0,void 0,function(){var n;return s.__generator(this,function(r){switch(r.label){case 0:return function(e,t){var n,r;try{for(var i=s.__values(e),o=i.next();!o.done;o=i.next())if(!w(o.value,t))return!1}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!0}(t,e)?[3,2]:[4,Object(l.l)(e)];case 1:n=r.sent(),Object(u.W)(e,n.EntityExtractionResult),r.label=2;case 2:return[2]}})})}var _=n(140);function P(e,t){return s.__awaiter(this,void 0,void 0,function(){var n,r,i,o;return s.__generator(this,function(a){switch(a.label){case 0:return s=u.h.EnabledAddinCommands.getExtensionPoint(_.a.DetectedEntity),n=0==s.length?[]:s.map(function(e){return e.AddinCommands.values()[0]}),r={},[4,j(e,n)];case 1:return a.sent(),i=T(n,e,r),o=new O.a(r),Object(u.V)(t,i,o),[2]}var s})})}var A=n(670),D=n(2622),k=n(2765);function B(e,t,n){return void 0===n&&(n=!0),s.__awaiter(this,void 0,void 0,function(){var r;return s.__generator(this,function(i){switch(i.label){case 0:return Object(l.b)(e,t),Object(u.z)(e),((s=t.mode)==_.a.MessageRead||s==_.a.MeetingRequest||s==_.a.AppointmentAttendee)&&(r=t,Object(u.ab)((o=r,a=e,function(){return P(o.getItem(),a)}))),Object(l.o)(e),Object(k.d)(n),[4,Object(D.e)(t.mode)];case 1:return i.sent(),[4,Object(c.a)()];case 2:return i.sent(),Object(A.e)()&&Object(k.e)(k.a.Single,e),[2]}var o,a,s})})}var U=n(20);function N(e){var t,n;Object(l.g)(e),Object(k.b)(e),Object(u.g)(e),t=e,n=H,Object(u.A)(t)?Object(U.when)(function(){return!Object(u.A)(t)},function(){return n(t)}):n(t)}function H(e){Object(u.E)(e)||Object(l.f)(e)}var L=n(1237);function F(e,t){t==L.a.Deselected&&Object(k.b)(e)}function V(e){return!!Object(u.q)(e)&&null!=Object(u.q)(e).contextualTerms}function W(e,t){return Object(U.when)(function(){return V(e)},function(){return t(V(n=e)?s.__spread(Object(u.q)(n).contextualTerms.keys()):null);var n})}var z=n(2431),G=n(1232),q=n(1274),K=function(e){function t(){var t=e.call(this,{},{},{},{})||this;return t.extension={AppDomains:[q.e,q.d],Id:q.k,Version:q.i,Type:"Default",TypeString:"Default",Origin:"Default",OriginString:"Default",IconUrl:q.h,DisplayName:q.c,ConsentState:0,Description:q.b,ProviderName:q.j,HighResolutionIconUrl:q.g,AppStatus:"",LicenseType:0,Settings:"{}",RequestedCapabilities:1,DisableEntityHighlighting:!1,Enabled:!0,LicenseStatus:0,IsMandatory:!1,ExtensionPointCollection:t.get_ExtensionPointCollection()},t.addinId=q.k,t.commandId=q.a,t.endpoint=q.d,t}return s.__extends(t,e),t.prototype.get_EntryPoint=function(){return this.endpoint.toString()},t.prototype.get_Label=function(){return this.extension.DisplayName},t.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},t.prototype.get_Id=function(){return this.extension.Id},t.prototype.get_Size16Icon=function(){return this.extension.IconUrl},t.prototype.get_Version=function(){return this.extension.Version},t.prototype.get_ExtensionPointCollection=function(){return{FunctionFile:q.f,MessageReadCommandSurface:this.get_ExtensionPoint(),MessageComposeCommandSurface:null,AppointmentOrganizerCommandSurface:null,AppointmentAttendeeCommandSurface:null,Events:null,DetectedEntity:null,CustomPane:null,__type:"MessageReadCommandSurface"}},t.prototype.get_ExtensionPoint=function(){return{Tabs:[this.get_Tab()],__type:""}},t.prototype.get_Tab=function(){return{Type:0,Id:"TabDefault",Groups:[this.get_Group()],Label:q.c,__type:null}},t.prototype.get_Group=function(){return{Id:"ScreamGroup",Label:q.c,Controls:[this.get_TaskPaneControl()],__type:null}},t.prototype.get_IconUrls=function(){return{Size16Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon16x16.png",Size32Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon32x32.png",Size80Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon80x80.png",Size20Url:null,Size24Url:null,Size40Url:null,Size48Url:null,Size64Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon64x64.png",__type:null}},t.prototype.get_TaskPaneControl=function(){var e=this.get_Control();return e.Action={SourceLocation:q.f,__type:"TaskPaneButton"},e},t.prototype.get_Control=function(){return{Label:q.c,Supertip:{Title:"Translate Item",Description:q.b},Icon:this.get_IconUrls(),Id:q.a,__type:"ShowTaskpane"}},t}(u.a),X=n(2416);function Q(e){return s.__awaiter(this,void 0,void 0,function(){var t;return s.__generator(this,function(n){switch(n.label){case 0:return[4,Object(X.a)()];case 1:return n.sent(),null==(t=new K)?[3,3]:[4,Object(k.f)(e,t,_.a.MessageRead)];case 2:return n.sent(),[2];case 3:return[2,null]}})})}var J=n(2694),Z=n(1239),Y=n(6);function $(){var e=Object(u.n)().Context,t=Object(u.C)(),n=Object(Y.a)().SegmentationSettings.OnSendAddinsEnabled;return e&&t?n&&Object(Z.a)(1).length>0:n}var ee=n(1),te=n(1231),ne=n(906);var re=n(3072),ie=n(3073),oe=n(2143),ae=n.n(oe),se=n(141),ce=n(9);var ue=n(2515);function le(e,t,n){return s.__awaiter(this,void 0,void 0,function(){var r,i,o;return s.__generator(this,function(a){switch(a.label){case 0:return Object(ue.f)(t)?[4,function(){return s.__awaiter(this,void 0,void 0,function(){var e;return s.__generator(this,function(t){switch(t.label){case 0:return[4,Object(se.b)(ae.a.gdprMinorDialogTitleText,ae.a.gdprMinorWarningText,!1,{okText:ae.a.gdprMinorDialogOKButtonText,cancelText:ae.a.gdprMinorRemoveAddinText})];case 1:return e=t.sent(),Object(ce.n)("ExtGDPRMinorDialogResponse",[e]),e===se.a.cancel&&Object(A.d)()&&Object(ie.a)(),[2]}})})}()]:[3,2];case 1:return a.sent(),[2];case 2:return r=Object(l.k)(e),i=!0,r.mode!==_.a.MessageRead&&r.mode!==_.a.AppointmentAttendee||(o=r.getItem(),i=Object(u.O)(o)),[4,Object(se.b)(ae.a.restrictedItemDialogHeader,"",i,{bodyElement:ee.createElement("p",null,ae.a.restrictedItemDialogLabel),hideCancelButton:!0})];case 3:return a.sent(),i?(Object(ce.n)("AddinLaunched",{addinId:t.extension.Id,marketplaceAssetId:t.extension.MarketplaceAssetID,isAddinPinned:r.isAddinPinned(t.extension.Id),isPinnableExperienceEnabled:Object(A.f)()}),ne.c(t.control)?Object(re.a)(e,t,r.mode,n):ne.a(t.control)&&(c=t,d=e,p=Object(u.s)(3),Object(u.N)(p,c,d)),[2]):[2]}var c,d,p})})}var de=n(3436),pe=n(1635),me=function(){function e(e,t){this.key=e,this.name=t}return e.prototype.generateData=function(){return{key:this.key,name:this.name,title:this.description,ariaLabel:this.accessibilityText,iconProps:Object(de.a)(this.iconUrl),itemType:pe.a.Normal,getClickHandler:this.getClickHandler,subMenuProps:this.subMenuData?{items:[this.subMenuData.generateData()]}:null}},e}(),he=function(){function e(e,t){this.key=e,this.header=t,this.menuItemDataList=[]}return e.prototype.addItem=function(e){this.menuItemDataList.push(e)},e.prototype.generateItemsData=function(){var e,t;try{for(var n=s.__values(this.menuItemDataList),r=n.next();!r.done;r=n.next()){var i=r.value;this.data.push(i.generateData())}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e.prototype.generateData=function(){return this.data=[],this.generateItemsData(),{key:this.key,itemType:pe.a.Section,sectionProps:{title:this.header,items:this.data}}},e}();function fe(e,t,n){var r,i,o,a,c,u,l,d=new he(e,t);try{for(var p=s.__values(n),m=p.next();!m.done;m=p.next()){var h=m.value;d.addItem((void 0,void 0,void 0,l=void 0,a=(o=h).control,c=a.Id,u=a.Label,l=new me(c,u),o.isMenu?l.subMenuData=fe(c,u,o.subCommands):o.isActionable&&(l.getClickHandler=ve(o)),l.iconUrl=o.control.Icon.Size16Url,l.accessibilityText=o.control.Label,l.description=o.control.Supertip.Title,l))}}catch(e){r={error:e}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}return d}function ge(e){var t=new me(e.Id,e.DisplayName);if(Object(ue.h)(e))if(Object(ue.g)(e))t.subMenuData=fe(e.Id,e.DisplayName,Object(ue.d)(e).subCommands);else{var n=e.AddinCommands.values();t.subMenuData=fe(e.Id,e.DisplayName,n)}else Object(ue.a)(e)&&(t.getClickHandler=ve(Object(ue.d)(e)));return t.description=Object(ue.e)(e),t.accessibilityText=Object(ue.b)(e),t.iconUrl=e.IconUrl,t}var ye=n(3437);function ve(e){return function(t){return function(n){n.stopPropagation(),le(t,e)}}}function be(e){var t=function(e){var t,n,r=new he("AddinsHeader",ae.a.overflowMenuHeaderAddins);try{for(var i=s.__values(e),o=i.next();!o.done;o=i.next()){var a=o.value;r.addItem(ge(a))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(e).generateData();return Object(A.b)("addin-inClientStoreEnabled")&&(t.sectionProps.items.push(Object(ye.b)()),t.sectionProps.items.push(Object(ye.a)())),t}var Ee=n(524),Ie=n(1588),Ce=n(1587),Me=n(14),xe=n(4341),Se=function(e){function t(t){var n=e.call(this,t,{hasLoadFailed:!1})||this;return n.handleAddinButtonLeftClick=function(e){e.stopPropagation(),Object(ue.a)(n.props.addin)&&le(n.props.hostItemIndex,Object(ue.d)(n.props.addin))},n.props=t,n.state={hasLoadFailed:!1},n}return s.__extends(t,e),t.prototype.onLoadingStateChanged=function(e){e==Ce.c.error?this.setState({hasLoadFailed:!0}):this.setState({hasLoadFailed:!1})},t.prototype.render=function(){var e={iconType:Ie.a.Image,imageProps:{src:this.props.addin.IconUrl,width:16,height:16,imageFit:Ce.b.contain,onLoadingStateChange:this.onLoadingStateChanged.bind(this)}},t={iconType:Ie.a.Default,iconName:"Photo2"},n=Object(ue.b)(this.props.addin),r={className:xe.addinEntryButton,iconProps:this.state.hasLoadFailed?t:e,title:n,ariaLabel:n};if(Object(ue.a)(this.props.addin))return ee.createElement(Ee.IconButton,s.__assign({onClick:this.handleAddinButtonLeftClick},r));if(Object(ue.h)(this.props.addin)){var i=ge(this.props.addin).generateData();return Object(te.a)(this.props.hostItemIndex,i),ee.createElement(Ee.IconButton,s.__assign({onMenuClick:this.handleAddinButtonLeftClick,menuProps:i.subMenuProps,menuIconProps:null},r))}return null},t=s.__decorate([Me.observer],t)}(ee.Component),Re=n(4343),Oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s.__extends(t,e),t.prototype.render=function(){var e,t,n=[];try{for(var r=s.__values(this.props.addins),i=r.next();!i.done;i=r.next()){var o=i.value;n.push(ee.createElement(Se,{hostItemIndex:this.props.hostItemIndex,addin:o,key:o.Id}))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return ee.createElement("div",{className:Re.listViewContainer},n)},t}(ee.Component),Te=n(2580),we=n(4345),je=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleChevronLeftClick=function(e){e.stopPropagation()},t}return s.__extends(t,e),t.prototype.render=function(){var e={iconType:Ie.a.Default,iconName:"ChevronDownMed",className:Te([we.overflowChevron])},t={className:Te([we.overflowChevronContainer]),iconProps:e,title:ae.a.overflowMenuTooltip,ariaLabel:ae.a.overflowMenuAccessibilityLabel},n=be(this.props.addins);return Object(te.a)(this.props.hostItemIndex,n),ee.createElement("div",{className:Te([we.overflowContainer])},ee.createElement("div",{className:Te([we.overflowDivider])}),ee.createElement(Ee.IconButton,s.__assign({onMenuClick:this.handleChevronLeftClick,menuProps:{items:[n]},menuIconProps:null},t)))},t=s.__decorate([Me.observer],t)}(ee.Component),_e=n(4347),Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s.__extends(t,e),t.prototype.getMaxVisibleAddinsCount=function(e){switch(e){case _.a.MessageRead:return 3;case _.a.MessageCompose:default:return 5}},t.prototype.render=function(){var e=u.h.HostItems.get(this.props.Index),t=u.h.EnabledAddinCommands;if(!e)return ee.createElement("div",null);var n=Object(l.k)(this.props.Index),r=this.getMaxVisibleAddinsCount(n.mode),i=t.getExtensionPoint(n.mode),o=null;return(r=Math.min(r,i.length))<i.length&&(o=ee.createElement(je,{hostItemIndex:this.props.Index,addins:i.slice(r,i.length)})),ee.createElement("div",{className:_e.divContainer},ee.createElement(Oe,{hostItemIndex:this.props.Index,addins:i.slice(0,r)}),o)},t=s.__decorate([Me.observer],t)}(ee.Component),Ae=n(3313),De=n(3327),ke=n(3433);function Be(e,t,n){Object(u.y)(e,t,n);var r=Object(u.n)();Object(ke.a)(t,r.contextualCalloutState.activeContextualAddinCommands[0])}function Ue(e,t,n,r,i){return s.__awaiter(this,void 0,void 0,function(){var o;return s.__generator(this,function(a){switch(a.label){case 0:return null==(o=Object(ue.c)(t,n,r))?[3,2]:[4,le(e,o,i)];case 1:return a.sent(),[2];case 2:return[2,null]}})})}var Ne={};function He(e){return Ne[e]||(Ne[e]=Object(U.computed)(function(){var t=Object(u.n)().Context,n=Object(u.n)().EnabledAddinCommands;return function(e,t,n){if(n&&t.isInitialized){var r=t.getExtensionPoint(e);return be(r)}return null}(e,n,t)})),Ne[e]}var Le=n(2917),Fe=n(2935),Ve=n(11),We=n.n(Ve),ze=n(18),Ge=n(3314);function qe(e){return s.__awaiter(this,void 0,void 0,function(){var t,n,r;return s.__generator(this,function(i){switch(i.label){case 0:if(!Object(A.b)("addin-itemSendEvent"))return[2,!0];if(t=Object(Ge.a)(),function(){var e=Object(u.n)().Context,t=Object(u.C)();if(Object(Y.a)().SegmentationSettings.OnSendAddinsEnabled&&(!e||!t))return Object(Fe.a)(We.a.messageSendingFailTitle,ae.a.itemSendEventAddinErrorExtensibilityUnavailable,!1,{hideCancelButton:!0}),!0;return!1}())return Object(Ge.c)(t,1),[2,!1];n=Object(u.o)(1),o=e,n.forEach(function(e){return Object(l.p)(o,e.extension.Id,e.extension.Id+"ItemSend")}),r=0,i.label=1;case 1:return r<n.length?[4,function(e,t,n){return s.__awaiter(this,void 0,void 0,function(){var r,i;return s.__generator(this,function(o){switch(o.label){case 0:return r=Object(u.s)(3),[4,Object(u.N)(r,t,e)];case 1:return(i=o.sent()).status!==u.e.Success||!1===i.allowEvent?(Object(l.c)(e,t.extension.Id,!1,t.extension.Id+"ItemSend",0,Object(ze.format)(ae.a.itemSendEventAddinBlockEvent,t.extension.DisplayName)),Object(Ge.b)(n,i,t),[2,!1]):[2,!0]}})})}(e,n[r],t)]:[3,4];case 2:if(!i.sent())return[2,!1];t.addCheckmark("ItemSend"+r),i.label=3;case 3:return r++,[3,1];case 4:return n.length>0?Object(Ge.c)(t,4):t.invalidate(),[2,!0]}var o})})}n.d(t,"removeExtensibilityNotification",function(){return i.h}),n.d(t,"updatePersistentNotifications",function(){return o.a}),n.d(t,"closeTaskPaneAddinCommand",function(){return a.a}),n.d(t,"initializeAddinsForItem",function(){return B}),n.d(t,"deinitializeAddinsForItem",function(){return N}),n.d(t,"onHostItemChanged",function(){return F}),n.d(t,"initializeExtensibilityContext",function(){return c.a}),n.d(t,"whenItemHasContextualAddinKeywords",function(){return W}),n.d(t,"triggerAppointmentTimeChangedEvent",function(){return z.e}),n.d(t,"isTranslatorEnabled",function(){return G.a}),n.d(t,"launchTranslateCommand",function(){return Q}),n.d(t,"setPersistedAddin",function(){return J.a}),n.d(t,"shouldForceFullCompose",function(){return $}),n.d(t,"AddinBarView",function(){return Pe}),n.d(t,"TaskPaneCollection",function(){return Ae.a}),n.d(t,"onComposeClose",function(){return De.a}),n.d(t,"openContextualCallout",function(){return Be}),n.d(t,"launchAddinCommand",function(){return Ue}),n.d(t,"observeAddinCommandSurfaceItems",function(){return He}),n.d(t,"onItemNavigation",function(){return Le.a}),n.d(t,"allowItemSendEvent",function(){return qe})},2449:function(e,t,n){"use strict";n.d(t,"b",function(){return d}),n.d(t,"a",function(){return m}),n.d(t,"d",function(){return f}),n.d(t,"c",function(){return g});var r=n(0),i=n(597),o=n(483),a=n(195),s=n(2450),c=n(2451),u=n(48),l=n(371);var d=function(e){return function(t,n,r){return Object(c.a)(e,t,n,r).catch(p)}};function p(e){throw e.messageId?function(e){switch(e){case"ErrorTooLargeForLocalAttachmentSingle":case"ErrorTooLargeForLocalAttachmentMultiple":return o.b.AttachmentSizeExceeded;default:return o.b.AttachmentUploadGeneralFailure}}(e.messageId):o.b.AttachmentUploadGeneralFailure}var m=function(e){return function(t,n,r){return Object(s.a)(e,t,n,r).catch(p)}};function h(e,t){var n=e.filter(function(e){return e.attachmentId.Id===t});return n.length>0?n[0]:null}var f=function(e){return function(t){return new Promise(function(n,i){a.f.import().then(function(a){try{var s=h(e.attachmentWell.docViewAttachments,t);if(s||(s=h(e.attachmentWell.imageViewAttachments,t)),s||(s=h(e.attachmentWell.inlineAttachments,t)),!s)return void i(new o.a(o.b.AttachmentToDeleteDoesNotExist));var c=r.__assign({},e.itemId,{mailboxInfo:Object(u.a)()});a(e.attachmentWell,s,c,Object(l.a)(e),Object(l.c)(e)),n()}catch(e){i(new o.a(o.b.AttachmentDeleteGeneralFailure))}})})}},g=function(e){return!(!e||0==e.length)&&e.some(function(e){return e.file.fileType==i.a.Uri&&e.isInline})}},2450:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(597),i=n(656),o=n(1545),a=n(371);function s(e,t,n,s){return new Promise(function(c,u){var l=!1,d=Object(a.a)(e);try{var p=Object(r.g)([{name:t,url:n}]),m=Object(i.b)(e).inlineImagePlugin,h="HTML"!=e.bodyType?null:m.processInlineImageBeforeUpload.bind(m);Object(o.a)(p,s,e,!1,!0,h,function(e,t){d(e,t),l||(l=!0,u({errorType:"UploadError",id:e}))},Object(a.c)(e),function(e){l||(l=!0,c(e.Id))})}catch(e){u({errorType:"UploadError"})}})}},2451:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(597),i=n(1545),o=n(371);function a(e,t,n,a){return new Promise(function(s,c){var u=!1,l=Object(o.a)(e),d=Object(r.f)([t],[n]);Object(i.a)(d,a,e,!1,!1,null,function(e,t){l(e,t),u||(u=!0,c({errorType:"UploadError",id:e}))},Object(o.c)(e),function(e){u||(u=!0,s(e.Id))})})}},2935:function(e,t,n){"use strict";var r=n(0),i=n(542),o=n(373),a=n(527),s=n(94),c=n(220),u=n(10),l=n.n(u),d=n(1),p=n(40),m=n(2941),h=0,f=function(e){function t(t){var n=e.call(this,t)||this;return n.cancelId="cancel-"+h++,n.okId="ok-"+h++,n.onClick=function(e){e&&(n.props.customizationOptions&&n.props.customizationOptions.delayCallbackAfterAnimation?n.delayedCallback=e:e()),n.setState({isShown:!1})},n.onDismiss=function(){n.props.onDismissCallback&&n.props.onDismissCallback(),n.props.customizationOptions.preventSoftDismiss||n.setState({isShown:!1})},n.onDismissed=function(){n.delayedCallback&&(n.delayedCallback(),n.delayedCallback=null),n.props.onClose()},n.state={isShown:!0},n}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.customizationOptions,n=function(){return e.onClick(e.props.onOkCallback)};return d.createElement(a.a,{isOpen:this.state.isShown,type:s.a.normal,onDismiss:this.onDismiss,onDismissed:this.onDismissed,subText:this.props.subText,title:this.props.title,containerClassName:t.containerClassName,contentClassName:m.content,modalProps:{firstFocusableSelector:this.firstFocusableSelector}},d.createElement("form",{onSubmit:function(e){e.preventDefault(),n()}},t.bodyElement,d.createElement("input",{className:m.hideSubmitButton,type:"submit"})),d.createElement(c.a,null,d.createElement(i.a,{id:this.okId,buttonType:o.a.primary,onClick:n,title:t.okToolTip},t.okText||l.a.okButton),t.hideCancelButton?null:d.createElement(i.a,{id:this.cancelId,buttonType:o.a.normal,onClick:function(){return e.onClick(e.props.onCancelCallback)},title:t.cancelToolTip},t.cancelText||l.a.cancelButton)))},Object.defineProperty(t.prototype,"firstFocusableSelector",{get:function(){var e=this.props.customizationOptions,t=e.hideCancelButton,n=e.focusOnCancel,r=e.focusSelector;return"ms-Dialog-inner "+(!t&&n?"#"+this.cancelId:r||"#"+this.okId)},enumerable:!0,configurable:!0}),t.defaultProps={customizationOptions:{}},t}(d.Component),g=0;var y=function(e,t,n,r,i,o){var a=document.createElement("div");a.id="confirmDialog"+g++,document.body.appendChild(a),p.render(d.createElement(f,{title:e,subText:t,customizationOptions:n,onOkCallback:r,onCancelCallback:i,onDismissCallback:o,onClose:function(){p.unmountComponentAtNode(a),document.body.removeChild(a)}}),a)},v=n(693);function b(e,t,n,r){return n?Promise.resolve(v.a.ok):new Promise(function(n,i){y(e,t,r,function(){n(v.a.ok)},function(){n(v.a.cancel)},function(){n(v.a.dismiss)})})}n.d(t,"a",function(){return b})},2941:function(e,t,n){var r=n(2942),i=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},2942:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,".VHdW41_pzN_kcH6PttbMk{max-height:80%;overflow:auto}.nAEzwgs_CqNZjD5faws7C{display:none}",""]),t.locals={content:"VHdW41_pzN_kcH6PttbMk",hideSubmitButton:"nAEzwgs_CqNZjD5faws7C"}},371:function(e,t,n){"use strict";var r=n(392),i=n(393);n.d(t,"a",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return s});var o=function(e){return function(t,n){Object(r.a)(e,t,n)}},a=function(e){return function(t){Object(i.a)(e,t)}},s=function(e){return function(){return e.infoBarIds}}},373:function(e,t,n){"use strict";var r,i,o,a;n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o}),(i=r||(r={}))[i.button=0]="button",i[i.anchor=1]="anchor",(a=o||(o={}))[a.normal=0]="normal",a[a.primary=1]="primary",a[a.hero=2]="hero",a[a.compound=3]="compound",a[a.command=4]="command",a[a.icon=5]="icon",a[a.default=6]="default"},392:function(e,t,n){"use strict";var r=n(1572),i=n(4),o=Object(i.action)("addInfoBarMessageInCompose")(function(e,t,n){Object(r.a)(e,t,e.composeId,n)});t.a=o},393:function(e,t,n){"use strict";var r=n(1455),i=n(4),o=Object(i.action)("removeInfoBarMessageInCompose")(function(e,t){e.infoBarIds&&e.infoBarIds.length&&(t?(t=Array.isArray(t)?t:[t]).forEach(function(t){Object(r.a)(e,t,e.composeId)}):e.infoBarIds.forEach(function(t){Object(r.a)(e,t,e.composeId)}))});t.a=o},396:function(e,t,n){"use strict";var r=n(318);t.a={MailComposeReply:{datapoint:{name:"MailComposeReply",options:{isQos:!0},customData:function(e,t,n,r,i){return[i,t]}}},MailComposeReplyAll:{datapoint:{name:"MailComposeReplyAll",options:{isQos:!0},customData:function(e,t,n,r,i){return[i,t]}}},MailComposeForward:{datapoint:{name:"MailComposeForward",options:{isQos:!0},customData:function(e,t){return[t]}}},MailComposeSend:{datapoint:{name:"MailComposeSend",options:{isQos:!0},customData:function(e,t,n){return[e,t,null]}}},MailComposeSendAsync:{datapoint:{name:"MailComposeSendAsync",options:{isQos:!0}}},MailComposeSendE2E:{datapoint:{name:"MailComposeSendE2E",options:{isCore:!0},customData:function(e){return{composeTraceId:e.logTraceId,operation:e.operation,isGroupScenario:null!=e.groupId&&Object(r.c)(e)}}}},MailComposeSendRequestReadReceipt:{datapoint:{name:"MailComposeSendRequestReadReceipt"}},MailComposeSave:{datapoint:{name:"MailComposeSave"}},MailComposeUpConvert:{datapoint:{name:"MailComposeUpConvert"}},ComposeCommandDiscardCompose:{datapoint:{name:"ComposeCommandDiscardCompose",customData:function(e){return{composeTraceId:e.logTraceId,wasEmptyBody:e.initialContent===e.content,wasEmptySubject:""===e.subject}},options:{isCore:!0},cosmosOnlyData:function(e){return JSON.stringify({smartReplyExtractionId:e.smartReplyExtractionId})}}},ComposeCommandShowFrom:{datapoint:{name:"ComposeCommandShowFrom"}},ComposeCommandSetImportance:{datapoint:{name:"ComposeCommmandSetImportance",customData:function(e,t){return[t]}}},SmartReplySendMessage:{datapoint:{name:"SmartReplySendMessage",customData:function(e){return[e]}}},SmartReplySaveMessage:{datapoint:{name:"SmartReplySaveMessage",customData:function(e){return[e]}}},SmartReplyDiscardMessage:{datapoint:{name:"SmartReplyDiscardMessage",customData:function(e){return[e]}}},UpgradeCompose:{datapoint:{name:"UpgradeCompose"}},UpgradeComposeTimedOut:{datapoint:{name:"UpgradeComposeTimedOut"}},UpgradeComposeCompleted:{datapoint:{name:"UpgradeComposeCompleted",customData:function(e,t){return[e,t]}}}}},398:function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(95),a=n(1634),s=n(1825),c=n(41),u=n(1839),l=n(212),d=n(264),p=n(382),m=Object(u.b)(function(e,t,n){var r,i,o,a=Object(l.a)(e),s=Object(d.a)(e),u={root:{maxWidth:"280px",minHeight:"72px",height:"auto",padding:"20px"},flexContainer:{flexDirection:"row",alignItems:"flex-start",minWidth:"100%",margin:""},textContainer:{textAlign:"left"},icon:{fontSize:"2em",lineHeight:"1em",height:"1em",margin:"0px 8px 0px 0px",flexBasis:"1em",flexShrink:"0"},label:{margin:"0 0 5px",lineHeight:"100%",fontWeight:c.FontWeights.semibold},description:[e.fonts.small,{lineHeight:"100%"}]},m={description:{color:e.palette.neutralSecondary},descriptionHovered:{color:e.palette.neutralDark},descriptionPressed:{color:"inherit"},descriptionChecked:{color:"inherit"},descriptionDisabled:{color:"inherit"}},h={description:{color:e.palette.white,selectors:(r={},r[c.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},r)},descriptionHovered:{color:e.palette.white,selectors:(i={},i[c.HighContrastSelector]={color:"Window",backgroundColor:"Highlight",MsHighContrastAdjust:"none"},i)},descriptionPressed:{color:"inherit"},descriptionChecked:{color:"inherit"},descriptionDisabled:{color:"inherit",selectors:(o={},o[c.HighContrastSelector]={color:"inherit"},o)}};return Object(c.concatStyleSets)(a,u,n?Object(p.a)(e):Object(p.b)(e),n?h:m,s,t)});n.d(t,"a",function(){return h});var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._skipComponentRefResolution=!0,t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.primary,n=void 0!==t&&t,a=e.styles,s=e.theme;return i.createElement(o.a,r.__assign({},this.props,{variantClassName:n?"ms-Button--compoundPrimary":"ms-Button--compound",styles:m(s,a,n)}))},t=r.__decorate([Object(a.b)("CompoundButton",["theme","styles"],!0)],t)}(s.a)},4341:function(e,t,n){var r=n(4342),i=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},4342:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'.NOL8VCjMRb9QkTChzvkvg{width:16px;height:16px}html[dir] .NOL8VCjMRb9QkTChzvkvg{padding:7px}._1men1gsibV5HaT7jCsOo9n{width:30px;height:30px;cursor:pointer}html[dir] ._1men1gsibV5HaT7jCsOo9n{background-color:transparent;padding:0}html[dir=ltr] ._1men1gsibV5HaT7jCsOo9n{margin:0 5px 0 0}html[dir=rtl] ._1men1gsibV5HaT7jCsOo9n{margin:0 0 0 5px}html[dir] ._1men1gsibV5HaT7jCsOo9n:hover{background-color:"[theme:themeLighter, default:#DEECF9]"}._1men1gsibV5HaT7jCsOo9n .ms-Button-menuIcon{display:none}',""]),t.locals={image:"NOL8VCjMRb9QkTChzvkvg",addinEntryButton:"_1men1gsibV5HaT7jCsOo9n"}},4343:function(e,t,n){var r=n(4344),i=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},4344:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,".FQ02ue1aX4xwyMt6X5DhP{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;height:30px}",""]),t.locals={listViewContainer:"FQ02ue1aX4xwyMt6X5DhP"}},4345:function(e,t,n){var r=n(4346),i=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},4346:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'._2w1quIbp_EboRMeUURPAlB{display:block}html[dir] ._2w1quIbp_EboRMeUURPAlB{background:transparent;border:none}html[dir=ltr] ._2w1quIbp_EboRMeUURPAlB{margin-right:5px}html[dir=rtl] ._2w1quIbp_EboRMeUURPAlB{margin-left:5px}._3LBXcAMg_xy8alwyBCVIEC{height:16px;width:0;color:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir] ._3LBXcAMg_xy8alwyBCVIEC{padding:0;margin:7px 0}html[dir=ltr] ._3LBXcAMg_xy8alwyBCVIEC{border-right-width:1px;border-right-style:solid;float:left}html[dir=rtl] ._3LBXcAMg_xy8alwyBCVIEC{border-left-width:1px;border-left-style:solid;float:right}.bWH8G54FUDIJnpWV4EPCH{display:inline-block;width:30px;height:30px;cursor:pointer}html[dir] .bWH8G54FUDIJnpWV4EPCH{background-color:transparent}html[dir] .bWH8G54FUDIJnpWV4EPCH:hover{background-color:"[theme:themeLighter, default:#DEECF9]"}.bWH8G54FUDIJnpWV4EPCH .ms-Button-menuIcon{display:none}._2OBjwjg8lV_PJUYMGgINNZ{font-size:10px;color:"[theme:neutralSecondary, default:#666666]"}',""]),t.locals={overflowContainer:"_2w1quIbp_EboRMeUURPAlB",overflowDivider:"_3LBXcAMg_xy8alwyBCVIEC",overflowChevronContainer:"bWH8G54FUDIJnpWV4EPCH",overflowChevron:"_2OBjwjg8lV_PJUYMGgINNZ"}},4347:function(e,t,n){var r=n(4348),i=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},4348:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,".mC892TZbvENg--nUlkCC_{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex}html[dir=ltr] .mC892TZbvENg--nUlkCC_{float:right}html[dir=rtl] .mC892TZbvENg--nUlkCC_{float:left}",""]),t.locals={divContainer:"mC892TZbvENg--nUlkCC_"}},508:function(e,t,n){"use strict";n.d(t,"d",function(){return y}),n.d(t,"e",function(){return v}),n.d(t,"c",function(){return b}),n.d(t,"a",function(){return E});var r=n(0),i=n(392),o=n(393),a=n(396),s=n(1558),c=n(1403),u=n(318),l=n(888),d=n(887),p=n(6),m=n(4),h=n(1392),f={};function g(e){var t=f[e.composeId];return t||(t={activeSaveAction:null,hasPendingSaveAction:!1},f[e.composeId]=t),t}function y(e,t){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return(n=g(e)).activeSaveAction=t,[4,t.then(function(e){return n.activeSaveAction=null,Promise.resolve(e)}).catch(function(e){return n.activeSaveAction=null,Promise.reject(e)})];case 1:return r.sent(),[2]}})})}function v(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return(t=f[e.composeId])&&t.activeSaveAction?[4,t.activeSaveAction]:[3,2];case 1:return n.sent(),[2,Promise.resolve(!0)];case 2:return[2,Promise.resolve(!1)]}})})}function b(e){var t=f[e.composeId];return t&&!!t.activeSaveAction}function E(e){f[e.composeId]&&delete f[e.composeId]}t.b=Object(m.action)("trySaveMessage",a.a.MailComposeSave)(function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(a){switch(a.label){case 0:return e?e.isSending?[2,Promise.resolve()]:(t||Object(o.a)(e,s.a),m=e,Object(u.a)(m)<=Object(p.a)().MaxRecipientsPerMessage?[4,function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return(t=g(e)).activeSaveAction?[3,1]:[2,Promise.resolve(!0)];case 1:return t.hasPendingSaveAction?[4,t.activeSaveAction]:[3,3];case 2:return n.sent(),[2,Promise.resolve(!1)];case 3:return t.hasPendingSaveAction=!0,[4,t.activeSaveAction];case 4:return n.sent(),t.hasPendingSaveAction=!1,[2,Promise.resolve(!0)]}})})}(e)]:(t||Object(i.a)(e,"warningMessageMaxRecipientsExceed"),[2,Promise.resolve()])):[2,Promise.reject("could not save message if view state does not exist")];case 1:return a.sent()?[2,y(e,Object(c.d)(e).then(function(n){return Object(c.c)(n,e),Object(l.a)()&&Object(d.a)(e,t?2:4),Object(h.a)(1,e.smartReplyExtractionId),Promise.resolve()}).catch(function(r){return t||Object(c.b)(r,e,!1),n?Promise.reject(r):Promise.resolve()}))]:[2,Promise.resolve()]}var m})})})},542:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var r=n(0),i=n(1),o=n(1632),a=n(1825),s=n(373),c=n(399),u=n(96),l=n(398),d=n(524),p=n(525),m=function(e){function t(t){var n=e.call(this,t)||this;return n._skipComponentRefResolution=!0,Object(o.b)("The Button component has been deprecated. Use specific variants instead. (PrimaryButton, DefaultButton, IconButton, ActionButton, etc.)"),n}return r.__extends(t,e),t.prototype.render=function(){var e=this.props;switch(e.buttonType){case s.a.command:return i.createElement(u.ActionButton,r.__assign({},e));case s.a.compound:return i.createElement(l.a,r.__assign({},e));case s.a.icon:return i.createElement(d.IconButton,r.__assign({},e));case s.a.primary:return i.createElement(p.a,r.__assign({},e));default:return i.createElement(c.a,r.__assign({},e))}},t}(a.a)},5584:function(e,t,n){"use strict";n.r(t);var r=n(2449);n.d(t,"hasInlineImage",function(){return r.c})},656:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"d",function(){return a}),n.d(t,"c",function(){return s});var r={};function i(e,t){r[e.composeId]=t}function o(e){return r[e.composeId]}function a(e){var t=o(e);t&&t.contentOperationPlugin&&t.contentOperationPlugin.stopSaveOnDispose(),delete r[e.composeId]}function s(e){var t=[e.dockingPlugin,e.ribbonPlugin,e.inlineImagePlugin,e.inlineImageResizePlugin,e.contentOperationPlugin,e.tableEdit];function n(e){e&&t.push(e)}return n(e.emojiPlugin),n(e.smartSuggestionsPlugin),n(e.linkPreviewPlugin),n(e.atMentionsPlugin),n(e.addinPlugin),n(e.accCheckerPlugin),n(e.pasteOptionPlugin),n(e.linkPlugin),n(e.editorPickerPlugin),n(e.cortanaComposePlugin),n(e.emojiPickerPlugin),t}},887:function(e,t,n){"use strict";var r=n(392),i=n(1606),o=n.n(i),a=n(1610),s=n.n(a),c=n(110),u=n(393),l=n(4),d=n(18),p=n(1187),m=n(1547),h=n(7),f=Object(l.action)("triggerPolicyTips")(function(e,t,n,r,i){var o=e.policyTipsViewState;if(!o.handlerDisabled&&!e.IRMData){var a,c,l,d=o.inProgressPolicyMatch,m=o.succeededPolicyMatch,h=o.pendingPolicyMatch;if(n||(n=v(e.subject)),r||(r=v(e.content)),i||(a=[],(c=e.attachmentWell).docViewAttachments.forEach(function(e){a.push(e.attachmentId)}),c.inlineAttachments.forEach(function(e){a.push(e.attachmentId)}),c.imageViewAttachments.forEach(function(e){a.push(e.attachmentId)}),i=a),o.isRequestInProgress)o.pendingRequests=!0,h.itemId=e.itemId,h.subjectChecksum=n,h.contentChecksum=r,h.eventTrigger=t,h.attachmentIds=i;else{if(o.pendingRequests=!1,d.itemId=e.itemId,d.subjectChecksum=n,d.contentChecksum=r,d.eventTrigger=t,d.attachmentIds=i,0==(l=d).subjectChecksum&&0==l.contentChecksum&&0==l.attachmentIds.length)return m.policyMatchDetails=[],m.subjectChecksum=0,m.contentChecksum=0,m.attachmentIds=[],void Object(u.a)(e,"dlpPolicyTips");(b(d,m)||function(e,t){if(e.attachmentIds.length!=t.attachmentIds.length)return!0;for(var n=0;n<e.attachmentIds.length;n++)if(null!=e.attachmentIds[n]&&null!=t.attachmentIds[n]&&e.attachmentIds[n].Id!=t.attachmentIds[n].Id)return!0;return!1}(d,m)||1==t)&&function(e){var t=e.policyTipsViewState,n=t.succeededPolicyMatch,r=t.inProgressPolicyMatch,i=e.itemId;if(i&&i.Id){var o={ItemId:i,ClientSupportsScanResultData:!0,ScanResultData:n.scanResultData,ScanResultMetadata:n.scanResultMetaData,BodyOrSubjectChanged:b(r,n),NeedToReclassify:!n.itemId,CustomizedStringsNeeded:!0,Recipients:Object(p.a)(e),EventTrigger:r.eventTrigger};e.policyTipsViewState.isRequestInProgress=!0,s()(o).then(function(t){!function(e,t,n,r){var i=t.policyTipsViewState,o=i.pendingPolicyMatch;i.isRequestInProgress=!1,i.pendingRequests&&o&&f(t,o.eventTrigger,o.subjectChecksum,o.contentChecksum,o.attachmentIds);0==e.EvaluationResult||1==e.OptimizationResult||2==e.EvaluationResult?n(t,e):r(t,e)}(t,e,g,y)})}}(e)}}});function g(e,t){var n,i=e.policyTipsViewState,a=i.succeededPolicyMatch,s=i.inProgressPolicyMatch;a.itemId=s.itemId,a.attachmentIds=s.attachmentIds,a.subjectChecksum=s.subjectChecksum,a.contentChecksum=s.contentChecksum,a.policyMatchDetails=t.Matches,t.ScanResultData&&(a.scanResultData=t.ScanResultData),t.ScanResultMetadata&&(a.scanResultMetaData=t.ScanResultMetadata),1==t.OptimizationResult&&(i.handlerDisabled=!0),function(e,t){if(t){var n=e.policyTipsViewState,r={complianceUrl:t.ComplianceURL,blockString:t.PolicyTipMessageBlockString,notifyString:t.PolicyTipMessageNotifyString,overrideString:t.PolicyTipMessageOverrideString};o()(n,r,function(e,t){return t||e})}}(e,t.CustomizedStrings),n=e,Object(u.a)(n,"dlpPolicyTips"),Object(m.a)(n.policyTipsViewState.succeededPolicyMatch)&&(Object(c.a)()?Object(r.a)(n,"consumerDlpPolicyTips"):Object(r.a)(n,"enterpriseDlpPolicyTips"))}function y(e,t){var n=e.policyTipsViewState;t?(h.c.warn(Object(d.format)("PolicyTips failed with EvaluationResult code of: {0}",t.EvaluationResult)+" Diagnostic: "+t.DiagnosticData),4!=t.EvaluationResult&&7!=t.EvaluationResult&&1!=t.EvaluationResult&&6!=t.EvaluationResult&&8!=t.EvaluationResult||(h.c.warn("Disabling further PolicyTips requests because of the failure"),n.handlerDisabled=!0)):(h.c.warn("PolicyTipsResponse is null (PolicyTipsRequest is timed out)"),n.handlerDisabled=!0),Object(u.a)(e,"dlpPolicyTips")}function v(e){var t=0;if(e)for(var n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}function b(e,t){return e.subjectChecksum!=t.subjectChecksum||e.contentChecksum!=t.contentChecksum}t.a=f},888:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(6),i=n(110),o=n(16);function a(){return Object(r.a)().PolicyTipsEnabled&&(Object(i.a)()||Object(o.b)("cmp-policyTips"))}},938:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"d",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"f",function(){return s}),n.d(t,"e",function(){return c});var r="onCloseInlineCompose",i="OnSuccessfulSendFromInlineCompose",o="UpdateInternetMessageId",a="closeCompose",s="openCompose",c="moveComposeToPopout"}},0,[6,7,25,34,57,0,152,218,225]]);
//# sourceMappingURL=owa.Addins.js.map
window.scriptsLoaded['owa.Addins.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.Addins.js'] = (new Date()).getTime();