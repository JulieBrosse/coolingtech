window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.MailOptin.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[81],{1187:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i});var r=n(1262),a=function(e){return[e.toRecipientWell,e.ccRecipientWell,e.bccRecipientWell]},o=function(e){var t=a(e);return Object(r.a)(t).map(function(e){return e.persona.EmailAddress.EmailAddress})},i=function(e){var t=a(e);return Object(r.a)(t).map(function(e){return e.persona.EmailAddress})}},1245:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(152),a=n.n(r);function o(e){return e?a()({Id:e.Id,ChangeKey:e.ChangeKey}):null}},1392:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r,a,o=n(9),i=n(396);function s(e,t){if(t){var n=null;switch(e){case 0:n=i.a.SmartReplySendMessage;break;case 1:n=i.a.SmartReplySaveMessage;break;case 2:n=i.a.SmartReplyDiscardMessage}var r=n.datapoint,a=r.name,s=r.customData;Object(o.n)(a,s(t))}}(a=r||(r={}))[a.Send=0]="Send",a[a.Save=1]="Save",a[a.Discard=2]="Discard"},1398:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(1559),a=n.n(r),o=n(1576),i=n.n(o),s=n(177),c=n.n(s),u=n(29),d=n.n(u),l=n(277),m=n(30);function p(e,t,n,r,o,s){var u,p,f,g,b,v,h,I=(u=e,p=t,f=n,g=r,b=o,v=s,h=i()({ClientSupportsIrm:!0,ComposeOperation:"newMail",MessageDisposition:f?"SendAndSaveCopy":"SaveOnly",OutboundCharset:"AutoDetect",Items:[u],TimeFormat:g,SendOnNotFoundError:!0,ItemShape:c()({BaseShape:"IdOnly",AdditionalProperties:[d()({FieldURI:"ItemLastModifiedTime"})]})}),v&&v.IsOwner&&(h.ComplianceId=v.RmsTemplateId?v.RmsTemplateId.toUpperCase():"0"),f?b&&(h.ItemShape.ReturnOnlyInternetMessageId=!0):(h.ItemShape=Object(l.b)(p),h.ShapeName="MailCompose"),h);return a()({Header:Object(m.getJsonRequestHeader)(),Body:I}).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}},1399:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var r=n(277),a=n(320),o=n(1617),i=n.n(o),s=n(177),c=n.n(s),u=n(29),d=n.n(u),l=n(1618),m=n.n(l),p=n(30);function f(e,t,n,o,s,u){var l,f,g,b,v,h,I,S=(l=e,f=t,g=n,b=o,v=s,h=u,I=i()({ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:b?"SendAndSaveCopy":"SaveOnly",OutboundCharset:"AutoDetect",Items:[f],TimeFormat:v,ItemShape:c()({BaseShape:"IdOnly",AdditionalProperties:[d()({FieldURI:"ItemLastModifiedTime"})]})}),b?h&&(I.ItemShape.ReturnOnlyInternetMessageId=!0):(I.ItemShape=Object(r.b)(g),I.ShapeName="MailCompose"),Object(a.b)("grp-consumerGroupPassSmtpAddressForCreateResponse")&&(I.GroupSmtpAddress=l),I);return m()({Header:Object(p.getJsonRequestHeader)(),Body:S}).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}},1403:function(e,t,n){"use strict";var r=n(0),a=n(392),o=n(1385),i=n.n(o),s=n(1398),c=n(1245),u=n(1399),d=new RegExp("<img[^>]*\\s+src=[\"']data:image\\/[^<]+;base64,[a-zA-Z0-9+\\/=&#;]+[\"'][^>]*>","gi");var l=n(1),m=n(335),p=n(10),f=n.n(p),g=n(11),b=n.n(g);var v=n(522),h=n(6),I=n(885),S=n.n(I),M=n(1619),O=n.n(M),j=n(1620),y=n.n(j),C=n(177),R=n.n(C),P=n(29),E=n.n(P),T=n(30);function w(e,t,n,r,a){var o,i,s,c,u,d=(o=e,i=t,s=r,c=a,u=y()({ModernGroupEmailAddress:{EmailAddress:o,MailboxType:"GroupMailbox"},ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:"SendAndSaveCopy",OutboundCharset:"AutoDetect",Items:[i],TimeFormat:s,ItemShape:R()({BaseShape:"IdOnly",AdditionalProperties:[E()({FieldURI:"ItemLastModifiedTime"})]})}),c&&(u.ItemShape.ReturnOnlyInternetMessageId=!0),u);return O()({Header:Object(T.getJsonRequestHeader)(),Body:d}).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}var A=new RegExp('<IMG[^>]+?ORIGINALSRC\\s*=\\s*"[\\s\\S]+?"[\\s\\S]*?>',"gim"),x=new RegExp('\\sSRC\\s*=\\s*"[\\s\\S]+?"',"im");var D=n(1408),F=n.n(D),B=n(1409),k=n.n(B),_=n(492),U=n.n(_),N=n(620),L=n.n(N),W=n(159),V=n.n(W),q=n(976),H=n.n(q);var z=n(493),Q=n(490),G=n.n(Q),J=n(152),K=n.n(J),$=n(491),X=n.n($);function Z(e,t,n){var r=[Object(z.a)("ToRecipients",e.ToRecipients),Object(z.a)("CcRecipients",e.CcRecipients),Object(z.a)("BccRecipients",e.BccRecipients),Object(z.a)("Subject",e.Subject),Object(z.a)("Body",e.Body),Object(z.a)("Importance",e.Importance),Object(z.a)("IsReadReceiptRequested",e.IsReadReceiptRequested),Object(z.a)("IsDeliveryReceiptRequested",e.IsDeliveryReceiptRequested)];e.From&&r.push(Object(z.a)("From",e.From)),e.MentionsEx&&r.push(Object(z.a)("MentionsEx",e.MentionsEx)),e.Sensitivity&&r.push(Object(z.a)("Sensitivity",e.Sensitivity)),e.ExtendedProperty&&e.ExtendedProperty.map(function(e){var t;r.push((t=e,H()({Path:V()(t.ExtendedFieldURI),Item:S()({ExtendedProperty:[L()(t)]})})))});var a=G()({Updates:r,ItemId:K()({Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey})}),o=U()({ItemChanges:[a],ConflictResolution:"AlwaysOverwrite",ClientSupportsIrm:!0,SendCalendarInvitationsOrCancellations:"SendToNone",MessageDisposition:t?"SendAndSaveCopy":"SaveOnly",SuppressReadReceipts:!1,ComposeOperation:"newMail",OutboundCharset:"AutoDetect",PromoteInlineAttachments:!1,SendOnNotFoundError:!0,ItemShape:R()({BaseShape:"IdOnly",AdditionalProperties:[E()({FieldURI:"ItemLastModifiedTime"})]})});return n&&n.IsOwner&&(o.ComplianceId=n.RmsTemplateId?n.RmsTemplateId.toUpperCase():"0"),o}var Y=n(1462),ee=n.n(Y),te=35356;var ne=n(1454),re=n(625),ae=n(938),oe=n(4),ie=Object(oe.action)(ae.d)(function(e,t,n){}),se=n(656),ce=n(18),ue="InternetHeaders",de="X-Ms-Exchange-Organization-Dlp-FalsePositive";var le=n(1565),me=n(318);n.d(t,"a",function(){return fe}),n.d(t,"e",function(){return ve}),n.d(t,"d",function(){return he}),n.d(t,"c",function(){return Ie}),n.d(t,"b",function(){return Se});var pe='<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css" style="display:none;"> P {{margin-top:0;margin-bottom:0;}} </style></head><body dir="{0}">{1}</body></html>',fe="ErrorSendCanceled";function ge(e){var t,n=e.content;if("HTML"==e.bodyType){var a=e.explicitTextDirection||(Object(h.a)().SessionSettings.IsUserCultureRightToLeft?ne.a.RTL:ne.a.LTR);n=(t=n)?t.replace(A,function(e){return e.replace(x,"")}):t,n=Object(ce.format)(pe,a,n)}var o=i()({BodyType:e.bodyType,Value:n});o.DataUriCount=function(e){var t=0;if(e){var n=e.match(d);t=n?n.length:0}return t}(e.content);var s,u=Object(c.a)(e.itemId),l=Object(c.a)(e.referenceItemId),m=Object(v.a)(e.toRecipientWell),p=Object(v.a)(e.ccRecipientWell),f=Object(v.a)(e.bccRecipientWell),g={Subject:e.subject||"",Importance:e.importance,IsReadReceiptRequested:e.isReadReceiptRequested,IsDeliveryReceiptRequested:e.isDeliveryReceiptRequested,ToRecipients:m,CcRecipients:p,BccRecipients:f,Sensitivity:e.sensitivity};e.useSmartResponse?s=(2==e.operation?F.a:k.a)(r.__assign({},g,{UpdateResponseItemId:u,ReferenceItemId:l,ReferenceItemDocumentId:e.referenceItemDocumentId||0,NewBodyContent:o})):(s=S()(r.__assign({},g,{Body:o})),e.itemId&&(s.ItemId=e.itemId));return e.fromViewState&&function(e,t){var n=e.from;if(n){var r=!1,a=Object(h.a)().SessionSettings.ConnectedAccountInfos;if(a)for(var o=0;o<a.length;o++){var i=a[o];if(i.EmailAddress==n.email.EmailAddress){r=!0;var s=L()({Value:i.SubscriptionGuid,ExtendedFieldURI:V()({PropertyId:te,DistinguishedPropertySetId:"Sharing",PropertyType:"CLSID"})});t.ExtendedProperty?t.ExtendedProperty.push(s):t.ExtendedProperty=[s],t.From=ee()({Mailbox:{MailboxType:n.email.MailboxType,RoutingType:"SMTP",EmailAddress:n.email.EmailAddress,Name:i.DisplayName}});break}}r||(t.From=ee()({Mailbox:n.email}))}}(e.fromViewState,s),s}function be(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,o,i,c;return r.__generator(this,function(d){switch(d.label){case 0:return n=ge(e),t&&function(e){var t=[];if(e.isReportedFalsePositive){var n={ExtendedFieldURI:{PropertyName:de,PropertyType:"String",DistinguishedPropertySetId:ue},Value:""};t.push(n)}return t}(e.policyTipsViewState).map(function(e){return r=e,void(null==(t=n).ExtendedProperty?t.ExtendedProperty=[r]:t.ExtendedProperty.push(r));var t,r}),[4,function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var a,o,i,s,c,u,d,l,m;return r.__generator(this,function(r){switch(r.label){case 0:return(a=Object(se.b)(e))&&(a.atMentionsPlugin&&a.atMentionsPlugin.isImported()||a.editorPickerPlugin&&a.editorPickerPlugin.isImported())?a.atMentionsPlugin?[4,a.atMentionsPlugin.getPlugin()]:[3,2]:[3,8];case 1:return i=r.sent(),[3,3];case 2:i=null,r.label=3;case 3:return(o=i)?(t?(d=Object(h.a)().SessionSettings,(l=o.getMentionsWrappersForSend({MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:d.UserEmailAddress,Name:d.UserDisplayName}))&&l.length>0&&(n.MentionsEx=l)):(m=o.getPendingTagsForSave()).length>0&&(n.PendingSocialActivityTagIds=m),[3,8]):[3,4];case 4:return a.editorPickerPlugin?[4,a.editorPickerPlugin.getPlugin()]:[3,6];case 5:return c=r.sent(),[3,7];case 6:c=null,r.label=7;case 7:(s=c)&&(u=s.dataProvider,t?(d=Object(h.a)().SessionSettings,(l=u.getMentionsWrappersForSend({MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:d.UserEmailAddress,Name:d.UserDisplayName}))&&l.length>0&&(n.MentionsEx=l)):(m=u.getPendingTagsForSave()).length>0&&(n.PendingSocialActivityTagIds=m)),r.label=8;case 8:return[2]}})})}(e,t,n)];case 1:return d.sent(),a=Object(h.a)().UserOptions.TimeFormat,[4,function(e,t,n,a){return r.__awaiter(this,void 0,void 0,function(){var o,i,c;return r.__generator(this,function(r){switch(r.label){case 0:return(o=e).groupId&&Object(me.c)(o)?a&&3!=e.operation?[4,w(o.groupId,t,e.bodyType,n,e.isInlineCompose)]:[3,2]:[3,4];case 1:return[2,r.sent()];case 2:return i=1==e.operation||2==e.operation,!e.itemId&&i||e.useSmartResponse?[4,Object(u.a)(o.groupId,t,e.bodyType,!1,n,e.isInlineCompose)]:[3,4];case 3:return[2,r.sent()];case 4:return!e.useSmartResponse&&e.itemId?[3,6]:[4,Object(s.a)(t,e.bodyType,a,n,e.isInlineCompose,e.IRMData)];case 5:return c=r.sent(),[3,8];case 6:return[4,(d=t,l=a,m=e.IRMData,p=Z(d,l,m),X()({Header:Object(T.getJsonRequestHeader)(),Body:p}).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))];case 7:c=r.sent(),r.label=8;case 8:return[2,c]}var d,l,m,p})})}(e,n,a,t)];case 2:return o=d.sent(),(i=o&&o.ResponseMessages&&o.ResponseMessages.Items?o.ResponseMessages.Items[0]:null)&&"Success"==i.ResponseClass?[2,Promise.resolve(i)]:(Object(le.d)(o,e),c=void 0,i?(c=new Error(i.ResponseCode)).messageText=i.MessageText:c=new Error("Unrecognized response"),[2,Promise.reject(c)])}})})}function ve(e){return be(e,!0)}function he(e){return be(e,!1)}function Ie(e,t){if(e&&e.Items){var n=e.Items[0];n&&(n.ItemId&&Object(re.a)(t,n.ItemId.Id,n.ItemId.ChangeKey,n.LastModifiedTime),n.InternetMessageId&&ie(t.conversationId,t.itemId?t.itemId.Id:null,n.InternetMessageId))}}function Se(e,t,n){if(e.message!=fe){var r,o=function(e,t){if(e){if(e.indexOf("500")>=0)return"error500";if(e.indexOf("503")>=0)return"error503";if(e.indexOf("Failed to fetch")>=0)return"errorFailedToFetch"}switch(e){case"ErrorSessionTimeout":return"errorSessionTimeout";case"ErrorMailboxStoreUnavaiable":return"errorMailboxStoreUnavailable";case"ErrorSendAsDenied":return"errorMessageNoPermissionToSendAs";case"ErrorRightsManagementPermanentException":return null;case"ErrorSubmissionQuotaExceeded":return"errorMessageSubmissionQuotaExceededMessageCanNotBeSent";case"ErrorAccountSuspend":return"errorMessageAccountSuspend";case"ErrorExceededMaxRecipientLimit":return"errorMessageExceededMaxRecipientLimit";case"ErrorExceededMessageLimit":return"errorMessageExceededMessageLimit";case"ErrorExceededHourlyMessageLimit":return"errorMessageExceededHourlyMessageLimit";case"ErrorMessageBlocked":return"errorMessageMessageBlocked";case"ErrorMessageSubmissionBlocked":return"errorMessageMessageSubmissionBlocked";case"ErrorAccountSuspendShowTierUpgrade":return"errorMessageAccountSuspendShowTierUpgrade";case"ErrorExceededMaxRecipientLimitShowTierUpgrade":return"errorMessageExceededMaxRecipientLimitShowTierUpgrade";case"ErrorExceededMessageLimitShowTierUpgrade":return"errorMessageExceededMessageLimitShowTierUpgrade";case"ErrorMessageTimeout":return"errorMessageTimeout";case"ErrorMessageThrottled":return"errorMessageThrottled";case"ErrorMessageTransientError":return"errorMessageTransientError";case"ErrorItemNotFound":return t?"errorMessageItemNoLongerExistToSend":"errorMessageItemNoLongerExistToSave";case"ErrorAccessDenied":return"warningMessageNoPermissionToPerformAction";case"ErrorQuotaExceeded":return t?"errorMessageQuotaExceededMessageCanNotBeSent":"errorMessageQuotaExceededMessageCanNotBeSaved";default:return t?"errorMessageMessageCanNotBeSent":"errorMessageMessageCanNotBeSaved"}}(e?e.message:null,n);"errorMessageMessageCanNotBeSent"==o&&e.messageText?Object(a.a)(t,"errorMessageErrorWithDetail",(r=e.messageText,function(){return{key:"errorMessageErrorWithDetail",source:m.c.Compose,rank:m.b.Error,messageParts:[f.a.errorMessageMessageCanNotBeSent,{showDetailsText:b.a.moreDetailsNotificationLabel,hideDetailsText:null,detailsElement:l.createElement("span",null,r)}]}})):Object(a.a)(t,o)}}},1454:function(e,t,n){"use strict";var r,a;(a=r||(r={})).LTR="ltr",a.RTL="rtl",t.a=r},1545:function(e,t,n){"use strict";var r=n(0),a=n(371),o=n(4),i=Object(o.action)("setNumberOfWaitingAttachments")(function(e,t){t<0||(e.numberOfWaitingAttachments=t)}),s=n(508),c=n(195),u=n(93),d=n(887),l=n(16),m=n(888);function p(e,t,n,o,p,f,g,b,v){return r.__awaiter(this,void 0,void 0,function(){var h,I;return r.__generator(this,function(S){switch(S.label){case 0:h=!1,Object(l.b)("cmp-upgradeCompose")&&!n.itemId&&(h=!0,i(n,n.numberOfWaitingAttachments+1)),S.label=1;case 1:return S.trys.push([1,,6,7]),(I=!n.itemId)?[4,Object(s.e)(n)]:[3,3];case 2:I=!S.sent(),S.label=3;case 3:return I?[4,Object(s.b)(n)]:[3,5];case 4:S.sent(),S.label=5;case 5:return M=e,O=t,j=n,y=o,C=p,R=f,P=g,E=b,T=function(e){v&&v(e),Object(m.a)()&&Object(d.a)(n,8)},c.e.import().then(function(e){var t=e(j.attachmentWell,r.__assign({},j.itemId,{mailboxInfo:Object(u.b)()}),M,P||Object(a.a)(j),E||Object(a.c)(j),O,y,C,T);if(O)for(var n=t.length,o=j.attachmentWell.inlineAttachments.length,i=0;i<n;i++){var s=j.attachmentWell.inlineAttachments[o-n+i];R&&R(s.placeholderId,t[i])}}),[3,7];case 6:return h&&i(n,n.numberOfWaitingAttachments-1),[7];case 7:return[2]}var M,O,j,y,C,R,P,E,T})})}n.d(t,"a",function(){return p})},1547:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(1611),a=n.n(r),o=n(1615),i=n.n(o);function s(e){var t=e.policyMatchDetails,n=t.filter(function(e){return 0!=e.MatchPriority});return n.length>0?i()(n,function(e){return e.MatchPriority}):a()(t,function(e){return function(e){switch(e){case 1:return 0;case 4:case 2:case 3:return 1;case 5:return 2;default:return 3}}(e.Action)})}},1558:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade","errorMessageExceededHourlyMessageLimit","errorMessageExceededMaxRecipientLimit","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimit","errorMessageExceededMessageLimitShowTierUpgrade","errorMessageMessageSubmissionBlocked","errorMessageMessageBlocked","errorMessageTimeout","errorMessageThrottled","errorMessageTransientError","errorMessageItemNoLongerExistToSave","errorMessageItemNoLongerExistToSend","errorMessageQuotaExceededMessageCanNotBeSaved","errorMessageQuotaExceededMessageCanNotBeSent","errorMessageSubmissionQuotaExceededMessageCanNotBeSent","errorMessageMessageCanNotBeSaved","errorMessageMessageCanNotBeSent","errorMessageNoPermissionToSendAs","errorMessageNoRecipentsMailCanNotBeSend","warningMessageMaxRecipientsExceed","warningMessageNoPermissionToPerformAction","error500","error503","errorFailedToFetch","errorSessionTimeout","errorMailboxStoreUnavailable","errorMessageErrorWithDetail"]},1565:function(e,t,n){"use strict";n.d(t,"d",function(){return d}),n.d(t,"c",function(){return l}),n.d(t,"b",function(){return m}),n.d(t,"a",function(){return p});var r=n(10),a=n.n(r),o=n(393),i=n(508),s="",c="",u="/owa/owahipcontrol.aspx?compose=1";function d(e,t){if(e){e.WasclUpgradeToPremiumUrl&&(s=e.WasclUpgradeToPremiumUrl),e.AccountRecoveryFlowUrl&&(c=e.AccountRecoveryFlowUrl);var n=e.ResponseMessages&&e.ResponseMessages.Items?e.ResponseMessages.Items[0]:null;!n||"ErrorExceededMessageLimit"!=n.ResponseCode&&"ErrorExceededHourlyMessageLimit"!=n.ResponseCode&&"ErrorExceededMessageLimitShowTierUpgrade"!=n.ResponseCode||Object(i.b)(t,!0)}}function l(e){return{text:a.a.errorMessageUpgradeToPremium,action:function(){Object(o.a)(e,["errorMessageExceededMessageLimit","errorMessageExceededMaxRecipientLimit"]),window.open(s)}}}function m(e){return{text:a.a.errorMessageVerify,action:function(){Object(o.a)(e,["errorMessageMessageSubmissionBlocked","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimitShowTierUpgrade"]),window.open(u)}}}function p(e){return{text:a.a.errorMessageVerify,action:function(){Object(o.a)(e,["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade"]),window.open(c)}}}},1567:function(e,t,n){"use strict";var r=n(1186),a=n(4);t.a=Object(a.action)("showCcWell")(function(e){e.ccRecipientWell||(e.ccRecipientWell=Object(r.a)(e.findPeopleFeedbackManager,[]))})},1580:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("switchToReadWriteRecipient")(function(e){e.showCompactRecipientWell=!1})},1939:function(e,t,n){"use strict";n.r(t);var r={optInReactClient:{datapoint:{name:"optInReactClient"}},cleanupOptInCallout:{datapoint:{name:"cleanupOptInCallout"}}},a=n(9),o=n(3924),i=n.n(o),s=n(2499),c=2,u=1e4,d=0;function l(e){Object(s.b)()&&(Object(s.d)(0),e.addEventListener("unload",function(){Object(s.a)()||Object(s.d)(null)}),Object(a.n)(r.optInReactClient.datapoint.name),function e(t){i()({clientTypeOptInState:2}).then(function(e){Object(s.d)(null)}).catch(function(n){d++<c&&t.setTimeout(function(){e(t)},u)})}(e))}var m=n(670),p=n(2188);var f=n(2669),g="appcacheuninstaller",b="owa/manifests/appCacheManifestHandler.ashx",v="?manifest=0&layout=mouse&UA=0",h="UnInstallAppcache",I="AppcacheObsolete",S=null;function M(e){var t,n;e.applicationCache&&(function(e){var t=null;null!=e.localStorage&&(t=e.localStorage.getItem(I));return t}(e)||((S=e.document.createElement("iframe")).src=(t=e.location.href,(n=new URL(t)).pathname=b,n.search=v,n.href),S.setAttribute("id",g),S.style.display="none",S.onload=function(){S.onload=null;try{t=e,(n=S.contentWindow.applicationCache).onobsolete=function(){j(t),O(n)},n.onerror=function(){j(t),O(n)}}catch(t){j(e)}var t,n},Object(f.b)(h,"true",{path:"/"}),e.document.body.appendChild(S)))}function O(e){e.onerror=null,e.onobsolete=null}function j(e){!function(e){if(null!=e.localStorage)try{e.localStorage.setItem(I,"1")}catch(e){}}(e),Object(f.b)(h),e.document.body.removeChild(S),S=null}var y=n(3925),C=n.n(y),R=n(626),P=n.n(R),E=69,T=1,w="ReOptInClk";function A(){var e,t;Object(s.b)()&&(Object(a.n)(r.cleanupOptInCallout.datapoint.name),Object(f.a)(w)&&(P()({datapoints:[{Id:"PerfTraceCTQ",Consumers:1,Time:new Date(Date.now()).toISOString(),Keys:["S","cd"],Values:["lightningPeekMore","id_"+E+"|category_4"]}]}),Object(f.b)(w)),C()({Identities:[E],Command:T})),Object(s.b)()&&Object(p.e)(),Object(s.b)()&&Object(m.b)("addin-persistentTaskPane")&&Object(p.f)(),l(window),e=window,null!=(t=e.navigator.serviceWorker)&&null!=t.controller&&t.getRegistrations().then(function(t){for(var n=e.location.origin+"/",r=0;r<t.length;++r)n.toLowerCase()==t[r].scope.toLowerCase()&&t[r].unregister()}),M(window)}n.d(t,"initializeMailOptinService",function(){return A})},2188:function(e,t,n){"use strict";var r=n(483),a=n(2),o=n(597),i=n(191);function s(e){for(var t=[],n=0,a=e;n<a.length;n++){var s=a[n],c=null;s.attachmentType==r.g.Item?c={fileType:o.a.MailItem,name:s.name,size:s.size,itemId:s.id}:s.attachmentType==r.g.File&&(c={fileType:o.a.Uri,name:s.name,size:s.size,uri:s.id,type:Object(i.a)(s.id)}),c&&t.push({file:c,isInline:s.isInline})}return t}var c=n(16),u=n(75);function d(e,t,n,r,a,o){if(Object(c.b)("rp-popouts")){var i={operation:0,bodyType:"HTML",subject:r,newContent:a,to:e,cc:t,bcc:n,preferAsyncSend:!0},d=s(o);u.p.importAndExecute(i,u.a.Popout,null,d)}}var l=n(11),m=n.n(l);var p=n(2449),f=function(e){return function(){return e.fromViewState&&e.fromViewState.from?e.fromViewState.from.email:null}},g=n(1568),b=n(656),v=function(e){return function(){return e.content}},h=function(e){return function(t,n){(Object(g.a)(e,t),"HTML"==e.bodyType)&&Object(b.b)(e).addinPlugin.updateContent(t,n)}},I=function(e){return function(){return e.bodyType}},S=function(e){return function(t){var n=Object(b.b)(e).addinPlugin;n.prependContent(t),Object(g.a)(e,n.getContent())}},M=function(e){return function(t){var n=Object(b.b)(e).addinPlugin;n.setSelectedData(t),Object(g.a)(e,n.getContent())}};var O=n(141),j=function(e){return function(){Object(O.b)(m.a.closeMessage,m.a.addinCloseCompose,!Object(u.e)(e),{okText:m.a.closeButton,hideCancelButton:!1}).then(function(t){t==O.a.ok&&u.f.importAndExecute(e)})}},y=function(e){return function(){return e.conversationId}},C=n(2570),R=n(1567),P=n(1580),E=n(522),T=n(2102),w=n(2670),A=n(2110),x=function(e){return function(t){var n=k(e,t);return Object(E.a)(n)}},D=function(e){return function(t,n){B(e,t);var r=k(e,t);Object(w.a)(r),n.forEach(function(e){Object(T.a)(r,!0,{EmailAddress:e}),Object(A.a)(r,!1)})}},F=function(e){return function(t,n){B(e,t);var r=k(e,t);n.forEach(function(e){Object(T.a)(r,!0,{EmailAddress:e}),Object(A.a)(r,!1)})}};function B(e,t){switch(e.showCompactRecipientWell&&Object(P.a)(e),t){case r.d.To:return;case r.d.Cc:return void Object(R.a)(e);case r.d.Bcc:return void Object(C.a)(e)}}var k=function(e,t){var n;switch(t){case r.d.To:n=e.toRecipientWell;break;case r.d.Cc:n=e.ccRecipientWell;break;case r.d.Bcc:n=e.bccRecipientWell}return n},_=n(508),U=function(e){return function(){return Object(_.b)(e,!1,!0).then(function(){return Promise.resolve(e.itemId.Id)}).catch(function(){return Promise.resolve(null)})}},N=n(2571),L=n(2572),W=function(e){return function(){return e.subject}},V=function(e){return function(t){Object(N.a)(e,t)}};function q(e){return 5===e.lastFocusedControl}var H=function(e){return function(){return 7===e.lastFocusedControl?(n=e,function(){return 7!==n.lastFocusedControl?null:Object(b.b)(n).addinPlugin.getSelectedData()})():5===e.lastFocusedControl?(t=e,function(){if(!q(t))return null;var e=t.subjectViewState,n=e.selectionStart,r=e.selectionEnd,a=t.subject;return{data:a=a.slice(n,r),sourceProperty:"subject",startPosition:n,endPosition:r}})():null;var t,n}},z=function(e){return function(t){var n;7===e.lastFocusedControl?M(e)(t):5===e.lastFocusedControl&&(n=e,function(e){if(q(n)){var t=n.subject,r=n.subjectViewState,a=r.selectionStart,o=r.selectionEnd;t=t.slice(0,a)+e+t.slice(o),Object(N.a)(n,t);var i=a+e.length;Object(L.a)(n,i,i)}})(t)}},Q=n(170);function G(e){Object(Q.d)(Q.c.CalendarRead,e,Q.a.Addins)}var J=n(0),K=n(27);function $(e){return K.a.items.get(e)}var X=n(5),Z=n(48),Y=n(73),ee=n(54),te=n(126);function ne(e){return J.__awaiter(this,void 0,void 0,function(){var t,n;return J.__generator(this,function(r){switch(r.label){case 0:return(t=$(e))&&t.NormalizedBody?[3,2]:(n={Id:e,mailboxInfo:Object(Z.b)(Object(X.v)())},[4,Object(ee.k)(n,"LoadItemReadingPane")]);case 1:t=r.sent(),r.label=2;case 2:return t.IsDraft?[4,function(e){return J.__awaiter(this,void 0,void 0,function(){return J.__generator(this,function(t){switch(t.label){case 0:return Object(c.b)("rp-popouts")?[4,u.n.importAndExecute(e,u.a.Popout)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}(e)]:[3,4];case 3:return r.sent(),[3,6];case 4:return[4,function(e){return J.__awaiter(this,void 0,void 0,function(){var t,n,r,a;return J.__generator(this,function(o){switch(o.label){case 0:return Object(te.a)()?(t=Object(X.v)(),n=Object(Z.b)(t),0!==t.tableQuery.listViewType?[3,2]:(r=J.__assign({},e.ConversationId,{mailboxInfo:n}),[4,Y.k.importAndExecute(r,e.Subject,e.Categories,!1,null)])):[3,4];case 1:return o.sent(),[3,4];case 2:return 1!==t.tableQuery.listViewType?[3,4]:(a=J.__assign({},e.ItemId,{mailboxInfo:n}),[4,Y.k.importAndExecute(a,e.Subject,e.Categories,!1,null)]);case 3:o.sent(),o.label=4;case 4:return[2]}})})}(t)];case 5:r.sent(),r.label=6;case 6:return[2]}})})}var re=n(317),ae=function(e){return!!~Object(re.c)(re.a.SurfaceActions).composeSurfaceAddins.indexOf(e)},oe=function(e){return!!~Object(re.c)(re.a.SurfaceActions).readSurfaceAddins.indexOf(e)},ie=function(e){return function(){return e.itemId?e.itemId.Id:null}},se=function(e){return function(){return e.ItemId.Id}},ce=n(140),ue=n(335),de=n(2143),le=n.n(de);function me(e,t,n){return function(){var a=Object(r.j)(t);if(!a)return null;var o,i,s,c,u=(o=e,i=t,s=a,c=n,{text:le.a.dismissAddinsInfoBarLabel,action:function(){var e=s.ExtensionId,t=s.Persistent;r.z.import().then(function(n){n(i),t&&r.C.import().then(function(t){t(o,e)})}),c(i)}});return{key:a.Key,source:ue.c.Extensibility,rank:function(e){switch(e){case 0:case 1:return ue.b.Info;case 2:return ue.b.Error}return ue.b.Safety}(a.Type),messageParts:[a.Message,"|",u],color:ue.a.Grey}}}var pe=n(371),fe=function(e){return function(t){pe.a(e)(t,me(Object(r.i)(e.composeId),t,ge(e)))}},ge=function(e){return function(t){pe.c(e)([t])}},be=function(e){return function(){return pe.b(e)()}};function ve(e){return{getRecipients:x(e),setRecipients:D(e),addRecipients:F(e),getSubject:W(e),setSubject:V(e),getItemId:ie(e),getConversationId:y(e),getBody:v(e),setBody:h(e),getBodyType:I(e),prependBody:S(e),getSelectedData:H(e),setSelectedData:z(e),setBodySelectedData:M(e),mode:ce.a.MessageCompose,saveItem:U(e),addNotificationMessage:fe(e),removeNotificationMessage:ge(e),getNotificationMessageIds:be(e),close:j(e),displayMessageForm:ne,displayAppointmentForm:G,addItemAttachment:Object(p.b)(e),addFileAttachment:Object(p.a)(e),removeAttachment:Object(p.d)(e),isAddinPinned:ae,getFrom:f(e)}}var he=n(93);function Ie(e,t,n,r){if(Object(c.b)("rp-popouts")){var a=$(e),o=a?a.ConversationId.Id:null,i=s(r);u.r.importAndExecute({referenceItemId:{Id:e,mailboxInfo:Object(he.b)()},isReplyAll:t,useFullCompose:!0,actionSource:"AddIns",instrumentationContexts:[],conversationId:o,body:n,fullComposeTarget:u.a.Popout,attachmentFiles:i})}}function Se(e){var t=[];return e&&(t=e.map(function(e){return{Mailbox:e}})),t}var Me=n(2430),Oe=function(e,t,n,r,a,o,i,s){var c,u=Se(e),d=Se(t),l=n?new Date(n):null,m=r?new Date(r):null;if(a){var p=Object(Me.c)(a);c=Object(Me.b)(p)[0]}var f=o?o.map(function(e){return{Mailbox:{EmailAddress:e}}}):null,g={RequiredAttendees:u||[],OptionalAttendees:d||[],Locations:c?[c]:[],Resources:f||[],Subject:i,Body:{Value:s}};g.Start=l||new Date,r&&(g.End=m),Object(Q.k)(Q.b.CalendarComposePopoutEvent,g),Object(Q.d)(Q.c.CalendarCompose,null,Q.a.Addins)},je=n(2625),ye=function(e){return function(t){je.a(e)(t,me(Object(r.k)(e.itemId),t,Ce(e)))}},Ce=function(e){return function(t){je.c(e)(t)}},Re=function(e){return function(){return je.b(e)()}},Pe=function(e){return function(){return e}},Ee=function(e){return function(){return!e.isConversationItemPart||e.isSelected}},Te=function(e,t){return function(){var n=e.isConversationItemPart&&t.ConversationId?t.ConversationId.Id:null;return!!Object(u.c)(n)}};function we(e,t){return{getItem:Pe(e),getItemId:se(e),addNotificationMessage:ye(t),removeNotificationMessage:Ce(t),getNotificationMessageIds:Re(t),mode:ce.a.MessageRead,displayMessageForm:ne,displayNewMessageForm:d,displayNewAppointmentForm:Oe,displayReplyForm:Ie,displayAppointmentForm:G,isAddinPinned:oe,isItemSelected:Ee(t),isInlineComposeOpen:Te(t,e)}}var Ae=n(320);function xe(e){if(!e)return!1;if(null!=e.RightsManagementLicenseData)return!1;if(e.IsDraft)return!1;if(Object(Ae.c)()&&e.MailboxInfo&&e.MailboxInfo.type===he.a.GroupMailbox)return!1;var t,n=e.ItemClass.toLowerCase();return(0!=(t=n).indexOf("ipm.note.smime")||-1!=t.indexOf("ipm.note.smime.multipartsigned"))&&0!=n.indexOf("report")}var De=n(279);function Fe(e){De.c.import().then(function(t){t().then(e)})}var Be={PinRequest:{datapoint:{name:"ExtPinRequest",customData:function(e,t){return[e,t]}}},PersistedAddinMigration:{datapoint:{name:"ExtPersistedAddinMigration",customData:function(e){return[e]}}}},ke=n(81),_e=n(104),Ue=n(9),Ne="ows/api/beta/Addins/PinAddins",Le=Be.PinRequest.datapoint;function We(){var e=Object(_e.getGuid)(),t=new Ue.c(Le.name);Object(ke.e)(Ne,{correlationId:e,defaults:Object(re.b)()[re.a.SurfaceActions]},e,!0).then(function(n){t.addCustomData(Le.customData(e,n.status)),200==n.status&&n.text().then(function(e){re.d.importAndExecute(re.a.SurfaceActions,JSON.parse(e))}),t.end()}).catch(function(){t.end()})}var Ve,qe,He,ze=n(6);(He=qe||(qe={}))[He.None=0]="None",He[He.Compose=1]="Compose",He[He.Read=2]="Read";var Qe=((Ve={})[qe.None]="NoAddins",Ve[qe.Compose]="ComposeAddinOnly",Ve[qe.Read]="ReadAddinOnly",Ve[qe.Compose|qe.Read]="BothAddins",Ve);function Ge(e){var t=JSON.parse(e);return{addinId:t.id,commandId:t.controlId}}function Je(){return J.__awaiter(this,void 0,void 0,function(){var e,t,n,a,o,i,s,c,u,d;return J.__generator(this,function(l){switch(l.label){case 0:return e=Object(ze.a)().ViewStateConfiguration,[4,r.A.import()];case 1:return t=l.sent(),n=qe.None,(a=e.PinnedComposeAddin)&&(o=Ge(a),t(ce.a.MessageCompose,o),n|=qe.Compose),(i=e.PinnedReadAddin)&&(s=Ge(i),t(ce.a.MessageRead,s),n|=qe.Read),c=Be.PersistedAddinMigration.datapoint,u=c.name,d=c.customData,Object(Ue.n)(u,d(Qe[n])),[2]}})})}var Ke=n(670);function $e(e,t){return void 0===t&&(t=null),J.__awaiter(this,void 0,void 0,function(){return J.__generator(this,function(n){switch(n.label){case 0:return Object(c.b)("rp-addins")&&Object(Ke.b)("addin-persistentTaskPane")?[4,r.x.import()]:[3,2];case 1:n.sent()(e,t),n.label=2;case 2:return[2]}})})}var Xe=n(146);function Ze(){Object(Xe.e)()?$e(r.e.NotSupported):$e(r.e.Empty)}n.d(t,"d",function(){return et}),n.d(t,"a",function(){return ve}),n.d(t,"b",function(){return we}),n.d(t,"c",function(){return xe}),n.d(t,"g",function(){return Fe}),n.d(t,"e",function(){return We}),n.d(t,"f",function(){return Je}),n.d(t,"h",function(){return $e}),n.d(t,"i",function(){return Ze});var Ye=new a.c(function(){return Promise.all([n.e(0),n.e(9),n.e(14),n.e(26),n.e(96)]).then(n.bind(null,5584))}),et=new a.b(Ye,function(e){return e.hasInlineImage});r.f.sendFeedback=function(){d([{Name:m.a.sendFeedbackDialogTitle,EmailAddress:"outlookinclientstorefeedback@service.microsoft.com"}],[],[],m.a.sendFeedbackEmailSubject,m.a.sendFeedbackEmailContentStart,[])}},2449:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"a",function(){return p}),n.d(t,"d",function(){return g}),n.d(t,"c",function(){return b});var r=n(0),a=n(597),o=n(483),i=n(195),s=n(2450),c=n(2451),u=n(48),d=n(371);var l=function(e){return function(t,n,r){return Object(c.a)(e,t,n,r).catch(m)}};function m(e){throw e.messageId?function(e){switch(e){case"ErrorTooLargeForLocalAttachmentSingle":case"ErrorTooLargeForLocalAttachmentMultiple":return o.b.AttachmentSizeExceeded;default:return o.b.AttachmentUploadGeneralFailure}}(e.messageId):o.b.AttachmentUploadGeneralFailure}var p=function(e){return function(t,n,r){return Object(s.a)(e,t,n,r).catch(m)}};function f(e,t){var n=e.filter(function(e){return e.attachmentId.Id===t});return n.length>0?n[0]:null}var g=function(e){return function(t){return new Promise(function(n,a){i.f.import().then(function(i){try{var s=f(e.attachmentWell.docViewAttachments,t);if(s||(s=f(e.attachmentWell.imageViewAttachments,t)),s||(s=f(e.attachmentWell.inlineAttachments,t)),!s)return void a(new o.a(o.b.AttachmentToDeleteDoesNotExist));var c=r.__assign({},e.itemId,{mailboxInfo:Object(u.a)()});i(e.attachmentWell,s,c,Object(d.a)(e),Object(d.c)(e)),n()}catch(e){a(new o.a(o.b.AttachmentDeleteGeneralFailure))}})})}},b=function(e){return!(!e||0==e.length)&&e.some(function(e){return e.file.fileType==a.a.Uri&&e.isInline})}},2450:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(597),a=n(656),o=n(1545),i=n(371);function s(e,t,n,s){return new Promise(function(c,u){var d=!1,l=Object(i.a)(e);try{var m=Object(r.g)([{name:t,url:n}]),p=Object(a.b)(e).inlineImagePlugin,f="HTML"!=e.bodyType?null:p.processInlineImageBeforeUpload.bind(p);Object(o.a)(m,s,e,!1,!0,f,function(e,t){l(e,t),d||(d=!0,u({errorType:"UploadError",id:e}))},Object(i.c)(e),function(e){d||(d=!0,c(e.Id))})}catch(e){u({errorType:"UploadError"})}})}},2451:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(597),a=n(1545),o=n(371);function i(e,t,n,i){return new Promise(function(s,c){var u=!1,d=Object(o.a)(e),l=Object(r.f)([t],[n]);Object(a.a)(l,i,e,!1,!1,null,function(e,t){d(e,t),u||(u=!0,c({errorType:"UploadError",id:e}))},Object(o.c)(e),function(e){u||(u=!0,s(e.Id))})})}},2452:function(e,t,n){"use strict";var r=n(4),a=n(1455),o=Object(r.action)("removeInfoBarMessageInReadingPane")(function(e,t){Object(a.a)(e,t,e.itemId)});t.a=o},2499:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return s}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return d});var r=n(2669),a=n(6),o="OptInPrg";function i(){return c(2)}function s(){return c(1)}function c(e){return Object(r.a)(o)==""+e}function u(e){d(1);var t=Object(a.a)().SessionSettings.WebSessionType,n="/owa/",r=[];t&&r.push("isc="+t),e&&r.push(e),r.length>0&&(n=n+"?"+r.join("&")),location.assign(n)}function d(e){null==e?Object(r.b)(o):Object(r.b)(o,""+e,{path:"/"})}},2570:function(e,t,n){"use strict";var r=n(1186),a=n(4);t.a=Object(a.action)("showBccWell")(function(e){e.bccRecipientWell||(e.bccRecipientWell=Object(r.a)(e.findPeopleFeedbackManager,[]))})},2571:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("updateSubject")(function(e,t){e.subject=t,e.isDirty=!0})},2572:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("updateSubjectSelectionRange")(function(e,t,n){e.subjectViewState.selectionStart=t,e.subjectViewState.selectionEnd=n})},2625:function(e,t,n){"use strict";var r=n(4),a=n(1572),o=Object(r.action)("addInfoBarMessageInReadingPane")(function(e,t,n){Object(a.a)(e,t,e.itemId,n)}),i=n(2452);n.d(t,"a",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return u});var s=function(e){return function(t,n){o(e,t,n)}},c=function(e){return function(t){Object(i.a)(e,t)}},u=function(e){return function(){return e.infoBarIds}}},2669:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o});var r=n(681);function a(e){return r.get(e)}function o(e,t,n){t?r.set(e,t,n):r.remove(e)}},371:function(e,t,n){"use strict";var r=n(392),a=n(393);n.d(t,"a",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return s});var o=function(e){return function(t,n){Object(r.a)(e,t,n)}},i=function(e){return function(t){Object(a.a)(e,t)}},s=function(e){return function(){return e.infoBarIds}}},392:function(e,t,n){"use strict";var r=n(1572),a=n(4),o=Object(a.action)("addInfoBarMessageInCompose")(function(e,t,n){Object(r.a)(e,t,e.composeId,n)});t.a=o},393:function(e,t,n){"use strict";var r=n(1455),a=n(4),o=Object(a.action)("removeInfoBarMessageInCompose")(function(e,t){e.infoBarIds&&e.infoBarIds.length&&(t?(t=Array.isArray(t)?t:[t]).forEach(function(t){Object(r.a)(e,t,e.composeId)}):e.infoBarIds.forEach(function(t){Object(r.a)(e,t,e.composeId)}))});t.a=o},396:function(e,t,n){"use strict";var r=n(318);t.a={MailComposeReply:{datapoint:{name:"MailComposeReply",options:{isQos:!0},customData:function(e,t,n,r,a){return[a,t]}}},MailComposeReplyAll:{datapoint:{name:"MailComposeReplyAll",options:{isQos:!0},customData:function(e,t,n,r,a){return[a,t]}}},MailComposeForward:{datapoint:{name:"MailComposeForward",options:{isQos:!0},customData:function(e,t){return[t]}}},MailComposeSend:{datapoint:{name:"MailComposeSend",options:{isQos:!0},customData:function(e,t,n){return[e,t,null]}}},MailComposeSendAsync:{datapoint:{name:"MailComposeSendAsync",options:{isQos:!0}}},MailComposeSendE2E:{datapoint:{name:"MailComposeSendE2E",options:{isCore:!0},customData:function(e){return{composeTraceId:e.logTraceId,operation:e.operation,isGroupScenario:null!=e.groupId&&Object(r.c)(e)}}}},MailComposeSendRequestReadReceipt:{datapoint:{name:"MailComposeSendRequestReadReceipt"}},MailComposeSave:{datapoint:{name:"MailComposeSave"}},MailComposeUpConvert:{datapoint:{name:"MailComposeUpConvert"}},ComposeCommandDiscardCompose:{datapoint:{name:"ComposeCommandDiscardCompose",customData:function(e){return{composeTraceId:e.logTraceId,wasEmptyBody:e.initialContent===e.content,wasEmptySubject:""===e.subject}},options:{isCore:!0},cosmosOnlyData:function(e){return JSON.stringify({smartReplyExtractionId:e.smartReplyExtractionId})}}},ComposeCommandShowFrom:{datapoint:{name:"ComposeCommandShowFrom"}},ComposeCommandSetImportance:{datapoint:{name:"ComposeCommmandSetImportance",customData:function(e,t){return[t]}}},SmartReplySendMessage:{datapoint:{name:"SmartReplySendMessage",customData:function(e){return[e]}}},SmartReplySaveMessage:{datapoint:{name:"SmartReplySaveMessage",customData:function(e){return[e]}}},SmartReplyDiscardMessage:{datapoint:{name:"SmartReplyDiscardMessage",customData:function(e){return[e]}}},UpgradeCompose:{datapoint:{name:"UpgradeCompose"}},UpgradeComposeTimedOut:{datapoint:{name:"UpgradeComposeTimedOut"}},UpgradeComposeCompleted:{datapoint:{name:"UpgradeComposeCompleted",customData:function(e,t){return[e,t]}}}}},508:function(e,t,n){"use strict";n.d(t,"d",function(){return v}),n.d(t,"e",function(){return h}),n.d(t,"c",function(){return I}),n.d(t,"a",function(){return S});var r=n(0),a=n(392),o=n(393),i=n(396),s=n(1558),c=n(1403),u=n(318),d=n(888),l=n(887),m=n(6),p=n(4),f=n(1392),g={};function b(e){var t=g[e.composeId];return t||(t={activeSaveAction:null,hasPendingSaveAction:!1},g[e.composeId]=t),t}function v(e,t){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return(n=b(e)).activeSaveAction=t,[4,t.then(function(e){return n.activeSaveAction=null,Promise.resolve(e)}).catch(function(e){return n.activeSaveAction=null,Promise.reject(e)})];case 1:return r.sent(),[2]}})})}function h(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return(t=g[e.composeId])&&t.activeSaveAction?[4,t.activeSaveAction]:[3,2];case 1:return n.sent(),[2,Promise.resolve(!0)];case 2:return[2,Promise.resolve(!1)]}})})}function I(e){var t=g[e.composeId];return t&&!!t.activeSaveAction}function S(e){g[e.composeId]&&delete g[e.composeId]}t.b=Object(p.action)("trySaveMessage",i.a.MailComposeSave)(function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(i){switch(i.label){case 0:return e?e.isSending?[2,Promise.resolve()]:(t||Object(o.a)(e,s.a),p=e,Object(u.a)(p)<=Object(m.a)().MaxRecipientsPerMessage?[4,function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return(t=b(e)).activeSaveAction?[3,1]:[2,Promise.resolve(!0)];case 1:return t.hasPendingSaveAction?[4,t.activeSaveAction]:[3,3];case 2:return n.sent(),[2,Promise.resolve(!1)];case 3:return t.hasPendingSaveAction=!0,[4,t.activeSaveAction];case 4:return n.sent(),t.hasPendingSaveAction=!1,[2,Promise.resolve(!0)]}})})}(e)]:(t||Object(a.a)(e,"warningMessageMaxRecipientsExceed"),[2,Promise.resolve()])):[2,Promise.reject("could not save message if view state does not exist")];case 1:return i.sent()?[2,v(e,Object(c.d)(e).then(function(n){return Object(c.c)(n,e),Object(d.a)()&&Object(l.a)(e,t?2:4),Object(f.a)(1,e.smartReplyExtractionId),Promise.resolve()}).catch(function(r){return t||Object(c.b)(r,e,!1),n?Promise.reject(r):Promise.resolve()}))]:[2,Promise.resolve()]}var p})})})},656:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o}),n.d(t,"d",function(){return i}),n.d(t,"c",function(){return s});var r={};function a(e,t){r[e.composeId]=t}function o(e){return r[e.composeId]}function i(e){var t=o(e);t&&t.contentOperationPlugin&&t.contentOperationPlugin.stopSaveOnDispose(),delete r[e.composeId]}function s(e){var t=[e.dockingPlugin,e.ribbonPlugin,e.inlineImagePlugin,e.inlineImageResizePlugin,e.contentOperationPlugin,e.tableEdit];function n(e){e&&t.push(e)}return n(e.emojiPlugin),n(e.smartSuggestionsPlugin),n(e.linkPreviewPlugin),n(e.atMentionsPlugin),n(e.addinPlugin),n(e.accCheckerPlugin),n(e.pasteOptionPlugin),n(e.linkPlugin),n(e.editorPickerPlugin),n(e.cortanaComposePlugin),n(e.emojiPickerPlugin),t}},887:function(e,t,n){"use strict";var r=n(392),a=n(1606),o=n.n(a),i=n(1610),s=n.n(i),c=n(110),u=n(393),d=n(4),l=n(18),m=n(1187),p=n(1547),f=n(7),g=Object(d.action)("triggerPolicyTips")(function(e,t,n,r,a){var o=e.policyTipsViewState;if(!o.handlerDisabled&&!e.IRMData){var i,c,d,l=o.inProgressPolicyMatch,p=o.succeededPolicyMatch,f=o.pendingPolicyMatch;if(n||(n=h(e.subject)),r||(r=h(e.content)),a||(i=[],(c=e.attachmentWell).docViewAttachments.forEach(function(e){i.push(e.attachmentId)}),c.inlineAttachments.forEach(function(e){i.push(e.attachmentId)}),c.imageViewAttachments.forEach(function(e){i.push(e.attachmentId)}),a=i),o.isRequestInProgress)o.pendingRequests=!0,f.itemId=e.itemId,f.subjectChecksum=n,f.contentChecksum=r,f.eventTrigger=t,f.attachmentIds=a;else{if(o.pendingRequests=!1,l.itemId=e.itemId,l.subjectChecksum=n,l.contentChecksum=r,l.eventTrigger=t,l.attachmentIds=a,0==(d=l).subjectChecksum&&0==d.contentChecksum&&0==d.attachmentIds.length)return p.policyMatchDetails=[],p.subjectChecksum=0,p.contentChecksum=0,p.attachmentIds=[],void Object(u.a)(e,"dlpPolicyTips");(I(l,p)||function(e,t){if(e.attachmentIds.length!=t.attachmentIds.length)return!0;for(var n=0;n<e.attachmentIds.length;n++)if(null!=e.attachmentIds[n]&&null!=t.attachmentIds[n]&&e.attachmentIds[n].Id!=t.attachmentIds[n].Id)return!0;return!1}(l,p)||1==t)&&function(e){var t=e.policyTipsViewState,n=t.succeededPolicyMatch,r=t.inProgressPolicyMatch,a=e.itemId;if(a&&a.Id){var o={ItemId:a,ClientSupportsScanResultData:!0,ScanResultData:n.scanResultData,ScanResultMetadata:n.scanResultMetaData,BodyOrSubjectChanged:I(r,n),NeedToReclassify:!n.itemId,CustomizedStringsNeeded:!0,Recipients:Object(m.a)(e),EventTrigger:r.eventTrigger};e.policyTipsViewState.isRequestInProgress=!0,s()(o).then(function(t){!function(e,t,n,r){var a=t.policyTipsViewState,o=a.pendingPolicyMatch;a.isRequestInProgress=!1,a.pendingRequests&&o&&g(t,o.eventTrigger,o.subjectChecksum,o.contentChecksum,o.attachmentIds);0==e.EvaluationResult||1==e.OptimizationResult||2==e.EvaluationResult?n(t,e):r(t,e)}(t,e,b,v)})}}(e)}}});function b(e,t){var n,a=e.policyTipsViewState,i=a.succeededPolicyMatch,s=a.inProgressPolicyMatch;i.itemId=s.itemId,i.attachmentIds=s.attachmentIds,i.subjectChecksum=s.subjectChecksum,i.contentChecksum=s.contentChecksum,i.policyMatchDetails=t.Matches,t.ScanResultData&&(i.scanResultData=t.ScanResultData),t.ScanResultMetadata&&(i.scanResultMetaData=t.ScanResultMetadata),1==t.OptimizationResult&&(a.handlerDisabled=!0),function(e,t){if(t){var n=e.policyTipsViewState,r={complianceUrl:t.ComplianceURL,blockString:t.PolicyTipMessageBlockString,notifyString:t.PolicyTipMessageNotifyString,overrideString:t.PolicyTipMessageOverrideString};o()(n,r,function(e,t){return t||e})}}(e,t.CustomizedStrings),n=e,Object(u.a)(n,"dlpPolicyTips"),Object(p.a)(n.policyTipsViewState.succeededPolicyMatch)&&(Object(c.a)()?Object(r.a)(n,"consumerDlpPolicyTips"):Object(r.a)(n,"enterpriseDlpPolicyTips"))}function v(e,t){var n=e.policyTipsViewState;t?(f.c.warn(Object(l.format)("PolicyTips failed with EvaluationResult code of: {0}",t.EvaluationResult)+" Diagnostic: "+t.DiagnosticData),4!=t.EvaluationResult&&7!=t.EvaluationResult&&1!=t.EvaluationResult&&6!=t.EvaluationResult&&8!=t.EvaluationResult||(f.c.warn("Disabling further PolicyTips requests because of the failure"),n.handlerDisabled=!0)):(f.c.warn("PolicyTipsResponse is null (PolicyTipsRequest is timed out)"),n.handlerDisabled=!0),Object(u.a)(e,"dlpPolicyTips")}function h(e){var t=0;if(e)for(var n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}function I(e,t){return e.subjectChecksum!=t.subjectChecksum||e.contentChecksum!=t.contentChecksum}t.a=g},888:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(6),a=n(110),o=n(16);function i(){return Object(r.a)().PolicyTipsEnabled&&(Object(a.a)()||Object(o.b)("cmp-policyTips"))}},938:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"f",function(){return s}),n.d(t,"e",function(){return c});var r="onCloseInlineCompose",a="OnSuccessfulSendFromInlineCompose",o="UpdateInternetMessageId",i="closeCompose",s="openCompose",c="moveComposeToPopout"}},0,[6,7,25,34,57,0,3,4,9,52,2,75,218,225,232,79,76]]);
//# sourceMappingURL=owa.MailOptin.js.map
window.scriptsLoaded['owa.MailOptin.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.MailOptin.js'] = (new Date()).getTime();