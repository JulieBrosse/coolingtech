window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.vendors~Addins~addins-marketplace.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[26],{1235:function(e,t,n){"use strict";var r=n(0),i=n(1),a=n(381),o=n(630),s=n(1887),l=n(1446),c=n(219),u=n(7),d=i.version,p='<html dir="'+(Object(s.a)()?"rtl":"ltr")+'"><head></head><body style="min-width: 0;"></body></html>',f=!1,m=function(e){function t(t){var n=e.call(this,t)||this;return n.state={errored:!1},"undefined"==typeof window||f||(c.b.getInstance().setConfig({onInsertRule:l.insertPopoutStylesheetRule}),f=!0),n}return r.__extends(t,e),t.prototype.render=function(){if(0==d.indexOf("16")){var e=this.props,t=e.html,n=r.__rest(e,["html"]);return t||(t=p),i.createElement(o.a,{child:i.createElement(l.Popout,r.__assign({},r.__assign({html:t},n))),onError:h,ErrorComponent:a.a})}return u.c.error("OWA Popout render control triggered for React version <16.0.0"),null},t}(i.Component);function h(e,t){u.c.error({message:"Error launching popout: "+e.message,error:e,diagnosticInfo:t.componentStack})}var g=n(369);function v(){return(location?location.pathname:"").split("/").indexOf(g.c)>=0}n(55),n(883);n(1379),n(1441);n.d(t,"b",function(){return v});t.a=m},1242:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n(2),i=new r.c(function(){return Promise.all([n.e(0),n.e(152)]).then(n.bind(null,2020))}),a=new r.a(i,function(e){return e.mountAndShowFlexPane}),o=new r.a(i,function(e){return e.hideFlexPane})},1321:function(e,t,n){"use strict";n.d(t,"b",function(){return a});var r=n(355),i=n(4),a=Object(i.select)({store:function(){return r.a}})(Object(i.action)("setAppPaneUnderlayVisibility")(function(e,t,n,r){t?r.store.shrinkable.set(e,n):r.store.shrinkable.delete(e),r.store.isShown.set(e,t)}));t.a=a},1379:function(e,t,n){"use strict";var r=n(369),i=n(55),a=n(883),o=n(161);function s(e,t){if(t){var n=t.displayName?t.displayName+"<"+t.smtpAddress+">":t.smtpAddress;return e?"&"+e+"="+n:n}return""}function l(e,t){return t?"&"+e+"="+t:""}function c(e){if(!e.to||!e.to.smtpAddress)return"";var t=o.parse(Object(i.a)().search.substr(1));return t.mailtolink=function(e){if(!e.to||!e.to.smtpAddress)return"";var t="mailto:"+s(null,e.to),n="";return n+=s("cc",e.cc),n+=s("bcc",e.bcc),n+=l("subject",e.subject),(n+=l("body",e.body))?t+"?"+n.slice(1):t}(e),Object(a.a)(r.e,r.b,"?"+o.stringify(t))}n.d(t,"a",function(){return c})},1440:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.popouts={}},1441:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(369),i=n(55),a=n(883);function o(e){return e?Object(a.a)(r.e,r.f+"/"+encodeURIComponent(e),Object(i.a)().search):""}},1446:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1727);t.Popout=r.Popout;var i=n(1731);t.insertPopoutStylesheetRule=i.insertPopoutStylesheetRule},1539:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="__$$REACT_POPOUT_COMPONENT$$__";t.id=r,t.set=function(e,t){window[r]=window[r]||{},window[r][e]=t},t.get=function(e){return window[r]&&window[r][e]}},1727:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=n(40),s=n(1728),l=n(1440),c=n(1729),u=n(1539);n(1730);var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setupAttempts=0,t.openChildWindow=function(){var e=s.generateWindowFeaturesString(t.props.options||{}),n=t.props.name||Math.random().toString(12).slice(2);t.child=function(e){if(!e||e.closed||void 0===e||void 0===e.closed)return null;return e}(window.open(t.props.url||"about:blank",n,e)),t.child?(t.id="__"+n+"_container__",t.container=t.initializeChildWindow(t.id,t.child)):(t.props.onBlocked&&t.props.onBlocked(),t.container=null)},t.closeChildWindowIfOpened=function(){p(t.child)&&(t.child.close(),t.child=null,t.props.onClose&&t.props.onClose())},t}return i(t,e),t.prototype.setupOnCloseHandler=function(e,t){var n,r=this;if(!(this.setupAttempts>=5))if(t&&t.document&&t.document.head){var i=t.document.createElement("script"),a="\n            window.onbeforeunload = function(e) {\n                var result = window.opener."+u.id+".onBeforeUnload.call(window, '"+e+"', e);\n\n                if (result) {\n                    window.opener."+u.id+".startMonitor.call(window.opener, '"+e+"');\n\n                    e.returnValue = result;\n                    return result;\n                } else {\n                    window.opener."+u.id+".onChildClose.call(window.opener, '"+e+"');\n                }\n            }";i.innerHTML="\n            window.onload = function(e) {\n                "+a+"\n            };\n            ",n="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent:"",(/Edge/.test(n)||/Trident/.test(n)||!this.props.url)&&(i.innerHTML=a),t.document.head.appendChild(i),this.setupCleanupCallbacks()}else this.setupAttempts++,setTimeout(function(){return r.setupOnCloseHandler(e,t)},50)},t.prototype.setupCleanupCallbacks=function(){var e=this;window.addEventListener("unload",function(t){return e.closeChildWindowIfOpened()}),u.set("onChildClose",function(e){l.popouts[e].props.onClose&&l.popouts[e].props.onClose()}),u.set("onBeforeUnload",function(e,t){if(l.popouts[e].props.onBeforeUnload)return l.popouts[e].props.onBeforeUnload(t)})},t.prototype.setupStyleElement=function(e){this.styleElement=e.document.createElement("style"),this.styleElement.setAttribute("data-this-styles","true"),this.styleElement.type="text/css",e.document.head.appendChild(this.styleElement)},t.prototype.injectHtml=function(e,t){var n;if(this.props.html){t.document.write(this.props.html);for(var r=t.document.head,i="",a=null,o=window.document.styleSheets.length-1;o>=0;o--){var s=window.document.styleSheets[o];try{a=s.cssRules}catch(e){var l=t.document.createElement("link");l.type=s.type,l.rel="stylesheet",l.href=s.href,r.appendChild(l)}finally{if(a)for(var c=0;c<a.length;c++)try{i+=a[c].cssText}catch(e){}}a=null}var u=t.document.createElement("style");u.innerHTML=i,r.appendChild(u),(n=t.document.createElement("div")).id=e,t.document.body.appendChild(n)}else{var d="<!DOCTYPE html><html><head>";for(o=window.document.styleSheets.length-1;o>=0;o--){s=window.document.styleSheets[o];try{d+="<style>"+(i=s.cssText)+"</style>"}catch(e){}}d+='</head><body><div id="'+e+'"></div></body></html>',t.document.write(d),n=t.document.getElementById(e)}return this.setupStyleElement(t),n},t.prototype.setupStyleObserver=function(e){new MutationObserver(function(t){t.forEach(function(t){"childList"==t.type&&function(e,t,n){for(var r,i=0;i<e.length;i++)"STYLE"==(r=e[i]).tagName&&t.call(n,r,i)}(t.addedNodes,function(t){e.document.head.appendChild(c.crossBrowserCloneNode(t,e.document))})})}).observe(document.head,{childList:!0})},t.prototype.initializeChildWindow=function(e,t){if(l.popouts[e]=this,this.props.url)return this.setupOnCloseHandler(e,t),null;var n=this.injectHtml(e,t);return this.setupStyleObserver(t),this.setupOnCloseHandler(e,t),n},t.prototype.renderChildWindow=function(){!function(e){if(!e)return;var t=document.createElement("a");t.href=e;var n=window.location;if(t.hostname&&n.hostname!=t.hostname||t.protocol&&n.protocol!=t.protocol)throw new Error("react-popup-component error: cross origin URLs are not supported (window="+n.protocol+"//"+n.hostname+"; popout="+t.protocol+"//"+t.hostname+")")}(this.props.url),this.props.hidden?this.closeChildWindowIfOpened():(p(this.child)||this.openChildWindow(),!this.props.url&&this.container&&o.render(this.props.children,this.container))},t.prototype.componentDidUpdate=function(){this.renderChildWindow()},t.prototype.componentDidMount=function(){this.renderChildWindow()},t.prototype.componentWillUnmount=function(){this.closeChildWindowIfOpened()},t.prototype.render=function(){return null},t}(a.Component);function p(e){return e&&!e.closed}t.Popout=d},1728:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(t,"__esModule",{value:!0}),t.generateWindowFeaturesString=function(e){var t={left:0,top:0,height:600,width:800,location:!1,menubar:!1,resizable:!1,scrollbars:!1,status:!1,toolbar:!1};return t=r({},t,e),Object.getOwnPropertyNames(t).map(function(e){return e+"="+("boolean"==typeof(n=t[e])?n?"1":"0":n?String(n):void 0);var n}).join(",")}},1729:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.crossBrowserCloneNode=function(e,t){var n=t.createElement(e.tagName);if(n.innerHTML=e.innerHTML,e.hasAttributes())for(var r=void 0,i=0;i<e.attributes.length;i++)r=e.attributes[i],n.setAttribute(r.name,r.value);return n}},1730:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1440),i={},a=250;n(1539).set("startMonitor",function(e){var t=function(){var n;r.popouts[e]&&r.popouts[e].props.onClose&&(!r.popouts[e].child||r.popouts[e].child.closed?(i[n=e]&&(clearTimeout(i[n]),delete i[n]),r.popouts[e].props.onClose(),r.popouts[e].child=null):i[e]=setTimeout(t,a))};i[e]=setTimeout(t,a)})},1731:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1440);t.insertPopoutStylesheetRule=function(e){Object.keys(r.popouts).forEach(function(t){var n=r.popouts[t];if(n.child&&n.styleElement)try{var i=n.styleElement.sheet;i.insertRule(e,i.cssRules.length)}catch(e){}})}},2048:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return l});var r,i=n(41),a=i.AnimationVariables.durationValue2,o={root:{selectors:(r={},r[i.HighContrastSelector]={opacity:0},r)}},s={root:"ms-Modal",main:"ms-Dialog-main",isOpen:"is-open"},l=function(e){var t=e.className,n=e.containerClassName,r=e.isOpen,o=e.isVisible,l=e.theme,c=l.palette,u=Object(i.getGlobalClassNames)(s,l);return{root:[u.root,{backgroundColor:"transparent",position:"fixed",height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,pointerEvents:"none",transition:"opacity "+a},r&&u.isOpen,o&&{opacity:1,pointerEvents:"auto"},t],main:[u.main,{boxShadow:"0 0 5px 0 rgba(0, 0, 0, 0.4)",backgroundColor:c.white,boxSizing:"border-box",position:"relative",textAlign:"left",outline:"3px solid tranparent",maxHeight:"100%",overflowY:"auto"},n]}}},2060:function(e,t,n){"use strict";n.d(t,"a",function(){return v});var r=n(0),i=n(1),a=n(1843),o=n(1844),s=n(1663),l=n(563),c=n(1825),u=n(402),d=n(2048),p=n(537),f=n(1888),m=n(1911),h=n(514),g=Object(a.a)(),v=function(e){function t(t){var n=e.call(this,t)||this;return n._focusTrapZone=Object(o.a)(),n._allowScrollOnModal=function(e){e?Object(s.b)(e,n._events):n._events.off(n._scrollableContent),n._scrollableContent=e},n.state={id:Object(l.c)("Modal"),isOpen:t.isOpen,isVisible:t.isOpen},n}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){clearTimeout(this._onModalCloseTimer),e.isOpen&&(this.state.isOpen?this.setState({isVisible:!0}):this.setState({isOpen:!0})),!e.isOpen&&this.state.isOpen&&(this._onModalCloseTimer=this._async.setTimeout(this._onModalClose,1e3*parseFloat(d.a)),this.setState({isVisible:!1}))},t.prototype.componentDidUpdate=function(e,t){e.isOpen||t.isVisible||this.setState({isVisible:!0})},t.prototype.render=function(){var e=this.props,t=e.className,n=e.containerClassName,r=e.elementToFocusOnDismiss,a=e.firstFocusableSelector,o=e.forceFocusInsideTrap,s=e.ignoreExternalFocusing,l=e.isBlocking,c=e.isClickableOutsideFocusTrap,v=e.isDarkOverlay,y=e.onDismiss,_=e.onLayerDidMount,C=e.responsiveMode,S=e.titleAriaId,A=e.styles,b=e.subtitleAriaId,I=e.theme,O=this.state,x=O.isOpen,E=O.isVisible;if(!x)return null;var T=g(A,{theme:I,className:t,containerClassName:n,isOpen:x,isVisible:E});return C>=h.a.small?i.createElement(f.a,{onLayerDidMount:_},i.createElement(m.a,{role:l?"alertdialog":"dialog",ariaLabelledBy:S,ariaDescribedBy:b,onDismiss:y},i.createElement("div",{className:T.root},i.createElement(p.a,{isDarkThemed:v,onClick:l?void 0:y,styles:d.b}),i.createElement(u.a,{componentRef:this._focusTrapZone,className:T.main,elementToFocusOnDismiss:r,isClickableOutsideFocusTrap:c||!l,ignoreExternalFocusing:s,forceFocusInsideTrap:o,firstFocusableSelector:a},i.createElement("div",{ref:this._allowScrollOnModal},this.props.children))))):null},t.prototype.focus=function(){this._focusTrapZone.current&&this._focusTrapZone.current.focus()},t.prototype._onModalClose=function(){this.setState({isOpen:!1}),this.props.onDismissed&&this.props.onDismissed()},t.defaultProps={isOpen:!1,isDarkOverlay:!0,isBlocking:!1,className:"",containerClassName:""},t=r.__decorate([h.b],t)}(c.a)},2069:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return s});var r={};function i(e,t){s(e)&&a(e),r[e]=t}function a(e){delete r[e]}function o(e){return r[e]}function s(e){return!!r[e]}},2073:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(0),i=n(1),a=n(1843),o=n(1825),s=Object(a.a)(),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,r=e.theme;return this._classNames=s(n,{theme:r,className:t}),i.createElement("div",{className:this._classNames.actions},i.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},t.prototype._renderChildrenAsActions=function(){var e=this;return i.Children.map(this.props.children,function(t){return t?i.createElement("span",{className:e._classNames.action},t):null})},t}(o.a)},2081:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n(0),i=n(1),a=n(1843),o=n(563),s=n(1825),l=n(94),c=n(401),u=n(514),d=n(2083),p=Object(a.a)(),f={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:""},m={type:l.a.normal,className:"",topButtonsProps:[]},h=function(e){function t(t){var n=e.call(this,t)||this;return n._getSubTextId=function(){var e=n.props,t=e.ariaDescribedById,r=e.modalProps,i=e.dialogContentProps,a=e.subText,o=t||r&&r.subtitleAriaId;return o||(o=(a||i&&i.subText)&&n._defaultSubTextId),o},n._getTitleTextId=function(){var e=n.props,t=e.ariaLabelledById,r=e.modalProps,i=e.dialogContentProps,a=e.title,o=t||r&&r.titleAriaId;return o||(o=(a||i&&i.title)&&n._defaultTitleTextId),o},n._id=Object(o.c)("Dialog"),n._defaultTitleTextId=n._id+"-title",n._defaultSubTextId=n._id+"-subText",n._warnDeprecations({isOpen:"hidden",type:"dialogContentProps.type",subText:"dialogContentProps.subText",contentClassName:"dialogContentProps.className",topButtonsProps:"dialogContentProps.topButtonsProps",className:"modalProps.className",isDarkOverlay:"modalProps.isDarkOverlay",isBlocking:"modalProps.isBlocking",containerClassName:"modalProps.containerClassName",onDismissed:"modalProps.onDismissed",onLayerDidMount:"modalProps.onLayerDidMount",ariaDescribedById:"modalProps.subtitleAriaId",ariaLabelledById:"modalProps.titleAriaId"}),n}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.containerClassName,a=e.contentClassName,o=e.elementToFocusOnDismiss,s=e.firstFocusableSelector,l=e.forceFocusInsideTrap,u=e.styles,h=e.hidden,g=e.ignoreExternalFocusing,v=e.isBlocking,y=e.isClickableOutsideFocusTrap,_=e.isDarkOverlay,C=e.isOpen,S=e.onDismiss,A=e.onDismissed,b=e.onLayerDidMount,I=e.responsiveMode,O=e.subText,x=e.theme,E=e.title,T=e.topButtonsProps,M=e.type,k=r.__assign({},f,this.props.modalProps),P=r.__assign({},m,this.props.dialogContentProps),N=p(u,{theme:x,className:t||k.className,containerClassName:n||k.containerClassName,hidden:h});return i.createElement(c.a,r.__assign({elementToFocusOnDismiss:o,firstFocusableSelector:s,forceFocusInsideTrap:l,ignoreExternalFocusing:g,isClickableOutsideFocusTrap:y,onDismissed:A,onLayerDidMount:b,responsiveMode:I},k,{isDarkOverlay:void 0!==_?_:k.isDarkOverlay,isBlocking:void 0!==v?v:k.isBlocking,isOpen:void 0!==C?C:!h,className:N.root,containerClassName:N.main,onDismiss:S||k.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),i.createElement(d.a,r.__assign({titleId:this._defaultTitleTextId,subTextId:this._defaultSubTextId,title:E,subText:O,showCloseButton:void 0!==v?!v:!k.isBlocking,topButtonsProps:T||P.topButtonsProps,type:void 0!==M?M:P.type,onDismiss:S||P.onDismiss,className:a||P.className},P),this.props.children))},t.defaultProps={hidden:!0},t=r.__decorate([u.b],t)}(s.a)},2082:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(0),i=n(1),a=n(1843),o=n(1825),s=n(94),l=n(524),c=n(220),u=n(514),d=Object(a.a)(),p=function(e){function t(t){return e.call(this,t)||this}return r.__extends(t,e),t.prototype.render=function(){var e,t=this.props,n=t.showCloseButton,a=t.className,o=t.closeButtonAriaLabel,c=t.onDismiss,u=t.subTextId,p=t.subText,f=t.titleId,m=t.title,h=t.type,g=t.styles,v=t.theme,y=d(g,{theme:v,className:a,isLargeHeader:h===s.a.largeHeader,isClose:h===s.a.close}),_=this._groupChildren();return p&&(e=i.createElement("p",{className:y.subText,id:u},p)),i.createElement("div",{className:y.content},i.createElement("div",{className:y.header},i.createElement("p",{className:y.title,id:f,role:"heading","aria-level":2},m),i.createElement("div",{className:y.topButton},this.props.topButtonsProps.map(function(e,t){return i.createElement(l.IconButton,r.__assign({key:e.uniqueId||t},e))}),(h===s.a.close||n&&h!==s.a.largeHeader)&&i.createElement(l.IconButton,{className:y.button,iconProps:{iconName:"Cancel"},ariaLabel:o,onClick:c}))),i.createElement("div",{className:y.inner},i.createElement("div",{className:y.innerContent},e,_.contents),_.footers))},t.prototype._groupChildren=function(){var e={footers:[],contents:[]};return i.Children.map(this.props.children,function(t){"object"==typeof t&&null!==t&&t.type===c.a?e.footers.push(t):e.contents.push(t)}),e},t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},t=r.__decorate([u.b],t)}(o.a)},2083:function(e,t,n){"use strict";var r=n(1842),i=n(2082),a=n(41),o={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"};n.d(t,"a",function(){return s});var s=Object(r.a)(i.a,function(e){var t=e.className,n=e.theme,r=e.isLargeHeader,i=e.isClose,s=e.hidden,l=e.isMultiline,c=n.palette,u=n.fonts,d=Object(a.getGlobalClassNames)(o,n);return{content:[r&&d.contentLgHeader,i&&d.close,{flexGrow:1,overflowY:"auto"},t],subText:[d.subText,r?u.medium:u.small,{margin:"0 0 20px 0",paddingTop:"8px",color:c.neutralPrimary,lineHeight:"1.5",wordWrap:"break-word",fontWeight:a.FontWeights.semilight}],header:[d.header,{position:"relative",width:"100%",boxSizing:"border-box"},r&&[d.headerLg,{backgroundColor:c.themePrimary}],i&&d.close],button:[d.button,s&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:c.neutralSecondary,fontSize:"16px"}}}],inner:[d.inner,{padding:l?"0 20px 20px":"0 28px 20px"}],innerContent:[d.content,{position:"relative",width:"100%",selectors:{".ms-Button.ms-Button--compount":{marginBottom:"20px",selectors:{"&:last-child":{marginBottom:"0"}}}}},t],title:[d.title,{color:c.neutralPrimary,margin:"0",padding:"20px 36px 20px 28px"},u.xLarge,r&&[{color:c.white,marginBottom:"8px",padding:"26px 28px 28px"},u.xxLarge],l&&u.xxLarge],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"12px 12px 0 0",selectors:{"> *":{flex:"0 0 auto"}}}]}},void 0,{scope:"DialogContent"})},2143:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),i=["appBuyButtonLabel","appErrorCode1_0","appErrorCode1_1","appErrorCode1_2","appErrorCode2_0","appErrorCode2_1","appErrorCode3_0","appErrorCode3_1","appErrorCode3_2","appErrorCode3_3","appErrorCodeDetailsAction","appErrorCodeUpdateAction","appErrorTitle","appInfoTitle","appTrialMessage","asyncMethodNotExecutedBecauseAsyncLimitIsExceededError","cancelButtonLabel","cantLoadAddinsRightNowError","closeAppPaneButtonLabel","closeLowerCase","composeAppsForOutlookLabel","dismissAddinsInfoBarLabel","extensionContainerAriaLabel","iFrameableDialogCloseButtonAccessibilityLabel","officeAddinsAutomaticProgressNotificationLabel","officeAddinsNotificationGenericError","oPayAddinName","overflowMenuAccessibilityLabel","overflowMenuHeaderAddins","overflowMenuFooterStoreLabel","overflowMenuTooltip","restrictedItemDialogHeader","restrictedItemDialogLabel","taskPanePinButtonLabel","taskPaneUnpinButtonLabel","taskPaneCloseButtonAriaLabel","taskPaneErrorAddinsNotSupported","taskPaneErrorAddinsNotSupportedDescription","taskPaneErrorMultipleItemsSelected","taskPaneErrorMultipleItemsSelectedDescription","taskPaneErrorNoItemSelected","taskPaneErrorNoItemSelectedDescription","ssoConsentPermissionTitleText","ssoSignInButtonText","ssoSignInCloseButtonText","ssoSignInLabelText","gdprMinorWarningText","gdprMinorRemoveAddinText","gdprMinorDialogTitleText","gdprMinorDialogOKButtonText","itemSendEventAddinErrorExtensibilityUnavailable","itemSendEventAddinBlockEvent"];t.OwaExtensibilityStringsStringModule=r.registerStringPackage("owa-extensibility-strings",null,i);var a={};i.forEach(function(e){Object.defineProperty(a,e,{get:function(){return t.OwaExtensibilityStringsStringModule.strings.get(e)}})}),t.getOwaExtensibilityStrings=function(){return a},t.default=a},2145:function(e,t,n){"use strict";n.d(t,"a",function(){return m}),n.d(t,"c",function(){return h}),n.d(t,"b",function(){return g});var r=n(176),i=n(138),a=n(158),o="resources/images/surfaceActions",s=o+"/attach.svg",l=o+"/attachDark.svg",c=o+"/inlineimage.svg",u=o+"/inlineimageDark.svg",d=o+"/emoji.svg",p=o+"/showribbon.svg",f=o+"/showribbonDark.svg";function m(e){var t,n,o=!1;switch(e){case"AddAttachment":t=Object(i.resolve)(Object(r.a)(),Object(a.c)()?l:s),n=Object(i.resolve)(Object(r.a)(),s),o=!0;break;case"AddInlineImage":t=Object(i.resolve)(Object(r.a)(),Object(a.c)()?u:c),n=Object(i.resolve)(Object(r.a)(),c),o=!0;break;case"AddEmoji":t=Object(i.resolve)(Object(r.a)(),d),o=!0;break;case"ToggleRibbon":t=Object(i.resolve)(Object(r.a)(),Object(a.c)()?f:p),n=Object(i.resolve)(Object(r.a)(),p),o=!0;break;case"ProtectMessage":t="Encryption";break;case"SaveDraft":t="Save";break;case"InsertSignature":t="InsertSignatureLine";break;case"ShowFrom":t="ArrangeByFrom";break;case"SetImportance":t="Important";break;case"ShowMessageOptions":case"SwitchBodyType":case"AccChecker":t="OutlookLogo";break;default:t=""}return{iconName:t,fallbackIconName:n||t,isImage:o}}function h(e){var t;switch(e){case"-":t="-";break;case"Reply":t="Reply";break;case"ReplyAll":t="ReplyAll";break;case"Forward":t="Forward";break;case"ReplyByMeeting":t="Calendar";break;case"Delete":t="Delete";break;case"MarkReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"MarkJunkNotJunk":t="MailAlert";break;case"MarkAsPhishing":t="Phishing";break;case"Block":t="BlockContact";break;case"CreateRule":t="CreateMailRule";break;case"Print":t="Print";break;case"Translate":t="LocaleLanguage";break;case"ShowInImmersiveReader":t="ReadOutLoud";break;case"ViewMessageSource":t="OpenSource";break;case"Popout":t="OpenInNewWindow";break;case"LikeUnlike":t="Like";break;case"ToggleDarkMode":t="Sunny";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}function g(e){var t;switch(e){case"-":t="-";break;case"Delete":t="Delete";break;case"Archive":t="Archive";break;case"PinUnpin":t="Pinned";break;case"ReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"Move":t="FabricFolder";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}},2150:function(e,t,n){"use strict";var r,i,a=n(0);(i=r||(r={}))[i.Message=1]="Message",i[i.Appointment=2]="Appointment",i[i.MeetingRequest=3]="MeetingRequest",i[i.MessageCompose=4]="MessageCompose",i[i.AppointmentCompose=5]="AppointmentCompose";var o=r;var s=n(810),l=n.n(s),c=n(811),u=n.n(c),d=n(152),p=n.n(d),f=n(30),m="Success";function h(e,t,n){var r=e.map(function(e){return p()({Id:e})});return l()({Header:Object(f.getJsonRequestHeader)(),Body:u()({ItemShape:t,ItemIds:r,ShapeName:n})}).then(function(e){return function(e){if(e.ResponseClass==m){var t=e;return t.Items[0]}return{}}(e.Body.ResponseMessages.Items[0])})}var g=n(177),v=n.n(g),y=n(29),_=n.n(y);function C(e){return h([e.ItemId.Id],v()({BaseShape:"IdOnly",AdditionalProperties:[_()({FieldURI:"EntityExtractionResult"})]}),null)}function S(e,t,n){return e&&e.match(function(e,t){var n,r="g";t&&(r="ig");try{n=new RegExp(e,r)}catch(e){return null}return n}(t,n))}var A=n(20),b=n(484);function I(e,t,n){if(!e)return{};var r,i={Addresses:e.Addresses?e.Addresses.map(function(e){return e.Address}):[],Urls:e.Urls?e.Urls.map(function(e){return e.Url}):[],PhoneNumbers:e.PhoneNumbers?e.PhoneNumbers:[]};return i.IsLegacyExtraction=!((r=t).EntityDocument||r.PropertyExistence&&r.PropertyExistence.TextEntityExtractions),0!=n.extension.RequestedCapabilities&&(i.Contacts=e.Contacts?e.Contacts:[],i.EmailAddresses=e.EmailAddresses?e.EmailAddresses.map(function(e){return e.EmailAddress}):[],i.MeetingSuggestions=e.MeetingSuggestions?e.MeetingSuggestions.map(function(e){var t=this.IsLegacyExtraction,n=Object(A.toJS)(b({},e));return n.EndTime=t?x(n.EndTime):new Date(n.EndTime).getTime(),n.StartTime=t?x(n.StartTime):new Date(n.StartTime).getTime(),n}.bind(i)):[],i.TaskSuggestions=e.TaskSuggestions?e.TaskSuggestions:[]),i}function O(e,t){var n,r;try{for(var i=a.__values(t),o=i.next();!o.done;o=i.next()){var s=S(e,o.value,!0);if(s&&s.length>0)return!0}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!1}function x(e){var t=new Date(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),n.getTime()}var E=n(664);function T(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var i,o,s;return a.__generator(this,function(a){switch(a.label){case 0:if(t.EntityExtractionResult||(!(d=t).PropertyExistence||!(d.PropertyExistence.ExtractedAddresses||d.PropertyExistence.ExtractedContacts||d.PropertyExistence.ExtractedEmails||d.PropertyExistence.ExtractedMeetings||d.PropertyExistence.ExtractedPhones||d.PropertyExistence.ExtractedTasks||d.PropertyExistence.ExtractedUrls)))return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,C(t)];case 2:return i=a.sent(),Object(E.W)(t,i.EntityExtractionResult),[3,4];case 3:return a.sent(),[3,4];case 4:return t.EntityExtractionResult&&(r.entities=I(t.EntityExtractionResult,t,n),r.entities&&(o=JSON.parse(JSON.stringify(r.entities)),r.selectedEntities=(l=o,c=Object(E.n)().contextualCalloutState.selectedTerms,u={},l&&c&&(l.Addresses&&(u.Addresses=l.Addresses.filter(function(e){return O(e,c)})),l.MeetingSuggestions&&(u.MeetingSuggestions=l.MeetingSuggestions.filter(function(e){return O(e.MeetingString,c)})),l.TaskSuggestions&&(u.TaskSuggestions=l.TaskSuggestions.filter(function(e){return O(e.TaskString,c)})),l.PhoneNumbers&&(u.PhoneNumbers=l.PhoneNumbers.filter(function(e){return O(e.OriginalPhoneString,c)})),l.Urls&&(u.Urls=l.Urls.filter(function(e){return O(e,c)})),l.Contacts&&(u.Contacts=l.Contacts.filter(function(e){return O(e.ContactString,c)})),l.EmailAddresses&&(u.EmailAddresses=l.EmailAddresses.filter(function(e){return O(e,c)}))),u))),(s=function(e,t){var n=Object(E.q)(e);if(n&&n.contextualEvaluationResults&&n.contextualEvaluationResults.has(t))return n.contextualEvaluationResults.get(t);return null}(e,n.extension.Id))&&(r.filteredEntities=s.filteredEntityMatches,r.regExMatches=s.regExMatches),[2,r]}var l,c,u,d})})}var M,k,P,N,R=n(1225);(k=M||(M={}))[k.Other=0]="Other",k[k.DistributionList=1]="DistributionList",k[k.User=2]="User",k[k.ExternalUser=3]="ExternalUser",(N=P||(P={}))[N.Unknown=0]="Unknown",N[N.Organizer=1]="Organizer",N[N.Tentative=2]="Tentative",N[N.Accept=3]="Accept",N[N.Decline=4]="Decline",N[N.NoResponseReceived=5]="NoResponseReceived";var D=function(e){return{address:e.EmailAddress,name:e.Name,recipientType:U(e.MailboxType)}},w=function(e){var t=D(e.Mailbox);return t.appointmentResponse=function(e){switch(e){case"Organizer":return P.Organizer;case"Tentative":return P.Tentative;case"Accept":return P.Accept;case"Decline":return P.Decline;case"NoResponseReceived":return P.NoResponseReceived;default:return P.Unknown}}(e.ResponseType),t},F=function(e){return e?e.map(function(e){return w(e)}):[]};function U(e){switch(e){case"PublicDL":case"PrivateDL":case"PublicFolder":return M.DistributionList;case"Mailbox":case"Contact":return M.User;case"OneOff":return M.ExternalUser;default:return M.Other}}var L,B,j=n(708),H=n(6);function V(){return function(e){if(e===L.consumer)return"outlookCom";if(e===L.office365)return"office365";return"enterprise"}(function(){var e=Object(H.a)();if(e.IsConsumerChild)return L.consumer;if(e.SessionSettings&&e.SessionSettings.IsBposUser)return L.office365;return L.enterprise}())}(B=L||(L={}))[B.consumer=0]="consumer",B[B.office365=1]="office365",B[B.enterprise=2]="enterprise";var W=n(39);function G(e,t,n,r){var i,a,o,s,l;return a=r,o=(i=t).extension,a.extensionId=o.Id,a.marketplaceContentMarket=o.MarketplaceContentMarket,a.permissionLevel=o.RequestedCapabilities,a.marketplaceAssetId=o.MarketplaceAssetID,a.entryPointUrl=i.get_EntryPoint(),a.consentMetadata=o.ConsentMetadata,a.endNodeUrl=o.EndNodeUrl,(s=r=a).hostVersion=Object(W.f)()||"debug",s.owaView="mouse",s.timeZoneOffsets=Object(j.a)(),r=s,0!=t.extension.RequestedCapabilities&&((l=r).userDisplayName=Object(W.j)(),l.userEmailAddress=Object(W.k)(),l.userTimeZone=Object(W.m)(),l.userProfileType=V(),l.ewsUrl=Object(E.m)().EwsUrl,l.restUrl=Object(E.m)().RestUrl,r=l),r}var q="0xe1d";function z(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var i;return a.__generator(this,function(a){switch(a.label){case 0:return r.id=e.getItemId(),r.isRead=!0,r.itemType=o.Message,i=e.getItem(),r.itemClass=i.ItemClass,r.subject=i.Subject,r.normalizedSubject=function(e,t){if(!e.ExtendedProperty)return null;for(var n=0;n<e.ExtendedProperty.length;n++){var r=e.ExtendedProperty[n];if(r&&r.ExtendedFieldURI&&r.ExtendedFieldURI.PropertyTag===t)return r.Value}return null}(i,q),r.conversationId=i.ConversationId.Id,r.internetMessageId=i.InternetMessageId,r.dateTimeCreated=i.DateTimeCreated?new Date(i.DateTimeCreated).getTime():null,r.dateTimeModified=i.LastModifiedTime?new Date(i.LastModifiedTime).getTime():null,r.dateTimeSent=i.DateTimeSent?new Date(i.DateTimeSent).getTime():null,r.attachments=i.Attachments?Object(R.b)(i.Attachments):[],[4,T(n,i,t,r)];case 1:return r=a.sent(),0!=t.extension.RequestedCapabilities&&(r.from=i.From?D(i.From.Mailbox):null,r.sender=i.Sender?D(i.Sender.Mailbox):null,r.to=i.ToRecipients?i.ToRecipients.map(D):[],r.cc=i.CcRecipients?i.CcRecipients.map(D):[],r.bcc=i.BccRecipients?i.BccRecipients.map(D):[],0==i.ItemClass.indexOf("IPM.Schedule.Meeting.Request")&&(s=r,l=e.getItem(),s.itemType=o.MeetingRequest,s.location=l.Location.DisplayName,s.start=l.Start,s.end=l.End,s.to=l.RequiredAttendees?l.RequiredAttendees.map(w):[],s.cc=l.OptionalAttendees?l.OptionalAttendees.map(w):[],s.resources=l.Resources?l.Resources.map(w):[],r=s)),[2,r]}var s,l})})}var X=n(140),K=n(2069);function J(e,t){return a.__awaiter(this,void 0,void 0,function(){var n,r,i;return a.__generator(this,function(s){switch(s.label){case 0:switch(n={},r=Object(K.c)(t),Object(E.q)(t),i=Object(E.i)(e),n=G(0,i,0,n),r.mode){case X.a.MeetingRequest:case X.a.MessageRead:return[3,1];case X.a.MessageCompose:return[3,3];case X.a.AppointmentAttendee:return[3,4];case X.a.AppointmentOrganizer:return[3,6]}return[3,7];case 1:return[4,z(r,i,t,n)];case 2:return n=s.sent(),[3,7];case 3:return c=r,(u=n).itemType=o.MessageCompose,u.conversationId=c.getConversationId(),u.isRead=!1,n=u,[3,7];case 4:return[4,function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var i,s;return a.__generator(this,function(a){switch(a.label){case 0:return r.itemType=o.Appointment,i=e.getItem(),r.id=i.ItemId.Id,r.end=i.End,r.start=i.Start,r.location=i.Location.DisplayName,r.dateTimeCreated=i.DateTimeCreated?new Date(i.DateTimeCreated):null,r.dateTimeModified=i.LastModifiedTime?new Date(i.LastModifiedTime):null,r.itemClass=i.ItemClass,r.subject=i.Subject,r.normalizedSubject=i.Subject,r.organizer=w(i.Organizer),s=F(i.RequiredAttendees),r.to=function(e,t){if(t){var n=e.some(function(e){return e.address.toLowerCase()===t.address.toLowerCase()});if(!n)return e.concat(t)}return e}(s,r.organizer),r.cc=F(i.OptionalAttendees),r.attachments=i.Attachments?Object(R.b)(i.Attachments):[],r.recurrence=i.Recurrence,r.resources=F(i.Resources),r.seriesId=i.SeriesId,[4,T(n,i,t,r)];case 1:return[2,r=a.sent()]}})})}(r,i,t,n)];case 5:return n=s.sent(),[3,7];case 6:return(l=n).itemType=o.AppointmentCompose,n=l,[3,7];case 7:return[2,n]}var l,c,u})})}n(1233);var Q=n(1227),Y=n(1205);function Z(e,t,n){return"Addin_"+e+"_"+t+"_"+n}var $,ee,te=n(2776);function ne(e){return void 0===e&&(e=null),{error:$.Success,data:e}}function re(e){return{error:$.Failed,errorCode:e}}(ee=$||($={}))[ee.Success=0]="Success",ee[ee.Failed=1]="Failed";var ie=n(1217);function ae(e,t,n){return a.__awaiter(this,void 0,void 0,function(){var r,i,o,s,l,c;return a.__generator(this,function(a){switch(a.label){case 0:if(r=Object(K.c)(e),i=Object(E.p)(t),o=Z(e,i,n),!Object(ie.f)(o))return[2,re(Y.b.NotificationKeyNotFound)];s=Object(ie.e)(o),l=s.Persistent,r.removeNotificationMessage(o),Object(ie.h)(o),a.label=1;case 1:return a.trys.push([1,4,,5]),l?[4,Object(te.a)(e,i)]:[3,3];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:return(c=a.sent())instanceof Q.a?[2,re(c.errorCode)]:[3,5];case 5:return[2,ne()]}})})}function oe(e,t,n,r,i,o,s,l){return void 0===s&&(s=null),void 0===l&&(l=!1),a.__awaiter(this,void 0,void 0,function(){var c,u,d,p,f,m,h;return a.__generator(this,function(a){switch(a.label){case 0:if(c=Object(K.c)(e),u=Object(E.p)(t),d=Z(e,u,r),function(e,t,n){var r=Object(E.i)(t);if(r){var i=r.get_Id(),a=Z(e,n,i);Object(ie.f)(a)&&ae(e,t,i)}}(e,t,u),p=!1,Object(ie.f)(d)){if(l)return[2,re(Y.b.DuplicateNotificationKey)];f=Object(ie.e)(d),p=f.Persistent}else if(Object(ie.g)(e,u))return[2,re(Y.b.NumberOfNotificationsExceeded)];g=i,m={ExtensionId:u,Persistent:!!n||2===g,Key:r,Type:g,Message:o,Icon:s},Object(ie.a)(e,u,d,m),c.addNotificationMessage(d),a.label=1;case 1:return a.trys.push([1,4,,5]),p||m.Persistent?[4,Object(te.a)(e,u)]:[3,3];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:return(h=a.sent())instanceof Q.a?[2,re(h.errorCode)]:[3,5];case 5:return[2,ne()]}var g})})}function se(e){try{var t=(new DOMParser).parseFromString(e,"text/html"),n=t.querySelectorAll("style");if(n&&n.length>0)for(var r=0;r<n.length;r++)n[r]&&(n[r].innerHTML="");return t.body.textContent||""}catch(e){return""}}function le(e){var t=Object(E.w)(e);if(t){var n=t.hostItemIndex,r=Object(E.x)(e);Object(E.R)(r);var i=Object(K.c)(n);i.closeTaskPane&&i.closeTaskPane()}}function ce(e){return Object(K.d)(e)}var ue=/^[a-zA-Z0-9.!#$%&â€™*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;function de(e){return ue.test(e)}function pe(e){var t=[];return e.forEach(function(e){de(e.address)&&t.push({Name:e.name,EmailAddress:e.address})}),t}var fe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},me=/[&<>"'\/]/g;var he=n(4292),ge=n.n(he);function ve(){return null}var ye,_e,Ce="<div>",Se="</div>";function Ae(e){return a.__awaiter(this,void 0,void 0,function(){var t;return a.__generator(this,function(n){switch(n.label){case 0:return[4,(a=e,ge()({input:a}).catch(ve))];case 1:return null==(t=n.sent())?[2,null]:[2,(r=t,i=r.trim(),i.substr(0,Ce.length).toLowerCase()==Ce&&i.substr(i.length-Se.length,Se.length).toLowerCase()==Se&&(i=i.substr(Ce.length,i.length-Se.length)),i)]}var r,i,a})})}(_e=ye||(ye={}))[_e.Text=0]="Text",_e[_e.Html=3]="Html";var be=1e6;function Ie(e,t,n,r,i,o){return a.__awaiter(this,void 0,void 0,function(){var t,s,l;return a.__generator(this,function(a){switch(a.label){case 0:return n.data.length>be?(r(re(Y.a.OoeInvalidDataFormat)),[2]):(t=o&&o(),s=null,n.coercionType!==ye.Html?[3,2]:[4,Ae(n.data)]);case 1:return null==(s=a.sent())?(r(re(Y.a.HtmlSanitizationFailure)),[2]):[3,3];case 2:"HTML"===Object(K.c)(e).getBodyType()?(d=n.data,s=d.replace(me,function(e){return fe[e]})):s=n.data,a.label=3;case 3:return!o||(l=o(),u=l,null==(c=t)&&null==u||null!=c&&null!=u&&c.data===u.data&&c.sourceProperty===u.sourceProperty&&c.startPosition===u.startPosition&&c.endPosition===u.endPosition)?(i(s),r(ne()),[2]):(r(re(Y.a.CursorPositionChanged)),[2])}var c,u,d})})}var Oe=n(3327);function xe(e,t,n,r){var i,o;o=t,a.__spread(Object(E.n)().taskPanes.values()).some(function(e){return e.controlId===o})?le(t):(i=t,Object(E.n)().runningContextualAddinCommand&&Object(E.n)().runningContextualAddinCommand.controlId===i&&Object(E.P)()),r(ne())}var Ee,Te,Me={ExecuteApiMethodNoItemFailure:{datapoint:{name:"ExtExecuteApiMethodNoItemFailure",customData:function(e){return[e]}}}};(Te=Ee||(Ee={}))[Te.MaxRecipientsOnDisplayNewAppointment=100]="MaxRecipientsOnDisplayNewAppointment",Te[Te.MaxSubjectLength=255]="MaxSubjectLength",Te[Te.MaxBodyLengthOnDisplayApis=32768]="MaxBodyLengthOnDisplayApis",Te[Te.MaxLocationLengthOnDisplayNewAppointment=255]="MaxLocationLengthOnDisplayNewAppointment",Te[Te.MaxAttachmentNumberOnDisplayApis=100]="MaxAttachmentNumberOnDisplayApis",Te[Te.MaxRecipientsPerCall=100]="MaxRecipientsPerCall";var ke=Ee,Pe=function(e){return"string"==typeof e?{Name:e,EmailAddress:e}:{Name:e.name,EmailAddress:e.address}},Ne=function(e){return e?e.map(Pe):[]};function Re(e,t){return e&&e.length>t}function De(e){switch(e[0]){case"file":return{id:(n=e)[2],name:n[1],attachmentType:R.a.File,isInline:n[3]};case"item":return{id:(t=e)[2],name:t[1],attachmentType:R.a.Item,isInline:!1};default:return null}var t,n}function we(e,t,n,r,i){return a.__awaiter(this,void 0,void 0,function(){var t,o,s;return a.__generator(this,function(a){switch(a.label){case 0:return t="",o=[],n.htmlBody?n.htmlBody.length>ke.MaxBodyLengthOnDisplayApis?(r(re()),[2]):[4,Ae(n.htmlBody)]:[3,2];case 1:if(null==(t=a.sent()))return r(re()),[2];a.label=2;case 2:if(n.attachments){if(n.attachments.length>ke.MaxAttachmentNumberOnDisplayApis)return r(re()),[2];o=n.attachments.map(De)}return[4,(s=Object(K.c)(e)).displayReplyForm(s.getItemId(),i,t,o)];case 3:return a.sent(),r(ne()),[2]}})})}function Fe(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return[4,we(e,0,n,r,!0)];case 1:return t.sent(),[2]}})})}function Ue(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return[4,we(e,0,n,r,!1)];case 1:return t.sent(),[2]}})})}n(2205);var Le=n(4295),Be=n.n(Le);var je=n(18),He="Token type is not supported for caching: {0}",Ve=n(2558),We=n.n(Ve),Ge=n(2559),qe=n.n(Ge),ze="CallerIdentity",Xe="ScopedToken",Ke="ExtensionRestApiCallback",Je="ExtensionCallback";var Qe=15,Ye={},Ze={};function $e(e,t){var n;nt(t.TokenType)[e]=(n=t,{cacheTime:Date.now(),token:n})}function et(e,t){var n=nt(t);return function(e,t){var n=nt(t);n[e]&&(r=n[e],i=Date.now()-r.cacheTime,a=1e3*(r.token.TTL-Qe)*60,i>=a)&&delete n[e];var r,i,a;return!!n[e]}(e,t)?n[e].token:null}function tt(e){return e==ze||e==Je}function nt(e){switch(e){case ze:return Ye;case Je:return Ze;default:throw Object(je.format)(He,e)}}var rt="Success";function it(e,t,n){return a.__awaiter(this,void 0,void 0,function(){var r,i,o,s;return a.__generator(this,function(a){switch(a.label){case 0:if(tt(t)&&(r=et(e.extension.Id,t)))return[2,r];i=[],et(e.extension.Id,ze)||i.push(ze),2!=e.extension.RequestedCapabilities||et(e.extension.Id,Je)||i.push(Je),!n||t!=Ke&&t!=Xe||i.push(t),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(e,t,n){var r=new Array(t.length);t.forEach(function(t,i){return r[i]={TokenType:t,Id:e,Scope:n}});var i=qe()({TokenRequests:r});return We()({Header:Object(f.getJsonRequestHeader)(),Body:i})}(e.extension.Id,i,n)];case 2:return o=a.sent(),[3,4];case 3:return a.sent(),[2,null];case 4:return(l=o).Body.ResponseMessages.Items.forEach(at),s=l.Body.ResponseMessages.Items,[2,ot(t)(s)]}var l})})}function at(e){"NoError"==e.ResponseCode&&e.ResponseClass==rt&&tt(e.Token.TokenType)&&$e(e.Token.Id,e.Token)}var ot=function(e){return function(t){var n=t.filter(st(e))[0];return n?n.Token:null}},st=function(e){return function(t){return"NoError"==t.ResponseCode&&t.ResponseClass==rt&&t.Token.TokenType==e}};var lt=1e6;function ct(e,t){return{wasSuccessful:e,token:t}}var ut="ParentItemId:";var dt=n(3314);var pt,ft,mt=500;(ft=pt||(pt={}))[ft.Start=1]="Start",ft[ft.End=2]="End";var ht=pt;var gt=n(4297),vt=n.n(gt);function yt(e,t,n){return{errorMessage:e,wasSuccessful:t,customProperties:n}}var _t=n(2431);var Ct=n(4299),St=n.n(Ct),At=n(4301),bt=n.n(At);var It=n(4302),Ot=n.n(It);var xt=n(4304),Et=n.n(xt);var Tt=32768;var Mt=255;var kt,Pt,Nt=n(9);(Pt=kt||(kt={}))[Pt.GetInitialData=1]="GetInitialData",Pt[Pt.GetUserIdentityToken=2]="GetUserIdentityToken",Pt[Pt.EwsRequest=5]="EwsRequest",Pt[Pt.LoadCustomProperties=3]="LoadCustomProperties",Pt[Pt.SaveCustomProperties=4]="SaveCustomProperties",Pt[Pt.DisplayNewAppointmentForm=7]="DisplayNewAppointmentForm",Pt[Pt.DisplayMessageForm=8]="DisplayMessageForm",Pt[Pt.DisplayAppointmentForm=9]="DisplayAppointmentForm",Pt[Pt.DisplayReplyForm=10]="DisplayReplyForm",Pt[Pt.DisplayReplyAllForm=11]="DisplayReplyAllForm",Pt[Pt.GetCallbackToken=12]="GetCallbackToken",Pt[Pt.SetBodySelectedDataAsync=13]="SetBodySelectedDataAsync",Pt[Pt.GetBodyTypeAsync=14]="GetBodyTypeAsync",Pt[Pt.GetRecipientsAsync=15]="GetRecipientsAsync",Pt[Pt.AddFileAttachmentAsync=16]="AddFileAttachmentAsync",Pt[Pt.SetSubjectAsync=17]="SetSubjectAsync",Pt[Pt.GetSubjectAsync=18]="GetSubjectAsync",Pt[Pt.AddItemAttachmentAsync=19]="AddItemAttachmentAsync",Pt[Pt.RemoveAttachmentAsync=20]="RemoveAttachmentAsync",Pt[Pt.SetRecipientsAsync=21]="SetRecipientsAsync",Pt[Pt.AddRecipientsAsync=22]="AddRecipientsAsync",Pt[Pt.BodyPrependAsync=23]="BodyPrependAsync",Pt[Pt.GetTimeAsync=24]="GetTimeAsync",Pt[Pt.SetTimeAsync=25]="SetTimeAsync",Pt[Pt.GetLocationAsync=26]="GetLocationAsync",Pt[Pt.SetLocationAsync=27]="SetLocationAsync",Pt[Pt.GetSelectedDataAsync=28]="GetSelectedDataAsync",Pt[Pt.SetSelectedDataAsync=29]="SetSelectedDataAsync",Pt[Pt.DisplayReplyFormWithAttachments=30]="DisplayReplyFormWithAttachments",Pt[Pt.DisplayReplyAllFormWithAttachments=31]="DisplayReplyAllFormWithAttachments",Pt[Pt.SaveAsync=32]="SaveAsync",Pt[Pt.AddNotificationMessageAsync=33]="AddNotificationMessageAsync",Pt[Pt.GetAllNotificationMessagesAsync=34]="GetAllNotificationMessagesAsync",Pt[Pt.ReplaceNotificationMessageAsync=35]="ReplaceNotificationMessageAsync",Pt[Pt.RemoveNotificationMessageAsync=36]="RemoveNotificationMessageAsync",Pt[Pt.GetBodyAsync=37]="GetBodyAsync",Pt[Pt.SetBodyAsync=38]="SetBodyAsync",Pt[Pt.RegisterConsentAsync=40]="RegisterConsentAsync",Pt[Pt.Close=41]="Close",Pt[Pt.CloseApp=42]="CloseApp",Pt[Pt.DisplayNewMessageForm=44]="DisplayNewMessageForm",Pt[Pt.EventCompleted=94]="EventCompleted",Pt[Pt.CloseContainer=97]="CloseContainer",Pt[Pt.GetAccessTokenAsync=98]="GetAccessTokenAsync",Pt[Pt.GetInitializationContextAsync=99]="GetInitializationContextAsync",Pt[Pt.GetFromAsync=107]="GetFromAsync",Pt[Pt.MESSAGE_PARENT_DISPID=144]="MESSAGE_PARENT_DISPID",Pt[Pt.SaveSettingsRequest=404]="SaveSettingsRequest";var Rt,Dt=n(7),wt=((Rt={})[kt.GetInitialData]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var n;return a.__generator(this,function(i){switch(i.label){case 0:return[4,J(t,e)];case 1:return n=i.sent(),Object(dt.d)(!0,Object(E.i)(t),e,Object(E.l)(t)),r(n),[2]}})})},Rt[kt.EwsRequest]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var e,i,o,s,l;return a.__generator(this,function(a){switch(a.label){case 0:return!(e=n.body)||e.length>lt?(r(re(Y.b.GenericResponseError)),[2]):[4,it(i=Object(E.i)(t),Je)];case 1:if(!(o=a.sent()))return r(re(Y.b.GenericTokenError)),[2];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,(u=e,d=o.TokenValue,p=i.extension.Id,f={Body:u,Token:d,ExtensionId:p},Be()(f))];case 3:return s=a.sent(),l={wasProxySuccessful:(c=s).WasProxySuccessful,errorMessage:c.ErrorMessage,statusCode:c.StatusCode,statusDescription:c.StatusDescription,body:c.Body},r(l),[3,5];case 4:return a.sent(),r(re(Y.b.GenericResponseError)),[3,5];case 5:return[2]}var c,u,d,p,f})})},Rt[kt.GetRecipientsAsync]=function(e,t,n,r){r(ne(Object(K.c)(e).getRecipients(n.recipientField).slice(0,mt).map(function(e){return{name:e.Name,address:e.EmailAddress,recipientType:U(e.MailboxType)}})))},Rt[kt.GetSubjectAsync]=function(e,t,n,r){r(ne(Object(K.c)(e).getSubject()||""))},Rt[kt.SetSubjectAsync]=function(e,t,n,r){n.subject.length>Mt?r(re(null)):(Object(K.c)(e).setSubject(n.subject),r(ne()))},Rt[kt.SetRecipientsAsync]=function(e,t,n,r){var i=Object(K.c)(e),a=pe(n.recipientArray);try{i.setRecipients(n.recipientField,a),r(ne())}catch(e){r(re(e.errorCode))}},Rt[kt.AddRecipientsAsync]=function(e,t,n,r){var i=Object(K.c)(e),a=pe(n.recipientArray);try{i.addRecipients(n.recipientField,a),r(ne())}catch(e){r(re(e.errorCode))}},Rt[kt.SaveSettingsRequest]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var i,o,s;return a.__generator(this,function(a){switch(a.label){case 0:if(i=n[0],(o=JSON.stringify(i)).length>Tt)return r(re(Y.b.GenericSettingsError)),[2];a.label=1;case 1:return a.trys.push([1,3,,4]),s=Object(E.i)(t),[4,(l=s.extension.Id,c=s.extension.Version,u=o,d={ExtensionId:l,ExtensionVersion:c,Settings:u},Et()({request:d}))];case 2:return a.sent(),Object(E.X)(e,t,o),r(ne()),[3,4];case 3:return a.sent(),r(re(Y.b.GenericSettingsError)),[3,4];case 4:return[2]}var l,c,u,d})})},Rt[kt.GetCallbackToken]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var i,o,s,l;return a.__generator(this,function(a){switch(a.label){case 0:return i=Object(E.i)(t),c=e,u=K.c(c).getItemId(),o=u?ut+u:null,s=n.isRest?Ke:Xe,o?[4,it(i,s,o)]:(r(re(Y.b.CallSaveAsyncBeforeToken)),[2]);case 1:return l=a.sent(),r(l?ct(!0,l.TokenValue):re(Y.b.GenericTokenError)),[2]}var c,u})})},Rt[kt.GetUserIdentityToken]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var e;return a.__generator(this,function(n){switch(n.label){case 0:return[4,it(Object(E.i)(t),ze)];case 1:return e=n.sent(),r(e?ct(!0,e.TokenValue):re(Y.b.GenericTokenError)),[2]}})})},Rt[kt.MESSAGE_PARENT_DISPID]=function(e,t,n,r){Object(_t.d)(_t.a.DISPLAY_DIALOG_DISPID,t,n,function(){r(ne())})},Rt[kt.SetBodyAsync]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var t,i;return a.__generator(this,function(a){switch(a.label){case 0:return t=Object(K.c)(e),i=n.coercionType==ye.Html?"HTML":"Text",[4,Ie(e,0,n,r,function(e){return t.setBody(e,i)})];case 1:return a.sent(),[2]}})})},Rt[kt.GetBodyAsync]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var t,i,o;return a.__generator(this,function(s){switch(s.label){case 0:if(t=Object(K.c)(e),i=t.mode,o=null,i!=X.a.MessageRead&&i!=X.a.AppointmentAttendee)return[3,5];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,function(e){return a.__awaiter(this,void 0,void 0,function(){var t;return a.__generator(this,function(n){switch(n.label){case 0:return e.NormalizedBody?[3,2]:[4,h([e.ItemId.Id],v()({BaseShape:"IdOnly",AdditionalProperties:[_()({FieldURI:"NormalizedBody"})]}),"ItemNormalizedBody")];case 1:t=n.sent(),e.NormalizedBody=t.NormalizedBody,n.label=2;case 2:return[2,e.NormalizedBody.Value]}})})}(t.getItem())];case 2:return o=s.sent(),[3,4];case 3:return s.sent(),r(re(Y.a.GenericResponseError)),[2];case 4:return[3,6];case 5:i!=X.a.MessageCompose&&i!=X.a.AppointmentOrganizer||(o=t.getBody()),s.label=6;case 6:return n.coercionType==ye.Text&&(o=se(o)),r(ne(o)),[2]}})})},Rt[kt.GetBodyTypeAsync]=function(e,t,n,r){var i=Object(K.c)(e).getBodyType();r(ne(i&&i.toLowerCase()||null))},Rt[kt.BodyPrependAsync]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var t;return a.__generator(this,function(i){switch(i.label){case 0:return t=Object(K.c)(e),n.coercionType===ye.Html&&"Text"===t.getBodyType()?(r(re(Y.a.OoeInvalidDataFormat)),[2]):[4,Ie(e,0,n,r,t.prependBody)];case 1:return i.sent(),[2]}})})},Rt[kt.Close]=function(e,t){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return[4,Object(K.c)(e).close()];case 1:return t.sent(),Object(Oe.a)(e),[2]}})})},Rt[kt.CloseApp]=xe,Rt[kt.CloseContainer]=xe,Rt[kt.DisplayMessageForm]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return[4,Object(K.c)(e).displayMessageForm(n.itemId)];case 1:return t.sent(),r(ne()),[2]}})})},Rt[kt.DisplayReplyAllForm]=Fe,Rt[kt.DisplayReplyAllFormWithAttachments]=Fe,Rt[kt.DisplayReplyForm]=Ue,Rt[kt.DisplayReplyFormWithAttachments]=Ue,Rt[kt.DisplayAppointmentForm]=function(e,t,n,r){n.itemId?(Object(K.c)(e).displayAppointmentForm(n.itemId),r(ne())):r(re())},Rt[kt.DisplayNewAppointmentForm]=function(e,t,n,r){var i;!n||Re((i=n).requiredAttendees,ke.MaxRecipientsOnDisplayNewAppointment)||Re(i.optionalAttendees,ke.MaxRecipientsOnDisplayNewAppointment)||Re(i.subject,ke.MaxSubjectLength)||Re(i.body,ke.MaxBodyLengthOnDisplayApis)||Re(i.location,ke.MaxLocationLengthOnDisplayNewAppointment)?r(re()):(Object(K.c)(e).displayNewAppointmentForm(Ne(n.requiredAttendees),Ne(n.optionalAttendees),n.start,n.end,n.location,n.resources,n.subject,n.body),r(ne()))},Rt[kt.DisplayNewMessageForm]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var t,i,o,s,l,c,u,d;return a.__generator(this,function(p){switch(p.label){case 0:if(t=!1,i=a.__read([n.toRecipients,n.ccRecipients,n.bccRecipients].map(function(e){return e?e.length>ke.MaxRecipientsPerCall?(t=!0,null):(n=[],e.forEach(function(e){de(e)&&n.push({Name:e,EmailAddress:e,MailboxType:"OneOff",RoutingType:"SMTP"})}),n):[];var n}),3),o=i[0],s=i[1],l=i[2],t)return r(re()),[2];if(c="",n.subject){if(n.subject.length>ke.MaxSubjectLength)return r(re()),[2];c=n.subject}return u="",n.htmlBody?n.htmlBody.length>ke.MaxBodyLengthOnDisplayApis?(r(re()),[2]):[4,Ae(n.htmlBody)]:[3,2];case 1:if(null==(u=p.sent()))return r(re()),[2];p.label=2;case 2:if(d=[],n.attachments){if(n.attachments.length>ke.MaxAttachmentNumberOnDisplayApis)return r(re()),[2];d=n.attachments.map(De)}return[4,Object(K.c)(e).displayNewMessageForm(o,s,l,c,u,d)];case 3:return p.sent(),r(ne()),[2]}})})},Rt[kt.EventCompleted]=function(e,t,n,r){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(t,n)},Rt[kt.GetSelectedDataAsync]=function(e,t,n,r){var i=Object(K.c)(e).getSelectedData();i?(n.coercionType==ye.Text&&(i.data=se(i.data)),r(ne(i))):r(re(Y.a.InvalidSelection))},Rt[kt.SetSelectedDataAsync]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var t,i;return a.__generator(this,function(a){switch(a.label){case 0:return t=Object(K.c)(e),null==(i=t.getSelectedData())?(r(re(Y.a.InvalidSelection)),[2]):n.coercionType===ye.Html&&("subject"===i.sourceProperty||"body"===i.sourceProperty&&"Text"===t.getBodyType())?(r(re(Y.a.OoeInvalidDataFormat)),[2]):[4,Ie(e,0,n,r,t.setSelectedData,t.getSelectedData)];case 1:return a.sent(),[2]}})})},Rt[kt.SetBodySelectedDataAsync]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var t;return a.__generator(this,function(i){switch(i.label){case 0:return t=Object(K.c)(e),[4,Ie(e,0,n,r,t.setBodySelectedData,t.getSelectedData)];case 1:return i.sent(),[2]}})})},Rt[kt.SaveAsync]=function(e,t,n,r){Object(K.c)(e).saveItem().then(function(e){r(e?ne(e):re(Y.a.SaveError))})},Rt[kt.LoadCustomProperties]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var n,i,o,s;return a.__generator(this,function(a){switch(a.label){case 0:if(n=Object(K.c)(e),!(i=n.getItemId()))return r(yt("",!0,"{}")),[2];o=Object(E.p)(t),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,(l=o,c=i,u={ExtensionId:l,ItemId:c},vt()({request:u}))];case 2:return s=a.sent(),r(yt(s.ErrorMessage,s.WasSuccessful,s.CustomProperties)),[3,4];case 3:return a.sent(),r(re(Y.b.GenericResponseError)),[3,4];case 4:return[2]}var l,c,u})})},Rt[kt.SaveCustomProperties]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var i,o,s,l,c;return a.__generator(this,function(a){switch(a.label){case 0:i=Object(K.c)(e),o=Object(E.p)(t),s=JSON.stringify(n.customProperties),l=i.getItemId(),a.label=1;case 1:return a.trys.push([1,5,,6]),l?[3,3]:[4,i.saveItem()];case 2:l=a.sent(),a.label=3;case 3:return[4,(u=o,d=l,p=s,f={ExtensionId:u,ItemId:d,CustomProperties:p},Ot()({request:f}))];case 4:return c=a.sent(),r(yt(c.ErrorMessage,c.WasSuccessful)),[3,6];case 5:return a.sent(),r(re(Y.b.GenericResponseError)),[3,6];case 6:return[2]}var u,d,p,f})})},Rt[kt.AddNotificationMessageAsync]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var i;return a.__generator(this,function(a){switch(a.label){case 0:return[4,oe(e,t,n.persistent,n.key,n.type,n.message,n.icon,!0)];case 1:return i=a.sent(),r(i),[2]}})})},Rt[kt.GetAllNotificationMessagesAsync]=function(e,t,n,r){r(ne(Object(K.c)(e).getNotificationMessageIds().reduce(function(e,t){var n,r=Object(ie.e)(t);return r&&e.push((n=r,a.__assign({key:n.Key,type:function(e){switch(e){case 0:return"informationalMessage";case 2:return"errorMessage";case 1:return"progressIndicator"}return""}(n.Type),message:n.Message,icon:n.Icon},n.Persistent&&{persistent:!0}))),e},[])))},Rt[kt.RemoveNotificationMessageAsync]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var i;return a.__generator(this,function(a){switch(a.label){case 0:return[4,ae(e,t,n.key)];case 1:return i=a.sent(),r(i),[2]}})})},Rt[kt.ReplaceNotificationMessageAsync]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var i;return a.__generator(this,function(a){switch(a.label){case 0:return[4,oe(e,t,n.persistent,n.key,n.type,n.message,n.icon,!1)];case 1:return i=a.sent(),r(i),[2]}})})},Rt[kt.AddItemAttachmentAsync]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var t,i,o;return a.__generator(this,function(a){switch(a.label){case 0:t=Object(K.c)(e),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.addItemAttachment(n.name,n.itemId,n.isInline)];case 2:return i=a.sent(),r(i?ne(i):re(Y.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return o=a.sent(),r(re(o)),[3,4];case 4:return[2]}})})},Rt[kt.AddFileAttachmentAsync]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var t,i,o;return a.__generator(this,function(a){switch(a.label){case 0:t=Object(K.c)(e),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.addFileAttachment(n.name,n.uri,n.isInline)];case 2:return i=a.sent(),r(i?ne(i):re(Y.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return o=a.sent(),r(re(o.errorCode)),[3,4];case 4:return[2]}})})},Rt[kt.RemoveAttachmentAsync]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var t;return a.__generator(this,function(i){switch(i.label){case 0:if(!n||!n.attachmentIndex)return r(re(Y.a.InvalidAttachmentId)),[2];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(K.c)(e).removeAttachment(n.attachmentIndex)];case 2:return i.sent(),r(ne()),[3,4];case 3:return t=i.sent(),r(re(t.errorCode)),[3,4];case 4:return[2]}})})},Rt[kt.RegisterConsentAsync]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var i,o,s;return a.__generator(this,function(a){switch(a.label){case 0:if(i=n.consentState,!(o=Object(E.p)(t))||!i)return r(re(Y.b.GenericResponseError)),[2];a.label=1;case 1:return a.trys.push([1,3,,4]),Object(E.U)(e,t,i),[4,(l=o,c=i,u=bt()({Id:l,ConsentState:c}),St()({Header:Object(f.getJsonRequestHeader)(),Body:u}))];case 2:return"NoError"===(s=a.sent()).Body.ResponseCode&&"Success"===s.Body.ResponseClass?(r(ne()),[2]):(r(re(Y.b.GenericResponseError)),[3,4]);case 3:return a.sent(),r(re(Y.b.GenericResponseError)),[3,4];case 4:return[2]}var l,c,u})})},Rt[kt.GetLocationAsync]=function(e,t,n,r){r(ne(Object(K.c)(e).getLocation()||""))},Rt[kt.SetLocationAsync]=function(e,t,n,r){null!=n.location?(Object(K.c)(e).setLocation(n.location),r(ne())):r(re(null))},Rt[kt.GetTimeAsync]=function(e,t,n,r){var i=Object(K.c)(e),a=null;n.TimeProperty===ht.Start?a=i.getStartTime():n.TimeProperty===ht.End&&(a=i.getEndTime()),r(ne(a))},Rt[kt.SetTimeAsync]=function(e,t,n,r){var i=Object(K.c)(e),a=new Date(n.time);if(n.TimeProperty===ht.Start)i.setStartTime(a);else if(n.TimeProperty===ht.End&&!i.setEndTime(a))return void r(re(Y.a.InvalidEndTime));r(ne())},Rt[kt.GetInitializationContextAsync]=function(e,t,n,r){return a.__awaiter(this,void 0,void 0,function(){var t,n;return a.__generator(this,function(i){return t=Object(E.n)().taskPanes,a.__spread(t.values()).forEach(function(t){t.hostItemIndex===e&&t.initializationContext&&(n=t.initializationContext)}),r(n?ne(n):re()),[2]})})},Rt[kt.GetFromAsync]=function(e,t,n,r){var i=Object(K.c)(e).getFrom();r(i?ne({name:i.Name,address:i.EmailAddress}):re())},Rt);function Ft(e,t,n,r,i){var a=wt[t];if(a){if(!ce(e)){var o=Me.ExecuteApiMethodNoItemFailure.datapoint,s=o.name,l=o.customData;return Object(Nt.n)(s,l(t)),void i(re(Y.b.GenericResponseError))}try{a(e,n,r,i)}catch(e){throw Dt.c.error(e.message),e}}}var Ut=n(4306),Lt=n.n(Ut);function Bt(e,t,n,r,i){var a={FormFactor:e,ClientLanguage:t,IncludeDisabledExtensions:n,ApiVersionSupported:r,ClientOverrideVersion:i};return Lt()({request:a})}var jt=n(4308),Ht=n.n(jt),Vt=n(4310),Wt=n.n(Vt);function Gt(e){return a.__awaiter(this,void 0,void 0,function(){var t,n,r;return a.__generator(this,function(i){switch(i.label){case 0:return t=Object(K.c)(e),n={Id:t.getItemId()},t.addNotificationMessage?(Object(ie.c)(e).map(t.addNotificationMessage),[4,(a=n,o=Wt()({ItemId:a}),Ht()({Header:Object(f.getJsonRequestHeader)(),Body:o})).catch(qt)]):[2];case 1:return(r=i.sent())&&(r.Body.Apps||[]).forEach(function(n){var r=!1;n.Notifications.forEach(function(i){var a={ExtensionId:n.Id,Persistent:!0,Key:i.Key,Type:i.Type,Message:i.Message,Icon:i.Icon};2===i.Type&&(a.Persistent=!1,r=!0);var o=Z(e,n.Id,i.Key);Object(ie.a)(e,n.Id,o,a),t.addNotificationMessage(o)}),r&&Object(te.a)(e,n.Id)}),[2]}var a,o})})}function qt(){return null}n.d(t,"b",function(){return K.a}),n.d(t,"f",function(){return K.b}),n.d(t,"k",function(){return K.c}),n.d(t,"c",function(){return oe}),n.d(t,"e",function(){return se}),n.d(t,"d",function(){return le}),n.d(t,"g",function(){return ie.b}),n.d(t,"h",function(){return ce}),n.d(t,"i",function(){return S}),n.d(t,"j",function(){return Ft}),n.d(t,"l",function(){return C}),n.d(t,"m",function(){return Bt}),n.d(t,"n",function(){return V}),n.d(t,"o",function(){return Gt}),n.d(t,"p",function(){return ae}),n.d(t,"a",function(){return J})},220:function(e,t,n){"use strict";var r=n(1842),i=n(2073),a=n(41),o={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"};n.d(t,"a",function(){return s});var s=Object(r.a)(i.a,function(e){var t=e.className,n=e.theme,r=Object(a.getGlobalClassNames)(o,n);return{actions:[r.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"20px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal"}}},t],action:[r.action],actionsRight:[r.actionsRight,{textAlign:"right",marginRight:"-4px",fontSize:"0",selectors:{$action:{margin:"0 4px"}}}]}},void 0,{scope:"DialogFooter"})},2205:function(e,t,n){"use strict";var r=n(176),i=n(6);n(4293);var a=n(4294);OSF.getLocalizedStringsFilePath=function(){var e=Object(r.a)()+"resources/locale/osfruntime/",t=Object(i.a)().SessionSettings?Object(i.a)().SessionSettings.UserLanguage:"en";return e+(a[t]||"en-us")+"/jscript/"},OSF.getManifestHostType=function(){}},2214:function(e,t,n){"use strict";var r=n(2),i=n(2310);function a(e){return i.a.addinOptionSurfaceItems[e]}var o=n(110),s=n(11),l=n.n(s),c=n(18);function u(e){switch(e){case"AddAttachment":return l.a.attachTooltip;case"AddInlineImage":return l.a.insertPicturesInlineTooltip;case"AddEmoji":return l.a.emojiTooltip;case"ToggleRibbon":return l.a.formattingOptionsTooltip;case"SaveDraft":return l.a.saveDraft;case"InsertSignature":return l.a.insertSignature;case"ShowFrom":return l.a.showFrom;case"SetImportance":return l.a.setImportance;case"ShowMessageOptions":return l.a.showMessageOptions;case"SwitchBodyType":return l.a.switchToPlainTextMenuItem;case"ProtectMessage":return l.a.composeProtectButton;case"AccChecker":return l.a.accCheckerMenuItemText;default:return""}}function d(e){switch(e){case"LikeUnlike":return l.a.itemHeaderLike;case"Reply":return l.a.itemHeaderReply;case"ReplyAll":return l.a.itemHeaderReplyAll;case"Forward":return l.a.itemHeaderForward;case"ReplyByMeeting":return l.a.itemHeaderReplyByMeeting;case"Popout":return l.a.popoutsOpenInNewWindow;case"Delete":return l.a.itemHeaderDelete;case"MarkReadUnread":return l.a.markAsUnread;case"FlagUnflag":return l.a.itemHeaderFlag;case"MarkJunkNotJunk":return l.a.itemHeaderMarkAsJunk;case"MarkAsPhishing":return l.a.itemHeaderMarkAsPhishing;case"Block":return Object(c.format)(l.a.itemHeaderBlock,"");case"CreateRule":return l.a.createRule;case"Print":return l.a.itemHeaderPrint;case"Translate":return l.a.itemHeaderTranslate;case"ShowInImmersiveReader":return l.a.showInImmersiveReader;case"ViewMessageSource":return Object(o.a)()?l.a.itemHeaderViewMessageSource:l.a.itemHeaderViewMessageDetails;case"ToggleDarkMode":return l.a.itemHeaderLightsOn;default:return""}}function p(e){switch(e){case"None":return l.a.none;case"Delete":return l.a.deleteItem;case"Archive":return l.a.archive;case"PinUnpin":return l.a.pin;case"ReadUnread":return l.a.readUnread;case"FlagUnflag":return l.a.flag;case"Move":return"Move to folder";default:return""}}var f=n(2145),m=n(2311),h=n(6),g=n(8);var v=n(317),y=n(158);function _(){var e=[{key:"Reply",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAll",hideInGroup:!1,hideInSxS:!1},{key:"Forward",hideInGroup:!1,hideInSxS:!1},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"Delete",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"MarkReadUnread",hideInGroup:!1,hideInSxS:!0},{key:"FlagUnflag",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}];return Object(h.a)().SessionSettings.IsShadowMailbox||e.push({key:"MarkJunkNotJunk",hideInGroup:!0,hideInSxS:!0},{key:"MarkAsPhishing",hideInGroup:!0,hideInSxS:!0},{key:"Block",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),e.push({key:"CreateRule",hideInGroup:!0,hideInSxS:!0},{key:"Print",hideInGroup:!1,hideInSxS:!1}),Object(g.c)("gsx-translator-translateMessage")&&e.push({key:"Translate",hideInGroup:!0,hideInSxS:!0}),Object(y.c)()&&e.push({key:"ToggleDarkMode",hideInGroup:!1,hideInSxS:!1}),Object(g.c)("rp-immersiveReader")&&e.push({key:"ShowInImmersiveReader",hideInGroup:!1,hideInSxS:!0}),e.push({key:"ViewMessageSource",hideInGroup:!0,hideInSxS:!0}),Object(g.c)("rp-popouts")&&e.push({key:"Popout",hideInGroup:!1,hideInSxS:!0}),Object(g.c)("rp-like")&&!Object(o.a)()&&e.push({key:"LikeUnlike",hideInGroup:!1,hideInSxS:!0}),Object(g.c)("rp-replyByMeeting")&&e.push({key:"ReplyByMeeting",hideInGroup:!0,hideInSxS:!0}),e}function C(){var e=[{key:"AddAttachment",hideInGroup:!1},{key:"AddInlineImage",hideInGroup:!1}];return Object(g.c)("mc-expPicker")&&e.push({key:"AddEmoji",hideInGroup:!1}),e=e.concat([{key:"ToggleRibbon",hideInGroup:!1},{key:"SaveDraft",hideInGroup:!1},{key:"InsertSignature",hideInGroup:!1},{key:"ShowFrom",hideInGroup:!1},{key:"SetImportance",hideInGroup:!1}]),(Object(o.a)()?Object(g.c)("cmp-encryption")&&Object(h.a)().SessionSettings.IsPremiumConsumerMailbox:Object(g.c)("cmp-manageIRM"))&&e.push({key:"ProtectMessage",hideInGroup:!1}),Object(m.a)()&&e.push({key:"ShowMessageOptions",hideInGroup:!1}),e.push({key:"SwitchBodyType",hideInGroup:!1}),Object(g.c)("cmp-accChecker")&&e.push({key:"AccChecker",hideInGroup:!1}),e}function S(e){return"Reply"==e||"ReplyAll"==e||"Forward"==e}function A(e){return-1!==Object(v.c)(v.a.SurfaceActions).readSurfaceActions.indexOf(e)}var b={CSACountReadUserAction:{datapoint:{name:"CSACountReadUserAction",customData:function(e,t){return[e,t]}}},CSACountComposeUserAction:{datapoint:{name:"CSACountComposeUserAction",customData:function(e,t){return[e,t]}}}},I=n(9);function O(e,t,n){var r="Pinned";if(n&&n.renderedInOverflow&&(r=n.isPinned?"Overflow":"NotPinned"),e){var i=b.CSACountComposeUserAction.datapoint,a=i.name,o=i.customData;Object(I.n)(a,o(t,r))}else{var s=b.CSACountReadUserAction.datapoint,l=s.name;o=s.customData;Object(I.n)(l,o(t,r))}}function x(e){e.subMenuProps&&e.subMenuProps.items.forEach(function(e){e.renderedInOverflow=!0})}function E(e){e.subMenuProps&&e.subMenuProps.items.forEach(function(e){e.renderedInOverflow=!1})}n.d(t,"j",function(){return M}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return u}),n.d(t,"g",function(){return d}),n.d(t,"f",function(){return p}),n.d(t,"a",function(){return"-"}),n.d(t,"d",function(){return f.a}),n.d(t,"h",function(){return f.c}),n.d(t,"e",function(){return C}),n.d(t,"i",function(){return _}),n.d(t,"o",function(){return S}),n.d(t,"n",function(){return A}),n.d(t,"k",function(){return O}),n.d(t,"m",function(){return x}),n.d(t,"l",function(){return E});var T=new r.c(function(){return n.e(176).then(n.bind(null,5694))}),M=new r.a(T,function(e){return e.setAddinOptionSurfaceItems})},2250:function(e,t,n){"use strict";n.d(t,"d",function(){return d}),n.d(t,"a",function(){return p}),n.d(t,"c",function(){return f}),n.d(t,"b",function(){return m}),n.d(t,"e",function(){return h}),n.d(t,"f",function(){return g});var r,i,a=n(2312),o=n(352),s=n.n(o),l=n(664),c=n(670),u=n(39);n(2205);function d(){return r}function p(){void 0===r&&(r="Store"+OSF.OUtil.generateConversationId());var e=Object(l.m)(),t=r+"|"+window.location.href.split("?")[0],n=OSF.OUtil.addXdmInfoAsHash(e.InClientStoreUrl,t);n=a.a(n,"client","WAC_Outlook");var o=Date.now();return n=a.a(n,"cv","16.2130.0.9999"),n=a.a(n,"ui",Object(u.i)()),n=a.a(n,"rs",Object(u.i)()),n=a.a(n,"timestamp",o.toString()),n=a.a(n,"ep",function(){if(i)return"il";return"ma"}()),n=a.a(n,"exchver",a.c()),n=a.a(n,"privateenabled","true"),n=a.a(n,"cb",a.d()),n=a.a(n,"ClientSessionId",a.e()),n=a.a(n,"userPuid","0"),Object(c.f)()&&(n=Object(c.b)("cal-addins")?a.a(n,"gates","Marketplace.Outlook.Pin.Addin.Options,Marketplace.Outlook.Pin.Addin.Calendar.Options"):a.a(n,"gates","Marketplace.Outlook.Pin.Addin.Options")),n}function f(){var e=OSF.OUtil.getUniqueId();return Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(e)}function m(){var e=s()();return e.headers=[["X-EWS-TargetVersion","2.80"]],delete e.credentials,e}function h(e){return"string"==typeof e?e:["notresponded","notconsented","consented"][e]}var g=function(e){i=e}},2310:function(e,t,n){"use strict";var r=n(3),i=Object(r.createStore)("SurfaceActionsStore",{addinOptionSurfaceItems:{}})();t.a=i},2311:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(8),i=n(39);function a(){return!Object(i.n)()&&(Object(r.c)("cmp-requestReadReceipts")||Object(r.c)("cmp-requestDeliveryReceipts")||Object(r.c)("cmp-setMessageSensitivity"))}},2312:function(e,t,n){"use strict";n.d(t,"d",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"c",function(){return l}),n.d(t,"e",function(){return c}),n.d(t,"f",function(){return u}),n.d(t,"b",function(){return d});var r,i=n(104),a=n(6);function o(){return"x"}function s(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");var r=e.split("#"),i=1==r.length?"":e.substr(e.indexOf("#"));return e=e.indexOf("?")>0?r[0]+"&"+t+"="+n+i:r[0]+"?"+t+"="+n+i}function l(){return window.genericDiagnostics.wsver}function c(){return void 0==r&&(r=Object(i.getGuid)()),r}function u(){return Object(a.a)().UserOptions.TimeZone}function d(e){var t=encodeURIComponent(e),n=unescape(t);return btoa(n)}n(138)},2416:function(e,t,n){"use strict";var r=n(2768);n.d(t,"a",function(){return r.a});var i=n(3075);n.d(t,"b",function(){return i.a})},2431:function(e,t,n){"use strict";var r,i,a,o;function s(e,t){var n,r;e&&e((n=t.EventResponseCode,(r={}).Error=n,r))}function l(e,t){void 0!==e.invokeHandlerIfPreviousOnTriggerFailed&&e.invokeHandlerIfPreviousOnTriggerFailed(t)}(i=r||(r={}))[i.DISPLAY_DIALOG_DISPID=10]="DISPLAY_DIALOG_DISPID",i[i.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID=11]="DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID",i[i.ITEM_CHANGED_EVENT_DISPID=46]="ITEM_CHANGED_EVENT_DISPID",i[i.APPOINTMENT_TIME_CHANGED_EVENT_DISPID=48]="APPOINTMENT_TIME_CHANGED_EVENT_DISPID",(o=a||(a={}))[o.SUCCESS=0]="SUCCESS",o[o.INTERNAL_ERROR=5001]="INTERNAL_ERROR",o[o.URL_NOT_IN_APP_DOMAINS=12004]="URL_NOT_IN_APP_DOMAINS",o[o.WEB_DIALOG_CLOSED=12006]="WEB_DIALOG_CLOSED",o[o.DIALOG_ALREADY_OPEN=12007]="DIALOG_ALREADY_OPEN";var c=a,u="DialogApiEventError",d="ApiEventError";function p(e,t,n){return{EventResponseCode:e,ErrorClassification:t,ErrorDetails:n}}function f(){return p(c.SUCCESS)}function m(e){return e.EventResponseCode===c.SUCCESS}function h(e,t){return f()}function g(e){return f()}function v(e,t){return f()}function y(e){return e}function _(e){return[JSON.stringify(e)]}var C={};function S(e,t){return C[e]&&C[e][t]?C[e][t]:null}function A(e){delete C[e]}function b(e,t){return!!S(e,t)}function I(e,t,n,r){var i=F(e),a=i.onTrigger(n,t);m(a)&&(a=function(e,t,n,r){var i=S(e,t);if(!i)return p(c.INTERNAL_ERROR,d,"HandlerNotRegistered");var a=n.formatArgsForHandler(r);return i(a),f()}(t,e,i,n)),s(r,a)}var O=n(664);function x(e,t){if(Object(O.B)())return p(c.DIALOG_ALREADY_OPEN,u,c[c.DIALOG_ALREADY_OPEN]);if(!function(e,t){if(t&&1==t.displayInIframe){var n=Object(O.i)(e).extension.AppDomains;return r=n,i=t.url,Microsoft.Office.Common.XdmCommunicationManager.checkUrlWithAppDomains(r,i)}var r,i;return!0}(e,t))return p(c.URL_NOT_IN_APP_DOMAINS,u,c[c.URL_NOT_IN_APP_DOMAINS]);var n,r,i,a,o=(n=e,r=t,i=!0,a=Object(O.r)(n),r&&1==r.displayInIframe?{dialogType:1,url:r.url,heightInPercentage:r.height,widthInPercentage:r.width,parentControlId:n,isOpen:i,hostItemIndex:a}:Object(O.F)(n)?{dialogType:2,parentControlId:n,isOpen:i,hostItemIndex:a}:null);return Object(O.G)(o),f()}function E(e){return Object(O.G)(null),I(r.DISPLAY_DIALOG_DISPID,e,null),f()}function T(e,t){return f()}function M(e){return null!=(t=e)&&void 0!==t.messageToParent?{messageType:"0",messageContent:e.messageToParent}:{messageType:c.WEB_DIALOG_CLOSED};var t}var k={UnregisteredItemChangedEvent:{datapoint:{name:"ExtTriggerUnregisteredItemChangedEvent"}}},P=n(9),N=!1,R=null;function D(e,t){var n,i;return n=e,b(i=t,r.ITEM_CHANGED_EVENT_DISPID)||(N=!0,R={controlId:i,args:n},Object(P.n)(k.UnregisteredItemChangedEvent.datapoint.name)),f()}function w(e){N&&R.controlId===e&&I(r.ITEM_CHANGED_EVENT_DISPID,e,R.args),N=!1,R=null}function F(e){switch(e){case r.DISPLAY_DIALOG_DISPID:case r.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID:return{register:x,unregister:E,onTrigger:T,formatArgsForHandler:M};case r.ITEM_CHANGED_EVENT_DISPID:return{register:h,unregister:g,onTrigger:D,formatArgsForHandler:y,invokeHandlerIfPreviousOnTriggerFailed:w};case r.APPOINTMENT_TIME_CHANGED_EVENT_DISPID:return{register:h,unregister:g,onTrigger:v,formatArgsForHandler:_};default:throw new Error("ApiEvent not implemented")}}function U(e,t,n){var r,i=(r=t).targetId?JSON.parse(r.targetId):null,a=F(t.eventDispId),o=a.register(t.controlId,i);m(o)&&(o=function(e,t,n){if(b(e,t))return p(c.INTERNAL_ERROR,d,"ControlAlreadyRegistered");return r=e,i=t,a=n,C[r]||(C[r]={}),C[r][i]=a,f();var r,i,a}(t.controlId,t.eventDispId,e)),s(n,o),l(a,t.controlId)}function L(e,t){var n=F(e.eventDispId).unregister(e.controlId);m(n)&&(n=function(e,t){if(!b(e,t))return p(c.INTERNAL_ERROR,d,"ControlNotRegistered");return n=e,r=t,C[n]&&C[n][r]&&delete C[n][r],f();var n,r}(e.controlId,e.eventDispId)),s(t,n)}var B=n(2150),j=n(140);function H(e){var t,n,i,a,o,s=Object(O.k)(e),l=Object(B.k)(s);if(null!=l&&l.mode===j.a.AppointmentOrganizer){var c=l;t=s,n=r.APPOINTMENT_TIME_CHANGED_EVENT_DISPID,i=function(){return{start:c.getStartTime(),end:c.getEndTime()}},a=!1,o=null,Object(O.j)(t).forEach(function(e){b(e,n)&&(a||(a=!0,o=i()),I(n,e,o))})}}n.d(t,"c",function(){return U}),n.d(t,"f",function(){return L}),n.d(t,"d",function(){return I}),n.d(t,"b",function(){return A}),n.d(t,"e",function(){return H}),n.d(t,"a",function(){return r})},2515:function(e,t,n){"use strict";n.d(t,"h",function(){return a}),n.d(t,"a",function(){return o}),n.d(t,"g",function(){return s}),n.d(t,"d",function(){return l}),n.d(t,"e",function(){return c}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"f",function(){return p});var r=n(0),i=n(664);function a(e){return s(e)?l(e).isMenu:e.AddinCommands.size>1}function o(e){return!!s(e)&&l(e).isActionable}function s(e){return 1==e.AddinCommands.size}function l(e){return e.AddinCommands.size>0?e.AddinCommands.values()[0]:null}function c(e){return s(e)?l(e).control.Supertip.Title:""}function u(e){var t=e.DisplayName;s(e)&&(t+=" - "+l(e).control.Supertip.Title);return t}function d(e,t,n){var a,o,s,l;try{for(var c=r.__values(i.h.EnabledAddinCommands.getExtensionPoint(n)),u=c.next();!u.done;u=c.next()){var d=u.value;if(d.Id==e&&d.AddinCommands.size>0)try{for(var p=r.__values(d.AddinCommands.values()),f=p.next();!f.done;f=p.next()){var m=f.value;if(m.control.Id==t)return m}}catch(e){s={error:e}}finally{try{f&&!f.done&&(l=p.return)&&l.call(p)}finally{if(s)throw s.error}}}}catch(e){a={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(a)throw a.error}}return null}function p(e){return i.h.compliance.isMinor&&(t=e.extension,!("Default"===t.TypeString||(r=t,"Organization"===r.OriginString)||(n=t,"Private"===n.TypeString)));var t,n,r}},2558:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),i=n(2650);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetClientAccessToken",e,t)}},2559:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetClientAccessTokenRequest:#Exchange"},e)}},2580:function(e,t,n){var r;
/*!
  Copyright (c) 2016 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/*!
  Copyright (c) 2016 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var a=typeof r;if("string"===a||"number"===a)e.push(r);else if(Array.isArray(r))e.push(i.apply(null,r));else if("object"===a)for(var o in r)n.call(r,o)&&r[o]&&e.push(o)}}return e.join(" ")}void 0!==e&&e.exports?e.exports=i:void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},2622:function(e,t,n){"use strict";var r=n(3744),i=n(2823);function a(e){var t=Object(r.a)(e);return Object(i.a)()[t]}var o=n(2694);function s(e){return e.isActionable&&e.control.Action.SupportsPersistence}var l=n(0),c=n(140),u=n(670),d=n(18),p=n(3738),f=!1;function m(e){return l.__awaiter(this,void 0,void 0,function(){var t,n;return l.__generator(this,function(r){switch(r.label){case 0:return Object(u.e)()?e===c.a.AppointmentAttendee||e===c.a.AppointmentOrganizer?[2]:f?[3,2]:[4,Object(p.a)()]:[2];case 1:t=r.sent(),(n=JSON.parse(t)).addins&&(f=!0,n.addins.forEach(function(e){if(n=e,!Object(d.isStringNullOrWhiteSpace)(n.mode)&&!Object(d.isStringNullOrWhiteSpace)(n.addinId)&&!Object(d.isStringNullOrWhiteSpace)(n.commandId)){var t={addinId:e.addinId,commandId:e.commandId};Object(i.a)()[e.mode]=t}var n})),r.label=2;case 2:return[2]}})})}function h(){return f}function g(e){return{addinId:e.extension.Id,commandId:e.control.Id}}var v=n(664);function y(e){for(var t=Object.keys(Object(i.a)()),n=0;n<t.length;n++){var r=t[n],a=Object(i.a)()[r];a&&e.indexOf(a.addinId)<0&&(Object(o.b)(r,null),Object(v.Q)(a.addinId))}}n.d(t,"c",function(){return a}),n.d(t,"g",function(){return o.a}),n.d(t,"a",function(){return s}),n.d(t,"e",function(){return m}),n.d(t,"d",function(){return h}),n.d(t,"b",function(){return g}),n.d(t,"f",function(){return y})},2650:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetClientAccessTokenJsonRequest:#Exchange"},e)}},2693:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(664);function i(e){var t=Object(r.v)("NonPersistent");!t||e&&t.hostItemIndex!==e||Object(r.R)("NonPersistent")}},2694:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s});var r=n(3744),i=n(2823),a=n(3738);function o(e,t){s(Object(r.a)(e),t)}function s(e,t){var n=t?t.addinId:"",r=t?t.commandId:"";Object(i.a)()[e]=t||void 0,Object(a.b)(e,n,r)}},2695:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"InstallExtensionJsonRequest:#Exchange"},e)}},2764:function(e,t,n){"use strict";var r=n(176),i=n(39),a={sets:[{name:"mailbox",maxVersion:"1.6"},{name:"DialogAPI"}]},o="16.01",s=["progress.gif","agavedefaulticon96x96.png","moe_status_icons.png"],l=["moeerrorux.css"],c="resources/images/osfruntime/",u="resources/styles/osfruntime/";function d(e,t,n){t.getLocalizedCSSFilePath=p(l,Object(r.a)()+u),t.getLocalizedImageFilePath=p(s,Object(r.a)()+c),t._notifyHostError=t._notifyHost,t._hostType="Outlook",t._hostPlatform="Web",t._hostSpecificFileVersion=o,t.getRequirementsChecker().setRequirements(a)}function p(e,t){return function(n){var r=e.filter(function(e){return n==e})[0];return(r=function(e){if(!Object(i.o)())return e;switch(e){case"moeerrorux.css":return"moerroruxrtl.css";default:return e}}(r))?t+r:""}}n(2205);var f=n(2150),m=n(664);function h(e,t,n){var r,a,o,s=t.addinCommand,l=t.controlId,c=t.isDialog,u=s.extension.Settings?JSON.parse(s.extension.Settings):{},d=(r=s,a=e,o=Object(f.k)(a),JSON.stringify({userType:Object(f.n)(),userId:Object(i.e)(),extensionType:r.extension.TypeString,module:Object(i.c)(),deployment:Object(i.d)(),scenario:Object(m.u)(a),clientVersion:Object(i.f)(),isPinned:o.isAddinPinned(r.extension.Id),react:!0}));return{div:n,id:l,marketplaceID:c?l:s.get_Id(),marketplaceVersion:s.extension.Version,settings:u,store:"",storeType:OSF.StoreType.Exchange,hostCustomMessage:d,isDialog:c,isVirtualOsfControl:!1}}var g=n(2431),v=n(2143),y=n.n(v);var _=function(e){return function(){window.open(e.extension.EndNodeUrl)}};function C(e){switch(e){case 0:case 3:case 1:return 2;case 2:default:return 0}}var S=n(3314),A=n(3435),b=function(e){return function(t,n){if(t){var r=t.ApiParams,i=k(t.MethodData.ControlId),a=t.MethodData.DispatchId;Object(f.j)(e,a,i,r,n)}}},I=function(e,t,n){Object(g.c)(e,n,t)},O=function(e,t,n){Object(g.f)(n,t)},x=[{name:"GetInitialData",isBlocking:!0,action:b},{name:"executeMethod",isBlocking:!1,action:function(e){return function(t,n){if(t){var r=k(t.DdaMethod.ControlId),i=t.DdaMethod.DispatchId;Object(f.j)(e,i,r,t,n)}}}},{name:"ExecuteMethod",isBlocking:!1,action:b}];function E(e){return[{name:"appCommandInvoked",registerAction:OfficeExt.AddinCommandsRuntimeManager.registerEvent,unregisterAction:OfficeExt.AddinCommandsRuntimeManager.unregisterEvent},{name:"dialogMessageReceived",registerAction:I,unregisterAction:O},{name:"dialogNotificationShown",registerAction:I,unregisterAction:O},{name:"olkItemSelectedChanged",registerAction:I,unregisterAction:O},{name:"olkAppointmentTimeChanged",registerAction:I,unregisterAction:O}]}function T(e,t){x.forEach(function(n){t.registerMethod(n.name,n.action(e),Microsoft.Office.Common.InvokeType.async,n.isBlocking)}),E().forEach(function(e){t.registerEventEx(e.name,e.registerAction,Microsoft.Office.Common.InvokeType.asyncRegisterEvent,e.unregisterAction,Microsoft.Office.Common.InvokeType.asyncUnregisterEvent)})}function M(e,t){x.forEach(function(e){return t.unregisterMethod(e.name)}),E().forEach(function(e){return t.unregisterEvent(e.name)})}function k(e){var t=e.lastIndexOf(A.a);return t>0?e.substring(0,t):e}var P=function(){function e(e,t,n,r,a){var s,l,c=this;this.hostItemIndex=e,this.notifyHost=this.notifyHost.bind(this),this.contextActivationManager=(s=Object(i.i)(),l=this.notifyHost,OSF.AppSpecificSetup._setupFacade=d,new OSF.ContextActivationManager({appName:64,appVersion:o,clientMode:1,appUILocale:s,lcid:s,notifyHost:l,dataLocale:"",hostControl:{},localizedScriptsUrl:OSF.getLocalizedStringsFilePath(),docUrl:""})),this.notifyHostActions=n||{},this.onInsertOsfControlAction=r,this.onDisplayNotificationAction=a,this.manifestCacheProvider=t;var u=this.notifyHostActions[8];this.notifyHostActions[8]=function(e,t){u&&u(e,t),c.notifyHostError(e,t)}}return e.prototype.insertOsfControl=function(e,t){T(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),this.activeOsfControl=e,this.extensionContainer=t,this.manifestCacheProvider.cache(e,Object(i.i)()),this.contextActivationManager.insertOsfControl(h(this.hostItemIndex,this.activeOsfControl,t))},e.prototype.purgeOsfControl=function(){if(this.activeOsfControl&&this.extensionContainer){var e=this.activeOsfControl.controlId;M(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),Object(g.b)(e),this.contextActivationManager.purgeOsfControl(e,!1),this.activeOsfControl=null,this.extensionContainer=null}},e.prototype.onInsertOsfControl=function(){var e=this.activeOsfControl.addinCommand.extension;("User"==e.OriginString||"Organization"==e.OriginString)&&m.h.Context&&m.h.Context.IsInOrgMarketplaceRole&&this.tryDisplayNotification(e.AppStatus,e.LicenseType),this.onInsertOsfControlAction&&this.onInsertOsfControlAction()},e.prototype.notifyAgave=function(e){var t=this.activeOsfControl.controlId;this.contextActivationManager.notifyAgave(t,e)},e.prototype.updateHostItemIndex=function(e){M(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),this.hostItemIndex=e,T(e,this.contextActivationManager._serviceEndPoint)},e.prototype.dispose=function(){this.contextActivationManager.dispose(),this.contextActivationManager=null},e.prototype.notifyHost=function(e,t,n){var r=this.notifyHostActions;if(r){var i=r[t];i&&i(e,n)}},e.prototype.notifyHostError=function(e,t){var n=this.activeOsfControl.addinCommand;Object(S.d)(!1,n,this.hostItemIndex,Object(m.l)(e),t.errorCode)},e.prototype.displayNotification=function(e){this.contextActivationManager.displayNotification(e),this.onDisplayNotificationAction&&this.onDisplayNotificationAction(e)},e.prototype.tryDisplayNotification=function(e,t){var n,r=this.activeOsfControl,i=r.addinCommand,a=r.controlId;if(e){var o=function(e,t,n){var r="",i="",a=!1,o=!1;switch(n){case"1.0":r=y.a.appErrorCode1_0,i=y.a.appErrorCodeUpdateAction,a=!0,o=!0;break;case"1.1":r=y.a.appErrorCode1_1,i=y.a.appErrorCodeUpdateAction,a=!0,o=!0;break;case"1.2":r=y.a.appErrorCode1_2,i=y.a.appErrorCodeUpdateAction,a=!0,o=!0;break;case"2.0":r=y.a.appErrorCode2_0,i=y.a.appErrorCodeUpdateAction;break;case"2.1":r=y.a.appErrorCode2_1,i=y.a.appErrorCodeUpdateAction;break;case"3.0":r=y.a.appErrorCode3_0,i=y.a.appErrorCodeDetailsAction;break;case"3.1":r=y.a.appErrorCode3_1,i=y.a.appErrorCodeDetailsAction;break;case"3.2":r=y.a.appErrorCode3_2,i=y.a.appErrorCodeDetailsAction;break;case"3.3":r=y.a.appErrorCode3_3,i=y.a.appErrorCodeDetailsAction;break;default:return null}return{infoType:1,id:e,title:y.a.appErrorTitle,description:r,buttonTxt:i,buttonCallback:_(t),detailView:a,displayDeactive:o,reDisplay:!0}}(a,i,e);o&&this.displayNotification(o)}else 1==t&&this.displayNotification((n=i,{infoType:2,id:a,title:y.a.appInfoTitle,description:y.a.appTrialMessage,buttonTxt:y.a.appBuyButtonLabel,buttonCallback:function(){window.open(n.extension.EndNodeUrl)},reDisplay:!0}))},e}(),N=n(0),R="permission";var D="DefaultSettings",w="0",F={cache:function(e,t){var n,r,i=e.addinCommand,a=i.extension,o="Preinstalled"===a.TypeString&&2!==a.ConsentState?function(e){var t,n=function(e){switch(e){case 1:return"ReadItem";case 2:return"ReadWriteMailbox";case 3:return"ReadWriteItem";default:return"Restricted"}}(e),r=Object(m.m)().ConsentUrl;if(r.indexOf("?")>0)t=(i=r.split("?"))[0]+"?"+R+"="+n+"&"+i[1];else if(r.indexOf("#")>0){var i;t=(i=r.split("#"))[0]+"?"+R+"="+n+"#"+i[1]}else t=r+"?"+R+"="+n;return t}(a.RequestedCapabilities):i.get_EntryPoint();if(OSF.OsfManifestManager.hasManifest(i.get_Id(),i.extension.Version)){var s=(n=OSF.OsfManifestManager.getCachedManifest(i.get_Id(),i.extension.Version))._extensionSettings[D]._sourceLocations[t];s!==o&&(n._extensionSettings[D]=L(o,t),OSF.OsfManifestManager.cacheManifest(i.get_Id(),i.extension.Version,n))}else r=L(o,t),l=i,c=t,d=(u=r)._sourceLocations[c],n=new OSF.Manifest.Manifest(function(e){e._id=l.get_Id(),e._version=l.extension.Version,e._extensionSettings={},e._displayNames={},e._defaultLocale="",e._displayNames[w]=l.extension.DisplayName,e._extensionSettings[D]=u,e._appDomains=N.__spread(l.extension.AppDomains,[d])}),OSF.OsfManifestManager.cacheManifest(i.get_Id(),i.extension.Version,n);var l,c,u,d}},U={cache:function(e,t){var n=e.addinCommand,r=e.controlId,i=e.sourceLocation,a=(o=n,s=r,l=t,c=i,u=OSF.OsfManifestManager.getCachedManifest(o.get_Id(),o.extension.Version),d=OfficeExt.AddinCommandsManifestManager.createManifestForAddinAction(u,c,null,s),d._extensionSettings={},d._extensionSettings[D]=L(c,l),d);var o,s,l,c,u,d;OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(a,r,n.extension.Version)}};function L(e,t){var n=new OSF.Manifest.ExtensionSettings;return n._sourceLocations={},n._sourceLocations[t]=e,n}n.d(t,"a",function(){return F}),n.d(t,"b",function(){return U}),n.d(t,"d",function(){return C}),n.d(t,"c",function(){return P})},2765:function(e,t,n){"use strict";var r,i=n(2917),a=n(1228),o=n(2693),s=n(3072),l=n(0),c=n(1),u=n(40),d=n(3433),p=n(3073),f=n(2143),m=n.n(f),h=n(670),g=n(14),v=n(4322),y=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.handleRemoveLinkClick=function(e){e.stopPropagation(),e.preventDefault(),r.props.onClickUninstall&&r.props.onClickUninstall(),Object(h.d)()&&Object(p.a)()},r.handleRemoveLinkClick=r.handleRemoveLinkClick.bind(r),r}return l.__extends(t,e),t.prototype.render=function(){return c.createElement("div",{className:v.divContainer},c.createElement("div",null,m.a.gdprMinorWarningText," ",c.createElement("a",{href:"",onClick:this.handleRemoveLinkClick},m.a.gdprMinorRemoveAddinText)))},t=l.__decorate([g.observer],t)}(c.Component),_=n(96),C=n(524),S=n(2764),A=n(1885),b=n(1826),I=n(1926),O=n(2515),x=n(2825),E=(n(2205),n(664)),T=n(4326),M=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.refCallback=r.refCallback.bind(r),r.focusOnAddinBar=r.focusOnAddinBar.bind(r),r.dismissCallout=r.dismissCallout.bind(r),r.getContextualExecutor=r.getContextualExecutor.bind(r),r.convertAddinsToCommandBarItems=r.convertAddinsToCommandBarItems.bind(r),r}return l.__extends(t,e),t.prototype.dismissCallout=function(){Object(E.n)().activeDialog||(Object(E.n)().contextualCalloutState.contextualAnchor.focus(),Object(E.P)())},t.prototype.focusOnAddinBar=function(){this.commandBar.focus()},t.prototype.getContextualExecutor=function(e){return function(){var t=Object(E.n)().runningContextualAddinCommand,n=t.hostItemIndex,r=t.addinCommand;e.get_Id()!==r.get_Id()&&Object(d.a)(n,e)}},t.prototype.convertAddinsToCommandBarItems=function(e,t){var n=this;return e.map(function(e){var r=e.get_Id()===t.get_Id();return{key:e.get_Id(),className:r&&T.selected,text:e.detectedEntity.Label,onClick:n.getContextualExecutor(e)}})},t.prototype.refCallback=function(e){this.commandBar=e},t.prototype.onRenderContextualAddin=function(e){return c.createElement(_.ActionButton,{className:e.className,onClick:e.onClick,text:e.text,ariaLabel:e.text})},t.prototype.onRenderOverflowButton=function(e){return c.createElement(C.IconButton,{menuIconProps:{iconName:"More"},menuProps:{items:e},ariaLabel:m.a.overflowMenuAccessibilityLabel})},t.prototype.render=function(){var e=Object(E.n)();if(!e.runningContextualAddinCommand)return c.createElement("div",null);var t=e.contextualCalloutState.contextualAnchor,n=e.runningContextualAddinCommand,r=n.hostItemIndex,i=n.addinCommand,a=this.convertAddinsToCommandBarItems(e.contextualCalloutState.activeContextualAddinCommands,i),o={height:i.detectedEntity.RequestedHeight?i.detectedEntity.RequestedHeight+"px":"350px"},s={};s[13]=this.focusOnAddinBar,s[14]=this.focusOnAddinBar,s[15]=this.dismissCallout;var l=Object(O.f)(i)?c.createElement(y,{onClickUninstall:this.dismissCallout}):c.createElement(x.a,{addinCommand:e.runningContextualAddinCommand.addinCommand,controlId:e.runningContextualAddinCommand.controlId,hostItemIndex:r,manifestCacheProvider:S.a,style:o,notifyHostActions:s});return c.createElement(A.a,{gapSpace:0,target:t,onDismiss:this.dismissCallout,setInitialFocus:!0,calloutWidth:parseInt("570px"),beakWidth:19,className:T.divContainer},c.createElement(b.a,{className:T.appIcon,iconName:"OfficeAddinsLogo"}),c.createElement("div",{className:T.divider}),c.createElement(I.a,{componentRef:this.refCallback,items:a,className:T.contextualBar,onRenderItem:this.onRenderContextualAddin,onRenderOverflowButton:this.onRenderOverflowButton}),c.createElement("div",{className:T.contextualAddinFrame},l))},t=l.__decorate([g.observer],t)}(c.Component),k=n(3435),P=n(3313),N=n(527),R=n(94),D=n(2431),w=n(4335),F=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.hideDialog=function(){Object(D.f)({eventDispId:D.a.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID,controlId:r.props.controlId})},r}return l.__extends(t,e),t.prototype.render=function(){var e=E.h.activeDialog,t=!1;e&&e.parentControlId==this.props.controlId&&2==e.dialogType&&(t=!0);var n=this.props.addinCommand,r=n.extension.ConsentState,i=n.extension.Type,a=2!=r&&"Preinstalled"==i?w.consentContainer:w.uiLessContainer,o=t?"":w.hiddenContainer;return c.createElement("div",null,c.createElement(N.a,{hidden:!1,onDismiss:this.hideDialog.bind(this),dialogContentProps:{type:R.a.normal,title:n.extension.DisplayName},modalProps:{isBlocking:t,containerClassName:w.dialogContainer,className:o},forceFocusInsideTrap:t,containerClassName:w.dialogContainer,isClickableOutsideFocusTrap:!0},c.createElement("div",{className:a},this.props.children)))},t=l.__decorate([g.observer],t)}(c.Component),U=n(2150),L=n(18),B=n(4337),j=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.addDisplayNotification=r.addDisplayNotification.bind(r),r.addGenericErrorNotification=r.addGenericErrorNotification.bind(r),r.invokeAppCommand=r.invokeAppCommand.bind(r),r.infoBarId=0,r}return l.__extends(t,e),t.prototype.addDisplayNotification=function(e){Object(U.c)(this.props.hostItemIndex,this.props.controlId,!1,""+this.props.addinCommand.get_Id()+this.infoBarId++,Object(S.d)(e.infoType),e.description)},t.prototype.addGenericErrorNotification=function(){var e=Object(L.format)(m.a.officeAddinsNotificationGenericError,this.props.addinCommand.get_ExtensionDisplayName());Object(U.c)(this.props.hostItemIndex,this.props.controlId,!1,this.props.addinCommand.get_Id(),2,e,this.props.addinCommand.get_Size16Icon())},t.prototype.removeProgressNotification=function(){Object(U.p)(this.props.hostItemIndex,this.props.controlId,this.props.addinCommand.get_Id())},t.prototype.addProgressNotification=function(){var e=Object(L.format)(m.a.officeAddinsAutomaticProgressNotificationLabel,this.props.addinCommand.get_ExtensionDisplayName(),this.props.addinCommand.get_Label());Object(U.c)(this.props.hostItemIndex,this.props.controlId,!1,this.props.addinCommand.get_Id(),1,e)},t.prototype.invokeAppCommand=function(){var e=this.props.addinCommand.control,t=e.Action.FunctionName,n={source:{id:e.Id}};this.addProgressNotification(),OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(this.props.controlId,t,n,this.onEventCompleted.bind(this))},t.prototype.onEventCompleted=function(e,t){this.removeProgressNotification();var n=t?t.completedContext:void 0;e!=E.e.Success&&Object(E.A)(this.props.hostItemIndex)&&this.addGenericErrorNotification(),Object(E.S)(this.props.controlId,this.props.hostItemIndex,e,n)},t.prototype.render=function(){var e={};return e[8]=this.addGenericErrorNotification,c.createElement(x.a,{addinCommand:this.props.addinCommand,controlId:this.props.controlId,hostItemIndex:this.props.hostItemIndex,manifestCacheProvider:S.a,onInsertOsfControl:this.invokeAppCommand,onDisplayNotification:this.addDisplayNotification,notifyHostActions:e,className:B.uiLessContainer})},t}(c.Component),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l.__extends(t,e),t.prototype.render=function(){var e=[];return Object(E.n)().runningUILessAddinCommands.forEach(function(t,n){t.forEach(function(t,r){e.push(c.createElement(F,{hostItemIndex:n,controlId:r,addinCommand:t,key:r},c.createElement(j,{addinCommand:t,controlId:r,hostItemIndex:n})))})}),c.createElement("div",null,e)},t=l.__decorate([g.observer],t)}(c.Component);function V(e){r||(r=document.createElement("div"),document.body.appendChild(r),u.render(c.createElement(W,{renderTaskPaneInPanel:e}),r))}var W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l.__extends(t,e),t.prototype.render=function(){return c.createElement("div",null,this.props.renderTaskPaneInPanel&&c.createElement(P.a,{renderTaskPaneInPanel:!0}),c.createElement(H,null),c.createElement(M,null),c.createElement(k.b,null))},t}(c.Component),G=n(3436),q=n(3437),z=n(1635);function X(e){var t,n=e.map(K);return n.push({key:(t=Object(q.a)()).key,name:t.name,itemType:t.itemType,iconProps:t.iconProps}),n}function K(e){return{key:e.Id,name:e.DisplayName,itemType:z.a.Normal,iconProps:Object(G.a)(e.IconUrl)}}n.d(t,"e",function(){return i.a}),n.d(t,"a",function(){return a.a}),n.d(t,"b",function(){return o.a}),n.d(t,"f",function(){return s.a}),n.d(t,"d",function(){return V}),n.d(t,"c",function(){return X})},2768:function(e,t,n){"use strict";var r=n(0),i=function(){function e(e){this.addinFactory=e}return e.prototype.activate=function(e,t){var n=this;return new Promise(function(r,i){var a=[];e.forEach(function(e){var r=n.addinFactory.CreateAddinIfEntryPointSupported(e,t);r&&a.push(r)}),r(a)})},e}(),a=n(2214),o=n(2765),s=n(140);var l=n(664),c=n(2622);function u(e,t){var n=new l.d;return t.activate(e,s.a.AppointmentAttendee).then(function(r){return n.setExtensionPoint(r,s.a.AppointmentAttendee),t.activate(e,s.a.AppointmentOrganizer)}).then(function(r){return n.setExtensionPoint(r,s.a.AppointmentOrganizer),t.activate(e,s.a.DetectedEntity)}).then(function(r){return n.setExtensionPoint(r,s.a.DetectedEntity),t.activate(e,s.a.MessageRead)}).then(function(r){return n.setExtensionPoint(r,s.a.MessageRead),t.activate(e,s.a.MessageCompose)}).then(function(r){return n.setExtensionPoint(r,s.a.MessageCompose),t.activate(e,s.a.MeetingRequest)}).then(function(r){return n.setExtensionPoint(r,s.a.MeetingRequest),t.activate(e,s.a.TrapOnSendEvent)}).then(function(e){n.setExtensionPoint(e,s.a.TrapOnSendEvent)}).then(function(){var t,r;n.isInitialized=!0,Object(l.J)(n),t=n,r={},[s.a.MessageRead,s.a.MessageCompose,s.a.AppointmentAttendee,s.a.AppointmentOrganizer].forEach(function(e){var n=t.getExtensionPoint(e);r[e]=Object(o.c)(n)}),a.j.importAndExecute(r);var i=e.map(function(e){return e.Id});Object(c.f)(i)})}var d=n(3075),p=n(670),f=n(7);n.d(t,"a",function(){return h});var m=!1;function h(){var e=this;return new Promise(function(t,n){return r.__awaiter(e,void 0,void 0,function(){var e,n,a;return r.__generator(this,function(r){switch(r.label){case 0:if((m||Object(l.C)())&&!Object(l.D)())return Object(l.ab)(t),[2];Object(l.L)(!1),g(!0),[],e=new i(new l.c(new l.b)),n=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(d.a)()];case 2:return n=r.sent(),[3,4];case 3:return a=r.sent(),f.c.error(a),[3,4];case 4:return Object(l.K)(n),Object(p.c)()&&Object(l.H)(n.GenericInfo),[4,u((o=n)&&o.Extensions?o.Extensions.filter(function(e){return e.Enabled&&null!=e.ExtensionPointCollection}):[],e)];case 5:return r.sent(),g(!1),t(),[2]}var o})})})}function g(e){m=e}},2776:function(e,t,n){"use strict";var r=n(0),i=n(1227),a=n(1205),o=n(4289),s=n.n(o),l=n(4291),c=n.n(l),u=n(30);var d=n(2069),p=n(1217);function f(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,o,l,f;return r.__generator(this,function(r){switch(r.label){case 0:if(n=Object(d.c)(e),!(o={Id:n.getItemId()}).Id)throw new i.a(a.b.CannotPersistPropertyInUnsavedDraftError);return l=Object(p.d)(e,t),f=Object.keys(l).map(function(e){var t=l[e];return{Key:t.Key,Type:t.Type,Message:t.Message,Icon:t.Icon}}),[4,(m=t,h=o,g=f,v=c()({ItemId:h,Id:m,Notifications:g}),s()({Header:Object(u.getJsonRequestHeader)(),Body:v})).catch(function(e){throw new i.a(a.b.PersistedNotificationArraySaveError)})];case 1:return r.sent(),[2]}var m,h,g,v})})}n.d(t,"a",function(){return f})},2823:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r={};function i(){return r}},2824:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),i=n(2695);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("InstallExtension",e,t)}},2825:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),i=n(1),a=n(670),o=n(2764),s=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.refCallback=function(e){e&&(r.extensionContainer=e,r.osfControlAdapter.insertOsfControl(r.props,r.extensionContainer))},r.handlerContainerOnFocus=function(){r.notifyAgave(11)},r.osfControlAdapter=r.props.osfControlAdapter?r.props.osfControlAdapter:new o.c(t.hostItemIndex,t.manifestCacheProvider,t.notifyHostActions,t.onInsertOsfControl,t.onDisplayNotification),r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.osfControlAdapter.onInsertOsfControl()},t.prototype.componentWillReceiveProps=function(e){Object(a.e)()&&this.isNewHostItemIndex(e)&&this.osfControlAdapter.updateHostItemIndex(e.hostItemIndex)},t.prototype.shouldComponentUpdate=function(e){return this.isNewOsfControl(e)},t.prototype.componentWillUpdate=function(){this.osfControlAdapter.purgeOsfControl()},t.prototype.componentDidUpdate=function(){this.osfControlAdapter.onInsertOsfControl()},t.prototype.componentWillUnmount=function(){this.osfControlAdapter.purgeOsfControl(),this.osfControlAdapter.dispose(),this.osfControlAdapter=null},t.prototype.notifyAgave=function(e){this.osfControlAdapter.notifyAgave(e)},t.prototype.isNewOsfControl=function(e){return this.props.controlId!=e.controlId},t.prototype.isNewHostItemIndex=function(e){return this.props.hostItemIndex!=e.hostItemIndex},t.prototype.render=function(){return this.extensionContainer&&this.osfControlAdapter.insertOsfControl(this.props,this.extensionContainer),i.createElement("div",{tabIndex:0,ref:this.refCallback,style:this.props.style,className:this.props.className,onFocus:this.handlerContainerOnFocus})},t}(i.Component)},2917:function(e,t,n){"use strict";var r=n(2150),i=n(2515),a=n(2622),o=n(664);function s(e,t){var n=Object(r.k)(e);if(n){var s=n.mode,l=Object(a.c)(s);if(l){var c=Object(i.c)(l.addinId,l.commandId,s);if(c&&!Object(i.f)(c)){var u=Object(o.s)(2);Object(o.M)(u,e,c,"Persistent",s,t)}else!c&&Object(o.C)()&&Object(a.g)(s,null)}}}var l=n(140),c={hostItemIndex:null,mode:l.a.Unknown,isNullSent:!1};function u(){return c}function d(e){c=e}function p(e){switch(Object(r.k)(e).mode){case l.a.MessageRead:case l.a.MeetingRequest:return l.a.MessageRead;case l.a.MessageCompose:return l.a.MessageCompose;default:return l.a.Unknown}}function f(){Object(o.R)("Persistent"),d({hostItemIndex:null,mode:l.a.Unknown,isNullSent:!1})}var m=n(0),h=n(2431);function g(e){var t,n=u();n.mode!==l.a.MessageCompose&&n.mode!==l.a.Unknown?(Object(o.Y)(e),n.isNullSent||((t=Object(o.v)("Persistent"))&&Object(h.d)(h.a.ITEM_CHANGED_EVENT_DISPID,t.controlId,null),d({hostItemIndex:null,mode:l.a.MessageRead,isNullSent:!0}))):f()}var v=n(1240);function y(e){Object(v.a)(0),Object(o.v)("Persistent")?(Object(o.Z)(e),function(e){m.__awaiter(this,void 0,void 0,function(){var t,n;return m.__generator(this,function(i){switch(i.label){case 0:return(t=Object(o.v)("Persistent"))?[4,Object(r.a)(t.controlId,e)]:[3,2];case 1:n=i.sent(),Object(h.d)(h.a.ITEM_CHANGED_EVENT_DISPID,t.controlId,n),i.label=2;case 2:return[2]}})})}(e)):s(e),d({hostItemIndex:e,mode:p(e),isNullSent:!1})}var _=n(670),C=n(1228);function S(e,t){var n,i,c,m,h,v,S,A;if(Object(_.e)())switch(e){case C.a.NotSupported:f();break;case C.a.Empty:g(1);break;case C.a.Multi:g(2);break;case C.a.Single:t&&(n=t,Object(r.h)(n)&&Object(o.C)()&&Object(a.d)()&&(S=n,(A=Object(r.k)(S)).mode!==l.a.MessageRead||!A.isInlineComposeOpen())&&(h=n,(v=Object(r.k)(h)).mode!==l.a.MessageRead||v.isItemSelected())&&n!==u().hostItemIndex&&(c=n,(m=Object(r.k)(c)).mode!==l.a.MessageRead||Object(o.O)(m.getItem())?p(n)!==u().mode?(i=n,Object(o.R)("Persistent"),s(i),d({hostItemIndex:i,mode:p(i),isNullSent:!1})):y(n):g(3)))}}n.d(t,"a",function(){return S})},3072:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(2693),i=n(2150),a=n(2622),o=n(664);function s(e,t,n,s){Object(r.a)(e);var l=Object(o.v)("Persistent");if(!(l&&(c=l.addinCommand,u=t,c&&u&&c.get_Id()===u.get_Id()))){var c,u,d=Object(i.k)(e);d.openTaskPane&&d.openTaskPane();var p=Object(o.s)(2);Object(o.M)(p,e,t,function(e,t){var n=Object(a.c)(t);if(!n)return"NonPersistent";var r=n.addinId,i=n.commandId;return e.get_Id()===""+r+i?"Persistent":"NonPersistent"}(t,n),n,s)}}},3073:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r,i=n(1),a=n(40),o=n(3074),s=n(3310);function l(){Object(s.a)().then(function(e){var t=e,n=i.createElement(o.a,{storeUrl:t});a.render(n,r).setPanelOpen()})}r=document.createElement("div"),document.body.appendChild(r)},3074:function(e,t,n){"use strict";var r=n(0),i=n(1),a=n(1238),o=n(10),s=n.n(o),l=n(524),c=n(670),u=n(401),d=n(3740),p=n(1900),f=n(4311),m=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isPanelOpen:!0},n}return r.__extends(t,e),t.prototype.setPanelOpen=function(){this.setState({isPanelOpen:!0})},t.prototype.openSendFeedbackCompose=function(){a.a.sendFeedback()},t.prototype.render=function(){var e=this;return Object(c.b)("addin-centerAlignedICSEnabled")?i.createElement(u.a,{isOpen:this.state.isPanelOpen,onDismiss:function(){return e.setState({isPanelOpen:!1})}},i.createElement("div",{className:f.container},i.createElement(l.IconButton,{className:f.closeButton,onClick:function(){e.setState({isPanelOpen:!1})},iconProps:{iconName:"Cancel"}}),i.createElement("iframe",{src:this.props.storeUrl,title:"",className:f.inClientStoreIFrameCenter,frameBorder:0})),Object(c.b)("addin-inClientStoreSendFeedbackEnabled")&&i.createElement("div",{className:f.FeedbackCommandBarCenter},i.createElement("div",{onClick:this.openSendFeedbackCompose},s.a.sendFeedback))):i.createElement(d.a,{isOpen:this.state.isPanelOpen,type:p.a.largeFixed,isLightDismiss:!0,focusTrapZoneProps:{forceFocusInsideTrap:!1},onDismiss:function(){return e.setState({isPanelOpen:!1})},className:f.inClientStorePanelContainer},i.createElement("iframe",{src:this.props.storeUrl,title:"",className:f.inClientStoreIFrame,frameBorder:0}),Object(c.b)("addin-inClientStoreSendFeedbackEnabled")&&i.createElement("div",{className:f.FeedbackCommandBar},i.createElement("div",{onClick:this.openSendFeedbackCompose},s.a.sendFeedback)))},t}(i.Component);t.a=m},3075:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var r=n(0),i=n(2150),a=n(39),o=3,s=3e3,l=3,c=!0,u="1.6",d="1.1";function p(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,(r=e==o?0:s,new Promise(function(e,t){setTimeout(function(){e()},r)}))];case 1:return n.sent(),[4,Object(i.m)(l,Object(a.l)(),c,u,d)];case 2:return[2,n.sent()];case 3:if(t=n.sent(),0==e)throw t;return[3,4];case 4:return[4,p(--e)];case 5:return[2,n.sent()]}var r})})}function f(){return p(o)}},3076:function(e,t,n){var r=n(4330),i=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},317:function(e,t,n){"use strict";var r=n(72),i=(function(){}(),n(2)),a=n(28),o=n(941),s=n(598),l=n(20),c=n(3),u=[r.a.SurfaceActions];Object(c.mutator)(o.a,function(e){var t=e.defaultOptions;u.forEach(function(e){t[e]&&Object(l.extendObservable)(s.a.options[e],t[e])})});var d=n(935),p=n(596);n.d(t,"d",function(){return m}),n.d(t,"g",function(){return h}),n.d(t,"e",function(){return g}),n.d(t,"f",function(){return v}),n.d(t,"c",function(){return d.a}),n.d(t,"b",function(){return p.a}),n.d(t,"a",function(){return r.a});var f=new i.c(function(){return n.e(101).then(n.bind(null,5643))}),m=new i.a(f,function(e){return e.createOrUpdateOptionsForFeature}),h=new i.a(f,function(e){return e.updateAddinPinStatus}),g=new i.b(f,function(e){return e.getServerOptionsForFeature}),v=new i.a(f,function(e){return e.loadOptions});Object(a.c)(function(){v.importAndExecute()})},3310:function(e,t,n){"use strict";n(2205);var r=n(2250),i=n(2312),a=n(2695),o=n.n(a),s=n(2824),l=n.n(s),c=n(39),u=n(517),d=n(670),p=n(2416),f=n(9),m=n(664);function h(e){e.registerMethod("InstallOutlookWebExt",function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:e[1],MarketplaceContentMarket:e[0],Client:"WAC_Outlook",ClientVersion:Object(c.f)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:null},n={Header:Object(u.getJsonRequestHeader)(i.f()),Body:t};Object(d.f)()&&Object(f.n)("InClientStorePinnableExperienceShown",{assetId:e[1]});var a=o()(n),s=Object(r.b)();return l()(a,s)})(e).then(function(n){if("Error"==n.Body.ResponseClass.toString())t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1);else{var r=n.Body.Extension?n.Body.Extension.MarketplaceAssetID:e[1],i=!!n.Body.WasFirstInstall;t([r,i],0)}Object(p.b)().then(function(e){Object(m.K)(e),Object(m.L)(!0)})})},Microsoft.Office.Common.InvokeType.async,!1)}var g=n(6),v=n(87),y=n(8);var _=n(4313),C=n.n(_),S=n(4314),A=n.n(S);function b(e){e.registerMethod("DisableOutlookWebExt",function(e,t){var n,a,o,s,l;(n=e,a={__type:"DisableAppRequest:#Exchange",ID:n.toString(),DisableReason:"NoReason"},o={Header:Object(u.getJsonRequestHeader)(i.f()),Body:a},s=C()(o),l=Object(r.b)(),A()(s,l)).then(function(n){"Error"==n.Body.ResponseClass.toString()?t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1):t([e.toString()],0),Object(p.b)().then(function(e){Object(m.K)(e),Object(m.L)(!0)})})},Microsoft.Office.Common.InvokeType.async,!1)}var I=n(4316),O=n.n(I),x=n(4317),E=n.n(x);function T(e){e.registerMethod("UninstallOutlookWebExt",function(e,t){var n,a,o,s,l;(n=e,a={__type:"UninstallAppRequest:#Exchange",ID:n.toString()},o={Header:Object(u.getJsonRequestHeader)(i.f()),Body:a},s=O()(o),l=Object(r.b)(),E()(s,l)).then(function(n){"Error"==n.Body.ResponseClass.toString()?t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1):(t([e.toString()],0),Object(p.b)().then(function(e){Object(m.K)(e),Object(m.L)(!0)}))})},Microsoft.Office.Common.InvokeType.async,!1)}function M(e){e.registerMethod("InstallOutlookWebExtByManifest",function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(c.f)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:e[0],Id:null};t.Manifest=i.b(t.Manifest);var n={Header:Object(u.getJsonRequestHeader)(i.f()),Body:t},a=o()(n),s=Object(r.b)();return l()(a,s)})(e).then(function(e){"Error"==e.Body.ResponseClass.toString()?t([e.Body.MessageText.toString(),e.Body.ResponseCode.toString()],-1):(t([!!e.Body.WasFirstInstall,e.Body.Extension?e.Body.Extension.Id:null,e.Body.Extension?e.Body.Extension.Enabled.toString():"false",e.Body.Extension?e.Body.Extension.ConsentState.toString():null,e.Body.Extension?e.Body.Extension.TypeString.toString():null,e.Body.Extension?e.Body.Extension.LicenseStatus.toString():null,e.Body.Extension?e.Body.Extension.TrialExpirationDate:null,e.Body.Extension?e.Body.Extension.Description:null,e.Body.Extension?e.Body.Extension.ProviderName:null,e.Body.Extension?e.Body.Extension.IconUrl:null,e.Body.Extension?e.Body.Extension.HighResolutionIconUrl:null,e.Body.Extension?e.Body.Extension.DisplayName:null,e.Body.Extension?e.Body.Extension.Requirements.toString():null,e.Body.Extension?e.Body.Extension.Version:null],0),Object(p.b)().then(function(e){Object(m.K)(e),Object(m.L)(!0)}))})},Microsoft.Office.Common.InvokeType.async,!1)}function k(e){e.registerMethod("InstallOutlookWebExtByManifestUrl",function(e,t){var n,a,s,d,f;(n=e,a={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(c.f)(),SendWelcomeEmail:!0,ManifestUrl:n[0],Manifest:null,Id:null},s={Header:Object(u.getJsonRequestHeader)(i.f()),Body:a},d=o()(s),f=Object(r.b)(),l()(d,f)).then(function(e){"Error"==e.Body.ResponseClass.toString()?t([e.Body.MessageText.toString(),e.Body.ResponseCode.toString()],-1):(t([!!e.Body.WasFirstInstall,e.Body.Extension?e.Body.Extension.Id:null,!!e.Body.Extension&&e.Body.Extension.Enabled.toString(),e.Body.Extension?e.Body.Extension.ConsentState.toString():null,e.Body.Extension?e.Body.Extension.TypeString.toString():null,e.Body.Extension?e.Body.Extension.LicenseStatus.toString():null,e.Body.Extension?e.Body.Extension.TrialExpirationDate:null,e.Body.Extension?e.Body.Extension.Description:null,e.Body.Extension?e.Body.Extension.ProviderName:null,e.Body.Extension?e.Body.Extension.IconUrl:null,e.Body.Extension?e.Body.Extension.HighResolutionIconUrl:null,e.Body.Extension?e.Body.Extension.DisplayName:null,e.Body.Extension?e.Body.Extension.Requirements.toString():null,e.Body.Extension?e.Body.Extension.Version:null],0),Object(p.b)().then(function(e){Object(m.K)(e),Object(m.L)(!0)}))})},Microsoft.Office.Common.InvokeType.async,!1)}function P(e){e.registerMethod("InstallOutlookWebExtByProductId",function(e,t){var n,a,s,d,f;(n=e,a={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(c.f)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:null,Id:n},s={Header:Object(u.getJsonRequestHeader)(i.f()),Body:a},d=o()(s),f=Object(r.b)(),l()(d,f)).then(function(n){if("Error"==n.Body.ResponseClass.toString())t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1);else{t([e,!1],0)}Object(p.b)().then(function(e){Object(m.K)(e),Object(m.L)(!0)})})},Microsoft.Office.Common.InvokeType.async,!1)}var N=n(4319),R=n.n(N),D=n(4320),w=n.n(D);function F(e){e.registerMethod("EnableApp",function(e,t){var n,a,o,s,l;(n=e,a={DisplayName:n[0],RawIdentity:n[1]},o={Header:Object(u.getJsonRequestHeader)(i.f()),Identity:a},s=R()(o),l=Object(r.b)(),w()(s,l)).then(function(e){t([e.WasSuccessful],0),Object(p.b)().then(function(e){Object(m.K)(e),Object(m.L)(!0)})}).catch(function(e){e.ErrorMessage?t([e.ErrorMessage],-1):t([],-1)})},Microsoft.Office.Common.InvokeType.async,!1)}var U=n(317);function L(e,t){e.registerMethod("GetTelemetryInfoFromOutlook",function(e,t){var n=Object(m.m)(),r=Object(g.a)(),a=!r.SessionSettings.IsSPOnPrem,o=Object(y.c)("doc-consumerUrl"),s=a?o?"Consumer":"Business":"OnPremise";t([Object(v.b)(),r.SessionSettings.UserCulture,"16.2130.0.9999",i.c(),s,a,o,n.MarketplaceUrl,r.SessionSettings.ExternalDirectoryUserGuid,r.SessionSettings.OrganizationDomain,i.e(),"other","OWA_REACT",n.GenericInfo],0)},Microsoft.Office.Common.InvokeType.async,!1),e.registerMethod("GetAllInstalledAddIns",function(e,t){var n=[];Object(m.m)().Extensions.forEach(function(e){"Private"!==e.TypeString&&"Default"!==e.TypeString&&n.push([e.Id,e.MarketplaceAssetID,e.Enabled.toString(),Object(r.e)(e.ConsentState),e.TypeString,e.LicenseStatus.toString(),e.TrialExpirationDate,e.IsMandatory.toString(),e.OriginString])}),t(n,0)},Microsoft.Office.Common.InvokeType.async,!1),e.registerMethod("GetAllPrivateAddIns",function(e,t){var n=[];Object(m.m)().Extensions.forEach(function(e){("Private"===e.TypeString||Object(d.b)("addin-inClientStoreDefaultAddinsEnabled")&&"Default"===e.TypeString)&&n.push([e.Id,e.Enabled.toString(),Object(r.e)(e.ConsentState),e.TypeString.toString(),e.LicenseStatus.toString(),e.TrialExpirationDate,e.Description,e.ProviderName,e.IconUrl,e.HighResolutionIconUrl,e.DisplayName,e.RequestedCapabilities.toString(),e.Version,e.OriginString,e.IsMandatory.toString()])}),t(n,0)},Microsoft.Office.Common.InvokeType.async,!1),h(e),b(e),T(e),M(e),k(e),P(e),F(e),e.registerMethod("LaunchUrl",function(e){var t=e;return window.open(t),null},Microsoft.Office.Common.InvokeType.sync,!1),e.registerMethod("UpdateAddinPinOptions",function(e){var t={readMode:e[2],composeMode:e[3],calendarMode:e[4]};U.g.importAndExecute(e[0],e[1],t),Object(f.n)(e[1]?"AddinPinned":"AddinUnpinned",{productId:e[0],readMode:e[2],composeMode:e[3],calendarMode:e[4]})},Microsoft.Office.Common.InvokeType.async,!1),e.registerConversation(r.d(),t,null,null)}t.a=function(){var e=r.c();return Object(p.a)().then(function(){var t=r.a();return L(e,t),t})}},3313:function(e,t,n){"use strict";var r=n(0),i=n(1),a=n(2580),o=n(2143),s=n.n(o),l=n(1826),c=n(4328),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.getErrorText(this.props.errorType);return i.createElement("div",{className:c.errorContainer},i.createElement("div",{className:c.errorContent},i.createElement(l.a,{className:c.errorIcon,iconName:"OfficeAddinsLogo"}),i.createElement("span",{className:a([c.errorTextCommon,c.errorTextTitle])},e.title),i.createElement("span",{className:a([c.errorTextCommon,c.errorTextDescription])},e.description)))},t.prototype.getErrorText=function(e){switch(e){case 1:return{title:s.a.taskPaneErrorNoItemSelected,description:s.a.taskPaneErrorNoItemSelectedDescription};case 2:return{title:s.a.taskPaneErrorMultipleItemsSelected,description:s.a.taskPaneErrorMultipleItemsSelectedDescription};case 3:return{title:s.a.taskPaneErrorAddinsNotSupported,description:s.a.taskPaneErrorAddinsNotSupportedDescription};default:return{title:null,description:null}}},t}(i.Component),d=n(1588),p=n(1587),f=n(1823),m=n(14),h=n(3076),g=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasLoadFailed:!1},n}return r.__extends(t,e),t.prototype.onLoadingStateChanged=function(e){e==p.c.error?this.setState({hasLoadFailed:!0}):this.setState({hasLoadFailed:!1})},t.prototype.render=function(){return this.state.hasLoadFailed?i.createElement(l.a,{iconName:"Photo2",iconType:d.a.default,className:a([h.fallbackIcon,this.props.className])}):i.createElement(f.a,{onLoadingStateChange:this.onLoadingStateChanged.bind(this),src:this.props.src,width:this.props.width,height:this.props.height,imageFit:p.b.contain,className:this.props.className})},t=r.__decorate([m.observer],t)}(i.Component),v=n(18),y=n(524),_=n(3076),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.getPersistButtonIcon(),t=this.getPersistButtonText();return i.createElement(y.IconButton,{className:_.persistIcon,onClick:this.props.togglePersist,title:t,ariaLabel:t,iconProps:{iconName:e}})},t.prototype.getPersistButtonText=function(){var e=this.props.isPersisted?s.a.taskPaneUnpinButtonLabel:s.a.taskPanePinButtonLabel;return Object(v.format)(e,this.props.displayName)},t.prototype.getPersistButtonIcon=function(){return this.props.isPersisted?"Pinned":"Pin"},t}(i.Component),S=n(670),A=n(3076),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.focusCloseButton=function(){this.closeButton&&this.closeButton.focus()},t.prototype.render=function(){var e=this,t=this.props.isCalendar;return i.createElement("div",{className:a(A.addinPaneHeader,t&&A.addinPaneHeaderCalendar)},i.createElement(g,{src:this.props.iconUrl,width:32,height:32,className:A.addinPaneIcon}),i.createElement("div",{className:a([A.addinPaneLabelText,A.ellipsis])},this.props.displayName),i.createElement("div",{className:A.rightButtons},Object(S.e)()&&this.props.isPersistable&&!t&&i.createElement(C,{displayName:this.props.displayName,isPersisted:this.props.isPersisted,togglePersist:this.props.togglePersist}),i.createElement(y.IconButton,{componentRef:function(t){return e.closeButton=t},className:A.closeButton,onClick:this.props.closeOnClick,ariaLabel:s.a.taskPaneCloseButtonAriaLabel,iconProps:{iconName:"Cancel"}})))},t}(i.Component),I=n(2764),O=n(402),x=n(3740),E=n(4331),T=function(e){return e.renderInPanel?i.createElement(x.a,{focusTrapZoneProps:{forceFocusInsideTrap:!1,disableFirstFocus:e.disableFirstFocus,isClickableOutsideFocusTrap:!0},hasCloseButton:!1,isOpen:!0,onDismiss:e.onDismiss,className:a(E.taskPane,e.isDeepLink&&E.taskPaneNoHeader),isBlocking:!1,isFooterAtBottom:!0,isLightDismiss:!0},e.children):i.createElement(O.a,{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,className:E.taskPane},e.children)},M=n(2150),k=n(140),P=n(1235),N=n(2825),R=(n(2205),n(664)),D=n(2622),w=n(4333),F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.focusTaskPaneHeader=function(){t.taskPaneHeader&&t.taskPaneHeader.focusCloseButton()},t.renderError=function(){var e=t.props.instance.errorType;return t.hasError()&&i.createElement(u,{errorType:e})},t.renderOsfHostContainer=function(){var e=t.props.instance,n=e.hostItemIndex,r=e.controlId,o=e.addinCommand,s={};return s[15]=t.focusTaskPaneHeader,s[14]=t.focusTaskPaneHeader,s[13]=t.focusTaskPaneHeader,i.createElement(N.a,{addinCommand:o,controlId:r,className:a([w.extensionHost,t.hasError()&&w.hide]),hostItemIndex:n,manifestCacheProvider:I.a,notifyHostActions:s})},t.hasError=function(){return 0!==t.props.instance.errorType},t.close=function(){var e=t.props.instance,n=e.mode,r=e.controlId;t.isPersisted()&&Object(D.g)(n,null),Object(M.d)(r)},t.togglePersist=function(){var e=t.isPersisted()?null:Object(D.b)(t.props.instance.addinCommand);Object(D.g)(t.props.instance.mode,e),Object(R.T)(t.props.type)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.instance,n=void 0===this.props.renderInPanel||this.props.renderInPanel;if(!t)return i.createElement("div",{className:w.divContainer});var r=t.addinCommand;return i.createElement(T,{renderInPanel:n,onDismiss:this.close,isDeepLink:Object(P.b)(),disableFirstFocus:this.isPersisted()},i.createElement(b,{iconUrl:r.extension.IconUrl,displayName:r.extension.DisplayName,closeOnClick:this.close,ref:function(t){return e.taskPaneHeader=t},isCalendar:this.isCalendar(),isPersistable:this.supportsPersisted(),isPersisted:this.isPersisted(),togglePersist:this.togglePersist}),i.createElement("div",{tabIndex:0,className:a(w.extensionContainer,this.isCalendar()&&w.extensionContainerCalendar),"aria-label":Object(v.format)(s.a.extensionContainerAriaLabel,r.extension.DisplayName),role:"complementary"},this.renderError(),this.renderOsfHostContainer()))},t.prototype.supportsPersisted=function(){return Object(D.a)(this.props.instance.addinCommand)},t.prototype.isCalendar=function(){return this.props.instance.mode===k.a.AppointmentAttendee||this.props.instance.mode===k.a.AppointmentOrganizer},t.prototype.isPersisted=function(){return"Persistent"===this.props.type},t=r.__decorate([m.observer],t)}(i.Component),U=n(1321),L=n(1242),B=n(246),j="addinTaskPane";var H=n(39),V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidUpdate=function(){if("Mail"===Object(H.c)()){var e=Object(R.n)().taskPanes;!this.previousTaskPanesSize&&e.size?(Object(U.a)(j,!0,!1),B.c.importAndExecute(),L.a.importAndExecute()):this.previousTaskPanesSize&&!e.size&&(Object(U.a)(j,!1,!1),B.c.importAndExecute()),this.previousTaskPanesSize=e.size}},t.prototype.renderTaskPane=function(e){var t=Object(R.v)(e);return t&&i.createElement(F,{key:t.controlId,type:e,instance:t,renderInPanel:this.props.renderTaskPaneInPanel})},t.prototype.render=function(){var e=Object(S.e)()&&this.renderTaskPane("Persistent"),t=this.renderTaskPane("NonPersistent");return i.createElement(i.Fragment,null,[e,t])},t=r.__decorate([m.observer],t)}(i.Component);t.a=V},3314:function(e,t,n){"use strict";var r={ExtAddinLaunched:{datapoint:{name:"ExtAddinLaunched",customData:function(e,t,n,r,i,a,o,s){return{id:e,name:t,owa_1:n,owa_2:r,owa_3:i,owa_4:o,lang:a,errorCode:s}}}},ExtItemSendEvent:{datapoint:{name:"ExtItemSendEvent",customData:function(e,t,n,r){return{owa_1:e,owa_2:r,id:t,name:n}}}}};var i,a,o=function(){return{tenantTokens:["56468f6991c348029c6bba403b444607-7f5d6cd1-7fbe-4ab1-be03-3b2b6aeb3eb4-7696"]}},s=n(9),l=n(39),c=n(670),u=n(664),d=function(e,t,n,i,a){if(Object(c.b)("addin-launchDatapoint")){var d=r.ExtAddinLaunched.datapoint,p=d.customData,f=d.name,m=new s.c(f,o());m.addCustomData(p(t.extension.Id,t.extension.DisplayName,Object(l.c)(),Object(u.u)(n),i,Object(l.i)(),t.extension.Type,a)),e?m.end():m.endWithError(s.a.Timeout,new Error("Add-in failed to load with code: "+a))}},p=9e5;function f(){var e=r.ExtItemSendEvent.datapoint.name;return o().timeout=p,new s.c(e)}function m(e,t){var n=r.ExtItemSendEvent.datapoint.customData;e.addCustomData(n(t)),e.end()}function h(e,t,n){var i=r.ExtItemSendEvent.datapoint.customData;e.addCustomData(i(function(e){if(e.status===u.e.Success)return e.allowEvent?4:2;switch(e.status){case u.e.TimedOut:return 16;case u.e.FunctionNotFound:return 8;default:return 32}}(t),n.extension.Id,n.extension.DisplayName,Object(l.c)())),e.end()}(a=i||(i={}))[a.ExtensibilityUnavailable=1]="ExtensibilityUnavailable",a[a.AllowEventFalse=2]="AllowEventFalse",a[a.AllowEventTrue=4]="AllowEventTrue",a[a.FunctionNotFound=8]="FunctionNotFound",a[a.FunctionTimedOut=16]="FunctionTimedOut",a[a.Unknown=32]="Unknown",n.d(t,"d",function(){return d}),n.d(t,"a",function(){return f}),n.d(t,"b",function(){return h}),n.d(t,"c",function(){return m})},3327:function(e,t,n){"use strict";var r=n(0),i=n(2431),a=n(664),o=function(e){Object(a.n)().activeDialog&&Object(a.n)().activeDialog.parentControlId==e&&Object(i.f)({eventDispId:i.a.DISPLAY_DIALOG_DISPID,controlId:e})};function s(e){Object(a.n)().runningUILessAddinCommands.has(e)&&r.__spread(Object(a.n)().runningUILessAddinCommands.get(e).keys()).forEach(function(t,n){var r,i,s;r=t,i=e,s=a.e.NavigatedBeforeCompleted,o(r),Object(a.S)(r,i,s)})}function l(e){s(e)}n.d(t,"a",function(){return l})},3433:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(664);function i(e,t){var n=Object(r.s)(1);Object(r.I)(n,e,t)}},3434:function(e,t,n){e.exports=n.p+"../resources/images/progress-e4ba8e5c7eb8b6080aadb62c29bbf737.gif"},3435:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n(0),i=n(1),a=n(2143),o=n.n(a),s=n(527),l=n(94),c=n(2764),u=n(14),d=n(2825),p=n(2431),f=(n(2205),n(664)),m=n(4324),h=":Dialog",g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.hideDialog=function(e){Object(p.f)({eventDispId:p.a.DISPLAY_DIALOG_DISPID,controlId:e})},t.prototype.render=function(){var e=Object(f.n)().activeDialog;if(!e)return i.createElement("div",{className:m.divContainer});if(e.isOpen&&1==e.dialogType){var t=Object(f.i)(e.parentControlId),n=t.extension.DisplayName,r={height:e.heightInPercentage+"vh",width:e.widthInPercentage+"vw",overflow:"hidden"},a=o.a.iFrameableDialogCloseButtonAccessibilityLabel;a&&(a=a.replace("{0}",n));var u={};return u[15]=this.hideDialog,i.createElement(s.a,{hidden:!e.isOpen,onDismiss:this.hideDialog.bind(this,e.parentControlId),dialogContentProps:{type:l.a.close,title:n,closeButtonAriaLabel:a},modalProps:{isBlocking:!0,containerClassName:m.dialogContainer},forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0},i.createElement(d.a,{addinCommand:t,controlId:e.parentControlId+h,isDialog:!0,hostItemIndex:e.hostItemIndex,sourceLocation:e.url,manifestCacheProvider:c.b,notifyHostActions:u,style:r}))}return i.createElement("div",{className:m.divContainer})},t=r.__decorate([u.observer],t)}(i.Component);t.b=g},3436:function(e,t,n){"use strict";var r=n(1),i=n(1588),a=n(1826),o=n(1587),s=n(4339);t.a=function(e){return{iconType:i.a.Image,imageProps:{src:e,width:16,height:16,imageFit:o.b.contain,shouldFadeIn:!1},styles:{root:{width:"16px !important",height:"16px !important"}},imageErrorAs:function(e){return r.createElement(a.a,{className:s.fallbackIcon,iconName:"Photo2",iconType:i.a.Default})}}}},3437:function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"b",function(){return c});var r=n(3073),i=n(11),a=n.n(i),o=n(1588),s=n(1635);function l(){return{key:"AddinMarketplace",name:a.a.manageAddins,title:a.a.manageAddins,ariaLabel:a.a.manageAddins,iconProps:{iconName:"AddIn",iconType:o.a.default},itemType:s.a.Normal,onClick:function(){Object(r.a)()}}}function c(){return{key:"AddinMarketplaceDivider",displayName:"-",itemType:s.a.Divider,iconProps:{iconName:"AddIn",iconType:o.a.default},onClick:null}}},369:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return o}),n.d(t,"h",function(){return s}),n.d(t,"g",function(){return l}),n.d(t,"f",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"e",function(){return d}),n.d(t,"a",function(){return p});var r=n(0),i=n(210),a="deeplink",o="compose",s="reply",l="replyall",c="read",u="group",d="/"+r.__spread(["mail"],Object(i.a)().split("/").slice(1)).join("/")+a+"/",p="/"+r.__spread(["calendar"],Object(i.a)().split("/").slice(1)).join("/")+a+"/"},3738:function(e,t,n){"use strict";var r=n(104),i=n(81),a="/ows/api/beta/PersistedAddins";function o(e,t,n){var o=Object(r.getGuid)();Object(i.d)(a,{Addin:{mode:e,addinId:t,commandId:n}},o)}var s=n(0),l=n(337);function c(){return s.__awaiter(this,void 0,void 0,function(){var e,t;return s.__generator(this,function(n){switch(n.label){case 0:return e=Object(r.getGuid)(),[4,Object(i.b)(a,e,!0)];case 1:return t=n.sent(),Object(l.a)(t.status)?[4,t.text()]:[3,3];case 2:return[2,n.sent()];case 3:return[2,"{}"]}})})}n.d(t,"b",function(){return o}),n.d(t,"a",function(){return c})},3744:function(e,t,n){"use strict";var r,i;(i=r||(r={})).MailRead="MailRead",i.MailCompose="MailCompose",i.NoEndpoint="";var a=r,o=n(140);function s(e){switch(e){case o.a.MessageRead:case o.a.MeetingRequest:return a.MailRead;case o.a.MessageCompose:return a.MailCompose;default:return a.NoEndpoint}}n.d(t,"a",function(){return s})},401:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1842),i=n(2060),a=n(2048),o=Object(r.a)(i.a,a.c,void 0,{scope:"Modal"})},4289:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),i=n(4290);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("UpdateClientExtensionNotifications",e,t)}},4290:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateClientExtensionNotificationsJsonRequest:#Exchange"},e)}},4291:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateClientExtensionNotificationsRequest:#Exchange"},e)}},4292:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38);t.default=function(e,t){return r.makeServiceRequest("SanitizeHtml",e,t)}},4293:function(e,t){
/*!
    Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.

    This file also contains the following Promise implementation (with a few small modifications):
        * @overview es6-promise - a tiny implementation of Promises/A+.
        * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
        * @license   Licensed under MIT license
        *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
        * @version   2.3.0
*/
var n,r;n=ne||(ne={}),r=function(){function e(){}return e.prototype.isMsAjaxLoaded=function(){var e="function";return!!("undefined"!=typeof Sys&&"undefined"!=typeof Type&&Sys.StringBuilder&&typeof Sys.StringBuilder===e&&Type.registerNamespace&&typeof Type.registerNamespace===e&&Type.registerClass&&typeof Type.registerClass===e&&typeof Function._validateParams===e&&Sys.Serialization&&Sys.Serialization.JavaScriptSerializer&&typeof Sys.Serialization.JavaScriptSerializer.serialize===e)},e.prototype.loadMsAjaxFull=function(e){var t=("https:"===window.location.protocol.toLowerCase()?"https:":"http:")+"//ajax.aspnetcdn.com/ajax/3.5/MicrosoftAjax.js";l.OUtil.loadScript(t,e)},Object.defineProperty(e.prototype,"msAjaxError",{get:function(){return null==this._msAjaxError&&this.isMsAjaxLoaded()&&(this._msAjaxError=Error),this._msAjaxError},set:function(e){this._msAjaxError=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"msAjaxString",{get:function(){return null==this._msAjaxString&&this.isMsAjaxLoaded()&&(this._msAjaxString=String),this._msAjaxString},set:function(e){this._msAjaxString=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"msAjaxDebug",{get:function(){return null==this._msAjaxDebug&&this.isMsAjaxLoaded()&&(this._msAjaxDebug=Sys.Debug),this._msAjaxDebug},set:function(e){this._msAjaxDebug=e},enumerable:!0,configurable:!0}),e}(),n.MicrosoftAjaxFactory=r;var i,a,o,s=new ne.MicrosoftAjaxFactory,l=l||{};i=ne||(ne={}),a=function(){function e(e){this._internalStorage=e}return e.prototype.getItem=function(e){try{return this._internalStorage&&this._internalStorage.getItem(e)}catch(e){return null}},e.prototype.setItem=function(e,t){try{this._internalStorage&&this._internalStorage.setItem(e,t)}catch(e){}},e.prototype.clear=function(){try{this._internalStorage&&this._internalStorage.clear()}catch(e){}},e.prototype.removeItem=function(e){try{this._internalStorage&&this._internalStorage.removeItem(e)}catch(e){}},e.prototype.getKeysWithPrefix=function(e){var t=[];try{for(var n=this._internalStorage&&this._internalStorage.length||0,r=0;r<n;r++){var i=this._internalStorage.key(r);0===i.indexOf(e)&&t.push(i)}}catch(e){}return t},e}(),i.SafeStorage=a,l.XdmFieldName={ConversationUrl:"ConversationUrl",AppId:"AppId"},l.WindowNameItemKeys={BaseFrameName:"baseFrameName",HostInfo:"hostInfo",XdmInfo:"xdmInfo",SerializerVersion:"serializerVersion",AppContext:"appContext"},l.OUtil=function(){var e="enumerable",t="undefined",n=2147483647,r=null,i=-1,a="&_serializer_version=",o="#",c={},u=r,d=r,p=(new Date).getTime();function f(){var e=n*Math.random();return(e^=p^(new Date).getMilliseconds()<<Math.floor(21*Math.random())).toString(16)}function m(){if(!u){try{var e=window.sessionStorage}catch(t){e=r}u=new ne.SafeStorage(e)}return u}function h(e){for(var t,n=[],r=[],i=e.length,a=0;a<i;a++)(t=e[a]).tabIndex?t.tabIndex>0?r.push(t):0===t.tabIndex&&n.push(t):n.push(t);return r=r.sort(function(e,t){var n=e.tabIndex-t.tabIndex;return 0===n&&(n=r.indexOf(e)-r.indexOf(t)),n}),[].concat(r,n)}return{set_entropy:function(e){if("string"==typeof e)for(var t=0;t<e.length;t+=4){for(var r=0,i=0;i<4&&t+i<e.length;i++)r=(r<<8)+e.charCodeAt(t+i);p^=r}else p^="number"==typeof e?e:n*Math.random();p&=n},extend:function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.uber=t.prototype,t.prototype.constructor===Object.prototype.constructor&&(t.prototype.constructor=t)},setNamespace:function(e,t){t&&e&&!t[e]&&(t[e]={})},unsetNamespace:function(e,t){t&&e&&t[e]&&delete t[e]},serializeSettings:function(e){var t={};for(var n in e){var r=e[n];try{r=JSON?JSON.stringify(r,function(e,t){return l.OUtil.isDate(this[e])?l.DDA.SettingsManager.DateJSONPrefix+this[e].getTime()+l.DDA.SettingsManager.DataJSONSuffix:t}):Sys.Serialization.JavaScriptSerializer.serialize(r),t[n]=r}catch(e){}}return t},deserializeSettings:function(e){var t={};e=e||{};for(var n in e){var r=e[n];try{r=JSON?JSON.parse(r,function(e,t){var n;return"string"==typeof t&&t&&t.length>6&&t.slice(0,5)===l.DDA.SettingsManager.DateJSONPrefix&&t.slice(-1)===l.DDA.SettingsManager.DataJSONSuffix&&(n=new Date(parseInt(t.slice(5,-1))))?n:t}):Sys.Serialization.JavaScriptSerializer.deserialize(r,!0),t[n]=r}catch(e){}}return t},loadScript:function(e,t,n){if(e&&t){var i=window.document,a=c[e];if(a)a.loaded?t():a.pendingCallbacks.push(t);else{var o=i.createElement("script");o.type="text/javascript",a={loaded:!1,pendingCallbacks:[t],timer:r},c[e]=a;var s=function(){a.timer!=r&&(clearTimeout(a.timer),delete a.timer),a.loaded=!0;for(var e=a.pendingCallbacks.length,t=0;t<e;t++){a.pendingCallbacks.shift()()}},l=function(){delete c[e],a.timer!=r&&(clearTimeout(a.timer),delete a.timer);for(var t=a.pendingCallbacks.length,n=0;n<t;n++){a.pendingCallbacks.shift()()}};o.readyState?o.onreadystatechange=function(){"loaded"!=o.readyState&&"complete"!=o.readyState||(o.onreadystatechange=r,s())}:o.onload=s,o.onerror=l,n=n||3e4,a.timer=setTimeout(l,n),o.setAttribute("crossOrigin","anonymous"),o.src=e,i.getElementsByTagName("head")[0].appendChild(o)}}},loadCSS:function(e){if(e){var t=window.document,n=t.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.getElementsByTagName("head")[0].appendChild(n)}},parseEnum:function(e,n){var r=n[e.trim()];if(typeof r==t)throw s.msAjaxDebug.trace("invalid enumeration string:"+e),s.msAjaxError.argument("str");return r},delayExecutionAndCache:function(){var e={calc:arguments[0]};return function(){return e.calc&&(e.val=e.calc.apply(this,arguments),delete e.calc),e.val}},getUniqueId:function(){return(i+=1).toString()},formatString:function(){var e=arguments;return e[0].replace(/{(\d+)}/gm,function(t,n){var r=parseInt(n,10)+1;return void 0===e[r]?"{"+n+"}":e[r]})},generateConversationId:function(){return[f(),f(),(new Date).getTime().toString()].join("_")},getFrameName:function(e){return"_xdm_"+e+this.generateConversationId()},addXdmInfoAsHash:function(e,t){return l.OUtil.addInfoAsHash(e,"&_xdm_Info=",t,!1)},addSerializerVersionAsHash:function(e,t){return l.OUtil.addInfoAsHash(e,a,t,!0)},addInfoAsHash:function(e,t,n,r){var i,a=(e=e.trim()||"").split(o),s=a.shift(),l=a.join(o);return i=r?[t,encodeURIComponent(n),l].join(""):[l,t,n].join(""),[s,o,i].join("")},parseHostInfoFromWindowName:function(e,t){return l.OUtil.parseInfoFromWindowName(e,t,l.WindowNameItemKeys.HostInfo)},parseXdmInfo:function(e){var t=l.OUtil.parseXdmInfoWithGivenFragment(e,window.location.hash);return t||(t=l.OUtil.parseXdmInfoFromWindowName(e,window.name)),t},parseXdmInfoFromWindowName:function(e,t){return l.OUtil.parseInfoFromWindowName(e,t,l.WindowNameItemKeys.XdmInfo)},parseXdmInfoWithGivenFragment:function(e,t){return l.OUtil.parseInfoWithGivenFragment("&_xdm_Info=","_xdm_",!1,e,t)},parseSerializerVersion:function(e){var t=l.OUtil.parseSerializerVersionWithGivenFragment(e,window.location.hash);return isNaN(t)&&(t=l.OUtil.parseSerializerVersionFromWindowName(e,window.name)),t},parseSerializerVersionFromWindowName:function(e,t){return parseInt(l.OUtil.parseInfoFromWindowName(e,t,l.WindowNameItemKeys.SerializerVersion))},parseSerializerVersionWithGivenFragment:function(e,t){return parseInt(l.OUtil.parseInfoWithGivenFragment(a,"_serializer_version=",!0,e,t))},parseInfoFromWindowName:function(e,t,n){try{var i=JSON.parse(t),a=i!=r?i[n]:r,o=m();if(!e&&o&&i!=r){var s=i[l.WindowNameItemKeys.BaseFrameName]+n;a?o.setItem(s,a):a=o.getItem(s)}return a}catch(e){return r}},parseInfoWithGivenFragment:function(e,t,n,i,a){var o=a.split(e),s=o.length>1?o[o.length-1]:r;n&&s!=r&&(s.indexOf("&")>=0&&(s=s.split("&")[0]),s=decodeURIComponent(s));var l=m();if(!i&&l){var c=window.name.indexOf(t);if(c>-1){var u=window.name.indexOf(";",c);-1==u&&(u=window.name.length);var d=window.name.substring(c,u);s?l.setItem(d,s):s=l.getItem(d)}}return s},getConversationId:function(){var e=window.location.search,t=r;if(e){var n=e.indexOf("&");(t=n>0?e.substring(1,n):e.substr(1))&&"="===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1))&&(t=decodeURIComponent(t))}return t},getInfoItems:function(e){var n=e.split("$");return typeof n[1]==t&&(n=e.split("|")),typeof n[1]==t&&(n=e.split("%7C")),n},getXdmFieldValue:function(e,t){var n="",r=l.OUtil.parseXdmInfo(t);if(r){var i=l.OUtil.getInfoItems(r);if(void 0!=i&&i.length>=3)switch(e){case l.XdmFieldName.ConversationUrl:n=i[2];break;case l.XdmFieldName.AppId:n=i[1]}}return n},validateParamObject:function(e,t){var n=Function._validateParams(arguments,[{name:"params",type:Object,mayBeNull:!1},{name:"expectedProperties",type:Object,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0}]);if(n)throw n;for(var r in t)if(n=Function._validateParameter(e[r],t[r],r))throw n},writeProfilerMark:function(e){window.msWriteProfilerMark&&(window.msWriteProfilerMark(e),s.msAjaxDebug.trace(e))},outputDebug:function(e){typeof s!==t&&s.msAjaxDebug&&s.msAjaxDebug.trace&&s.msAjaxDebug.trace(e)},defineNondefaultProperty:function(e,t,n,r){n=n||{};for(var i in r){var a=r[i];void 0==n[a]&&(n[a]=!0)}return Object.defineProperty(e,t,n),e},defineNondefaultProperties:function(e,t,n){t=t||{};for(var r in t)l.OUtil.defineNondefaultProperty(e,r,t[r],n);return e},defineEnumerableProperty:function(t,n,r){return l.OUtil.defineNondefaultProperty(t,n,r,[e])},defineEnumerableProperties:function(t,n){return l.OUtil.defineNondefaultProperties(t,n,[e])},defineMutableProperty:function(t,n,r){return l.OUtil.defineNondefaultProperty(t,n,r,["writable",e,"configurable"])},defineMutableProperties:function(t,n){return l.OUtil.defineNondefaultProperties(t,n,["writable",e,"configurable"])},finalizeProperties:function(e,t){t=t||{};for(var n=Object.getOwnPropertyNames(e),r=n.length,i=0;i<r;i++){var a=n[i],o=Object.getOwnPropertyDescriptor(e,a);o.get||o.set||(o.writable=t.writable||!1),o.configurable=t.configurable||!1,o.enumerable=t.enumerable||!0,Object.defineProperty(e,a,o)}return e},mapList:function(e,t){var n=[];if(e)for(var r in e)n.push(t(e[r]));return n},listContainsKey:function(e,t){for(var n in e)if(t==n)return!0;return!1},listContainsValue:function(e,t){for(var n in e)if(t==e[n])return!0;return!1},augmentList:function(e,t){var n=e.push?function(t,n){e.push(n)}:function(t,n){e[t]=n};for(var r in t)n(r,t[r])},redefineList:function(e,t){for(var n in e)delete e[n];for(var r in t)e[r]=t[r]},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.apply(e)},isDate:function(e){return"[object Date]"===Object.prototype.toString.apply(e)},addEventListener:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):Sys.Browser.agent===Sys.Browser.InternetExplorer&&e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},removeEventListener:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):Sys.Browser.agent===Sys.Browser.InternetExplorer&&e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=r},getCookieValue:function(e){return RegExp(e+"[^;]+").exec(document.cookie).toString().replace(/^[^=]+./,"")},xhrGet:function(e,t,n){var r;try{(r=new XMLHttpRequest).onreadystatechange=function(){4==r.readyState&&(200==r.status?t(r.responseText):n(r.status))},r.open("GET",e,!0),r.send()}catch(e){n(e)}},xhrGetFull:function(e,t,n,r){var i,a=t;try{(i=new XMLHttpRequest).onreadystatechange=function(){4==i.readyState&&(200==i.status?n(i,a):r(i.status))},i.open("GET",e,!0),i.send()}catch(e){r(e)}},encodeBase64:function(e){if(!e)return e;var t,n,r,i,a,o,s,l=[],c=[],u=0,d=e.length;do{t=e.charCodeAt(u++),n=e.charCodeAt(u++),r=e.charCodeAt(u++),s=0,i=255&t,a=t>>8,o=255&n,c[s++]=i>>2,c[s++]=(3&i)<<4|a>>4,c[s++]=(15&a)<<2|o>>6,c[s++]=63&o,isNaN(n)||(i=n>>8,a=255&r,o=r>>8,c[s++]=i>>2,c[s++]=(3&i)<<4|a>>4,c[s++]=(15&a)<<2|o>>6,c[s++]=63&o),isNaN(n)?c[s-1]=64:isNaN(r)&&(c[s-2]=64,c[s-1]=64);for(var p=0;p<s;p++)l.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c[p]))}while(u<d);return l.join("")},getSessionStorage:function(){return m()},getLocalStorage:function(){if(!d){try{var e=window.localStorage}catch(t){e=r}d=new ne.SafeStorage(e)}return d},convertIntToCssHexColor:function(e){return"#"+(Number(e)+16777216).toString(16).slice(-6)},attachClickHandler:function(e,t){e.onclick=function(){t()},e.ontouchend=function(e){t(),e.preventDefault()}},getQueryStringParamValue:function(e,t){if(Function._validateParams(arguments,[{name:"queryString",type:String,mayBeNull:!1},{name:"paramName",type:String,mayBeNull:!1}]))return s.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: Parameters cannot be null."),"";var n=new RegExp("[\\?&]"+t+"=([^&#]*)","i");return n.test(e)?n.exec(e)[1]:(s.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: The parameter is not found."),"")},isiOS:function(){return!!window.navigator.userAgent.match(/(iPad|iPhone|iPod)/g)},isChrome:function(){return window.navigator.userAgent.indexOf("Chrome")>0&&!l.OUtil.isEdge()},isEdge:function(){return window.navigator.userAgent.indexOf("Edge")>0},isIE:function(){return window.navigator.userAgent.indexOf("Trident")>0},isFirefox:function(){return window.navigator.userAgent.indexOf("Firefox")>0},shallowCopy:function(e){if(e==r)return r;if(e instanceof Object){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}var i=e.constructor();for(var a in e)e.hasOwnProperty(a)&&(i[a]=e[a]);return i}return e},createObject:function(e){var t=r;if(e){t={};for(var n=e.length,i=0;i<n;i++)t[e[i].name]=e[i].value}return t},addClass:function(e,t){if(!l.OUtil.hasClass(e,t)){var n=e.getAttribute("class");n?e.setAttribute("class",n+" "+t):e.setAttribute("class",t)}},removeClass:function(e,t){if(l.OUtil.hasClass(e,t)){var n=e.getAttribute("class"),r=new RegExp("(\\s|^)"+t+"(\\s|$)");n=n.replace(r,""),e.setAttribute("class",n)}},hasClass:function(e,t){var n=e.getAttribute("class");return n&&n.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},focusToFirstTabbable:function(e,t){var n,i,a,o,s,l=!1,c=function(){l=!0};if(e=h(e),n=t?e.length-1:0,0===e.length)return r;for(;!l&&n>=0&&n<e.length;)i=e[n],window.focus(),i.addEventListener("focus",c),i.focus(),i.removeEventListener("focus",c),a=e.length,s=t,n=(o=n)<0||o>a?-1:0===o&&s?-1:o!==a-1||s?s?o-1:o+1:-1,l||i!==document.activeElement||(l=!0);return l?i:r},focusToNextTabbable:function(e,t,n){var i,a,o,s=!1,l=function(){s=!0},c=function(e,t,n){return t<0||t>e?-1:0===t&&n?-1:t!==e-1||n?n?t-1:t+1:-1};if(i=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}(e=h(e),t),(a=c(e.length,i,n))<0)return r;for(;!s&&a>=0&&a<e.length;)(o=e[a]).addEventListener("focus",l),o.focus(),o.removeEventListener("focus",l),a=c(e.length,a,n),s||o!==document.activeElement||(s=!0);return s?o:r}}}(),l.OUtil.Guid=(o=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],{generateNewGuid:function(){for(var e="",t=(new Date).getTime(),n=0;n<32&&t>0;n++)8!=n&&12!=n&&16!=n&&20!=n||(e+="-"),e+=o[t%16],t=Math.floor(t/16);for(;n<32;n++)8!=n&&12!=n&&16!=n&&20!=n||(e+="-"),e+=o[Math.floor(16*Math.random())];return e}}),window.OSF=l,function(e){var t="undefined",n=function(){function e(){}return e.isInstanceOfType=function(e,n){if(typeof n===t||null===n)return!1;if(n instanceof e)return!0;var r=n.constructor;return r&&"function"==typeof r&&r.__typeName&&"Object"!==r.__typeName||(r=Object),!(r!==e)||r.__typeName&&e.__typeName&&r.__typeName===e.__typeName},e}();e.MsAjaxTypeHelper=n;var r=function(){var e="Parameter name: {0}";function n(){}return n.create=function(e,t){var n=new Error(e);if(n.message=e,t)for(var r in t)n[r]=t[r];return n.popStackFrame(),n},n.parameterCount=function(e){var t="Sys.ParameterCountException: "+(e||"Parameter count mismatch."),r=n.create(t,{name:"Sys.ParameterCountException"});return r.popStackFrame(),r},n.argument=function(t,r){var a="Sys.ArgumentException: "+(r||"Value does not fall within the expected range.");t&&(a+="\n"+i.format(e,t));var o=n.create(a,{name:"Sys.ArgumentException",paramName:t});return o.popStackFrame(),o},n.argumentNull=function(t,r){var a="Sys.ArgumentNullException: "+(r||"Value cannot be null.");t&&(a+="\n"+i.format(e,t));var o=n.create(a,{name:"Sys.ArgumentNullException",paramName:t});return o.popStackFrame(),o},n.argumentOutOfRange=function(r,a,o){var s="Sys.ArgumentOutOfRangeException: "+(o||"Specified argument was out of the range of valid values.");r&&(s+="\n"+i.format(e,r)),typeof a!==t&&null!==a&&(s+="\n"+i.format("Actual value was {0}.",a));var l=n.create(s,{name:"Sys.ArgumentOutOfRangeException",paramName:r,actualValue:a});return l.popStackFrame(),l},n.argumentType=function(t,r,a,o){var s="Sys.ArgumentTypeException: ";s+=o||(r&&a?i.format("Object of type '{0}' cannot be converted to type '{1}'.",r.getName?r.getName():r,a.getName?a.getName():a):"Object cannot be converted to the required type."),t&&(s+="\n"+i.format(e,t));var l=n.create(s,{name:"Sys.ArgumentTypeException",paramName:t,actualType:r,expectedType:a});return l.popStackFrame(),l},n.argumentUndefined=function(t,r){var a="Sys.ArgumentUndefinedException: "+(r||"Value cannot be undefined.");t&&(a+="\n"+i.format(e,t));var o=n.create(a,{name:"Sys.ArgumentUndefinedException",paramName:t});return o.popStackFrame(),o},n.invalidOperation=function(e){var t="Sys.InvalidOperationException: "+(e||"Operation is not valid due to the current state of the object."),r=n.create(t,{name:"Sys.InvalidOperationException"});return r.popStackFrame(),r},n}();e.MsAjaxError=r;var i=function(){function e(){}return e.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(/{(\d+)}/gm,function(e,n){var r=parseInt(n,10);return void 0===t[r]?"{"+n+"}":t[r]})},e.startsWith=function(e,t){return e.substr(0,t.length)===t},e}();e.MsAjaxString=i;var a=function(){function e(){}return e.trace=function(){},e}();if(e.MsAjaxDebug=a,!s.isMsAjaxLoaded()){var o=function(e,t,n){void 0!==e.__typeName&&null!==e.__typeName||(e.__typeName=t),void 0!==e.__class&&null!==e.__class||(e.__class=n)};o(Function,"Function",!0),o(Error,"Error",!0),o(Object,"Object",!0),o(String,"String",!0),o(Boolean,"Boolean",!0),o(Date,"Date",!0),o(Number,"Number",!0),o(RegExp,"RegExp",!0),o(Array,"Array",!0),Function.createCallback||(Function.createCallback=function(e,t){var n=Function._validateParams(arguments,[{name:"method",type:Function},{name:"context",mayBeNull:!0}]);if(n)throw n;return function(){var n=arguments.length;if(n>0){for(var r=[],i=0;i<n;i++)r[i]=arguments[i];return r[n]=t,e.apply(this,r)}return e.call(this,t)}}),Function.createDelegate||(Function.createDelegate=function(e,t){var n=Function._validateParams(arguments,[{name:"instance",mayBeNull:!0},{name:"method",type:Function}]);if(n)throw n;return function(){return t.apply(e,arguments)}}),Function._validateParams||(Function._validateParams=function(e,n,r){var i,a=n.length;if(r=r||typeof r===t,i=Function._validateParameterCount(e,n,r))return i.popStackFrame(),i;for(var o=0,s=e.length;o<s;o++){var l=n[Math.min(o,a-1)],c=l.name;if(l.parameterArray)c+="["+(o-a+1)+"]";else if(!r&&o>=a)break;if(i=Function._validateParameter(e[o],l,c))return i.popStackFrame(),i}return null}),Function._validateParameterCount||(Function._validateParameterCount=function(e,t,n){var i,a,o=t.length,s=e.length;if(s<o){var l=o;for(i=0;i<o;i++){var c=t[i];(c.optional||c.parameterArray)&&l--}s<l&&(a=!0)}else if(n&&s>o)for(a=!0,i=0;i<o;i++)if(t[i].parameterArray){a=!1;break}if(a){var u=r.parameterCount();return u.popStackFrame(),u}return null}),Function._validateParameter||(Function._validateParameter=function(e,n,r){var i,a=n.type,o=!!n.integer,s=!!n.domElement,l=!!n.mayBeNull;if(i=Function._validateParameterType(e,a,o,s,l,r))return i.popStackFrame(),i;var c=n.elementType,u=!!n.elementMayBeNull;if(a===Array&&typeof e!==t&&null!==e&&(c||!u))for(var d=!!n.elementInteger,p=!!n.elementDomElement,f=0;f<e.length;f++){var m=e[f];if(i=Function._validateParameterType(m,c,d,p,u,r+"["+f+"]"))return i.popStackFrame(),i}return null}),Function._validateParameterType||(Function._validateParameterType=function(n,r,i,a,o,s){var l;return typeof n===t?o?null:((l=e.MsAjaxError.argumentUndefined(s)).popStackFrame(),l):null===n?o?null:((l=e.MsAjaxError.argumentNull(s)).popStackFrame(),l):r&&!e.MsAjaxTypeHelper.isInstanceOfType(r,n)?((l=e.MsAjaxError.argumentType(s,typeof n,r)).popStackFrame(),l):null}),window.Type||(window.Type=Function),Type.registerNamespace||(Type.registerNamespace=function(e){for(var t=e.split("."),n=window,r=0;r<t.length;r++)n[t[r]]=n[t[r]]||{},n=n[t[r]]}),Type.prototype.registerClass||(Type.prototype.registerClass=function(e){({})}),typeof Sys===t&&Type.registerNamespace("Sys"),Error.prototype.popStackFrame||(Error.prototype.popStackFrame=function(){if(0!==arguments.length)throw r.parameterCount();if(typeof this.stack!==t&&null!==this.stack&&typeof this.fileName!==t&&null!==this.fileName&&typeof this.lineNumber!==t&&null!==this.lineNumber){for(var e=this.stack.split("\n"),n=e[0],i=this.fileName+":"+this.lineNumber;typeof n!==t&&null!==n&&-1===n.indexOf(i);)e.shift(),n=e[0];var a=e[1];if(typeof a!==t&&null!==a){var o=a.match(/@(.*):(\d+)$/);typeof o!==t&&null!==o&&(this.fileName=o[1],this.lineNumber=parseInt(o[2]),e.shift(),this.stack=e.join("\n"))}}}),s.msAjaxError=r,s.msAjaxString=i,s.msAjaxDebug=a}}(ne||(ne={})),l.OUtil.setNamespace("Microsoft",window),l.OUtil.setNamespace("Office",Microsoft),l.OUtil.setNamespace("Common",Microsoft.Office),Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5},l.SerializerVersion={MsAjax:0,Browser:1},function(e){(ne||(ne={})).appSpecificCheckOrigin=function(){return!1}}(),Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5},Microsoft.Office.Common.InvokeResultCode={noError:0,errorInRequest:-1,errorHandlingRequest:-2,errorInResponse:-3,errorHandlingResponse:-4,errorHandlingRequestAccessDenied:-5,errorHandlingMethodCallTimedout:-6},Microsoft.Office.Common.MessageType={request:0,response:1},Microsoft.Office.Common.ActionType={invoke:0,registerEvent:1,unregisterEvent:2},Microsoft.Office.Common.ResponseType={forCalling:0,forEventing:1},Microsoft.Office.Common.MethodObject=function(e,t,n){this._method=e,this._invokeType=t,this._blockingOthers=n},Microsoft.Office.Common.MethodObject.prototype={getMethod:function(){return this._method},getInvokeType:function(){return this._invokeType},getBlockingFlag:function(){return this._blockingOthers}},Microsoft.Office.Common.EventMethodObject=function(e,t){this._registerMethodObject=e,this._unregisterMethodObject=t},Microsoft.Office.Common.EventMethodObject.prototype={getRegisterMethodObject:function(){return this._registerMethodObject},getUnregisterMethodObject:function(){return this._unregisterMethodObject}},Microsoft.Office.Common.ServiceEndPoint=function(e){var t=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:!1}]);if(t)throw t;this._methodObjectList={},this._eventHandlerProxyList={},this._Id=e,this._conversations={},this._policyManager=null,this._appDomains={},this._onHandleRequestError=null},Microsoft.Office.Common.ServiceEndPoint.prototype={registerMethod:function(e,t,n,r){var i=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:!1},{name:"method",type:Function,mayBeNull:!1},{name:"invokeType",type:Number,mayBeNull:!1},{name:"blockingOthers",type:Boolean,mayBeNull:!1}]);if(i)throw i;if(n!==Microsoft.Office.Common.InvokeType.async&&n!==Microsoft.Office.Common.InvokeType.sync)throw s.msAjaxError.argument("invokeType");var a=new Microsoft.Office.Common.MethodObject(t,n,r);this._methodObjectList[e]=a},unregisterMethod:function(e){var t=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:!1}]);if(t)throw t;delete this._methodObjectList[e]},registerEvent:function(e,t,n){var r=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:!1},{name:"registerMethod",type:Function,mayBeNull:!1},{name:"unregisterMethod",type:Function,mayBeNull:!1}]);if(r)throw r;var i=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(t,Microsoft.Office.Common.InvokeType.syncRegisterEvent,!1),new Microsoft.Office.Common.MethodObject(n,Microsoft.Office.Common.InvokeType.syncUnregisterEvent,!1));this._methodObjectList[e]=i},registerEventEx:function(e,t,n,r,i){var a=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:!1},{name:"registerMethod",type:Function,mayBeNull:!1},{name:"registerMethodInvokeType",type:Number,mayBeNull:!1},{name:"unregisterMethod",type:Function,mayBeNull:!1},{name:"unregisterMethodInvokeType",type:Number,mayBeNull:!1}]);if(a)throw a;var o=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(t,n,!1),new Microsoft.Office.Common.MethodObject(r,i,!1));this._methodObjectList[e]=o},unregisterEvent:function(e){var t=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:!1}]);if(t)throw t;this.unregisterMethod(e)},registerConversation:function(e,t,n,r){var i=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1},{name:"conversationUrl",type:String,mayBeNull:!1,optional:!0},{name:"appDomains",type:Object,mayBeNull:!0,optional:!0},{name:"serializerVersion",type:Number,mayBeNull:!0,optional:!0}]);if(i)throw i;if(n){if(!(n instanceof Array))throw s.msAjaxError.argument("appDomains");this._appDomains[e]=n}this._conversations[e]={url:t,serializerVersion:r}},unregisterConversation:function(e){var t=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1}]);if(t)throw t;delete this._conversations[e]},setPolicyManager:function(e){var t=Function._validateParams(arguments,[{name:"policyManager",type:Object,mayBeNull:!1}]);if(t)throw t;if(!e.checkPermission)throw s.msAjaxError.argument("policyManager");this._policyManager=e},getPolicyManager:function(){return this._policyManager},dispose:function(){this._methodObjectList=null,this._eventHandlerProxyList=null,this._Id=null,this._conversations=null,this._policyManager=null,this._appDomains=null,this._onHandleRequestError=null}},Microsoft.Office.Common.ClientEndPoint=function(e,t,n,r){var i="targetWindow",a=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1},{name:i,mayBeNull:!1},{name:"targetUrl",type:String,mayBeNull:!1},{name:"serializerVersion",type:Number,mayBeNull:!0,optional:!0}]);if(a)throw a;try{if(!t.postMessage)throw s.msAjaxError.argument(i)}catch(e){if(!Object.prototype.hasOwnProperty.call(t,"postMessage"))throw s.msAjaxError.argument(i)}this._conversationId=e,this._targetWindow=t,this._targetUrl=n,this._callingIndex=0,this._callbackList={},this._eventHandlerList={},this._serializerVersion=null!=r?r:l.SerializerVersion.Browser},Microsoft.Office.Common.ClientEndPoint.prototype={invoke:function(e,t,n){var r=Function._validateParams(arguments,[{name:"targetMethodName",type:String,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"param",mayBeNull:!0}]);if(r)throw r;var i=this._callingIndex++,a={callback:t,createdOn:(new Date).getTime()};n&&"object"==typeof n&&"number"==typeof n.__timeout__&&(a.timeout=n.__timeout__,delete n.__timeout__),this._callbackList[i]=a;try{var o=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.invoke,this._conversationId,i,n),s=Microsoft.Office.Common.MessagePackager.envelope(o,this._serializerVersion);this._targetWindow.postMessage(s,this._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{null!==t&&t(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete this._callbackList[i]}}},registerForEvent:function(e,t,n,r){var i=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:!1},{name:"eventHandler",type:Function,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"data",mayBeNull:!0,optional:!0}]);if(i)throw i;var a=this._callingIndex++,o=new Date;this._callbackList[a]={callback:n,createdOn:o.getTime()};try{var s=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.registerEvent,this._conversationId,a,r),l=Microsoft.Office.Common.MessagePackager.envelope(s,this._serializerVersion);this._targetWindow.postMessage(l,this._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer(),this._eventHandlerList[e]=t}catch(e){try{null!==n&&n(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete this._callbackList[a]}}},unregisterForEvent:function(e,t,n){var r=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"data",mayBeNull:!0,optional:!0}]);if(r)throw r;var i=this._callingIndex++,a=new Date;this._callbackList[i]={callback:t,createdOn:a.getTime()};try{var o=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.unregisterEvent,this._conversationId,i,n),s=Microsoft.Office.Common.MessagePackager.envelope(o,this._serializerVersion);this._targetWindow.postMessage(s,this._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{null!==t&&t(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete this._callbackList[i]}}finally{delete this._eventHandlerList[e]}}},Microsoft.Office.Common.XdmCommunicationManager=function(){var e=!0,t="channel is not ready.",n="conversationId",r="Unknown conversation Id.",i=!1,a=null,o=[],c=a,u=a,d=10,p=i,f=a,m=65e3,h={},g={},v=i;function y(){if(u!==a){if(!p)if(o.length>0){_(o.shift())}else clearInterval(u),u=a}else s.msAjaxDebug.trace(t)}function _(e){p=e.getInvokeBlockingFlag(),e.invoke(),c=(new Date).getTime()}function C(){if(f){var e,n,r=0,i=new Date;for(var o in g){e=g[o];for(var l in e._callbackList){var c=e._callbackList[l];if((n=c.timeout?c.timeout:m)>=0&&Math.abs(i.getTime()-c.createdOn)>=n)try{c.callback&&c.callback(Microsoft.Office.Common.InvokeResultCode.errorHandlingMethodCallTimedout,a)}finally{delete e._callbackList[l]}else r++}}0===r&&(clearInterval(f),f=a)}else s.msAjaxDebug.trace(t)}function S(){p=i}function A(e,t){var n=i;if(!(t&&t.length&&e&&e instanceof Array&&e.length))return n;var r=document.createElement("a"),a=document.createElement("a");r.href=t;for(var o=0;o<e.length&&!n;o++)-1!==e[o].indexOf("://")&&(a.href=e[o],n=b(r,a));return delete r,n}function b(e,t){return e.hostname==t.hostname&&e.protocol==t.protocol&&e.port==t.port}function I(t){var f,m,v,C,I,O,x,E;if(l&&""!=t.data){var T,M=l.SerializerVersion.Browser,k=t.data;try{M=(T=Microsoft.Office.Common.MessagePackager.unenvelope(k,l.SerializerVersion.Browser))._serializerVersion!=a?T._serializerVersion:M}catch(e){return}if(T._messageType===Microsoft.Office.Common.MessageType.request){var P=t.origin==a||"null"==t.origin?T._origin:t.origin;try{var N=function(e){for(var t in h)if(h[t]._conversations[e])return h[t];throw s.msAjaxDebug.trace(r),s.msAjaxError.argument(n)}(T._conversationId),R=N._conversations[T._conversationId];M=R.serializerVersion!=a?R.serializerVersion:M;var D=[R.url].concat(N._appDomains[T._conversationId]);if(!A(D,t.origin)&&!ne.appSpecificCheckOrigin(D,t,T._origin,A))throw"Failed origin check";var w=N.getPolicyManager();if(w&&!w.checkPermission(T._conversationId,T._actionName,T._data))throw"Access Denied";var F=function(e,t){var n=e._methodObjectList[t._actionName];if(!n)throw s.msAjaxDebug.trace("The specified method is not registered on service endpoint:"+t._actionName),s.msAjaxError.argument("messageObject");return t._actionType===Microsoft.Office.Common.ActionType.invoke?n:t._actionType===Microsoft.Office.Common.ActionType.registerEvent?n.getRegisterMethodObject():n.getUnregisterMethodObject()}(N,T),U=new Microsoft.Office.Common.InvokeCompleteCallback(t.source,P,T._actionName,T._conversationId,T._correlationId,S,M),L=new Microsoft.Office.Common.Invoker(F,T._data,U,N._eventHandlerProxyList,T._conversationId,T._actionName,M),B=e;u==a&&((c==a||(new Date).getTime()-c>d)&&!p?(_(L),B=i):u=setInterval(y,d)),B&&(E=L,o.push(E))}catch(e){N&&N._onHandleRequestError&&N._onHandleRequestError(T,e);var j=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequest;"Access Denied"==e&&(j=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequestAccessDenied);var H=new Microsoft.Office.Common.Response(T._actionName,T._conversationId,T._correlationId,j,Microsoft.Office.Common.ResponseType.forCalling,e),V=Microsoft.Office.Common.MessagePackager.envelope(H,M),W=i;try{W=!(!t.source||!t.source.postMessage)}catch(e){}W&&t.source.postMessage(V,P)}}else{if(T._messageType!==Microsoft.Office.Common.MessageType.response)return;var G=(O=T._conversationId,!(x=g[O])&&s.msAjaxDebug.trace(r),x);if(!G)return;if(G._serializerVersion=M,f=G._targetUrl,m=t.origin,I=i,!(f===e?e:f&&m&&f.length&&m.length?(v=document.createElement("a"),C=document.createElement("a"),v.href=f,C.href=m,I=b(v,C),delete v,I):I))throw"Failed orgin check";if(T._responseType===Microsoft.Office.Common.ResponseType.forCalling){var q=G._callbackList[T._correlationId];if(q)try{q.callback&&q.callback(T._errorCode,T._data)}finally{delete G._callbackList[T._correlationId]}}else{var z=G._eventHandlerList[T._actionName];void 0!==z&&z!==a&&z(T._data)}}}}function O(){v||(!function(e){if(window.addEventListener)window.addEventListener("message",e,i);else{if(!(navigator.userAgent.indexOf("MSIE")>-1&&window.attachEvent))throw s.msAjaxDebug.trace("Browser doesn't support the required API."),s.msAjaxError.argument("Browser");window.attachEvent("onmessage",e)}}(I),v=e)}return{connect:function(e,t,n,r){var i=g[e];return i||(O(),i=new Microsoft.Office.Common.ClientEndPoint(e,t,n,r),g[e]=i),i},getClientEndPoint:function(e){var t=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:i}]);if(t)throw t;return g[e]},createServiceEndPoint:function(e){O();var t=new Microsoft.Office.Common.ServiceEndPoint(e);return h[e]=t,t},getServiceEndPoint:function(e){var t=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:i}]);if(t)throw t;return h[e]},deleteClientEndPoint:function(e){var t=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:i}]);if(t)throw t;delete g[e]},deleteServiceEndPoint:function(e){var t=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:i}]);if(t)throw t;delete h[e]},checkUrlWithAppDomains:function(e,t){return A(e,t)},_setMethodTimeout:function(e){var t=Function._validateParams(arguments,[{name:"methodTimeout",type:Number,mayBeNull:i}]);if(t)throw t;m=e<=0?65e3:e},_startMethodTimeoutTimer:function(){f||(f=setInterval(C,2e3))}}}(),Microsoft.Office.Common.Message=function(e,t,n,r,i){var a=Function._validateParams(arguments,[{name:"messageType",type:Number,mayBeNull:!1},{name:"actionName",type:String,mayBeNull:!1},{name:"conversationId",type:String,mayBeNull:!1},{name:"correlationId",mayBeNull:!1},{name:"data",mayBeNull:!0,optional:!0}]);if(a)throw a;this._messageType=e,this._actionName=t,this._conversationId=n,this._correlationId=r,this._origin=window.location.href,this._data=void 0===i?null:i},Microsoft.Office.Common.Message.prototype={getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getOrigin:function(){return this._origin},getData:function(){return this._data},getMessageType:function(){return this._messageType}},Microsoft.Office.Common.Request=function(e,t,n,r,i){Microsoft.Office.Common.Request.uber.constructor.call(this,Microsoft.Office.Common.MessageType.request,e,n,r,i),this._actionType=t},l.OUtil.extend(Microsoft.Office.Common.Request,Microsoft.Office.Common.Message),Microsoft.Office.Common.Request.prototype.getActionType=function(){return this._actionType},Microsoft.Office.Common.Response=function(e,t,n,r,i,a){Microsoft.Office.Common.Response.uber.constructor.call(this,Microsoft.Office.Common.MessageType.response,e,t,n,a),this._errorCode=r,this._responseType=i},l.OUtil.extend(Microsoft.Office.Common.Response,Microsoft.Office.Common.Message),Microsoft.Office.Common.Response.prototype.getErrorCode=function(){return this._errorCode},Microsoft.Office.Common.Response.prototype.getResponseType=function(){return this._responseType},Microsoft.Office.Common.MessagePackager={envelope:function(e){return"object"==typeof e&&(e._serializerVersion=l.SerializerVersion.Browser),JSON.stringify(e)},unenvelope:function(e){return JSON.parse(e)}},Microsoft.Office.Common.ResponseSender=function(e,t,n,r,i,a,o){var l=Function._validateParams(arguments,[{name:"requesterWindow",mayBeNull:!1},{name:"requesterUrl",type:String,mayBeNull:!1},{name:"actionName",type:String,mayBeNull:!1},{name:"conversationId",type:String,mayBeNull:!1},{name:"correlationId",mayBeNull:!1},{name:"responsetype",type:Number,maybeNull:!1},{name:"serializerVersion",type:Number,maybeNull:!0,optional:!0}]);if(l)throw l;this._requesterWindow=e,this._requesterUrl=t,this._actionName=n,this._conversationId=r,this._correlationId=i,this._invokeResultCode=Microsoft.Office.Common.InvokeResultCode.noError,this._responseType=a;var c=this;this._send=function(e){try{var t=new Microsoft.Office.Common.Response(c._actionName,c._conversationId,c._correlationId,c._invokeResultCode,c._responseType,e),n=Microsoft.Office.Common.MessagePackager.envelope(t,o);c._requesterWindow.postMessage(n,c._requesterUrl)}catch(e){s.msAjaxDebug.trace("ResponseSender._send error:"+e.message)}}},Microsoft.Office.Common.ResponseSender.prototype={getRequesterWindow:function(){return this._requesterWindow},getRequesterUrl:function(){return this._requesterUrl},getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getSend:function(){return this._send},setResultCode:function(e){this._invokeResultCode=e}},Microsoft.Office.Common.InvokeCompleteCallback=function(e,t,n,r,i,a,o){Microsoft.Office.Common.InvokeCompleteCallback.uber.constructor.call(this,e,t,n,r,i,Microsoft.Office.Common.ResponseType.forCalling,o),this._postCallbackHandler=a;var l=this;this._send=function(e,t){void 0!=t&&(l._invokeResultCode=t);try{var n=new Microsoft.Office.Common.Response(l._actionName,l._conversationId,l._correlationId,l._invokeResultCode,l._responseType,e),r=Microsoft.Office.Common.MessagePackager.envelope(n,o);l._requesterWindow.postMessage(r,l._requesterUrl),l._postCallbackHandler()}catch(e){s.msAjaxDebug.trace("InvokeCompleteCallback._send error:"+e.message)}}},l.OUtil.extend(Microsoft.Office.Common.InvokeCompleteCallback,Microsoft.Office.Common.ResponseSender),Microsoft.Office.Common.Invoker=function(e,t,n,r,i,a,o){var s=Function._validateParams(arguments,[{name:"methodObject",mayBeNull:!1},{name:"paramValue",mayBeNull:!0},{name:"invokeCompleteCallback",mayBeNull:!1},{name:"eventHandlerProxyList",mayBeNull:!0},{name:"conversationId",type:String,mayBeNull:!1},{name:"eventName",type:String,mayBeNull:!1},{name:"serializerVersion",type:Number,mayBeNull:!0,optional:!0}]);if(s)throw s;this._methodObject=e,this._param=t,this._invokeCompleteCallback=n,this._eventHandlerProxyList=r,this._conversationId=i,this._eventName=a,this._serializerVersion=o},Microsoft.Office.Common.Invoker.prototype={invoke:function(){try{var e;switch(this._methodObject.getInvokeType()){case Microsoft.Office.Common.InvokeType.async:this._methodObject.getMethod()(this._param,this._invokeCompleteCallback.getSend());break;case Microsoft.Office.Common.InvokeType.sync:e=this._methodObject.getMethod()(this._param),this._invokeCompleteCallback.getSend()(e);break;case Microsoft.Office.Common.InvokeType.syncRegisterEvent:var t=this._createEventHandlerProxyObject(this._invokeCompleteCallback);e=this._methodObject.getMethod()(t.getSend(),this._param),this._eventHandlerProxyList[this._conversationId+this._eventName]=t.getSend(),this._invokeCompleteCallback.getSend()(e);break;case Microsoft.Office.Common.InvokeType.syncUnregisterEvent:var n=this._eventHandlerProxyList[this._conversationId+this._eventName];e=this._methodObject.getMethod()(n,this._param),delete this._eventHandlerProxyList[this._conversationId+this._eventName],this._invokeCompleteCallback.getSend()(e);break;case Microsoft.Office.Common.InvokeType.asyncRegisterEvent:var r=this._createEventHandlerProxyObject(this._invokeCompleteCallback);this._methodObject.getMethod()(r.getSend(),this._invokeCompleteCallback.getSend(),this._param),this._eventHandlerProxyList[this._callerId+this._eventName]=r.getSend();break;case Microsoft.Office.Common.InvokeType.asyncUnregisterEvent:var i=this._eventHandlerProxyList[this._callerId+this._eventName];this._methodObject.getMethod()(i,this._invokeCompleteCallback.getSend(),this._param),delete this._eventHandlerProxyList[this._callerId+this._eventName]}}catch(e){this._invokeCompleteCallback.setResultCode(Microsoft.Office.Common.InvokeResultCode.errorInResponse),this._invokeCompleteCallback.getSend()(e)}},getInvokeBlockingFlag:function(){return this._methodObject.getBlockingFlag()},_createEventHandlerProxyObject:function(e){return new Microsoft.Office.Common.ResponseSender(e.getRequesterWindow(),e.getRequesterUrl(),e.getActionName(),e.getConversationId(),e.getCorrelationId(),Microsoft.Office.Common.ResponseType.forEventing,this._serializerVersion)}},l.OUtil.setNamespace("OSF",window),l.MessageIDs={FetchBundleUrl:0,LoadReactBundle:1,LoadBundleSuccess:2,LoadBundleError:3},l.AppName={Unsupported:0,Excel:1,Word:2,PowerPoint:4,Outlook:8,ExcelWebApp:16,WordWebApp:32,OutlookWebApp:64,Project:128,AccessWebApp:256,PowerpointWebApp:512,ExcelIOS:1024,Sway:2048,WordIOS:4096,PowerPointIOS:8192,Access:16384,Lync:32768,OutlookIOS:65536,OneNoteWebApp:131072,OneNote:262144,ExcelWinRT:524288,WordWinRT:1048576,PowerpointWinRT:2097152,OutlookAndroid:4194304,OneNoteWinRT:8388608,ExcelAndroid:8388609,VisioWebApp:8388610,OneNoteIOS:8388611,WordAndroid:8388613,PowerpointAndroid:8388614},l.InternalPerfMarker={DataCoercionBegin:"Agave.HostCall.CoerceDataStart",DataCoercionEnd:"Agave.HostCall.CoerceDataEnd"},l.HostCallPerfMarker={IssueCall:"Agave.HostCall.IssueCall",ReceiveResponse:"Agave.HostCall.ReceiveResponse",RuntimeExceptionRaised:"Agave.HostCall.RuntimeExecptionRaised"},l.AgaveHostAction={Select:0,UnSelect:1,CancelDialog:2,InsertAgave:3,CtrlF6In:4,CtrlF6Exit:5,CtrlF6ExitShift:6,SelectWithError:7,NotifyHostError:8,RefreshAddinCommands:9,PageIsReady:10,TabIn:11,TabInShift:12,TabExit:13,TabExitShift:14,EscExit:15,F2Exit:16,ExitNoFocusable:17,ExitNoFocusableShift:18,MouseEnter:19,MouseLeave:20,UpdateTargetUrl:21,InstallCustomFunctions:22},l.SharedConstants={NotificationConversationIdSuffix:"_ntf"},l.DialogMessageType={DialogMessageReceived:0,DialogParentMessageReceived:1,DialogClosed:12006},l.OfficeAppContext=function(e,t,n,r,i,a,o,s,l,c,u,d,p,f,m,h,g,v,y,_,C,S,A,b){this._id=e,this._appName=t,this._appVersion=n,this._appUILocale=r,this._dataLocale=i,this._docUrl=a,this._clientMode=o,this._settings=s,this._reason=l,this._osfControlType=c,this._eToken=u,this._correlationId=d,this._appInstanceId=p,this._touchEnabled=f,this._commerceAllowed=m,this._appMinorVersion=h,this._requirementMatrix=g,this._hostCustomMessage=v,this._hostFullVersion=y,this._isDialog=!1,this._clientWindowHeight=_,this._clientWindowWidth=C,this._addinName=S,this._appDomains=A,this._dialogRequirementMatrix=b,this.get_id=function(){return this._id},this.get_appName=function(){return this._appName},this.get_appVersion=function(){return this._appVersion},this.get_appUILocale=function(){return this._appUILocale},this.get_dataLocale=function(){return this._dataLocale},this.get_docUrl=function(){return this._docUrl},this.get_clientMode=function(){return this._clientMode},this.get_bindings=function(){return this._bindings},this.get_settings=function(){return this._settings},this.get_reason=function(){return this._reason},this.get_osfControlType=function(){return this._osfControlType},this.get_eToken=function(){return this._eToken},this.get_correlationId=function(){return this._correlationId},this.get_appInstanceId=function(){return this._appInstanceId},this.get_touchEnabled=function(){return this._touchEnabled},this.get_commerceAllowed=function(){return this._commerceAllowed},this.get_appMinorVersion=function(){return this._appMinorVersion},this.get_requirementMatrix=function(){return this._requirementMatrix},this.get_dialogRequirementMatrix=function(){return this._dialogRequirementMatrix},this.get_hostCustomMessage=function(){return this._hostCustomMessage},this.get_hostFullVersion=function(){return this._hostFullVersion},this.get_isDialog=function(){return this._isDialog},this.get_clientWindowHeight=function(){return this._clientWindowHeight},this.get_clientWindowWidth=function(){return this._clientWindowWidth},this.get_addinName=function(){return this._addinName},this.get_appDomains=function(){return this._appDomains}},l.OsfControlType={DocumentLevel:0,ContainerLevel:1},l.ClientMode={ReadOnly:0,ReadWrite:1},l.OUtil.setNamespace("Microsoft",window),l.OUtil.setNamespace("Office",Microsoft),l.OUtil.setNamespace("Client",Microsoft.Office),l.OUtil.setNamespace("WebExtension",Microsoft.Office),Microsoft.Office.WebExtension.InitializationReason={Inserted:"inserted",DocumentOpened:"documentOpened"},Microsoft.Office.WebExtension.ValueFormat={Unformatted:"unformatted",Formatted:"formatted"},Microsoft.Office.WebExtension.FilterType={All:"all"},Microsoft.Office.WebExtension.Parameters={BindingType:"bindingType",CoercionType:"coercionType",ValueFormat:"valueFormat",FilterType:"filterType",Columns:"columns",SampleData:"sampleData",GoToType:"goToType",SelectionMode:"selectionMode",Id:"id",PromptText:"promptText",ItemName:"itemName",FailOnCollision:"failOnCollision",StartRow:"startRow",StartColumn:"startColumn",RowCount:"rowCount",ColumnCount:"columnCount",Callback:"callback",AsyncContext:"asyncContext",Data:"data",Rows:"rows",OverwriteIfStale:"overwriteIfStale",FileType:"fileType",EventType:"eventType",Handler:"handler",SliceSize:"sliceSize",SliceIndex:"sliceIndex",ActiveView:"activeView",Status:"status",PlatformType:"platformType",HostType:"hostType",ForceConsent:"forceConsent",ForceAddAccount:"forceAddAccount",AuthChallenge:"authChallenge",Reserved:"reserved",Xml:"xml",Namespace:"namespace",Prefix:"prefix",XPath:"xPath",Text:"text",ImageLeft:"imageLeft",ImageTop:"imageTop",ImageWidth:"imageWidth",ImageHeight:"imageHeight",TaskId:"taskId",FieldId:"fieldId",FieldValue:"fieldValue",ServerUrl:"serverUrl",ListName:"listName",ResourceId:"resourceId",ViewType:"viewType",ViewName:"viewName",GetRawValue:"getRawValue",CellFormat:"cellFormat",TableOptions:"tableOptions",TaskIndex:"taskIndex",ResourceIndex:"resourceIndex",CustomFieldId:"customFieldId",Url:"url",MessageHandler:"messageHandler",Width:"width",Height:"height",RequireHTTPs:"requireHTTPS",MessageToParent:"messageToParent",DisplayInIframe:"displayInIframe",MessageContent:"messageContent",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels",AppCommandInvocationCompletedData:"appCommandInvocationCompletedData",Base64:"base64",FormId:"formId"},l.OUtil.setNamespace("DDA",l),l.DDA.DocumentMode={ReadOnly:1,ReadWrite:0},l.DDA.PropertyDescriptors={AsyncResultStatus:"AsyncResultStatus"},l.DDA.EventDescriptors={},l.DDA.ListDescriptors={},l.DDA.UI={},l.DDA.getXdmEventName=function(e,t){return t==Microsoft.Office.WebExtension.EventType.BindingSelectionChanged||t==Microsoft.Office.WebExtension.EventType.BindingDataChanged||t==Microsoft.Office.WebExtension.EventType.DataNodeDeleted||t==Microsoft.Office.WebExtension.EventType.DataNodeInserted||t==Microsoft.Office.WebExtension.EventType.DataNodeReplaced?e+"_"+t:t},l.DDA.MethodDispId={dispidMethodMin:64,dispidGetSelectedDataMethod:64,dispidSetSelectedDataMethod:65,dispidAddBindingFromSelectionMethod:66,dispidAddBindingFromPromptMethod:67,dispidGetBindingMethod:68,dispidReleaseBindingMethod:69,dispidGetBindingDataMethod:70,dispidSetBindingDataMethod:71,dispidAddRowsMethod:72,dispidClearAllRowsMethod:73,dispidGetAllBindingsMethod:74,dispidLoadSettingsMethod:75,dispidSaveSettingsMethod:76,dispidGetDocumentCopyMethod:77,dispidAddBindingFromNamedItemMethod:78,dispidAddColumnsMethod:79,dispidGetDocumentCopyChunkMethod:80,dispidReleaseDocumentCopyMethod:81,dispidNavigateToMethod:82,dispidGetActiveViewMethod:83,dispidGetDocumentThemeMethod:84,dispidGetOfficeThemeMethod:85,dispidGetFilePropertiesMethod:86,dispidClearFormatsMethod:87,dispidSetTableOptionsMethod:88,dispidSetFormatsMethod:89,dispidExecuteRichApiRequestMethod:93,dispidAppCommandInvocationCompletedMethod:94,dispidCloseContainerMethod:97,dispidGetAccessTokenMethod:98,dispidOpenBrowserWindow:102,dispidCreateDocumentMethod:105,dispidInsertFormMethod:106,dispidDisplayRibbonCalloutAsyncMethod:109,dispidGetSelectedTaskMethod:110,dispidGetSelectedResourceMethod:111,dispidGetTaskMethod:112,dispidGetResourceFieldMethod:113,dispidGetWSSUrlMethod:114,dispidGetTaskFieldMethod:115,dispidGetProjectFieldMethod:116,dispidGetSelectedViewMethod:117,dispidGetTaskByIndexMethod:118,dispidGetResourceByIndexMethod:119,dispidSetTaskFieldMethod:120,dispidSetResourceFieldMethod:121,dispidGetMaxTaskIndexMethod:122,dispidGetMaxResourceIndexMethod:123,dispidCreateTaskMethod:124,dispidAddDataPartMethod:128,dispidGetDataPartByIdMethod:129,dispidGetDataPartsByNamespaceMethod:130,dispidGetDataPartXmlMethod:131,dispidGetDataPartNodesMethod:132,dispidDeleteDataPartMethod:133,dispidGetDataNodeValueMethod:134,dispidGetDataNodeXmlMethod:135,dispidGetDataNodesMethod:136,dispidSetDataNodeValueMethod:137,dispidSetDataNodeXmlMethod:138,dispidAddDataNamespaceMethod:139,dispidGetDataUriByPrefixMethod:140,dispidGetDataPrefixByUriMethod:141,dispidGetDataNodeTextMethod:142,dispidSetDataNodeTextMethod:143,dispidMessageParentMethod:144,dispidSendMessageMethod:145,dispidMethodMax:145},l.DDA.EventDispId={dispidEventMin:0,dispidInitializeEvent:0,dispidSettingsChangedEvent:1,dispidDocumentSelectionChangedEvent:2,dispidBindingSelectionChangedEvent:3,dispidBindingDataChangedEvent:4,dispidDocumentOpenEvent:5,dispidDocumentCloseEvent:6,dispidActiveViewChangedEvent:7,dispidDocumentThemeChangedEvent:8,dispidOfficeThemeChangedEvent:9,dispidDialogMessageReceivedEvent:10,dispidDialogNotificationShownInAddinEvent:11,dispidDialogParentMessageReceivedEvent:12,dispidObjectDeletedEvent:13,dispidObjectSelectionChangedEvent:14,dispidObjectDataChangedEvent:15,dispidContentControlAddedEvent:16,dispidActivationStatusChangedEvent:32,dispidRichApiMessageEvent:33,dispidAppCommandInvokedEvent:39,dispidOlkItemSelectedChangedEvent:46,dispidOlkRecipientsChangedEvent:47,dispidOlkAppointmentTimeChangedEvent:48,dispidOlkRecurrenceChangedEvent:49,dispidTaskSelectionChangedEvent:56,dispidResourceSelectionChangedEvent:57,dispidViewSelectionChangedEvent:58,dispidDataNodeAddedEvent:60,dispidDataNodeReplacedEvent:61,dispidDataNodeDeletedEvent:62,dispidEventMax:63},l.Constants={FileVersion:"16.0.10204.10000",ThreePartsFileVersion:"16.0.10204",OmexAnonymousServiceExtension:"/anonymousserviceextension.aspx",OmexGatedServiceExtension:"/gatedserviceextension.aspx",OmexUnGatedServiceExtension:"/ungatedserviceextension.aspx",OmexConsentNotificationPage:"/client/consentnotification.aspx",Http:"http",Https:"https",ProtocolSeparator:"://",SignInRedirectUrl:"/logontoliveforwac.aspx?returnurl=",ETokenParameterName:"et",ActivatedCacheKey:"__OSF_RUNTIME_.Activated.{0}.{1}.{2}",AuthenticatedConnectMaxTries:3,IgnoreSandBoxSupport:"Ignore_SandBox_Support",IEUpgradeUrl:"https://office.microsoft.com/redir/HA102789344.aspx",OmexForceAnonymousParamName:"SKAV",OmexForceAnonymousParamValue:"274AE4CD-E50B-4342-970E-1E7F36C70037",EndPointInternalSuffix:"_internal",PreloadOfficeJsId:"OFFICEJSPRELOAD",PreloadOfficeJsUrl:"//appsforoffice.microsoft.com/preloading/preloadoffice.js",StringResourceFile:"osfruntime_strings.js"};var c,u,d,p,f,m,h=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)};(function(e){var t="ov:Description",n="bt:Image",r="ov:VersionOverrides",i="o:OfficeApp",a=null,o=function(e){this.name="AddinManifestError",this.message=this.name+": "+e},s=function(e){this.name="AddinInternalError",this.message=e};function l(e,t){if(e==a)throw new o(t)}var c=function(){function e(e){this.Images={},this.Urls={},this.LongStrings={},this.ShortStrings={};var t=e.manifest._xmlProcessor.selectSingleNode(i),a=e.selectSingleNode(t,[r,"ov:Resources"]);this.parseCollection(e,e.selectChildNodes(n,a,["bt:Images"]),this.Images),this.parseCollection(e,e.selectChildNodes("bt:Url",a,["bt:Urls"]),this.Urls),this.parseCollection(e,e.selectChildNodes("bt:String",a,["bt:LongStrings"]),this.LongStrings),this.parseCollection(e,e.selectChildNodes("bt:String",a,["bt:ShortStrings"]),this.ShortStrings)}return e.prototype.parseCollection=function(e,t,n){for(var r=t.length,i=0;i<r;i++){var a=t[i];n[a.getAttribute("id")]=e.parseLocaleAwareSettingsAndGetValue(a)}},e}();e.ManifestResourceManager=c;var u=function(){function e(e,t,n,r){this.hostType=e,this.formFactor=t,this.entitlement=n,this.manifest=r,this.resources=new c(this)}return e.prototype.parseIdRequired=function(e){var t=e.getAttribute("id");return l(t,"Id required"),t},e.prototype.parseLabel=function(e){var t=this.manifest._xmlProcessor.selectSingleNode("ov:Label",e);return t!=a?this.getShortString(t):a},e.prototype.parseLabelRequired=function(e){var t=this.parseLabel(e);return l(t,"Label required"),t},e.prototype.parseRequiredSuperTip=function(e){var t=this.parseSuperTip(e);return l(t,"SuperTip required"),t},e.prototype.parseSuperTip=function(e){var n=a,r=this.manifest._xmlProcessor.selectSingleNode("ov:Supertip",e);if(r!=a){var i,o=r;l(r=this.manifest._xmlProcessor.selectSingleNode("ov:Title",o),"Title is necessary for SuperTip."),i=this.getShortString(r),l(r=this.manifest._xmlProcessor.selectSingleNode(t,o),"Description is necessary for SuperTip."),n={title:i,description:this.getLongString(r)}}return n},e.prototype.parseRequiredIcon=function(e){var t=this.parseIcon(e);return l(t,"Icon required"),t},e.prototype.parseIcon=function(e){var t=this.selectChildNodes(n,e,["ov:Icon"]),r=t.length;if(0==r)return a;for(var i={},o=0;o<r;o++){var s=t[o];i[s.getAttribute("size")]=this.getImageResource(s)}return i},e.prototype.parseChildControls=function(e,t,n){var r=this.manifest._xmlProcessor.selectNodes(e,t);return this.parseControls(r,n)},e.prototype.parseControls=function(e,t){for(var n=[],r=e.length,i=0;i<r;i++){var a=t(this,e[i]);l(a,"parser must return a control."),n.push(a)}return n},e.prototype.parseControlInGroup=function(t){var n,r=t.getAttribute(e.typeAttributeName);switch(r){case"Menu":n=new _;break;case"Button":n=new S(r);break;default:throw new o("Unsupported control type.")}return n.parse(this,t),n},e.prototype.parseMenuItem=function(e){var t=new A;return t.parse(this,e),t},e.prototype.parseLocaleAwareSettingsAndGetValue=function(e){var t={},n=e.getAttribute("DefaultValue");t[this.manifest._defaultLocale]=n,t[this.manifest._defaultLocale.toLocaleLowerCase()]=n;var r=this.manifest._xmlProcessor.selectNodes("bt:Override",e);if(r)for(var i=r.length,a=0;a<i;a++){var o=(e=r[a]).getAttribute("Locale"),s=e.getAttribute("Value");t[o]=s,t[o.toLocaleLowerCase()]=s}return this.manifest._getDefaultValue(t)},e.prototype.selectSingleNode=function(e,t){if(t==a)return e;for(var n=0;n<t.length&&(e=this.manifest._xmlProcessor.selectSingleNode(t[n],e))!=a;n++);return e},e.prototype.selectChildNodes=function(e,t,n){return(t=this.selectSingleNode(t,n))==a?[]:this.manifest._xmlProcessor.selectNodes(e,t)},e.prototype.getResourceByNode=function(e,t){var n=t.getAttribute("resid"),r=e[n];return l(r,"resid: "+n+" not found"),r},e.prototype.getImageResource=function(e){return this.getResourceByNode(this.resources.Images,e)},e.prototype.getUrlResource=function(e){return this.getResourceByNode(this.resources.Urls,e)},e.prototype.getLongString=function(e){return this.getResourceByNode(this.resources.LongStrings,e)},e.prototype.getShortString=function(e){return this.getResourceByNode(this.resources.ShortStrings,e)},e.typeAttributeName="xsi:type",e}();e.ParsingContext=u;var d=function(){function e(){}return e.buildControls=function(e,t){for(var n=t.length,r=0;r<n;r++)t[r].apply(e)},e}(),p=function(e,t){this.functionFile=e,this.builder=t},f=function(){function e(){}return e.prototype.parse=function(e,n){var r=e.manifest._xmlProcessor,i=r.selectSingleNode("ov:Title",n);l(i,"Title is necessary for GetStarted."),this.title=e.getShortString(i);var a=r.selectSingleNode(t,n);l(a,"Description is necessary for GetStarted."),this.description=e.getLongString(a);var o=r.selectSingleNode("ov:LearnMoreUrl",n);this.learnMoreUrl=e.getUrlResource(o)},e}(),m=function(){function e(e){this.type=e}return e.prototype.buildAction=function(){},e.prototype.parse=function(){},e}(),g=function(e){function t(){e.apply(this,arguments)}return h(t,e),t.prototype.buildAction=function(e){return e.actionBuilder.buildShowTaskpane(this.sourceLocation,this.title,this.taskpaneId)},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n);var r=t.manifest._xmlProcessor.selectSingleNode("ov:TaskpaneId",n);r!=a&&(this.taskpaneId=r.firstChild.nodeValue),(r=t.manifest._xmlProcessor.selectSingleNode("ov:Title",n))!=a&&(this.title=t.getShortString(r))},t}(function(e){function t(){e.apply(this,arguments),this.title=a}return h(t,e),t.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode("ov:SourceLocation",t);l(n,"SourceLocation is necessary for ShowTaskpane action"),this.sourceLocation=e.getUrlResource(n),e.manifest.addManifestUrl(this.sourceLocation)},t}(m)),v=function(e){function t(){e.apply(this,arguments)}return h(t,e),t.prototype.buildAction=function(e){return l(e.functionFile,"Function file source url is necessary for ExecuteFunctionAction."),e.actionBuilder.buildCallFunction(e.functionFile,this.functionName,this.controlId)},t.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode("ov:FunctionName",t);l(n,"FunctionName is necessary for ExecuteFunctionAction."),this.functionName=e.manifest._xmlProcessor.getNodeValue(n)},t}(m),y=function(){function e(){}return e.prototype.parse=function(e,t){this.id=e.parseIdRequired(t),this.label=e.parseLabelRequired(t)},e}(),_=function(e){function t(){e.apply(this,arguments)}return h(t,e),t.prototype.apply=function(e){e.controlBuilder.startBuildMenu(this),d.buildControls(e,this.children),e.controlBuilder.endBuildMenu()},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.icon=t.parseRequiredIcon(n),this.superTip=t.parseRequiredSuperTip(n);var r=t.selectChildNodes("ov:Item",n,["ov:Items"]);this.children=t.parseControls(r,function(e,t){return e.parseMenuItem(t)})},t}(y),C=function(e){function t(t){e.call(this),this.controlType=t}return h(t,e),t.prototype.apply=function(e){var t=this.action.buildAction(e),n={id:this.id,label:this.label,icon:this.icon,superTip:this.superTip,actionType:this.actionType,action:t};this.applyControl(e,n)},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.icon=this.parseIcon(t,n),this.superTip=t.parseRequiredSuperTip(n);var r=t.manifest._xmlProcessor.selectSingleNode("ov:Action",n);l(r,"Action is necessary for itemControl.");var i,a=r.getAttribute(u.typeAttributeName);switch(a){case"ShowTaskpane":i=new g(a);break;case"ExecuteFunction":(i=new v(a)).controlId=this.id;break;default:throw new o("Unsupported action type.")}i.parse(t,r),this.actionType=a,this.action=i},t.prototype.applyControl=function(){throw new s("Not implemented method applyControl for ItemControl.")},t.prototype.parseIcon=function(e,t){return e.parseIcon(t)},t}(y),S=function(e){function t(){e.apply(this,arguments)}return h(t,e),t.prototype.applyControl=function(e,t){e.controlBuilder.addButton(t)},t.prototype.parseIcon=function(e,t){return e.parseRequiredIcon(t)},t}(C),A=function(e){function t(){e.call(this,"MenuItem")}return h(t,e),t.prototype.applyControl=function(e,t){e.controlBuilder.addMenuItem(t)},t}(C),b=function(){function e(e){this.label=a,this.isOfficeTab=!1,this.children=[],this.isOfficeTab=e}return e.prototype.apply=function(e){e.builder.ribbonBuilder.startBuildTab(this);for(var t=this.children.length,n=0;n<t;n++)this.children[n].apply(e);e.builder.ribbonBuilder.endBuildTab()},e.prototype.parse=function(e,t){this.id=e.parseIdRequired(t),this.isOfficeTab||(this.label=e.parseLabelRequired(t)),this.children=e.parseChildControls("ov:Group",t,function(e,t){var n=new I;return n.parse(e,t),n})},e}(),I=function(e){function t(){e.apply(this,arguments)}return h(t,e),t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.icon=t.parseRequiredIcon(n),this.children=t.parseChildControls("ov:Control",n,function(e,t){return e.parseControlInGroup(t)})},t.prototype.apply=function(e){e.builder.ribbonBuilder.startBuildGroup(this),d.buildControls({functionFile:e.functionFile,actionBuilder:e.builder.actionBuilder,controlBuilder:e.builder.ribbonBuilder},this.children),e.builder.ribbonBuilder.endBuildGroup()},t}(y),O=function(){function e(e){this.type=e,this.tabs=[]}return e.prototype.apply=function(e){if(this.type==e.builder.commandSurface)for(var t=this.tabs.length,n=0;n<t;n++)this.tabs[n].apply(e)},e.prototype.parse=function(e,t){var n,r=e.manifest._xmlProcessor.selectSingleNode("ov:OfficeTab",t);r!=a&&((n=new b(!0)).parse(e,r),this.tabs.push(n)),(r=e.manifest._xmlProcessor.selectSingleNode("ov:CustomTab",t))!=a&&((n=new b(!1)).parse(e,r),this.tabs.push(n))},e}(),x=function(){function e(){}return e.prototype.parse=function(e,t){this.id=e.parseIdRequired(t),this.children=e.parseChildControls("ov:Control",t,function(e,t){return e.parseControlInGroup(t)})},e.prototype.apply=function(e){e.controlBuilder.startBuildMenu({id:this.id,label:a,superTip:a}),d.buildControls(e,this.children),e.controlBuilder.endBuildMenu()},e}(),E=function(){function e(e){this.type=e}return e.prototype.apply=function(e){this.type==e.builder.commandSurface&&d.buildControls({functionFile:e.functionFile,actionBuilder:e.builder.actionBuilder,controlBuilder:e.builder.contextMenuBuilder},this.children)},e.prototype.parse=function(e,t){this.children=e.parseChildControls("ov:OfficeMenu",t,function(e,t){var n=new x;return n.parse(e,t),n})},e}(),T=function(){function e(e){this.type=e}return e.prototype.apply=function(){},e.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode("ov:Namespace",t);if(n&&(this.namespaceResId=n.getAttribute("resid")),!this.namespaceResId)throw new o("Missing required <Namespace> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var r=e.manifest._xmlProcessor.selectSingleNode("ov:Script",t);if(r&&(this.scriptResId=this._parseSourceLocationResId(e,r)),!this.scriptResId)throw new o("Missing required <Script> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var i=e.manifest._xmlProcessor.selectSingleNode("ov:Page",t);if(i&&(this.pageResId=this._parseSourceLocationResId(e,i)),!this.pageResId)throw new o("Missing required <Page> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var a=e.manifest._xmlProcessor.selectSingleNode("ov:Metadata",t);if(a&&(this.metadataResId=this._parseSourceLocationResId(e,a)),!this.metadataResId)throw new o("Missing required <Metadata> element under element <ExtensionPoint xsi:type='CustomFunctions'>.")},e.prototype._parseSourceLocationResId=function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode("ov:SourceLocation",t);if(n)return n.getAttribute("resid")},e}();e.CustomFunctionsExtensionPoint=T;var M=function(){function e(){this.getStartedNode=a,this.functionFile=a,this.cacheableUrls=[],this.ExtensionPoints=[]}return e.prototype.cacheableResources=function(){return this.cacheableUrls},e.prototype.apply=function(e,t){try{e.startApplyAddin({entitlement:this.extensionEntitlement,manifest:this.extensionManifest,startedNode:this.getStartedNode,overrides:{type:this.type,description:this.description}});for(var n=new p(this.functionFile,e),r=this.ExtensionPoints.length,i=0;i<r;i++)this.ExtensionPoints[i].apply(n);e.endApplyAddin()}catch(e){throw e instanceof o&&t.setErrorMessageForAddin(this.extensionEntitlement.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),e}},e.prototype.parse=function(e,n){this.type=n.getAttribute(u.typeAttributeName);var r=e.manifest._xmlProcessor.selectSingleNode(t,n);r!=a&&(this.description=e.getLongString(r));for(var i=e.selectChildNodes("ov:Host",n,["ov:Hosts"]),s=a,l=i.length,c=0;c<l;c++){var d=i[c];if(d.getAttribute(u.typeAttributeName)==e.hostType){(s=e.manifest._xmlProcessor.selectSingleNode("ov:"+e.formFactor,d))==a&&(s=e.manifest._xmlProcessor.selectSingleNode("ov:AllFormFactors",d));break}}var p=e.manifest._xmlProcessor.selectSingleNode("ov:GetStarted",s);p!=a&&(this.getStartedNode=new f,this.getStartedNode.parse(e,p)),(r=e.manifest._xmlProcessor.selectSingleNode("ov:FunctionFile",s))!=a&&(this.functionFile=e.getUrlResource(r),e.manifest.addManifestUrl(this.functionFile));var m=e.manifest._xmlProcessor.selectNodes("ov:ExtensionPoint",s);for(l=m.length,c=0;c<l;c++){var h,g=m[c],v=g.getAttribute(u.typeAttributeName);switch(v){case"Events":throw"Not Implemented";case"PrimaryCommandSurface":h=new O(v);break;case"ContextMenu":h=new E(v);break;case"CustomFunctions":h=new T(v);break;default:throw new o("Unsupported extension type.")}h.parse(e,g),this.ExtensionPoints.push(h)}var y=e.resources.Images;for(var _ in y)this.cacheableUrls.push(y[_]);this.extensionEntitlement=e.entitlement,this.extensionManifest=e.manifest},e}();e.VersionOverrides=M;var k=function(){function e(){}return e.prototype.cacheableResources=function(){return[]},e.prototype.apply=function(){},e}(),P=function(){function e(e,t){this.hostType=e,this.formFactor=t}return e.prototype.parseExtensions=function(e,t,n){try{var s=t._xmlProcessor.selectSingleNode(i),l=t._xmlProcessor.selectSingleNode(r,s);if(l==a)return new k;var c=new M;return c.parse(new u(this.hostType,this.formFactor,e,t),l),c}catch(t){throw t instanceof o&&n.setErrorMessageForAddin(e.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),t}},e}();e.AddinCommandsManifestParser=P})((c=ne||(ne={})).Parser||(c.Parser={})),u=ne||(ne={}),d=function(){function e(){}return e.createManifestForAddinAction=function(e,t,n,r){var i=new l.Manifest.ExtensionSettings,a=(l.FormFactor.Default,{}),o=e._UILocale.toLocaleLowerCase();a[o]=n,i._defaultHeight=null,i._defaultWidth=null,i._sourceLocations={},i._sourceLocations[o]=t;var s=e;return new l.Manifest.Manifest(function(e){e._xmlProcessor=s._xmlProcessor,e._displayNames=null!=n?a:s._displayNames,e._iconUrls=s._iconUrls,e._extensionSettings={formFactor:i},e._highResolutionIconUrls=s._highResolutionIconUrls,e._target=s._target,e._id=null!=r?r:s._id,e._version=s._version,e._providerName=s._providerName,e._idIssuer=s._idIssuer,e._alternateId=s._alternateId,e._defaultLocale=s._defaultLocale,e._signature=s._signature,e._capabilities=s._capabilities,e._hosts=s._hosts,e._descriptions=s._descriptions,e._appDomains=s._appDomains,e._permissions=s._permissions,e._requirements=s._requirements,e._webApplicationResource=s._webApplicationResource,e._webApplicationId=s._webApplicationId,e._webApplicationScopes=s._webApplicationScopes},s._UILocale)},e.cacheManifestForAction=function(e,t,n){l.OsfManifestManager.cacheManifest(t,n,e)},e.purgeManifestForAction=function(e,t){l.OsfManifestManager.purgeManifest(e,t)},e}(),u.AddinCommandsManifestManager=d,function(e){var t="##UILessContainer##";e.AddinActionContextMap={},e.AutoShowTaskPaneControlIdMap={};var n,r={};(n=e.CommandInvokeMode||(e.CommandInvokeMode={}))[n.Default=1]="Default",n[n.ExclusiveForCur=2]="ExclusiveForCur",n[n.ExclusiveForNew=3]="ExclusiveForNew";var i,a,o,s=e.CommandInvokeMode;a=i||(i={}),o="ooeOperationNotSupported",a[a.ooeTimeout=-1]="ooeTimeout",a[a.ooeSuccess=0]="ooeSuccess",a[a[o]=5e3]=o;var c=function(){function n(e,t,n){this.contextProvider=e,this.manifest=n,this.entitlement=t}return n.prototype.buildShowTaskpane=function(e,t,n){return this.CreateManifestAndActivationContextForTaskpaneCommand(e,t,n)},n.prototype.buildCallFunction=function(e,t,n){return this.CreateManifestAndActivationContextForUILessCommand(e,t,n)},n.prototype.CreateManifestAndActivationContextForTaskpaneCommand=function(e,t,n){var a=function(e,t){t==i.ooeSuccess&&null!=n&&(r[n]=e)};return this.CreateManifestAndActivationContext(e,t,n,function(e,t,i,o){null!=n&&function(e,t){var n=r[e];if(null==n)return!1;var i=t.getOsfControl(n);null!=i&&i._refresh()}(n,t),e.showTaskpane(i,o,a)})},n.prototype.CreateManifestAndActivationContext=function(t,n,r,i){var a=this,o=e.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,t,n,null);return function(t){var n=a.contextProvider.createActionContext(t,function(n,s){var c={assetId:a.entitlement.assetId+(r||t),appVersion:a.entitlement.appVersion,storeId:a.entitlement.storeId,storeType:l.StoreType.InMemory,targetType:l.OsfControlTarget.TaskPane};o._inMemoryEToken=a.entitlement.eToken,e.AddinCommandsManifestManager.cacheManifestForAction(o,c.assetId,c.appVersion),i(n,s,c,o)});e.AddinActionContextMap[t]=n,null==e.AutoShowTaskPaneControlIdMap[a.entitlement.assetId]&&"Office.AutoShowTaskpaneWithDocument"==r&&(e.AutoShowTaskPaneControlIdMap[a.entitlement.assetId]=t)}},n.prototype.CreateManifestAndActivationContextForUILessCommand=function(n,r,a){var o=this,s=e.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,n,null,null);return function(n){var c=o.contextProvider.createActionContext(n,function(n){var c={assetId:o.entitlement.assetId+t,appVersion:o.entitlement.appVersion,storeId:o.entitlement.storeId,storeType:l.StoreType.InMemory,targetType:l.OsfControlTarget.TaskPane};e.AddinCommandsManifestManager.cacheManifestForAction(s,c.assetId,c.appVersion),n.createUILessSandbox(c,s,function(e,t){if(t==i.ooeSuccess)f.ensureOsfHostEntry(e,n);!function(e,t){if(t==i.ooeSuccess){var n={source:{id:a}};f.invokeAppCommand(e,r,n,function(){})}}(e,t)})});e.AddinActionContextMap[n]=c}},n}(),u=function(){function n(e,t){this.contextProvider=e,this.entitlement=t}return n.prototype.buildShowTaskpane=function(){var t=this;return function(n){delete e.AddinActionContextMap[n],e.AddinCommandsManifestManager.purgeManifestForAction(t.entitlement.assetId+n,t.entitlement.appVersion)}},n.prototype.buildCallFunction=function(){var n=this;return function(r){delete e.AddinActionContextMap[r],e.AddinCommandsManifestManager.purgeManifestForAction(n.entitlement.assetId+t,n.entitlement.appVersion)}},n}(),d=function(){function t(){}return t.createActionBuilder=function(e,t,n){return new c(e,t,n)},t.createDeleterActionBuilder=function(e,t){return new u(e,t)},t.bindAction=function(e,t){t(e)},t.retrieveActionContext=function(t){return e.AddinActionContextMap[t]},t.retrieveAutoShowTaskPaneControlIdMap=function(){return e.AutoShowTaskPaneControlIdMap},t}();e.DefaultControlActionBinder=d;var p=function(){function e(){this.invocationQueue={}}return e.prototype.invokeAppCommand=function(t,n,r,i,a){var o={dispid:l.DDA.EventDispId.dispidAppCommandInvokedEvent,controlId:this.osfControlId};o[0]=t,o[1]=n,o[2]=JSON.stringify(r),a=a||e.defaultTimeout;var c=r&&r.commandMode?r.commandMode:s.Default,u={args:o,onComplete:i,timeout:a,timeoutTimer:null},d=this.invocationQueue[n];null==d&&(d=[],this.invocationQueue[n]=d),!(c==s.ExclusiveForCur&&d.length>0)&&!(c==s.ExclusiveForNew&&d.length>1)&&d.push(u),1==d.length&&this.trySendInvocation(u)},e.prototype.invocationCompleted=function(e,t,n){var r=this;for(var i in this.invocationQueue){var a=this.invocationQueue[i],o=a[0];if(e==o.args[0]){if(a.length>1){a.splice(0,1);var s=a[0];window.setTimeout(function(){r.trySendInvocation(s)},0)}else delete this.invocationQueue[i];return null!=o.timeoutTimer&&(window.clearTimeout(o.timeoutTimer),o.timeoutTimer=null),void o.onComplete(t,n)}}},e.prototype.sendInvocations=function(e){if(this.eventHandler=e,null!=e)for(var t in this.invocationQueue){var n=this.invocationQueue[t][0];this.sendInvocation(e,n)}},e.prototype.trySendInvocation=function(e){var t=this.eventHandler;null!=t&&this.sendInvocation(t,e)},e.prototype.sendInvocation=function(e,t){var n=this,r=t.args;e(r),t.timeoutTimer=window.setTimeout(function(){n.invocationTimeout(r[0])},t.timeout)},e.prototype.invocationTimeout=function(e){this.invocationCompleted(e,i.ooeTimeout,null)},e.prototype.disposeHost=function(){for(var e in this.invocationQueue)return;this.host.disposeHost(this.osfControlId),null!=this.onDisposed&&this.onDisposed(this)},e.defaultTimeout=3e5,e}(),f=function(){function e(){}return e.registerEvent=function(t,n,r){e.registerEventInternal(r.eventDispId,r.controlId,r.targetId,t,function(e){n&&n(0==e)})},e.unregisterEvent=function(t,n,r){e.unregisterEventInternal(r.eventDispId,r.controlId,r.targetId,t,function(e){n&&n(0==e)})},e.invokeAppCommand=function(t,n,r,i){var a=e.getOrCreateOsfHostEntry(t),o=e.getNextAppCommandId();a.invokeAppCommand(o,n,r,i)},e.invocationCompleted=function(t,n){var r=e.getOrCreateOsfHostEntry(t),i=n[0],a=n[1],o=n[2]?JSON.parse(n[2]):null;r.invocationCompleted(i,a,o)},e.ensureOsfHostEntry=function(t,n){var r=e.getOrCreateOsfHostEntry(t);return null==r.host&&(r.host=n),r},e.getNextAppCommandId=function(){return"AppCmd"+e._nextAppCommandId++},e.getOrCreateOsfHostEntry=function(t){var n=e._invocationQueues[t];return null==n&&((n=new p).osfControlId=t,n.onDisposed=function(t){delete e._invocationQueues[t.osfControlId]},e._invocationQueues[t]=n),n},e.registerEventInternal=function(t,n,r,a,o){switch(t){case l.DDA.EventDispId.dispidAppCommandInvokedEvent:var s=e.getOrCreateOsfHostEntry(n);return o(i.ooeSuccess),void s.sendInvocations(a)}o(i.ooeOperationNotSupported)},e.unregisterEventInternal=function(t,n,r,a,o){switch(t){case l.DDA.EventDispId.dispidAppCommandInvokedEvent:var s=e.getOrCreateOsfHostEntry(n);return s.eventHandler==a&&(s.eventHandler=null),void o(i.ooeSuccess)}o(i.ooeOperationNotSupported)},e._nextAppCommandId=0,e._invocationQueues={},e}();e.AddinCommandsRuntimeManager=f}(ne||(ne={})),l.ShowWindowDialogParameterKeys={Url:"url",Width:"width",Height:"height",DisplayInIframe:"displayInIframe",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels"},l.HostThemeButtonStyleKeys={ButtonBorderColor:"buttonBorderColor",ButtonBackgroundColor:"buttonBackgroundColor"},l.OmexPageParameterKeys={AppName:"client",AppVersion:"cv",AppUILocale:"ui",AppDomain:"appDomain",StoreLocator:"rs",AssetId:"assetid",NotificationType:"notificationType",AppCorrelationId:"corr",AuthType:"authType",AppId:"appid",Scopes:"scopes"},l.AuthType={Anonymous:0,MSA:1,OrgId:2,ADAL:3},l.OmexMessageKeys={MessageType:"messageType",MessageValue:"messageValue"},l.OmexRemoveAddinMessageKeys={RemoveAddinResultCode:"resultCode",RemoveAddinResultValue:"resultValue"},l.OmexRemoveAddinResultCode={Success:0,ClientError:400,ServerError:500,UnknownError:600},function(e){var t="^https://[a-z0-9-]+.(officeapps.live|officeapps-df.live|partner.officewebapps).com/";function n(e){if("undefined"!=typeof JSON)try{return JSON.stringify(e)}catch(e){}return""}function r(){try{var e=window.navigator.userAgent;return e.indexOf("MSIE ")>-1||e.indexOf("Trident/")>-1||e.indexOf("Edge/")>-1}catch(e){return i("Error happens in isInternetExplorer.",e),!1}}function i(e,t){s.msAjaxDebug.trace(e+" Exception details: "+n(t))}e.parseAppContextFromWindowName=function(e,t){return l.OUtil.parseInfoFromWindowName(e,t,l.WindowNameItemKeys.AppContext)},e.serializeObjectToString=n,e.isHostTrusted=function(){return new RegExp(t).test(l.getClientEndPoint()._targetUrl.toLowerCase())},e.addHostInfoAsQueryParam=function(e,t){if(!e)return null;var n,r="#",i=(e=e.trim()||"").split(r),a=i.shift(),o=i.join(r),s=a.split("?");return s.length>1?n=a+"&_host_Info="+t:s.length>0&&(n=a+"?_host_Info="+t),o?[n,r,o].join(""):n},e.getDomainForUrl=function(e){if(!e)return null;var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host},e.shouldUseLocalStorageToPassMessage=function(){try{for(var e=["Windows NT 6.1","Windows NT 6.2","Windows NT 6.3"],t=window.navigator.userAgent,n=0,a=e.length;n<a;n++)if(t.indexOf(e[n])>-1)return r();return!1}catch(e){return i("Error happens in shouldUseLocalStorageToPassMessage.",e),!1}},e.isInternetExplorer=r,e.removeMatchesFromLocalStorage=function(e){for(var t=l.OUtil.getLocalStorage(),n=t.getKeysWithPrefix(""),r=0,i=n.length;r<i;r++)for(var a=n[r],o=0,s=e.length;o<s;o++)if(e[o].test(a)){t.removeItem(a);break}},e.logExceptionToBrowserConsole=i;var a=function(){function e(){}return e.GatedCacheKeyPrefix="__OSF_GATED_OMEX.",e.AuthenticatedAppInstallInfoCacheKey=e.GatedCacheKeyPrefix+"appinstall_authenticated.{0}.{1}.{2}.{3}",e.EntitlementsKey="entitle.{0}.{1}",e}();e.CacheConstants=a}((p=ne||(ne={})).WACUtils||(p.WACUtils={})),l.XmlConstants={MaxXmlSize:1048576,MaxElementDepth:64},l.Xpath3Provider=function(e,t){this._xmldoc=(new DOMParser).parseFromString(e,"text/xml"),this._evaluator=new XPathEvaluator,this._namespaceMapping={},this._defaultNamespace=null;for(var n,r=t.split(" "),i=0;i<r.length;++i)(n=/xmlns="([^"]*)"/g.exec(r[i]))?this._defaultNamespace=n[1]:(n=/xmlns:([^=]*)="([^"]*)"/g.exec(r[i]))&&(this._namespaceMapping[n[1]]=n[2]);this._resolver=this},l.Xpath3Provider.prototype={lookupNamespaceURI:function(e){return this._namespaceMapping[e]||this._defaultNamespace},addNamespaceMapping:function(e,t){return!this._namespaceMapping[e]&&(this._namespaceMapping[e]=t,!0)},selectSingleNode:function(e,t){var n=(t?"./":"/")+e;t=t||this.getDocumentElement();var r=this._evaluator.evaluate(n,t,this._resolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null);return r?r.singleNodeValue:null},selectNodes:function(e,t){var n=(t?"./":"/")+e;t=t||this.getDocumentElement();var r=this._evaluator.evaluate(n,t,this._resolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),i=[];if(r)for(var a=r.iterateNext();a;)i.push(a),a=r.iterateNext();return i},selectNodesByXPath:function(e,t){var n=this._evaluator.evaluate(e,t,this._resolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),r=[];if(n)for(var i=n.iterateNext();i;)r.push(i),i=n.iterateNext();return r},getDocumentElement:function(){return this._xmldoc.documentElement}},l.IEXpathProvider=function(e,t){for(var n=null,r=["MSXML2.DOMDocument.6.0"],i=0;i<r.length;i++)try{(n=new ActiveXObject(r[i])).setProperty("ResolveExternals",!1),n.setProperty("ValidateOnParse",!1),n.setProperty("ProhibitDTD",!0),n.setProperty("MaxXMLSize",l.XmlConstants.MaxXmlSize),n.setProperty("MaxElementDepth",l.XmlConstants.MaxElementDepth),n.async=!1,n.loadXML(e),n.setProperty("SelectionLanguage","XPath"),n.setProperty("SelectionNamespaces",t);break}catch(e){s.msAjaxDebug.trace("xml doc creating error:"+e)}this._xmldoc=n},l.IEXpathProvider.prototype={selectSingleNode:function(e,t){var n=(t?"./":"/")+e;return(t=t||this.getDocumentElement()).selectSingleNode(n)},addNamespaceMapping:function(e,t){var n="SelectionNamespaces",r=this._xmldoc.getProperty(n),i="xmlns:"+e+"=",a="xmlns:"+e+'="'+t+'"';return-1==r.indexOf(i)&&(r=r+" "+a,this._xmldoc.setProperty(n,r),!0)},selectNodes:function(e,t){var n=(t?"./":"/")+e;return(t=t||this.getDocumentElement()).selectNodes(n)},selectNodesByXPath:function(e,t){return t.selectNodes(e)},getDocumentElement:function(){return this._xmldoc.documentElement},getActiveXObject:function(){return this._xmldoc}},l.DomParserProvider=function(e,t){try{this._xmldoc=(new DOMParser).parseFromString(e,"text/xml")}catch(e){Sys.Debug.trace("xml doc creating error:"+e)}this._namespaceMapping={},this._defaultNamespace=null;for(var n,r=t.split(" "),i=0;i<r.length;++i)(n=/xmlns="([^"]*)"/g.exec(r[i]))?this._defaultNamespace=n[1]:(n=/xmlns:([^=]*)="([^"]*)"/g.exec(r[i]))&&(this._namespaceMapping[n[1]]=n[2])},l.DomParserProvider.prototype={addNamespaceMapping:function(e,t){return!this._namespaceMapping[e]&&(this._namespaceMapping[e]=t,!0)},selectSingleNode:function(e,t){var n=t||this._xmldoc,r=this._selectNodes(e,n);return 0===r.length?null:r[0]},selectNodes:function(e,t){var n=t||this._xmldoc;return this._selectNodes(e,n)},selectNodesByXPath:function(){return null},_selectNodes:function(e,t){var n=[];if(!e)return n;var r,i,a=e.split(":");if(1===a.length)r=null,i=a[0];else{if(2!==a.length)throw s.msAjaxError.argument("name");r=this._namespaceMapping[a[0]],i=a[1]}if(!t.hasChildNodes)return n;for(var o=t.childNodes,l=0;l<o.length;l++)i===this._removeNodePrefix(o[l].nodeName)&&r===o[l].namespaceURI&&n.push(o[l]);return n},_removeNodePrefix:function(e){var t=e.split(":");return 1===t.length?e:t[1]},getDocumentElement:function(){return this._xmldoc.documentElement}},l.XmlProcessor=function(e,t){var n=Function._validateParams(arguments,[{name:"xml",type:String,mayBeNull:!1},{name:"xmlNamespaces",type:String,mayBeNull:!1}]);if(n)throw n;document.implementation&&document.implementation.hasFeature("XPath","3.0")?this._provider=new l.Xpath3Provider(e,t):(this._provider=new l.IEXpathProvider(e,t),this._provider.getActiveXObject()||(this._provider=new l.DomParserProvider(e,t)))},l.XmlProcessor.prototype={addNamespaceMapping:function(e,t){var n=Function._validateParams(arguments,[{name:"namespacePrefix",type:String,mayBeNull:!1},{name:"namespaceUri",type:String,mayBeNull:!1}]);if(n)throw n;return this._provider.addNamespaceMapping(e,t)},selectSingleNode:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return this._provider.selectSingleNode(e,t)},selectNodes:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return this._provider.selectNodes(e,t)},selectNodesByXPath:function(e,t){var n=Function._validateParams(arguments,[{name:"xpath",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return t=t||this._provider.getDocumentElement(),this._provider.selectNodesByXPath(e,t)},getDocumentElement:function(){return this._provider.getDocumentElement()},getNodeValue:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.text?e.text:e.textContent},getNodeText:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return 9==this.getNodeType(e)?this.getNodeText(this.getDocumentElement()):e.text?e.text:e.textContent},setNodeText:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"text",type:String,mayBeNull:!1}]);if(n)throw n;if(9==this.getNodeType(e))return!1;try{e.text?e.text=t:e.textContent=t}catch(e){return!1}return!0},getNodeXml:function(e){var t,n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(n)throw n;return e.xml?t=e.xml:(t=(new XMLSerializer).serializeToString(e),2==this.getNodeType(e)&&(t=this.getNodeBaseName(e)+'="'+t+'"')),t},setNodeXml:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"xml",type:String,mayBeNull:!1}]);if(n)throw n;var r=new l.XmlProcessor(t,"");if(!r.isValidXml())return null;var i=r.getDocumentElement();try{e.parentNode.replaceChild(i,e)}catch(e){return null}return i},getNodeNamespaceURI:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.namespaceURI},getNodePrefix:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.prefix},getNodeBaseName:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return!e.nodeType||1!=e.nodeType&&2!=e.nodeType?e.nodeName:e.baseName?e.baseName:e.localName},getNodeType:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.nodeType},appendChild:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"childXml",type:String,mayBeNull:!1}]);if(n)throw n;var r=new l.XmlProcessor(t,"");if(!r.isValidXml())return null;var i=r.getDocumentElement();return e.appendChild(i),i},_getAttributeLocalName:function(e){return e.localName?e.localName:e.baseName},readAttributes:function(e,t,n){var r=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"attributesToRead",type:Object,mayBeNull:!1},{name:"objectToFill",type:Object,mayBeNull:!1}]);if(r)throw r;for(var i,a,o=0;o<e.attributes.length;o++){i=e.attributes[o],a=this._getAttributeLocalName(i);for(var s in t)a===s&&(n[t[s]]=i.value)}},isValidXml:function(){if(null==this.getDocumentElement())return!1;if(this._provider._xmldoc.getElementsByTagName("parsererror").length>0){var e=(new DOMParser).parseFromString("<","text/xml").getElementsByTagName("parsererror")[0].namespaceURI;return this._provider._xmldoc.getElementsByTagNameNS(e,"parsererror").length<=0}return!0}},function(e){var t=function(){function e(){}return e.prototype.Serialize=function(e){try{return JSON.stringify(e)}catch(e){return null}},e.prototype.Deserialize=function(e){try{return JSON.parse(e)}catch(e){return null}},e}();e.SafeSerializer=t;var n=function(){function e(e,t){this._localStorage=e,this._serializer=t}return e.prototype.GetCacheItem=function(t,n,r,i,a){void 0===n&&(n=!0),void 0===a&&(a=!0),this.ValidateCurrentCache();var o=this._localStorage.getItem(t);if(o){var s=this._serializer.Deserialize(o);if(void 0!==i&&i>0&&i-s.createdOn>0)this._localStorage.removeItem(t),r&&(r.cacheExpired=!0);else{if(!n)return s.data;var l=new Date;if(Math.abs(l.getTime()-s.createdOn)<e.msPerDay*s.refreshRate)return s.data;a&&(this._localStorage.removeItem(t),r&&(r.cacheExpired=!0))}}},e.prototype.SetCacheItem=function(t,n,r){r=r||e.defaultRefreshRateInDays;var i={data:n,createdOn:(new Date).getTime(),refreshRate:r};this._localStorage.setItem(t,this._serializer.Serialize(i))},e.prototype.RemoveCacheItem=function(e){this._localStorage.removeItem(e)},e.prototype.RemoveAll=function(e){for(var t=this._localStorage.getKeysWithPrefix(e),n=0,r=t.length;n<r;n++)this._localStorage.removeItem(t[n])},e.prototype.RemoveMatches=function(e){for(var t=this._localStorage.getKeysWithPrefix(""),n=0,r=t.length;n<r;n++)for(var i=t[n],a=0,o=e.length;a<o;a++)if(e[a].test(i)){this._localStorage.removeItem(i);break}},e.prototype.ValidateCurrentCache=function(){this._localStorage.getItem(e.cacheVersionKey)!=e.currentSchemaVersion&&(this.RemoveMatches([new RegExp("__OSF_(?!.*activated).*$","i")]),this._localStorage.setItem(e.cacheVersionKey,e.currentSchemaVersion))},e.defaultRefreshRateInDays=3,e.msPerDay=864e5,e.currentSchemaVersion="1",e.checkedCache=!1,e.cacheVersionKey="osfCacheVersion",e}();e.AppsDataCacheManager=n;var r=function(e){function t(t,n){e.call(this,t,n)}return h(t,e),t.prototype.GetRefreshToken=function(n,r){var i=l.OUtil.formatString(t._refreshTokenCacheKey,n,r);return e.prototype.GetCacheItem.call(this,i)},t.prototype.AddRefreshToken=function(n,r,i){var a=l.OUtil.formatString(t._refreshTokenCacheKey,r,i);e.prototype.SetCacheItem.call(this,a,n)},t.prototype.RemoveAll=function(){e.prototype.RemoveAll.call(this,t._refreshTokenCachePrefixKey)},t.prototype.RemoveRefreshToken=function(n,r){var i=l.OUtil.formatString(t._refreshTokenCacheKey,n,r);e.prototype.RemoveCacheItem.call(this,i)},t._refreshTokenCacheKey="_OSF_PRIVATECATALOG_REFRESHTOKEN_{0}_{1}",t._refreshTokenCachePrefixKey="_OSF_PRIVATECATALOG_REFRESHTOKEN",t}(n);e.TokenCacheManager=r}(ne||(ne={})),function(e){var t="Error",n="ResponseTime",r="Result",i="OperationMetadata",a="ErrorResult",o="AssetId",s="CorrelationId",l=function(){function e(e){this._table=e,this._fields={}}return Object.defineProperty(e.prototype,"Fields",{get:function(){return this._fields},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Table",{get:function(){return this._table},enumerable:!0,configurable:!0}),e.prototype.SerializeFields=function(){},e.prototype.SetSerializedField=function(e,t){void 0!==t&&null!==t&&(this._serializedFields[e]=t.toString())},e.prototype.SerializeRow=function(){return this._serializedFields={},this.SetSerializedField("Table",this._table),this.SerializeFields(),JSON.stringify(this._serializedFields)},e}();e.BaseUsageData=l;var c=function(e){var t="Stage11Time",n="Stage10Time",r="Stage9Time",i="Stage8Time",l="Stage7Time",c="Stage6Time",u="Stage5Time",d="Stage4Time",p="Stage3Time",f="Stage2Time",m="Stage1Time",g="InstanceId",v="ActivationInfo";function y(){e.call(this,"AppLoadTime")}return h(y,e),Object.defineProperty(y.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"AppInfo",{get:function(){return this.Fields.AppInfo},set:function(e){this.Fields.AppInfo=e},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,v,{get:function(){return this.Fields[v]},set:function(e){this.Fields[v]=e},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,g,{get:function(){return this.Fields[g]},set:function(e){this.Fields[g]=e},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,o,{get:function(){return this.Fields.AssetId},set:function(e){this.Fields.AssetId=e},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,m,{get:function(){return this.Fields[m]},set:function(e){this.Fields[m]=e},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,f,{get:function(){return this.Fields[f]},set:function(e){this.Fields[f]=e},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,p,{get:function(){return this.Fields[p]},set:function(e){this.Fields[p]=e},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,d,{get:function(){return this.Fields[d]},set:function(e){this.Fields[d]=e},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,u,{get:function(){return this.Fields[u]},set:function(e){this.Fields[u]=e},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,c,{get:function(){return this.Fields[c]},set:function(e){this.Fields[c]=e},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,l,{get:function(){return this.Fields[l]},set:function(e){this.Fields[l]=e},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:!0,configurable:!0}),y.prototype.SerializeFields=function(){this.SetSerializedField(s,this.CorrelationId),this.SetSerializedField("AppInfo",this.AppInfo),this.SetSerializedField(v,this.ActivationInfo),this.SetSerializedField(g,this.InstanceId),this.SetSerializedField(o,this.AssetId),this.SetSerializedField(m,this.Stage1Time),this.SetSerializedField(f,this.Stage2Time),this.SetSerializedField(p,this.Stage3Time),this.SetSerializedField(d,this.Stage4Time),this.SetSerializedField(u,this.Stage5Time),this.SetSerializedField(c,this.Stage6Time),this.SetSerializedField(l,this.Stage7Time),this.SetSerializedField(i,this.Stage8Time),this.SetSerializedField(r,this.Stage9Time),this.SetSerializedField(n,this.Stage10Time),this.SetSerializedField(t,this.Stage11Time),this.SetSerializedField(a,this.ErrorResult)},y}(l);e.AppLoadTimeUsageData=c;var u=function(e){var t="NotificationClickInfo";function n(){e.call(this,"AppNotification")}return h(n,e),Object.defineProperty(n.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:!0,configurable:!0}),n.prototype.SerializeFields=function(){this.SetSerializedField(s,this.CorrelationId),this.SetSerializedField(a,this.ErrorResult),this.SetSerializedField(t,this.NotificationClickInfo)},n}(l);e.AppNotificationUsageData=u;var d=function(e){function t(){e.call(this,"AppManagementMenu")}return h(t,e),Object.defineProperty(t.prototype,o,{get:function(){return this.Fields.AssetId},set:function(e){this.Fields.AssetId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:!0,configurable:!0}),t.prototype.SerializeFields=function(){this.SetSerializedField(o,this.AssetId),this.SetSerializedField(i,this.OperationMetadata),this.SetSerializedField(a,this.ErrorResult)},t}(l);e.AppManagementMenuUsageData=d;var p=function(e){var t="LastActiveTabCount",n="LastActiveTab",r="DialogState",i="TrustPageSessionTime",a="TotalSessionTime";function s(){e.call(this,"InsertionDialogSession")}return h(s,e),Object.defineProperty(s.prototype,o,{get:function(){return this.Fields.AssetId},set:function(e){this.Fields.AssetId=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:!0,configurable:!0}),s.prototype.SerializeFields=function(){this.SetSerializedField(o,this.AssetId),this.SetSerializedField(a,this.TotalSessionTime),this.SetSerializedField(i,this.TrustPageSessionTime),this.SetSerializedField(r,this.DialogState),this.SetSerializedField(n,this.LastActiveTab),this.SetSerializedField(t,this.LastActiveTabCount)},s}(l);e.InsertionDialogSessionUsageData=p;var f=function(e){function t(){e.call(this,"UploadFileDevCatelog")}return h(t,e),Object.defineProperty(t.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:!0,configurable:!0}),t.prototype.SerializeFields=function(){this.SetSerializedField(s,this.CorrelationId),this.SetSerializedField(i,this.OperationMetadata),this.SetSerializedField(a,this.ErrorResult)},t}(l);e.UploadFileDevCatelogUsageData=f;var m=function(e){var t="AppSizeHeight",n="AppSizeWidth",r="IsAppCommand",i="AppTargetType",a="AppVersion",o="StoreType";function l(){e.call(this,"UploadFileDevCatalogUsage")}return h(l,e),Object.defineProperty(l.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"AppId",{get:function(){return this.Fields.AppId},set:function(e){this.Fields.AppId=e},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:!0,configurable:!0}),l.prototype.SerializeFields=function(){this.SetSerializedField(s,this.CorrelationId),this.SetSerializedField(o,this.StoreType),this.SetSerializedField("AppId",this.AppId),this.SetSerializedField(a,this.AppVersion),this.SetSerializedField(i,this.AppTargetType),this.SetSerializedField(r,this.IsAppCommand),this.SetSerializedField(n,this.AppSizeWidth),this.SetSerializedField(t,this.AppSizeHeight)},l}(l);e.UploadFileDevCatalogUsageUsageData=m;var g=function(e){function i(){e.call(this,"OneDriveCatalogGetAccessToken")}return h(i,e),Object.defineProperty(i.prototype,r,{get:function(){return this.Fields.Result},set:function(e){this.Fields.Result=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,t,{get:function(){return this.Fields.Error},set:function(e){this.Fields.Error=e},enumerable:!0,configurable:!0}),i.prototype.SerializeFields=function(){this.SetSerializedField(r,this.Result),this.SetSerializedField(n,this.ResponseTime),this.SetSerializedField(t,this.Error)},i}(l);e.OneDriveCatalogGetAccessTokenUsageData=g;var v=function(e){function i(){e.call(this,"OneDriveCatalogGetManifests")}return h(i,e),Object.defineProperty(i.prototype,r,{get:function(){return this.Fields.Result},set:function(e){this.Fields.Result=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,t,{get:function(){return this.Fields.Error},set:function(e){this.Fields.Error=e},enumerable:!0,configurable:!0}),i.prototype.SerializeFields=function(){this.SetSerializedField(r,this.Result),this.SetSerializedField(n,this.ResponseTime),this.SetSerializedField(t,this.Error)},i}(l);e.OneDriveCatalogGetManifestsUsageData=v;var y=function(e){function i(){e.call(this,"OneDriveCatalogGetManifest")}return h(i,e),Object.defineProperty(i.prototype,"id",{get:function(){return this.Fields.id},set:function(e){this.Fields.id=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,r,{get:function(){return this.Fields.Result},set:function(e){this.Fields.Result=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,t,{get:function(){return this.Fields.Error},set:function(e){this.Fields.Error=e},enumerable:!0,configurable:!0}),i.prototype.SerializeFields=function(){this.SetSerializedField("id",this.id),this.SetSerializedField(r,this.Result),this.SetSerializedField(n,this.ResponseTime),this.SetSerializedField(t,this.Error)},i}(l);e.OneDriveCatalogGetManifestUsageData=y;var _=function(e){function i(){e.call(this,"OneDriveCatalogInsertManifest")}return h(i,e),Object.defineProperty(i.prototype,r,{get:function(){return this.Fields.Result},set:function(e){this.Fields.Result=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,t,{get:function(){return this.Fields.Error},set:function(e){this.Fields.Error=e},enumerable:!0,configurable:!0}),i.prototype.SerializeFields=function(){this.SetSerializedField(r,this.Result),this.SetSerializedField(n,this.ResponseTime),this.SetSerializedField(t,this.Error)},i}(l);e.OneDriveCatalogInsertManifestUsageData=_}(f||(f={})),function(e){var t;(t=e.ULSTraceLevel||(e.ULSTraceLevel={}))[t.unexpected=10]="unexpected",t[t.warning=15]="warning",t[t.info=50]="info",t[t.verbose=100]="verbose",t[t.verboseEx=200]="verboseEx";var n,r,i,a,o,s,c,u,d=e.ULSTraceLevel;n=e.ULSCat||(e.ULSCat={}),r="msoulscat_Osf_UploadFileDevCatalogUsage",i="msoulscat_Osf_UploadFileDevCatelog",a="msoulscat_Osf_InsertionDialogSession",o="msoulscat_Osf_AppManagementMenu",s="msoulscat_Osf_Runtime",c="msoulscat_Osf_Notification",n[n[u="msoulscat_Osf_Latency"]=1401]=u,n[n[c]=1402]=c,n[n[s]=1403]=s,n[n[o]=1404]=o,n[n[a]=1405]=a,n[n[i]=1406]=i,n[n[r]=1411]=r;var p,m,h,g,v,y,_=e.ULSCat;m=p||(p={}),h="InsertionDialogClosed",m[m[g="ConfirmationDialogCancel"]=256]=g,m[m[h]=512]=h,m[m.IsAnonymous=1024]="IsAnonymous",(y=v||(v={}))[y.Undefined=0]="Undefined",y[y.Inserted=1]="Inserted",y[y.Canceled=2]="Canceled",y[y.Closed=3]="Closed",y[y.TrustPageVisited=8]="TrustPageVisited";var C=function(){function e(){this.timeValue=0}return e.prototype.Start=function(){this.timeValue=-(new Date).getTime(),this.finishedMeasurement=!1},e.prototype.Stop=function(){this.timeValue<0&&(this.timeValue+=(new Date).getTime(),this.finishedMeasurement=!0)},Object.defineProperty(e.prototype,"Finished",{get:function(){return this.finishedMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){var e=this.timeValue;return!this.Finished&&e<0&&(e=Math.abs(e)-(new Date).getTime()),e},enumerable:!0,configurable:!0}),e}();e.LatencyStopwatch=C;var S=function(){return function(){}}();e.Context=S;var A=function(){function e(){}return e.SendULSTraceTag=function(e,t,n,r){Microsoft.Office.WebExtension.FULSSupported&&Diag.UULS.trace(r,e,t,n)},e}(),b=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){A.SendULSTraceTag(e.category,e.level,t.SerializeRow(),6062431)},e.category=_.msoulscat_Osf_Notification,e.level=d.info,e}();e.NotificationLogger=b;var I=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){A.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085957)},e.category=_.msoulscat_Osf_AppManagementMenu,e.level=d.info,e}();e.AppManagementMenuLogger=I;var O=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){A.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085958)},e.category=_.msoulscat_Osf_UploadFileDevCatelog,e.level=d.info,e}();e.UploadFileDevCatelogLogger=O;var x=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){A.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17834653)},e.category=_.msoulscat_Osf_UploadFileDevCatalogUsage,e.level=d.info,e}();e.UploadFileDevCatalogUsageLogger=x;var E=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){A.SendULSTraceTag(e.category,e.level,t.SerializeRow(),4748055)},e.category=_.msoulscat_Osf_Latency,e.level=d.info,e}();e.LatencyLogger=E;var T=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){A.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085959)},e.category=_.msoulscat_Osf_InsertionDialogSession,e.level=d.info,e}();e.InsertionDialogSessionLogger=T;var M=function(){function e(){}return e.LogNotification=function(e,t,n){var r=new f.AppNotificationUsageData;r.CorrelationId=e,r.ErrorResult=t,r.NotificationClickInfo=n,b.Instance().LogData(r)},e}();e.AppNotificationHelper=M;var k=function(){function e(){}return e.LogAppManagementMenuAction=function(e,t,n,r,i,a){var o=new f.AppManagementMenuUsageData,s=0===e.toLowerCase().indexOf("wa")?parseInt(e.substring(2),10):parseInt(e,10);r&&(t|=p.InsertionDialogClosed),i&&(t|=p.IsAnonymous),o.AssetId=s,o.OperationMetadata=t,o.ErrorResult=a,I.Instance().LogData(o)},e}();e.AppManagementMenuHelper=k;var P=function(){function e(){}return e.LogUploadFileDevCatelogAction=function(e,t,n,r,i,a){var o=new f.UploadFileDevCatelogUsageData;o.CorrelationId=e,o.OperationMetadata=t,o.ErrorResult=a,O.Instance().LogData(o)},e}();e.UploadFileDevCatelogHelper=P;var N=function(){function e(){}return e.LogUploadFileDevCatalogUsageAction=function(e,t,n,r,i,a,o,s){var l=new f.UploadFileDevCatalogUsageUsageData;l.CorrelationId=e,l.StoreType=t,l.AppId=n,l.AppVersion=r,l.AppTargetType=i,l.IsAppCommand=a,l.AppSizeWidth=o,l.AppSizeHeight=s,x.Instance().LogData(l)},e}();e.UploadFileDevCatalogUsageHelper=N;var R=function(){function e(){}return e.GenerateActivationMessage=function(e,t){var n="";return null!=e&&(n+="ActivationRuntimeType: "+e.toString()+"|"),null!=t&&(n+="CorrelationId: "+t),n},e.ActivationStart=function(t,n,r,i,a,o){e.activatingNumber++,t.LoadTime=new f.AppLoadTimeUsageData,t.Timers={},t.LoadTime.CorrelationId=i,t.LoadTime.AppInfo=n,t.LoadTime.ActivationInfo=0,t.LoadTime.InstanceId=a,t.LoadTime.AssetId=r,t.LoadTime.Stage1Time=0,t.Timers.Stage1Time=new C,t.LoadTime.Stage2Time=0,t.Timers.Stage2Time=new C,t.LoadTime.Stage3Time=0,t.LoadTime.Stage4Time=0,t.Timers.Stage4Time=new C,t.LoadTime.Stage5Time=0,t.Timers.Stage5Time=new C,t.LoadTime.Stage6Time=e.activatingNumber,t.LoadTime.Stage7Time=0,t.Timers.Stage7Time=new C,t.LoadTime.Stage8Time=0,t.Timers.Stage8Time=new C,t.LoadTime.Stage9Time=0,t.Timers.Stage9Time=new C,t.LoadTime.Stage10Time=0,t.Timers.Stage10Time=new C,t.LoadTime.Stage11Time=0,t.Timers.Stage11Time=new C,t.LoadTime.ErrorResult=0,t.ActivationRuntimeType=o,e.StartStopwatch(t,"Stage1Time"),A.SendULSTraceTag(_.msoulscat_Osf_Runtime,d.info,e.GenerateActivationMessage(o,i),19515419)},e.ActivationEnd=function(t){e.ActivateEndInternal(t)},e.PageStart=function(t){e.StartStopwatch(t,"Stage2Time")},e.PageLoaded=function(t){e.StopStopwatch(t,"Stage2Time")},e.ServerCallStart=function(t){e.StartStopwatch(t,"Stage4Time")},e.ServerCallEnd=function(t){e.StopStopwatch(t,"Stage4Time")},e.AuthenticationStart=function(t){e.StartStopwatch(t,"Stage5Time")},e.AuthenticationEnd=function(t){e.StopStopwatch(t,"Stage5Time")},e.EntitlementCheckStart=function(t){e.StartStopwatch(t,"Stage7Time")},e.EntitlementCheckEnd=function(t){e.StopStopwatch(t,"Stage7Time")},e.KilledAppsCheckStart=function(t){e.StartStopwatch(t,"Stage8Time")},e.KilledAppsCheckEnd=function(t){e.StopStopwatch(t,"Stage8Time")},e.AppStateCheckStart=function(t){e.StartStopwatch(t,"Stage9Time")},e.AppStateCheckEnd=function(t){e.StopStopwatch(t,"Stage9Time")},e.ManifestRequestStart=function(t){e.StartStopwatch(t,"Stage10Time")},e.ManifestRequestEnd=function(t){e.StopStopwatch(t,"Stage10Time")},e.OfficeJSStartToLoad=function(t){e.StartStopwatch(t,"Stage11Time")},e.OfficeJSLoaded=function(t){e.StopStopwatch(t,"Stage11Time")},e.SetAnonymousFlag=function(t,n){e.SetActivationInfoField(t,e.ConvertFlagToBit(n),2,0)},e.SetRetryCount=function(t,n){e.SetActivationInfoField(t,n,3,2)},e.SetManifestTrustCachedFlag=function(t,n){e.SetActivationInfoField(t,e.ConvertFlagToBit(n),2,5)},e.SetManifestDataCachedFlag=function(t,n){e.SetActivationInfoField(t,e.ConvertFlagToBit(n),2,7)},e.SetOmexHasEntitlementFlag=function(t,n){e.SetActivationInfoField(t,e.ConvertFlagToBit(n),2,9)},e.SetManifestDataInvalidFlag=function(t,n){e.SetActivationInfoField(t,e.ConvertFlagToBit(n),2,11)},e.SetAppStateDataCachedFlag=function(t,n){e.SetActivationInfoField(t,e.ConvertFlagToBit(n),2,13)},e.SetAppStateDataInvalidFlag=function(t,n){e.SetActivationInfoField(t,e.ConvertFlagToBit(n),2,15)},e.SetActivationRuntimeType=function(t,n){e.SetActivationInfoField(t,n,2,17)},e.SetErrorResult=function(t,n){t.LoadTime&&(t.LoadTime.ErrorResult=n,e.ActivateEndInternal(t))},e.SetBit=function(t,n,r,i){e.SetActivationInfoField(t,n,i||2,r)},e.StartStopwatch=function(t,n){t.LoadTime&&t.Timers&&t.Timers[n]&&(t.Timers[n].Start(),e.UpdateActivatingNumber(t))},e.StopStopwatch=function(t,n){t.LoadTime&&t.Timers&&t.Timers[n]&&(t.Timers[n].Stop(),e.UpdateActivatingNumber(t))},e.ConvertFlagToBit=function(e){return e?2:1},e.SetActivationInfoField=function(t,n,r,i){t.LoadTime&&(e.UpdateActivatingNumber(t),t.LoadTime.ActivationInfo=e.SetBitField(t.LoadTime.ActivationInfo,n,r,i))},e.SetBitField=function(e,t,n,r){return e&~(Math.pow(2,n)-1<<r)|t<<r},e.UpdateActivatingNumber=function(t){t.LoadTime&&(t.LoadTime.Stage6Time=t.LoadTime.Stage6Time>e.activatingNumber?t.LoadTime.Stage6Time:e.activatingNumber)},e.ActivateEndInternal=function(t){if(t.LoadTime){if(e.StopStopwatch(t,"Stage1Time"),t.Timers)for(var n in t.Timers)null!=t.Timers[n].ElapsedTime&&(t.LoadTime[n]=t.Timers[n].ElapsedTime);A.SendULSTraceTag(_.msoulscat_Osf_Runtime,d.info,e.GenerateActivationMessage(t.ActivationRuntimeType,t.LoadTime.CorrelationId),19515420),E.Instance().LogData(t.LoadTime),t.LoadTime=null,e.activatingNumber--}},e.activatingNumber=0,e}();e.AppLoadTimeHelper=R;var D=function(){function e(){}return e.LogProxyFailure=function(t,n,r){var i;null==t&&(t=""),i=l.OUtil.formatString("appCorrelationId:{0}, methodName:{1}",t,n),Object.keys(r).forEach(function(e){var t=r[e];null!=t&&(t=t.toString()),i+=", "+e+":"+t}),A.SendULSTraceTag(e.category,d.warning,i,6062432)},e.LogExceptionTag=function(t,n,r,i){var a=t;n&&(n.name&&(a+=" Exception name:"+n.name+"."),n.paramName&&(a+=" Param name:"+n.paramName+"."),n.message&&(a+=" Message:"+n.message+"."),n.stack&&(a+=" [Stack:"+n.stack+"]")),null!=r&&(a+=" AppCorrelationId:"+r+"."),A.SendULSTraceTag(e.category,d.warning,a,i)},e.LogCommonMessageTag=function(t,n,r){null!=n&&(t+=" AppCorrelationId:"+n+"."),A.SendULSTraceTag(e.category,d.info,t,r)},e.category=_.msoulscat_Osf_Runtime,e}();e.RuntimeTelemetryHelper=D;var w=function(){function e(){}return e.LogInsertionDialogSession=function(e,t,n,r,i,a){var o=new f.InsertionDialogSessionUsageData,s=0===e.toLowerCase().indexOf("wa")?parseInt(e.substring(2),10):parseInt(e,10),l=v.Undefined;l|=r?v.Inserted:v.Canceled,n>0&&(l|=v.TrustPageVisited),o.AssetId=s,o.TotalSessionTime=t,o.TrustPageSessionTime=n,o.DialogState=l,o.LastActiveTab=i,o.LastActiveTabCount=a,T.Instance().LogData(o)},e}();e.InsertionDialogSessionHelper=w}(m||(m={}));var g='xmlns="urn:schemas-microsoft-com:office:office" xmlns:o="urn:schemas-microsoft-com:office:office"';l.AppVersion={access:"ZAC150",excel:"ZXL150",excelwebapp:"WAE160",outlook:"ZOL150",outlookwebapp:"MOW150",powerpoint:"ZPP151",powerpointwebapp:"WAP160",project:"ZPJ150",word:"ZWD150",wordwebapp:"WAW160",onenotewebapp:"WAO160"},l.AppSubType={Taskpane:1,Content:2,Contextual:3,Dictionary:4},l.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2};var v,y,_,C,S,A,b,I,O,x,E,T,M,k,P,N,R,D,w,F,U,L,B,j,H,V,W,G,q,z,X,K,J,Q,Y,Z,$,ee,te,ne,re,ie;l.HostSpecificFileVersionDefault="16.00",l.HostSpecificFileVersionMap={access:{web:"16.00"},agavito:{winrt:"16.00"},excel:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},onenote:{web:"16.00",win32:"16.00",winrt:"16.00"},outlook:{ios:"16.00",mac:"16.00",web:"16.01",win32:"16.02"},powerpoint:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},project:{win32:"16.00"},sway:{web:"16.00"},word:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"}},l.HostType={Excel:"Excel",Outlook:"Outlook",Access:"Access",PowerPoint:"PowerPoint",Word:"Word",Sway:"Sway",OneNote:"OneNote"},l.ManifestHostType={Workbook:"Workbook",Document:"Document",Presentation:"Presentation",Notebook:"Notebook"},l.HostPlatform={Web:"Web"},l.getAppVerCode=function(e){var t;switch(e){case l.AppName.ExcelWebApp:t="excel.exe";break;case l.AppName.AccessWebApp:t="ZAC";break;case l.AppName.PowerpointWebApp:t="WAP";break;case l.AppName.WordWebApp:t="WAW";break;case l.AppName.OneNoteWebApp:t="WAO";break;default:throw s.msAjaxDebug.trace("Invalid appName."),"Invalid appName."}return t},l.getModernAppVerCode=function(e){var t;switch(e){case l.AppName.ExcelWebApp:t="WAC_Excel";break;case l.AppName.PowerpointWebApp:t="WAC_PowerPoint";break;case l.AppName.WordWebApp:t="WAC_Word";break;case l.AppName.OneNoteWebApp:t="WAC_OneNote";break;case l.AppName.OutlookWebApp:t="WAC_Outlook";break;default:throw s.msAjaxDebug.trace("Invalid appName."),"Invalid appName."}return t},l.getManifestHostType=function(e){var t;switch(e){case l.HostType.Excel:t=l.ManifestHostType.Workbook;break;case l.HostType.Word:t=l.ManifestHostType.Document;break;case l.HostType.PowerPoint:t=l.ManifestHostType.Presentation;break;case l.HostType.OneNote:t=l.ManifestHostType.Notebook;break;default:throw s.msAjaxDebug.trace("Invalid host type."),"Invalid hostType."}return t},l.Capability={Mailbox:"Mailbox",Document:"Document",Workbook:"Workbook",Project:"Project",Presentation:"Presentation",Database:"Database",Sway:"Sway",Notebook:"Notebook"},l.HostCapability={Excel:l.Capability.Workbook,Outlook:l.Capability.Mailbox,Access:l.Capability.Database,PowerPoint:l.Capability.Presentation,Word:l.Capability.Document,Sway:l.Capability.Sway,OneNote:l.Capability.Notebook},l.OsfControlTarget={Undefined:-1,InContent:0,TaskPane:1,Contextual:2},l.OsfControlPermission={Restricted:1,ReadDocument:2,WriteDocument:4,ReadItem:32,ReadWriteMailbox:64,ReadAllDocument:131,ReadWriteDocument:135},l.OsfControlStatus={NotActivated:1,Activated:2,AppStoreNotReachable:3,InvalidOsfControl:4,UnsupportedStore:5,UnknownStore:6,ActivationFailed:7,NotSandBoxSupported:8},l.OsfControlPageStatus={NotStarted:1,Loading:2,Ready:3,FailedHandleRequest:4,FailedOriginCheck:5,FailedPermissionCheck:6},l.StoreType={OMEX:"omex",SPCatalog:"spcatalog",SPApp:"spapp",Exchange:"exchange",FileSystem:"filesystem",Registry:"registry",InMemory:"inmemory",OneDrive:"onedrive",PrivateCatalog:"excatalog",HardCodedPreinstall:"hardcodedpreinstall",FirstParty:"firstparty",UploadFileDevCatalog:"uploadfiledevcatalog"},l.StoreTypeEnum={MarketPlace:0,Catalog:1,SPApp:2,Exchange:3,FileSystem:4,Registry:5,OneDrive:9,PrivateCatalog:10,HardCodedPreinstall:11,FirstParty:12,UploadFileDevCatalog:15},l.ManifestIdIssuer={Microsoft:"Microsoft",Custom:"Custom"},l.OmexClientAppStatus={OK:1,UnknownAssetId:2,KilledAsset:3,NoEntitlement:4,DownloadsExceeded:5,Expired:6,Invalid:7,Revoked:8,ServerError:9,BadRequest:10,LimitedTrial:11,TrialNotSupported:12,EntitlementDeactivated:13,VersionMismatch:14,VersionNotSupported:15,UserIsMinor:16},l.OmexState={Killed:0,OK:1,Withdrawn:2,Flagged:3,DeveloperWithdrawn:4},l.OmexTrialType={None:0,Office:1,External:2},l.OmexEntitlementType={Free:"free",Trial:"trial",Paid:"paid"},l.OmexAuthNStatus={NotAttempted:-1,CheckFailed:0,Authenticated:1,Anonymous:2,Unknown:3},l.OmexRemoveAppStatus={Failed:0,Success:1},l.OfficeAppType={ContentApp:l.OsfControlTarget.InContent,TaskPaneApp:l.OsfControlTarget.TaskPane,MailApp:l.OsfControlTarget.Contextual},l.FormFactor={Default:"DefaultSettings",Desktop:"DesktopSettings",Tablet:"TabletSettings",Phone:"PhoneSettings"},l.OsfOfficeExtensionManagerPerfMarker={GetEntitlementStart:"Agave.OfficeExtensionManager.GetEntitlementStart",GetEntitlementEnd:"Agave.OfficeExtensionManager.GetEntitlementEnd"},l.OsfControlActivationPerfMarker={ActivationStart:"Agave.AgaveActivationStart",ActivationEnd:"Agave.AgaveActivationEnd",DeactivationStart:"Agave.AgaveDeactivationStart",DeactivationEnd:"Agave.AgaveDeactivationEnd",SelectionTimeout:"Agave.AgaveSelectionTimeout"},l.NotificationUxPerfMarker={RenderLoadingAnimationStart:"Agave.NotificationUx.RenderLoadingAnimationStart",RenderLoadingAnimationEnd:"Agave.NotificationUx.RenderLoadingAnimationEnd",RemoveLoadingAnimationStart:"Agave.NotificationUx.RemoveLoadingAnimationStart",RemoveLoadingAnimationEnd:"Agave.NotificationUx.RemoveLoadingAnimationEnd",RenderStage1Start:"Agave.NotificationUx.RenderStage1Start",RenderStage1End:"Agave.NotificationUx.RenderStage1End",RemoveStage1Start:"Agave.NotificationUx.RemoveStage1Start",RemoveStage1End:"Agave.NotificationUx.RemoveStage1End",RenderStage2Start:"Agave.NotificationUx.RenderStage2Start",RenderStage2End:"Agave.NotificationUx.RenderStage2End",RemoveStage2Start:"Agave.NotificationUx.RemoveStage2Start",RemoveStage2End:"Agave.NotificationUx.RemoveStage2End"},l.ProxyCallStatusCode={Succeeded:1,Failed:0,ProxyNotReady:-1},l.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2},l.SQMDataPoints={DATAID_APPSFOROFFICEUSAGE:10595,DATAID_APPSFOROFFICENOTIFICATIONS:10942},l.BWsaStreamTypes={Static:1},l.BWsaConfig={defaultMaxStreamRows:1e3},l.ErrorStatusCodes={E_OEM_EXTENSION_NOT_ENTITLED:2147758662,E_MANIFEST_SERVER_UNAVAILABLE:2147758672,E_USER_NOT_SIGNED_IN:2147758677,E_MANIFEST_DOES_NOT_EXIST:2147758673,E_OEM_EXTENSION_KILLED:2147758660,E_OEM_OMEX_EXTENSION_KILLED:2147758686,E_MANIFEST_UPDATE_AVAILABLE:2147758681,S_OEM_EXTENSION_TRIAL_MODE:275013,E_OEM_EXTENSION_WITHDRAWN_FROM_SALE:2147758690,E_TOKEN_EXPIRED:2147758675,E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED:2147757992,E_MANIFEST_REFERENCE_INVALID:2147758678,S_USER_CLICKED_BUY:274205,E_MANIFEST_INVALID_VALUE_FORMAT:2147758654,E_TRUSTCENTER_MOE_UNACTIVATED:2147757996,S_OEM_EXTENSION_FLAGGED:275040,S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE:275041,E_BROWSER_VERSION:2147758194,E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR:-2147209295,WAC_AgaveUnsupportedStoreType:1041,WAC_AgaveActivationError:1042,WAC_ActivateAttempLoading:1043,WAC_HTML5IframeSandboxNotSupport:1044,WAC_AgaveRequirementsErrorOmex:1045,WAC_AgaveRequirementsError:1046,WAC_AgaveOriginCheckError:1047,WAC_AgavePermissionCheckError:1048,WAC_AgaveHostHandleRequestError:1049,WAC_AgaveUnknownClientAppStatus:1050,WAC_AgaveAnonymousProxyCreationError:1051,WAC_AgaveOsfControlActivationError:1052,WAC_AgaveEntitlementRequestFailure:1053,WAC_AgaveManifestRequestFailure:1054,WAC_AgaveManifestAndEtokenRequestFailure:1055,WAC_FirstPartyAddInListRequestFailure:1056,WAC_SSOAddinRequireConsent:1057},l.InvokeResultCode={S_OK:0,E_REQUEST_TIME_OUT:-2147471590,E_USER_NOT_SIGNED_IN:-2147208619,E_CATALOG_ACCESS_DENIED:-2147471591,E_CATALOG_REQUEST_FAILED:-2147471589,E_OEM_NO_NETWORK_CONNECTION:-2147208640,E_PROVIDER_NOT_REGISTERED:-2147208617,E_OEM_CACHE_SHUTDOWN:-2147208637,E_OEM_REMOVED_FAILED:-2147209421,E_CATALOG_NO_APPS:-1,E_GENERIC_ERROR:-1e3,S_HIDE_PROVIDER:10},l.OmexClientNames=(v={},y=l.AppName,v[y.ExcelWebApp]="WAC_Excel",v[y.WordWebApp]="WAC_Word",v[y.OutlookWebApp]="WAC_Outlook",v[y.AccessWebApp]="WAC_Access",v[y.PowerpointWebApp]="WAC_Powerpoint",v[y.OneNoteWebApp]="WAC_OneNote",v),l.OmexAppVersions=(_={},C=l.AppName,_[C.ExcelWebApp]=l.AppVersion.excelwebapp,_[C.WordWebApp]=l.AppVersion.wordwebapp,_[C.OutlookWebApp]=l.AppVersion.outlookwebapp,_[C.AccessWebApp]=l.AppVersion.access,_[C.PowerpointWebApp]=l.AppVersion.powerpointwebapp,_[C.OneNoteWebApp]=l.AppVersion.onenotewebapp,_),l.ActivationTypes={V1Enabled:0,V1S2SEnabled:1,V2Enabled:2,V2S2SEnabled:3},l.ManifestRequestTypes={Manifest:1,Etoken:2,Both:3},function(e){var t=function(){function e(){}return e.versionLessThan=function(e,t){return l.OsfManifestManager.versionLessThan(e,t)},e.ParseManifest=function(e,t,n){try{return new l.Manifest.Manifest(e,t)}catch(e){return m.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest:",e,n,20306078),null}},e}();e.ManifestUtil=t;var n=function(){function t(){}return t.failed=function(t,n,r){if(t.status!=e.DataServiceResultCode.Succeeded){var i={status:t.status,httpStatus:t.httpStatus};return null!=r&&(i.value=r),n(i),!0}return!1},t}();e.AsyncUtil=n;var r=function(){function e(){}return e.register=function(e,t){this._registry[e]=t},e.resolve=function(e,t){var n=this._resolved[e];if(null!=n)return n;if(null!=(t=t||this._hostInfo)){var r=this._registry[e];if(null==r)return null;this._resolved[e]=n=r(t)}return n},e.setHostContext=function(e){this._hostInfo=e},e._registry={},e._resolved={},e}();e.CatalogFactory=r}(ne||(ne={})),S=ne||(ne={}),A=function(){function e(e){this._initParams=e}return e.prototype.getEntitlementAsync=function(e,t,n){n({status:S.DataServiceResultCode.Failed,httpStatus:403})},e.prototype.getAndCacheManifest=function(e,t,n,r){r({status:S.DataServiceResultCode.Failed,httpStatus:404})},e.prototype.activateAsync=function(e,t){this._initParams&&this._initParams.loaderParams?this._initParams.controlStatus===l.OsfControlStatus.ActivationFailed?t.fail(this._initParams.loaderParams,this._initParams.controlStatus):t.notifyUser(this._initParams.loaderParams):t.fail(S.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveActivationError_ERR,errorCode:l.ErrorStatusCodes.WAC_AgaveActivationError}),l.OsfControlStatus.ActivationFailed)},e.prototype.removeAsync=function(e,t,n){n({status:S.DataServiceResultCode.Failed,httpStatus:403})},e.prototype.getAppDetails=function(e,t,n,r){r({status:S.DataServiceResultCode.Failed,httpStatus:403})},e}(),S.ForbiddenCatalog=A,b=ne||(ne={}),I=function(){function e(){}return e.defaultTitle=function(e){switch(e){case l.InfoType.Information:return Strings.OsfRuntime.L_AgaveInformationTitle_TXT;case l.InfoType.Error:return Strings.OsfRuntime.L_AgaveErrorTile_TXT;case l.InfoType.Warning:return Strings.OsfRuntime.L_AgaveWarningTitle_TXT}return Strings.OsfRuntime.L_AgaveInformationTitle_TXT},e.fillMissing=function(t){return t.infoType=t.infoType||l.InfoType.Information,t.title=t.title||e.defaultTitle(t.infoType),t.buttonTxt=t.buttonTxt||Strings.OsfRuntime.L_OkButton_TXT,t.buttonCallback=t.buttonCallback||null,t.url=t.url||null,t.urlButtonTxt=t.urlButtonTxt||null,t.dismissCallback=t.dismissCallback||null,t.reDisplay=!t.dismissCallback,t.displayDeactive=null==t.displayDeactive||t.displayDeactive,t.detailView=t.detailView||!1,t.logAsError=t.logAsError||!1,t.highPriority=t.highPriority||!1,t.retryAll=t.retryAll||!1,t.errorCode=t.errorCode?t.errorCode:0,t},e.error=function(t){return t.infoType=t.infoType||l.InfoType.Error,t.logAsError=null==t.logAsError||t.logAsError,e.fillMissing(t)},e.warning=function(t){return t.infoType=t.infoType||l.InfoType.Warning,t.logAsError=null==t.logAsError||t.logAsError,e.fillMissing(t)},e.showNotification=function(t,n){t.notifyUser(e.fillMissing(n))},e.showError=function(t,n){t.notifyUser(e.error(n))},e.showWarning=function(t,n){t.notifyUser(e.warning(n))},e.failWithWarning=function(t,n,r){r=r||l.OsfControlStatus.ActivationFailed,t.fail(e.warning(n),r)},e.failWithError=function(t,n,r){r=r||l.OsfControlStatus.ActivationFailed,t.fail(e.error(n),r)},e}(),b.LoaderUtil=I,O=ne||(ne={}),x=function(){function e(e,t){this.osfControl=e,this.trusted=t}return e.prototype.getRequirementsChecker=function(){return this.osfControl._contextActivationMgr.getRequirementsChecker()},e.prototype.load=function(e,t){this.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.Inserted&&(this.osfControl._retryActivate=null,this.osfControl._contextActivationMgr.retryAll(e.entitlement.assetId)),this.osfControl._status!==l.OsfControlStatus.NotActivated&&this.osfControl.deActivate();var n=e.manifest,r=this.osfControl;if(r._etoken=e.eToken,r._manifest=n,r._sourceLocationOverrideResourceId?r._iframeUrl=n.getSourceLocationOverrideByResourceId(r._sourceLocationOverrideResourceId):r._iframeUrl=n.getDefaultSourceLocation(r._contextActivationMgr.getFormFactor()),r._permission=n.getPermission(),r._appDomains=n.getAppDomains(),r.processManifestForCustomFunctions(),null!=t&&(r._iframeUrl=t.decorateUrl(r._iframeUrl)),r._contextActivationMgr._doesUrlHaveSupportedProtocol(r._iframeUrl)){null!=t&&t.preLoad(r,r._contextActivationMgr);var i=n.getDefaultDisplayName();r._isAddinCommands(function(e){e&&(r._isvirtualOsfControl=!0,r.invokeVirtualOsfControlActivationCallback(n)),(!e||r.containsCustomFunctions())&&r._createIframeAndActivateOsfControl(i)}),null!=t&&t.postLoad(r,r._contextActivationMgr)}else O.LoaderUtil.failWithError(this,{description:Strings.OsfRuntime.L_AgaveManifestError_ERR,detailView:!0,errorCode:l.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT})},e.prototype.skipTrust=function(){return this.osfControl._contextActivationMgr._autoTrusted||this.osfControl.getTrustNoPrompt()||this.osfControl._isOsfControlInEmbeddingMode(this.osfControl)},e.prototype.hasConsent=function(){return this.trusted||this.isInsertion()},e.prototype.isInsertion=function(){return this.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.Inserted},e.prototype.setRetryCall=function(e){this.osfControl._retryActivate=e},e.prototype.askForTrust=function(e,t){var n=this;this.osfControl._showTrustError(e.displayName,e.providerName,e.entitlement.storeType,function(){n.restartActivation(),t()},e.url,e.isSSOAddin)},e.prototype.askForUpgrade=function(e,t){var n=this;e.buttonCallback=function(){n.restartActivation(),t()},this.notifyUser(e)},e.prototype.askForConsentForSideloadAddin=function(e,t){var n=this;this.osfControl._manifest=e,this.osfControl._isAddinCommands(function(e){e?n.osfControl.showConsentError(t,l.NotificationType.ConsentWhiteDialog,!0):n.osfControl.showConsentError(t,l.NotificationType.ConsentYellowBar,!0)})},e.prototype.fail=function(e,t){var n=this.osfControl;n._status=t,this.notifyUser(e),n._contextActivationMgr.raiseOsfControlStatusChange(n)},e.prototype.notifyUser=function(e){var t=this.osfControl;e.id=t._id,t._contextActivationMgr.displayNotification(e)},e.prototype.restartActivation=function(){this.osfControl._restartActivate()},e}(),O.OsfControlLoader=x,E=ne||(ne={}),T=function(){function e(e){this._requirementsChecker=e}return e.prototype.getRequirementsChecker=function(){return this._requirementsChecker},e.prototype.load=function(){},e.prototype.skipTrust=function(){return!1},e.prototype.hasConsent=function(){return!1},e.prototype.setRetryCall=function(){},e.prototype.askForTrust=function(){},e.prototype.askForUpgrade=function(){},e.prototype.askForConsentForSideloadAddin=function(){},e.prototype.fail=function(){},e.prototype.notifyUser=function(){},e.prototype.restartActivation=function(){},e}(),E.PreCacher=T,M=ne||(ne={}),k=function(){var e=null;function t(){this.isReady=!1,this.clientEndPoint=e,this.pendingCallbacks=[],this.iframe=e,this._pendingRequests={},this.conversationId=l.OUtil.generateConversationId()}return t.prototype.invokeProxyCommandAsync=function(t,n,r){var i=this,a=n||n.correlationId||"";this.prepareProxy(function(o){o.value!=e?i.invokeProxyMethodAsync(t,r,n):(m.RuntimeTelemetryHelper.LogExceptionTag("clientendpoint is invalid",e,a,18940552),r({status:M.DataServiceResultCode.ProxyNotReady}))},function(){m.RuntimeTelemetryHelper.LogExceptionTag("proxysetup failure",e,a,18940553),r({status:M.DataServiceResultCode.ProxyNotReady})})},t.prototype.prepareProxy=function(){},t.prototype.doesUrlHaveSupportedProtocol=function(t){var n=!1;t&&(n=decodeURIComponent(t).match(/^https?:\/\/.+$/gi)!=e);return n},t.prototype.invokeProxyMethodAsync=function(t,n,r){var i,a=r||r.correlationId||"",o=[this.clientEndPoint._targetUrl,t];for(var s in r)("string"===(i=typeof r[s])||"number"===i||"boolean"===i)&&o.push(r[s]);var c=o.join("."),u=this._pendingRequests,d={onCompleted:n,methodName:t,correlationId:a},p=u[c];if(p)p.push(d);else{u[c]=[d];r||(r={}),r.officeVersion=l.Constants.ThreePartsFileVersion,this.clientEndPoint.invoke(t,function(t,n){var r=e,i=0,a=M.DataServiceResultCode.Failed;0===t&&n.status&&(r=n.result,a=M.DataServiceResultCode.Succeeded);var o=u[c];delete u[c];for(var s=o.length,l=0;l<s;l++){var d=o.shift();try{n&&n.failureInfo&&(i=n.failureInfo.statusCode||e,n.failureInfo.result=n.result,m.RuntimeTelemetryHelper.LogProxyFailure(d.correlationId,d.methodName,n.failureInfo)),d.onCompleted({status:a,httpStatus:i,value:r})}catch(e){var p="invokeProxyMethodAsync failed";M.WACUtils.logExceptionToBrowserConsole(p,e),m.RuntimeTelemetryHelper.LogExceptionTag(p,e,d.correlationId,19015124)}}},r)}},t}(),M.ProxyBase=k,function(e){var t;(t=e.Activity||(e.Activity={}))[t.Activation=0]="Activation",t[t.ServerCall=1]="ServerCall",t[t.Authentication=2]="Authentication",t[t.EntitlementCheck=3]="EntitlementCheck",t[t.AppStateCheck=4]="AppStateCheck",t[t.KilledAppsCheck=5]="KilledAppsCheck",t[t.ManifestRequest=6]="ManifestRequest";var n,r,i,a,o,s,c,u,d,p=e.Activity;n=e.FlagName||(e.FlagName={}),r="ManifestRequestType",i="ActivationRuntimeType",a="AppStateDataInvalidFlag",o="AppStateDataCachedFlag",s="ManifestDataInvalidFlag",c="OmexHasEntitlementFlag",u="ManifestDataCachedFlag",d="ManifestTrustCachedFlag",n[n.AnonymousFlag=0]="AnonymousFlag",n[n.RetryCount=1]="RetryCount",n[n[d]=2]=d,n[n[u]=3]=u,n[n[c]=4]=c,n[n[s]=5]=s,n[n[o]=6]=o,n[n[a]=7]=a,n[n[i]=8]=i,n[n[r]=9]=r;var f=e.FlagName,h=function(){function t(e,t,n,r,i){this.correlationId=e,this.perfContext=t,this.appInfo=n,this.assetId=r,this.instanceId=i}return t.prototype.startActivity=function(n){switch(n){case p.Activation:var r=l.ActivationTypes.V2Enabled;return 0==(15&this.appInfo)&&e.S2SOmexCatalogService._requestHandler&&(r=l.ActivationTypes.V2S2SEnabled),m.AppLoadTimeHelper.ActivationStart(this.perfContext,this.appInfo,this.assetId,this.correlationId,this.instanceId,r),void this.setBits(f.ActivationRuntimeType,r)}m.AppLoadTimeHelper.StartStopwatch(this.perfContext,t.StopWatchName[n])},t.prototype.stopActivity=function(e){m.AppLoadTimeHelper.StopStopwatch(this.perfContext,t.StopWatchName[e])},t.prototype.setFlag=function(e,t){var n=t?2:1;this.setBits(e,n)},t.prototype.setBits=function(e,n){m.AppLoadTimeHelper.SetBit(this.perfContext,n,t.FlagOffsetMap[e],2)},t.FlagOffsetMap=[0,2,5,7,9,11,13,15,17,19],t.StopWatchName=["Stage1Time","Stage4Time","Stage5Time","Stage7Time","Stage9Time","Stage8Time","Stage10Time"],t}();e.ActivationTelemetryContext=h;var g=function(){function e(e){this.correlationId=e}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.AddinCommandsTelemetryContext=g;var v=function(){function e(e){this.correlationId=e}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.InsertDialogTelemetryContext=v;var y=function(){function e(){}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.SimpleTelemetryContext=y}(ne||(ne={})),function(e){var t=null,n=function(){function n(n,r){void 0===r&&(r=t),this._initParam=n,this._cacheManager=r||new e.AppsDataCacheManager(l.OUtil.getLocalStorage(),new e.SafeSerializer)}return n.prototype.getEntitlementAsync=function(n,r,i){var a=this,o=[],s=[],c=n?this.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey():this.getUploadFileDevCatalogAddinsCacheKey(),u=this._cacheManager.GetCacheItem(c);u!=t&&(u.forEach(function(n){var r=a._cacheManager.GetCacheItem(a.getUploadFileDevCatalogManifestCacheKey(n));if(r!=t){var i=e.ManifestUtil.ParseManifest(r,a._initParam.appUILocale);if(i==t)return;var c={assetId:n,appVersion:i.getMarketplaceVersion(),storeId:"developer",storeType:l.StoreType.UploadFileDevCatalog,targetType:i.getTarget()};s.push(c),o.push(n)}}),o.length!=u.length&&(o.length>0?this._cacheManager.SetCacheItem(c,o):this._cacheManager.RemoveCacheItem(c))),i({status:e.DataServiceResultCode.Succeeded,value:s})},n.prototype.getAndCacheManifest=function(n,r,i,a){var o=l.OsfManifestManager.getCachedManifest(n.assetId,n.appVersion);if(o==t){if(o==t){var s=this._cacheManager.GetCacheItem(this.getUploadFileDevCatalogManifestCacheKey(n.assetId));s!=t&&(o=e.ManifestUtil.ParseManifest(s,this._initParam.appUILocale))!=t&&l.OsfManifestManager.cacheManifest(n.assetId,n.appVersion,o)}a({status:o!=t?e.DataServiceResultCode.Succeeded:e.DataServiceResultCode.Failed,value:o})}else a({status:e.DataServiceResultCode.Succeeded,value:o})},n.prototype.activateAsync=function(n,r,i){var a=this;this.getAndCacheManifest(n,n.storeId,i,function(o){if(o.status!=e.DataServiceResultCode.Succeeded)e.LoaderUtil.failWithError(r,{description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),a.activateAsync(n,r,i)},errorCode:l.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE});else{var s=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();if(s&&s.enableSingleSignOnForAddin){var c=o.value;if(c.isSSOAddin()){return void r.askForConsentForSideloadAddin(c,function(){r.load({entitlement:n,eToken:"",manifest:o.value},t)})}}r.load({entitlement:n,eToken:"",manifest:o.value},t)}})},n.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},n.prototype.getAppDetails=function(t,n,r,i){i({status:e.DataServiceResultCode.Failed})},n.prototype.validateAndCacheNewManifest=function(e,t,n,r){return!!this.validateAddinIdAndVersion(e,t)&&(this.cacheManifest(e,t,n,r),!0)},n.prototype.localCacheAddinCommands=function(e){this.cacheMyAddins(this.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey(),e)},n.prototype.validateAddinIdAndVersion=function(e,t){return n.idRegExp.test(e)&&n.versionRegExp.test(t)},n.prototype.cacheManifest=function(e,t,n,r){l.OsfManifestManager.cacheManifest(e,t,r),this.cacheMyAddins(this.getUploadFileDevCatalogAddinsCacheKey(),e),this._cacheManager.SetCacheItem(this.getUploadFileDevCatalogManifestCacheKey(e),n)},n.prototype.cacheMyAddins=function(e,n){var r=this._cacheManager.GetCacheItem(e);r==t&&(r=[]),r.lastIndexOf(n)<0&&(r.push(n),this._cacheManager.SetCacheItem(e,r))},n.prototype.getUploadFileDevCatalogAddinsCacheKey=function(){return n.UploadFileCatalogCacheKey.myAddins+"."+this._initParam.appName+"."+this._initParam.userNameHashCode},n.prototype.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey=function(){return n.UploadFileCatalogCacheKey.addinCommandsMyAddins+"."+this._initParam.appName+"."+this._initParam.userNameHashCode},n.prototype.getUploadFileDevCatalogManifestCacheKey=function(e){return n.UploadFileCatalogCacheKey.manifest+"."+this._initParam.appName+"."+e},n.UploadFileCatalogCacheKeyPrefix="__OSF_UPLOADFILE.",n.UploadFileCatalogCacheKey={myAddins:n.UploadFileCatalogCacheKeyPrefix+"MyAddins",addinCommandsMyAddins:n.UploadFileCatalogCacheKeyPrefix+"AddinCommandsMyAddins",manifest:n.UploadFileCatalogCacheKeyPrefix+"Manifest"},n.idRegExp=new RegExp("[\\w-]+"),n.versionRegExp=new RegExp("(\\d{1,2}.)*\\d{1,2}"),n}();e.CatalogFactory.register(l.StoreType.UploadFileDevCatalog,function(r){return r.enableUploadFileDevCatalog?new n({appName:r.appName,appUILocale:r.appUILocale,userNameHashCode:r.userNameHashCode}):new e.ForbiddenCatalog(t)});var r=function(){function t(e,t){this._catalog=e,this._storeType=t}return t.prototype.validateAndCacheNewManifest=function(){throw"Should never here"},t.prototype.getEntitlementsAsync=function(t,n,r,i){this._catalog.getEntitlementAsync(n,new e.AddinCommandsTelemetryContext(l.OUtil.Guid.generateNewGuid()),function(e){i(e.value)},!1,r)},t.prototype.getManifestAsync=function(){throw"Should never here"},t.prototype.localCacheAddinCommands=function(e,t,n,r){this._storeType==l.StoreType.UploadFileDevCatalog&&this._catalog.localCacheAddinCommands(t,n,r)},t}(),i=function(){function n(){}return n.createAddinDataProvider=function(n){var i=e.CatalogFactory.resolve(n);return i==t?t:new r(i,n)},n}();e.AddinDataProviderFactory=i}(ne||(ne={})),function(e){var t;(t=e.DataServiceResultCode||(e.DataServiceResultCode={}))[t.Succeeded=1]="Succeeded",t[t.Failed=0]="Failed",t[t.ProxyNotReady=-1]="ProxyNotReady",t[t.UnknownUserType=2]="UnknownUserType",t[t.Unauthenticated=3]="Unauthenticated";e.DataServiceResultCode}(ne||(ne={})),P=ne||(ne={}),N=function(){var e=null;function t(t,n){void 0===n&&(n=e),this._initParam=t,this._cacheManager=n||new P.AppsDataCacheManager(l.OUtil.getLocalStorage(),new P.SafeSerializer)}return t.prototype.getEntitlementAsync=function(){throw new Error("in firstParty get Entitlementasync")},t.prototype.getAndCacheManifest=function(){throw new Error("in firstParty getAndCacheManifest")},t.prototype.removeAsync=function(){throw new Error("in firstParty removeAsync")},t.prototype.getAppDetails=function(){throw new Error("in firstParty getappDetails")},t.prototype.TryFallBackFirstPartyAddInList=function(t,n){m.RuntimeTelemetryHelper.LogExceptionTag("Falling back to stale 1st party add-ins list.",e,t.correlationId,34366471);var r=this._cacheManager.GetCacheItem(P.CacheConsts.firstPartyAddinListCacheKey,!1);n(r?{status:P.DataServiceResultCode.Succeeded,value:r}:{status:P.DataServiceResultCode.Failed,value:e})},t.prototype.GetFirstyPartyAddInsInfo=function(t,n,r){var i=this,a=this._cacheManager.GetCacheItem(P.CacheConsts.firstPartyAddinListCacheKey,!0,e,e,!1);if(a){var o={addInList:a,refreshRate:e};r({status:P.DataServiceResultCode.Succeeded,value:o})}else t.getFirstPartyAddInList(function(t){if(t.status==P.DataServiceResultCode.Succeeded){var a=e;try{a=P.OmexXmlProcessor.ProcessFirstPartyAddInList(t.value)}catch(e){return m.RuntimeTelemetryHelper.LogExceptionTag("Problem parsing first party list.",e,n.correlationId,34366472),void i.TryFallBackFirstPartyAddInList(n,r)}i._cacheManager.SetCacheItem(P.CacheConsts.firstPartyAddinListCacheKey,a.addInList,a.refreshRate/P.CacheConsts.hourToDayConversionFactor),r({status:P.DataServiceResultCode.Succeeded,value:a})}else i.TryFallBackFirstPartyAddInList(n,r)})},t.prototype.TryFallBackFirstPartyManifest=function(t,n,r){m.RuntimeTelemetryHelper.LogExceptionTag("Falling back to stale manifest for: "+t,e,n.correlationId,34366473);var i=this.ReadFirstPartyManifestFromLocalStorage(n,t);r(i?{status:P.DataServiceResultCode.Succeeded,value:i}:{status:P.DataServiceResultCode.Failed,value:e})},t.prototype.ReadFirstPartyManifestFromLocalStorage=function(t,n){var r=l.OUtil.formatString(P.CacheConsts.firstPartyManifestCacheKey,n),i=this._cacheManager.GetCacheItem(r,!1);return i?P.ManifestUtil.ParseManifest(i,this._initParam.appUILocale,t.correlationId):e},t.prototype.GetFirstPartyManifest=function(e,t,n,r){var i=this,a=l.OsfManifestManager.getCachedManifest(n.assetId,"");if(a||(a=this.ReadFirstPartyManifestFromLocalStorage(t,n.assetId))&&l.OsfManifestManager.cacheManifest(n.assetId,"",a),!a||l.OsfManifestManager.versionLessThan(a.getMarketplaceVersion(),n.version)){var o=l.OUtil.formatString("{0}/{1}",this._initParam.firstPartyManifestCDNUrl,n.path);e.getFirstPartyManifest(o,function(e){if(e.status==P.DataServiceResultCode.Succeeded){var a=P.ManifestUtil.ParseManifest(e.value,i._initParam.appUILocale,t.correlationId);if(a){l.OsfManifestManager.cacheManifest(n.assetId,"",a);var o=l.OUtil.formatString(P.CacheConsts.firstPartyManifestCacheKey,n.assetId);i._cacheManager.SetCacheItem(o,e.value),r({status:P.DataServiceResultCode.Succeeded,value:a})}else i.TryFallBackFirstPartyManifest(n.assetId,t,r)}else i.TryFallBackFirstPartyManifest(n.assetId,t,r)})}else r({status:P.DataServiceResultCode.Succeeded,value:a})},t.prototype.getDataService=function(t,n){var r=this;if(this._dataService==e){var i={status:P.DataServiceResultCode.Failed,value:e},a=P.ProxyBasedCatalogService.getFirstPartyInstance(this._initParam);a.prepareProxy(t.correlationId,function(e){var t,o;o=a,(t=e).status==P.DataServiceResultCode.Succeeded?(r._dataService=o,i.value=o,i.status=P.DataServiceResultCode.Succeeded,n(i)):(i.httpStatus=t.httpStatus,n(i))})}else n({status:P.DataServiceResultCode.Succeeded,value:this._dataService})},t.prototype.createActivityScope=function(e,t){var n=this;this.getDataService(e,function(r){if(!P.AsyncUtil.failed(r,t)){var i=r.value,a={cacheManager:n._cacheManager,cachePrefix:P.CacheConsts.anonymousCacheKeyPrefix,cid:i.getCID(),anonymous:!0,telemetryContext:e},o=i.createScope(a);t({status:P.DataServiceResultCode.Succeeded,value:o})}})},t.prototype.activateAsync=function(t,n,r){var i=this;this.createActivityScope(r,function(a){if(a.status!=P.DataServiceResultCode.Succeeded)return m.RuntimeTelemetryHelper.LogExceptionTag("Failed to create 1st party activity scope.",e,r.correlationId,34366474),void P.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),i.activateAsync(t,n,r)},errorCode:l.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError});var o=a.value;i.GetFirstyPartyAddInsInfo(o,r,function(a){if(a.status!=P.DataServiceResultCode.Succeeded)return m.RuntimeTelemetryHelper.LogExceptionTag("Failed get list of 1st party addIns.",e,r.correlationId,34366475),void P.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),i.activateAsync(t,n,r)},errorCode:l.ErrorStatusCodes.WAC_FirstPartyAddInListRequestFailure});var s=a.value.addInList[t.assetId];if(!s)return m.RuntimeTelemetryHelper.LogExceptionTag("Could not find 1st party addin assetId in list: "+t.assetId,e,r.correlationId,34366476),void P.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),i.activateAsync(t,n,r)},errorCode:l.ErrorStatusCodes.WAC_FirstPartyAddInListRequestFailure});i.GetFirstPartyManifest(o,r,s,function(a){if(a.status!=P.DataServiceResultCode.Succeeded)return m.RuntimeTelemetryHelper.LogExceptionTag("Could not find get 1st party manifest: "+t.assetId,e,r.correlationId,34366477),void P.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),i.activateAsync(t,n,r)},errorCode:l.ErrorStatusCodes.WAC_AgaveManifestRequestFailure});var o=a.value;n.load({entitlement:t,manifest:o,eToken:""},e)})})})},t}(),P.FirstPartyCatalog=N,P.CatalogFactory.register(l.StoreType.FirstParty,function(e){if(e.osfOmexBaseUrl&&e.firstPartyManifestCDNUrl){var t,n=e.osfOmexBaseUrl.indexOf(l.Constants.ProtocolSeparator);t=n>=0?e.osfOmexBaseUrl.substr(n):l.Constants.ProtocolSeparator+e.osfOmexBaseUrl;var r=l.Constants.Https+t;return new N({appName:e.appName,appUILocale:e.appUILocale,AppVersion:e.appVersion,clientMode:e.clientMode,docUrl:e.docUrl,omexBaseUrl:r,omexForceAnonymous:!0,firstPartyManifestCDNUrl:e.firstPartyManifestCDNUrl})}return new P.ForbiddenCatalog({loaderParams:P.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR,errorCode:l.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED}),controlStatus:l.OsfControlStatus.ActivationFailed})}),function(e){var t=function(){var e="OMEX_clearCacheAsync",t="OMEX_removeCacheAsync",n="OMEX_getAppStateAsync",r="OMEX_getKilledAppsAsync",i="OMEX_getManifestAndETokenAsync";function a(){}return a.CheckProxyIsReady="OMEX_isProxyReady",a.Gated_GetManifestAndEToken=i,a.Gated_GetKilledApps=r,a.Gated_GetEntitlementSummary="OMEX_getEntitlementSummaryAsync",a.Gated_GetAppState=n,a.Gated_RemoveApp="OMEX_removeAppAsync",a.Gated_RemoveCache=t,a.Gated_ClearCache=e,a.UnGated_GetAppDetails="OMEX_getAppDetailsAsync",a.UnGated_GetRecommendations="OMEX_getRecommendationsAsync",a.UnGated_ClearCache=e,a.Anonymous_GetManifestAndEToken=i,a.Anonymous_GetKilledApps=r,a.Anonymous_GetAppState=n,a.Anonymous_RemoveCache=t,a.Anonymous_ClearCache=e,a.Anonymous_GetAuthNStatus="OMEX_getAuthNStatus",a.Anonymous_GetFirstPartyAddInList="OMEX_getFirstPartyAddInListAsync",a.Anonymous_GetFirstPartyManifest="OMEX_getFirstPartyManifestAsync",a}();e.OmexProxyMethods=t;var n=function(n){function r(e){n.call(this),this.osfOmexBaseUrl=e}return h(r,n),r.prototype.prepareProxy=function(e,t,n){n&&(this.isReady=!1,r.resetProxy(this)),this.isReady?e({status:null,value:{clientEndpoint:this.clientEndPoint}}):this.clientEndPoint?this.pendingCallbacks.push([e,t]):this.createProxy(e,t)},r.resetProxy=function(e){Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(e.conversationId)&&Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(e.conversationId),e.iframe&&(l.OUtil.removeEventListener(e.iframe,"load",e.iframeOnload),e.iframe.parentNode.removeChild(e.iframe),e.iframe=null),e.clientEndPoint=null},r.prototype.createProxy=function(n,i){try{!this.doesUrlHaveSupportedProtocol(this.proxyUrl)&&i({status:null,value:{errorMessage:"Protocal of proxyUrl is not supported."}});var a=document.createElement("iframe");a.setAttribute("id",this.proxyName),a.setAttribute("name",this.proxyName);var o=this.proxyUrl+"?"+this.conversationId;o=l.OUtil.addXdmInfoAsHash(o,this.conversationId+"|"+this.proxyName+"|"+window.location.href),o=l.OUtil.addSerializerVersionAsHash(o,l.SerializerVersion.Browser),a.setAttribute("src",o),a.setAttribute("scrolling","auto"),a.setAttribute("border","0"),a.setAttribute("width","0"),a.setAttribute("height","0"),a.setAttribute("style","position: absolute; left: -100px; top:0px;"),document.body.appendChild(a);var s=this,c=function(){if(s.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(s.conversationId,a.contentWindow,s.proxyUrl),s.clientEndPoint)s.clientEndPoint.invoke(t.CheckProxyIsReady,function(e,t){var n=s.pendingCallbacks.length;if(0!=n){var i=null;0===e&&t.status?(s.isReady=!0,i={status:null,value:{clientEndpoint:s.clientEndPoint}}):(r.resetProxy(s),i={status:null,value:{errorMessage:"isProxyReadyCallback failed, error code "+e}});for(var a=0;a<n;a++){var o=s.pendingCallbacks.shift();s.isReady?o[0](i):o[1](i)}}},{__timeout__:500});else{var e="Unexpected error, iframe loaded again after failing OMEX_isProxyReady";m.RuntimeTelemetryHelper.LogExceptionTag(e,null,null,18121820),i({status:null,value:{errorMessage:e}})}l.OUtil.set_entropy((new Date).getTime())};l.OUtil.addEventListener(a,"load",c),this.iframeOnload=c,this.pendingCallbacks.push([n,i]),this.iframe=a}catch(t){var u="Error creating client endpoint with proxyUrl = ["+this.proxyUrl+"], msg:"+e.WACUtils.serializeObjectToString(t);i({status:null,value:{errorMessage:u}})}},r}(e.ProxyBase);e.OmexProxyBase=n}(ne||(ne={})),R=ne||(ne={}),D=function(e){function t(t){e.call(this,t),this.proxyName="__omexExtensionAnonymousProxy",this.proxyUrl=this.osfOmexBaseUrl+"/anonymousserviceextension.aspx"}return h(t,e),t.prototype.getManifestAsync=function(e,t){this.invokeProxyCommandAsync(R.OmexProxyMethods.Anonymous_GetManifestAndEToken,e,function(e){null!=e.value&&e.status==R.DataServiceResultCode.Succeeded&&(e.value=R.OmexXmlProcessor.ConvertClientAppInstallInfo(e.value)),t(e)})},t.prototype.getFirstPartyAddInListAsync=function(e,t){this.invokeProxyCommandAsync(R.OmexProxyMethods.Anonymous_GetFirstPartyAddInList,e,function(e){t(e)})},t.prototype.getFirstPartyManifestAsync=function(e,t){this.invokeProxyCommandAsync(R.OmexProxyMethods.Anonymous_GetFirstPartyManifest,e,function(e){t(e)})},t.prototype.getAppStateAsync=function(e,t){this.invokeProxyCommandAsync(R.OmexProxyMethods.Anonymous_GetAppState,e,function(e){null!=e.value&&e.status==R.DataServiceResultCode.Succeeded&&(e.value=R.OmexXmlProcessor.ConvertAppState(e.value)),t(e)})},t.prototype.getKilledAppAsync=function(e,t){this.invokeProxyCommandAsync(R.OmexProxyMethods.Anonymous_GetKilledApps,e,function(e){null!=e.value&&e.status==R.DataServiceResultCode.Succeeded&&(e.value=R.OmexXmlProcessor.ConvertKilledAppsInfo(e.value)),t(e)})},t.prototype.getAuthNStatusAsync=function(e,t){this.invokeProxyCommandAsync(R.OmexProxyMethods.Anonymous_GetAuthNStatus,e,t)},t}(R.OmexProxyBase),R.AnonymousOmexProxy=D,w=ne||(ne={}),F=function(e){function t(t){e.call(this,t),this.proxyName="__omexExtensionGatedProxy",this.proxyUrl=this.osfOmexBaseUrl+"/gatedserviceextension.aspx"}return h(t,e),t.prototype.getOmexEntitlementsAsync=function(e,t){this.invokeProxyCommandAsync(w.OmexProxyMethods.Gated_GetEntitlementSummary,e,function(e){null!=e.value&&e.status==w.DataServiceResultCode.Succeeded&&(e.value=w.OmexXmlProcessor.ConvertEntitlementInfo(e.value)),t(e)})},t.prototype.getManifestAndETokenAsync=function(e,t){this.invokeProxyCommandAsync(w.OmexProxyMethods.Gated_GetManifestAndEToken,e,function(e){null!=e.value&&e.status==w.DataServiceResultCode.Succeeded&&(e.value=w.OmexXmlProcessor.ConvertClientAppInstallInfo(e.value)),t(e)})},t.prototype.getAppStateAsync=function(e,t){this.invokeProxyCommandAsync(w.OmexProxyMethods.Gated_GetAppState,e,function(e){null!=e.value&&e.status==w.DataServiceResultCode.Succeeded&&(e.value=w.OmexXmlProcessor.ConvertAppState(e.value)),t(e)})},t.prototype.getKilledAppAsync=function(e,t){this.invokeProxyCommandAsync(w.OmexProxyMethods.Gated_GetKilledApps,e,function(e){null!=e.value&&e.status==w.DataServiceResultCode.Succeeded&&(e.value=w.OmexXmlProcessor.ConvertKilledAppsInfo(e.value)),t(e)})},t.prototype.removeApps=function(e,t){this.invokeProxyCommandAsync(w.OmexProxyMethods.Gated_RemoveApp,e,function(e){null!=e.value&&e.status==w.DataServiceResultCode.Succeeded&&(e.value=w.OmexXmlProcessor.ConvertRemoveAppResponse(e.value)),t(e)})},t}(w.OmexProxyBase),w.GatedOmexProxy=F,function(e){var t,n,r="";(n=t||(t={}))[n.NotDetected=0]="NotDetected",n[n.AuthedUser=1]="AuthedUser",n[n.AnonymousUser=2]="AnonymousUser";var i=function(){function n(n){this.currentUserType=t.NotDetected,this.omexAuthNStatus=l.OmexAuthNStatus.NotAttempted,this.omexAuthConnectTries=1,this.initParams=n,this.gatedProxy=new e.GatedOmexProxy(n.omexBaseUrl),this.ungatedProxy=new e.UnGatedOmexProxy(n.omexBaseUrl),this.anonymousProxy=new e.AnonymousOmexProxy(n.omexBaseUrl)}return n.getInstance=function(e){return null==n._instance&&(n._instance=new n(e)),n._instance},n.getFirstPartyInstance=function(e){if(null==n._firstPartyInstance){var t=new n(e);t._isFirstParty=!0,t.omexAuthNStatus=l.OmexAuthNStatus.Anonymous,this._firstPartyInstance=t}return n._firstPartyInstance},n.prototype.prepareProxy=function(n,i){var a=this;n=n||r;this.ensureOmexProxySetUp(n,function(n){var r;n&&null!=n.status?n.status:e.DataServiceResultCode.ProxyNotReady;n&&n.value&&(a._isFirstParty?r=!0:n.value.currentUserType&&(n.value.currentUserType==t.AuthedUser?r=!1:n.value.currentUserType==t.AnonymousUser&&(r=!0))),i({status:n.status,value:{anonymous:r}})})},n.prototype.createScope=function(e){return new o(e,this)},n.prototype.getCID=function(){switch(this.currentUserType){case t.AuthedUser:return this._cid;case t.AnonymousUser:return r}throw"not initialized"},n.prototype.ensureOmexProxySetUp=function(n,r){if(this.currentUserType==t.NotDetected||!this.anonymousProxy.isReady&&!this.gatedProxy.isReady){var i=this,a=function(){i.currentUserType=t.AuthedUser,r({status:e.DataServiceResultCode.Succeeded,value:i})},o=function(){i.omexAuthConnectTries<l.Constants.AuthenticatedConnectMaxTries?(i.omexAuthConnectTries++,i.omexAuthNStatus!==l.OmexAuthNStatus.CheckFailed?i.anonymousProxy.prepareProxy(s,u):i.gatedProxy.prepareProxy(a,o)):(m.RuntimeTelemetryHelper.LogExceptionTag("exceed maximum tries and fail",null,n,18657693),i.anonymousProxy.prepareProxy(c,u))},s=function(e){if(e&&e.value){i.anonymousProxy.getAuthNStatusAsync({correlationId:n},function(e){if(e.status===l.ProxyCallStatusCode.Succeeded){var t=e.value;t==l.OmexAuthNStatus.Authenticated?(i.omexAuthNStatus=l.OmexAuthNStatus.Authenticated,i.gatedProxy.prepareProxy(a,o)):t!=l.OmexAuthNStatus.Anonymous&&t!=l.OmexAuthNStatus.Unknown||(i.omexAuthNStatus=l.OmexAuthNStatus.Anonymous,i.anonymousProxy.prepareProxy(c,u))}else m.RuntimeTelemetryHelper.LogExceptionTag("auth check failure.",null,n,18657694),i.omexAuthNStatus=l.OmexAuthNStatus.CheckFailed,i.initParams.omexForceAnonymous?i.anonymousProxy.prepareProxy(c,u):i.gatedProxy.prepareProxy(a,o)})}else m.RuntimeTelemetryHelper.LogExceptionTag("GetAuthNStatus callback param invalid",null,n,18657695)},c=function(n){i.omexAuthNStatus==l.OmexAuthNStatus.NotAttempted?s(n):(i.currentUserType=t.AnonymousUser,r({status:e.DataServiceResultCode.Succeeded,value:i}))},u=function(){m.RuntimeTelemetryHelper.LogExceptionTag("create anonymous proxy failure",null,n,18657696),r({status:e.DataServiceResultCode.ProxyNotReady})};i.initParams.omexForceAnonymous?i.anonymousProxy.prepareProxy(c,u):i.gatedProxy.prepareProxy(a,o)}else r({status:e.DataServiceResultCode.Succeeded,value:this})},n}();e.ProxyBasedCatalogService=i;var a=function(){function e(){}return e.dummyApplicationName="unused",e}(),o=function(){var n="contentMarket";function i(e,t){this._build=l.Constants.FileVersion,this._catalogService=t,this._appVersion=l.OmexAppVersions[this._catalogService.initParams.appName],this._clientName=l.OmexClientNames[this._catalogService.initParams.appName],this._clientVersion=s.getClientVersionFromWACAppVersion(this._catalogService.initParams.AppVersion),this._correlationId=e.telemetryContext.correlationId||r}return i.prototype.getFirstPartyAddInList=function(e){var t=this.buildOmexRequestParameters();t.errors={},this._catalogService.anonymousProxy.getFirstPartyAddInListAsync(t,e)},i.prototype.getFirstPartyManifest=function(e,t){var n=this.buildOmexRequestParameters();n.errors={},n.manifestUrl=e,this._catalogService.anonymousProxy.getFirstPartyManifestAsync(n,t)},i.prototype.tryFail=function(t,n,r){return t!=e.DataServiceResultCode.Succeeded&&(r({status:t}),!0)},i.prototype.isUserTypeValid=function(e){return e!==t.NotDetected||(m.RuntimeTelemetryHelper.LogExceptionTag("userType is invalid.",null,this._correlationId,18657698),!1)},i.prototype.getEntitlementAsync=function(n,r,i){var o=this,s=this.buildOmexRequestParameters();s.applicationName=a.dummyApplicationName,s.appVersion=this._appVersion,s.clearEntitlement=i||!1;var l=this._catalogService.currentUserType;this.isUserTypeValid(l)?l===t.AuthedUser?this._catalogService.gatedProxy.getOmexEntitlementsAsync(s,function(e){o.tryFail(e.status,e.httpStatus,r)||(o._catalogService._cid=e.value.cid,r(e))}):l===t.AnonymousUser&&r({status:e.DataServiceResultCode.Succeeded,value:{refreshRate2:0,entitlements:[]}}):r({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,entitlements:[]}})},i.prototype.getLastStoreUpdate=function(){},i.prototype.isStoreDisabled=function(t){t({status:e.DataServiceResultCode.Succeeded,value:!1})},i.prototype.getManifest=function(t,n,i){this.getETokenAndManifestInternal(t,n,l.ClientAppInfoReturnType.urlOnly,function(t){var n=t&&t.value&&t.value.manifest?t.value.manifest:r,a=t&&t.value&&t.value.status2?t.value.status2:l.OmexClientAppStatus.ServerError,o=t?t.status:e.DataServiceResultCode.Failed;i({status:o,value:{status2:a,manifest:n}})})},i.prototype.getEToken=function(e,t,n){this.getETokenAndManifestInternal(e,t,l.ClientAppInfoReturnType.etokenOnly,n)},i.prototype.getETokenAndManifest=function(e,t,n){this.getETokenAndManifestInternal(e,t,l.ClientAppInfoReturnType.both,n)},i.prototype.getAppState=function(i,a){var o=this,s=this.buildOmexRequestParameters();s.assetID=i.assetId,s[n]=i.storeId,s.errors={};var l=this._catalogService.currentUserType;this.isUserTypeValid(l)?l===t.AuthedUser?this._catalogService.gatedProxy.getAppStateAsync(s,function(e){o.tryFail(e.status,e.httpStatus,a)?o.logServiceCallResponseError("appstate",e.httpStatus):a(e)}):l===t.AnonymousUser&&this._catalogService.anonymousProxy.getAppStateAsync(s,a):a({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,assetId:r,productId:r,version:r,state2:-1}})},i.prototype.getKilledApps=function(n){var r=this,i=this.buildOmexRequestParameters(),a=this._catalogService.currentUserType;this.isUserTypeValid(a)?a===t.AuthedUser?this._catalogService.gatedProxy.getKilledAppAsync(i,function(e){r.tryFail(e.status,e.httpStatus,n)?r.logServiceCallResponseError("killedapps",e.httpStatus):n(e)}):a===t.AnonymousUser&&this._catalogService.anonymousProxy.getKilledAppAsync(i,n):n({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,killedApps:null}})},i.prototype.getAppDetails=function(e,t,i){var a=this,o=this.buildOmexRequestParameters();o.assetid=r,o.assetID=e.join(","),o[n]=t,this._catalogService.ungatedProxy.getAppDetailsAsync(o,function(e){a.tryFail(e.status,e.httpStatus,i)?a.logServiceCallResponseError("appdetails",e.httpStatus):i(e)})},i.prototype.removeApps=function(n,i){var a=this,o=this.buildOmexRequestParameters();o.assetid=r,o.assetID=n.join(",");var s=this._catalogService.currentUserType;this.isUserTypeValid(s)?s===t.AuthedUser?this._catalogService.gatedProxy.removeApps(o,function(e){a.tryFail(e.status,e.httpStatus,i)?a.logServiceCallResponseError("removeapps",e.httpStatus):i(e)}):s===t.AnonymousUser&&i({status:e.DataServiceResultCode.Succeeded,value:{removedApps:[]}}):i({status:e.DataServiceResultCode.UnknownUserType,value:{removedApps:[]}})},i.prototype.getETokenAndManifestInternal=function(i,o,s,c){var u=this,d=this.buildOmexRequestParameters();d.applicationName=a.dummyApplicationName,d.assetID=i.assetId,d.clientAppInfoReturnType=s;var p=this._catalogService.currentUserType;this.isUserTypeValid(p)?p===t.AuthedUser&&s!=l.ClientAppInfoReturnType.urlOnly?(d.assetContentMarket=o,d.userContentMarket=i.storeId,d.expectedVersion=i.appVersion,this._catalogService.gatedProxy.getManifestAndETokenAsync(d,function(e){u.tryFail(e.status,e.httpStatus,c)?u.logServiceCallResponseError("manifestandetoken",e.httpStatus):c(e)})):(d[n]=i.storeId,d.clientAppInfoReturnType==l.ClientAppInfoReturnType.etokenOnly?c({status:e.DataServiceResultCode.Succeeded,value:{status2:l.OmexClientAppStatus.OK,etoken:r,manifest:null}}):this._catalogService.anonymousProxy.getManifestAsync(d,function(e){u.tryFail(e.status,e.httpStatus,c)?u.logServiceCallResponseError("manifest",e.httpStatus):c(e)})):c({status:e.DataServiceResultCode.UnknownUserType,value:{etoken:r,manifest:null}})},i.prototype.buildOmexRequestParameters=function(){return{clientName:this._clientName,clientVersion:this._clientVersion,correlationId:this._correlationId,build:this._build}},i.prototype.logServiceCallResponseError=function(e,t){var n="proxybased request "+e+" failed";t&&(n+=":"+t),m.RuntimeTelemetryHelper.LogExceptionTag(n,null,this._correlationId,18657697)},i}();e.ProxyBasedCatalogServiceScope=o;var s=function(){function e(){}return e.getClientVersionFromWACAppVersion=function(e){if(e){var t=e.split("."),n=parseInt(t[0],10),r=parseInt(t[1],10)||0;if(!(n<=15&&r<=0)){var i=l.Constants.FileVersion.split(".");return n+"."+r+"."+i[2]+"."+i[3]}}},e.getOmexEndPointPageUrl=function(e,t,n){return l.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",e,n,t)},e}();e.OmexUtils=s}(ne||(ne={})),U=ne||(ne={}),L=function(e){function t(t){e.call(this,t),this.proxyName="__omexExtensionProxy",this.proxyUrl=this.osfOmexBaseUrl+"/ungatedserviceextension.aspx"}return h(t,e),t.prototype.getAppDetailsAsync=function(e,t){this.invokeProxyCommandAsync(U.OmexProxyMethods.UnGated_GetAppDetails,e,function(e){null!=e.value&&e.status==U.DataServiceResultCode.Succeeded&&(e.value=U.OmexXmlProcessor.ConvertAppDetails(e.value)),t(e)})},t}(U.OmexProxyBase),U.UnGatedOmexProxy=L,B=ne||(ne={}),j=null,H=!0,V=function(){var e="cacheExpired";function t(e,t){this._initParam=t,this._cacheManager=e.cacheManager,this._cachePrefix=e.cachePrefix,this._cid=e.cid,this._anonymous=e.anonymous,this._telemetryContext=e.telemetryContext}return t.prototype.GetCacheKeyPrefix=function(){return this._cachePrefix},t.prototype.getOmexEndPointPageUrl=function(e,t){return B.OmexUtils.getOmexEndPointPageUrl(this._initParam.omexBaseUrl,e,t)},t.prototype.getKilledApps=function(e,t,n){var r=this;this._telemetryContext.startActivity(B.Activity.KilledAppsCheck);var i=l.OUtil.formatString(B.CacheConsts.killedAppsCacheKey,this.GetCacheKeyPrefix());if(n)this._cacheManager.RemoveCacheItem(i);else{var a=this._cacheManager.GetCacheItem(i,H);if(a&&a.refreshRate2!=j)return this._telemetryContext.stopActivity(B.Activity.KilledAppsCheck),void t({status:B.DataServiceResultCode.Succeeded,value:a})}e.getKilledApps(function(e){e.status==B.DataServiceResultCode.Succeeded?(r._telemetryContext.stopActivity(B.Activity.KilledAppsCheck),a=e.value,r._cacheManager.SetCacheItem(i,a,a.refreshRate/B.CacheConsts.hourToDayConversionFactor),t(e)):t(e)})},t.prototype.getAppState=function(t,n,r,i){var a=this;this._telemetryContext.startActivity(B.Activity.AppStateCheck);var o,s=l.OUtil.formatString(B.CacheConsts.appStateCacheKey,this.GetCacheKeyPrefix(),n.storeId,n.assetId);if(i)this._cacheManager.RemoveCacheItem(s);else{var c={};if(o=this._cacheManager.GetCacheItem(s,H,c),this._telemetryContext.setFlag(B.FlagName.AppStateDataInvalidFlag,c[e]||!1),o&&o.state2!=j)return this._telemetryContext.stopActivity(B.Activity.AppStateCheck),this._telemetryContext.setFlag(B.FlagName.AppStateDataCachedFlag,H),void r({status:B.DataServiceResultCode.Succeeded,value:o})}t.getAppState(n,function(e){e.status==B.DataServiceResultCode.Succeeded?(a._telemetryContext.stopActivity(B.Activity.AppStateCheck),a._telemetryContext.setFlag(B.FlagName.AppStateDataCachedFlag,!1),o=e.value,a._cacheManager.SetCacheItem(s,o,o.refreshRate2/B.CacheConsts.hourToDayConversionFactor),r(e)):r(e)})},t.prototype.getManifest=function(t,n,r,i,a){var o=this;this._telemetryContext.startActivity(B.Activity.ManifestRequest);var s,c=l.OUtil.formatString(B.CacheConsts.anonymousAppInstallInfoCacheKey,n.assetId,n.storeId);if(a)this._cacheManager.RemoveCacheItem(c);else{var u={};if(s=this._cacheManager.GetCacheItem(c,H,u),this._telemetryContext.setFlag(B.FlagName.ManifestDataInvalidFlag,u[e]||!1),s&&s.status2!=j)return this._telemetryContext.stopActivity(B.Activity.ManifestRequest),this._telemetryContext.stopActivity(B.Activity.ServerCall),this._telemetryContext.setFlag(B.FlagName.ManifestDataCachedFlag,H),void i({status:B.DataServiceResultCode.Succeeded,value:{status2:s.status2,manifest:s.manifest}})}t.getManifest(n,r,function(e){e.status==B.DataServiceResultCode.Succeeded&&e.value.status2==l.OmexClientAppStatus.OK?(o._telemetryContext.stopActivity(B.Activity.ManifestRequest),o._telemetryContext.stopActivity(B.Activity.ServerCall),o._telemetryContext.setFlag(B.FlagName.ManifestDataCachedFlag,!1),o._telemetryContext.setBits(B.FlagName.ManifestRequestType,l.ManifestRequestTypes.Manifest),s={etoken:"",status2:e.value.status2,manifest:e.value.manifest},o._cacheManager.SetCacheItem(c,s,B.CacheConsts.manifestRefreshRate),i(e)):i(e)})},t.prototype.removeApps=function(e,t,n){var r=this;e.removeApps(t,function(e){if(e.status==B.DataServiceResultCode.Succeeded){for(var t=!1,i=[],a=e.value.removedApps,o=0;o<a.length;++o)a[o].result2==l.OmexRemoveAppStatus.Success&&(i.push(new RegExp(l.OUtil.formatString(B.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,".*",a[o].assetId,".*",".*"),"i")),t=H);t&&r._cacheManager.RemoveMatches(i),n(e)}else n(e)})},t.prototype.getCachedETokenAndManifest=function(t){var n={},r=this._cacheManager.GetCacheItem(t,H,n);if(this._telemetryContext.setFlag(B.FlagName.ManifestDataInvalidFlag,n[e]||!1),r){if(r.status2&&r.tokenExpirationDate2&&r.tokenExpirationDate2>(new Date).getTime())return r;r.etoken=j,r.tokenExpirationDate2=j,r.entitlementType=j}return r},t.prototype.getETokenAndManifest=function(e,t,n,r,i){var a=this;if(this._anonymous)this.getManifest(e,t,n,function(e){B.AsyncUtil.failed(e,r)||r({status:e.status,value:{etoken:"",status2:e.value.status2,manifest:e.value.manifest}})},i);else{this._telemetryContext.startActivity(B.Activity.ManifestRequest);var o,s=function(e,t){a._telemetryContext.stopActivity(B.Activity.ManifestRequest),a._telemetryContext.stopActivity(B.Activity.ServerCall),a._telemetryContext.setFlag(B.FlagName.ManifestDataCachedFlag,e),t&&a._telemetryContext.setBits(B.FlagName.ManifestRequestType,t)},c=l.OUtil.formatString(B.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,this._cid,t.assetId,t.storeId,n);if(i)this._cacheManager.RemoveCacheItem(c);else{if((o=this.getCachedETokenAndManifest(c))&&o.etoken&&o.manifest)return s(H),void r({status:B.DataServiceResultCode.Succeeded,value:o});var u=o?o.manifest:j;if(u==j||""==u){var d=l.OUtil.formatString(B.CacheConsts.anonymousAppInstallInfoCacheKey,t.assetId,t.storeId),p=this._cacheManager.GetCacheItem(d,H);p&&(u=p.manifest)}if(u)return void(o&&o.etoken?(s(H),o.manifest=u,r({status:B.DataServiceResultCode.Succeeded,value:o})):e.getEToken(t,n,function(e){e.status===B.DataServiceResultCode.Succeeded&&e.value&&(s(!1,l.ManifestRequestTypes.Etoken),(o=e.value).status2===l.OmexClientAppStatus.OK&&(a._cacheManager.SetCacheItem(c,o,B.CacheConsts.manifestRefreshRate),o.manifest=u)),r(e)}))}e.getETokenAndManifest(t,n,function(e){e.status==B.DataServiceResultCode.Succeeded?(s(!1,l.ManifestRequestTypes.Both),e.value.status2===l.OmexClientAppStatus.OK&&a._cacheManager.SetCacheItem(c,e.value,B.CacheConsts.manifestRefreshRate),r(e)):r(e)})}},t.prototype.getEntitlements=function(e,t,n,r){var i=this;this._telemetryContext.startActivity(B.Activity.EntitlementCheck);var a,o,s=function(){o!=j&&a!=j&&(a=a.filter(function(e){return o.every(function(t){return t.assetId!=e.assetId})}),n({status:B.DataServiceResultCode.Succeeded,value:{entitlements:a,killed:o}}))};this._anonymous?(a=[],this._telemetryContext.stopActivity(B.Activity.EntitlementCheck),s()):e.getEntitlementAsync(t,function(e){i._telemetryContext.stopActivity(B.Activity.EntitlementCheck),n!=j&&(B.AsyncUtil.failed(e,n)?n=j:(i._cid||(i._cid=e.value.cid),a=e.value.entitlements,s()))},r),this.getKilledApps(e,function(e){n!=j&&(o=e.status==B.DataServiceResultCode.Succeeded?e.value.killedApps:[],s())})},t.prototype.activate=function(e,t,n){var r,i,a=this,o={assetId:t.assetId,appVersion:t.appVersion,storeId:t.storeId,storeType:t.storeType,targetType:t.targetType},s=!1,c=this.getOmexEndPointPageUrl(o.assetId,o.storeId),u=B.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),d=function(i,s){switch(i.status2){case l.OmexClientAppStatus.OK:if(i.tokenExpirationDate2&&i.tokenExpirationDate2<=(new Date).getTime())return void B.LoaderUtil.failWithWarning(n,B.LoaderUtil.warning({description:Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){return p()},errorCode:l.ErrorStatusCodes.E_TOKEN_EXPIRED}));var d=B.ManifestUtil.ParseManifest(i.manifest,a._initParam.appUILocale,a._telemetryContext.correlationId);if(d==j)return void B.LoaderUtil.failWithError(n,{infoType:l.InfoType.Error,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),a.restartActivationTelemetry(),p()},description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,errorCode:l.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT});var h=d.getMarketplaceVersion();if(l.OsfManifestManager.cacheManifest(o.assetId,t.appVersion,d),!1===d.requirementsSupported||void 0===d.requirementsSupported&&!n.getRequirementsChecker().isManifestSupported(d)){d.requirementsSupported=!1;var v;return v=Strings.OsfRuntime.L_AgaveManifestRequirementsErrorOmex_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,void B.LoaderUtil.failWithError(n,{description:v,url:c,detailView:H,errorCode:l.ErrorStatusCodes.WAC_AgaveRequirementsErrorOmex})}d.requirementsSupported=H,a._telemetryContext.setFlag(B.FlagName.ManifestTrustCachedFlag,!s);var y=l.OUtil.formatString(l.Constants.ActivatedCacheKey,t.assetId.toLowerCase(),t.storeType,t.storeId);if(s&&!n.skipTrust(t)){if(!(a._anonymous&&a._cacheManager.GetCacheItem(y,!1))&&!n.hasConsent(t))return void n.askForTrust({anonymous:!1,entitlement:o,displayName:d.getDefaultDisplayName(),providerName:d.getProviderName(),url:c,isSSOAddin:d.isSSOAddin()},function(){a.restartActivationTelemetry(),a._cacheManager.SetCacheItem(y,H),a._anonymous?n.load({entitlement:o,manifest:d,eToken:i.etoken},j):a.getETokenAndManifest(e,o,o.storeId,function(e){e.status==B.DataServiceResultCode.Succeeded&&e.value.status2==l.OmexClientAppStatus.OK?(e.value.version!=j&&B.ManifestUtil.versionLessThan(o.appVersion,e.value.version)&&(o.appVersion=e.value.version),g(H)):B.LoaderUtil.failWithError(n,{infoType:l.InfoType.Error,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),a.restartActivationTelemetry(),p()},description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,errorCode:l.ErrorStatusCodes.WAC_AgaveManifestAndEtokenRequestFailure})})})}n.hasConsent(t)&&a._cacheManager.SetCacheItem(y,H);var _=r.version;B.ManifestUtil.versionLessThan(_,t.appVersion)&&(_=t.appVersion),B.ManifestUtil.versionLessThan(h,_)?(o.appVersion=_,B.LoaderUtil.showWarning(n,{description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,buttonCallback:function(){n.restartActivation(),a.restartActivationTelemetry(),p(H),f()},url:c,highPriority:H,displayDeactive:!1,errorCode:l.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE})):r.state2===l.OmexState.DeveloperWithdrawn?B.LoaderUtil.showWarning(n,{description:Strings.OsfRuntime.L_AgaveRetiring_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,url:c,displayDeactive:!1,errorCode:l.ErrorStatusCodes.S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE}):r.state2===l.OmexState.Flagged?B.LoaderUtil.showWarning(n,{description:Strings.OsfRuntime.L_AgaveSoftKilled_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,url:c,displayDeactive:!1,errorCode:l.ErrorStatusCodes.S_OEM_EXTENSION_FLAGGED}):!a._anonymous&&i.entitlementType&&i.entitlementType.toLowerCase()===l.OmexEntitlementType.Trial&&(B.LoaderUtil.showNotification(n,{description:Strings.OsfRuntime.L_AgaveTrial_ERR,buttonTxt:Strings.OsfRuntime.L_BuyButton_TXT,buttonCallback:function(){return window.open(c)},reDisplay:H,highPriority:H,displayDeactive:!1,errorCode:l.ErrorStatusCodes.S_OEM_EXTENSION_TRIAL_MODE}),B.LoaderUtil.showNotification(n,{description:Strings.OsfRuntime.L_AgaveTrialRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){n.restartActivation(),a.restartActivationTelemetry(),p(H)},detailView:H,reDisplay:H,highPriority:H,displayDeactive:!1,errorCode:l.ErrorStatusCodes.S_USER_CLICKED_BUY})),n.load({entitlement:o,manifest:d,eToken:i.etoken},j);break;case l.OmexClientAppStatus.KilledAsset:B.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:c,errorCode:l.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED});break;case l.OmexClientAppStatus.NoEntitlement:case l.OmexClientAppStatus.TrialNotSupported:case l.OmexClientAppStatus.LimitedTrial:case l.OmexClientAppStatus.EntitlementDeactivated:if(a._anonymous){B.LoaderUtil.failWithError(n,{title:Strings.OsfRuntime.L_AgaveSigninRequiredTitle_TXT,description:Strings.OsfRuntime.L_AgaveNotViewableAnonymous_ERR,buttonTxt:Strings.OsfRuntime.L_SignInButton_TXT,buttonCallback:function(){var e=window.location.href,t=a._initParam.omexBaseUrl+l.Constants.SignInRedirectUrl+encodeURIComponent(e);window.open(t)},errorCode:l.ErrorStatusCodes.E_USER_NOT_SIGNED_IN})}else{n.setRetryCall(function(){a.restartActivationTelemetry(),p(H)}),B.LoaderUtil.failWithWarning(n,{description:Strings.OsfRuntime.L_AgaveLicenseNotAquired_ERR,buttonTxt:Strings.OsfRuntime.L_BuyButton_TXT,buttonCallback:function(){window.open(c),B.LoaderUtil.showWarning(n,{description:Strings.OsfRuntime.L_AgaveLicenseNotAquiredRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){n.restartActivation(),a.restartActivationTelemetry(),p(H)},detailView:H,retryAll:H,errorCode:l.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})},errorCode:l.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})}break;case l.OmexClientAppStatus.UnknownAssetId:B.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,errorCode:l.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST});break;case l.OmexClientAppStatus.Expired:case l.OmexClientAppStatus.Invalid:B.LoaderUtil.failWithWarning(n,{description:Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),a.restartActivationTelemetry(),p()},errorCode:l.ErrorStatusCodes.E_TOKEN_EXPIRED});break;case l.OmexClientAppStatus.Revoked:B.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveRetired_ERR,url:c,errorCode:l.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE});break;case l.OmexClientAppStatus.VersionMismatch:o.appVersion=i.version,n.askForUpgrade(B.LoaderUtil.warning({description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,url:c,highPriority:H,logAsError:H,errorCode:l.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE}),function(){a.restartActivationTelemetry(),p(H)});break;case l.OmexClientAppStatus.VersionNotSupported:B.LoaderUtil.failWithWarning(n,{description:Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,errorCode:l.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType},l.OsfControlStatus.UnsupportedStore);break;case l.OmexClientAppStatus.UserIsMinor:u&&u.enableDisplayBlockedMinorError&&B.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:l.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR});break;default:m.RuntimeTelemetryHelper.LogExceptionTag("unknown clientAppStatus in manifestAndEtoken: "+i.status2,j,a._telemetryContext.correlationId,20030238),B.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),a.restartActivationTelemetry(),p(H)},errorCode:l.ErrorStatusCodes.WAC_AgaveUnknownClientAppStatus})}},p=function(t){var c=i?i.contentMarket:o.storeId,f=function(e,r){return e.status!=B.DataServiceResultCode.Succeeded&&(u&&u.enableDisplayBlockedMinorError&&451===e.httpStatus?(B.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:l.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR}),H):(B.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),a.restartActivationTelemetry(),p(t)},errorCode:r}),H))};n.skipTrust(o)?a.getManifest(e,o,c,function(e){if(!f(e,l.ErrorStatusCodes.WAC_AgaveManifestRequestFailure))return t?(r=j,void v(H)):void d({etoken:"",status2:e.value.status2,manifest:e.value.manifest})},t):a.getETokenAndManifest(e,o,c,function(e){if(!f(e,l.ErrorStatusCodes.WAC_AgaveManifestAndEtokenRequestFailure))return t?(r=j,s=!1,g(H),void v(H)):void d(e.value)},t)},f=function(){var e=l.OUtil.formatString(B.CacheConsts.anonymousAppInstallInfoCacheKey,o.assetId,o.storeId);a._cacheManager.RemoveCacheItem(e)},h=function(){if(r!=j&&s){if(i!=j)return o.appVersion=i.version,void p();var u,f,m;if(r.state2===l.OmexState.Flagged?u=H:r.state2===l.OmexState.DeveloperWithdrawn?f=H:r.state2===l.OmexState.Withdrawn&&(m=H),!(u||f||m)||(B.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveRetired_ERR,url:c,errorCode:l.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE}),!u))if(n.hasConsent(t))p();else{var g=i?i.contentMarket:o.storeId;a.getManifest(e,o,g,function(e){e.status==B.DataServiceResultCode.Succeeded?d({etoken:"",status2:e.value.status2,manifest:e.value.manifest},H):B.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),a.restartActivationTelemetry(),h()},errorCode:l.ErrorStatusCodes.WAC_AgaveManifestRequestFailure})})}}},g=function(t){i=j,s=!1,a.getEntitlements(e,!1,function(e){if(e.status!=B.DataServiceResultCode.Succeeded)return u&&u.enableDisplayBlockedMinorError&&451===e.httpStatus?void B.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:l.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR}):void B.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),g()},errorCode:l.ErrorStatusCodes.WAC_AgaveEntitlementRequestFailure});e.value.killed.some(function(e){return e.assetId==o.assetId})?B.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:c,errorCode:l.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED}):(e.value.entitlements.some(function(e){return e.assetId.toLowerCase()==o.assetId.toLowerCase()&&(i=e,c=a.getOmexEndPointPageUrl(e.assetId,e.contentMarket),H)}),a._telemetryContext.setFlag(B.FlagName.OmexHasEntitlementFlag,i!=j),s=H,h())},t)},v=function(t){r=j,a.getAppState(e,o,function(e){if(e.status!=B.DataServiceResultCode.Succeeded)return r={state2:l.OmexState.OK,productId:j,assetId:o.assetId,version:o.appVersion,refreshRate2:0},void h();e.value.state2!==l.OmexState.Killed?(r=e.value,h()):B.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:c,errorCode:l.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED})},t)};v(),g()},t.prototype.restartActivationTelemetry=function(){this._telemetryContext.startActivity(B.Activity.Activation),this._telemetryContext.startActivity(B.Activity.ServerCall),this._telemetryContext.setFlag(B.FlagName.AnonymousFlag,this._anonymous)},t}(),W=function(){function e(e,t){void 0===t&&(t=j),this._anonymous=H,this._initParam=e,this._cacheManager=t||new B.AppsDataCacheManager(l.OUtil.getLocalStorage(),new B.SafeSerializer)}return e.prototype.GetCacheKeyPrefix=function(){return this._anonymous?B.CacheConsts.anonymousCacheKeyPrefix:B.WACUtils.CacheConstants.GatedCacheKeyPrefix},e.prototype.getOmexEndPointPageUrl=function(e,t){return l.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",this._initParam.omexBaseUrl,t,e)},e.prototype.getDataService=function(e,t){var n=this;if(this._dataService==j)if(this._dataServiceReady==j){this._dataServiceReady=t;var r={status:B.DataServiceResultCode.Failed,value:j},i=function(e,t){var i=n._dataServiceReady;n._dataServiceReady=j,e.status==B.DataServiceResultCode.Succeeded?(n._anonymous=e.value.anonymous,n._dataService=t,r.value=t,r.status=B.DataServiceResultCode.Succeeded,i(r)):(r.httpStatus=e.httpStatus,i(r))};e.startActivity(B.Activity.Authentication);var a=new B.S2SOmexCatalogService(this._initParam);a.initialize(e.correlationId,function(t){if(t.status==B.DataServiceResultCode.Succeeded){var r=B.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();if(!r||!r.enableAnonymousUseLegacyCatalogService||!t.value.anonymous)return e.stopActivity(B.Activity.Authentication),void i(t,a)}e.setBits(B.FlagName.ActivationRuntimeType,l.ActivationTypes.V2Enabled);var o=B.ProxyBasedCatalogService.getInstance(n._initParam);o.prepareProxy(e.correlationId,function(t){e.stopActivity(B.Activity.Authentication),e.setBits(B.FlagName.RetryCount,o.omexAuthConnectTries),i(t,o)})})}else{e.startActivity(B.Activity.Authentication);var o=this._dataServiceReady;this._dataServiceReady=function(n){e.stopActivity(B.Activity.Authentication),o(n),t(n)}}else t({status:B.DataServiceResultCode.Succeeded,value:this._dataService})},e.prototype.createActivityScope=function(e,t){var n=this;this.getDataService(e,function(r){if(B.AsyncUtil.failed(r,t))m.RuntimeTelemetryHelper.LogExceptionTag("failed to get data service.",j,e.correlationId,18657692);else{e.setFlag(B.FlagName.AnonymousFlag,n._anonymous);var i=r.value,a={cacheManager:n._cacheManager,cachePrefix:n.GetCacheKeyPrefix(),cid:i.getCID(),anonymous:n._anonymous,telemetryContext:e},o=i.createScope(a),s=new V(a,n._initParam);t({status:B.DataServiceResultCode.Succeeded,value:{serviceScope:o,activityScope:s}})}})},e.prototype.getEntitlementAsync=function(e,t,n,r,i){var a=this;this.createActivityScope(t,function(t){B.AsyncUtil.failed(t,n,[])||(a._anonymous?n({status:B.DataServiceResultCode.Failed,httpStatus:403}):t.value.serviceScope.getEntitlementAsync(e,function(e){if(!B.AsyncUtil.failed(e,n,[])){for(var t=e.value.entitlements,r=0;r<t.length;r++){var i=t[r],a=i;a.appVersion=i.version,a.storeId=i.contentMarket,a.storeType=l.StoreType.OMEX,a.targetType=l.OUtil.getTargetType(i.appSubType)}n({status:e.status,value:t})}},r,i))})},e.prototype.getAndCacheManifest=function(e,t,n,r,i){var a=this;i=i||!1;var o=l.OsfManifestManager.getCachedManifest(e.assetId,e.appVersion);i||o==j?this.createActivityScope(n,function(o){if(!B.AsyncUtil.failed(o,r)){var s=o.value.serviceScope;o.value.activityScope.getManifest(s,e,t,function(t){if(!B.AsyncUtil.failed(t,r))if(t.value.status2==l.OmexClientAppStatus.OK){var i=B.ManifestUtil.ParseManifest(t.value.manifest,a._initParam.appUILocale,n.correlationId);i!=j?(l.OsfManifestManager.cacheManifest(e.assetId,e.appVersion,i),r({status:B.DataServiceResultCode.Succeeded,value:i})):r({status:B.DataServiceResultCode.Failed,value:i})}else r({status:B.DataServiceResultCode.Failed})},i)}}):r({status:B.DataServiceResultCode.Succeeded,value:o})},e.prototype.activateAsync=function(e,t,n){var r=this;n.startActivity(B.Activity.Activation),n.startActivity(B.Activity.ServerCall),this.createActivityScope(n,function(i){r.isStoreDisabled(n,function(a){if(a.value===H)B.LoaderUtil.failWithError(t,{description:Strings.OsfRuntime.L_OmexStoreDisabledByAdmin,errorCode:l.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED});else if(i.status!=B.DataServiceResultCode.Succeeded)return void B.LoaderUtil.failWithError(t,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){t.restartActivation(),r.activateAsync(e,t,n)},errorCode:l.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError})});var a=i.value.serviceScope;i.value.activityScope.activate(a,e,t)})},e.prototype.removeAsync=function(e,t,n){this.createActivityScope(t,function(t){if(!B.AsyncUtil.failed(t,n)){var r=t.value.serviceScope;t.value.activityScope.removeApps(r,e,n)}})},e.prototype.getAppDetails=function(e,t,n,r,i){var a=this,o=[];if(i)this._cacheManager.RemoveAll(B.CacheConsts.ungatedCacheKeyPrefix);else{for(var s=e,c=[],u=0;u<s.length;++u){var d=l.OUtil.formatString(B.CacheConsts.appDetailKey,s[u]),p=this._cacheManager.GetCacheItem(d,H);p&&p.state2!=j?o.push(p):c.push(s[u])}if(0===c.length)return void r({status:B.DataServiceResultCode.Succeeded,value:o});e=c}this.createActivityScope(n,function(n){B.AsyncUtil.failed(n,r,o)||n.value.serviceScope.getAppDetails(e,t,function(e){if(!B.AsyncUtil.failed(e,r,o)){for(var t=e.value,n=0;n<t.length;++n){var i=t[n],s=l.OUtil.formatString(B.CacheConsts.appDetailKey,i.assetId);a._cacheManager.SetCacheItem(s,i),o.push(i)}e.value=o,r(e)}})})},e.prototype.isStoreDisabled=function(e,t){this.createActivityScope(e,function(e){B.AsyncUtil.failed(e,t,!1)||e.value.serviceScope.isStoreDisabled(t)})},e}(),B.OmexCatalog=W,B.CatalogFactory.register(l.StoreType.OMEX,function(e){if(e.allowExternalMarketplace&&e.osfOmexBaseUrl){var t,n=e.osfOmexBaseUrl.indexOf(l.Constants.ProtocolSeparator);t=n>=0?e.osfOmexBaseUrl.substr(n):l.Constants.ProtocolSeparator+e.osfOmexBaseUrl;var r=l.Constants.Https+t;return l.OUtil.getQueryStringParamValue(window.location.search,l.Constants.OmexForceAnonymousParamName).toLowerCase()==l.Constants.OmexForceAnonymousParamValue.toLowerCase()&&(e.omexForceAnonymous=H),new W({appName:e.appName,appUILocale:e.appUILocale,AppVersion:e.appVersion,clientMode:e.clientMode,docUrl:e.docUrl,omexBaseUrl:r,omexForceAnonymous:e.omexForceAnonymous})}return new B.ForbiddenCatalog({loaderParams:B.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR,errorCode:l.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED}),controlStatus:l.OsfControlStatus.ActivationFailed})}),G=ne||(ne={}),q=function(){function e(){}return e.anonymousCacheKeyPrefix="__OSF_ANONYMOUS_OMEX.",e.ungatedCacheKeyPrefix="__OSF_OMEX.",e.manifestRefreshRate=1825,e.hourToDayConversionFactor=24,e.anonymousAppInstallInfoCacheKey=e.anonymousCacheKeyPrefix+"appInstallInfo.{0}.{1}",e.firstPartyAddinListCacheKey=e.anonymousCacheKeyPrefix+"firstPartyAddInList",e.firstPartyManifestCacheKey=e.anonymousCacheKeyPrefix+"firstPartyManifest.{0}",e.killedAppsCacheKey="{0}killedApps",e.appStateCacheKey="{0}appState.{1}.{2}",e.appDetailKey="__OSF_OMEX.appDetails.{0}",e}(),G.CacheConsts=q,function(e){var t=function(){function t(e,t,n){this._handler=e,this._initParam=t,this._cacheManager=n.cacheManager,this._cachePrefix=n.cachePrefix,this._cid=n.cid,this._correlationId=n.telemetryContext.correlationId}return t.prototype.tryFail=function(t,n){return 200!=t&&(n({httpStatus:t,status:e.DataServiceResultCode.Failed}),!0)},t.prototype.getLastStoreUpdate=function(t){var n=this,r=this._initParam.appUILocale;this._handler.getLastStoreUpdate(r,this._correlationId,function(r,i){n.tryFail(r,t)?n.logServiceCallResponseError("laststoreupdate",r):t({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessLastStoreUpdate(i)})})},t.prototype.getEntitlementAsync=function(t,n,r,i){var a=this,o=l.OmexAppVersions[this._initParam.appName],s=l.OUtil.formatString(this._cachePrefix+e.WACUtils.CacheConstants.EntitlementsKey,o,this._cid);if(r)this._cacheManager.RemoveCacheItem(s);else{var c=this._cacheManager.GetCacheItem(s,!0,null,i);if(null!=c)return void n({status:e.DataServiceResultCode.Succeeded,value:c})}this._handler.getEntitlement(t,o,this._correlationId,function(t,r){if(a.tryFail(t,n))a.logServiceCallResponseError("entitlement",t);else{var i=e.OmexXmlProcessor.ProcessEntitlement(r);i.cid=a._cid,a._cacheManager.SetCacheItem(s,i,i.refreshRate2/e.CacheConsts.hourToDayConversionFactor),n({status:e.DataServiceResultCode.Succeeded,value:i})}})},t.prototype.getEToken=function(t,n,r){var i=this,a=n,o=t.storeId,s=t.assetId,c=t.appVersion;this._handler.getEToken(o,a,s,c,this._correlationId,function(t,n){i.tryFail(t,r)?i.logServiceCallResponseError("etoken",t):r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessClientAppInstallInfo(n,l.ClientAppInfoReturnType.etokenOnly)})})},t.prototype.getETokenAndManifest=function(t,n,r){var i=this;this.getEToken(t,n,function(a){a.status==e.DataServiceResultCode.Succeeded?i.getManifest(t,n,function(t){if(t.status!=e.DataServiceResultCode.Succeeded)return a.status=t.status,a.httpStatus=t.httpStatus,void r(a);a.value.manifest=t.value.manifest,r(a)}):r(a)})},t.prototype.getManifest=function(t,n,r){var i=n;this._handler.getManifest(i,t.assetId,this._correlationId,function(t,n){r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ConvertAnonymousManifest(t,n)})})},t.prototype.getAppState=function(t,n){var r=this,i=t.storeId+":"+t.assetId;this._handler.getAppState(i,this._correlationId,function(t,i){r.tryFail(t,n)?r.logServiceCallResponseError("appstate",t):n({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessAppState(i)})})},t.prototype.getKilledApps=function(t){var n=this;this._handler.getKilledApps(this._correlationId,function(r,i){n.tryFail(r,t)?n.logServiceCallResponseError("killedapps",r):t({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessKilledApps(i)})})},t.prototype.getAppDetails=function(t,n,r){var i=this;this._handler.getAppDetails(n,t.join(","),this._correlationId,function(t,n){i.tryFail(t,r)?i.logServiceCallResponseError("appdetails",t):r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessAppDetails(n)})})},t.prototype.removeApps=function(t,n){var r=this;this._handler.removeApps(t.join(","),this._correlationId,function(t,i){if(r.tryFail(t,n))r.logServiceCallResponseError("removeapps",t);else{var a=e.OmexXmlProcessor.ProcessRemoveAppResponse(i);a.removedApps.some(function(e){return e.result2==l.OmexRemoveAppStatus.Success})&&r.clearEntitlementCache(),n({status:e.DataServiceResultCode.Succeeded,value:a})}})},t.prototype.clearEntitlementCache=function(){var t=new RegExp(l.OUtil.formatString(e.WACUtils.CacheConstants.EntitlementsKey,".*",".*"),"i");this._cacheManager.RemoveMatches([t])},t.prototype.isStoreDisabled=function(t){var n=this;this._handler.isStoreDisabled(this._correlationId,function(r){if(200!=r&&403!=r&&401!=r)return n.logServiceCallResponseError("isStoreDisabled",r),void t({status:e.DataServiceResultCode.Failed,value:!1});t({status:e.DataServiceResultCode.Succeeded,value:401==r})})},t.prototype.logServiceCallResponseError=function(e,t){var n="s2s request "+e+" failed";t&&(n+=":"+t),m.RuntimeTelemetryHelper.LogExceptionTag(n,null,this._correlationId,18657699)},t}();e.OmexCatalogServiceS2SScope=t;var n=function(){function n(e){this._cid="",this._initParam=e}return n.initRequestHandler=function(e){null==n._requestHandler&&(n._requestHandler=e)},n.prototype.getCID=function(){return this._cid},n.prototype.initialize=function(t,r){var i=this;null!=n._requestHandler?this._initParam.omexForceAnonymous?r({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!0}}):n._requestHandler.getUserId(t,function(n,a){200==n?(i._cid=a.trim(),r({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!1}})):403==n?r({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!0}}):(m.RuntimeTelemetryHelper.LogExceptionTag("s2s getuserId request failed "+n,null,t,18657728),r({status:e.DataServiceResultCode.Failed,httpStatus:n}))}):r({status:e.DataServiceResultCode.Failed,httpStatus:404})},n.prototype.createScope=function(e){return new t(n._requestHandler,this._initParam,e)},n}();e.S2SOmexCatalogService=n}(ne||(ne={})),z=ne||(ne={}),X=function(){var e="assetId";function t(){}return t.ProcessLastStoreUpdate=function(e){var t=new l.XmlProcessor(e,g).getDocumentElement().selectSingleNode("o:update");return null!=t.firstChild?Date.parse(t.firstChild.nodeValue):null},t.ProcessAppState=function(n){var r={},i=new l.XmlProcessor(n,g),a=i.getDocumentElement();i.readAttributes(a,{rr:"refreshRate"},r);var o=i.selectSingleNode("o:results"),s=i.selectSingleNode("o:lang",o),c=i.selectSingleNode("o:asset",s);return i.readAttributes(c,{assetid:e,prodid:"productId",ver:"version",state:"state",tdurl:"takeDownUrl",upv:"unsafePreviousVersion",expiry:"expirationDate"},r),t.ConvertAppState(r)},t.ProcessFirstPartyAddInList=function(t){var n={addInList:{},refreshRate:null},r=new l.XmlProcessor(t,g),i=r.getDocumentElement(),a=r.selectSingleNode("o:Apps",i),o=a.getAttribute("d1p1:rr");n.refreshRate=o?parseInt(o):0;for(var s=r.selectNodes("o:App",a),c=0;c<s.length;c++){var u=s[c],d={assetId:null,path:null,version:null};r.readAttributes(u,{assetid:e},d);var p=r.selectSingleNode("o:Path",u);d.path=null!=p.text?p.text:null!=p.textContent?p.textContent:p.nodeTypedValue;var f=r.selectSingleNode("o:Version",u);d.version=null!=f.text?f.text:null!=f.textContent?f.textContent:f.nodeTypedValue,n.addInList[d.assetId]=d}return n},t.ConvertAppState=function(e){return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e.state2=e.state?parseInt(e.state):0,e.expirationDate2=t.GetTickByDate(e.expirationDate),e},t.ProcessEntitlement=function(n){var r={},i=new l.XmlProcessor(n,g),a=i.selectSingleNode("o:entitlementlist"),o=i.selectSingleNode("o:hdr",a);i.readAttributes(o,{pm:"billingMarket",pagesize:"pageSize",rr:"refreshRate"},r);for(var s,c,u=i.selectNodes("o:entitlement",i.selectSingleNode("o:entitlements",a)),d=[],p=0;p<u.length;++p)c={},s=u[p],i.readAttributes(s,{assetid:e,pid:"productId",ver:"version",appst:"appSubType",cm:"contentMarket",trlt:"licenseType",acqdate:"acquireDate",expiry2:"expirationDate",attreq:"attentionRequired"},c),d.push(c);return r.entitlements=d,t.ConvertEntitlementInfo(r)},t.ConvertEntitlementInfo=function(e){for(var n=e.entitlements,r=0;r<n.length;++r){var i=n[r];i.appSubType2=i.appSubType?parseInt(i.appSubType):0,i.acquireDate2=t.GetTickByDate(i.acquireDate),i.expirationDate2=t.GetTickByDate(i.expirationDate),i.attentionRequired2="true"===i.attentionRequired}return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e},t.ProcessKilledApps=function(n){var r={},i=new l.XmlProcessor(n,g),a=i.getDocumentElement();i.readAttributes(a,{rr:"refreshRate"},r);for(var o=[],s=i.selectSingleNode("o:assets"),c=i.selectNodes("o:asset",s),u=0;u<c.length;++u){var d=c[u],p={};i.readAttributes(d,{assetid:e,pid:"productId"},p),o.push({assetId:p.assetId,productId:p.productId})}return r.killedApps=o,t.ConvertKilledAppsInfo(r)},t.ConvertKilledAppsInfo=function(e){return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e},t.ProcessClientAppInstallInfo=function(n,r){var i=new l.XmlProcessor(n,g),a=i.selectSingleNode("o:assets"),o=i.selectSingleNode("o:asset",a),s={etoken:null,manifest:null};if(r===l.ClientAppInfoReturnType.urlOnly?i.readAttributes(o,{url:"url"},s):r===l.ClientAppInfoReturnType.etokenOnly?i.readAttributes(o,{etok:"etoken"},s):i.readAttributes(o,{url:"url",etok:"etoken"},s),i.readAttributes(o,{status:"status",cm:"contentMarket",assetid:e,ver:"version"},s),r!=l.ClientAppInfoReturnType.urlOnly&&s.etoken){var c=new l.XmlProcessor(s.etoken,""),u=c.selectSingleNode("t",c.selectSingleNode("r"));c.readAttributes(u,{te:"tokenExpirationDate",et:"entitlementType",cid:"cid"},s)}return t.ConvertClientAppInstallInfo(s)},t.ConvertClientAppInstallInfo=function(e){return e.status2=e.status?parseInt(e.status):0,e.tokenExpirationDate2=t.GetTickByDate(e.tokenExpirationDate),e},t.ProcessManifest=function(e){return{manifest:e}},t.ProcessRemoveAppResponse=function(n){var r={};r.removedApps=[];for(var i,a,o=new l.XmlProcessor(n,g),s=(o.getDocumentElement(),o.selectSingleNode("o:apps",o.selectSingleNode("o:removedApps"))),c=o.selectNodes("o:app",s),u=0;u<c.length;++u)i=c[u],a={},o.readAttributes(i,{assetid:e,result:"result"},a),r.removedApps.push(a);return t.ConvertRemoveAppResponse(r)},t.ConvertRemoveAppResponse=function(e){for(var t=e.removedApps,n=0;n<t.length;++n){var r=t[n];r.result2=r.result?parseInt(r.result):0}return e},t.ProcessAppDetails=function(n){for(var r,i,a=new l.XmlProcessor(n,g),o=a.selectSingleNode("o:results"),s=a.selectNodes("o:wainfo",o),c=[],u=0;u<s.length;++u)r=s[u],i={},a.readAttributes(r,{assetid:e,defhei:"defaultHeight",defwid:"defaultWidth",title:"name",prov:"provider",desc:"description",icon:"iconUrl",ver:"version",state:"state",appst:"appSubType",appvers:"appVersions",req:"requirements",hosts:"hosts",highresicon:"highResolutionIconUrl"},i),c.push(i);return t.ConvertAppDetails(c)},t.ConvertAppDetails=function(e){for(var t=0;t<e.length;++t){var n=e[t];n.defaultHeight2=n.defaultHeight?parseInt(n.defaultHeight):0,n.defaultWidth2=n.defaultWidth?parseInt(n.defaultWidth):0,n.state2=n.state?parseInt(n.state):0,n.appSubType2=n.appSubType?parseInt(n.appSubType):0}return e},t.ProcessRecommendations=function(t){for(var n,r,i,a=new l.XmlProcessor(t,g),o=a.selectSingleNode("o:results"),s=a.selectNodes("o:wa",o),c=[],u=0;u<s.length;++u)n=s[u],i={},a.readAttributes(n,{assetid:e,title:"name",desc:"description",icon:"iconUrl",ver:"version",state:"state",rat:"rating",dls:"downloads",prov:"provider"},i),r=a.selectSingleNode("o:price",n),a.readAttributes(r,{fop:"originalPrice",opt:"originalPriceTier",fpp:"promotionalPrice",ppt:"promotionalPriceTier",cmod:"priceModel"},i),c.push(i);return c},t.ConvertAnonymousManifest=function(e,t){var n,r="";switch(e){case 200:n=l.OmexClientAppStatus.OK,r=t;break;case 204:case 1223:n=l.OmexClientAppStatus.NoEntitlement;break;case 400:n=l.OmexClientAppStatus.BadRequest;break;case 410:n=l.OmexClientAppStatus.KilledAsset;break;case 404:n=l.OmexClientAppStatus.UnknownAssetId;break;case 412:n=l.OmexClientAppStatus.VersionNotSupported;break;case 451:n=l.OmexClientAppStatus.UserIsMinor;break;default:n=l.OmexClientAppStatus.ServerError}return{status2:n,manifest:r}},t.GetTickByDate=function(e){return e?new Date(e).getTime():null},t}(),z.OmexXmlProcessor=X,K=ne||(ne={}),J=function(){var e=null;function t(t,n,r,i){void 0===i&&(i=e),this._cacheManager=i||new K.AppsDataCacheManager(l.OUtil.getLocalStorage(),new K.SafeSerializer),this._privateCatalogService=new K.PrivateCatalogService(l.OmexClientNames[t],l.OUtil.normalizeAppVersion(n)),this._uiLocale=r}return t.prototype.getEntitlementAsync=function(e,n,r,i){n.startActivity(K.Activity.EntitlementCheck),i&&(this._cacheManager.RemoveAll(t._addInsCacheKey),this._cacheManager.RemoveCacheItem(t._lastCatalogUpdateKey)),this.GetAddInList(e,n,function(e){for(var i=[],a=0;a<e.length;a++){var o=e[a];o.addInState===t._addInOkState&&i.push(o)}n.stopActivity(K.Activity.EntitlementCheck),r({status:K.DataServiceResultCode.Succeeded,value:i})},function(e){r({status:e})})},t.prototype.getAppDetails=function(n,r,i,a,o){var s=this;o&&this._cacheManager.RemoveAll(t._addInDetailsCacheKeyPrefix);for(var l=[],c=[],u=0;u<n.length;u++){var d=t.GetAppDetailsCacheKey(n[u].ProductId),p=this._cacheManager.GetCacheItem(d);p?l.push(p):c.push(n[u])}0!==c.length?this._privateCatalogService.GetManifests(c,e,e,i,function(e){for(var n=0;n<e.length;n++){var r=s.ParseAndCacheManifest(e[n],i);if(r){var o=t.CreateAddInDetails(r);l.push(o);var c=t.GetAppDetailsCacheKey(o.assetId);s._cacheManager.SetCacheItem(c,o,t._addInDetailsRefreshRateDays)}}a({status:K.DataServiceResultCode.Succeeded,value:l})},function(e){a({status:e})}):a({status:K.DataServiceResultCode.Succeeded,value:l})},t.prototype.getAndCacheManifest=function(e,n,r,i){var a={ProductId:e.assetId,Version:e.appVersion,AddInState:t._addInOkState,StoreInfo:{AssetId:e.storeId,ContentMarket:n}};this.GetManifest(a,r,function(e){i({status:K.DataServiceResultCode.Succeeded,value:e})},function(e){i({status:e})})},t.prototype.activateAsync=function(n,r,i){var a=this;i.startActivity(K.Activity.Activation);var o=this;this.GetAddInList(!1,i,function(s){for(var c,u=0;u<s.length;u++){var d=s[u];if(n.assetId===d.assetId){c=d;break}}if(c)if(c.addInState===t._addInOkState){n.appVersion=c.appVersion;var p={ProductId:c.assetId,Version:c.appVersion,AddInState:t._addInOkState,StoreInfo:{AssetId:c.storeId,ContentMarket:""}};a.GetManifest(p,i,function(t){r.load({entitlement:n,manifest:t,eToken:""},e)},function(){K.LoaderUtil.failWithError(r,{description:Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message,url:"",errorCode:l.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){r.restartActivation(),o.activateAsync(n,r,i)}})})}else K.LoaderUtil.failWithError(r,{description:Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,url:"",errorCode:l.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED});else K.LoaderUtil.showWarning(r,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){r.restartActivation(),o._cacheManager.RemoveAll(t._addInsCacheKey),o._cacheManager.RemoveCacheItem(t._lastCatalogUpdateKey),o.activateAsync(n,r,i)},detailView:!0,retryAll:!0,errorCode:l.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})},function(){K.LoaderUtil.showWarning(r,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){r.restartActivation(),o._cacheManager.RemoveAll(t._addInsCacheKey),o._cacheManager.RemoveCacheItem(t._lastCatalogUpdateKey),o.activateAsync(n,r,i)},detailView:!0,retryAll:!0,errorCode:l.ErrorStatusCodes.WAC_AgaveActivationError}),i.stopActivity(K.Activity.Activation)})},t.prototype.removeAsync=function(e,t,n){n({status:K.DataServiceResultCode.Failed})},t.GetAppDetailsCacheKey=function(e){return t._addInDetailsCacheKeyPrefix+l.OUtil.formatString(t._addInDetailsCacheKeySufix,e)},t.GetManifestCacheKey=function(e,n){return t._manifestCacheKeyPrefix+l.OUtil.formatString(t._manifestCacheKeySufix,e,n)},t.CreateAddInDetails=function(e){return{assetId:e.getMarketplaceID(),defaultHeight2:e.getDefaultHeight()||0,defaultHeight:String(e.getDefaultHeight()||0),defaultWidth2:e.getDefaultWidth()||0,defaultWidth:String(e.getDefaultWidth()||0),name:e.getDefaultDisplayName(),provider:e.getProviderName(),description:e.getDefaultDescription(),iconUrl:e.getDefaultIconUrl(),version:e.getMarketplaceVersion(),state2:1,state:"1",appSubType2:e.getOmexTargetCode(),appSubType:String(e.getOmexTargetCode()),appVersions:void 0,requirements:e.getRequirementsXml(),hosts:e.getHostsXml(),highResolutionIconUrl:e.getDefaultHighResolutionIconUrl()}},t.prototype.GetAddInList=function(n,r,i,a){var o,s=this;n||!(o=this._cacheManager.GetCacheItem(t._addInsCacheKey))?this._privateCatalogService.GetAddInList(e,e,r,function(e){for(var n=0;n<e.length;n++){var r=e[n],a=t.GetAppDetailsCacheKey(r.assetId),o=s._cacheManager.GetCacheItem(a);o&&o.version!==r.appVersion&&s._cacheManager.RemoveCacheItem(a)}s._cacheManager.SetCacheItem(t._addInsCacheKey,e,t._addInListRefreshRateDays),i(e)},a):i(o)},t.prototype.GetManifest=function(n,r,i,a){var o=this;r.startActivity(K.Activity.ManifestRequest);var s=l.OsfManifestManager.getCachedManifest(n.ProductId,n.Version);if(s)return r.stopActivity(K.Activity.ManifestRequest),void i(s);var c=t.GetManifestCacheKey(n.ProductId,n.Version),u=this._cacheManager.GetCacheItem(c);if(u)return(s=new l.Manifest.Manifest(u,this._uiLocale))?(r.stopActivity(K.Activity.ManifestRequest),void i(s)):void a(K.DataServiceResultCode.Failed);this._privateCatalogService.GetManifests([n],e,e,r,function(e){(s=o.ParseAndCacheManifest(e[0],r))?(l.OsfManifestManager.cacheManifest(n.ProductId,n.Version,s),r.stopActivity(K.Activity.ManifestRequest),i(s)):a(K.DataServiceResultCode.Failed)},function(e){a(e)})},t.prototype.ParseAndCacheManifest=function(n,r){try{var i=new l.Manifest.Manifest(n,this._uiLocale),a=t.GetManifestCacheKey(i.getMarketplaceID(),i.getMarketplaceVersion());return this._cacheManager.SetCacheItem(a,n,t._addInManifestRefreshRateDays),i}catch(e){m.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest retrieved from Private Catalog.",e,r.correlationId,19965729)}return e},t._addInsCacheKey="__OSF_PRIVATECATALOG_ADDINS",t._addInDetailsCacheKeyPrefix="__OSF_PRIVATECATALOG_ADDINDETAILS",t._addInDetailsCacheKeySufix="_{0}",t._manifestCacheKeyPrefix="__OSF_PRIVATECATALOG_MANIFEST",t._manifestCacheKeySufix="_{0}_{1}",t._lastCatalogUpdateKey="_OSF_PRIVATECATALOG_LASTUPDATE",t._addInListRefreshRateDays=1/24,t._addInDetailsRefreshRateDays=365,t._addInManifestRefreshRateDays=365,t._addInOkState="Ok",t}(),K.PrivateCatalog=J,K.CatalogFactory.register(l.StoreType.PrivateCatalog,function(e){return new J(e.appName,e.appVersion,e.appUILocale)}),Q=ne||(ne={}),Y=function(){function e(e,t){this._clientCode=e,this._clientVersion=t}return e.initRequestHandler=function(t,n,r){null==e._requestHandler&&(e._requestHandler=t),null==e.authenticationProxy&&(e.authenticationProxy=n),e._isThirdPartyHostEnabled=r,e._tokenCacheManager=new Q.TokenCacheManager(l.OUtil.getLocalStorage(),new Q.SafeSerializer),e._cacheManager=new Q.AppsDataCacheManager(l.OUtil.getLocalStorage(),new Q.SafeSerializer)},e.ParseAddInList=function(t,n){var r,i=[];try{r=JSON.parse(t)}catch(e){return m.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetAddIns reponse.",e,n.correlationId,19965730),null}if(!r||!r.AddIns)return m.RuntimeTelemetryHelper.LogCommonMessageTag("GetPrivateCatalogAddIns response could not be parsed.",n.correlationId,20194262),i;for(var a=0,o=r.AddIns;a<o.length;a++){var s=o[a];s.AddInState&&s.ProductId&&s.Version?(i.push({assetId:s.ProductId,storeId:s.StoreInfo?s.StoreInfo.AssetId:"none",appVersion:s.Version,storeType:l.StoreType.PrivateCatalog,targetType:l.OsfControlTarget.Undefined,addInState:s.AddInState,contentMarket:s.StoreInfo?s.StoreInfo.ContentMarket:""}),e.StoreAuthenticationData(r)):m.RuntimeTelemetryHelper.LogCommonMessageTag(l.OUtil.formatString('Add-In metadata was missing some data. ID: "{0}", Version: "{1}", State: "{2}".',s.ProductId||"",s.Version||"",s.AddInState||""),n.correlationId,20194263)}return i},e.ParseAndCacheManifestList=function(t,n){var r,i=[];try{r=JSON.parse(t)}catch(e){return m.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetManifests reponse.",e,n.correlationId,19965731),null}if(!r||!r.Manifests)return m.RuntimeTelemetryHelper.LogCommonMessageTag("GetAddInManifests response could not be parsed.",n.correlationId,20194264),i;for(var a=0,o=r.Manifests;a<o.length;a++){var s=o[a];i.push(s)}return e.StoreAuthenticationData(r),i},e.StoreAuthenticationData=function(t){e._tokenCacheManager.AddRefreshToken(t.RefreshToken,t.UserId,t.TenantId),e._userId=t.UserId,e._tenantId=t.TenantId},e.prototype.GetLastPrivateCatalogUpdate=function(t,n,r,i,a){var o=this,s=0;e._requestHandler.getLastPrivateCatalogUpdate(this._clientCode,this._clientVersion,t,n,r.correlationId,function(l,c){if(s++,200===l){var u;try{u=JSON.parse(c)}catch(e){return m.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetLastPrivateCatalogUpdate reponse.",e,r.correlationId,22823177),void a(Q.DataServiceResultCode.Failed)}return u&&u.LastUpdate?(e.StoreAuthenticationData(u),void i(u.LastUpdate)):(m.RuntimeTelemetryHelper.LogCommonMessageTag("GetLastPrivateCatalogUpdate response could not be parsed.",r.correlationId,22823178),void a(Q.DataServiceResultCode.Failed))}if(403===l){var d;if(1==s)if(s++,d=JSON.parse(c)){var p=e._tokenCacheManager.GetRefreshToken(d.UserId,d.TenantId);if(null!=p)return void o.GetLastPrivateCatalogUpdate(t,p,r,i,a)}if(s>2||null!=t)return m.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetLastPrivateCatalogUpdate authentication loop occured.",null,r.correlationId,22823179),void a(Q.DataServiceResultCode.Unauthenticated);var f=!0;return setTimeout(function(){e.authenticationProxy.tryAuthorize(function(e){f&&(f=!1,o.GetLastPrivateCatalogUpdate(e,n,r,i,a))},function(){f&&(f=!1,a(Q.DataServiceResultCode.Unauthenticated))})},0),void setTimeout(function(){f&&(f=!1,a(Q.DataServiceResultCode.Unauthenticated))},5e3)}m.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetLastPrivateCatalogUpdate request failed with status code "+l,null,r.correlationId,22823180),a(Q.DataServiceResultCode.Failed)})},e.prototype.GetAddInList=function(t,n,r,i,a){var o=this,s=0;e._requestHandler.getPrivateCatalogAddIns(this._clientCode,this._clientVersion,t,n,r.correlationId,function(l,c){if(s++,200===l){var u=e.ParseAddInList(c,r);return u?void i(u):void a(Q.DataServiceResultCode.Failed)}if(403===l){var d;if(1==s)if(s++,d=JSON.parse(c)){var p=e._tokenCacheManager.GetRefreshToken(d.UserId,d.TenantId);if(null!=p)return void o.GetAddInList(t,p,r,i,a)}if(s>2||null!=t)return m.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetAddInList authentication loop occured.",null,r.correlationId,20497158),void a(Q.DataServiceResultCode.Unauthenticated);var f=!0;return setTimeout(function(){e.authenticationProxy.tryAuthorize(function(e){f&&(f=!1,o.GetAddInList(e,n,r,i,a))},function(){f&&(f=!1,a(Q.DataServiceResultCode.Failed))})},0),void setTimeout(function(){if(f){f=!1;var t=e._isThirdPartyHostEnabled?Q.DataServiceResultCode.Unauthenticated:Q.DataServiceResultCode.Failed;a(t)}},5e3)}m.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetAddInList request failed with status code "+l,null,r.correlationId,20497159),a(Q.DataServiceResultCode.Failed)})},e.prototype.GetManifests=function(t,n,r,i,a,o){var s=this,l=0,c={AddIns:t,RefreshToken:r,UserId:"",TenantId:""};e._requestHandler.getPrivateCatalogManifests(Q.WACUtils.serializeObjectToString(c),n,r,i.correlationId,function(c,u){if(l++,200===c){var d=e.ParseAndCacheManifestList(u,i);return d?void a(d):void o(Q.DataServiceResultCode.Failed)}if(403===c){var p;if(1==l)if(l++,p=JSON.parse(u)){var f=e._tokenCacheManager.GetRefreshToken(p.UserId,p.TenantId);if(null!=f)return void s.GetManifests(t,n,f,i,a,o)}return l>2?(m.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetManifests authentication loop occured.",null,i.correlationId,20497160),void o(Q.DataServiceResultCode.Unauthenticated)):void e.authenticationProxy.tryAuthorize(function(e){s.GetManifests(t,e,r,i,a,o)},function(){o(Q.DataServiceResultCode.Unauthenticated)})}m.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetManifests request failed with status code "+c,null,i.correlationId,20497161),o(Q.DataServiceResultCode.Failed)})},e.SignOutUser=function(){m.RuntimeTelemetryHelper.LogCommonMessageTag(l.OUtil.formatString("PrivateCatalogService.SignOutUser: userId = {0}, tenantId = {1}",e._userId,e._tenantId),null,21616005),e._tokenCacheManager.RemoveRefreshToken(e._userId,e._tenantId),e.authenticationProxy.signOut(function(){e._cacheManager.RemoveAll(Q.PrivateCatalog._addInsCacheKey),e._cacheManager.RemoveAll(Q.PrivateCatalog._addInDetailsCacheKeyPrefix)},function(){m.RuntimeTelemetryHelper.LogCommonMessageTag("Private Catalog: Failed to sign out ",null,22316866)})},e}(),Q.PrivateCatalogService=Y,Z=ne||(ne={}),$=null,ee=function(){function e(e,t){this._initParam=t,this._cacheManager=e.cacheManager,this._telemetryContext=e.telemetryContext}return e.prototype.getManifest=function(e,t,n,r){var i=this;this._telemetryContext.startActivity(Z.Activity.ManifestRequest);var a=l.OsfManifestManager.getCachedManifest(t.OfficeExtensionID,t.OfficeExtensionVersion);if(a)return this._telemetryContext.stopActivity(Z.Activity.ManifestRequest),this._telemetryContext.stopActivity(Z.Activity.ServerCall),void n({status:Z.DataServiceResultCode.Succeeded,value:{manifest:a,cached:!0}});t.EncodedAbsUrl?e.getManifest(t.EncodedAbsUrl,t.OfficeExtensionID,t.OfficeExtensionVersion,function(e){if(i._telemetryContext.stopActivity(Z.Activity.ManifestRequest),i._telemetryContext.stopActivity(Z.Activity.ServerCall),e.status==Z.DataServiceResultCode.Succeeded){var t=Z.ManifestUtil.ParseManifest(e.value.manifest,i._initParam.appUILocale,i._telemetryContext.correlationId);t==$&&(e.status=Z.DataServiceResultCode.Failed),n({status:e.status,value:{manifest:t,cached:!1}})}else n({status:e.status,value:{manifest:$,cached:!1}})},r):n({status:Z.DataServiceResultCode.Failed,value:{manifest:$,cached:!1}})},e.prototype.activate=function(e,t,n){var r,i=this,a={assetId:t.assetId,appVersion:t.appVersion,storeId:t.storeId,storeType:t.storeType,targetType:t.targetType},o=function(c){i.getManifest(e,r,function(e){e.status===Z.DataServiceResultCode.Succeeded&&e.value.manifest?function(e,r){var o=e.manifest,c=o.getMarketplaceVersion();if(l.OsfManifestManager.cacheManifest(t.assetId,t.appVersion,o),e.cached&&Z.ManifestUtil.versionLessThan(c,t.appVersion))s(!0);else{var u;if(!1===o.requirementsSupported||void 0===o.requirementsSupported&&!n.getRequirementsChecker().isManifestSupported(o))return o.requirementsSupported=!1,u=Strings.OsfRuntime.L_AgaveManifestRequirementsError_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,void Z.LoaderUtil.failWithError(n,{description:u,detailView:!0,errorCode:l.ErrorStatusCodes.WAC_AgaveRequirementsError});if(o.requirementsSupported=!0,r&&!n.skipTrust(t)){var d=l.OUtil.formatString(l.Constants.ActivatedCacheKey,t.assetId.toLowerCase(),t.storeType,t.storeId);if(!i._cacheManager.GetCacheItem(d,!1)&&!n.hasConsent(t))return void n.askForTrust({anonymous:$,entitlement:a,displayName:o.getDefaultDisplayName(),providerName:o.getProviderName(),isSSOAddin:o.isSSOAddin()},function(){i._cacheManager.SetCacheItem(d,!0),n.load({entitlement:a,manifest:o,eToken:$},$)})}n.hasConsent(t)&&i._cacheManager.SetCacheItem(d,!0),n.load({entitlement:a,manifest:o,eToken:$},$)}}(e.value,!0):Z.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),o(c)},errorCode:l.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE})},c)},s=function(c){r=$,i._telemetryContext.startActivity(Z.Activity.EntitlementCheck),e.getEntitlementAsync(!1,t.targetType,function(e){if(e.status==Z.DataServiceResultCode.Succeeded){i._telemetryContext.stopActivity(Z.Activity.EntitlementCheck);for(var t,u=$,d=e.value.entitlements,p=0;p<d.length;p++)(t=d[p]).OfficeExtensionID&&a.assetId&&t.OfficeExtensionID.toLowerCase()==a.assetId.toLowerCase()&&(u&&!Z.ManifestUtil.versionLessThan(u.OfficeExtensionVersion,t.OfficeExtensionVersion)||(u=t));var f;f=c,(r=u)?r.OfficeExtensionKillbit?Z.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,errorCode:l.ErrorStatusCodes.E_OEM_EXTENSION_KILLED}):o(f):Z.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),i._telemetryContext.startActivity(Z.Activity.Activation),i._telemetryContext.startActivity(Z.Activity.ServerCall),s(!0)},errorCode:l.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST})}else Z.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),i._telemetryContext.startActivity(Z.Activity.Activation),i._telemetryContext.startActivity(Z.Activity.ServerCall),s()},errorCode:l.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE})},c)};s()},e}(),te=function(){function e(e,t){void 0===t&&(t=$),this._appDataService={},this._catalogUrlDataService={},this._initParam=e,this._cacheManager=t||new Z.AppsDataCacheManager(l.OUtil.getLocalStorage(),new Z.SafeSerializer)}return e.prototype.getDataService=function(e,t,n){this.getDataServiceInternal(this._appDataService,e,t,n)},e.prototype.getCatalogUrlDataService=function(e,t,n){this.getDataServiceInternal(this._catalogUrlDataService,e,t,n)},e.prototype.getDataServiceInternal=function(e,t,n,r){if(e[t]==$&&(e[t]={spCatalogService:$,spCatalogServiceReady:$}),e[t].spCatalogService==$)if(e[t].spCatalogServiceReady==$){e[t].spCatalogServiceReady=r;var i={status:Z.DataServiceResultCode.Failed,value:$};n.startActivity(Z.Activity.Authentication);var a=Z.SPCatalogProxyBasedCatalogService.getInstance(this._initParam);a.prepareProxy(t,n.correlationId,function(r){var o,s,l;n.stopActivity(Z.Activity.Authentication),o=r,s=a,l=e[t].spCatalogServiceReady,e[t].spCatalogServiceReady=$,o.status==Z.DataServiceResultCode.Succeeded?(e[t].spCatalogService=s,i.value=s,i.status=Z.DataServiceResultCode.Succeeded,l(i)):(i.httpStatus=o.httpStatus,l(i))})}else{var o=e[t].spCatalogServiceReady;e[t].spCatalogServiceReady=function(e){o(e),r(e)}}else r({status:Z.DataServiceResultCode.Succeeded,value:e[t].spCatalogService})},e.prototype.createActivityScope=function(e,t,n){var r=this;this.getDataService(e,t,function(i){if(!Z.AsyncUtil.failed(i,n)){var a=i.value,o={cacheManager:r._cacheManager,storeId:e,telemetryContext:t},s=a.createScope(o),l=new ee(o,r._initParam);n({status:Z.DataServiceResultCode.Succeeded,value:{serviceScope:s,activityScope:l}})}})},e.prototype.getEntitlementAsync=function(e,t,n,r,i,a){var o=this,s=function(i){i.status===Z.DataServiceResultCode.Succeeded?(o.myOrgCatalogUrl=i.value,o.createActivityScope(i.value,t,function(t){Z.AsyncUtil.failed(t,n,[])||t.value.serviceScope.getEntitlementAsync(e,$,function(e){if(!Z.AsyncUtil.failed(e,n,[])){for(var t=e.value.entitlements,r=0;r<t.length;r++){var i=t[r];i.assetId=i.OfficeExtensionID,i.appVersion=i.OfficeExtensionVersion,i.storeId=o.myOrgCatalogUrl,i.storeType=l.StoreType.SPCatalog,i.targetType=l.OfficeAppType[i.OEType]}n({status:e.status,value:t})}},r)})):n({status:i.status,value:$})};(a=a||this.myOrgCatalogUrl||$)?s({status:Z.DataServiceResultCode.Succeeded,value:a}):this.getSPCatalogUrl(t,s)},e.prototype.getAndCacheManifest=function(e,t,n,r){var i=this;this.getEntitlementAsync(!0,n,function(t){if(l.OUtil.writeProfilerMark(l.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd),t.status===Z.DataServiceResultCode.Succeeded&&t.value){for(var a=t.value,o=a.length,s=$,c=0;c<o;c++){var u=a[c];u.OfficeExtensionID&&e.assetId&&u.OfficeExtensionID.toLowerCase()===e.assetId.toLowerCase()&&(s&&!l.OsfManifestManager.versionLessThan(s.OfficeExtensionVersion,u.OfficeExtensionVersion)||(s=u))}s!=$?i.createActivityScope(i.myOrgCatalogUrl,n,function(e){Z.AsyncUtil.failed(e,r)||e.value.activityScope.getManifest(e.value.serviceScope,s,function(e){r({status:e.status,value:e.value.manifest})})}):r({status:Z.DataServiceResultCode.Failed,value:$})}else r({status:Z.DataServiceResultCode.Failed,value:$})},!1,0,e.storeId)},e.prototype.activateAsync=function(e,t,n){var r=this;n.startActivity(Z.Activity.Activation),n.startActivity(Z.Activity.ServerCall),this.createActivityScope(e.storeId,n,function(i){if(i.status==Z.DataServiceResultCode.Succeeded){var a=i.value.serviceScope;i.value.activityScope.activate(a,e,t)}else Z.LoaderUtil.failWithError(t,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){t.restartActivation(),r.activateAsync(e,t,n)},errorCode:l.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError})})},e.prototype.removeAsync=function(e,t,n){n({status:Z.DataServiceResultCode.Failed})},e.prototype.getAppDetails=function(e,t,n,r){r({status:Z.DataServiceResultCode.Failed})},e.prototype.getSPCatalogUrl=function(e,t){var n=this;this.getCatalogUrlDataService(this._initParam.spBaseUrl,e,function(){Z.SPCatalogProxyBasedCatalogService.getInstance(n._initParam).getSPCatalogUrl(n._initParam.spBaseUrl,e.correlationId,t)})},e}(),Z.CatalogFactory.register(l.StoreType.SPCatalog,function(e){return new te({applicationName:l.HostCapability[e.hostType],AppVersion:e.appVersion,clientMode:e.clientMode,appUILocale:e.appUILocale,spBaseUrl:e.spBaseUrl,docUrl:e.docUrl})}),function(e){var t=function(){function e(){}return e.CheckProxyIsReady="OEM_isProxyReady",e.GetEntitlementSummary="OEM_getEntitlementSummaryAsync",e.GetManifest="OEM_getManifestAsync",e.GetSPCatalogUrl="OEM_getSPCatalogUrlAsync",e}();e.SPCatalogProxyMethods=t;var n=function(){function e(){this.iframeProxies={},this.iframeProxyCount=0}return e.iframeNamePrefix="__officeExtensionProxy",e}();e.IframeProxyGroup=n;var r=function(r){function i(e,t){r.call(this),this.proxyUrl=e,this.iframeProxyGroup=t}return h(i,r),i.prototype.getEntitlementsAsync=function(e,n){this.invokeProxyCommandAsync(t.GetEntitlementSummary,e,n)},i.prototype.getManifestAsync=function(e,n){this.invokeProxyCommandAsync(t.GetManifest,e,n)},i.prototype.getSPCatalogUrlAsync=function(e,n){this.invokeProxyCommandAsync(t.GetSPCatalogUrl,e,n)},i.prototype.prepareProxy=function(e,t){this.isReady?e({status:null,value:{clientEndpoint:this.clientEndPoint}}):this.clientEndPoint?this.pendingCallbacks.push([e,t]):this.createProxy(e,t)},i.resetProxy=function(e){delete e.iframeProxyGroup.iframeProxies[e.proxyUrl],e.iframeProxyGroup.iframeProxyCount=e.iframeProxyGroup.iframeProxyCount-1,Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(e.conversationId)&&Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(e.conversationId),e.iframe&&(l.OUtil.removeEventListener(e.iframe,"load",e.iframeOnload),e.iframe.parentNode.removeChild(e.iframe),e.iframe=null),e.clientEndPoint=null},i.prototype.createProxy=function(r,a){try{if(!this.doesUrlHaveSupportedProtocol(this.proxyUrl))return void a({status:null,value:{errorMessage:"Protocal of proxyUrl is not supported."}});this.iframeProxyGroup.iframeProxies[this.proxyUrl]=this,this.iframeProxyGroup.iframeProxyCount=this.iframeProxyGroup.iframeProxyCount+1;var o=this.proxyUrl,s=o.length;"/"===o.charAt(s-1)&&(o=o.substr(0,s-1));var c=document.createElement("iframe"),u=n.iframeNamePrefix+this.iframeProxyGroup.iframeProxyCount;c.setAttribute("id",u),c.setAttribute("name",u);var d=o+"/_layouts/15/OfficeExtensionManager.aspx?"+this.conversationId;d=l.OUtil.addXdmInfoAsHash(d,this.conversationId+"|"+u+"|"+window.location.href),d=l.OUtil.addSerializerVersionAsHash(d,l.SerializerVersion.Browser),c.setAttribute("scrolling","auto"),c.setAttribute("border","0"),c.setAttribute("width","0"),c.setAttribute("height","0"),c.setAttribute("style","position: absolute; left: -100px; top:0px;");var p=this;document.body.appendChild(c);var f=function(){if(p.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(p.conversationId,c.contentWindow,p.proxyUrl),p.clientEndPoint)p.clientEndPoint.invoke(t.CheckProxyIsReady,function(e,t){var n=null;0===e&&t.status?(p.isReady=!0,n={status:null,value:{clientEndpoint:p.clientEndPoint}}):(i.resetProxy(p),n={status:null,value:{errorMessage:"isProxyReadyCallback failed, error code "+e}});for(var r=p.pendingCallbacks.length,a=0;a<r;a++){var o=p.pendingCallbacks.shift();p.isReady?o[0](n):o[1](n)}},{__timeout__:2e3});else{var e="Unexpected error, iframe loaded again after failing OEM_isProxyReady";m.RuntimeTelemetryHelper.LogExceptionTag(e,null,null,18657365),a({status:null,value:{errorMessage:e}})}};l.OUtil.addEventListener(c,"load",f),c.setAttribute("src",d),this.iframeOnload=f,this.pendingCallbacks.push([r,a]),this.iframe=c}catch(t){var h="Error creating client endpoint with proxyUrl = ["+this.proxyUrl+"], msg:"+e.WACUtils.serializeObjectToString(t);a({status:null,value:{errorMessage:h}})}},i}(e.ProxyBase);e.SPCatalogProxy=r}(ne||(ne={})),function(e){var t=function(){function t(t){this.proxyRetries={},this.initParams=t,this.iframeProxyGroup=new e.IframeProxyGroup}return t.getInstance=function(e){return null==t._instance&&(t._instance=new t(e)),t._instance},t.prototype.prepareProxy=function(t,n,r){n=n||"";this.proxyRetries[t]=1,this.ensureSPCatalogProxySetUp(t,n,function(t){t&&null!=t.status?t.status:e.DataServiceResultCode.ProxyNotReady;r({status:t.status})})},t.prototype.createScope=function(e){return new n(e,this)},t.prototype.getSPCatalogUrl=function(t,n,r){var i=this;this.prepareProxy(t,n,function(){var a;if(t&&(a=i.iframeProxyGroup.iframeProxies[t])){var o={};o.webUrl=t,a.getSPCatalogUrlAsync(o,function(t){var i="getspcatalogurl failed";t.status!==e.DataServiceResultCode.Succeeded&&(m.RuntimeTelemetryHelper.LogExceptionTag(i,null,n,19015125),s.msAjaxDebug.trace(i)),r(t)})}else m.RuntimeTelemetryHelper.LogExceptionTag(l.OUtil.formatString("getspcatalogurl proxy not found, webUrl: {0}",t),null,n,19969545),r({status:e.DataServiceResultCode.ProxyNotReady})})},t.prototype.ensureSPCatalogProxySetUp=function(t,n,r){if(!t)return m.RuntimeTelemetryHelper.LogExceptionTag("proxyUrl is null",null,n,19969546),void r({status:e.DataServiceResultCode.Failed});var i=this.iframeProxyGroup.iframeProxies[t];if(i||(i=new e.SPCatalogProxy(t,this.iframeProxyGroup)),i.isReady)r({status:e.DataServiceResultCode.Succeeded});else{var a=this,o=function(){r({status:e.DataServiceResultCode.Succeeded})},s=function(){a.proxyRetries[t]<l.Constants.AuthenticatedConnectMaxTries?(a.proxyRetries[t]++,i.prepareProxy(o,s)):(m.RuntimeTelemetryHelper.LogExceptionTag("sp exceed maximum tries and fail",null,n,18940555),r({status:e.DataServiceResultCode.ProxyNotReady}))};i.prepareProxy(o,s)}},t}();e.SPCatalogProxyBasedCatalogService=t;var n=function(){function t(e,t){this._catalogService=t,this.proxyUrl=e.storeId,this._correlationId=e.telemetryContext.correlationId||""}return t.prototype.tryFail=function(t,n,r){return t!=e.DataServiceResultCode.Succeeded&&(r({status:t}),!0)},t.prototype.getEntitlementAsync=function(e,t,n,r){var i=this,a=this._catalogService.iframeProxyGroup.iframeProxies[this.proxyUrl],o={};o.webUrl=this.proxyUrl,o.applicationName=this._catalogService.initParams.applicationName,o.officeExtentionTarget=t,o.clearCache=r||!1,o.supportedManifestVersions={"1.0":!0,1.1:!0},a.getEntitlementsAsync(o,function(e){i.tryFail(e.status,e.httpStatus,n)?i.logServiceCallResponseError("entitlement",e.httpStatus):n(e)})},t.prototype.getLastStoreUpdate=function(){},t.prototype.getManifest=function(e,t,n,r,i){var a=this,o=this._catalogService.iframeProxyGroup.iframeProxies[this.proxyUrl],s={};s.manifestUrl=e,s.id=t,s.version=n,s.clearCache=i,o.getManifestAsync(s,function(e){a.tryFail(e.status,e.httpStatus,r)?a.logServiceCallResponseError("manifest",e.httpStatus):r(e)})},t.prototype.logServiceCallResponseError=function(e,t){var n="spproxy request "+e+" failed";t&&(n+=":"+t),m.RuntimeTelemetryHelper.LogExceptionTag(n,null,this._correlationId,18940556)},t}();e.SPCatalogProxyBasedCatalogServiceScope=n}(ne||(ne={})),l.InfoType={Error:0,Warning:1,Information:2,SecurityInfo:3},l.NotificationType={TrustYellowBar:0,ConsentYellowBar:1,ConsentWhiteDialog:2},l.ConsentResultCode={Success:0,Cancelled:100,ClientError:400,ServerError:500,UnknownError:600},l.OmexMessageType={ConsentResult:0,TabExit:1,ButtonClick:2,PageLoad:3},l._ErrorUXHelper=function(e){var t="moe-infobar-button2_",n="moe-infobar-button_",r="moe-infobar-button",i="button",a="moe-infobar-dismiss_",o="moe-infobar-dismiss",s="moe-infobar-message",c="moe-infobar-message_",u="moe-infobar-message-div",d="moe-infobar-secinfo",p="moe-infobar-warning",f="moe-infobar-button-cell",h="moe-infobar-top-right-cell",g="moe-infobar-message-cell",v="moe-infobar-top-left-cell",y="presentation",_="moe-infobar-infotable",C="no-repeat",S="alpha(opacity=100)",A="tabindex",b="moe-background",I="class",O="notificationbackground_",x="moe-infobar-body_",E="agavedefaulticon96x96.png",T="moe_status_icons.png",M=e,k=M.getOsfOmexBaseUrl(),P="omexNotificationIframeClassName";l.OUtil.loadCSS(M.getLocalizedCSSFilePath("moeerrorux.css")),document.createElement("img").src=M.getLocalizedImageFilePath("progress.gif"),document.createElement("img").src=M.getLocalizedImageFilePath(T),document.createElement("img").src=M.getLocalizedImageFilePath(E);var N={},R=0,D=function(e){for(var t,n=e.childNodes.length,r=0;r<n;)"iframe"===(t=e.childNodes.item(r)).tagName.toLowerCase()?r++:(e.removeChild(t),n--)},w=function(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)},F=function(e,t){var n;l.OUtil.writeProfilerMark(l.NotificationUxPerfMarker.RemoveStage2Start),n=t?x+e:O+e;var r=N[e]&&N[e].length>0;r&&N[e][0].highPriority&&R--,w(n),r&&N[e].shift(),l.OUtil.writeProfilerMark(l.NotificationUxPerfMarker.RemoveStage2End)},U=function(e){l.OUtil.writeProfilerMark(l.NotificationUxPerfMarker.RenderStage1Start),D(e.div);var t=document.createElement("div");t.setAttribute(I,b),t.setAttribute("id","icon_"+e.id);var n=document.createElement("input");n.setAttribute("id","iconImg_"+e.id),n.setAttribute("type","image"),n.setAttribute(A,"0"),n.src=M.getLocalizedImageFilePath(T);var r,i,a;n.setAttribute("onclick","getIntoStage2(params)"),l.OUtil.attachClickHandler(n,function(){!function(e){e.sqmDWords[1]|=2,X(e.id);var t=ne.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();t&&t.enableSingleSignOnForAddin?B(e):L(e)}(e)}),t.appendChild(n),e.displayDeactive&&(t.style.backgroundImage="url("+M.getLocalizedImageFilePath(E)+")",t.style.backgroundColor="white",t.style.opacity="1",t.style.filter=S,t.style.backgroundRepeat=C,t.style.backgroundPosition="center",t.style.height="100%"),e.infoType===l.InfoType.Error?(r="moe-status-error-icon",i="iconImg_error_"+e.id,a=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===l.InfoType.Warning?(r="moe-status-warning-icon",i="iconImg_warning_"+e.id,a=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===l.InfoType.Information?(r="moe-status-info-icon",i="iconImg_info_"+e.id,a=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(r="moe-status-secinfo-icon",i="iconImg_secinfo_"+e.id,a=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)&&9==parseFloat(RegExp.$1)&&(r+="_ie"),n.setAttribute(I,r),n.setAttribute("id",i),n.setAttribute("alt",a),0!=e.div.childNodes.length?e.div.insertBefore(t,e.div.childNodes[0]):e.div.appendChild(t),J(e.id,l.AgaveHostAction.TabIn),l.OUtil.writeProfilerMark(l.NotificationUxPerfMarker.RenderStage1End)},L=function(e){l.OUtil.writeProfilerMark(l.NotificationUxPerfMarker.RenderStage2Start),D(e.div);var k=e.description;e.title.length>100&&(e.title=e.title.substring(0,99)),e.description.length>255&&(e.description=e.description.substring(0,254));var P=x+e.id,R=document.getElementById(P);void 0==R&&((R=document.createElement("div")).setAttribute(I,"moe-infobar-body"),R.setAttribute("id",P));var w=document.createElement("div");w.innerHTML=k,R.setAttribute("title",w.textContent),w=null;var U=document.createElement("table");U.setAttribute(I,_),U.setAttribute("role",y);for(var L=0;L<3;L++)U.insertRow(L).setAttribute("role",y);var B=U.rows;B[0].insertCell(0),B[0].insertCell(1),B[0].insertCell(2),B[0].cells[1].setAttribute("rowSpan","2"),B[1].insertCell(0),B[1].insertCell(1),B[2].insertCell(0),B[2].insertCell(1),B[2].insertCell(2),B[0].cells[0].setAttribute(I,v),B[0].cells[1].setAttribute(I,g),B[0].cells[2].setAttribute(I,h),B[2].cells[1].setAttribute(I,f);var j,H,V=document.createElement("img");V.src=M.getLocalizedImageFilePath(T),e.infoType===l.InfoType.Error?(j="moe-infobar-error",H=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===l.InfoType.Warning?(j=p,H=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===l.InfoType.Information?(j="moe-infobar-info",H=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(j=d,H=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),V.setAttribute(I,j),V.setAttribute("alt",H),B[0].cells[0].appendChild(V);var W=document.createElement("a");W.setAttribute(I,u),W.setAttribute(A,"1");var G=document.createElement("span");G.setAttribute(I,"moe-infobar-title"),G.innerHTML=e.title;var q=c+e.id,z=document.getElementById(q);void 0==z&&((z=document.createElement("span")).setAttribute(I,s),z.setAttribute("id",q)),z.innerHTML=e.description,W.appendChild(G),W.appendChild(z),B[0].cells[1].appendChild(W);var Y=function(e){var t=M.getOsfControl(e.id);m.AppNotificationHelper.LogNotification(t._appCorrelationId,e.sqmDWords[0],e.sqmDWords[1])},Z=function(){if(e.sqmDWords[1]|=8,Y(e),!e.reDisplay&&F(e.id,e.displayDeactive),X(e.id),e.reDisplay)Q(e);else if(N[e.id].length>0){var t=N[e.id][0];Q(t)}else K(e.id);e.dismissCallback&&e.dismissCallback()},$=document.createElement("input");$.setAttribute("type","image"),$.setAttribute("src",M.getLocalizedImageFilePath(T)),$.setAttribute(I,o),$.setAttribute("id",a+e.id),$.setAttribute(A,"0"),$.setAttribute("alt",Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT),$.setAttribute("role",i),$.setAttribute("onclick","handleDismiss();"),l.OUtil.attachClickHandler($,Z),B[0].cells[2].appendChild($),e.detailView=!1;var ee=document.createElement(i);if(ee.setAttribute(I,r),ee.innerHTML=e.buttonTxt,ee.setAttribute("id",n+e.id),ee.setAttribute(A,"1"),ee.setAttribute("type",i),e.buttonCallback){ee.setAttribute("onclick","handleButtonClick()"),l.OUtil.attachClickHandler(ee,function(){if(e.sqmDWords[1]|=4,Y(e),F(e.id,!1),X(e.id),N[e.id].length>0){var t=N[e.id][0];Q(t)}else K(e.id);if(!0===e.retryAll){var n=M.getOsfControl(e.id);n._retryActivate=null,M.retryAll(n._marketplaceID)}e.buttonCallback()})}else ee.setAttribute("onclick","handleDismiss()"),l.OUtil.attachClickHandler(ee,Z);if(B[2].cells[1].appendChild(ee),e.url){var te=document.createElement(i);te.setAttribute(I,r),te.innerHTML=e.urlButtonTxt?e.urlButtonTxt:Strings.OsfRuntime.L_MoreInfoButton_TXT,te.setAttribute("id",t+e.id),te.setAttribute("onclick","moreInfoButtonClick()"),l.OUtil.attachClickHandler(te,function(){e.sqmDWords[1]|=4,Y(e),e.sqmDWords[1]=1,window.open(e.url)}),te.setAttribute(A,"1"),te.setAttribute("type",i),B[2].cells[1].appendChild(te)}R.appendChild(U);var ne=document.createElement("div");ne.setAttribute(I,b),ne.setAttribute("id",O+e.id),e.displayDeactive&&(ne.style.backgroundImage="url("+M.getLocalizedImageFilePath(E)+")",ne.style.backgroundColor="white",ne.style.opacity="1",ne.style.filter=S,ne.style.backgroundRepeat=C,ne.style.backgroundPosition="center",ne.style.height="100%"),ne.appendChild(R),0!=e.div.childNodes.length?e.div.insertBefore(ne,e.div.childNodes[0]):e.div.appendChild(ne),J(e.id,l.AgaveHostAction.TabIn),l.OUtil.writeProfilerMark(l.NotificationUxPerfMarker.RenderStage2End)},B=function(e){l.OUtil.writeProfilerMark(l.NotificationUxPerfMarker.RenderStage2Start);try{D(e.div);var t=e.description;e.title.length>100&&(e.title=e.title.substring(0,99)),e.description.length>255&&(e.description=e.description.substring(0,254));var n=x+e.id,r=document.getElementById(n);void 0==r&&((r=document.createElement("div")).className="moe-infobar-body",r.id=n),r.title=t,e.iframeNotificationUrl?r.appendChild(H(e,r)):r.appendChild(j(e));var i=document.createElement("div");i.className=b,i.id=O+e.id,e.displayDeactive&&(i.style.backgroundImage="url("+M.getLocalizedImageFilePath(E)+")",i.style.backgroundColor="white",i.style.opacity="1",i.style.filter=S,i.style.backgroundRepeat=C,i.style.backgroundPosition="center",i.style.height="100%"),i.appendChild(r),0!=e.div.childNodes.length?e.div.insertBefore(i,e.div.childNodes[0]):e.div.appendChild(i),J(e.id,l.AgaveHostAction.TabIn)}catch(e){m.RuntimeTelemetryHelper.LogExceptionTag("Failed to show infobar, error message: ",e,null,23455900)}l.OUtil.writeProfilerMark(l.NotificationUxPerfMarker.RenderStage2End)},j=function(e){var a=V(e),o=a.rows;o[0].cells[0].appendChild(W(e));var d=document.createElement("a");d.className=u,d.tabIndex=1;var p=document.createElement("span");p.className="moe-infobar-title",p.textContent=e.title;var f=c+e.id,m=document.getElementById(f);void 0==m&&((m=document.createElement("span")).className=s,m.id=f),m.textContent=e.description,d.appendChild(p),d.appendChild(m),o[0].cells[1].appendChild(d);var h=function(){q(e)},g=z(e);l.OUtil.attachClickHandler(g,h),o[0].cells[2].appendChild(g),e.detailView=!1;var v=document.createElement(i);if(v.className=r,v.textContent=e.buttonTxt,v.id=n+e.id,v.tabIndex=1,v.type=i,e.buttonCallback){l.OUtil.attachClickHandler(v,function(){if(e.sqmDWords[1]|=4,G(e),F(e.id,!1),X(e.id),N[e.id].length>0){var t=N[e.id][0];Q(t)}else K(e.id);if(!0===e.retryAll){var n=M.getOsfControl(e.id);n._retryActivate=null,M.retryAll(n._marketplaceID)}e.buttonCallback()})}else l.OUtil.attachClickHandler(v,h);if(o[2].cells[1].appendChild(v),e.url){var y=document.createElement(i);y.className=r,y.textContent=e.urlButtonTxt?e.urlButtonTxt:Strings.OsfRuntime.L_MoreInfoButton_TXT,y.id=t+e.id,l.OUtil.attachClickHandler(y,function(){e.sqmDWords[1]|=4,G(e),e.sqmDWords[1]=1,window.open(e.url)}),y.tabIndex=1,y.type=i,o[2].cells[1].appendChild(y)}return a},H=function(e,t){var n=V(e),r=n.rows,i=document.createElement("iframe");window.getComputedStyle(e.div,null);i.width="100%",i.frameBorder="0",i.className=P,i.src=e.iframeNotificationUrl,r[0].cells[1].appendChild(i);t.addEventListener("mouseenter",function(){l.OUtil.addClass(t,"moe-hovered"),i.contentWindow.postMessage(l.AgaveHostAction.MouseEnter,k)}),t.addEventListener("mouseleave",function(){l.OUtil.removeClass(t,"moe-hovered"),i.contentWindow.postMessage(l.AgaveHostAction.MouseLeave,k)}),e.detailView=!1;var a=null,o=z(e);return l.OUtil.attachClickHandler(o,function(){q(e),window.removeEventListener("message",a)}),r[0].cells[2].appendChild(o),o.addEventListener("keydown",function(e){9==e.keyCode&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),i.contentWindow.postMessage(l.AgaveHostAction.TabInShift,k))}),e.buttonCallback&&(a=function(t){try{if(t.source==i.contentWindow){var n=JSON.parse(t.data),r=parseInt(n[l.OmexMessageKeys.MessageType]),s=parseInt(n[l.OmexMessageKeys.MessageValue]);if(r==l.OmexMessageType.ConsentResult){if(F(e.id,!1),X(e.id),N[e.id].length>0){var c=N[e.id][0];Q(c)}else K(e.id);if(!0===e.retryAll&&(e.notificationType==l.NotificationType.TrustYellowBar||e.notificationType==l.NotificationType.ConsentYellowBar&&s==l.ConsentResultCode.Success)){var u=M.getOsfControl(e.id);u._retryActivate=null,M.retryAll(u._marketplaceID)}window.removeEventListener("message",a),e.buttonCallback(s)}else r==l.OmexMessageType.TabExit&&(s==l.AgaveHostAction.TabExitShift&&M._notifyHost?M._notifyHost(e.id,l.AgaveHostAction.TabExitShift):s==l.AgaveHostAction.TabExit&&(window.focus(),o.focus()))}}catch(e){m.RuntimeTelemetryHelper.LogExceptionTag("Exception in receivedMessageHandler: ",e,null,23455901)}},window.addEventListener("message",a)),n},V=function(e){var t=document.createElement("table");t.className=_,t.setAttribute("role",y);for(var n=e.iframeNotificationUrl?1:3,r=0;r<n;r++){t.insertRow(r).setAttribute("role",y)}var i=t.rows;return i[0].insertCell(0),i[0].insertCell(1),i[0].insertCell(2),i[0].cells[1].setAttribute("rowSpan","2"),i[0].cells[0].setAttribute(I,v),i[0].cells[1].setAttribute(I,g),i[0].cells[2].setAttribute(I,h),null==e.iframeNotificationUrl&&(i[1].insertCell(0),i[1].insertCell(1),i[2].insertCell(0),i[2].insertCell(1),i[2].insertCell(2),i[2].cells[1].setAttribute(I,f)),i[0].cells[0].appendChild(W(e)),t},W=function(e){var t,n,r=document.createElement("img");return r.src=M.getLocalizedImageFilePath(T),e.infoType===l.InfoType.Error?(t="moe-infobar-error",n=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===l.InfoType.Warning?(t=p,n=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===l.InfoType.Information?(t="moe-infobar-info",n=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(t=d,n=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),r.className=t,r.alt=n,r},G=function(e){var t=M.getOsfControl(e.id);m.AppNotificationHelper.LogNotification(t._appCorrelationId,e.sqmDWords[0],e.sqmDWords[1])},q=function(e){if(e.sqmDWords[1]|=8,G(e),!e.reDisplay&&F(e.id,e.displayDeactive),X(e.id),e.reDisplay)Q(e);else if(N[e.id].length>0){var t=N[e.id][0];Q(t)}else K(e.id);e.dismissCallback&&e.dismissCallback()},z=function(e){var t=document.createElement("input");return t.type="image",t.src=M.getLocalizedImageFilePath(T),t.className=o,t.id=a+e.id,t.tabIndex=0,t.alt=Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT,t.setAttribute("role",i),t},X=function(e){var t=M.getOsfControl(e);t&&(t._controlFocus=!0)},K=function(e){var t,n=M.getOsfControl(e);if(n&&!(N[e]&&N[e].length>0))if(n.getStatus()===l.OsfControlStatus.Activated&&n.getPageStatus()===l.OsfControlPageStatus.Ready)n.notifyAgave(l.AgaveHostAction.TabIn);else{var r="_trySetFocusInAppContent$newCallback";if(n._notifyHostIFrameOnLoaded&&n._notifyHostIFrameOnLoaded.newCallbackIdentity&&n._notifyHostIFrameOnLoaded.newCallbackIdentity===r)return;var i=(t=n._notifyHostIFrameOnLoaded,function(){if(t)try{t()}catch(e){}n.getStatus()===l.OsfControlStatus.Activated&&n.getPageStatus()===l.OsfControlPageStatus.Ready&&n.notifyAgave(l.AgaveHostAction.TabIn),n._notifyHostIFrameOnLoaded=t});i.newCallbackIdentity=r,n._notifyHostIFrameOnLoaded=i}},J=function(e,t){var n=M.getOsfControl(e);if(n&&n._controlFocus)if(N[e]&&N[e].length>0){var r=N[e][0];if(r&&r.div)if(null!=r.iframeNotificationUrl){var i=r.div.getElementsByClassName(P)[0];i&&(i.contentWindow.postMessage(l.AgaveHostAction.TabIn,k),M._notifyHost&&M._notifyHost(e,l.AgaveHostAction.SelectWithError))}else{var a=r.div.querySelectorAll("input,a,button");if(a&&a.length>0){var o=a[0];o instanceof HTMLElement&&(window.focus(),o.focus(),M._notifyHost&&M._notifyHost(e,l.AgaveHostAction.SelectWithError))}}}else n.notifyAgave(t)},Q=function(e){if(void 0==e.detailView||!1===e.detailView)e.sqmDWords[1]=0,U(e);else{e.sqmDWords[1]=1;var t=ne.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();t&&t.enableSingleSignOnForAddin?B(e):L(e)}};return{showProgress:function(e,t){try{if(l.OUtil.writeProfilerMark(l.NotificationUxPerfMarker.RenderLoadingAnimationStart),!document.getElementById("progress_"+t)){N[t]=[];var n=document.createElement("div");n.setAttribute(I,b),n.setAttribute("id","progress_"+t),n.style.backgroundColor="rgba(255, 255, 255, 0.5)",n.style.opacity="1",n.style.filter=S,n.style.height="100%";var r=document.createElement("div");r.style.width="100%",r.style.height="100%",r.style.backgroundImage="url("+M.getLocalizedImageFilePath("progress.gif")+")",r.style.backgroundRepeat=C,r.style.backgroundPosition="center",n.appendChild(r),e.appendChild(n)}l.OUtil.writeProfilerMark(l.NotificationUxPerfMarker.RenderLoadingAnimationEnd)}catch(e){}},showNotification:function(e){e.sqmDWords=[e.errorCode,0],delete e.errorCode,void 0==e.highPriority&&(e.highPriority=e.infoType===l.InfoType.Error),void 0==e.reDisplay&&(e.reDisplay=e.infoType===l.InfoType.Error);var t=N[e.id];void 0===t&&(t=[],N[e.id]=t),!1===e.highPriority?t.push(e):(t.splice(R,0,e),R++),(1===N[e.id].length||e.highPriority)&&Q(t[0])},showICon:function(e){U(e)},removeDOMElement:function(e){w(e)},removeProgressDiv:function(e,t){l.OUtil.writeProfilerMark(l.NotificationUxPerfMarker.RemoveLoadingAnimationStart),e.ownerDocument.getElementById("progress_"+t)&&D(e),l.OUtil.writeProfilerMark(l.NotificationUxPerfMarker.RemoveLoadingAnimationEnd)},removeIConDiv:function(e){var t;t=e,l.OUtil.writeProfilerMark(l.NotificationUxPerfMarker.RemoveStage1Start),w("icon_"+t),l.OUtil.writeProfilerMark(l.NotificationUxPerfMarker.RemoveStage1End)},removeInfoBarDiv:function(e,t){F(e,t)},dismissMessages:function(e){!function(e){if(N[e]){if(N[e].length>0){var t=N[e][0].div;D(t)}delete N[e]}}(e)},getHTMLEncodedString:function(e){return t=e,n=document.createElement("div"),r=document.createTextNode(t),n.appendChild(r),n.innerHTML;var t,n,r},purgeOsfControlNotification:function(e){var t=N[e],n=M.getOsfControl(e);t&&t.length>0&&n&&m.AppNotificationHelper.LogNotification(e,t[0].sqmDWords[0],t[0].sqmDWords[1])},focusOnNotificationUx:function(e,t){X(e),J(e,t)},focusOnNotificationUxShiftIn:function(e,t){X(e),function(e,t){var n=M.getOsfControl(e);if(n&&n._controlFocus)if(N[e]&&N[e].length>0){var r=N[e][0];if(r&&r.div){var i=r.div.querySelectorAll("input,a,button");if(i&&i.length>0){var a=i.length>1?i[1]:i[0];a instanceof HTMLElement&&(window.focus(),a.focus(),M._notifyHost&&M._notifyHost(e,l.AgaveHostAction.SelectWithError))}}}else n._controlFocus=!1,M._notifyHost(e,t)}(e,t)},appHasNotifications:function(e){return N[e]&&N[e].length>0}}},re=ne||(ne={}),ie=function(){function e(){}return e.setHostFeatureEnabledInfo=function(e){this._hostFeatureEnabledInfo=e},e.getHostFeatureEnabledInfo=function(){return this._hostFeatureEnabledInfo},e}(),re.HostFeatureEnabledInfo=ie,l.OUtil.setNamespace("AppSpecificSetup",l),l.ContextActivationManager=function(e){var t="osfControl for the given ID doesn't exist.";if(l.OUtil.validateParamObject(e,{appName:{type:Number,mayBeNull:!1},appVersion:{type:String,mayBeNull:!1},clientMode:{type:Number,mayBeNull:!1},appUILocale:{type:String,mayBeNull:!1},dataLocale:{type:String,mayBeNull:!1},osfOmexBaseUrl:{type:String,mayBeNull:!0},devCatalogUrl:{type:String,mayBeNull:!0},oneDriveCatalogBaseApiUrl:{type:String,mayBeNull:!0},spBaseUrl:{type:String,mayBeNull:!0},docUrl:{type:String,mayBeNull:!0},hostControl:{type:Object,mayBeNull:!0},pageBaseUrl:{type:String,mayBeNull:!0},lcid:{type:String,mayBeNull:!0},formFactor:{type:String,mayBeNull:!0},controlStatusChanged:{type:Object,mayBeNull:!0},notifyHost:{type:Object,mayBeNull:!0},allowExternalMarketplace:{type:Boolean,mayBeNull:!0},localizedScriptsUrl:{type:String,mayBeNull:!0},localizedImagesUrl:{type:String,mayBeNull:!0},localizedStylesUrl:{type:String,mayBeNull:!0},localizedResourcesUrl:{type:String,mayBeNull:!0},trustAgaves:{type:Boolean,mayBeNull:!0},enableAddinCommands:{type:Boolean,mayBeNull:!0},enableBlackForestRedirect:{type:Boolean,mayBeNull:!0},enableMyOrg:{type:Boolean,mayBeNull:!0},enableMyApps:{type:Boolean,mayBeNull:!0},enableDevCatalog:{type:Boolean,mayBeNull:!0},enableOneDriveCatalog:{type:Boolean,mayBeNull:!0},enablePrivateCatalog:{type:Boolean,mayBeNull:!0},enableTaskpaneUpgradeToAppCommand:{type:Boolean,mayBeNull:!0},enableUploadFileDevCatalog:{type:Boolean,mayBeNull:!0},enableV1RedirectApis:{type:Boolean,mayBeNull:!0},omexForceAnonymous:{type:Boolean,mayBeNull:!0},userNameHashCode:{type:Number,mayBeNull:!0},hostFullVersion:{type:String,mayBeNull:!0},envCode:{type:String,mayBeNull:!0},showSignOutFromPrivateCatalogMessage:{type:Boolean,mayBeNull:!0},enableSingleSignOnForAddin:{type:Boolean,mayBeNull:!0},enableServiceDeliveredExperience:{type:Boolean,mayBeNull:!0},enableSkipNewWindowNotification:{type:Boolean,mayBeNull:!0},hideAppsExtensionUrl:{type:String,mayBeNull:!0},enableInsertDialogAccessibilityFix:{type:Boolean,mayBeNull:!0},disableLogging:{type:Boolean,mayBeNull:!0},enableDisplayBlockedMinorError:{type:Boolean,mayBeNull:!0},enableFirstPartySSO:{type:Boolean,mayBeNull:!0},enableFirstPartySSOResourceCheck:{type:Boolean,mayBeNull:!0},disableAppsForOfficeThirdParty:{type:Boolean,mayBeNull:!0},wacSessionId:{type:String,mayBeNull:!0}},null),this._osfOmexBaseUrl=e.osfOmexBaseUrl,this._devCatalogUrl=e.devCatalogUrl,this._firstPartyManifestCDNUrl=e.firstPartyManifestCDNUrl,this._oneDriveCatalogBaseApiUrl=e.oneDriveCatalogBaseApiUrl,this._spBaseUrl=e.spBaseUrl,this._myOrgCatalogUrl=null,this._enableAddinCommands=e.enableAddinCommands||!1,this._enableBlackForestRedirect=e.enableBlackForestRedirect||!1,this._enableInsertDialogAccessibilityFix=e.enableInsertDialogAccessibilityFix||!1,this._enableMyOrg=e.enableMyOrg||!1,this._enableMyApps=e.enableMyApps||!1,this._enableDevCatalog=e.enableDevCatalog||!1,this._enableOneDriveCatalog=e.enableOneDriveCatalog||!1,this._enablePrivateCatalog=e.enablePrivateCatalog||!1,this._showSignOutFromPrivateCatalogMessage=e.showSignOutFromPrivateCatalogMessage||!1,this._enableTaskpaneUpgradeToAppCommand=e.enableTaskpaneUpgradeToAppCommand||!1,this._enableUploadFileDevCatalog=e.enableUploadFileDevCatalog||!1,this._enableV1RedirectApis=e.enableV1RedirectApis||!1,this._appName=e.appName,this._appVersion=e.appVersion,this._clientMode=e.clientMode,this._appUILocale=e.appUILocale,this._dataLocale=e.dataLocale,this._docUrl=e.docUrl,this._hostControl=e.hostControl,this._formFactor=e.formFactor||l.FormFactor.Default,this._pageBaseUrl=e.pageBaseUrl,this._lcid=e.lcid,this._controlStatusChanged=e.controlStatusChanged,this._notifyHost=e.notifyHost||function(){},this._allowExternalMarketplace=e.allowExternalMarketplace,this._localizedScriptsUrl=e.localizedScriptsUrl,this._localizedImagesUrl=e.localizedImagesUrl,this._localizedStylesUrl=e.localizedStylesUrl,this._localizedResourcesUrl=e.localizedResourcesUrl,this._autoTrusted=e.trustAgaves,this._omexForceAnonymous=e.omexForceAnonymous||!1,this._userNameHashCode=e.userNameHashCode||0,this._hostFullVersion=e.hostFullVersion,this._wacHostEnvironment=e.envCode,this._enableSingleSignOnForAddin=e.enableSingleSignOnForAddin||!1,this._enableFirstPartySSO=e.enableFirstPartySSO||!1,this._enableFirstPartySSOResourceCheck=e.enableFirstPartySSOResourceCheck||!1,this._enableServiceDeliveredExperience=e.enableServiceDeliveredExperience||!0,this._enableSkipNewWindowNotification=e.enableSkipNewWindowNotification||!1,this._hideAppsExtensionUrl=this._osfOmexBaseUrl+e.hideAppsExtensionUrl,this._disableLogging=e.disableLogging||!1,this._enableDisplayBlockedMinorError=e.enableDisplayBlockedMinorError||!1,this._disableAppsForOfficeThirdParty=e.disableAppsForOfficeThirdParty||!1,ne.HostFeatureEnabledInfo.setHostFeatureEnabledInfo(e),this._pageBaseUrl&&"/"!==this._pageBaseUrl.charAt(this._pageBaseUrl.length-1)&&(this._pageBaseUrl=this._pageBaseUrl+"/"),this._localizedResourcesUrl&&"/"!==this._localizedResourcesUrl.charAt(this._localizedResourcesUrl.length-1)&&(this._localizedResourcesUrl=this._localizedResourcesUrl+"/"),this._clientId=l.OUtil.getUniqueId(),this._cachedOsfControls={},this._iframeAttributeBag={},this._serviceEndPoint=null,this._serviceEndPointInternal=null,this._internalConversationId=null,this._iframeProxies={},this._iframeProxyCount=0,this._iframeNamePrefix="__officeExtensionProxy",this._webUrl=null,this._wsa=null,this._insertDialogDiv=null,this._hasPreloadedOfficeJs=!1,this._contextMgrCorrelationId=e.wacSessionId||l.OUtil.Guid.generateNewGuid(),m.RuntimeTelemetryHelper.LogCommonMessageTag("_contextMgrCorrelationId :"+this._contextMgrCorrelationId,null,20194265),this._hostType=null,this._hostPlatform=null,this._hostSpecificFileVersion=null,this._requirementsChecker=new l.RequirementsChecker,this._onClickInstallOsfControl=null,this._osfOmexBaseUrl){var n,r=this._osfOmexBaseUrl.indexOf(l.Constants.ProtocolSeparator);n=r>=0?this._osfOmexBaseUrl.substr(r):l.Constants.ProtocolSeparator+this._osfOmexBaseUrl;var i=l.Constants.Https+n,a=l.Constants.Https+n;l.OUtil.getQueryStringParamValue(window.location.search,l.Constants.OmexForceAnonymousParamName).toLowerCase()==l.Constants.OmexForceAnonymousParamValue.toLowerCase()?(this._omexAuthNStatus=l.OmexAuthNStatus.Anonymous,this._omexForceAnonymous=!0):this._omexAuthNStatus=l.OmexAuthNStatus.NotAttempted,this._omexGatedWSProxy={proxyUrl:i+l.Constants.OmexGatedServiceExtension,proxyName:"__omexExtensionGatedProxy",isReady:!1,clientEndPoint:null,pendingCallbacks:[]},this._omexWSProxy={proxyUrl:a+l.Constants.OmexUnGatedServiceExtension,proxyName:"__omexExtensionProxy",isReady:!1,clientEndPoint:null,pendingCallbacks:[]},this._omexAnonymousWSProxy={proxyUrl:i+l.Constants.OmexAnonymousServiceExtension,proxyName:"__omexExtensionAnonymousProxy",isReady:!1,clientEndPoint:null,pendingCallbacks:[]},this._omexBillingMarket=null,this._omexEndPointBaseUrl=a}this._isFromWacAutomation=function(){if(void 0!==this._isFromWacAutomation&&null!==this._isFromWacAutomation)return this._isFromWacAutomation;try{for(var e=window,t=void 0;e!==t;){if(!e.location||!e.location.search)return!1;if(e.location.search.toLowerCase().indexOf("automation=1")>=0)return!0;t=e,e=e.parent}}catch(e){return!1}return!1}(),l.OsfManifestManager._setUILocale(this._appUILocale);var o=this;if(o.getContextForEmbeddingPage=function(){var e=0;if(o._hostSpecificFileVersion&&-1!=o._hostSpecificFileVersion.indexOf(".")){var t=o._hostSpecificFileVersion.split("."),n=t[1];isNaN(n)||(e=parseInt(t[1]))}var r=o._requirementsChecker._getSupportedSet();return{appName:o._appName,appVersion:o._appVersion,appUILocal:o._appUILocale,dataLocale:o._dataLocale,docUrl:o._docUrl||window.location.href,clientMode:o._clientMode,minorVersion:e,requirements:r}},this._enableServiceDeliveredExperience)var c=function(e){var t=e&&e.contextId?o.getOsfControl(e.contextId):null;switch(e.id){case l.MessageIDs.FetchBundleUrl:if(!t._agaveEndPoint){var n=t._conversationId+l.SharedConstants.NotificationConversationIdSuffix;t._agaveEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(n,t._frame.contentWindow,t._iframeUrl)}if(t._bundleUrl){var r={id:l.MessageIDs.LoadReactBundle,bundleUrl:t._bundleUrl};t.sendMessageToSdx(r)}break;case l.MessageIDs.LoadBundleSuccess:t._pageStatus=l.OsfControlPageStatus.Ready,t._contextActivationMgr._ErrorUXHelper&&t._contextActivationMgr._ErrorUXHelper.removeProgressDiv(t._div,t._id);break;case l.MessageIDs.LoadBundleError:break;default:s.msAjaxDebug.trace("MessageID: "+e.id+" onMessageFromSdx got wrong message.")}};var u=function(e,t){e.hasOwnProperty("fromInsertDialog")&&!e.fromInsertDialog||null!=o._insertDialogDiv&&2==o._insertDialogDiv.childNodes.length&&o._insertDialogDiv.removeChild(o._insertDialogDiv.lastChild);var n,r=l.OUtil.Guid.generateNewGuid(),i=new ne.InsertDialogTelemetryContext(r);e.storeType==l.StoreTypeEnum.MarketPlace?n={storeType:l.StoreType.OMEX,storeLocator:o._osfOmexBaseUrl}:e.storeType==l.StoreTypeEnum.Catalog?n={storeType:l.StoreType.SPCatalog,storeLocator:o._myOrgCatalogUrl}:e.storeType==l.StoreTypeEnum.OneDrive&&(n={storeType:l.StoreType.OneDrive,storeLocator:o._oneDriveCatalogBaseApiUrl});var a=e.refresh,c={assetId:"",contentMarket:"",anonymous:!1,clientEndPoint:null,clearCache:a,clearKilledApps:!1,referenceInUse:n,hostType:o._hostType};if(e&&e.storeType==l.StoreTypeEnum.MarketPlace){c.clientVersion=o._getClientVersionForOmex(),c.clientVersion&&(c.clientName=o._getClientNameForOmex(),c.appVersion=o._getAppVersionForOmex());(d=ne.CatalogFactory.resolve(l.StoreType.OMEX)).getEntitlementAsync(!1,i,Function.createDelegate(o,function(e){if(e.status==ne.DataServiceResultCode.Succeeded&&e.value){var n=e.value,r=n.length;0===r&&t({errorCode:l.InvokeResultCode.S_OK});for(var s,c={},u=[],p=0;p<r;p++)c[(s=n[p]).contentMarket]?c[s.contentMarket].push(s.assetId):c[s.contentMarket]=[s.assetId];var f=0,m=function(e,n){if(e.status==ne.DataServiceResultCode.Succeeded&&e.value&&e.value.length&&e.value.length>0)for(var i=e.value,a=o.getRequirementsChecker(),s=0;s<i.length;s++){if(a.isEntitlementFromOmexSupported(i[s])){var c=[];c.push(i[s].name),c.push(i[s].assetId),c.push(i[s].description),c.push(l.OUtil.getTargetType(i[s].appSubType)),c.push(l.OUtil.normalizeAppVersion(i[s].version)),c.push(i[s].assetId),c.push(l.StoreType.OMEX),c.push(parseInt(i[s].defaultWidth)),c.push(parseInt(i[s].defaultHeight)),c.push(i[s].iconUrl),c.push(i[s].provider),c.push(n),c.push(l.StoreType.OMEX),u.push(c)}f++}if(f===r){var d={value:u,errorCode:l.InvokeResultCode.S_OK};t(d)}},h=function(e,t){d.getAppDetails(e,t,i,function(e){Function.createDelegate(o,m)(e,t)},a)};for(var g in c)h(c[g],g)}else{var v={value:null,errorCode:l.InvokeResultCode.E_USER_NOT_SIGNED_IN};t(v)}}),a)}else if(e&&e.storeType==l.StoreTypeEnum.Catalog){var u=ne.CatalogFactory.resolve(l.StoreType.SPCatalog);u.myOrgCatalogUrl=o._myOrgCatalogUrl;u.getEntitlementAsync(!1,i,Function.createDelegate(o,function(e){var r;if(l.OUtil.writeProfilerMark(l.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd),e.status==ne.DataServiceResultCode.Succeeded&&e.value){for(var i,a=e.value,s=a.length,c=[],u=0,d=o.getRequirementsChecker(),p=0;p<s;p++)if(i=a[p],d.isEntitlementFromCorpCatalogSupported(i)){var f=[];f.push(i.Title),f.push(i.OfficeExtensionID),f.push(i.OfficeExtensionDescription),f.push(l.OfficeAppType[i.OEType]),f.push(l.OUtil.normalizeAppVersion(i.OfficeExtensionVersion)),f.push(i.OfficeExtensionID),f.push(l.StoreType.SPCatalog),f.push(parseInt(i.OfficeExtensionDefaultWidth.toString())),f.push(parseInt(i.OfficeExtensionDefaultHeight.toString())),f.push(i.OfficeExtensionIcon),f.push(i.OEProviderName),f.push(n.storeLocator),f.push(l.StoreType.SPCatalog),c.push(f),u++}r=u>0?{value:c,errorCode:l.InvokeResultCode.S_OK}:{value:null,errorCode:l.InvokeResultCode.E_CATALOG_NO_APPS}}else r=n.storeLocator?{value:null,errorCode:l.InvokeResultCode.E_GENERIC_ERROR}:{value:null,errorCode:l.InvokeResultCode.E_CATALOG_NO_APPS};t(r)}),a)}else if(e&&e.storeType==l.StoreTypeEnum.OneDrive){l.OsfManifestManager.getOneDriveEntitlementsAsync(c,function(e){var n;e.statusCode===l.ProxyCallStatusCode.Succeeded&&e.value&&(n={value:e.value.entitlements,errorCode:l.InvokeResultCode.S_OK},t(n))})}else if(e&&e.storeType==l.StoreTypeEnum.PrivateCatalog){var d;(d=ne.CatalogFactory.resolve(l.StoreType.PrivateCatalog)).getEntitlementAsync(!1,i,Function.createDelegate(o,function(e){if(e.status!=ne.DataServiceResultCode.Unauthenticated)if(e.status===ne.DataServiceResultCode.Succeeded&&e.value){var n=e.value;if(0!==n.length){var r;r=n.map(function(e){return{ProductId:e.assetId,AddInState:e.addInState,Version:e.appVersion}});var s=[];d.getAppDetails(r,"",i,Function.createDelegate(o,function(e){if(e.status===ne.DataServiceResultCode.Succeeded&&e.value&&e.value.length&&0!==e.value.length){for(var n=e.value,r=o.getRequirementsChecker(),i=0;i<n.length;i++)if(r.isEntitlementFromOmexSupported(n[i])){var a=[];a.push(n[i].name),a.push(n[i].assetId),a.push(n[i].description),a.push(l.OUtil.getTargetType(n[i].appSubType)),a.push(l.OUtil.normalizeAppVersion(n[i].version)),a.push(n[i].assetId),a.push(l.StoreType.PrivateCatalog),a.push(parseInt(n[i].defaultWidth)),a.push(parseInt(n[i].defaultHeight)),a.push(n[i].iconUrl),a.push(n[i].provider),a.push(l.StoreType.PrivateCatalog),a.push(l.StoreType.PrivateCatalog),s.push(a)}t({value:s,errorCode:l.InvokeResultCode.S_OK})}else t({value:null,errorCode:l.InvokeResultCode.E_CATALOG_REQUEST_FAILED})}),a)}else t({errorCode:l.InvokeResultCode.E_CATALOG_NO_APPS})}else t({value:null,errorCode:l.InvokeResultCode.E_CATALOG_REQUEST_FAILED});else t({value:null,errorCode:l.InvokeResultCode.E_USER_NOT_SIGNED_IN})}),a)}else s.msAjaxDebug.trace("Unknown store type.")};this._onClickInstallOsfControl=function(e){if(o._enableUploadFileDevCatalog){s.msAjaxDebug.trace("onClickInstallOsfControl!");try{l.OUtil.validateParamObject(e,{manifest:{type:String,mayBeNull:!1}},null);var t=new l.Manifest.Manifest(e.manifest,o.getAppUILocale()),n=t.getMarketplaceID(),r=t.getMarketplaceVersion();if(ne.CatalogFactory.resolve(l.StoreType.UploadFileDevCatalog).validateAndCacheNewManifest(n,r,e.manifest,t)){var i={id:n,targetType:t.getTarget(),appVersion:r,currentStoreType:l.StoreType.UploadFileDevCatalog,storeId:"developer",assetId:n,assetStoreId:l.StoreType.UploadFileDevCatalog,width:parseInt(t.getDefaultWidth()||"0"),height:parseInt(t.getDefaultHeight()||"0"),isAddinCommands:t._isAddinCommandsManifest(l.getManifestHostType(o._hostType))};l.OUtil.validateParamObject(i,{id:{type:String,mayBeNull:!1},targetType:{type:Number,mayBeNull:!1},appVersion:{type:String,mayBeNull:!1},width:{type:Number,mayBeNull:!0},height:{type:Number,mayBeNull:!0}},null),m.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,i.currentStoreType,i.assetId,i.appVersion,i.targetType,i.isAddinCommands,i.width,i.height),o._notifyHost("0",l.AgaveHostAction.InsertAgave,i)}else o._notifyHost("0",l.AgaveHostAction.NotifyHostError,null)}catch(e){var a="Invalid manifest from addincommands dev catalog.";return ne.WACUtils.logExceptionToBrowserConsole(a,e),m.RuntimeTelemetryHelper.LogExceptionTag(a,e,this._appCorrelationId,19203548),void o._notifyHost("0",l.AgaveHostAction.NotifyHostError,null)}}};var d=function(e){s.msAjaxDebug.trace("onClickRefreshfAddinCommands!"),o._notifyHost("0",l.AgaveHostAction.RefreshAddinCommands,e)},p=function(e){var t=l.OUtil.Guid.generateNewGuid(),n=new ne.InsertDialogTelemetryContext(t),r=ne.CatalogFactory.resolve(l.StoreType.OMEX),i=new ne.PreCacher(o.getRequirementsChecker()),a={assetId:e.assetId,storeType:l.StoreType.OMEX,storeId:e.storeId,appVersion:"",targetType:null};r.activateAsync(a,i,n)},f=function(e,t){if(o._enableSingleSignOnForAddin)h(e,t);else{var n={assetId:e.id,clientVersion:o._getClientVersionForOmex(),clientName:o._getClientNameForOmex(),clientEndPoint:o._omexGatedWSProxy.clientEndPoint},r=o._insertDialogDiv,i={errorCode:l.InvokeResultCode.E_OEM_REMOVED_FAILED},a=l.OUtil.Guid.generateNewGuid(),s=new ne.InsertDialogTelemetryContext(a);ne.CatalogFactory.resolve(l.StoreType.OMEX).removeAsync([n.assetId],s,function(a){var s=0;if(a.status==ne.DataServiceResultCode.Succeeded&&a.value&&a.value.removedApps&&a.value.removedApps.length>0){for(var c=a.value.removedApps,u=l.InvokeResultCode.E_OEM_REMOVED_FAILED,d=0;d<c.length;d++)if(c[d].assetId==n.assetId){c[d].result==l.OmexRemoveAppStatus.Success&&(u=l.InvokeResultCode.S_OK);break}u==l.InvokeResultCode.S_OK&&(s=o.untrustOsfControls(e)),i.errorCode=u}var p=!document.documentElement.contains(r);m.AppManagementMenuHelper.LogAppManagementMenuAction(n.assetId,l.AppManagementAction.Remove,s,p,!1,i.errorCode),t(i)})}},h=function(e,t){var n=o._hideAppsExtensionUrl+"&"+l.OmexPageParameterKeys.AppName+"="+l.getModernAppVerCode(o._appName)+"&"+l.OmexPageParameterKeys.AssetId+"="+e.id+"&"+l.OmexPageParameterKeys.AppCorrelationId+"="+o._contextMgrCorrelationId,r=document.createElement("iframe");r.setAttribute("id","serviceExtensionIframe"),r.setAttribute("src",n),r.setAttribute("scrolling","auto"),r.setAttribute("border","0"),r.setAttribute("width","0"),r.setAttribute("height","0"),r.setAttribute("style","position: absolute; left: -100px; top:0px;"),document.body.appendChild(r);var i=o._insertDialogDiv,a=function(n){if(n.source==r.contentWindow){var s={errorCode:l.InvokeResultCode.E_OEM_REMOVED_FAILED};document.body.removeChild(r),window.removeEventListener("message",a);var c=0,u=JSON.parse(n.data),d=parseInt(u[l.OmexRemoveAddinMessageKeys.RemoveAddinResultCode]),p=l.InvokeResultCode.E_OEM_REMOVED_FAILED;if(d===l.OmexRemoveAddinResultCode.Success){for(var f=u[l.OmexRemoveAddinMessageKeys.RemoveAddinResultValue],h=0;h<f.length;h++)if(f[h]==e.id){p=l.InvokeResultCode.S_OK;break}p==l.InvokeResultCode.S_OK&&(c=o.untrustOsfControls(e),g(e.id)),s.errorCode=p}var v=!document.documentElement.contains(i);m.AppManagementMenuHelper.LogAppManagementMenuAction(e.id,l.AppManagementAction.Remove,c,v,!1,s.errorCode),t(s)}};window.addEventListener("message",a)},g=function(e){var t=[];t.push(new RegExp(l.OUtil.formatString(ne.WACUtils.CacheConstants.EntitlementsKey,".*",".*"),"i")),t.push(new RegExp(l.OUtil.formatString(ne.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,".*",e,".*",".*"),"i")),ne.WACUtils.removeMatchesFromLocalStorage(t)};if(this._serviceEndPoint=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(this._clientId),this._serviceEndPoint._onHandleRequestError=function(e,t){var n,r,i;e&&(n=e._data)&&((r="string"==typeof(r="object"==typeof n?n[0]:n)?r:null)&&(i=o.getOsfControl(r))&&(i._pageStatus="Failed origin check"===t?l.OsfControlPageStatus.FailedOriginCheck:"Access Denied"===t?l.OsfControlPageStatus.FailedPermissionCheck:l.OsfControlPageStatus.FailedHandleRequest,m.RuntimeTelemetryHelper.LogExceptionTag(t,null,i.getCorrelationId(),19203549)))},this._serviceEndPoint.registerMethod("ContextActivationManager_getAppContextAsync",function(e,n){var r="string"==typeof e?e:"object"==typeof e&&e.length>0?e[0]:null,i="object"==typeof e&&2==e.length?e[1]:null;(!r||!n)&&m.RuntimeTelemetryHelper.LogExceptionTag("Parameter validation error in getAppContextAsync.",null,null,19203545);var a=o.getOsfControl(r);if(!a)throw s.msAjaxDebug.trace(t),m.RuntimeTelemetryHelper.LogExceptionTag("Cannot get osfControl with given ID.",null,null,19203546),s.msAjaxError.argument("contextId");m.AppLoadTimeHelper.OfficeJSLoaded(a._telemetryContext);var c=a.getEToken(),u=0;if(o._hostSpecificFileVersion&&-1!=o._hostSpecificFileVersion.indexOf(".")){var d=o._hostSpecificFileVersion.split("."),p=d[1];isNaN(p)||(u=parseInt(d[1]))}var f=o._requirementsChecker._getSupportedSet(),h=new l.OfficeAppContext(a.getMarketplaceID(),o._appName,o._appVersion,o._appUILocale,o._dataLocale,o._docUrl||window.location.href,o._clientMode,a.getSettings(),a.getReason(),a.getOsfControlType(),c,a._appCorrelationId,a.getID(),!1,!0,u,f,a.getHostCustomMessage(),o._hostFullVersion||l.Constants.FileVersion,window.innerHeight,window.innerWidth,a.getManifest()?a.getManifest().getDefaultDisplayName():null,a._appDomains,void 0);h._wacHostEnvironment=o._wacHostEnvironment||"0",h._isFromWacAutomation=!!o._isFromWacAutomation,h._skipNewWindowNotification=a._skipNewWindowNotification,n(h),a._pageStatus=l.OsfControlPageStatus.Ready,a._pageIsReadyTimerExpired&&m.RuntimeTelemetryHelper.LogExceptionTag("App attempted to retrieve context after app activation error has occured.",null,a.getCorrelationId(),19203547),a._contextActivationMgr._ErrorUXHelper&&a._contextActivationMgr._ErrorUXHelper.removeProgressDiv(a._div,a._id),a._timer&&(window.clearTimeout(a._timer),a._timer=null);var g=a._conversationId+l.SharedConstants.NotificationConversationIdSuffix,v=null!=i&&a.checkAppDomains(i)?i:a._iframeUrl;a._agaveEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(g,a._frame.contentWindow,v),m.AppLoadTimeHelper.ActivationEnd(a._telemetryContext)},Microsoft.Office.Common.InvokeType.async,!1),this._serviceEndPoint.registerMethod("ContextActivationManager_notifyHost",function(e){e&&2==e.length||(!e||3!=e.length||e[1]!==l.AgaveHostAction.UpdateTargetUrl)&&s.msAjaxDebug.trace("ContextActivationManager_notifyHost params is wrong.");var n=e[0],r=e[1],i=o.getOsfControl(n);i?r===l.AgaveHostAction.TabExitShift||r===l.AgaveHostAction.ExitNoFocusableShift?o._ErrorUXHelper.focusOnNotificationUxShiftIn(n,r):r===l.AgaveHostAction.UpdateTargetUrl?i.isFirstParty()&&i.updateTargetUrl(e[2]):i._contextActivationMgr._notifyHost?i._contextActivationMgr._notifyHost(n,r):s.msAjaxDebug.trace("No notifyHost provided by the host."):s.msAjaxDebug.trace(t)},Microsoft.Office.Common.InvokeType.async,!1),this._serviceEndPoint.registerMethod("ContextActivationManager_openWindowInHost",function(e){window.open(e.strUrl,e.strWindowName,e.strWindowFeatures)},Microsoft.Office.Common.InvokeType.async,!1),this._enableServiceDeliveredExperience&&this._serviceEndPoint.registerMethod("Office_sendMessageToHost",c,Microsoft.Office.Common.InvokeType.async,!1),this._serviceEndPointInternal=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(this._clientId+l.Constants.EndPointInternalSuffix),this._serviceEndPointInternal.registerMethod("ContextActivationManager_getEntitlementsForInsertDialog",u,Microsoft.Office.Common.InvokeType.async,!1),this._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeSignIn",function(e){if(e&&e.storeType!=l.StoreTypeEnum.PrivateCatalog){var t=window.location.href,n=o._osfOmexBaseUrl+l.Constants.SignInRedirectUrl+encodeURIComponent(t);window.location.assign(n)}else ne.PrivateCatalogService.authenticationProxy.getSignInUrl(function(e){window.top.location.replace(e)},function(){o._notifyHost("0",l.AgaveHostAction.NotifyHostError,null)})},Microsoft.Office.Common.InvokeType.async,!1),this._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeSignOut",function(e){e&&e.storeType==l.StoreTypeEnum.PrivateCatalog&&ne.PrivateCatalogService.SignOutUser(),d(e,null)},Microsoft.Office.Common.InvokeType.async,!1),this._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeWindowOpen",function(e){window.open(e.pageUrl)},Microsoft.Office.Common.InvokeType.async,!1),this._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInsertOsfControl",function(e){s.msAjaxDebug.trace("onClickInsertOsfControl!"),o._notifyHost("0",l.AgaveHostAction.InsertAgave,e)},Microsoft.Office.Common.InvokeType.async,!1),this._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInstallOsfControl",this._onClickInstallOsfControl,Microsoft.Office.Common.InvokeType.async,!1),this._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickRefreshAddinCommands",d,Microsoft.Office.Common.InvokeType.async,!1),this._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickCancelDialog",function(){s.msAjaxDebug.trace("onClickCancelDialog!"),o._notifyHost("0",l.AgaveHostAction.CancelDialog),o._internalConversationId&&(o._serviceEndPointInternal.unregisterConversation(o._internalConversationId),o._internalConversationId=null)},Microsoft.Office.Common.InvokeType.async,!1),this._serviceEndPointInternal.registerMethod("ContextActivationManager_removeAppForInsertDialog",f,Microsoft.Office.Common.InvokeType.async,!1),this._serviceEndPointInternal.registerMethod("ContextActivationManager_logTelemetryDataForInsertDialog",function(e){switch(e.datapointName){case l.DataPointNames.AppManagementMenu:l.OUtil.validateParamObject(e,{assetId:{type:String,mayBeNull:!1},operationMetadata:{type:Number,mayBeNull:!1},hrStatus:{type:Number,mayBeNull:!1}},null),m.AppManagementMenuHelper.LogAppManagementMenuAction(e.assetId,e.operationMetadata,0,!1,!1,e.hrStatus);break;case l.DataPointNames.InsertionDialogSession:l.OUtil.validateParamObject(e,{assetId:{type:String,mayBeNull:!1},totalSessionTime:{type:Number,mayBeNull:!1},trustPageSessionTime:{type:Number,mayBeNull:!1},appInserted:{type:Boolean,mayBeNull:!1},lastActiveTab:{type:Number,mayBeNull:!1},lastActiveTabCount:{type:Number,mayBeNull:!1}},null),m.InsertionDialogSessionHelper.LogInsertionDialogSession(e.assetId,e.totalSessionTime,e.trustPageSessionTime,e.appInserted,e.lastActiveTab,e.lastActiveTabCount);break;case l.DataPointNames.UploadFileDevCatelog:l.OUtil.validateParamObject(e,{operationMetadata:{type:Number,mayBeNull:!1},hrStatus:{type:Number,mayBeNull:!1}},null),m.UploadFileDevCatelogHelper.LogUploadFileDevCatelogAction(this._appCorrelationId,e.operationMetadata,0,!1,!1,e.hrStatus);break;case l.DataPointNames.UploadFileDevCatalogUsage:l.OUtil.validateParamObject(e,{currentStoreType:{type:String,mayBeNull:!1},id:{type:String,mayBeNull:!0},appVersion:{type:String,mayBeNull:!0},appTargetType:{type:Number,mayBeNull:!1},isAppCommand:{type:String,mayBeNull:!1},appSizeWidth:{type:Number,mayBeNull:!0},appSizeHeight:{type:Number,mayBeNull:!0}},null),m.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,e.currentStoreType,e.Id,e.appVersion,e.appTargetType,e.isAppCommand,e.appSizeWidth,e.appSizeHeight)}},Microsoft.Office.Common.InvokeType.async,!1),this._serviceEndPointInternal.registerMethod("ContextActivationManager_getOmexData",p,Microsoft.Office.Common.InvokeType.async,!1),l.AppSpecificSetup._setupFacade(this._hostControl,this,this._serviceEndPoint,this._serviceEndPointInternal),e.hostType=this._hostType,e.spBaseUrl=this._spBaseUrl,ne.CatalogFactory.setHostContext(e),this._localeStringLoadingPendingCallbacks=[],this._localizedScriptsUrl&&"null/"!=this._localizedScriptsUrl){this._loadLocaleString(Function.createDelegate(this,function(){this._ErrorUXHelper=new l._ErrorUXHelper(this)}))}this.queryEntitlementDetails=function(e){u(e,e.callbackFunc)},this._getOmexData=function(e){p(e)},this._removeAppForInsertDialog=function(e){f(e,e.callbackFunc)}},l.ContextActivationManager.prototype={insertOsfControl:function(e){if(l.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:!1},id:{type:String,mayBeNull:!1},marketplaceID:{type:String,mayBeNull:!1},marketplaceVersion:{type:String,mayBeNull:!1},store:{type:String,mayBeNull:!1},storeType:{type:String,mayBeNull:!1},alternateReference:{type:Object,mayBeNull:!0},settings:{type:Object,mayBeNull:!0},reason:{type:String,mayBeNull:!0},osfControlType:{type:Number,mayBeNull:!0},snapshotUrl:{type:String,mayBeNull:!0},preactivationCallback:{type:Object,mayBeNull:!0},virtualOsfControlActivationCallback:{type:Object,mayBeNull:!0},isvirtualOsfControl:{type:Boolean,mayBeNull:!0},isDialog:{type:Boolean,mayBeNull:!0},hostCustomMessage:{type:String,mayBeNull:!0},isForUILessAction:{type:Boolean,mayBeNull:!0},ownerAddinAssetId:{type:String,mayBeNull:!0},ownerAddinStoreType:{type:String,mayBeNull:!0}},null),!this._disableAppsForOfficeThirdParty||e.storeType.toLowerCase()===l.StoreType.FirstParty.toLowerCase()){var t={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,alternateReference:e.alternateReference,settings:e.settings,reason:e.reason,osfControlType:e.osfControlType,snapshotUrl:e.snapshotUrl,contextActivationMgr:this,preactivationCallback:e.preactivationCallback,virtualOsfControlActivationCallback:e.virtualOsfControlActivationCallback,isvirtualOsfControl:e.isvirtualOsfControl,isDialog:e.isDialog,hostCustomMessage:e.hostCustomMessage,isForUILessAction:e.isForUILessAction,ownerAddinAssetId:e.ownerAddinAssetId,sourceLocationOverrideResourceId:e.sourceLocationOverrideResourceId,ownerAddinStoreType:e.ownerAddinStoreType},n=this.getSQMAgaveUsage(t.storeType,t.osfControlType,t.reason,e.marketplaceID),r=new l.OsfControl(t);r._sqmDWords[0]=n[0],r._sqmDWords[1]=n[1],r._contextActivationMgr._ErrorUXHelper&&r._contextActivationMgr._ErrorUXHelper.showProgress(r._div,r._id);return this._loadLocaleString(Function.createDelegate(this,function(){r.activate()})),r}},insertDialogControl:function(e){l.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:!1},id:{type:String,mayBeNull:!1},dialogUrl:{type:String,mayBeNull:!1},marketplaceID:{type:String,mayBeNull:!1},marketplaceVersion:{type:String,mayBeNull:!1},appDomains:{type:Array,mayBeNull:!1},store:{type:String,mayBeNull:!1},storeType:{type:String,mayBeNull:!1},agaveName:{type:String,mayBeNull:!0}},null);var t={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,isDialog:!0,contextActivationMgr:this};new l.OsfControl(t).createIframeForDialogControl(e.agaveName,e.dialogUrl,e.appDomains)},insertBlankControlWithErrorUX:function(e,t){l.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:!1},id:{type:String,mayBeNull:!1},marketplaceID:{type:String,mayBeNull:!1},marketplaceVersion:{type:String,mayBeNull:!1},store:{type:String,mayBeNull:!1},osfControlType:{type:Number,mayBeNull:!0},storeType:{type:String,mayBeNull:!1}},null);var n={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,osfControlType:e.osfControlType,contextActivationMgr:this,isvirtualOsfControl:!1},r=new l.OsfControl(n);r._contextActivationMgr.registerOsfControl(r);var i=ne.OmexUtils.getOmexEndPointPageUrl(this.getOsfOmexBaseUrl(),e.marketplaceID,e.store),a=ne.CatalogFactory.resolve(e.storeType.toLowerCase());if(null!=a){var o={assetId:e.marketplaceID,appVersion:e.marketplaceVersion,storeType:e.storeType,storeId:e.store,targetType:null};a.getAndCacheManifest(o,this._storeLocator,new ne.AddinCommandsTelemetryContext(r.getCorrelationId()),function(n){var a,o,s,l,c,u;o=function(n,a,o){r._showTrustError(n,a,e.storeType,t,i,o)},l="",c="",u=!1,(a=n).status===ne.DataServiceResultCode.Succeeded&&a.value&&(l=(s=a.value).getDefaultDisplayName(),c=s.getProviderName(),u=s.isSSOAddin()),o(l,c,u)})}},purgeDialogControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&(n._conversationId&&this._getServiceEndPoint().unregisterConversation(n._conversationId),this.unregisterOsfControl(n))},dispose:function(){this._serviceEndPoint&&(this._serviceEndPoint.dispose(),Microsoft.Office.Common.XdmCommunicationManager.deleteServiceEndPoint(this._clientId),this._serviceEndPoint=null),this._serviceEndPointInternal&&(this._serviceEndPointInternal.dispose(),Microsoft.Office.Common.XdmCommunicationManager.deleteServiceEndPoint(this._clientId+l.Constants.EndPointInternalSuffix),this._serviceEndPointInternal=null)},setLocalizedUrl:function(e,t,n){var r=Function._validateParams(arguments,[{name:"scriptUrl",type:String,mayBeNull:!1},{name:"imageUrl",type:String,mayBeNull:!1},{name:"styleUrl",type:String,mayBeNull:!1}]);if(r)throw r;if(this._localizedScriptsUrl=e,this._localizedImagesUrl=t,this._localizedStylesUrl=n,this._localizedScriptsUrl&&"null/"!=this._localizedScriptsUrl){this._loadLocaleString(Function.createDelegate(this,function(){this._ErrorUXHelper||(this._ErrorUXHelper=new l._ErrorUXHelper(this))}))}},getOsfControlStatus:function(e){var t=this._cachedOsfControls[e];return t?t.getStatus():l.OsfControlStatus.InvalidOsfControl},activateOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&n.activate()},deActivateOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&n.deActivate()},purgeOsfControl:function(e,t){var n=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"purgeManifest",type:Boolean,mayBeNull:!1}]);if(n)throw n;var r=this._cachedOsfControls[e];void 0!==r&&r.purge(t)},purgeOsfControlNotifications:function(){for(var e in this._cachedOsfControls)this._ErrorUXHelper.purgeOsfControlNotification(e)},untrustOsfControls:function(e){var t=0,n=function(e){return function(){e.activate({hasConsent:!0})}},r=l.OUtil.formatString(l.Constants.ActivatedCacheKey,e.id.toLowerCase(),e.currentStoreType,e.storeId);this._deleteCachedFlag(r);for(var i in this._cachedOsfControls){var a=this._cachedOsfControls[i];if(a._marketplaceID.toLowerCase()==e.id.toLowerCase()){this._ErrorUXHelper.purgeOsfControlNotification(a._id),a.deActivate();var o=ne.OmexUtils.getOmexEndPointPageUrl(this.getOsfOmexBaseUrl(),a._marketplaceID,e.storeId);a._showTrustError(e.displayName,e.providerName,e.currentStoreType,n(a),o),t++}}return t},retryAll:function(e){for(var t in this._cachedOsfControls){var n=this._cachedOsfControls[t];n._marketplaceID.toLowerCase()==e.toLowerCase()&&n._retryActivate&&(this._ErrorUXHelper.purgeOsfControlNotification(n._id),this._ErrorUXHelper.removeInfoBarDiv(t,!1),n._retryActivate(),n._retryActivate=null)}},getOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;return this._cachedOsfControls[e]},getOsfControls:function(){var e=[];for(var t in this._cachedOsfControls)e.push(this._cachedOsfControls[t]);return e},getOsfOmexBaseUrl:function(){return this._osfOmexBaseUrl},getAppName:function(){return this._appName},getClientMode:function(){return this._clientMode},getClientId:function(){return this._clientId},getFormFactor:function(){return this._formFactor},getDocUrl:function(){return this._docUrl},getAppUILocale:function(){return this._appUILocale},getDataLocale:function(){return this._dataLocale},getPageBaseUrl:function(){return this._pageBaseUrl},getLcid:function(){return this._lcid},isExternalMarketplaceAllowed:function(){return this._allowExternalMarketplace},isStoreDisabled:function(e){this._loadLocaleString(Function.createDelegate(this,function(){var t=ne.CatalogFactory.resolve(l.StoreType.OMEX),n=l.OUtil.Guid.generateNewGuid(),r=new ne.InsertDialogTelemetryContext(n);t instanceof ne.OmexCatalog?t.isStoreDisabled(r,e):e({value:!1,status:200})}))},getLocalizedScriptsUrl:function(){return this._localizedScriptsUrl?this._localizedScriptsUrl:""},getLocalizedImagesUrl:function(){return this._localizedImagesUrl?this._localizedImagesUrl:""},getLocalizedStylesUrl:function(){return this._localizedStylesUrl?this._localizedStylesUrl:""},raiseOsfControlStatusChange:function(e){this._controlStatusChanged&&this._controlStatusChanged(e)},registerOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:!1}]);if(t)throw t;this._cachedOsfControls[e.getID()]=e},unregisterOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:!1}]);if(t)throw t;delete this._cachedOsfControls[e.getID()]},setIframeAttributeBag:function(e){this._iframeAttributeBag=e},getOmexIframeNotificationUrl:function(e,t,n){var r=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"notificationType",type:Number,mayBeNull:!1},{name:"isForSideloadAddin",type:Boolean,mayBeNull:!1}]);if(r)throw r;var i=this.getOsfControl(e);if(i){var a=this._osfOmexBaseUrl+l.Constants.OmexConsentNotificationPage+"?"+l.OmexPageParameterKeys.AppName+"="+l.getModernAppVerCode(this._appName)+"&"+l.OmexPageParameterKeys.AppVersion+"="+(this._hostFullVersion||l.Constants.FileVersion)+"&"+l.OmexPageParameterKeys.AppUILocale+"="+this._appUILocale+"&"+l.OmexPageParameterKeys.AppDomain+"="+window.location.origin+"&"+l.OmexPageParameterKeys.StoreLocator+"="+i.getStoreLocator()+"&"+l.OmexPageParameterKeys.NotificationType+"="+t+"&"+l.OmexPageParameterKeys.AppCorrelationId+"="+i.getCorrelationId()+"&"+l.OmexPageParameterKeys.AuthType+"="+this._getAuthTypeForHideAppsExtensionUrl();if(n){var o=i.getManifest().getWebApplicationId(),s=i.getManifest().getWebApplicationScopes();a=a+"&"+l.OmexPageParameterKeys.AppId+"="+o+"&"+l.OmexPageParameterKeys.Scopes+"="+encodeURIComponent(s.join(","))}else{var c=i.getOwnerAddinAssetId(),u=c||i.getMarketplaceID();a=a+"&"+l.OmexPageParameterKeys.AssetId+"="+u}return a}return null},displayNotification:function(e){l.OUtil.validateParamObject(e,{infoType:{type:Number,mayBeNull:!1},id:{type:String,mayBeNull:!1},title:{type:String,mayBeNull:!1},description:{type:String,mayBeNull:!1},url:{type:String,mayBeNull:!0},buttonTxt:{type:String,mayBeNull:!0},buttonCallback:{type:Function,mayBeNull:!0},dismissCallback:{type:Function,mayBeNull:!0},"displayDeactive ":{type:Boolean,mayBeNull:!0},highPriority:{type:Boolean,mayBeNull:!0},detailView:{type:Boolean,mayBeNull:!0},reDisplay:{type:Boolean,mayBeNull:!0},logAsError:{type:Boolean,mayBeNull:!0},errorCode:{type:Number,mayBeNull:!0},retryAll:{type:Boolean,mayBeNull:!0},iframeNotificationUrl:{type:String,mayBeNull:!0},notificationType:{type:Number,mayBeNull:!0}},null),e.errorCode||(e.errorCode=0);var t=this._cachedOsfControls[e.id];if(t)if(t._isvirtualOsfControl){if(e.errorCode==l.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED||e.errorCode==l.ErrorStatusCodes.E_OEM_EXTENSION_KILLED)return void this.purgeOsfControl(e.id,!0);if(void 0==e.highPriority&&(e.highPriority=e.infoType===l.InfoType.Error),!1===e.highPriority)t._notificationParams.push(e);else{for(var n=t._notificationParams,r=0;r<n.length;r++)if(!n[r].highPriority){n.splice(r,0,e),n=null;break}null!=n&&n.push(e)}t._isvirtualOsfControlCallbackInvoked||(null!=t._manifest?t.invokeVirtualOsfControlActivationCallback(t._manifest):t.forceGetVirtualOsfControlManifest())}else{if(e.logAsError&&(m.AppLoadTimeHelper.SetErrorResult(t._telemetryContext,e.errorCode),this._notifyHostError)){var i={errorCode:e.errorCode};this._notifyHostError(e.id,l.AgaveHostAction.NotifyHostError,i)}(e.displayDeactive||null!=e.iframeNotificationUrl)&&(e.detailView=!0),e.div=t._div,this._ErrorUXHelper.showNotification(e)}},dismissMessages:function(e){this._ErrorUXHelper&&this._ErrorUXHelper.dismissMessages(e)},notifyAgave:function(e,t){var n=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"actionId",type:Number,mayBeNull:!1}]);if(n)throw n;var r=this._cachedOsfControls[e];void 0!==r&&(t===l.AgaveHostAction.CtrlF6In||t===l.AgaveHostAction.TabIn||t===l.AgaveHostAction.Select?this._ErrorUXHelper.focusOnNotificationUx(e,t):t===l.AgaveHostAction.TabInShift&&r._pageStatus!==l.OsfControlPageStatus.Ready?this._ErrorUXHelper.focusOnNotificationUxShiftIn(e,t):r.notifyAgave(t))},setWSA:function(e){this._wsa=e,this._wsa&&(this._wsa.createStreamUnobfuscated(l.SQMDataPoints.DATAID_APPSFOROFFICEUSAGE,l.BWsaStreamTypes.Static,2,l.BWsaConfig.defaultMaxStreamRows),this._wsa.createStreamUnobfuscated(l.SQMDataPoints.DATAID_APPSFOROFFICENOTIFICATIONS,l.BWsaStreamTypes.Static,4,l.BWsaConfig.defaultMaxStreamRows))},getWSA:function(){return this._wsa},getSQMAgaveUsage:function(e,t,n,r){var i,a;switch(e.toLowerCase()){case l.StoreType.OMEX:i=0;break;case l.StoreType.SPCatalog:i=1;break;case l.StoreType.FileSystem:i=2;break;case l.StoreType.Registry:i=3;break;case l.StoreType.Exchange:i=4;break;case l.StoreType.SPApp:i=5;break;default:i=15}switch(t){case l.OsfControlType.DocumentLevel:a=1;break;case l.OsfControlType.ContainerLevel:a=0;break;default:a=2}var o=7;if(n&&n.toLowerCase)switch(n.toLowerCase()){case Microsoft.Office.WebExtension.InitializationReason.Inserted.toLowerCase():o=0;break;case Microsoft.Office.WebExtension.InitializationReason.DocumentOpened.toLowerCase():o=1}return[o<<8|a<<4|i,0===r.toLowerCase().indexOf("wa")?parseInt(r.substring(2),10):0]},isMyOrgReady:function(e){if(this._enableMyOrg)if(this._spBaseUrl&&this._iframeProxies&&this._iframeProxies[this._spBaseUrl]&&this._iframeProxies[this._spBaseUrl].clientEndPoint)e({isReady:!0,clientEndPoint:this._iframeProxies[this._spBaseUrl].clientEndPoint});else{this._createSharePointIFrameProxy(this._spBaseUrl,function(t){e(t?{isReady:!0,clientEndPoint:t}:{isReady:!1})})}else e({isReady:!1})},openInputUrlDialog:function(e){var t=document.createElement("p");t.setAttribute("id","title-p"),t.textContent="DevCatalog server Url is configured in settings.xml - Enter manifest file name only (AppId.xml):",e.appendChild(t);var n=document.createElement("input");n.setAttribute("type","url"),n.setAttribute("id","url-input"),n.setAttribute("size","80"),n.setAttribute("data-lpignore","true"),e.appendChild(n);var r=this,i=function(e){var t=new l.Manifest.Manifest(e,r.getAppUILocale());!l.OsfManifestManager.hasManifest(t.getMarketplaceID(),t.getMarketplaceVersion())&&l.OsfManifestManager.cacheManifest(t.getMarketplaceID(),t.getMarketplaceVersion(),t);var n={id:t.getMarketplaceID(),targetType:t.getTarget(),appVersion:t.getMarketplaceVersion(),currentStoreType:l.StoreType.Registry,storeId:"developer",assetId:t.getMarketplaceID(),assetStoreId:l.StoreType.Registry,width:t.getDefaultWidth()||0,height:t.getDefaultHeight()||0,isAddinCommands:t._isAddinCommandsManifest(l.getManifestHostType(r._hostType))};m.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,n.currentStoreType,n.id,n.appVersion,n.targetType,n.isAddinCommands,n.width,n.height),r._notifyHost("0",l.AgaveHostAction.InsertAgave,n)},a=function(e){alert("Error when requsting manifest file: "+e)},o=document.createElement("input");o.setAttribute("type","button"),o.setAttribute("value","Insert"),l.OUtil.addEventListener(o,"click",function(){l.OUtil.xhrGet(r._devCatalogUrl+"/"+n.value,i,a)}),e.appendChild(o)},launchInsertDialog:function(e,t,n){0!=e.childNodes.length&&e.removeChild(e.childNodes.item(0));var r,i=l.OUtil.Guid.generateNewGuid(),a=new ne.InsertDialogTelemetryContext(i);if(this._enableDevCatalog){(r=document.createElement("div")).style.width="100%",r.style.height="80%",e.appendChild(r);var o=document.createElement("div");o.style.width="100%",o.style.height="20%",e.appendChild(o),this.openInputUrlDialog(o)}else r=e;var s=this;s._insertDialogDiv=r;var c=document.createElement("div");c.style.width="100%",c.style.height="100%",c.style.backgroundImage="url("+s.getLocalizedImageFilePath("progress.gif")+")",c.style.backgroundRepeat="no-repeat",c.style.backgroundPosition="center",r.appendChild(c);!function(e,t){if(s._enableMyOrg)try{l.OUtil.validateParamObject(e,{webUrl:{type:String,mayBeNull:!1}},t),s.isMyOrgReady(function(n){n.isReady?(e.clientEndPoint=n.clientEndPoint,ne.CatalogFactory.resolve(l.StoreType.SPCatalog).getSPCatalogUrl(a,function(n){t({statusCode:n.status,value:n.value,context:e})})):t({statusCode:l.InvokeResultCode.E_GENERIC_ERROR,value:null,context:e})})}catch(n){return m.RuntimeTelemetryHelper.LogExceptionTag("Error when getting corporate catalog url:",n,this._appCorrelationId,34719254),void t({statusCode:l.InvokeResultCode.E_GENERIC_ERROR,value:null,context:e})}else t({statusCode:l.InvokeResultCode.E_CATALOG_NO_APPS,value:null,context:e})}({webUrl:s._spBaseUrl},function(e){var i=document.createElement("iframe");i.setAttribute("id","InsertDialog"),i.setAttribute("src","about:blank"),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("marginHeight","0"),i.setAttribute("marginWidth","0"),i.setAttribute("frameBorder","0"),i.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups"),"undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime&&i.setAttribute("title",Strings.OsfRuntime.L_InsertionDialogTile_TXT);var a=null,o=[];s.isStoreDisabled(function(c){var u='{ "IsUploadFileDevCatalogEnabled":'+s._enableUploadFileDevCatalog+',"isStoreDisabled":'+c.value+',"showSignOutFromPrivateCatalogMessage":'+s._showSignOutFromPrivateCatalogMessage+',"enableInsertDialogAccessibilityFix":'+s._enableInsertDialogAccessibilityFix+',"isBlackForestRedirectEnabled":'+s._enableBlackForestRedirect+" }";if(s.isExternalMarketplaceAllowed()){var d='{ "provValues":[0,0,0,'+(s._enableMyApps?l.InvokeResultCode.S_OK.toString():l.InvokeResultCode.S_HIDE_PROVIDER.toString())+'], "url":"'+s._osfOmexBaseUrl+'", "client":"'+s._getClientNameForOmex()+'", "'+l.OmexPageParameterKeys.AuthType+'":'+s._getAuthTypeForHideAppsExtensionUrl()+"}";o.push('"myApp":'+d),m.RuntimeTelemetryHelper.LogCommonMessageTag("isExternalMarketplaceAllowed is true, myApp tab show firstly.",s._contextMgrCorrelationId,20194266)}if(e&&null!=e.value){if(s._enableMyOrg){s._myOrgCatalogUrl=e.value;var p='{ "provValues":[1,1,0,'+e.statusCode+'], "url":"'+e.value+'"}';o.push('"myOrg":'+p)}if(s._enableOneDriveCatalog&&-1!=document.cookie.indexOf("OneDriveCatalog=true")){s._myOneDriveCatalogUrl=e.value;var f='{ "provValues":[9,9,0,0], "url":"'+e.value+'"}';o.push('"myOneDrive":'+f)}}if(s._enablePrivateCatalog){var h='{"provValues":[10,10,0,0], "client":"'+s._getClientNameForOmex()+'"}';o.push('"privateCatalog":'+h)}o.length>0&&(a="{"+o.join(", ")+"}"),s._internalConversationId&&s._serviceEndPointInternal.unregisterConversation(s._internalConversationId);var g=s.getClientId()+"_"+s.getDocUrl(),v=l.OUtil.getFrameName(g),y=l.OUtil.generateConversationId();s._internalConversationId=l.OUtil.generateConversationId(),i.setAttribute("name",v);var _=null;null!=n&&(_='{ "navigationMode":'+n.navigationMode+', "navigationModeParameter": "'+n.assetId+'", "category":"'+n.category+'"}');var C="",S=[y,encodeURIComponent(window.location.href),s._appVersion,l.getAppVerCode(s._appName),s.getLcid(),l.Constants.FileVersion,encodeURIComponent(a),t,encodeURIComponent(u),encodeURIComponent(_),s._contextMgrCorrelationId];C=s._localizedResourcesUrl?s._localizedResourcesUrl+"WefGallery.htm?b="+l.Constants.FileVersion:s._pageBaseUrl+s.getLcid()+"/WefGallery.htm?b="+l.Constants.FileVersion;var A=l.OUtil.addXdmInfoAsHash(C,S.join("|"));s._serviceEndPointInternal.registerConversation(y,A),i.setAttribute("src",A),s._insertDialogDiv?(0!=r.childNodes.length&&r.removeChild(r.childNodes.item(0)),r.appendChild(i)):(r.insertBefore(i,r.firstChild),s._insertDialogDiv=r)})}),s._preloadOfficeJs()},activateAgavesBlockedBySandboxNotSupport:function(){for(var e in this._cachedOsfControls){var t=this._cachedOsfControls[e];t._status===l.OsfControlStatus.NotSandBoxSupported&&t.activate()}},setRequirementsChecker:function(e){this._requirementsChecker=e},getRequirementsChecker:function(){return this._requirementsChecker},appHasNotifications:function(e){return!!this._ErrorUXHelper&&this._ErrorUXHelper.appHasNotifications(e)},_doesUrlHaveSupportedProtocol:function(e){var t=!1;e&&(t=null!=decodeURIComponent(e).match(/^https?:\/\/.+$/gi));return t},_loadLocaleString:function(e){if("undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime){for(var t=this._localeStringLoadingPendingCallbacks.length,n=0;n<t;n++){this._localeStringLoadingPendingCallbacks.shift()()}e()}else{this._localeStringLoadingPendingCallbacks.push(e);var r=this._localeStringLoadingPendingCallbacks;if(1===r.length){this._loadStringScript(function(){for(var e=r.length,t=0;t<e;t++){var n=r.shift();"function"==typeof n&&n()}})}}},_loadStringScript:function(e){var t=this,n=this.getLocalizedScriptsUrl();n+=l.Constants.StringResourceFile;var r=0,i=function(){if("undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime){if(r>0){a=l.OUtil.formatString("osfruntime_strings loaded after {0} retries.",r);m.RuntimeTelemetryHelper.LogExceptionTag(a,null,null,20306077)}e()}else{if(++r<3)return void setTimeout(function(){l.OUtil.loadScript(n,i)},750*r);t._localeStringLoadingPendingCallbacks.length=0;var a=l.OUtil.formatString("The locale, {0}, provided by the host app is not supported. Url: {1}",t.getLcid(),n);m.RuntimeTelemetryHelper.LogExceptionTag(a,null,null,20306076)}};l.OUtil.loadScript(n,i)},_getServiceEndPoint:function(){return this._serviceEndPoint},_getOmexEndPointPageUrl:function(e,t){return l.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",this._omexEndPointBaseUrl,t,e)},_getManifestAndTargetByConversationId:function(e){for(var t in this._cachedOsfControls){var n=this._cachedOsfControls[t];if(e===n._getConversationId())return{manifest:l.OsfManifestManager.getCachedManifest(n.getMarketplaceID(),n.getMarketplaceVersion()),target:n.getOsfControlType()}}return null},_createSharePointIFrameProxy:function(e,t){if(this._doesUrlHaveSupportedProtocol(e)){var n=e.length;"/"===e.charAt(n-1)&&(e=e.substr(0,n-1));var r=this._iframeProxies[e];if(r)r.isReady?t(r.clientEndPoint):r.pendingCallbacks.push(t);else{var i=l.OUtil.generateConversationId(),a=document.createElement("iframe");this._iframeProxyCount=this._iframeProxyCount+1;var o=this._iframeNamePrefix+this._iframeProxyCount;a.setAttribute("id",o),a.setAttribute("name",o);var s=e+"/_layouts/15/OfficeExtensionManager.aspx?"+i;s=l.OUtil.addXdmInfoAsHash(s,i+"|"+o+"|"+window.location.href),s=l.OUtil.addSerializerVersionAsHash(s,l.SerializerVersion.Browser),a.setAttribute("scrolling","auto"),a.setAttribute("border","0"),a.setAttribute("width","0"),a.setAttribute("height","0"),a.setAttribute("style","position: absolute; left: -100px; top:0px;");var c=this,u=function(t,n){var r,o=c._iframeProxies[e];if(o&&0===t&&n.status?(o.isReady=!0,r=o.clientEndPoint):(delete c._iframeProxies[e],Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(i)?(Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(i),l.OUtil.removeEventListener(a,"load",d),a.parentNode.removeChild(a)):m.RuntimeTelemetryHelper.LogExceptionTag("Unexpected error occured with SharePoint proxy.",null,null,19203550),r=null),o)for(var s=o.pendingCallbacks.length,u=0;u<s;u++){o.pendingCallbacks.shift()(r)}},d=function(){c._iframeProxies[e]&&(c._iframeProxies[e].clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(i,a.contentWindow,e),c._iframeProxies[e].clientEndPoint.invoke("OEM_isProxyReady",u,{__timeout__:2e3}))};document.body.appendChild(a),l.OUtil.addEventListener(a,"load",d),a.setAttribute("src",s),this._iframeProxies[e]={clientEndPoint:null,isReady:!1,pendingCallbacks:[t]}}}else t(null)},_getClientVersionForOmex:function(){if(this._appVersion){var e=this._appVersion.split("."),t=parseInt(e[0],10),n=parseInt(e[1],10)||0;if(!(t<=15&&n<=0)){var r=l.Constants.FileVersion.split(".");return t+"."+n+"."+r[2]+"."+r[3]}}},_getClientNameForOmex:function(){return l.OmexClientNames[this._appName]},_getAppVersionForOmex:function(){return l.OmexAppVersions[this._appName]},_setCachedFlag:function(e){var t=l.OUtil.getLocalStorage();t&&t.setItem(e,"true")},_getCachedFlag:function(e){var t=l.OUtil.getLocalStorage();if(t)return!!t.getItem(e)},_deleteCachedFlag:function(e){var t=l.OUtil.getLocalStorage();t&&t.removeItem(e)},_preloadOfficeJs:function(){if(!this._hasPreloadedOfficeJs){var e=document.createElement("script");e.src=l.OUtil.formatString("{0}?locale={1}&host={2}&version={3}",l.Constants.PreloadOfficeJsUrl,this._appUILocale,this._appName,this._hostSpecificFileVersion),e.type="text/javascript",e.id=l.Constants.PreloadOfficeJsId,e.onerror=function(){m.RuntimeTelemetryHelper.LogExceptionTag("Failed to connect to preload service.",null,null,19203551)},document.getElementsByTagName("head")[0].appendChild(e),this._hasPreloadedOfficeJs=!0}},_getAuthTypeForHideAppsExtensionUrl:function(){var e=l.OUtil.getQueryStringParamValue(this._hideAppsExtensionUrl,l.OmexPageParameterKeys.AuthType);return e||l.AuthType.Anonymous},isAddinCommandsAsync:function(e,t){l.OUtil.validateParamObject(e,{marketplaceId:{type:String,mayBeNull:!1},marketplaceVersion:{type:String,mayBeNull:!1},storeType:{type:String,mayBeNull:!1},storeId:{type:String,mayBeNull:!1},targetData:{type:Object,mayBeNull:!1},clearCache:{type:Boolean,mayBeNull:!0}},null);var n=e.storeType.toLowerCase(),r={contextActivationMgr:null,referenceInUse:null},i=e.clearCache||!1;try{r.referenceInUse={id:e.marketplaceId,version:e.marketplaceVersion,storeType:e.storeType,storeLocator:e.storeId},r.contextActivationMgr=this;if(l.StoreType.OMEX===n||l.StoreType.UploadFileDevCatalog===n||l.StoreType.SPCatalog===n||l.StoreType.PrivateCatalog===n){var a=ne.CatalogFactory.resolve(n),o={assetId:r.referenceInUse.id,storeType:n,storeId:r.referenceInUse.storeLocator,appVersion:r.referenceInUse.version,targetType:null},s=l.OUtil.Guid.generateNewGuid(),c=new ne.AddinCommandsTelemetryContext(s);a.getAndCacheManifest(o,o.storeId,c,function(n){var i;null!=(i={statusCode:n.status,value:n.value})&&i.statusCode==ne.DataServiceResultCode.Succeeded&&null!=i.value?t(!0,i.value._isAddinCommandsManifest(l.getManifestHostType(r.contextActivationMgr._hostType)),e):t(!1,!1,e)},i)}else t(!0,!1,e)}catch(n){m.RuntimeTelemetryHelper.LogExceptionTag("Error for checking is addincommands or not",n,null,19203552),t(!1,!1,e)}},getManifestInvaildErrorString:function(){return Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message},getUserNameHashCode:function(){return this._userNameHashCode}},l.OsfControl=function(e){l.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:!1},contextActivationMgr:{type:Object,mayBeNull:!1},id:{type:String,mayBeNull:!1},marketplaceID:{type:String,mayBeNull:!1},marketplaceVersion:{type:String,mayBeNull:!1},store:{type:String,mayBeNull:!1},storeType:{type:String,mayBeNull:!1},alternateReference:{type:Object,mayBeNull:!0},settings:{type:Object,mayBeNull:!0},reason:{type:String,mayBeNull:!0},osfControlType:{type:Number,mayBeNull:!0},snapshotUrl:{type:String,mayBeNull:!0},preactivationCallback:{type:Object,mayBeNull:!0},virtualOsfControlActivationCallback:{type:Object,mayBeNull:!0},isvirtualOsfControl:{type:Boolean,mayBeNull:!0},isDialog:{type:Boolean,mayBeNull:!0},hostCustomMessage:{type:String,mayBeNull:!0},isForUILessAction:{type:Boolean,mayBeNull:!0},ownerAddinAssetId:{type:String,mayBeNull:!0},sourceLocationOverrideResourceId:{type:String,mayBeNull:!0},ownerAddinStoreType:{type:String,mayBeNull:!0}},null),this._div=e.div,this._sourceLocationOverrideResourceId=e.sourceLocationOverrideResourceId,this._contextActivationMgr=e.contextActivationMgr,this._id=e.id,this._storeType=e.storeType.toLowerCase(),this._storeLocator=e.store,this._marketplaceID=e.marketplaceID,this._marketplaceVersion=e.marketplaceVersion,this._alternateReference=e.alternateReference,this._settings=e.settings||{},this._reason=void 0==e.reason?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:e.reason,this._osfControlType=void 0==e.osfControlType?l.OsfControlType.DocumentLevel:e.osfControlType,this._snapshotUrl=e.snapshotUrl,this._status=l.OsfControlStatus.NotActivated,this._notificationParams=[],this._iframeUrl=null,this._permission=null,this._conversationId=null,this._manifestUrl=null,this._pageStatus=l.OsfControlPageStatus.NotStarted,this._pageIsReadyTimerExpired=!1,this._timer=null,this._retryLoadingNum=2,this._frame=null,this._agaveEndPoint=null,this._etoken="",this._sqmDWords=[0,0],this._preactivationCallback=e.preactivationCallback,this._telemetryContext={},this._controlFocus=!1,this._agavePageUrl=null,this._agaveWindowName=null,this._manifest=null,this._virtualOsfControlActivationCallback=e.virtualOsfControlActivationCallback,this._isvirtualOsfControl=void 0!=e.isvirtualOsfControl&&e.isvirtualOsfControl,this._isvirtualOsfControlCallbackInvoked=!1,this._isDialog=void 0!=e.isDialog&&e.isDialog,this._hostCustomMessage=e.hostCustomMessage,this._contextActivationMgr._enableSkipNewWindowNotification?this._skipNewWindowNotification=void 0!=e.isForUILessAction&&!e.isForUILessAction:this._skipNewWindowNotification=!1,this._contextActivationMgr._enableServiceDeliveredExperience&&(this._bundleUrl=null,this._sdxIframeTemplateUrl="https://osf-agave/rtm/sdx/index.html"),this._isUILessAddInCommands=!!e.isForUILessAction,this._ownerAddinAssetId=e.ownerAddinAssetId?e.ownerAddinAssetId:null,this._ownerAddinStoreType=e.ownerAddinStoreType?e.ownerAddinStoreType:null,l.OUtil.isiOS()&&(this._div.style.webkitOverflowScrolling="touch",this._div.style.overflow="auto"),this._appCorrelationId=l.OUtil.Guid.generateNewGuid(),this._iframeOnLoadDelegate=Function.createDelegate(this,this._iframeOnLoad),this._retryActivate=null,this._onKeyDownEventDelegate=Function.createDelegate(this,this._onKeydownEvent)},l.OsfControl.prototype={activate:function(e){var t=this;if(this._status!==l.OsfControlStatus.Activated){try{if(l.OUtil.addEventListener(this._div,"keydown",this._onKeyDownEventDelegate),(e=e||{}).hostType=this._contextActivationMgr._hostType,e.osfControl=e.osfControl||this,e.referenceInUse=e.referenceInUse||{id:this._marketplaceID,version:this._marketplaceVersion,storeType:this._storeType,storeLocator:this._storeLocator},e.correlationId=e.osfControl._appCorrelationId,!this._doesBrowserSupportRequiredFeatures())return this._showActivationError(l.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnsupportedBroswer_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(this,this._refresh),null,null,null,!0,l.ErrorStatusCodes.E_BROWSER_VERSION),void this.invokePreactivationCompletedCallback();var n=document.createElement("iframe"),r="sandbox"in n;n=null;var i=!1,a=l.OUtil.getLocalStorage();if(a&&(i=a.getItem(l.Constants.IgnoreSandBoxSupport)),this._contextActivationMgr._autoTrusted&&!r&&!i)return this._contextActivationMgr._ErrorUXHelper.removeProgressDiv(this._div,this._id),this._status=l.OsfControlStatus.NotSandBoxSupported,this._contextActivationMgr.displayNotification({id:this._id,infoType:l.InfoType.Warning,title:Strings.OsfRuntime.L_AppsDisabled_WRN,description:Strings.OsfRuntime.L_NotSandBoxSupported_ERR,buttonTxt:Strings.OsfRuntime.L_EnableAppsButton_TXT,buttonCallback:Function.createCallback(this._activateAgavesBlockedBySandboxNotSupport,this._contextActivationMgr),url:l.Constants.IEUpgradeUrl,urlButtonTxt:Strings.OsfRuntime.L_UpgradeBrowserButton_TXT,dismissCallback:null,reDisplay:!0,displayDeactive:!0,errorCode:l.ErrorStatusCodes.WAC_HTML5IframeSandboxNotSupport,highPriority:!0}),void this.invokePreactivationCompletedCallback();this.startActivate();var o=this,s=e.referenceInUse;if(s.storeType===l.StoreType.OMEX||s.storeType===l.StoreType.UploadFileDevCatalog||s.storeType===l.StoreType.SPCatalog||s.storeType===l.StoreType.PrivateCatalog||s.storeType===l.StoreType.FirstParty){var c=e.noTargetType||e.osfControl.getOsfControlType()===l.OsfControlTarget.TaskPane?null:e.osfControl.getOsfControlType(),u=ne.CatalogFactory.resolve(s.storeType),d=new ne.OsfControlLoader(this,e.hasConsent);return u.activateAsync({assetId:s.id,storeId:s.storeLocator,appVersion:s.version,storeType:s.storeType,targetType:s.storeType===l.StoreType.SPCatalog?c:""},d,new ne.ActivationTelemetryContext(this.getCorrelationId(),this._telemetryContext,this._sqmDWords[0],this._sqmDWords[1],this._id)),void this.invokePreactivationCompletedCallback()}if("1B4CD97F-DBFE-4C1A-B4C4-FC163B4F9693"===s.id&&m.RuntimeTelemetryHelper.LogCommonMessageTag("ONO_Onboarding_CorrelationId :"+this.getCorrelationId(),null,23381916),m.AppLoadTimeHelper.ActivationStart(this._telemetryContext,this._sqmDWords[0],this._sqmDWords[1],this.getCorrelationId(),this._id,l.ActivationTypes.V2Enabled),m.AppLoadTimeHelper.ServerCallStart(this._telemetryContext),s.storeType===l.StoreType.Exchange||s.storeType===l.StoreType.InMemory)l.OsfManifestManager.getManifestAsync(e,function(e){e.statusCode===l.ProxyCallStatusCode.Succeeded&&e.value&&!t._etoken&&(t._etoken=e.value.getInMemoryEToken()||""),t._onGetManifestCompleted(e)});else if(s.storeType===l.StoreType.Registry&&this._contextActivationMgr._enableDevCatalog||s.storeType===l.StoreType.HardCodedPreinstall)if(e.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.DocumentOpened){l.OUtil.xhrGet(this._contextActivationMgr._devCatalogUrl+"/"+s.id+".xml",function(t){var n=new l.Manifest.Manifest(t,o._contextActivationMgr.getAppUILocale());!l.OsfManifestManager.hasManifest(n.getMarketplaceID(),n.getMarketplaceVersion())&&l.OsfManifestManager.cacheManifest(n.getMarketplaceID(),n.getMarketplaceVersion(),n),l.OsfManifestManager.getManifestAsync(e,Function.createDelegate(o,o._onGetManifestCompleted))},function(e){alert("Error when requsting manifest file: "+e)})}else l.OsfManifestManager.getManifestAsync(e,Function.createDelegate(this,this._onGetManifestCompleted));else if(s.storeType===l.StoreType.OneDrive&&this._contextActivationMgr._enableOneDriveCatalog){var p=function(t){var n=new l.Manifest.Manifest(t,o._contextActivationMgr.getAppUILocale());l.OsfManifestManager.cacheManifest(s.id,n.getMarketplaceVersion(),n),l.OsfManifestManager.getManifestAsync(e,Function.createDelegate(o,o._onGetManifestCompleted))},f=function(){o._showActivationError(l.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(o,o._refresh),null,null,null,null,l.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},h=window.location.protocol+"//"+window.location.host;l.OneDriveOAuth.setHostCallbackUri(h);var g=this._contextActivationMgr._oneDriveCatalogBaseApiUrl+"/root:/Manifests/"+s.id+":/content?access_token=";l.OneDriveOAuth.getAccessToken(function(e){g+=e,l.OUtil.xhrGet(g,p,f)},function(){o._showActivationError(l.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(o,o._refresh),null,null,null,null,l.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)})}else s.storeType===l.StoreType.SPApp?(m.AppLoadTimeHelper.EntitlementCheckStart(this._telemetryContext),e.baseUrl=this._contextActivationMgr.getPageBaseUrl(),e.pageUrl=this._contextActivationMgr._docUrl,e.webUrl=this._contextActivationMgr._webUrl,e.appWebUrl=this._contextActivationMgr._webUrl,l.OsfManifestManager.getSPAppEntitlementsAsync(e,Function.createDelegate(this,this._onGetEntitlementsCompleted))):s.storeType===l.StoreType.FileSystem||s.storeType===l.StoreType.Registry||s.storeType===l.StoreType.HardCodedPreinstall?this._showActivationWarning(l.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,null,null,null,null,l.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType):s.storeType===l.StoreType.OneDrive?this._showActivationWarning(l.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,null,null,null,null,l.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType):this._showActivationError(l.OsfControlStatus.UnknownStore,Strings.OsfRuntime.L_AgaveUnknownStoreType_ERR,null,null,null,null,null,null,l.ErrorStatusCodes.E_MANIFEST_REFERENCE_INVALID)}catch(e){var v="Error getting app data.";ne.WACUtils.logExceptionToBrowserConsole(v,e),m.RuntimeTelemetryHelper.LogExceptionTag(v,e,this.getCorrelationId(),18420419),this._showActivationError(l.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(this,this._refresh),null,null,null,null,l.ErrorStatusCodes.WAC_AgaveOsfControlActivationError)}this.invokePreactivationCompletedCallback()}else this.invokePreactivationCompletedCallback()},createIframeForDialogControl:function(e,t,n){for(;this._div.childNodes.length>0;)this._div.removeChild(this._div.childNodes.item(0));var r=this._createIframeForControl(e);this._iframeUrl=t,this._appDomains=n,this._setIframeAttribute(r,t),this._div.appendChild(r),this._contextActivationMgr.registerOsfControl(this)},deActivate:function(){try{if(l.OUtil.writeProfilerMark(l.OsfControlActivationPerfMarker.DeactivationStart),this._contextActivationMgr.dismissMessages(this._id),this._retryActivate=null,this._status!==l.OsfControlStatus.NotActivated){for(this._agaveEndPoint&&(Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(this._agaveEndPoint._conversationId),this._agaveEndPoint=null),this._frame&&(l.OUtil.removeEventListener(this._frame,"load",this._iframeOnLoadDelegate),this._frame=null),this._timer&&(window.clearTimeout(this._timer),this._timer=null);this._div.childNodes.length>0;)this._div.removeChild(this._div.childNodes.item(0));this._status=l.OsfControlStatus.NotActivated,this._conversationId&&this._contextActivationMgr._getServiceEndPoint().unregisterConversation(this._conversationId),this._contextActivationMgr.raiseOsfControlStatusChange(this)}this._controlFocus=!1,l.OUtil.removeEventListener(this._div,"keydown",this._onKeyDownEventDelegate),l.OUtil.writeProfilerMark(l.OsfControlActivationPerfMarker.DeactivationEnd)}catch(e){ne.WACUtils.logExceptionToBrowserConsole("Deactivate failed.",e),m.RuntimeTelemetryHelper.LogExceptionTag("Deactivate failed.",e,this.getCorrelationId(),18420420)}},startActivate:function(){for(this._controlFocus=!0,this._pageStatus=l.OsfControlPageStatus.Loading,l.OUtil.writeProfilerMark(l.OsfControlActivationPerfMarker.ActivationStart),this._frame&&(l.OUtil.removeEventListener(this._frame,"load",this._iframeOnLoadDelegate),this._frame=null);this._div.childNodes.length>0;)this._div.removeChild(this._div.childNodes.item(0));this._contextActivationMgr._ErrorUXHelper.showProgress(this._div,this._id),this._contextActivationMgr.registerOsfControl(this)},_restartActivate:function(){this.deActivate(),this.startActivate(),this.invokePreactivationCompletedCallback()},purge:function(e){var t=Function._validateParams(arguments,[{name:"purgeManifest",type:Boolean,mayBeNull:!1}]);if(t)throw t;try{this._contextActivationMgr._ErrorUXHelper.purgeOsfControlNotification(this._id),this.deActivate(),e&&l.OsfManifestManager.purgeManifest(this._marketplaceID,this._marketplaceVersion),this._contextActivationMgr.unregisterOsfControl(this)}catch(e){ne.WACUtils.logExceptionToBrowserConsole("Purge failed.",e),m.RuntimeTelemetryHelper.LogExceptionTag("Purge failed.",e,this.getCorrelationId(),18420421)}},invokeVirtualOsfControlActivationCallback:function(e){try{this._virtualOsfControlActivationCallback&&(this._virtualOsfControlActivationCallback(this,e),this._isvirtualOsfControlCallbackInvoked=!0)}catch(e){var t="invokeVirtualOsfControlActivationCallback failed.";ne.WACUtils.logExceptionToBrowserConsole(t,e),m.RuntimeTelemetryHelper.LogExceptionTag(t,e,this.getCorrelationId(),36496280)}},onForceGetVirtualOsfControlManifestCompleted:function(e){var t=null;e.status===ne.DataServiceResultCode.Succeeded&&e.value?t=e.value:this._status=l.OsfControlStatus.ActivationFailed,this.invokeVirtualOsfControlActivationCallback(t)},forceGetVirtualOsfControlManifest:function(){var e={assetId:this._marketplaceID,appVersion:this._marketplaceVersion,storeType:this._storeType,storeId:this._storeLocator,targetType:null},t=ne.CatalogFactory.resolve(e.storeType);null!=t?t.getAndCacheManifest(e,this._storeLocator,new ne.AddinCommandsTelemetryContext(this.getCorrelationId()),Function.createDelegate(this,this.onForceGetVirtualOsfControlManifestCompleted)):(alert("AddinCommands is not supported in "+e.storeType+" store."),this.onForceGetVirtualOsfControlManifestCompleted({status:ne.DataServiceResultCode.Failed,value:null}))},invokePreactivationCompletedCallback:function(){this._preactivationCallback&&this._preactivationCallback()},getMarketplaceID:function(){return this._marketplaceID},getMarketplaceVersion:function(){return this._marketplaceVersion},getContainingDiv:function(){return this._div},getID:function(){return this._id},getSettings:function(){return this._settings},setSettings:function(e){this._settings=e},getReason:function(){return this._reason},getManifest:function(){return this._manifest},getOsfControlType:function(){return this._osfControlType},getSnapshotUrl:function(){return this._snapshotUrl},getStoreType:function(){return this._storeType},isFirstParty:function(){return this._storeType&&this._storeType===l.StoreType.FirstParty},updateTargetUrl:function(e){this._agaveEndPoint._targetUrl=e},getStoreLocator:function(){return this._storeLocator},getHostCustomMessage:function(){return this._hostCustomMessage},getProperty:function(e){var t=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1}]);if(t)throw t;return this._settings[e]},addProperty:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"value",type:String,mayBeNull:!1}]);if(n)throw n;this._settings[e]=t},removeProperty:function(e){var t=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1}]);if(t)throw t;delete this._settings[e]},getStatus:function(){return this._status},getPageStatus:function(){return this._pageStatus},checkAppDomains:function(e){return Microsoft.Office.Common.XdmCommunicationManager.checkUrlWithAppDomains(this._appDomains,e)},getNotificationParams:function(){return this._notificationParams},removeFirstNotification:function(){this._notificationParams.shift()},getIframeUrl:function(){return this._iframeUrl},getPermission:function(){return this._permission},getTrustNoPrompt:function(){return!1},getEToken:function(){return this._etoken},getCorrelationId:function(){return this._appCorrelationId},getAgavePageUrl:function(){return this._agavePageUrl},getAgaveWindowName:function(){return this._agaveWindowName},notifyAgave:function(e){this._agaveEndPoint&&this._agaveEndPoint.invoke("Office_notifyAgave",null,e)},sendMessageToSdx:function(e,t){this._agaveEndPoint&&this._agaveEndPoint.invoke("Office_sendMessageToSdx",t,e)},isUILessAddInCommands:function(){return this._isUILessAddInCommands},getOwnerAddinAssetId:function(){return this._ownerAddinAssetId},getOwnerAddinStoreType:function(){return this._ownerAddinStoreType},_onKeydownEvent:function(e){if(e.preventDefault=e.preventDefault||function(){e.returnValue=!1},117==e.keyCode&&(e.ctrlKey||e.metaKey)){e.preventDefault(),e.stopPropagation();var t=l.AgaveHostAction.CtrlF6Exit;e.shiftKey&&(t=l.AgaveHostAction.CtrlF6ExitShift),this._contextActivationMgr._notifyHost(this._id,t)}else if(9==e.keyCode){e.preventDefault(),e.stopPropagation();var n=this._div.querySelectorAll("input, button, a");if(0==n.length)return;l.OUtil.focusToNextTabbable(n,e.target||e.srcElement,e.shiftKey)||(e.shiftKey?this._contextActivationMgr._notifyHost(this._id,l.AgaveHostAction.TabExitShift):this._agaveEndPoint?this.notifyAgave(l.AgaveHostAction.TabIn):this._contextActivationMgr._notifyHost(this._id,l.AgaveHostAction.TabExit))}else if(27==e.keyCode)e.preventDefault(),this._contextActivationMgr._notifyHost(this._id,l.AgaveHostAction.EscExit);else if(113==e.keyCode)e.preventDefault(),this._contextActivationMgr._notifyHost(this._id,l.AgaveHostAction.F2Exit);else if(13==e.keyCode||32==e.keyCode)for(var r=this._div.querySelectorAll("input, button, a"),i=0;i<r.length;i++){var a=e.target||e.srcElement;if(r[i]===a)return e.preventDefault(),e.stopPropagation(),void a.click()}else e.preventDefault(),e.stopPropagation()},_onGetEntitlementsCompleted:function(e){if(e.statusCode===l.ProxyCallStatusCode.Succeeded&&e.value){m.AppLoadTimeHelper.EntitlementCheckEnd(this._telemetryContext);for(var t,n=e.context.referenceInUse,r=e.value.entitlements,i=r.length,a=null,o=0;o<i;o++)(t=r[o]).OfficeExtensionID&&n.id&&t.OfficeExtensionID.toLowerCase()===n.id.toLowerCase()&&(a&&!this._lessThan(a.OfficeExtensionVersion,t.OfficeExtensionVersion)||(a=t));(t=a)?t.OfficeExtensionKillbit?this._showActivationError(l.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,null,null,null,null,null,null,l.ErrorStatusCodes.E_OEM_EXTENSION_KILLED):(e.context.manifestUrl=t.EncodedAbsUrl,e.context.appInstanceId=t.AppInstanceID,e.context.productId=t.ProductID,e.context.appInstanceId?l.OsfManifestManager.getAppInstanceInfoByIdAsync(e.context,Function.createDelegate(this,this._onGetAppInstanceInfoByIdCompleted)):l.OsfManifestManager.getManifestAsync(e.context,Function.createDelegate(this,this._onGetManifestCompleted))):this._showActivationError(l.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveNotExist_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createCallback(function(e){e.osfControl._refresh(e)},{clearCache:!0,referenceInUse:e.context.referenceInUse,osfControl:e.context.osfControl}),null,null,null,null,l.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST)}else this._showActivationError(l.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(this,this._refresh),null,null,null,null,l.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetAppInstanceInfoByIdCompleted:function(e){if(e.statusCode===l.ProxyCallStatusCode.Succeeded&&e.value){var t=e.value,n=e.context;t.AppWebFullUrl&&(n.appWebUrl=t.AppWebFullUrl),n.clientId=t.AppPrincipalId,n.remoteAppUrl=t.RemoteAppUrl,n.appWebUrl&&n.productId?l.OsfManifestManager.getSPTokenByProductIdAsync(n,Function.createDelegate(this,this._onGetSPTokenByProductIdCompleted)):l.OsfManifestManager.getManifestAsync(n,Function.createDelegate(this,this._onGetManifestCompleted))}else this._showActivationError(l.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(this,this._refresh),null,null,null,null,l.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetSPTokenByProductIdCompleted:function(e){e.statusCode===l.ProxyCallStatusCode.Succeeded&&e.value&&(this._etoken=e.value),l.OsfManifestManager.getManifestAsync(e.context,Function.createDelegate(this,this._onGetManifestCompleted))},_retryActivation:function(){this._retryLoadingNum--,this._pageStatus===l.OsfControlPageStatus.Ready||this._retryLoadingNum<=0?(this._contextActivationMgr._ErrorUXHelper.removeProgressDiv(this._div,this._id),this._retryLoadingNum=2):this._refresh()},_iframeOnLoad:function(){var e=this;m.AppLoadTimeHelper.PageLoaded(this._telemetryContext);e._pageStatus!==l.OsfControlPageStatus.Ready?e._timer=window.setTimeout(function(){!function(e){if(e){if(e._contextActivationMgr._ErrorUXHelper&&(l.OUtil.writeProfilerMark(l.OsfControlActivationPerfMarker.SelectionTimeout),e._contextActivationMgr._ErrorUXHelper.removeProgressDiv(e._div,e._id)),e._pageStatus!==l.OsfControlPageStatus.Ready)if(2===e._retryLoadingNum){var t=l.ErrorStatusCodes.WAC_AgaveActivationError;switch(e._pageStatus){case l.OsfControlPageStatus.FailedOriginCheck:t=l.ErrorStatusCodes.WAC_AgaveOriginCheckError;break;case l.OsfControlPageStatus.FailedPermissionCheck:t=l.ErrorStatusCodes.WAC_AgavePermissionCheckError;break;case l.OsfControlPageStatus.FailedHandleRequest:t=l.ErrorStatusCodes.WAC_AgaveHostHandleRequestError}e._showActivationError(l.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveActivationError_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(e,e._retryActivation),null,null,null,null,t)}else 1===e._retryLoadingNum&&e._showActivationError(l.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_ActivateAttempLoading_ERR,Strings.OsfRuntime.L_ActivateButton_TXT,Function.createDelegate(e,e._retryActivation),null,null,null,null,l.ErrorStatusCodes.WAC_ActivateAttempLoading);else e._notifyHostIFrameOnLoaded();e._timer&&(window.clearTimeout(e._timer),e._timer=null),e._pageIsReadyTimerExpired=!0}}(e)},5e3*e._retryLoadingNum+1):e._notifyHostIFrameOnLoaded()},_isOsfControlInEmbeddingMode:function(e){var t=!1;try{t=null!=e.getContainingDiv().parentNode.parentNode.id.match(/^(m_excelEmbedRenderer_|ewaSynd).+$/gi)}catch(e){ne.WACUtils.logExceptionToBrowserConsole("_isOsfControlInEmbeddingMode error.",e)}return t},_createIframeAndActivateOsfControl:function(e){var t=this._createIframeForControl(e);this._activate(t,this._iframeUrl)},_createIframeForControl:function(e){var t=document.createElement("iframe");t.setAttribute("id",this._id),t.setAttribute("width","100%"),t.setAttribute("height","100%"),t.setAttribute("frameborder","0"),t.setAttribute("allowfullscreen","true");var n=Strings.OsfRuntime.L_IframeTitle_TXT+" "+e;t.setAttribute("title",n),t.style.msUserSelect="element",this._setSandboxAttribute(t);for(var r in this._contextActivationMgr._iframeAttributeBag)t.setAttribute(r,this._contextActivationMgr._iframeAttributeBag[r]);return this._frame=t,t},_setSandboxAttribute:function(e){e.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox"),e.setAttribute("allow","geolocation;microphone;camera")},_onGetManifestCompleted:function(e){if(e.statusCode===l.ProxyCallStatusCode.Succeeded&&e.value){m.AppLoadTimeHelper.ManifestRequestEnd(this._telemetryContext),m.AppLoadTimeHelper.ServerCallEnd(this._telemetryContext);var t=e.value,n=e.context,r=n.referenceInUse,i=r.storeType,a=t.getDefaultDisplayName();if(this._manifest=t,n.manifestCached&&!n.retried){var o=t.getMarketplaceVersion();if(this._lessThan(o,r.version)&&i===l.StoreType.SPApp)return void this._refresh({clearCache:!0,referenceInUse:r,osfControl:n.osfControl,retried:!0})}if(!1===t.requirementsSupported||void 0===t.requirementsSupported&&!this._contextActivationMgr.getRequirementsChecker().isManifestSupported(t)){t.requirementsSupported=!1;var s,c;return s=Strings.OsfRuntime.L_AgaveManifestRequirementsError_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,c=l.ErrorStatusCodes.WAC_AgaveRequirementsError,void this._showActivationError(l.OsfControlStatus.ActivationFailed,s,null,null,null,null,null,!0,c)}if(t.requirementsSupported=!0,this._iframeUrl=t.getDefaultSourceLocation(this._contextActivationMgr.getFormFactor()),this._contextActivationMgr._enableServiceDeliveredExperience){var u=".js"===this._iframeUrl.substr(this._iframeUrl.length-".js".length,".js".length);this._iframeUrl&&u&&(this._bundleUrl=this._iframeUrl,this._iframeUrl=this._sdxIframeTemplateUrl)}if(this._permission=t.getPermission(),this._appDomains=t.getAppDomains(),i===l.StoreType.SPApp&&this._iframeUrl&&(n.clientId&&(this._iframeUrl=this._iframeUrl.replace(/~clientid/gi,n.clientId)),n.appWebUrl&&(this._iframeUrl=this._iframeUrl.replace(/~appweburl/gi,n.appWebUrl)),n.remoteAppUrl&&(this._iframeUrl=this._iframeUrl.replace(/~remoteappurl/gi,n.remoteAppUrl))),!this._contextActivationMgr._doesUrlHaveSupportedProtocol(this._iframeUrl))return void this._showActivationError(l.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestError_ERR,null,null,null,null,null,null,l.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT);this.processManifestForCustomFunctions(),this._isvirtualOsfControl?!n.showNewerVersion&&this.invokeVirtualOsfControlActivationCallback(t):this._createIframeAndActivateOsfControl(a)}else m.RuntimeTelemetryHelper.LogExceptionTag("GetManifest failed:"+ne.WACUtils.serializeObjectToString(e),null,null,18420422),this._showActivationError(l.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(this,this._refresh),null,null,null,null,l.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_isCustomFunctionSandbox:function(){if("object"==typeof this._settings&&"number"==typeof this._settings.length)for(var e=0;e<this._settings.length;e++)if("object"==typeof this._settings[e]&&"number"==typeof this._settings[e].length&&"string"==typeof this._settings[e][0]&&"string"==typeof this._settings[e][1]&&"customfunctionaddinid"==this._settings[e][0].toLowerCase())return!0;return!1},containsCustomFunctions:function(){var e=this._contextActivationMgr._hostType,t=l.getManifestHostType(e);return e!=l.HostType.Outlook&&this._manifest.containsCustomFunctions(t)},processManifestForCustomFunctions:function(){if((this.getReason()===Microsoft.Office.WebExtension.InitializationReason.Inserted||this.getReason()===Microsoft.Office.WebExtension.InitializationReason.DocumentOpened)&&this.containsCustomFunctions()){var e=this.getManifest(),t=l.getManifestHostType(this._contextActivationMgr._hostType),n=this._contextActivationMgr.getFormFactor(),r=new ne.Parser.ParsingContext(t,n,null,e),i=new ne.Parser.AddinCommandsManifestParser(t,n),a={assetId:this._marketplaceID,appVersion:this._marketplaceVersion,storeType:this._storeType,storeId:this._storeLocator,targetType:null},o={setErrorMessageForAddin:function(e,t){s.msAjaxDebug.trace("Error parsing app manifest: "+t)}},c=i.parseExtensions(a,e,o);if("object"==typeof c.ExtensionPoints&&"number"==typeof c.ExtensionPoints.length)for(var u=0;u<c.ExtensionPoints.length;u++)if("CustomFunctions"===c.ExtensionPoints[u].type){var d=c.ExtensionPoints[u];if(this._isCustomFunctionSandbox())this._iframeUrl=r.resources.Urls[d.pageResId];else{var p={osfControl:this,namespace:r.resources.ShortStrings[d.namespaceResId],metadataUrl:r.resources.Urls[d.metadataResId]};this._contextActivationMgr._notifyHost(this._id,l.AgaveHostAction.InstallCustomFunctions,p)}break}}},_lessThan:function(e,t){return l.OsfManifestManager.versionLessThan(e,t)},_showTrustError:function(e,t,n,r,i,a){var o=l.OUtil.formatString(Strings.OsfRuntime.L_AgaveName_INFO,e||"");o=this._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(o);var s=l.OUtil.formatString(Strings.OsfRuntime.L_AgaveProvider_INFO,t||"");s=this._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(s);var c=l.OUtil.formatString(Strings.OsfRuntime.L_AgaveUntrusted_INFO,o,s);a=void 0==a?!!this.getManifest()&&this.getManifest().isSSOAddin():a,this._retryActivate=r,this._contextActivationMgr.displayNotification({id:this._id,infoType:l.InfoType.SecurityInfo,title:Strings.OsfRuntime.L_AgaveNewAppTitle_TXT,description:c,buttonTxt:Strings.OsfRuntime.L_ActivateButton_TXT,buttonCallback:r,url:i||null,dismissCallback:null,reDisplay:!0,displayDeactive:!0,logAsError:!0,retryAll:!0,errorCode:l.ErrorStatusCodes.E_TRUSTCENTER_MOE_UNACTIVATED,iframeNotificationUrl:a&&this._storeType===l.StoreType.OMEX?this._contextActivationMgr.getOmexIframeNotificationUrl(this._id,l.NotificationType.TrustYellowBar):null,notificationType:l.NotificationType.TrustYellowBar})},showConsentError:function(e,t,n){this._retryActivate=e,this._contextActivationMgr.displayNotification({id:this._id,infoType:l.InfoType.SecurityInfo,title:"",description:"",buttonCallback:e,dismissCallback:null,reDisplay:!0,displayDeactive:!1,retryAll:!0,errorCode:l.ErrorStatusCodes.WAC_SSOAddinRequireConsent,iframeNotificationUrl:this._contextActivationMgr.getOmexIframeNotificationUrl(this._id,t,n),notificationType:t})},_showActivationError:function(e,t,n,r,i,a,o,s,c){this._status=e;var u={id:this._id,infoType:l.InfoType.Error,status:e,title:o||Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:t,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||null,url:i||null,dismissCallback:a||null,reDisplay:!a,displayDeactive:!0,detailView:!!s,logAsError:!0,errorCode:c||0};this._contextActivationMgr.displayNotification(u),this._contextActivationMgr.raiseOsfControlStatusChange(this)},_showActivationWarning:function(e,t,n,r,i,a,o){this._status=e;var s={id:this._id,infoType:l.InfoType.Warning,status:e,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:t,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||null,url:i||null,dismissCallback:a||null,reDisplay:!a,displayDeactive:!0,logAsError:!0,errorCode:o||0};this._contextActivationMgr.displayNotification(s),this._contextActivationMgr.raiseOsfControlStatusChange(this)},_refresh:function(e){this.deActivate(),this.activate(e)},_activateAgavesBlockedBySandboxNotSupport:function(e){e.activateAgavesBlockedBySandboxNotSupport();var t=l.OUtil.getLocalStorage();t&&t.setItem(l.Constants.IgnoreSandBoxSupport,"true")},_setCachedFlag:function(e){this._contextActivationMgr._setCachedFlag(e)},_getCachedFlag:function(e){return this._contextActivationMgr._getCachedFlag(e)},_deleteCachedFlag:function(e){this._contextActivationMgr._deleteCachedFlag(e)},_notifyHostIFrameOnLoaded:function(){this._contextActivationMgr._notifyHost&&this._contextActivationMgr._notifyHost(this._id,l.AgaveHostAction.PageIsReady)},_addETokenAsQueryParameter:function(e){var t=document.createElement("a");t.href=e;var n=this.getEToken(),r=l.Constants.ETokenParameterName+"="+encodeURIComponent(l.OUtil.encodeBase64(n)),i=t.search.length>1?t.search.substr(1)+"&":"";t.search=i+r;var a=t.href;return t=null,a},_activate:function(e,t){m.AppLoadTimeHelper.PageStart(this._telemetryContext),this._setIframeAttribute(e,t),this._pageIsReadyTimerExpired=!1,l.OUtil.addEventListener(e,"load",this._iframeOnLoadDelegate),this._div.appendChild(e),this._status=l.OsfControlStatus.Activated,l.OUtil.writeProfilerMark(l.OsfControlActivationPerfMarker.ActivationEnd),this._contextActivationMgr.raiseOsfControlStatusChange(this),m.AppLoadTimeHelper.OfficeJSStartToLoad(this._telemetryContext)},_setIframeAttribute:function(e,t){t=this._addETokenAsQueryParameter(t);var n=this._contextActivationMgr.getClientId()+"_"+this._contextActivationMgr.getDocUrl()+"_"+this._id,r=l.OUtil.getFrameName(n);this._conversationId=l.OUtil.generateConversationId();var i=[this._contextActivationMgr._hostType,this._contextActivationMgr._hostPlatform,this._contextActivationMgr._hostSpecificFileVersion,this._contextActivationMgr._appUILocale,this.getCorrelationId(),this._isDialog?"isDialog":null,this._contextActivationMgr._disableLogging?"disableLogging":null].join("|"),a=t,o=window.location.href,s=this._conversationId+"|"+this._id+"|"+(o.indexOf("$")>=0?encodeURIComponent(o):o),c={};c[l.WindowNameItemKeys.BaseFrameName]=r,c[l.WindowNameItemKeys.HostInfo]=i,c[l.WindowNameItemKeys.XdmInfo]=s,c[l.WindowNameItemKeys.SerializerVersion]=l.SerializerVersion.Browser,this._contextActivationMgr._getServiceEndPoint().registerConversation(this._conversationId,a,this._appDomains),e.setAttribute("src",a),this._agaveWindowName=ne.WACUtils.serializeObjectToString(c),e.setAttribute("name",this._agaveWindowName),l.OUtil.addClass(e,"AddinIframe"),this._agavePageUrl=a},_getConversationId:function(){return this._conversationId},_doesBrowserSupportRequiredFeatures:function(){var e=!1;if(Object.defineProperty)try{Object.defineProperty({},"myTestProperty",{get:function(){return this.desc},set:function(e){this.desc=e}}),e=!0}catch(e){}return e},_isAddinCommands:function(e){if(this._isvirtualOsfControl)e(!0);else if(this._contextActivationMgr._enableAddinCommands&&this._contextActivationMgr._enableTaskpaneUpgradeToAppCommand&&null!=this._virtualOsfControlActivationCallback){var t={marketplaceId:this._marketplaceID,marketplaceVersion:this._marketplaceVersion,storeType:this._storeType,storeId:this._storeLocator,targetData:{}};this._contextActivationMgr.isAddinCommandsAsync(t,function(t,n){e(n)})}else e(!1)}},l.OUtil.setNamespace("Manifest",l),l.Manifest.HostApp=function(e){this._appName=e,this._minVersion=null},l.Manifest.HostApp.prototype={getAppName:function(){return this._appName},getMinVersion:function(){return this._minVersion},_setMinVersion:function(e){this._minVersion=e}},l.Manifest.ExtensionSettings=function(){this._sourceLocations={},this._defaultHeight=null,this._defaultWidth=null},l.Manifest.ExtensionSettings.prototype={getDefaultHeight:function(){return this._defaultHeight},getDefaultWidth:function(){return this._defaultWidth},getSourceLocations:function(){return this._sourceLocations},_addSourceLocation:function(e,t){this._sourceLocations[e.toLocaleLowerCase()]=t},_setDefaultWidth:function(e){this._defaultWidth=e},_setDefaultHeight:function(e){this._defaultHeight=e}},l.Manifest.Manifest=function(e,t){if(this._UILocale=t||"en-us","string"==typeof e){var n;this._displayNames={},this._descriptions={},this._iconUrls={},this._extensionSettings={},this._highResolutionIconUrls={},this._xmlProcessor=new l.XmlProcessor(e,l.ManifestNamespaces[1.1]),this._xmlProcessor.selectSingleNode("o:OfficeApp")?(n=function(){var e=this._xmlProcessor.selectSingleNode("o:Hosts",i);this._hosts=this._parseHosts(e),e&&(this._hostsXml=e.xml||e.outerHTML);e=this._xmlProcessor.selectSingleNode("o:Requirements",i),this._requirements=this._parseRequirements(e),e&&(this._requirementsXml=e.xml||e.outerHTML);(e=this._xmlProcessor.selectSingleNode("o:HighResolutionIconUrl",i))&&this._parseLocaleAwareSettings(e,Function.createDelegate(this,this._addHighResolutionIconUrl))},this._manifestSchemaVersion=l.ManifestSchemaVersion[1.1]):(this._xmlProcessor=new l.XmlProcessor(e,l.ManifestNamespaces["1.0"]),n=function(){var e=this._xmlProcessor.selectSingleNode("o:Capabilities",i),t=this._xmlProcessor.selectNodes("o:Capability",e);this._capabilities=this._parseCapabilities(t)},this._manifestSchemaVersion=l.ManifestSchemaVersion["1.0"]);var r=this._xmlProcessor.getDocumentElement();this._target=l.OUtil.parseEnum(r.getAttribute("xsi:type"),l.OfficeAppType);var i=this._xmlProcessor.selectSingleNode("o:OfficeApp");if(r=this._xmlProcessor.selectSingleNode("o:Id",i),this._id=this._xmlProcessor.getNodeValue(r),!new RegExp("^[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}$","i").test(this._id))throw s.msAjaxError.argument("Manifest");if(r=this._xmlProcessor.selectSingleNode("o:Version",i),this._version=this._xmlProcessor.getNodeValue(r),r=this._xmlProcessor.selectSingleNode("o:ProviderName",i),this._providerName=this._xmlProcessor.getNodeValue(r),r=this._xmlProcessor.selectSingleNode("o:IdIssuer",i),this._idIssuer=this._parseIdIssuer(r),(r=this._xmlProcessor.selectSingleNode("o:AlternateId",i))&&(this._alternateId=this._xmlProcessor.getNodeValue(r)),r=this._xmlProcessor.selectSingleNode("o:DefaultLocale",i),this._defaultLocale=this._xmlProcessor.getNodeValue(r),r=this._xmlProcessor.selectSingleNode("o:DisplayName",i),this._parseLocaleAwareSettings(r,Function.createDelegate(this,this._addDisplayName)),r=this._xmlProcessor.selectSingleNode("o:Description",i),this._parseLocaleAwareSettings(r,Function.createDelegate(this,this._addDescription)),r=this._xmlProcessor.selectSingleNode("o:AppDomains",i),this._appDomains=this._parseAppDomains(r),(r=this._xmlProcessor.selectSingleNode("o:IconUrl",i))&&this._parseLocaleAwareSettings(r,Function.createDelegate(this,this._addIconUrl)),(r=this._xmlProcessor.selectSingleNode("o:Signature",i))&&(this._signature=this._xmlProcessor.getNodeValue(r)),this._parseExtensionSettings(),r=this._xmlProcessor.selectSingleNode("o:Permissions",i),this._permissions=this._parsePermission(r),this._allowSnapshot=!0,(r=this._xmlProcessor.selectSingleNode("o:AllowSnapshot",i))&&(this._allowSnapshot=this._parseBooleanNode(r)),this._manifestSchemaVersion===l.ManifestSchemaVersion[1.1]){var a="ov:";if(this._target==l.OfficeAppType.ContentApp&&(a="c:"),r=this._xmlProcessor.selectSingleNode(a+"VersionOverrides",i)){var o=this._xmlProcessor.selectSingleNode(a+"WebApplicationInfo",r);if(o){var c=this._xmlProcessor.selectSingleNode(a+"Resource",o);this._webApplicationResource=this._xmlProcessor.getNodeValue(c);var u=this._xmlProcessor.selectSingleNode(a+"Id",o);this._webApplicationId=this._xmlProcessor.getNodeValue(u);var d=this._xmlProcessor.selectSingleNode(a+"Scopes",o);this._webApplicationScopes=this._parseWebApplicationScopes(d,a)}}}if(this._manifestSchemaVersion===l.ManifestSchemaVersion[1.1]){var p=this._xmlProcessor.selectSingleNode("ov:VersionOverrides",i);p&&(this._manifestSourceLocationOverrides=this._parseSourceLocationOverrides(p))}n.apply(this)}else e(this)},l.Manifest.Manifest.prototype={getSourceLocationOverrideByResourceId:function(e){return e&&this._manifestSourceLocationOverrides?this._manifestSourceLocationOverrides[e]:null},getManifestSchemaVersion:function(){return this._manifestSchemaVersion},getMarketplaceID:function(){return this._id},getMarketplaceVersion:function(){return this._version},getDefaultLocale:function(){return this._defaultLocale},getProviderName:function(){return this._providerName},getIdIssuer:function(){return this._idIssuer},getAlternateId:function(){return this._alternateId},getSignature:function(){return this._signature},getCapabilities:function(){return this._capabilities},getDisplayName:function(e){return this._displayNames[e.toLocaleLowerCase()]},getDefaultDisplayName:function(){return this._getDefaultValue(this._displayNames)},getDescription:function(e){return this._descriptions[e]},getDefaultDescription:function(){return this._getDefaultValue(this._descriptions)},getIconUrl:function(e){return this._iconUrls[e]},getDefaultIconUrl:function(){return this._getDefaultValue(this._iconUrls)},getSourceLocation:function(e,t){return this._getExtensionSetting(t).getSourceLocations()[e.toLocaleLowerCase()]},getDefaultSourceLocation:function(e){var t=this._getExtensionSetting(e).getSourceLocations();return this._getDefaultValue(t)},getDefaultWidth:function(e){return this._getExtensionSetting(e).getDefaultWidth()},getDefaultHeight:function(e){return this._getExtensionSetting(e).getDefaultHeight()},getTarget:function(){return this._target},getOmexTargetCode:function(){switch(this._target){case l.OfficeAppType.ContentApp:return 2;case l.OfficeAppType.TaskPaneApp:return 1;case l.OfficeAppType.MailApp:return 3;default:return 0}},getPermission:function(){return this._permissions},hasPermission:function(e){return(this._permissions&e)===e},getHosts:function(){return this._hosts},getHostsXml:function(){return this._hostsXml},getRequirements:function(){return this._requirements},getRequirementsXml:function(){return this._requirementsXml},getHighResolutionIconUrl:function(e){return this._highResolutionIconUrls[e]},getDefaultHighResolutionIconUrl:function(){return this._getDefaultValue(this._highResolutionIconUrls)},getAppDomains:function(){return this._appDomains},getInMemoryEToken:function(){return this._inMemoryEToken},isAllowSnapshot:function(){return this._allowSnapshot},addManifestUrl:function(e){var t=ne.WACUtils.getDomainForUrl(e);-1===this._appDomains.indexOf(t)&&this._appDomains.push(t)},getWebApplicationResource:function(){return this._webApplicationResource},getWebApplicationId:function(){return this._webApplicationId},getWebApplicationScopes:function(){return this._webApplicationScopes},isSSOAddin:function(){return!!this._webApplicationResource&&!!this._webApplicationId},containsAddinCommands:function(e){var t=this._getCurrentHostTypeNode(e);if(null!==t&&null!=this._xmlProcessor.selectSingleNode("ov:DesktopFormFactor",t))return!0;return!1},containsCustomFunctions:function(e){var t=this._getCurrentHostTypeNode(e);if(null!==t){var n=this._xmlProcessor.selectSingleNode("ov:AllFormFactors",t);if(null!==n){var r=this._xmlProcessor.selectNodes("ov:ExtensionPoint",n);if(null!==r)for(var i=r.length,a=0;a<i;a++){if("CustomFunctions"===r[a].getAttribute("xsi:type"))return!0}}}return!1},_getDefaultValue:function(e){var t;if(this._UILocale&&(t=e[this._UILocale]||e[this._UILocale.toLocaleLowerCase()]||void 0),!t&&this._defaultLocale&&(t=e[this._defaultLocale]||e[this._defaultLocale.toLocaleLowerCase()]||void 0),!t){var n;for(var r in e){n=r;break}t=e[n]}return t},_getExtensionSetting:function(e){var t;if(void 0!==this._extensionSettings[e])t=this._extensionSettings[e];else for(var n in this._extensionSettings){t=this._extensionSettings[n];break}return t},_addDisplayName:function(e,t){this._displayNames[e.toLocaleLowerCase()]=t},_addDescription:function(e,t){this._descriptions[e]=t},_addIconUrl:function(e,t){this._iconUrls[e]=t},_parseLocaleAwareSettings:function(e,t){if(!e)throw s.msAjaxError.argument("Manifest");var n=e.getAttribute("DefaultValue");t(this._defaultLocale,n);var r=this._xmlProcessor.selectNodes("o:Override",e);if(r)for(var i=r.length,a=0;a<i;a++){var o=r[a];t(o.getAttribute("Locale"),o.getAttribute("Value"))}},_parseBooleanNode:function(e){if(e){var t=this._xmlProcessor.getNodeValue(e).toLowerCase();return"true"===t||"1"===t}return!1},_parseIdIssuer:function(e){if(e){var t=this._xmlProcessor.getNodeValue(e);return l.OUtil.parseEnum(t,l.ManifestIdIssuer)}return l.ManifestIdIssuer.Custom},_parseCapabilities:function(e){for(var t,n=[],r=0;r<e.length;r++){t=e[r].getAttribute("Name"),t=l.OUtil.parseEnum(t,l.Capability),n.push(t)}return n},_parsePermission:function(e){if(!e)throw s.msAjaxError.argument("Manifest");var t=this._xmlProcessor.getNodeValue(e);return l.OUtil.parseEnum(t,l.OsfControlPermission)},_parseExtensionSettings:function(){var e,t,n,r=this;for(var i in l.FormFactor){var a=this._xmlProcessor.selectSingleNode("o:OfficeApp");if(t=this._xmlProcessor.selectSingleNode("o:"+l.FormFactor[i],a)){e=new l.Manifest.ExtensionSettings,n=this._xmlProcessor.selectSingleNode("o:SourceLocation",t);this._parseLocaleAwareSettings(n,function(t,n){e._addSourceLocation(t,n),r.addManifestUrl(n)}),(n=this._xmlProcessor.selectSingleNode("o:RequestedWidth",t))&&e._setDefaultWidth(this._xmlProcessor.getNodeValue(n)),(n=this._xmlProcessor.selectSingleNode("o:RequestedHeight",t))&&e._setDefaultHeight(this._xmlProcessor.getNodeValue(n)),this._extensionSettings[i]=e}}if(!e)throw s.msAjaxError.argument("Manifest")},_parseHosts:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:Host",e),r=0;r<n.length;r++)t.push(n[r].getAttribute("Name"));return t},_parseWebApplicationScopes:function(e,t){var n=[];if(e)for(var r=this._xmlProcessor.selectNodes(t+"Scope",e),i=0;i<r.length;i++)n.push(this._xmlProcessor.getNodeValue(r[i]));return n},_parseRequirements:function(e){var t={sets:[],methods:[]};if(e){var n=this._xmlProcessor.selectSingleNode("o:Sets",e);t.sets=this._parseSets(n);var r=this._xmlProcessor.selectSingleNode("o:Methods",e);t.methods=this._parseMethods(r)}return t},_parseSets:function(e){var t=[];if(e)for(var n=e.getAttribute("DefaultMinVersion"),r=this._xmlProcessor.selectNodes("o:Set",e),i=0;i<r.length;i++){var a=r[i],o=a.getAttribute("MinVersion");t.push({name:a.getAttribute("Name"),version:o||n})}return t},_parseMethods:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:Method",e),r=0;r<n.length;r++)t.push(n[r].getAttribute("Name"));return t},_parseSourceLocationOverrides:function(e){var t={};if(e){var n=this._xmlProcessor.selectSingleNode("ov:Resources",e);if(n){var r=this._xmlProcessor.selectSingleNode("bt:Urls",n);if(r){var i=this._xmlProcessor.selectNodes("bt:Url",r);if(i)for(var a=0;a<i.length;a++){var o=i[a],s=o.getAttribute("id"),l=o.getAttribute("DefaultValue");s&&l&&(t[s]=l)}}}}return t},_parseAppDomains:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:AppDomain",e),r=0;r<n.length;r++){var i=ne.WACUtils.getDomainForUrl(this._xmlProcessor.getNodeValue(n[r]));-1===t.indexOf(i)&&t.push(i)}return t},_addHighResolutionIconUrl:function(e,t){this._highResolutionIconUrls[e]=t},_isAddinCommandsManifest:function(e){return this.containsAddinCommands(e)||this.containsCustomFunctions(e)},_getCurrentHostTypeNode:function(e){var t=this._xmlProcessor.selectSingleNode("o:OfficeApp");if(null!==t&&this.getManifestSchemaVersion()===l.ManifestSchemaVersion[1.1]){var n=this._xmlProcessor.selectSingleNode("ov:VersionOverrides",t);if(null!==n){var r=this._xmlProcessor.selectSingleNode("ov:Hosts",n);if(null!==r){var i=this._xmlProcessor.selectNodes("ov:Host",r);if(null!==i)for(var a=i.length,o=0;o<a;o++){if(i[o].getAttribute("xsi:type")===e)return i[o]}}}}return null}},l.OsfManifestManager=function(){var e="marketplaceVersion",t="marketplaceID",n={},r="en-us",i={};function a(e,t){return e+"_"+t}return{getManifestAsync:function(e,t){l.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:!1},referenceInUse:{type:Object,mayBeNull:!1}},t);var r=e.referenceInUse,i=a(r.id,r.version),o=n[i];if(e.manifestCached=!1,o)e.manifestCached=!0,t({statusCode:l.ProxyCallStatusCode.Succeeded,value:o,context:e});else if(e.clientEndPoint&&e.manifestUrl){m.AppLoadTimeHelper.ManifestRequestStart(e.osfControl._telemetryContext);var s={manifestUrl:e.manifestUrl,id:r.id,version:r.version,clearCache:e.clearCache||!1};this._invokeProxyMethodAsync(e,"OEM_getManifestAsync",function(e){var n;if(e.statusCode===l.ProxyCallStatusCode.Succeeded&&e.value)try{var i;n=e.context.osfControl,"string"==typeof e.value?(e.context.manifestCached=!0,i=e.value):(e.context.manifestCached=e.value.cached,i=e.value.manifest),m.AppLoadTimeHelper.SetManifestDataCachedFlag(n._telemetryContext,e.value.cached),e.value=new l.Manifest.Manifest(i,n._contextActivationMgr.getAppUILocale()),l.OsfManifestManager.cacheManifest(r.id,r.version,e.value)}catch(t){var a;e.value=null,n&&(a=n._appCorrelationId);var o="Invalid manifest in getManifestAsync.";ne.WACUtils.logExceptionToBrowserConsole(o,t),m.RuntimeTelemetryHelper.LogExceptionTag(o,t,a,18420423)}else m.RuntimeTelemetryHelper.LogExceptionTag("getManifestAsync failed:"+ne.WACUtils.serializeObjectToString(e),null,null,18420424);t(e)},s)}else t({statusCode:l.ProxyCallStatusCode.Failed,value:null,context:e})},getAppInstanceInfoByIdAsync:function(e,t){l.OUtil.validateParamObject(e,{webUrl:{type:String,mayBeNull:!1},appInstanceId:{type:String,mayBeNull:!1},clientEndPoint:{type:Object,mayBeNull:!1}},t);var n={webUrl:e.webUrl,appInstanceId:e.appInstanceId,clearCache:e.clearCache||!1};this._invokeProxyMethodAsync(e,"OEM_getSPAppInstanceInfoByIdAsync",t,n)},getSPTokenByProductIdAsync:function(e,t){l.OUtil.validateParamObject(e,{appWebUrl:{type:String,mayBeNull:!1},productId:{type:String,mayBeNull:!1}},t);var n=this;e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.appWebUrl,function(r){if(r){var i={webUrl:e.appWebUrl,productId:e.productId,clearCache:e.clearCache||!1,clientEndPoint:r};n._invokeProxyMethodAsync(e,"OEM_getSPTokenByProductIdAsync",t,i)}else t({statusCode:l.ProxyCallStatusCode.ProxyNotReady,value:null,context:e})})},getSPAppEntitlementsAsync:function(e,t){if(l.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:!1},referenceInUse:{type:Object,mayBeNull:!1},baseUrl:{type:String,mayBeNull:!1},pageUrl:{type:String,mayBeNull:!1},webUrl:{type:String,mayBeNull:!0}},t),e.webUrl)this.getCorporateCatalogEntitlementsAsync(e,t);else{var n=document.createElement("a");n.href=e.pageUrl;var r=n.pathname,i=r.split("/"),a=i.length-1,o=n.href.substring(0,n.href.length-r.length);o&&"/"!==o.charAt(o.length-1)&&(o+="/");for(var s=[o],c=0;c<a;c++)i[c]&&(o=o+i[c]+"/",s.push(o));n=null;var u=this,d=e.osfControl._contextActivationMgr,p=s.pop(),f=function(e){if(e.statusCode===l.ProxyCallStatusCode.Succeeded){var n=e.value;n&&"/"!==n.charAt(n.length-1)&&(n+="/"),d._webUrl=n,e.context.webUrl=n,e.context.appWebUrl=n,u.getCorporateCatalogEntitlementsAsync(e.context,t)}else t(e)},m=function(n){if(n){e.clientEndPoint=n;var r={pageUrl:e.pageUrl,baseUrl:p,clearCache:e.clearCache||!1};u._invokeProxyMethodAsync(e,"OEM_getSPAppWebUrlFromPageUrlAsync",f,r)}else s.length>0?(p=s.pop(),d._createSharePointIFrameProxy(p,m)):t({statusCode:l.ProxyCallStatusCode.Failed,value:null,context:e})};d._createSharePointIFrameProxy(p,m)}},getOneDriveEntitlementsAsync:function(e,t){var n=e.referenceInUse.storeLocator,r=e.referenceInUse.storeLocator+"/root:/Manifests",i=l.OneDriveOAuth.getAccessTokenFromCookie(),a="?access_token="+i,o=r+a,s=new XMLHttpRequest,c=new XMLHttpRequest;s.onreadystatechange=function(){if(4==s.readyState&&200==s.status){var t=JSON.parse(s.response).id,n=e.referenceInUse.storeLocator+"/items/"+t+"/children"+a;c.open("GET",n),c.setRequestHeader("Content-Type","json"),c.send()}};var u=[],d=0,p=0,f=function(){d==p&&t({statusCode:l.ProxyCallStatusCode.Succeeded,value:{entitlements:u},context:e})},m=function(e,t){p++;var n=t;try{var r=new l.Manifest.Manifest(e.responseText),i=[];i.push(r.getDefaultDisplayName()),i.push(n),i.push(r.getDefaultDescription()),i.push(r.getTarget()),i.push(r.getMarketplaceVersion()),i.push(n),i.push(l.StoreType.OneDrive),i.push(r.getDefaultWidth()||0),i.push(r.getDefaultHeight()||0),i.push(r.getDefaultIconUrl()),i.push(r.getProviderName()),i.push(r.getDefaultLocale()),i.push(l.StoreType.OneDrive),u.push(i)}catch(e){}f()},h=function(){p++,f()};c.onreadystatechange=function(){if(4==c.readyState&&200==c.status){for(var e=JSON.parse(c.responseText),t=0;t<e.value.length;t++)if(".xml"==e.value[t].name.substr(e.value[t].name.length-4).toLowerCase()){var r=n+"/root:/Manifests/"+e.value[t].name+":/content?access_token="+i;l.OUtil.xhrGetFull(r,e.value[t].name,m,h),d++}f()}},s.open("GET",o),s.setRequestHeader("Content-Type","json"),s.send()},getCorporateCatalogEntitlementsAsync:function(e,t){l.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:!1},referenceInUse:{type:Object,mayBeNull:!1},webUrl:{type:String,mayBeNull:!1}},t),m.AppLoadTimeHelper.AuthenticationStart(e.osfControl._telemetryContext);var n=this,r=0,i=function(a){if(a){m.AppLoadTimeHelper.AuthenticationEnd(e.osfControl._telemetryContext),e.clientEndPoint=a;var o={webUrl:e.webUrl,applicationName:l.HostCapability[e.hostType],officeExtentionTarget:e.noTargetType||e.osfControl.getOsfControlType()===l.OsfControlTarget.TaskPane?null:e.osfControl.getOsfControlType(),clearCache:e.clearCache||!1,supportedManifestVersions:{"1.0":!0,1.1:!0}};n._invokeProxyMethodAsync(e,"OEM_getEntitlementSummaryAsync",t,o)}else r<l.Constants.AuthenticatedConnectMaxTries?(r++,setTimeout(function(){e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.webUrl,i)},500)):t({statusCode:l.ProxyCallStatusCode.ProxyNotReady,value:null,context:e})};e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.webUrl,i)},_invokeProxyMethodAsync:function(e,t,n,r){var a,o=[r.clientEndPoint?r.clientEndPoint._targetUrl:e.clientEndPoint._targetUrl,t];for(var s in r)("string"===(a=typeof r[s])||"number"===a||"boolean"===a)&&o.push(r[s]);var c=o.join("."),u=i,d={onCompleted:n,context:e,methodName:t},p=u[c];if(p)p.push(d);else{u[c]=[d];var f=e.clientEndPoint;r.clientEndPoint&&(f=r.clientEndPoint,delete r.clientEndPoint),e.referenceInUse&&e.referenceInUse.storeType===l.StoreType.OMEX&&(r.officeVersion=l.Constants.ThreePartsFileVersion),f.invoke(t,function(e,t){var n=null,r=l.ProxyCallStatusCode.Failed;0===e&&t.status&&(n=t.result,r=l.ProxyCallStatusCode.Succeeded);var i=u[c];delete u[c];for(var a=i.length,o=0;o<a;o++){var s,d=i.shift();try{d.context&&d.context.osfControl&&(s=d.context.osfControl._appCorrelationId),t&&t.failureInfo&&m.RuntimeTelemetryHelper.LogProxyFailure(s,d.methodName,t.failureInfo),d.onCompleted({statusCode:r,value:n,context:d.context})}catch(e){var p="_invokeProxyMethodAsync failed.";ne.WACUtils.logExceptionToBrowserConsole(p,e),m.RuntimeTelemetryHelper.LogExceptionTag(p,e,s,18420425)}}},r)}},removeOmexCacheAsync:function(e,t){l.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:!1},referenceInUse:{type:Object,mayBeNull:!1},clientEndPoint:{type:Object,mayBeNull:!1}},t);var n=e.referenceInUse,r={applicationName:e.hostType,assetID:n.id,officeExtentionTarget:e.osfControl.getOsfControlType(),clearEntitlement:e.clearEntitlement||!1,clearToken:e.clearToken||!1,clearAppState:e.clearAppState||!1,clearManifest:e.clearManifest||!1,appVersion:e.appVersion};e.anonymous?r.contentMarket=n.storeLocator:(r.assetContentMarket=e.osfControl._omexEntitlement.contentMarket,r.userContentMarket=n.storeLocator),this._invokeProxyMethodAsync(e,"OMEX_removeCacheAsync",t,r)},purgeManifest:function(r,i){var o=Function._validateParams(arguments,[{name:t,type:String,mayBeNull:!1},{name:e,type:String,mayBeNull:!1}]);if(o)throw o;var s=a(r,i);void 0!==n[s]&&delete n[s]},cacheManifest:function(i,o,s){var l=Function._validateParams(arguments,[{name:t,type:String,mayBeNull:!1},{name:e,type:String,mayBeNull:!1},{name:"manifest",type:Object,mayBeNull:!1}]);if(l)throw l;var c=a(i,o);s._UILocale=r,n[c]=s},hasManifest:function(r,i){var o=Function._validateParams(arguments,[{name:t,type:String,mayBeNull:!1},{name:e,type:String,mayBeNull:!1}]);if(o)throw o;var s=a(r,i);return void 0!==n[s]},getCachedManifest:function(r,i){var o=Function._validateParams(arguments,[{name:t,type:String,mayBeNull:!1},{name:e,type:String,mayBeNull:!1}]);if(o)throw o;var s=a(r,i);return n[s]},versionLessThan:function(e,t){for(var n,r,i=e.split("."),a=t.split("."),o=Math.min(i.length,a.length),s=0;s<o;s++)try{if((n=parseFloat(i[s]))!=(r=parseFloat(a[s])))return n<r}catch(e){}if(i.length>=a.length)return!1;o=a.length;var l=0;for(s=i.length;s<o;s++){try{r=parseFloat(a[s])}catch(e){r=0}l+=r}return l>0},_setUILocale:function(e){r=e}}}(),l.ManifestSchemaVersion={"1.0":"1.0",1.1:"1.1"},l.ManifestNamespaces={"1.0":'xmlns="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"',1.1:'xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0" xmlns:ov="http://schemas.microsoft.com/office/taskpaneappversionoverrides" xmlns:c="http://schemas.microsoft.com/office/contentappversionoverrides"'},l.OsfNavigationMode={DefaultMode:0,CategoryMode:1,TrustPageMode:2,QueryResultMode:3},l.RequirementsChecker=function(e,t,n,r,i){this.setCapabilities(e),this.setHosts(t),this.setRequirements(n),this.setSupportedControlTargets(r),this.setSupportedOmexAppVersions(i),this.setFilteringEnabled(!1)},l.RequirementsChecker.prototype={defaultMinMaxVersion:"1.1",isManifestSupported:function(e){if(!this.isFilteringEnabled())return!0;if(!e)return!1;switch(e.getManifestSchemaVersion()||l.ManifestSchemaVersion["1.0"]){case l.ManifestSchemaVersion["1.0"]:return this._checkManifest1_0(e);case l.ManifestSchemaVersion[1.1]:return this._checkManifest1_1(e);default:return!1}},isEntitlementFromOmexSupported:function(e){var t;if(!this.isFilteringEnabled())return!0;if(!e)return!1;switch(e.appSubType){case"1":t=l.OsfControlTarget.TaskPane;break;case"2":t=l.OsfControlTarget.InContent;break;case"3":t=l.OsfControlTarget.Contextual;break;case"4":t=l.OsfControlTarget.TaskPane;break;default:return!1}if(!this._checkControlTarget(t))return!1;if(!e.requirements&&!e.hosts)return!e.hasOwnProperty("appVersions")||void 0===e.appVersions||this._checkOmexAppVersions(e.appVersions);var n,r,i,a,o=new l.Manifest.Manifest(function(){});return e.requirements&&(o._xmlProcessor=new l.XmlProcessor(e.requirements,l.ManifestNamespaces[1.1]),r=o._xmlProcessor.getDocumentElement()),n=o._parseRequirements(r),e.hosts&&(o._xmlProcessor=new l.XmlProcessor(e.hosts,l.ManifestNamespaces[1.1]),a=o._xmlProcessor.getDocumentElement()),i=o._parseHosts(a),this._checkHosts(i)&&this._checkSets(n.sets)&&this._checkMethods(n.methods)},isEntitlementFromCorpCatalogSupported:function(e){if(!this.isFilteringEnabled())return!0;if(!e)return!1;var t=l.OfficeAppType[e.OEType];if(!this._checkControlTarget(t))return!1;var n,r,i,a,o,s=new l.Manifest.Manifest(function(){});e.OfficeExtensionCapabilitiesXML&&(s._xmlProcessor=new l.XmlProcessor(e.OfficeExtensionCapabilitiesXML,l.ManifestNamespaces[1.1]),a=s._xmlProcessor.getDocumentElement(),r=(o=s._parseRequirements(a)).sets,i=o.methods,n=s._parseHosts(a));return this._checkHosts(n)&&this._checkSets(r)&&this._checkMethods(i)},setCapabilities:function(e){this._supportedCapabilities=this._scalarArrayToObject(e)},setHosts:function(e){this._supportedHosts=this._scalarArrayToObject(e)},setRequirements:function(e){this._supportedSets=e&&this._arrayToSetsObject(e.sets)||{},this._supportedMethods=e&&this._scalarArrayToObject(e.methods)||{}},setSupportedControlTargets:function(e){this._supportedControlTargets=this._scalarArrayToObject(e)},setSupportedOmexAppVersions:function(e){this._supportedOmexAppVersions=e&&e.slice?e.slice(0):[]},setFilteringEnabled:function(e){this._filteringEnabled=!!e},isFilteringEnabled:function(){return this._filteringEnabled},_checkManifest1_0:function(e){return this._checkCapabilities(e.getCapabilities())},_checkCapabilities:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(this._supportedCapabilities[e[t]])return!0;return!1},_checkManifest1_1:function(e){var t=e.getRequirements()||{};return this._checkHosts(e.getHosts())&&this._checkSets(t.sets)&&this._checkMethods(t.methods)},_checkHosts:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(this._supportedHosts[e[t]])return!0;return!1},_checkSets:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++){var n=e[t],r=this._supportedSets[n.name.toLowerCase()];if(!r)return!1;if(n.version&&(this._compareVersionStrings(r.minVersion||this.defaultMinMaxVersion,n.version)>0||this._compareVersionStrings(r.maxVersion||this.defaultMinMaxVersion,n.version)<0))return!1}return!0},_checkMethods:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(!this._supportedMethods[e[t]])return!1;return!0},_checkControlTarget:function(e){return void 0!=e&&this._supportedControlTargets[e]},_checkOmexAppVersions:function(e){if(!e)return!1;for(var t=0;t<this._supportedOmexAppVersions.length;t++)if(e.indexOf(this._supportedOmexAppVersions[t])>=0)return!0;return!1},_scalarArrayToObject:function(e){var t={};if(e&&e.length)for(var n=0;n<e.length;n++)void 0!=e[n]&&(t[e[n]]=!0);return t},_arrayToSetsObject:function(e){var t={};if(e&&e.length)for(var n=0;n<e.length;n++){var r=e[n];r&&void 0!=r.name&&(t[r.name.toLowerCase()]=r)}return t},_getSupportedSet:function(){for(var e={},t=Object.getOwnPropertyNames(this._supportedSets),n=0;n<t.length;n++){var r=this._supportedSets[t[n]];e[r.name.toLowerCase()]=r.maxVersion||this.defaultMinMaxVersion}return"undefined"!=typeof JSON?JSON.stringify(e):e},_compareVersionStrings:function(e,t){e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length),r=0;r<n;r++){var i=parseInt(e[r],10)||0,a=parseInt(t[r],10)||0;if(i!==a)return i-a}return 0}},ne.appSpecificCheckOrigin=function(e,t,n,r){try{return!(!(t&&t.source&&t.source.location&&t.source.location.pathname)||t.source.location.pathname.indexOf("projection.aspx")<0)&&r(e,n)}catch(e){return!1}},window.OfficeExt=ne},4294:function(e,t){e.exports={am:"am-et",ar:"ar-sa",bg:"bg-bg","bn-in":"bn-in",ca:"ca-es",cs:"cs-cz",cy:"cy-gb",da:"da-dk",de:"de-de",el:"el-gr",en:"en-us",es:"es-es","es-mx":"es-mx",et:"et-ee",eu:"eu-es",fa:"fa-ir",fi:"fi-fi",fil:"fil-ph",fr:"fr-fr","fr-ca":"fr-ca",gl:"gl-es",gu:"gu-in",he:"he-il",hi:"hi-in",hr:"hr-hr",hu:"hu-hu",id:"id-id",is:"is-is",it:"it-it",ja:"ja-jp",kk:"kk-kz",kn:"kn-in",ko:"ko-kr","lo-la":"lo-la",lt:"lt-lt",lv:"lv-lv",ml:"ml-in",mr:"mr-in",ms:"ms-my",nl:"nl-nl","nn-no":"nn-no",no:"nb-no",pl:"pl-pl",pt:"pt-br","pt-pt":"pt-pt",ro:"ro-ro",ru:"ru-ru",sk:"sk-sk",sl:"sl-si",sr:"sr-latn-rs","sr-cyrl":"sr-cyrl-rs",sv:"sv-se",sw:"sw-ke",ta:"ta-in",te:"te-in",th:"th-th",tr:"tr-tr",uk:"uk-ua",ur:"ur-pk",vi:"vi-vn","zh-hans":"zh-cn","zh-hant":"zh-tw"}},4295:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),i=n(4296);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("ExecuteEwsProxy",e,t)}},4296:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"EwsProxyRequestParameters:#Exchange"},e)}},4297:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),i=n(4298);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=i.default(e.request)),r.makeServiceRequest("LoadExtensionCustomProperties",e,t)}},4298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"LoadExtensionCustomPropertiesParameters:#Exchange"},e)}},4299:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),i=n(4300);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("RegisterConsent",e,t)}},4300:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"RegisterConsentJsonRequest:#Exchange"},e)}},4301:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"RegisterConsentRequest:#Exchange"},e)}},4302:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),i=n(4303);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=i.default(e.request)),r.makeServiceRequest("SaveExtensionCustomProperties",e,t)}},4303:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SaveExtensionCustomPropertiesParameters:#Exchange"},e)}},4304:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),i=n(4305);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=i.default(e.request)),r.makeServiceRequest("SaveExtensionSettings",e,t)}},4305:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SaveExtensionSettingsParameters:#Exchange"},e)}},4306:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),i=n(4307);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=i.default(e.request)),r.makeServiceRequest("GetExtensibilityContext",e,t)}},4307:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetExtensibilityContextParameters:#Exchange"},e)}},4308:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),i=n(4309);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetAllClientExtensionsNotifications",e,t)}},4309:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAllClientExtensionsNotificationsJsonRequest:#Exchange"},e)}},4310:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAllClientExtensionsNotificationsRequest:#Exchange"},e)}},4311:function(e,t,n){var r=n(4312),i=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},4312:function(e,t,n){var r=n(871);(t=e.exports=n(35)(!1)).push([e.i,"._3vfuEgb3IQrqM2T_xifSIS.ms-Panel{top:48px}._3vfuEgb3IQrqM2T_xifSIS.ms-Panel .ms-Panel-contentInner{top:40px;position:absolute;overflow:visible}._3vfuEgb3IQrqM2T_xifSIS.ms-Panel .ms-Panel-contentInner .ms-Panel-content{height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;position:relative;min-height:400px;overflow:visible}html[dir] ._3vfuEgb3IQrqM2T_xifSIS.ms-Panel .ms-Panel-contentInner .ms-Panel-content{padding-bottom:0}html[dir=ltr] ._3vfuEgb3IQrqM2T_xifSIS.ms-Panel .ms-Panel-contentInner .ms-Panel-content,html[dir=rtl] ._3vfuEgb3IQrqM2T_xifSIS.ms-Panel .ms-Panel-contentInner .ms-Panel-content{padding-left:0;padding-right:0}._3vfuEgb3IQrqM2T_xifSIS.ms-Panel .ms-Panel-main{width:955px!important}html[dir=ltr] ._3vfuEgb3IQrqM2T_xifSIS.ms-Panel .ms-Panel-main{right:0!important;left:auto!important}html[dir=rtl] ._3vfuEgb3IQrqM2T_xifSIS.ms-Panel .ms-Panel-main{left:0!important;right:auto!important}.u_bxF17azZ5o9VLzMTSV-{display:-webkit-box;display:-ms-flexbox;display:flex;height:calc(100vh - 80px);width:950px;overflow:hidden}._2OR7T4GMkgEKDKdO5dk8ph{position:absolute;top:6px;z-index:1000;cursor:pointer}html[dir] ._2OR7T4GMkgEKDKdO5dk8ph{background:none}html[dir=ltr] ._2OR7T4GMkgEKDKdO5dk8ph{left:901px}html[dir=rtl] ._2OR7T4GMkgEKDKdO5dk8ph{right:901px}._1b0Umj5BNiUthUttlSg00M{height:100%;width:100%}html[dir] ._1b0Umj5BNiUthUttlSg00M{background:url("+r(n(3434))+");background-repeat:no-repeat;background-position:50%;padding-top:17px}._1lNE4erFNhpvihMADuR0KX{top:11px;z-index:1;position:absolute;cursor:pointer}html[dir=ltr] ._1lNE4erFNhpvihMADuR0KX{right:73px}html[dir=rtl] ._1lNE4erFNhpvihMADuR0KX{left:73px}._6_QFPxEhjNxmC2Pa9m2wT{height:100%;width:100%}html[dir] ._6_QFPxEhjNxmC2Pa9m2wT{background:url("+r(n(3434))+");background-repeat:no-repeat;background-position:50%}._3QkvxH49g3ojiuxMtru4vc{top:-29px;z-index:1;position:absolute;cursor:pointer}html[dir=ltr] ._3QkvxH49g3ojiuxMtru4vc{right:73px}html[dir=rtl] ._3QkvxH49g3ojiuxMtru4vc{left:73px}",""]),t.locals={inClientStorePanelContainer:"_3vfuEgb3IQrqM2T_xifSIS",container:"u_bxF17azZ5o9VLzMTSV-",closeButton:"_2OR7T4GMkgEKDKdO5dk8ph",inClientStoreIFrameCenter:"_1b0Umj5BNiUthUttlSg00M",FeedbackCommandBarCenter:"_1lNE4erFNhpvihMADuR0KX",inClientStoreIFrame:"_6_QFPxEhjNxmC2Pa9m2wT",FeedbackCommandBar:"_3QkvxH49g3ojiuxMtru4vc"}},4313:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"DisableExtensionJsonRequest:#Exchange"},e)}},4314:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),i=n(4315);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("DisableExtension",e,t)}},4315:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"DisableExtensionJsonRequest:#Exchange"},e)}},4316:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UninstallExtensionJsonRequest:#Exchange"},e)}},4317:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),i=n(4318);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("UninstallExtension",e,t)}},4318:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UninstallExtensionJsonRequest:#Exchange"},e)}},4319:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"EnableAppDataRequest:#Exchange"},e)}},4320:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),i=n(4321);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("EnableApp",e,t)}},4321:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"EnableAppDataRequest:#Exchange"},e)}},4322:function(e,t,n){var r=n(4323),i=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},4323:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,"._3xP4jwI3q_T6E7xuv-FVWe{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;max-width:510px}html[dir] ._3xP4jwI3q_T6E7xuv-FVWe{margin:30px}",""]),t.locals={divContainer:"_3xP4jwI3q_T6E7xuv-FVWe"}},4324:function(e,t,n){var r=n(4325),i=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},4325:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,"._3gIWKkd66RhEGU2eEhXYKL{display:none}.Dogv8HUwc_fEU5PciD8R7{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);max-width:none!important}html[dir] .Dogv8HUwc_fEU5PciD8R7{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white)}",""]),t.locals={divContainer:"_3gIWKkd66RhEGU2eEhXYKL",dialogContainer:"Dogv8HUwc_fEU5PciD8R7"}},4326:function(e,t,n){var r=n(4327),i=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},4327:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'._3KHqwEvkiXZwaO9J1IOBKy{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary)}html[dir] ._3KHqwEvkiXZwaO9J1IOBKy{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white)}._3KHqwEvkiXZwaO9J1IOBKy .ms-Callout-main{overflow:hidden!important}._2z7ltMDjH8B0brbQRbPYmI{height:32px!important;color:inherit}html[dir] ._2z7ltMDjH8B0brbQRbPYmI{background-color:transparent}._2z7ltMDjH8B0brbQRbPYmI .ms-Button{height:32px}._2TIhzrpeS7H0cZ1D5fKh5W .ms-Button-label,._2z7ltMDjH8B0brbQRbPYmI .is-expanded .ms-CommandBarItem-overflow{color:"[theme:themePrimary, default:#0078D7]"!important}._278NcH_rzHCir3xNrGzVJ4{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._278NcH_rzHCir3xNrGzVJ4{padding:8px}html[dir=ltr] ._278NcH_rzHCir3xNrGzVJ4{float:left}html[dir=rtl] ._278NcH_rzHCir3xNrGzVJ4{float:right}._6ZO0J-SQTgh8L0ZqDbOz1{height:16px;width:0}html[dir] ._6ZO0J-SQTgh8L0ZqDbOz1{padding:0;margin:8px 0;border-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"!important}html[dir=ltr] ._6ZO0J-SQTgh8L0ZqDbOz1{border-right-width:1px;border-right-style:solid;float:left}html[dir=rtl] ._6ZO0J-SQTgh8L0ZqDbOz1{border-left-width:1px;border-left-style:solid;float:right}._3bRzyCMz2Ze5xCTvDpTGd9{width:570px;max-height:450px;min-height:32px}html[dir] ._3bRzyCMz2Ze5xCTvDpTGd9{border-top-style:solid;border-top-width:1px;border-top-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}',""]),t.locals={divContainer:"_3KHqwEvkiXZwaO9J1IOBKy",contextualBar:"_2z7ltMDjH8B0brbQRbPYmI",selected:"_2TIhzrpeS7H0cZ1D5fKh5W",appIcon:"_278NcH_rzHCir3xNrGzVJ4",divider:"_6ZO0J-SQTgh8L0ZqDbOz1",contextualAddinFrame:"_3bRzyCMz2Ze5xCTvDpTGd9"}},4328:function(e,t,n){var r=n(4329),i=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},4329:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'._2p1N7p98Pe0ELLwawCRyVC{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);height:100%;width:100%}html[dir] ._2p1N7p98Pe0ELLwawCRyVC{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white)}._1touFx4573Kl_KFD0cvq3x{position:relative;top:25%}html[dir] ._1touFx4573Kl_KFD0cvq3x{text-align:center}._16PcyVLKG3f1GnOiwcPrSw{display:inline-block;font-size:80px;line-height:1;color:"[theme:themePrimary, default:#0078D7]"}html[dir] ._16PcyVLKG3f1GnOiwcPrSw{text-align:center}._10THEo2s-crtEO5ngrjRV0{display:block;max-width:70%}html[dir] ._10THEo2s-crtEO5ngrjRV0{margin:auto}._947p-qACNSxRgYHD2MWDp{font-size:17px;font-weight:300;color:"[theme:neutralPrimary, default:#333333]"}html[dir] ._947p-qACNSxRgYHD2MWDp{padding-top:25px}._2lLE5Scn3cVQNXWzg4wcfd{font-size:12px;font-weight:400;color:"[theme:neutralSecondary, default:#666666]"}html[dir] ._2lLE5Scn3cVQNXWzg4wcfd{padding-top:10px}',""]),t.locals={errorContainer:"_2p1N7p98Pe0ELLwawCRyVC",errorContent:"_1touFx4573Kl_KFD0cvq3x",errorIcon:"_16PcyVLKG3f1GnOiwcPrSw",errorTextCommon:"_10THEo2s-crtEO5ngrjRV0",errorTextTitle:"_947p-qACNSxRgYHD2MWDp",errorTextDescription:"_2lLE5Scn3cVQNXWzg4wcfd"}},4330:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'.aOoPXSDEeWhe4AsQkIFi-{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:70px}html[dir] .aOoPXSDEeWhe4AsQkIFi-{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white);padding:0 22px;padding-top:10px}.sWCWzo3SlWk1Fbm3LigaM{height:60px}html[dir] .sWCWzo3SlWk1Fbm3LigaM{padding:0 32px;padding-top:10px}html[dir=ltr] .sWCWzo3SlWk1Fbm3LigaM{padding-right:36px}html[dir=rtl] .sWCWzo3SlWk1Fbm3LigaM{padding-left:36px}.suSANjptUnSiXbyWbQoAN{position:static}html[dir=ltr] .suSANjptUnSiXbyWbQoAN{margin-right:-10px;right:0}html[dir=rtl] .suSANjptUnSiXbyWbQoAN{margin-left:-10px;left:0}.dYpO2Atoru5JqXmolHg3Y{font-size:32px;color:"[theme:neutralSecondary, default:#666666]";width:32px;height:32px;min-width:32px}html[dir] .dYpO2Atoru5JqXmolHg3Y{border:0;padding:0}html[dir=ltr] .dYpO2Atoru5JqXmolHg3Y{float:left}html[dir=rtl] .dYpO2Atoru5JqXmolHg3Y{float:right}._2298CYyghZxjywlVmIKH60{color:"[theme:neutralTertiary, default:#a6a6a6]"}.torAcvin6pOkh3fM-lcn0{font-size:21px;font-weight:100;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:"[theme:neutralPrimary, default:#333333]";overflow:hidden;white-space:nowrap;text-overflow:ellipsis}html[dir=ltr] .torAcvin6pOkh3fM-lcn0{float:left;margin-left:8px}html[dir=rtl] .torAcvin6pOkh3fM-lcn0{float:right;margin-right:8px}._2nXa4dCQobTYJGRuY8-SY1{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}._39GjpY1Rh2dM1sYT3AEMGx{white-space:nowrap}.LJgl3KnauiXBDWBN5oMxK{color:"[theme:neutralPrimary, default:#333333]"}',""]),t.locals={addinPaneHeader:"aOoPXSDEeWhe4AsQkIFi-",addinPaneHeaderCalendar:"sWCWzo3SlWk1Fbm3LigaM",closeButton:"suSANjptUnSiXbyWbQoAN",addinPaneIcon:"dYpO2Atoru5JqXmolHg3Y",fallbackIcon:"_2298CYyghZxjywlVmIKH60",addinPaneLabelText:"torAcvin6pOkh3fM-lcn0",ellipsis:"_2nXa4dCQobTYJGRuY8-SY1",rightButtons:"_39GjpY1Rh2dM1sYT3AEMGx",persistIcon:"LJgl3KnauiXBDWBN5oMxK"}},4331:function(e,t,n){var r=n(4332),i=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},4332:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,"._3orVsetp1eAGYITgglQimL .ms-Panel-content{height:100%;overflow-y:hidden}html[dir] ._3orVsetp1eAGYITgglQimL .ms-Panel-content{padding:0}._3orVsetp1eAGYITgglQimL .ms-Panel-main{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);top:48px;height:calc(100% - 48px);width:320px!important}html[dir] ._3orVsetp1eAGYITgglQimL .ms-Panel-main{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white)}html[dir=ltr] ._3orVsetp1eAGYITgglQimL .ms-Panel-main{left:calc(100vw - 322px)!important}html[dir=rtl] ._3orVsetp1eAGYITgglQimL .ms-Panel-main{right:calc(100vw - 322px)!important}._3w1qhg7Ld8hKbR2775XP36 .ms-Panel-main{top:0;height:100%}._3orVsetp1eAGYITgglQimL .ms-Panel-contentInner{height:100%}._3orVsetp1eAGYITgglQimL{height:100%;overflow-y:hidden}",""]),t.locals={taskPane:"_3orVsetp1eAGYITgglQimL",taskPaneNoHeader:"_3w1qhg7Ld8hKbR2775XP36"}},4333:function(e,t,n){var r=n(4334),i=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},4334:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,"._3f8hSCx90KR8PdFgtKVrO1{display:none}._23tb8CVHCnUDDFkVDgxd4P{width:100%;height:calc(100% - 80px)}._32zX-5xzJ0bB-9fnbzCi8{height:calc(100% - 70px)}._1-Zb1kdsIT0TH-tqllITZt{display:block;top:0;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box}._1-Zb1kdsIT0TH-tqllITZt iframe{max-height:100%}.cCBF3889jOoLxnYmkz0m1{display:none}",""]),t.locals={divContainer:"_3f8hSCx90KR8PdFgtKVrO1",extensionContainer:"_23tb8CVHCnUDDFkVDgxd4P",extensionContainerCalendar:"_32zX-5xzJ0bB-9fnbzCi8",extensionHost:"_1-Zb1kdsIT0TH-tqllITZt",hide:"cCBF3889jOoLxnYmkz0m1"}},4335:function(e,t,n){var r=n(4336),i=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},4336:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,".irsQ4tcHIYF7j2-9I7hSH{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);max-width:none}html[dir] .irsQ4tcHIYF7j2-9I7hSH{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white)}._3mJFbK82bUni5JBJIUUF4d{height:190px}.AJomCIJmHLmR3UUfMp83L{width:550px;height:400px}.h6gOJ_o08N0FHHEIB36uM{display:none!important}",""]),t.locals={dialogContainer:"irsQ4tcHIYF7j2-9I7hSH",uiLessContainer:"_3mJFbK82bUni5JBJIUUF4d",consentContainer:"AJomCIJmHLmR3UUfMp83L",hiddenContainer:"h6gOJ_o08N0FHHEIB36uM"}},4337:function(e,t,n){var r=n(4338),i=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},4338:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,".utBIuEhQQ51evhMmy1bag{width:100%;height:100%}",""]),t.locals={uiLessContainer:"utBIuEhQQ51evhMmy1bag"}},4339:function(e,t,n){var r=n(4340),i=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},4340:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,".ms-ContextualMenu-icon ._3BwehfCUyRD_TY1pDQQpUQ{position:relative;top:-8px}",""]),t.locals={fallbackIcon:"_3BwehfCUyRD_TY1pDQQpUQ"}},527:function(e,t,n){"use strict";var r=n(1842),i=n(2081),a=n(41),o={root:"ms-Dialog"};n.d(t,"a",function(){return s});var s=Object(r.a)(i.a,function(e){var t,n=e.className,r=e.containerClassName,i=e.dialogDefaultMinWidth,s=void 0===i?"288px":i,l=e.dialogDefaultMaxWidth,c=void 0===l?"340px":l,u=e.hidden,d=e.theme;return{root:[Object(a.getGlobalClassNames)(o,d).root,n],main:[{width:s,selectors:(t={},t["@media (min-width: "+a.ScreenWidthMinMedium+"px)"]={width:"auto",maxWidth:c,minWidth:s},t)},!u&&{display:"flex"},r]}},void 0,{scope:"Dialog"})},596:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(110),i=n(72);function a(){var e;return(e={})[i.a.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[i.a.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[i.a.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(r.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddInlineImage","AddEmoji","ToggleRibbon"],composeSurfaceAddins:[]},e[i.a.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[i.a.Confetti]={confettiEnabled:!0},e[i.a.GdprAdsPrefs]={feature:i.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[i.a.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e}},598:function(e,t,n){"use strict";var r,i=n(72),a=n(940),o=n(3);t.a=Object(o.createStore)("owsOptionsStore",{options:(r={},r[i.a.SmartSuggestions]={feature:i.a.SmartSuggestions,smartSuggestionsEnabled:!1,browserLocationEnabled:!1},r[i.a.DiverseEmojis]={feature:i.a.DiverseEmojis,diverseEmojisSelectedSkinTone:""},r[i.a.SurfaceActions]={feature:i.a.SurfaceActions,readSurfaceActions:[],readSurfaceAddins:[],composeSurfaceActions:[],composeSurfaceAddins:[]},r[i.a.SkypeNotifications]={feature:i.a.SkypeNotifications,skypeMessageNotification:1,skypeCallingNotification:1},r[i.a.WebPushNotifications]={feature:i.a.WebPushNotifications,enabled:!1,applicationServerKey:null},r[i.a.Confetti]={feature:i.a.Confetti,confettiEnabled:!1},r[i.a.GdprAdsPrefs]={feature:i.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},r[i.a.CalendarSurfaceAddins]={feature:i.a.CalendarSurfaceAddins,calendarSurfaceAddins:[]},r),loadState:a.a.OptionsNotLoaded})()},72:function(e,t,n){"use strict";var r,i;n.d(t,"a",function(){return r}),(i=r||(r={}))[i.TestFeature=1]="TestFeature",i[i.SmartSuggestions=2]="SmartSuggestions",i[i.DiverseEmojis=4]="DiverseEmojis",i[i.SurfaceActions=5]="SurfaceActions",i[i.SkypeNotifications=6]="SkypeNotifications",i[i.WebPushNotifications=7]="WebPushNotifications",i[i.Confetti=8]="Confetti",i[i.GdprAdsPrefs=9]="GdprAdsPrefs",i[i.CalendarSurfaceAddins=10]="CalendarSurfaceAddins"},883:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(25),i=n(138),a=n(369);function o(e,t,n){var o=Object(r.h)("fwk-pathBasedRouter")?{pathname:e+t,search:n}:{pathname:e,search:n,hash:"/"+a.c+"/"+t};return i.format(o)}},934:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(41),i=n(1839),a=n(212),o=Object(i.b)(function(e,t){var n,i=Object(a.a)(e),o={root:{padding:"0 4px",height:"40px",color:e.palette.neutralPrimary,backgroundColor:"transparent",border:"none"},rootHovered:{color:e.palette.themePrimary,selectors:(n={},n[r.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},n)},iconHovered:{color:e.palette.themePrimary},rootPressed:{color:e.palette.black},rootExpanded:{color:e.palette.themePrimary},iconPressed:{color:e.palette.themeDarker},rootDisabled:{color:e.palette.neutralTertiary,backgroundColor:"transparent"},rootChecked:{color:e.palette.black},iconChecked:{color:e.palette.themeDarker},flexContainer:{justifyContent:"flex-start"},icon:{color:e.palette.themeDarkAlt},iconDisabled:{color:"inherit"},menuIcon:{color:e.palette.neutralSecondary},textContainer:{flexGrow:0}};return Object(r.concatStyleSets)(i,o,t)})},935:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(598);function i(e){return r.a.options[e]}},94:function(e,t,n){"use strict";var r,i;n.d(t,"a",function(){return r}),(i=r||(r={}))[i.normal=0]="normal",i[i.largeHeader=1]="largeHeader",i[i.close=2]="close"},940:function(e,t,n){"use strict";var r,i;n.d(t,"a",function(){return r}),(i=r||(r={}))[i.OptionsNotLoaded=0]="OptionsNotLoaded",i[i.OptionsLoading=1]="OptionsLoading",i[i.OptionsLoaded=2]="OptionsLoaded"},941:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(3),i=n(596),a=Object(r.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",function(e){return void 0===e&&(e=Object(i.a)()),{defaultOptions:e}})},96:function(e,t,n){"use strict";n.r(t),n.d(t,"ActionButton",function(){return c});var r=n(0),i=n(1),a=n(95),o=n(1825),s=n(1634),l=n(934),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._skipComponentRefResolution=!0,t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme;return i.createElement(a.a,r.__assign({},this.props,{variantClassName:"ms-Button--action ms-Button--command",styles:Object(l.a)(n,t),onRenderDescription:o.b}))},t=r.__decorate([Object(s.b)("ActionButton",["theme","styles"],!0)],t)}(o.a)}}]);
//# sourceMappingURL=owa.vendors~Addins~addins-marketplace.js.map
window.scriptsLoaded['owa.vendors~Addins~addins-marketplace.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.vendors~Addins~addins-marketplace.js'] = (new Date()).getTime();