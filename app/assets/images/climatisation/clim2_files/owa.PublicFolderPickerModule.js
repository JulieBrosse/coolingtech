window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.PublicFolderPickerModule.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[128],{2035:function(e,r,t){"use strict";t.r(r);var o=t(0),n=t(1),i=t(3740),a=t(1900),l=t(1667),d=t(3),c=Object(d.createStore)("publicFolderPickerStore",{showPanel:!1,selectedFolderId:null,showErrorDialog:!1})(),s=Object(d.action)("updateResponseMessageInPicker",function(e,r){return{responseMessageInPicker:e,isResponseError:r}}),u=Object(d.action)("selectPublicFolderNode",function(e){return{folderId:e}}),p=Object(d.action)("publicFolderPickerController",function(e){return{showPanel:e}}),f=Object(d.action)("shouldShowPublicFolderErrorDialog",function(e){return{shouldShow:e}}),h=t(14),F=t(280),b=Object(d.action)("LOAD_PUBLIC_FOLDERS",function(e){return{folderId:e}}),m=Object(d.action)("LOAD_FIRST_LEVEL_PUBLIC_FOLDERS",function(e){return{folderId:e}}),v=Object(d.action)("processFindFolderResponse",function(e){return{responseMessage:e}}),I=Object(d.action)("addChildFolderIdToParentFolder",function(e,r){return{parentFolder:e,childFolderId:r}}),_=Object(d.action)("togglePublicFolderNodeExpansion",function(e){return{folder:e}}),g={folderTable:new(t(21).a)({}),rootFolder:null},O=Object(d.createStore)("publicFolderTable",g)();function y(e){return O.folderTable.get(e)}var P=t(3100),T=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.renderMyTreeNodeDisplay=function(e){switch(e.FolderClass){case"IPF.Note":case"IPF.Appointment":case"IPF.Contact":return n.createElement("span",null," ",e.DisplayName," ");default:return n.createElement("span",{className:P.greyed}," ",e.DisplayName," ")}},r.onChevronClicked=function(e){e.stopPropagation(),_(r.folder),r.folder.isExpanded&&b(r.props.folderId)},r.isFolderExpandable=function(e){return null==e||0!=e.ChildFolderCount},r.onClick=function(e){u(r.folder.FolderId.Id)},r}return o.__extends(r,e),Object.defineProperty(r.prototype,"folder",{get:function(){return y(this.props.folderId)},enumerable:!0,configurable:!0}),r.prototype.render=function(){var e=this,r=this.getChevronProps(this.folder);return n.createElement(F.a,{chevronProps:r,customIcon:this.getIconFromType(this.folder.FolderClass),depth:this.props.depth,displayName:this.folder.DisplayName,key:this.props.folderId,isRootNode:!1,onClick:this.onClick,isSelected:this.folder.FolderId.Id==c.selectedFolderId,renderCustomTreeNodeDisplay:function(){return e.renderMyTreeNodeDisplay(e.folder)}})},r.prototype.getIconFromType=function(e){switch(e){case"IPF.Note":return"Mail";case"IPF.Appointment":return"Calendar";case"IPF.Contact":return"Contact";default:return"FabricFolder"}},r.prototype.getChevronProps=function(e){return this.isFolderExpandable(e)?{isExpanded:e.isExpanded,onClick:this.onChevronClicked}:null},r=o.__decorate([h.observer],r)}(n.Component),E=t(96),j=t(524),w=Object(d.action)("ADD_PUBLIC_FOLDER_TO_FAVORITES",function(e){return{folderId:e}}),C=t(2519),x=t.n(C),N=Object(d.createStore)("publicFolderPickerHeaderState",{isResponseError:!1,responseMessage:null})(),D=t(3100),R=Object(h.observer)(function(){return n.createElement(n.Fragment,null,n.createElement("p",{className:N.isResponseError?D.errorText:D.headerText},N.responseMessage),n.createElement("div",{className:D.headerTitle},x.a.publicFolderPickerHeaderText),n.createElement("p",{className:D.headerText},x.a.publicFolderPickerSubHeaderText))}),k=Object(d.action)("addFolderToPublicFolderTable",function(e){return{item:e}}),A=Object(d.action)("addRootFolderToPublicFolderTable",function(e){return{rootFolder:e}}),S=Object(d.action)("clearPublicFolderTable",function(){return{}}),L=t(527),B=t(94),M=t(220),V=t(525),Y=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.closeDialog=function(){f(!1)},r}return o.__extends(r,e),r.prototype.render=function(){return n.createElement(L.a,{hidden:this.props.isHidden,onDismiss:this.closeDialog,dialogContentProps:{type:B.a.normal,title:x.a.errorPublicFolderNotAvailableDialogBoxTitle,subText:x.a.errorPublicFolderNotAvailableDialogBoxBody}},n.createElement(M.a,null,n.createElement(V.a,{onClick:this.closeDialog,text:x.a.okButton})))},r=o.__decorate([h.observer],r)}(n.Component),H=t(4588),W=t.n(H);function K(){return O.rootFolder}var G=t(3100),Q=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.onRootNodeChevronClicked=function(e){e.stopPropagation(),_(K())},r.addToFavorites=function(e){null!=c.selectedFolderId&&w(c.selectedFolderId)},r}return o.__extends(r,e),r.prototype.render=function(){var e=this,r=K(),t=this.getChildFolders(r);return n.createElement("div",null,n.createElement(i.a,{isOpen:c.showPanel,onDismiss:this._closePanel,isLightDismiss:!0,onLightDismissClick:this._closePanel,type:a.a.largeFixed,onRenderHeader:function(){return n.createElement(R,null)},onRenderNavigation:function(){return e.renderTopRibbon()}},n.createElement("div",null,c.showPanel&&r&&this.renderFolderRoot(r),c.showPanel&&t.length>0&&this.renderChildFolders(t,0))),n.createElement(Y,{isHidden:!c.showErrorDialog}))},r.prototype.renderTopRibbon=function(){return n.createElement("div",null,n.createElement(E.ActionButton,{className:G.addToFavoriteButton,onClick:this.addToFavorites,iconProps:{iconName:"FavoriteStar"}},x.a.addToFavoritesButtonText),n.createElement(j.IconButton,{className:G.closeButton,disabled:!1,checked:!1,onClick:this._closePanel,iconProps:{iconName:"Cancel"},title:W.a.closeButton,ariaLabel:W.a.closeButton}))},r.prototype.renderFolderRoot=function(e){var r={isExpanded:e.isExpanded,onClick:this.onRootNodeChevronClicked},t=e.FolderId.Id;return n.createElement("div",null,n.createElement(F.a,{chevronProps:r,depth:0,displayName:x.a.allPublicFoldersDisplayName,isRootNode:!0,key:t,onClick:r.onClick}))},r.prototype.getChildFolders=function(e){var r=[];return e&&e.childFolderIds&&e.childFolderIds.map(function(e){var t=y(e);t&&r.push(t.FolderId.Id)}),r},r.prototype.renderChildFolders=function(e,r){var t=this,o=[];if(0==r){if(K().isExpanded){var n=this.renderChildFolders(e,r+2);Array.prototype.push.apply(o,n)}}else e.forEach(function(e){var n=y(e);if(o.push(t.renderFolderNode(n,r)),n.isExpanded&&n.childFolderIds&&n.childFolderIds.length>0){var i=t.renderChildFolders(n.childFolderIds,r+1);Array.prototype.push.apply(o,i)}});return o},r.prototype.renderFolderNode=function(e,r){return n.createElement("div",null,n.createElement(T,{depth:r,folderId:e.FolderId.Id,key:e.FolderId.Id}))},r.prototype._closePanel=function(){p(!1),S()},o.__decorate([l.a],r.prototype,"_closePanel",null),r=o.__decorate([h.observer],r)}(n.Component),U=Object(d.action)("REMOVE_PUBLIC_FOLDER_FROM_FAVORITES",function(e){return{folder:e}}),X=(Object(d.orchestrator)(v,function(e){var r=e.responseMessage;if(r){var t=[];r.RootFolder.Folders.forEach(function(e){k(e),t.push(e.FolderId)}),K()||(k(r.RootFolder.ParentFolder),A(y(r.RootFolder.ParentFolder.FolderId.Id))),t.forEach(function(e){var r=y(e.Id),t=y(r.ParentFolderId.Id);t&&!r.isHidden&&I(t,e.Id)})}else s(x.a.errorCantLoadPublicFolderListText,!0)}),t(323)),z=t.n(X),q=t(324),Z=t.n(q),J=t(71),$=t.n(J),ee=t(347),re=t.n(ee),te=t(30),oe=t(6);var ne=t(108),ie=t.n(ne);function ae(e){var r,t={headers:{"X-OWA-ExplicitLogonUser":r=Object(oe.a)().SessionSettings.DefaultPublicFolderMailbox,"X-AnchorMailbox":r}};return z()({Header:Object(te.getJsonRequestHeader)(),Body:Z()({FolderShape:re()({BaseShape:"IdOnly"}),Paging:null,ParentFolderIds:["publicfoldersroot"==e?ie()({Id:e}):$()({Id:e})],ReturnParentFolder:!0,ShapeName:"Folder",Traversal:"Shallow"})},t).then(function(e){return e.Body.ResponseMessages.Items[0]}).catch(function(){return null})}Object(d.orchestrator)(b,function(e){return o.__awaiter(void 0,void 0,void 0,function(){var r;return o.__generator(this,function(t){switch(t.label){case 0:return 0!=y(e.folderId).childFolderIds.length?[3,2]:[4,ae(e.folderId)];case 1:r=t.sent(),v(r),t.label=2;case 2:return[2]}})})}),Object(d.orchestrator)(m,function(e){return o.__awaiter(void 0,void 0,void 0,function(){var r;return o.__generator(this,function(t){switch(t.label){case 0:return[4,ae(e.folderId)];case 1:return(r=t.sent())?(v(r),p(!0)):f(!0),[2]}})})});var le=t(18),de=t(8),ce=t(31),se=t(2797),ue=t(2977),pe=t(104),fe=t(1268),he=t(898),Fe=t(1269),be=t(92),me=t(26),ve=t(112);Object(d.orchestrator)(w,function(e){return o.__awaiter(void 0,void 0,void 0,function(){var r,t;return o.__generator(this,function(n){switch(n.label){case 0:switch(r=y(e.folderId),t=null,r.FolderClass){case"IPF.Note":t=Object(le.format)(x.a.folderAddedToMailFavoritesText,r.DisplayName);break;case"IPF.Appointment":t=Object(le.format)(x.a.folderAddedToCalendarFavoritesText,r.DisplayName);break;case"IPF.Contact":t=Object(le.format)(x.a.folderAddedToPeopleFavoritesText,r.DisplayName)}switch(r.FolderClass){case"IPF.Note":case"IPF.Appointment":case"IPF.Contact":return[3,1]}return[3,3];case 1:return[4,function(e){return o.__awaiter(this,void 0,void 0,function(){var r;return o.__generator(this,function(t){switch(t.label){case 0:return r=!1,Object(de.c)("tri-favorites-roaming")?[4,function(e){return o.__awaiter(this,void 0,void 0,function(){var r,t,n,i=this;return o.__generator(this,function(a){switch(a.label){case 0:return r=Object(pe.getGuid)(),d=!1,function(e){if(0===he.a.folderTable.size)return!0;return!he.a.folderTable.has(e.publicFolderId)}(t={treeType:"favorites",type:"publicFolder",favoriteId:r,displayName:(l=e).DisplayName,publicFolderId:l.FolderId.Id,client:d?"Migration":"OWA"})?(Object(fe.a)(he.a,e),[4,ce.K.import()]):[3,2];case 1:return a.sent()(t),n=Object(ue.a)(e,!1),[2,Object(ce.i)(n).then(function(r){return o.__awaiter(i,void 0,void 0,function(){var n;return o.__generator(this,function(o){switch(o.label){case 0:return n=Object(ce.f)(r,"publicFolder"),n.publicFolderId=e.FolderId.Id,[4,ce.G.import()];case 1:return o.sent()(t,n),[2,r]}})})}).catch(function(e){return o.__awaiter(i,void 0,void 0,function(){return o.__generator(this,function(r){switch(r.label){case 0:return[4,ce.H.import()];case 1:return r.sent()(e.message,t),[2,null]}})})})];case 2:return[2,null]}var l,d})})}(e)]:[3,2];case 1:return t.sent()&&(r=!0),[3,4];case 2:return[4,Object(se.a)(e,!0)];case 3:t.sent().WasSuccessful&&(r=!0,Object(ce.eb)()),t.label=4;case 4:return[2,r]}})})}(r)];case 2:return n.sent()?s(t,!1):s(x.a.errorCantAddToFavoritesText,!0),[3,4];case 3:return s(x.a.errorFolderTypeInvalidText,!0),[3,4];case 4:return[2]}})})}),Object(d.orchestrator)(U,function(e){return o.__awaiter(void 0,void 0,void 0,function(){var r,t,n,i,a=this;return o.__generator(this,function(l){switch(l.label){case 0:return r=e.folder,t=r.FolderId.Id,n=Object(ce.p)(t),i=Object(ce.m)(n,6),t==Object(be.b)()&&Object(ve.n)(Object(me.a)("inbox"),"primaryFolderTree"),[4,ce.S.import()];case 1:return l.sent()(i),Object(Fe.a)(t),[2,Object(ce.k)(n).then(function(){return o.__awaiter(a,void 0,void 0,function(){return o.__generator(this,function(e){switch(e.label){case 0:return[4,ce.Q.import()];case 1:return e.sent()(i),[2]}})})}).catch(function(e){return o.__awaiter(a,void 0,void 0,function(){return o.__generator(this,function(r){switch(r.label){case 0:return[4,ce.R.import()];case 1:return r.sent()(e.message,i),[2]}})})})]}})})}),Object(d.mutator)(I,function(e){e.parentFolder.childFolderIds.push(e.childFolderId)}),Object(d.mutator)(_,function(e){var r=e.folder;r.isExpanded=!r.isExpanded}),Object(d.mutator)(p,function(e){var r=e.showPanel;c.showPanel=r,r||(c.selectedFolderId=null,N.isResponseError=!1,N.responseMessage=null)}),Object(d.mutator)(u,function(e){var r=e.folderId;c.selectedFolderId==r?c.selectedFolderId=null:c.selectedFolderId=r}),Object(d.mutator)(s,function(e){var r=e.responseMessageInPicker,t=e.isResponseError;N.responseMessage=r,N.isResponseError=t}),Object(d.mutator)(f,function(e){var r=e.shouldShow;c.showErrorDialog=r});function Ie(e,r){if(e.ExtendedProperty)for(var t=0;t<e.ExtendedProperty.length;t++){var o=e.ExtendedProperty[t];if(o.ExtendedFieldURI.PropertyTag===r||o.ExtendedFieldURI.PropertyName===r)return JSON.parse(o.Value)}}Object(d.mutator)(k,function(e){var r,t,n=e.item,i=n.FolderId.Id,a=n.DistinguishedFolderId?n.DistinguishedFolderId:void 0,l=o.__assign({isExpanded:!1,childFolderIds:[],distinguishedFolderId:a,UnreadCount:n.UnreadCount,TotalCount:n.TotalCount,isHidden:(t=n,Ie(t,"0x10f4")),sourceWellKnownFolderType:(r=n,parseInt(Ie(r,"SourceWellKnownFolderType"),10))},n);O.folderTable.set(i,l)}),Object(d.mutator)(A,function(e){var r=e.rootFolder;O.rootFolder=r}),Object(d.mutator)(S,function(e){O.folderTable.clear(),O.rootFolder=null}),t.d(r,"PublicFolderPicker",function(){return Q}),t.d(r,"loadPublicFolders",function(){return m}),t.d(r,"removePublicFolderFromFavorites",function(){return U})},2797:function(e,r,t){"use strict";t.d(r,"a",function(){return u});var o=t(351),n=t.n(o),i=t(71),a=t.n(i),l=t(2660),d=t.n(l),c=t(2976),s=t.n(c);function u(e,r){var t,o,i,l=(t=e,o=r,i=a()({Id:t.FolderId.Id,ChangeKey:t.FolderId.ChangeKey}),d()({Folder:n()({FolderId:i,DisplayName:t.DisplayName}),Operation:o?0:1}));return s()({request:l}).then(function(e){return e})}},2798:function(e,r,t){"use strict";var o=t(3);r.a=Object(o.action)("ADD_FAVORITE_FOLDER_V2",function(e){return{folderIdToAdd:e}})},2977:function(e,r,t){"use strict";t.d(r,"a",function(){return c});var o=t(0),n=t(2798),i=t(12),a=t(104),l=t(3),d=t(31);Object(l.orchestrator)(n.a,function(e){return o.__awaiter(void 0,void 0,void 0,function(){var r,t,n,l,s,u=this;return o.__generator(this,function(p){switch(p.label){case 0:return r=e.folderIdToAdd,t=i.n.folderTable.get(r),n=Object(a.getGuid)(),h=!1,l={treeType:"favorites",type:"folder",favoriteId:n,displayName:(f=t).DisplayName,folderId:f.FolderId.Id,client:h?"Migration":"OWA"},[4,d.K.import()];case 1:return p.sent()(l),s=c(t,!1),Object(d.i)(s).then(function(e){return o.__awaiter(u,void 0,void 0,function(){var r;return o.__generator(this,function(t){switch(t.label){case 0:return r=Object(d.f)(e,"folder"),[4,d.G.import()];case 1:return t.sent()(l,r),[2]}})})}).catch(function(e){return o.__awaiter(u,void 0,void 0,function(){return o.__generator(this,function(r){switch(r.label){case 0:return[4,d.H.import()];case 1:return r.sent()(e.message,l),[2]}})})}),[2]}var f,h})})});function c(e,r){return{Type:"folder",DisplayName:e.DisplayName,SingleValueSettings:[{Key:"FolderId",Value:Object(d.c)(e.FolderId.Id)}],Client:r?"Migration":"OWA"}}},3100:function(e,r,t){var o=t(4587),n=t(33);"string"==typeof o&&(o=[[e.i,o]]);for(var i=0;i<o.length;i++)n.loadStyles(o[i][1],!1);o.locals&&(e.exports=o.locals)},4587:function(e,r,t){(r=e.exports=t(35)(!1)).push([e.i,'html[dir=ltr] ._2V36xsu2ipdYgOeX4-A1nj{float:right;margin-right:5px}html[dir=rtl] ._2V36xsu2ipdYgOeX4-A1nj{float:left;margin-left:5px}html[dir=ltr] .WYNo4I7wwY8SAkVCo9vzi{float:left;margin-left:15px}html[dir=rtl] .WYNo4I7wwY8SAkVCo9vzi{float:right;margin-right:15px}html[dir=ltr] ._21L8_s5wP8in4n3GDV8Czx{margin-left:25px}html[dir=rtl] ._21L8_s5wP8in4n3GDV8Czx{margin-right:25px}._3mvcXmeTt6k4wiQkVK4uB5{font-size:1.6em;font-weight:200}html[dir=ltr] ._3mvcXmeTt6k4wiQkVK4uB5{margin-left:25px}html[dir=rtl] ._3mvcXmeTt6k4wiQkVK4uB5{margin-right:25px}._1vIZFpNO1jaQRquRLYEA-m{color:"[theme:redDark, default:#a80000]";font-weight:500}html[dir=ltr] ._1vIZFpNO1jaQRquRLYEA-m{margin-left:25px}html[dir=rtl] ._1vIZFpNO1jaQRquRLYEA-m{margin-right:25px}._1y9fv-T88PvO8WIDG31MoT{color:"[theme:neutralTertiary, default:#a6a6a6]"}',""]),r.locals={closeButton:"_2V36xsu2ipdYgOeX4-A1nj",addToFavoriteButton:"WYNo4I7wwY8SAkVCo9vzi",headerText:"_21L8_s5wP8in4n3GDV8Czx",headerTitle:"_3mvcXmeTt6k4wiQkVK4uB5",errorText:"_1vIZFpNO1jaQRquRLYEA-m",greyed:"_1y9fv-T88PvO8WIDG31MoT"}}},0,[6,7,25,34,57,0,3,4,9,52,1,2,51,19,60,8,11,55,201,223,56,242,218,225,232,64,216,53,54]]);
//# sourceMappingURL=owa.PublicFolderPickerModule.js.map
window.scriptsLoaded['owa.PublicFolderPickerModule.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.PublicFolderPickerModule.js'] = (new Date()).getTime();