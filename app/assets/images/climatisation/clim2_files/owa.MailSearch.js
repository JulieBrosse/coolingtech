window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.MailSearch.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[60,234],{116:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return o});var r=n(0),a=n(3),i={findText:"",isFocusInSearchBox:!1,newFolderViewState:null,shouldShowAllFolders:!1,moveToMailboxContext:"primary"},o=Object(a.createStore)("moveToStore",r.__assign({},i)),c=o();t.a=c},1204:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return s});var r=n(1211),a=n(148),i=n(263),o=n(213);function c(e){return!(1!==Object(o.b)()||!l())&&u(e,a.a.brandList.domains)}function s(e){return!(1!==Object(o.b)()||!l())&&u(e,a.a.brandList.tier3Domains)}function l(){return a.a.brandListLoadState===i.a.unloaded&&Object(r.a)(),!(a.a.brandListLoadState!=i.a.loadSucceeded||!a.a.brandList||!a.a.brandList.domains)}function u(e,t){if(e){e=e.toLowerCase();for(var n=0;n<t.length;n++)if(e.match("(.|@)"+t[n]+"$"))return!0}return!1}},1207:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(0),a=n(1),i=n(1843),o=n(1844),c=n(1825),s=n(1932),l=Object(i.a)(),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._link=Object(o.a)(),t._onClick=function(e){var n=t.props,r=n.onClick;n.disabled?e.preventDefault():r&&r(e)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.disabled,i=t.children,o=t.className,c=t.href,u=t.theme,d=t.styles,p=t.keytipProps,f=l(d,{className:o,isButton:!c,isDisabled:n,theme:u}),h=this._getRootType(this.props);return a.createElement(s.a,{keytipProps:p,ariaDescribedBy:this.props["aria-describedby"],disabled:n},function(t){return a.createElement(h,r.__assign({},t,e._removeInvalidPropsForRootType(h,e.props),{className:f.root,onClick:e._onClick,ref:e._link,"aria-disabled":n}),i)})},t.prototype.focus=function(){var e=this._link.current;e&&e.focus&&e.focus()},t.prototype._removeInvalidPropsForRootType=function(e,t){t.children,t.as;var n=t.disabled,a=t.target,i=t.href,o=(t.theme,t.getStyles,t.styles,r.__rest(t,["children","as","disabled","target","href","theme","getStyles","styles"]));return"string"==typeof e?"a"===e?r.__assign({target:a,href:i},o):r.__assign({},o,{disabled:n}):r.__assign({target:a,href:i,disabled:n},o)},t.prototype._getRootType=function(e){return e.as?e.as:e.href?"a":"button"},t}(c.a)},1208:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i});var r={};function a(e){r=e}function i(){return r}},1209:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"j",function(){return i}),n.d(t,"e",function(){return o}),n.d(t,"d",function(){return c}),n.d(t,"f",function(){return s}),n.d(t,"h",function(){return l}),n.d(t,"i",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"a",function(){return p}),n.d(t,"g",function(){return f}),n.d(t,"k",function(){return h});var r=n(3),a=Object(r.action)("onAcceptingMeeting",function(e,t){return{meetingId:e,respondToSeries:t}}),i=Object(r.action)("onTentativelyAcceptingMeeting",function(e,t){return{meetingId:e,respondToSeries:t}}),o=Object(r.action)("onDecliningMeeting",function(e,t){return{meetingId:e,respondToSeries:t}}),c=Object(r.action)("onCancelingMeeting",function(e,t){return{meetingId:e,respondToSeries:t}}),s=Object(r.action)("onDeletingMeeting",function(e,t){return{meetingId:e,respondToSeries:t}}),l=Object(r.action)("onMeetingResponseActionFailed",function(e,t,n,r){return{meetingId:e,originalMeetingResponse:t,error:n,meetingResponseActionParams:r}}),u=Object(r.action)("onMeetingResponseActionSucceeded",function(e,t,n){return{meetingId:e,originalMeetingResponse:t,meetingResponseActionParams:n}}),d=Object(r.action)("joinOnlineMeeting",function(e,t){return{meetingId:e,joinOnlineMeetingParams:t}}),p=Object(r.action)("editMeeting",function(e,t){return{meetingId:e,editMeetingParams:t}}),f=Object(r.action)("onMeetingInfoRequested",function(e,t){return{personaId:e,successCallback:t}}),h=Object(r.action)("openMeeting",function(e){return{meetingId:e}})},1210:function(e,t,n){"use strict";var r,a;n.d(t,"a",function(){return r}),(a=r||(r={}))[a.NoOp=0]="NoOp",a[a.AlwaysHidden=1]="AlwaysHidden",a[a.CopyMailReadingPaneContainer=2]="CopyMailReadingPaneContainer",a[a.LoadConversationReadingPane=3]="LoadConversationReadingPane",a[a.LoadItemReadingPane=4]="LoadItemReadingPane"},1211:function(e,t,n){"use strict";var r=n(0),a=n(176),i=n(3),o=n(148),c=Object(i.mutatorAction)("SET_BRAND_LIST",function(e){o.a.brandList=e}),s=Object(i.mutatorAction)("SET_BRAND_LIST_LOAD_STATE",function(e){o.a.brandListLoadState=e}),l=n(263),u=n(7);n.d(t,"a",function(){return p});var d="resources/json/brandList.json";function p(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,i;return r.__generator(this,function(r){switch(r.label){case 0:if(o.a.brandListLoadState!=l.a.unloaded)return[2];s(l.a.loading),e=""+Object(a.a)()+d,r.label=1;case 1:return r.trys.push([1,6,,7]),[4,fetch(e)];case 2:return 200!==(t=r.sent()).status?[3,4]:[4,t.json()];case 3:return(n=r.sent())?(s(l.a.loadSucceeded),c(n)):(s(l.a.loadFailed),u.c.info("error fetching brand list. Empty response")),[3,5];case 4:s(l.a.loadFailed),u.c.info("error fetching brand list. Http response: "+t.status),r.label=5;case 5:return[3,7];case 6:return i=r.sent(),s(l.a.loadFailed),u.c.info("error fetching brand list. Exception: "+i),[3,7];case 7:return[2]}})})}},1213:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(3),a=Object(r.action)("exitSearch",function(e){return{actionSource:e}})},1220:function(e,t,n){"use strict";function r(e){var t={};return e.map(function(e){var n=e.displayName.toLowerCase();t[n]?t[n]++:t[n]=1}),t}n.d(t,"a",function(){return r})},1221:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_FOLDER_CLICKED_IN_MOVEIN_CONTROL",function(){return{}})},1223:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(27),a=n(6);function i(e){var t=r.a.conversations.get(e);if(t){var n=Object(a.a)().UserOptions.ConversationSortOrderReact;return t.conversationNodeIds.length>0&&!t.loadingState.hasLoadFailed&&t.conversationSortOrder==n}return!1}},1229:function(e,t,n){"use strict";var r=n(1278),a=n(984),i=n(1266),o=n(4);t.a=Object(o.action)("setOngoingActionAndActionMessage")(function(e,t,n){Object(r.a)(e,t),e.actionMessage=n,Object(i.a)(e)?Object(a.a)(e,!0):Object(a.a)(e,!1)})},1234:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(18),a=n(276);function i(e){switch(e.__type){case a.e:return 0;case a.m:return 1;case a.g:return 2;case a.h:var t=e;return Object(r.isStringNullOrWhiteSpace)(t.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+e.__type)}}},1236:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return u});var r=n(669),a=n(116),i=n(12),o=n(8);function c(e){switch(e){case"primary":return Object(i.y)();case"archive":return Object(i.r)()}}function s(e){return c(e).FolderId.Id}function l(e,t,n){var c=Object(a.b)(),s=c.moveToMailboxContext;switch(e){case"primary":return t.indexOf("primary")>-1&&("primary"!=s||"primary"==s&&!c.shouldShowAllFolders||c.findText.length>0||"primary"==s&&n.length<Object(r.b)("primary").folders.length);case"archive":return t.indexOf("archive")>-1&&Object(o.c)("tri-archive-mailbox")&&!!Object(i.r)()&&("archive"!=s||c.findText.length>0||"archive"==s&&n.length<Object(r.b)("archive").folders.length);default:return!1}}function u(){return"archive"===Object(a.b)().moveToMailboxContext&&Object(i.x)(i.d)===i.e.Loading}},1251:function(e,t,n){"use strict";var r=n(1208);n.d(t,"a",function(){return r.b});n(338);var a=n(1204);n.d(t,"b",function(){return a.b});var i=n(1209);n.d(t,"c",function(){return i.g}),n.d(t,"d",function(){return i.k})},1252:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(276),a=n(597),i=[0,1,3,2,6,5,7,8,4];function o(e){var t=null,n=function(n){var r=Object(a.b)(n);return null===r?null:function(){if(!t){t={};for(var n=0,r=i;n<r.length;n++){var a=r[n];t[a]=e(a)}}return t}()[r]};return{getDataProviderInfo:n,getDefaultDataProviderInfo:function(e){return n(e?r.k:r.l)}}}},1254:function(e,t,n){"use strict";var r=n(1279),a=n(1265),i=n(1229),o=n(18);var c=n(150),s=n(599),l=n(617);n.d(t,"b",function(){return d}),n.d(t,"a",function(){return p});var u=null;function d(){return u||(u=Object.keys(c.a).reduce(function(e,t){var n=c.a[t];return Number.isInteger(n)&&e.push(n),e},[])),u}function p(e,t,n){n&&0!==n.length||(n=d());var c,u,p=Object(s.c)(t.model,!0),f=Object(s.f)(),h=Object(l.a)(t),m=h&&t.isFolder,b=Object(r.a)(f,p,t.attachmentClass,t.model,h?t.model.ProviderType:null,t.model.AttachmentOriginalUrl,t.info.allowDownload,m,n,e.isReadOnly);e.strategy=b,c=e,u=t,e.strategy.isSaveToCloudSupported&&!Object(o.isStringNullOrWhiteSpace)(u.model.AttachmentOriginalUrl)&&(Object(a.a)(c,2),Object(i.a)(c,0,2))}},1257:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),a=n(974);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetPersona",e,t)}},1265:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("addCompletedAction")(function(e,t){e.completedActions.push(t)})},1266:function(e,t,n){"use strict";function r(e){return 0!==e.actionMessage}n.d(t,"a",function(){return r})},1267:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(896);function a(e,t,n){if(t)Object(r.a)(e);else{var a=document.createElement("a");a.style.display="none",a.href=e,a.download="",n||(n=document.body),n.appendChild(a),a.click(),n.removeChild(a)}}},1278:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("setOngoingAction")(function(e,t){e.ongoingAction=t})},1279:function(e,t,n){"use strict";var r=n(0),a=n(599),i=n(150),o=n(82),c=n(149);function s(e){switch(e){case i.a.Download:return c.a.Download;case i.a.OpenInNewTab:return c.a.OpenInNewTab;case i.a.Preview:return c.a.Preview;case i.a.ImportCalendarEventAttachment:case i.a.ChangePermissions:case i.a.CopyLink:case i.a.SaveToCloud:case i.a.ViewInProvider:case i.a.ConvertClassicToCloudy:case i.a.ConvertCloudyToClassic:case i.a.MoveAttachmentToInline:case i.a.RefreshLink:case i.a.IgnoreExpiration:return null;default:return Object(o.a)(e)}}function l(e){switch(e){case c.a.Download:return i.a.Download;case c.a.OpenInNewTab:return i.a.OpenInNewTab;case c.a.Preview:return i.a.Preview;case c.a.NoAction:return null;default:return Object(o.a)(e)}}var u=n(1252),d=n(8);var p=Object(u.a)(function(e){switch(e){case 0:return n={supportViewInProvider:!1,supportConvertCloudyToClassic:!1},r.__assign({},n,{supportViewInProvider:!0,supportConvertCloudyToClassic:!0});case 1:return t={supportViewInProvider:!1,supportConvertCloudyToClassic:!1},r.__assign({},t,{supportConvertCloudyToClassic:Object(d.c)("doc-consumerUrl")});case 3:case 2:case 6:case 5:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};case 7:case 8:case 9:case 4:case 10:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};default:return Object(o.a)(e)}var t,n}),f=p.getDataProviderInfo,h=p.getDefaultDataProviderInfo,m=f;var b=n(144),g=n(18);function v(e,t,n,i,o,u,d,p,f,h){var g,v,y,T=Object(c.d)(t,n,i);v=f,y=function(e,t,n){void 0===n&&(n=!1);var r=e.filter(function(e){return-1!==t.indexOf(e)});return n&&(r=r.filter(function(e,t,n){return n.indexOf(e)===t})),r}((g=T).supportedOpenActions.map(l).filter(function(e){return!!e}),v),g.supportedOpenActions=y.map(s);var O,w,x,A,C,_,I,P,j,D,E,k,M,F,R,L,N,B,U,W,V=i.__type===b.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE,H=Object(a.e)(i,V,h),z=V,G=S(V,o,u),q=(O=V,w=h,e.convertClassicToCloudyEnabled&&!O&&!w),K=function(e,t,n,r,a){if(e.convertCloudyToClassicEnabled&&t&&!n&&r){var i=m(a);return i&&i.supportConvertCloudyToClassic||!1}return!1}(e,V,h,d,o),Y=2===n&&!V&&!h;switch(n){case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:case 13:M=T,F=H,R=V,L=z,N=G,B=q,U=K,W=Y,x=r.__assign({},M,{isSaveToCloudSupported:F,isOpeningByLinkSupported:R,isOpeningInProviderSupported:L,isViewingInProviderSupported:N,isConvertClassicToCloudySupported:B,isConvertCloudyToClassicSupported:U,isMoveAttachmentToInlineSupported:W,showActionsMenu:!0,supportedMenuActions:[]});break;case 1:k=T,x=r.__assign({},k,{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!1,isOpeningInProviderSupported:!1,isViewingInProviderSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]});break;default:V?(P=T,j=z,D=G,E=K,x=r.__assign({},P,{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!0,isOpeningInProviderSupported:j,isViewingInProviderSupported:D,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:E,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})):(A=T,C=H,_=G,I=q,x=r.__assign({},A,{isSaveToCloudSupported:C,isViewingInProviderSupported:_,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:I,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]}))}return x.supportedMenuActions=f,x}function S(e,t,n){if(e)return(a=m(t))&&a.supportViewInProvider||!1;var r=Object(d.c)("doc-consumerUrl"),a=h(r);return!Object(g.isStringNullOrWhiteSpace)(n)&&(r||a&&a.supportViewInProvider)}n.d(t,"a",function(){return v}),n.d(t,"b",function(){return S})},1303:function(e,t,n){"use strict";var r=n(0),a=n(3),i={ShareByEmail:{datapoint:{name:"ShareByEmail"}}},o=Object(a.action)("SHARE_BY_EMAIL",function(e,t){return{attachments:e,composeTarget:t,datapointConfig:i.ShareByEmail.datapoint}}),c=n(75);Object(a.orchestrator)(o,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t={operation:0,bodyType:"HTML",to:null,conversationId:""},n=e.attachments.map(function(e){return{file:e,isInline:!1}}),[4,c.p.importAndExecute(t,e.composeTarget,null,n)];case 1:return r.sent(),[2]}})})});n.d(t,"a",function(){return o})},133:function(e,t,n){"use strict";var r={sequentialIndex:"0",nonSequentialIndex:"-1"},a=n(600),i=n(0),o=n(3),c=n(979);Object(o.orchestrator)(c.d,function(e){return i.__awaiter(void 0,void 0,void 0,function(){return i.__generator(this,function(e){return Object(a.c)(),[2]})})});n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a.c})},1447:function(e,t,n){var r=n(1449),a=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1449:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'.ULq_xzpicAREijO-aYbPX{max-height:544px}html[dir] ._1rICyVzZyw7RpD2QOIPDhn:focus,html[dir] ._1rICyVzZyw7RpD2QOIPDhn:hover,html[dir] ._2gvlFgX5lazjyaqNJNrbc0,html[dir] ._26YpV5Xnc_2YuQT-j7dzDz:focus,html[dir] ._26YpV5Xnc_2YuQT-j7dzDz:hover{background-color:"[theme:neutralLight, default:#eaeaea]"}._1rICyVzZyw7RpD2QOIPDhn,._26YpV5Xnc_2YuQT-j7dzDz,._121jtM2FactR8JqtMFZKyU{-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;display:-webkit-box;display:-ms-flexbox;display:flex;height:36px;line-height:36px}html[dir=ltr] ._1rICyVzZyw7RpD2QOIPDhn,html[dir=ltr] ._26YpV5Xnc_2YuQT-j7dzDz{padding-right:8px}html[dir=rtl] ._1rICyVzZyw7RpD2QOIPDhn,html[dir=rtl] ._26YpV5Xnc_2YuQT-j7dzDz{padding-left:8px}._1vtcCVeoh4Z1-LX_pjPU8F,._216afmSUDW3Nvl5A-idK5P{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.fOnzwlH-vEvdMUy-KWthv,.Ti2OOt0eLyAblZbyreOF0{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;white-space:pre}.fOnzwlH-vEvdMUy-KWthv{font-weight:600;color:"[theme:black, default:#000000]"}html[dir=ltr] ._1rICyVzZyw7RpD2QOIPDhn{padding-left:30px}html[dir=rtl] ._1rICyVzZyw7RpD2QOIPDhn{padding-right:30px}._17sgqAh38bEAVW9R7ZuZu1{color:"[theme:neutralPrimary, default:#333333]"}html[dir] ._17sgqAh38bEAVW9R7ZuZu1{margin:0 8px}.yWk6z2aJmIsXmpGCTtgVA{height:1px}html[dir] .yWk6z2aJmIsXmpGCTtgVA{background-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] .RIFzUxv0RpIaBvYTAs6dF{padding:8px 0}',""]),t.locals={moveToMenu:"ULq_xzpicAREijO-aYbPX",highlightItem:"_2gvlFgX5lazjyaqNJNrbc0",moveToMenuItemContainer:"_26YpV5Xnc_2YuQT-j7dzDz",nonIconMenuItem:"_1rICyVzZyw7RpD2QOIPDhn",moveToMenuItemContainerCommon:"_121jtM2FactR8JqtMFZKyU",folderName:"_1vtcCVeoh4Z1-LX_pjPU8F",folderMenuItemContainer:"_216afmSUDW3Nvl5A-idK5P",folderSuggestion:"Ti2OOt0eLyAblZbyreOF0",folderMatchSuggestion:"fOnzwlH-vEvdMUy-KWthv",icon:"_17sgqAh38bEAVW9R7ZuZu1",moveToMenuDivider:"yWk6z2aJmIsXmpGCTtgVA",moveToLoadingSpinner:"RIFzUxv0RpIaBvYTAs6dF"}},147:function(e,t,n){"use strict";n.d(t,"g",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"f",function(){return o}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return l}),n.d(t,"i",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"h",function(){return p});var r=n(3),a=Object(r.action)("RESET_MOVETO_STORE"),i=Object(r.action)("ON_MOVETO_SEARCH_TEXT_CHANGES",function(e){return{searchText:e}}),o=Object(r.action)("ON_VIEW_ALL_MENU_CLICKED",function(e){return{moveToMailboxContext:e}}),c=Object(r.action)("ON_CHANGE_MOVE_TO_CONTEXT",function(e){return{moveToMailboxContext:e}}),s=Object(r.action)("SET_NEW_FOLDER_TEXT",function(e){return{folderText:e}}),l=Object(r.action)("SET_NEW_FOLDER_INVALID_STATE"),u=Object(r.action)("SET_FOCUS_IN_SEARCH_BOX",function(e){return{isFocusInSearchBox:e}}),d=Object(r.action)("NEW_FOLDER_MENU_CLICK"),p=Object(r.action)("RESET_NEW_FOLDER_VIEWSTATE")},1542:function(e,t,n){"use strict";var r=n(937),a={RecipientCacheHitIndex:{datapoint:{name:"RecipientCacheHitIndex",customData:function(e){return[Math.ceil(e/50)]}}}},i=n(9);function o(e,t,n,o){var s=[],l=0;for(e=e.toLowerCase();s.length<t&&r.a.recipientCache&&l<r.a.recipientCache.length;){var u=r.a.recipientCache[l].EmailAddress;if(u.EmailAddress&&0==u.EmailAddress.toLowerCase().indexOf(e)||u.Name&&0==u.Name.toLowerCase().indexOf(e)){var d=!1;n&&c(u,n)&&(d=!0),o&&o.indexOf(u.MailboxType)>=0&&(d=!0),d||s.push(r.a.recipientCache[l])}l++}return Object(i.n)(a.RecipientCacheHitIndex.datapoint.name,a.RecipientCacheHitIndex.datapoint.customData(l)),s}function c(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}n.d(t,"a",function(){return o})},1822:function(e,t,n){"use strict";var r=n(1842),a=n(0),i=n(1),o=n(1843),c=n(1844),s=n(563),l=n(1845),u=n(1825),d=n(1629),p=n(1932),f=Object(o.a)(),h=function(e){function t(t){var n=e.call(this,t)||this;return n._toggleButton=Object(c.a)(),n._onClick=function(e){var t=n.props,r=t.disabled,a=t.checked,i=t.onChange,o=t.onChanged,c=t.onClick,s=n.state.checked;r||(void 0===a&&n.setState({checked:!s}),i&&i(e,!s),o&&o(!s),c&&c(e))},n._warnMutuallyExclusive({checked:"defaultChecked"}),n._warnDeprecations({onAriaLabel:"ariaLabel",offAriaLabel:void 0,onChanged:"onChange"}),n.state={checked:!(!t.checked&&!t.defaultChecked)},n._id=t.id||Object(s.c)("Toggle"),n}return a.__extends(t,e),Object.defineProperty(t.prototype,"checked",{get:function(){return this.state.checked},enumerable:!0,configurable:!0}),t.prototype.componentWillReceiveProps=function(e){void 0!==e.checked&&this.setState({checked:!!e.checked})},t.prototype.render=function(){var e=this,t=this.props,n=t.as,r=void 0===n?"div":n,o=t.className,c=t.theme,s=t.disabled,u=t.keytipProps,h=t.label,m=t.ariaLabel,b=t.onAriaLabel,g=t.offAriaLabel,v=t.offText,S=t.onText,y=t.styles,T=this.state.checked,O=T?S:v,w=T?b:g,x=Object(l.f)(this.props,l.i,["defaultChecked"]),A=f(y,{theme:c,className:o,disabled:s,checked:T});return i.createElement(r,{className:A.root},h&&i.createElement(d.a,{htmlFor:this._id,className:A.label},h),i.createElement("div",{className:A.container},i.createElement(p.a,{keytipProps:u,ariaDescribedBy:x["aria-describedby"],disabled:s},function(t){return i.createElement("button",a.__assign({},x,t,{className:A.pill,disabled:s,id:e._id,type:"button",role:"switch",ref:e._toggleButton,"aria-disabled":s,"aria-checked":T,"aria-label":m||w,"data-is-focusable":!0,onChange:e._noop,onClick:e._onClick}),i.createElement("div",{className:A.thumb}))}),O&&i.createElement(d.a,{className:A.text},O)))},t.prototype.focus=function(){this._toggleButton.current&&this._toggleButton.current.focus()},t.prototype._noop=function(){},t}(u.a),m=n(41);n.d(t,"a",function(){return b});var b=Object(r.a)(h,function(e){var t,n,r,a,i,o,c,s=e.theme,l=e.className,u=e.disabled,d=e.checked,p=s.semanticColors,f=p.bodyBackground,h=p.inputBackgroundChecked,b=p.inputBackgroundCheckedHovered,g=p.disabledBodyText,v=p.inputBorderHovered,S=p.inputForegroundChecked,y=p.disabledBodyText,T=p.disabledBackground,O=p.smallInputBorder,w=p.inputBorderHovered,x=p.disabledBodyText,A=p.disabledText;return{root:["ms-Toggle",d&&"is-checked",!u&&"is-enabled",u&&"is-disabled",s.fonts.medium,{marginBottom:"8px"},l],label:["ms-Toggle-label",u&&{color:A,selectors:(t={},t[m.HighContrastSelector]={color:"GrayText"},t)}],container:["ms-Toggle-innerContainer",{display:"inline-flex",position:"relative"}],pill:["ms-Toggle-background",Object(m.getFocusStyle)(s,-3),{fontSize:"20px",boxSizing:"border-box",width:"2.2em",height:"1em",borderRadius:"1em",transition:"all 0.1s ease",borderWidth:"1px",borderStyle:"solid",background:f,borderColor:O,cursor:"pointer",display:"flex",alignItems:"center",padding:"0 .2em"},!u&&[!d&&{selectors:{":hover":[{borderColor:w}],":hover .ms-Toggle-thumb":[{selectors:(n={},n[m.HighContrastSelector]={borderColor:"Highlight"},n)}]}},d&&[{background:h,borderColor:"transparent",justifyContent:"flex-end"},{selectors:(r={":hover":[{backgroundColor:b,borderColor:"transparent",selectors:(a={},a[m.HighContrastSelector]={backgroundColor:"Highlight"},a)}]},r[m.HighContrastSelector]={backgroundColor:"WindowText"},r)}]],u&&[{cursor:"default"},!d&&[{borderColor:x}],d&&[{backgroundColor:g,borderColor:"transparent",justifyContent:"flex-end"}]],!u&&{selectors:{"&:hover":{selectors:(i={},i[m.HighContrastSelector]={borderColor:"Highlight"},i)}}}],thumb:["ms-Toggle-thumb",{width:".5em",height:".5em",borderRadius:".5em",transition:"all 0.1s ease",backgroundColor:v,borderColor:"transparent",borderWidth:".28em",borderStyle:"solid",boxSizing:"border-box"},!u&&d&&[{backgroundColor:S,selectors:(o={},o[m.HighContrastSelector]={backgroundColor:"Window",borderColor:"Window"},o)}],u&&[!d&&[{backgroundColor:y}],d&&[{backgroundColor:T}]]],text:["ms-Toggle-stateText",{selectors:{"&&":{padding:"0",margin:"0 10px",userSelect:"none"}}},u&&{selectors:{"&&":{color:A,selectors:(c={},c[m.HighContrastSelector]={color:"GrayText"},c)}}}]}},void 0,{scope:"Toggle"})},1906:function(e,t,n){"use strict";var r=n(1842),a=n(0),i=n(1),o=n(1843),c=n(1844),s=n(1825),l=n(1923),u=n(526),d=n(1885),p=n(1824),f=n(2151),h=n(402),m=Object(o.a)(),b={months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["S","M","T","W","T","F","S"],goToToday:"Go to today",prevMonthAriaLabel:"Go to previous month",nextMonthAriaLabel:"Go to next month",prevYearAriaLabel:"Go to previous year",nextYearAriaLabel:"Go to next year",closeButtonAriaLabel:"Close date picker"},g=function(e){function t(t){var n=e.call(this,t)||this;return n._calendar=Object(c.a)(),n._datePickerDiv=Object(c.a)(),n._textField=Object(c.a)(),n._onSelectDate=function(e){var t=n.props,r=t.formatDate,a=t.onSelectDate;n.props.calendarProps&&n.props.calendarProps.onSelectDate&&n.props.calendarProps.onSelectDate(e),n.setState({selectedDate:e,formattedDate:r&&e?r(e):""}),a&&a(e),n._calendarDismissed()},n._onCalloutPositioned=function(){n._calendar.current&&!n.props.disableAutoFocus&&n._calendar.current.focus()},n._onTextFieldFocus=function(e){n.props.disableAutoFocus||n.props.allowTextInput||n._showDatePickerPopup()},n._onTextFieldBlur=function(e){n._validateTextInput()},n._onTextFieldChanged=function(e,t){if(n.props.allowTextInput){n.state.isDatePickerShown&&n._dismissDatePickerPopup();var r=n.props,a=r.isRequired,i=r.value,o=r.strings;n.setState({errorMessage:a&&!i?o.isRequiredErrorMessage||" ":void 0,formattedDate:t})}},n._onTextFieldKeyDown=function(e){switch(e.which){case 13:e.preventDefault(),e.stopPropagation(),n.state.isDatePickerShown?n.props.allowTextInput&&n._dismissDatePickerPopup():n._showDatePickerPopup();break;case 27:n._handleEscKey(e)}},n._onTextFieldClick=function(e){n.state.isDatePickerShown||n.props.disabled?n.props.allowTextInput&&n.setState({isDatePickerShown:!1}):n._showDatePickerPopup()},n._onIconClick=function(e){e.stopPropagation(),n._onTextFieldClick(e)},n._dismissDatePickerPopup=function(){n.state.isDatePickerShown&&(n.setState({isDatePickerShown:!1}),n._validateTextInput())},n._calendarDismissed=function(){n._dismissDatePickerPopup()},n._handleEscKey=function(e){e.stopPropagation(),n._calendarDismissed()},n._validateTextInput=function(){var e=n.props,t=e.isRequired,r=e.allowTextInput,a=e.strings,i=e.parseDateFromString,o=e.onSelectDate,c=e.formatDate,s=e.minDate,l=e.maxDate,u=n.state.formattedDate;if(!n.state.isDatePickerShown)if(!t||u){if(r){var d=null;u?n.state.selectedDate&&c&&c(n.state.selectedDate)===u?d=n.state.selectedDate:!(d=i(u))||isNaN(d.getTime())?(c&&(d=n.state.selectedDate,n.setState({formattedDate:c(d).toString()})),n.setState({errorMessage:a.invalidInputErrorMessage||" "})):n._isDateOutOfBounds(d,s,l)?n.setState({errorMessage:a.isOutOfBoundsErrorMessage||" "}):(n.setState({selectedDate:d,errorMessage:""}),c&&c(d)!==u&&n.setState({formattedDate:c(d).toString()})):n.setState({errorMessage:""}),o&&o(d)}}else n.setState({errorMessage:a.isRequiredErrorMessage||" "})},n.state=n._getDefaultState(),n}return a.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){var t=e.formatDate,n=e.isRequired,r=e.strings,a=e.value,i=e.minDate,o=e.maxDate;if(!(Object(f.f)(this.props.minDate,e.minDate)&&Object(f.f)(this.props.maxDate,e.maxDate)&&this.props.isRequired===e.isRequired&&Object(f.f)(this.state.selectedDate,a)&&this.props.formatDate===t)){var c=n&&!a?r.isRequiredErrorMessage||" ":void 0;!c&&a&&(c=this._isDateOutOfBounds(a,i,o)?r.isOutOfBoundsErrorMessage||" ":void 0),this.setState({errorMessage:c});var s=this.state.selectedDate;Object(f.f)(s,a)&&this.props.formatDate===t||this.setState({selectedDate:a||void 0,formattedDate:t&&a?t(a):""})}},t.prototype.componentDidUpdate=function(e,t){this.props.onAfterMenuDismiss&&t.isDatePickerShown&&!this.state.isDatePickerShown&&this.props.onAfterMenuDismiss()},t.prototype.render=function(){var e=this.props,t=e.firstDayOfWeek,n=e.strings,r=e.label,o=e.theme,c=e.className,s=e.styles,u=e.initialPickerDate,f=e.isRequired,b=e.disabled,g=e.ariaLabel,v=e.pickerAriaLabel,S=e.placeholder,y=e.allowTextInput,T=e.borderless,O=e.minDate,w=e.maxDate,x=e.showCloseButton,A=e.calendarProps,C=this.state,_=C.isDatePickerShown,I=C.formattedDate,P=C.selectedDate,j=C.errorMessage,D=m(s,{theme:o,className:c,disabled:b,label:!!r,isDatePickerShown:_});return i.createElement("div",{className:D.root},i.createElement("div",{ref:this._datePickerDiv},i.createElement(p.a,{label:r,ariaLabel:g,"aria-haspopup":"true","aria-expanded":_,required:f,disabled:b,onKeyDown:this._onTextFieldKeyDown,onFocus:this._onTextFieldFocus,onBlur:this._onTextFieldBlur,onClick:this._onTextFieldClick,onChange:this._onTextFieldChanged,errorMessage:j,placeholder:S,borderless:T,iconProps:{iconName:"Calendar",onClick:this._onIconClick,className:D.icon},readOnly:!y,value:I,componentRef:this._textField,role:"button"})),_&&i.createElement(d.a,{role:"dialog",ariaLabel:v,isBeakVisible:!1,className:D.callout,gapSpace:0,doNotLayer:!1,target:this._datePickerDiv.current,directionalHint:4,onDismiss:this._calendarDismissed,onPositioned:this._onCalloutPositioned},i.createElement(h.a,{isClickableOutsideFocusTrap:!0,disableFirstFocus:this.props.disableAutoFocus},i.createElement(l.a,a.__assign({},A,{onSelectDate:this._onSelectDate,onDismiss:this._calendarDismissed,isMonthPickerVisible:this.props.isMonthPickerVisible,showMonthPickerAsOverlay:this.props.showMonthPickerAsOverlay,today:this.props.today,value:P||u,firstDayOfWeek:t,strings:n,highlightCurrentMonth:this.props.highlightCurrentMonth,highlightSelectedMonth:this.props.highlightSelectedMonth,showWeekNumbers:this.props.showWeekNumbers,firstWeekOfYear:this.props.firstWeekOfYear,showGoToToday:this.props.showGoToToday,dateTimeFormatter:this.props.dateTimeFormatter,minDate:O,maxDate:w,componentRef:this._calendar,showCloseButton:x})))))},t.prototype.focus=function(){this._textField.current&&this._textField.current.focus()},t.prototype.reset=function(){this.setState(this._getDefaultState())},t.prototype._showDatePickerPopup=function(){this.state.isDatePickerShown||this.setState({isDatePickerShown:!0,errorMessage:""})},t.prototype._getDefaultState=function(e){return void 0===e&&(e=this.props),{selectedDate:e.value||void 0,formattedDate:e.formatDate&&e.value?e.formatDate(e.value):"",isDatePickerShown:!1,errorMessage:void 0}},t.prototype._isDateOutOfBounds=function(e,t,n){return!!t&&Object(f.e)(t,e)>0||!!n&&Object(f.e)(n,e)<0},t.defaultProps={allowTextInput:!1,formatDate:function(e){return e?e.toDateString():""},parseDateFromString:function(e){var t=Date.parse(e);return t?new Date(t):null},firstDayOfWeek:u.b.Sunday,initialPickerDate:new Date,isRequired:!1,isMonthPickerVisible:!0,showMonthPickerAsOverlay:!1,strings:b,highlightCurrentMonth:!1,highlightSelectedMonth:!1,borderless:!1,pickerAriaLabel:"Calender",showWeekNumbers:!1,firstWeekOfYear:u.c.FirstDay,showGoToToday:!0,dateTimeFormatter:void 0,showCloseButton:!1},t}(s.a),v=n(41),S={root:"ms-DatePicker",callout:"ms-DatePicker-callout",withLabel:"ms-DatePicker-event--with-label",withoutLabel:"ms-DatePicker-event--without-label",disabled:"msDatePickerDisabled "};n.d(t,"a",function(){return y});var y=Object(r.a)(g,function(e){var t=e.className,n=e.theme,r=e.disabled,a=e.label,i=e.isDatePickerShown,o=n.palette,c=Object(v.getGlobalClassNames)(S,n),s={color:o.neutralSecondary,fontSize:v.FontSizes.icon,lineHeight:"18px",pointerEvents:"none",position:"absolute",right:"9px"};return{root:[c.root,i&&"is-open",v.normalize,t],textField:[{position:"relative",selectors:{"& input[readonly]":{cursor:"pointer"},input:{selectors:{"::-ms-clear":{display:"none"}}}}}],callout:[c.callout],icon:[s,!a&&[c.withoutLabel,{top:"7px"}],a&&[c.withLabel,{bottom:"5px"}],!r&&[c.disabled,{pointerEvents:"initial",cursor:"pointer"}]]}},void 0,{scope:"DatePicker"})},191:function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function a(e){var t=r(e);return t?t.replace(".",""):null}var i=n(655),o=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];function c(e){var t=r(e);return!!t&&o.indexOf(t.toLowerCase())>=0}var s=n(8),l=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function u(e){if(!Object(s.c)("doc-attachment-documentThumbnail"))return!1;var t=r(e);return!!t&&l.indexOf(t.toLowerCase())>=0}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"e",function(){return i.a}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return u})},2190:function(e,t,n){"use strict";function r(e,t){var n,r;t&&e&&(e.addCustomData({httpStatusCode:t.status}),n=e,(r=t.headers)&&n&&n.addCustomData({frontendServer:r.get("x-feserver"),requestId:r.get("request-id"),backendServer:r.get("x-beserver"),backendHttpStatus:r.get("x-backendhttpstatus"),serverVersion:r.get("x-owa-version")}))}function a(e){return e&&void 0!==e.fetchErrorType}function i(e,t){e.addCustomProperty("ErrorInformation",t)}function o(e,t){i(e,t?"Empty response from server":"Null response from server")}n.d(t,"c",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"b",function(){return o})},2234:function(e,t,n){"use strict";t.a={WacEditAndReply:{datapoint:{name:"WacEditAndReply",customData:function(e,t){return[e,t]}}},WacEdit:{datapoint:{name:"WacEdit",customData:function(e,t){return[e,t]}}},SetImageFromGalleryItem:{datapoint:{name:"SetImageFromGalleryItem",customData:function(e,t,n){return[e,t,n]}}},SxSSaveToCloud:{datapoint:{name:"SxSSaveToCloud",customData:function(e,t,n){return{size:e,result:t,actionSource:n}}}},SxSOpen:{datapoint:{name:"SxSOpen",customData:function(e,t){return{module:e,actionSource:t}}}},SxSClose:{datapoint:{name:"SxSClose",customData:function(e,t){return{module:e,closingSource:t}}}},SxSShowHideEmail:{datapoint:{name:"SxSShowHideEmail",customData:function(e,t){return{isShowEmail:e,module:t}}}},SxSImagePreviewLoadTime:{datapoint:{name:"SxSImagePreviewLoadTime"}},SxSPrint:{datapoint:{name:"SxSPrint",customData:function(e,t){return{doctype:e,module:t}}}}}},2243:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38);t.default=function(e,t){return r.makeServiceRequest("GetWacAttachmentInfo",e,t)}},2302:function(e,t,n){"use strict";var r=n(2398),a=n(2234),i=n(278),o=n(256),c=n(379),s=n(9),l=n(4);t.a=Object(l.select)({previewPaneStore:function(){return o.a}})(Object(l.action)("setReadingPaneDisplay")(function(e,t,n){if(n.previewPaneStore.readingPaneDisplay=e,Object(r.a)(),t){var o=a.a.SxSShowHideEmail.datapoint,l=o.name,u=o.customData;Object(s.n)(l,u(e===i.a.Show,Object(c.a)()))}}))},2397:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(2243),a=n.n(r),i=n(985),o=n.n(i);function c(e,t,n,r,i){if(i){var c="getWacAttachmentInfo"+i,s=new Headers;s.set("X-OWA-ActionName",c);var l={headers:s};r=r?o()(r,l):l}return a()({attachmentId:e,isEdit:t,draftId:n,appId:null},r)}},2398:function(e,t,n){"use strict";var r=n(2399),a=n(278),i=n(256),o=n(34),c=n(4);t.a=Object(c.select)({previewPaneStore:function(){return i.a},documentWidth:function(){return Math.max(document.documentElement.clientWidth,o.e)}})(Object(c.action)("updateReadingPaneSize")(function(e){var t=e.previewPaneStore.readingPaneSize&&e.previewPaneStore.readingPaneDisplay!==a.a.Initial?e.previewPaneStore.readingPaneSize/100:o.i/100;e.previewPaneStore.readingPaneDisplay===a.a.Initial&&(e.previewPaneStore.readingPaneDisplay=a.a.Default),Object(r.a)(e.documentWidth*(1-t),e.documentWidth*t,{previewPaneStore:e.previewPaneStore})}))},2399:function(e,t,n){"use strict";var r=n(278),a=n(256),i=n(82),o=n(4),c=n(34);t.a=Object(o.select)({previewPaneStore:function(){return a.a}})(Object(o.action)("setReadingPaneSize")(function(e,t,n){if(n.previewPaneStore.state){var a=e+t,o=c.f+c.j;switch(n.previewPaneStore.haveSpaceForReadingPane=a>=o,n.previewPaneStore.readingPaneDisplay===r.a.Initial&&(n.previewPaneStore.readingPaneDisplay=r.a.Default),n.previewPaneStore.readingPaneDisplay){case r.a.Default:n.previewPaneStore.haveSpaceForReadingPane?u():l();break;case r.a.AlwaysHide:case r.a.Hide:l();break;case r.a.Show:if(e>c.c&&Math.round(t)<c.d){var s=e-c.c;e-=s,t+=s}u();break;default:Object(i.a)(n.previewPaneStore.readingPaneDisplay)}}function l(){n.previewPaneStore.hideReadingPane=!0,n.previewPaneStore.readingPaneSize=0,n.previewPaneStore.previewPaneSizePixels=a,n.previewPaneStore.readingPaneSizePixels=0}function u(){n.previewPaneStore.hideReadingPane=!1;var r=100*t/(t+e);n.previewPaneStore.readingPaneSize=r,n.previewPaneStore.previewPaneSizePixels=e,n.previewPaneStore.readingPaneSizePixels=t}}))},2400:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(11),a=n.n(r);function i(e){switch(e){case 2:return a.a.errorGetWacUrlNotFoundOrNoPermission;case 3:return a.a.errorGetWacUrlProtectedByUnsupportedIrm;case 5:return a.a.errorGetWacUrlInvalidRequest;case 6:return a.a.errorGetWacUrlAttachmentDataProviderError;case 7:return a.a.errorGetWacUrlUploadFailed;case 4:return a.a.errorGetWacUrlUnsupportedObjectType;case 10:return a.a.errorGetWacUrlEditIrmAttachmentNotSupported;case 11:return a.a.errorGetWacUrlEditMacAttachmentNotSupported;default:return a.a.errorGetWacUrl}}},2443:function(e,t,n){"use strict";var r=n(0),a=n(2397),i=n(4),o=n(9),c=n(2190),s={},l={};t.a=Object(i.action)("initializeWacUrl")(function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var i,u,d,p,f;return r.__generator(this,function(r){switch(r.label){case 0:if(i=new o.c("InitializeWacUrl"),n&&i.addCustomProperty("actionSource",n),d=(u=t?l:s)[e.Id]){if(d.expireTime>=(new Date).getTime())return i.addCustomProperty("ReturnFromCache",!0),i.end(),[2,d.value];delete u[e.Id]}i.addCustomProperty("ReturnFromCache",!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(a.a)(e.Id,t,null,e.mailboxInfo&&e.mailboxInfo.requestOptions,n)];case 2:return 0===(p=r.sent()).Status&&(u[e.Id]={expireTime:(new Date).getTime()+36e5,value:p}),p.WacUrl||i.addCustomProperty("WacUrlIsEmpty",!0),i.addCustomProperty("WacAttachmentResponseStatus",p.Status.toString()),i.end(),[3,4];case 3:throw f=r.sent(),Object(c.a)(f)&&Object(c.c)(i,f.response),Object(c.d)(i,f.toString()),i.endWithError(o.a.ServerError),f;case 4:return[2,p]}})})})},2444:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),a=n(2400),i=n(2443),o=n(11),c=n.n(o);function s(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var o,s;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(i.a)(e,t,n)];case 1:return o=r.sent(),[3,3];case 2:throw s=r.sent(),{errorMessage:c.a.errorGetWacUrl,error:s};case 3:if(0===o.Status)return[2,[o.WacUrl,o.BootScriptUrl,o.WopiSrcUrl,o.AccessToken,o.Token]];throw{errorMessage:Object(a.a)(o.Status),error:new Error("GetWacAttachmentInfo failed with status: "+o.Status)}}})})}},2480:function(e,t,n){"use strict";var r=n(0),a=n(20),i=n(14),o=n(1906),c=n(666),s=n.n(c),l=n(10),u=n.n(l),d=n(1),p=n(614),f=n(2490),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"datePickerStrings",{get:function(){return{months:[u.a.januaryUppercase,u.a.februaryUppercase,u.a.marchUppercase,u.a.aprilUppercase,u.a.mayUppercase,u.a.juneUppercase,u.a.julyUppercase,u.a.augustUppercase,u.a.septemberUppercase,u.a.octoberUppercase,u.a.novemberUppercase,u.a.decemberUppercase],shortMonths:[u.a.januaryAbbreviatedUppercase,u.a.februaryAbbreviatedUppercase,u.a.marchAbbreviatedUppercase,u.a.aprilAbbreviatedUppercase,u.a.mayAbbreviatedUppercase,u.a.juneAbbreviatedUppercase,u.a.julyAbbreviatedUppercase,u.a.augustAbbreviatedUppercase,u.a.septemberAbbreviatedUppercase,u.a.octoberAbbreviatedUppercase,u.a.novemberAbbreviatedUppercase,u.a.decemberAbbreviatedUppercase],days:[u.a.sundayUppercase,u.a.mondayUppercase,u.a.tuesdayUppercase,u.a.wednesdayUppercase,u.a.thursdayUppercase,u.a.fridayUppercase,u.a.saturdayUppercase],shortDays:[u.a.sundaySingleLetterAbbreviation,u.a.mondaySingleLetterAbbreviation,u.a.tuesdaySingleLetterAbbreviation,u.a.wednesdaySingleLetterAbbreviation,u.a.thursdaySingleLetterAbbreviation,u.a.fridaySingleLetterAbbreviation,u.a.saturdaySingleLetterAbbreviation],goToToday:s.a.goToTodayStringLowerCaseText}},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e,t=r.__assign({},this.props.calendarProps,{showSixWeeksByDefault:!0,strings:null}),n=this.props.disabled;return d.createElement("div",{ref:"root",className:p((e={},e[f.grey]=n,e))},d.createElement(o.a,r.__assign({},this.props,{calendarProps:t,strings:this.datePickerStrings})))},r.__decorate([a.computed],t.prototype,"datePickerStrings",null),t=r.__decorate([i.observer],t)}(d.Component);t.a=h},2489:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetWacInfoRequest:#Exchange"},e)}},2490:function(e,t,n){var r=n(2491),a=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},2491:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'._9XNkA-bXYn8Z2JtBc1vw4 .ms-DatePicker-event--without-label,._9XNkA-bXYn8Z2JtBc1vw4 input{color:"[theme:neutralTertiary, default:#a6a6a6]"}',""]),t.locals={grey:"_9XNkA-bXYn8Z2JtBc1vw4"}},250:function(e,t,n){"use strict";var r=n(1213),a=n(286),i=n(528),o=n(6),c=n(74),s=n(4),l=Object(s.action)("initializeShowReadingPane")(function(){switch(Object(o.a)().UserOptions.GlobalReadingPanePositionReact){case c.a.Off:Object(a.a)(!1);break;case c.a.Right:case c.a.Bottom:Object(a.a)(!0);break;default:i.b.importAndExecute(c.a.Off)}}),u=n(394),d=Object(s.action)("onNewMessage")(function(e){e||(Object(a.a)(!0),Object(u.a)(Object(o.a)().UserOptions.GlobalReadingPanePositionReact!==c.a.Off))}),p=Object(s.action)("onPrintRow")(function(){Object(o.a)().UserOptions.GlobalReadingPanePositionReact===c.a.Off&&(Object(a.a)(!0),Object(u.a)(!1))}),f=n(0),h=n(16),m=n(5),b=n(509),g=n(73),v=n(43),S=n(32),y=n(57),T=n(27),O=n(1223),w=n(54);function x(e,t,n,r,i,o,c,s){var l=Promise.resolve(),d=!1,p=!0;switch(o){case y.a.MailListItemBody:case y.a.CommandBarArrows:case y.a.KeyboardEnter:case y.a.MailListItemExpansion:case y.a.MailListItemRichPreview:case y.a.ImmersiveReadingPaneDelete:case y.a.SearchSuggestionClick:d=!0,p=!1;break;case y.a.MailListItemTwisty:l=function(e){if(Object(O.a)(e.Id))return Promise.resolve();return Object(w.j)(e,"LoadConversationReadingPane")}(e),d=!1,p=!0;break;case y.a.KeyboardUpDown:case y.a.MailListItemCheckbox:case y.a.MailListItemContextMenu:case y.a.NewConversation:case y.a.Reset:case y.a.RouteHandler:case y.a.RowRemoval:default:d=!1,p=!0}if(d)switch(t){case 0:l=g.h.importAndExecute(e,i,c,n,r);break;case 1:l=g.j.importAndExecute(e,i,c,s)}return Object(a.a)(d),Object(u.a)(p),l}var A=Object(s.action)("onListViewSelectionChange")(Object(s.select)({listViewStore:function(){return m.F}})(function(e,t,n,r){return f.__awaiter(this,void 0,void 0,function(){var i,s,l,d,p,O,w,A,C,_,I,P,j;return f.__generator(this,function(f){return n==y.a.MessageAd?[2]:(i=Promise.resolve(),s=e.selectedRowKeys.size,l=Object(o.a)().UserOptions.GlobalReadingPanePositionReact,0==s?(D=l,Object(u.a)(!0),D===c.a.Off?Object(a.a)(!1):Object(a.a)(!0)):1==s?(d=e.selectedRowKeys.keys()[0],p=m.b.getRowClientItemId(d,e),O=m.b.getIsDraft(d,e),w=m.b.getIsSubmitted(d,e),A=e.tableQuery,C=Object(m.C)(A)||Object(v.m)(A),_=O&&!w&&!C,I=Object(b.a)([d],e)[0],P=m.b.getCategories(d,e),j=0==A.listViewType?r.listViewStore.conversationItems.get(p.Id).subject:T.a.items.get(p.Id).Subject,Object(h.a)("sea-qf")&&I&&S.t.importAndExecute(I.traceId,I.referenceKey,new Date,I.index),C||(l==c.a.Right||l==c.a.Bottom?i=function(e,t,n,r,i,o,c,s){switch(Object(a.a)(!0),Object(u.a)(!0),t){case 0:return g.h.importAndExecute(e,i,c,n,r);case 1:return g.j.importAndExecute(e,i,c,s);default:return Promise.resolve()}}(p,A.listViewType,j,P,t,0,I,_):l==c.a.Off&&(i=x(p,A.listViewType,j,P,t,n,I,_)))):l==c.a.Off&&(Object(a.a)(!1),Object(u.a)(!0)),[2,i]);var D})})})),C=n(2),_=n(28),I=(n(34),n(64));n.d(t,"c",function(){return j}),n.d(t,"d",function(){return D}),n.d(t,"e",function(){return E}),n.d(t,"g",function(){return k}),n.d(t,"h",function(){return M}),n.d(t,"f",function(){return R}),n.d(t,"b",function(){return l}),n.d(t,"j",function(){return d}),n.d(t,"i",function(){return A}),n.d(t,"k",function(){return p}),n.d(t,"a",function(){return r.a});var P=new C.c(function(){return Promise.all([n.e(226),n.e(66)]).then(n.bind(null,5645))}),j=new C.a(P,function(e){return e.closeImmersiveReadingPane}),D=new C.a(P,function(e){return e.onCloseCompose}),E=new C.a(P,function(e){return e.onReplyOrReplyAllOrForwardMessage}),k=new C.a(P,function(e){return e.onSelectingFolder}),M=new C.b(P,function(e){return e.onSxSPreviewPaneClose}),F=new C.a(P,function(e){return e.onReadingPanePositionOptionSaved}),R=new C.a(P,function(e){return e.onSelectMessageAd});Object(_.c)(function(){Object(I.subscribe)("saveReadingPanePositionOptionStitchName",function(e){return F.importAndExecute(e)})})},2555:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2556),a=n.n(r);function i(e,t){return a()({request:{Url:e,IsEdit:!1,ProviderType:t}})}},2556:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),a=n(2489);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=a.default(e.request)),r.makeServiceRequest("GetWacInfo",e,t)}},2557:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(12),a=n(380),i=n(51),o=n(11),c=n.n(o);function s(e){switch(e.kind){case"PrimaryMailbox":case"ArchiveMailbox":case"SharedFolders":return t=e,(n=Object(i.a)(t.folderId))===r.i?c.a.allFolders:n===r.d?c.a.allFoldersInArchive:r.n.folderTable.get(t.folderId).DisplayName;case"Group":return function(e){if(a.d.tryImportSync())return a.d.tryImportSync()(e.groupId);return e.groupId}(e);default:throw new Error("Unregistered search scope")}var t,n}},2647:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ReferenceAttachment:#Exchange"},e)}},2648:function(e,t,n){"use strict";var r=n(256),a=n(4);t.a=Object(a.select)({previewPaneStore:function(){return r.a}})(Object(a.action)("updatePreviewPaneState")(function(e,t){null!=t.previewPaneStore.state&&(t.previewPaneStore.state=e)}))},2794:function(e,t,n){"use strict";var r=n(2400);n.d(t,"a",function(){return r.a});n(2444),n(2555)},286:function(e,t,n){"use strict";var r=n(27),a=n(4),i=n(126),o=n(113);t.a=Object(a.action)("setShowReadingPane")(function(e){r.a.mailModule.showReadingPane=e,Object(i.a)()&&o.e.importAndExecute(o.i)})},2958:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"AttachmentType:#Exchange"},e)}},2959:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),a=n(2960);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetSearchSuggestions",e,t)}},2960:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetSearchSuggestionsJsonRequest:#Exchange"},e)}},335:function(e,t,n){"use strict";var r,a,i,o,c,s;n.d(t,"c",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c}),(a=r||(r={}))[a.Compose=0]="Compose",a[a.Extensibility=1]="Extensibility",a[a.ReadingPane=2]="ReadingPane",a[a.Fileshub=3]="Fileshub",(o=i||(i={}))[o.Safety=0]="Safety",o[o.Error=1]="Error",o[o.Info=2]="Info",o[o.Encryption=3]="Encryption",(s=c||(c={}))[s.Grey=0]="Grey",s[s.Red=1]="Red",s[s.Green=2]="Green",s[s.Yellow=3]="Yellow"},379:function(e,t,n){"use strict";function r(){var e=window.location.pathname;"/"===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1));var t=e.lastIndexOf("/");return-1===t?e:e.substr(t+1)}n.d(t,"a",function(){return r})},380:function(e,t,n){"use strict";var r=n(2),a=n(5);function i(){return o(Object(a.v)())}function o(e){return e&&2==e.tableQuery.type?e.tableQuery.folderId:null}function c(){var e=Object(a.v)();return e&&2==e.tableQuery.type}n.d(t,"d",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"h",function(){return d}),n.d(t,"g",function(){return p}),n.d(t,"f",function(){return f}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"c",function(){return c});var s=new r.c(function(){return Promise.all([n.e(229),n.e(94)]).then(n.bind(null,5676))}),l=new r.b(s,function(e){return e.getGroupDisplayName}),u=new r.b(s,function(e){return e.getGroupDisplayNameFromTableView}),d=new r.b(s,function(e){return e.isPrivateUnjoinedGroup}),p=new r.b(s,function(e){return e.isJoinedGroup}),f=new r.b(s,function(e){return e.isGroupOwner})},3801:function(e,t,n){var r=n(3802),a=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},3802:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'html[dir] ._1Z5tU0n4rzHmc64hRAxBYA,html[dir] ._2x7ZBsBTVeVgbn6Z_u9XEo,html[dir] ._3bzYkt7o5QqZF9PJNo5qUd,html[dir] .F_EYRvS40DKsZYpc9G7so{border-bottom:1px solid "[theme:neutralLight, default:#eaeaea]"}._1-2eV3X3Injib6u5sHKlpy{font-size:14px;font-weight:400;cursor:pointer;color:inherit;display:-webkit-box;display:-ms-flexbox;display:flex;height:32px;line-height:32px;outline:inherit;width:100%}html[dir] ._1-2eV3X3Injib6u5sHKlpy{background:none;border:none;padding:0 6px}html[dir=ltr] ._1-2eV3X3Injib6u5sHKlpy{text-align:left}html[dir=rtl] ._1-2eV3X3Injib6u5sHKlpy{text-align:right}._1-2eV3X3Injib6u5sHKlpy._9BAqL9G4tUtzl7WsOFcYM{font-weight:600}html[dir=ltr] ._1-2eV3X3Injib6u5sHKlpy._v4S5t8pTKStUrDbWxRO2{padding-left:40px}html[dir=rtl] ._1-2eV3X3Injib6u5sHKlpy._v4S5t8pTKStUrDbWxRO2{padding-right:40px}html[dir] ._1-2eV3X3Injib6u5sHKlpy:focus,html[dir] ._1-2eV3X3Injib6u5sHKlpy:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._2cy8oN1JtXHnlNWeZKkzF0{padding:0 10px}._2x7ZBsBTVeVgbn6Z_u9XEo{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}html[dir] ._2x7ZBsBTVeVgbn6Z_u9XEo{padding:6px 12px}html[dir] .F_EYRvS40DKsZYpc9G7so{padding:6px 12px 0}.JeNVer5tNMfoGWS2P8LbP{width:200px}html[dir] .JeNVer5tNMfoGWS2P8LbP{padding-bottom:12px}html[dir] .IeYmEBtmvupc4mikPoXi-{margin:12px}',""]),t.locals={refinerDivider:"_3bzYkt7o5QqZF9PJNo5qUd",folderOptions:"_1Z5tU0n4rzHmc64hRAxBYA",attachmentsRefinerContainer:"_2x7ZBsBTVeVgbn6Z_u9XEo",dateRefinersContainer:"F_EYRvS40DKsZYpc9G7so",folderOption:"_1-2eV3X3Injib6u5sHKlpy",isSelected:"_9BAqL9G4tUtzl7WsOFcYM",isNotSelected:"_v4S5t8pTKStUrDbWxRO2",selectedFolderCheckMark:"_2cy8oN1JtXHnlNWeZKkzF0",datePicker:"JeNVer5tNMfoGWS2P8LbP",clearFiltersButton:"IeYmEBtmvupc4mikPoXi-"}},3803:function(e,t,n){var r=n(3804),a=n(33);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},3804:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'.Sy41Cecmv9zx1Jn3ghigh{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:inherit;font:inherit;cursor:pointer;outline:inherit;color:"[theme:headerSearchFilters, default:#0078D7]";-webkit-box-flex:0;-ms-flex:0 10000000 auto;flex:0 10000000 auto;line-height:32px;min-width:32px}html[dir] .Sy41Cecmv9zx1Jn3ghigh{background:none;border:none;padding-bottom:0;padding-top:0}html[dir=ltr] .Sy41Cecmv9zx1Jn3ghigh{margin-left:auto}html[dir=rtl] .Sy41Cecmv9zx1Jn3ghigh{margin-right:auto}.Sy41Cecmv9zx1Jn3ghigh:hover{color:"[theme:headerSearchFiltersHover, default:#004578]"}._1n0cGE3-xzp0ciJYPPjI9p{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px;font-weight:400;-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto}html[dir=ltr] ._1n0cGE3-xzp0ciJYPPjI9p{text-align:right}html[dir=rtl] ._1n0cGE3-xzp0ciJYPPjI9p{text-align:left}.iku3YsXaIt6xaKQ33SuaN{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:11px;font-weight:400;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:32px}html[dir] .iku3YsXaIt6xaKQ33SuaN{padding-top:2px}',""]),t.locals={refinersButton:"Sy41Cecmv9zx1Jn3ghigh",refinersButtonText:"_1n0cGE3-xzp0ciJYPPjI9p",refinersButtonIcon:"iku3YsXaIt6xaKQ33SuaN"}},389:function(e,t,n){"use strict";var r=n(0);var a={AttachmentRefreshDownloadToken:{datapoint:{name:"AttachmentRefreshDownloadToken",customData:function(e){return[e]}}}},i=n(943),o=n.n(i),c=n(6),s=n(9),l=n(93),u=n(8),d=n(18),p=n(7);n.d(t,"a",function(){return m}),n.d(t,"c",function(){return b}),n.d(t,"b",function(){return g});var f=function(e){var t;void 0===e&&(e={}),(t=e).timeBetweenRetryInMS=t.timeBetweenRetryInMS||function(){return 6e4};var n=e.maximumAttempts,r=e.timeBetweenRetryInMS;return function(e){var t=0,a=!1,i=function(o,c){a?c(new Error("The function retry was cancelled")):(t++,e().then(o).catch(function(e){n&&t>=n?c(e):setTimeout(function(){return i(o,c)},r(t))}))};return{retriableFunc:function(){return new Promise(function(e,t){return i(e,t)})},cancel:function(){return a=!0}}}}({timeBetweenRetryInMS:function(){return 3e4}}),h=function(){function e(e,t,n,i){var c=this;this.downloadTokenRefreshMinutes=e,this.downloadUrlBase=t,this.mailboxAddress=n,this.refreshDownloadTokenAndRetryInCaseOfFailure=function(){return r.__awaiter(c,void 0,void 0,function(){var e,t,n,i,c=this;return r.__generator(this,function(l){switch(l.label){case 0:if(this.isRefreshingDownloadToken)return[3,4];this.isRefreshingDownloadToken=!0,e=0,t=f(function(){return r.__awaiter(c,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return e++,t=this,[4,function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,o()()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),p.c.warn("Unable to get the download token "+e),e;case 3:return[2]}})})}()];case 1:return t.downloadToken=n.sent(),this.isRefreshingDownloadToken=!1,[2]}})})}).retriableFunc,n=new s.d(a.AttachmentRefreshDownloadToken.datapoint.name),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,t()];case 2:return l.sent(),n.addCustomData(a.AttachmentRefreshDownloadToken.datapoint.customData(e)),n.end(),[3,4];case 3:return i=l.sent(),p.c.warn("Retry to refresh token failed: "+i),n.addCustomData(a.AttachmentRefreshDownloadToken.datapoint.customData(e)),n.endWithError(s.a.ServerError,i),this.isRefreshingDownloadToken=!1,[3,4];case 4:return[2]}})})},this.useDownloadUrlBase=!Object(d.isStringNullOrWhiteSpace)(this.downloadUrlBase)&&!Object(d.isStringNullOrWhiteSpace)(this.mailboxAddress)&&Object(u.c)("doc-attachment-downloadDomain"),this.downloadToken=i,this.downloadTokenRefreshMinutes<1&&(this.downloadTokenRefreshMinutes=1),this.useDownloadUrlBase&&setInterval(this.refreshDownloadTokenAndRetryInCaseOfFailure,6e4*this.downloadTokenRefreshMinutes)}return e.getInstance=function(){if(!e.instance){var t=Object(c.a)(),n=Object(l.b)().mailboxId,r=t.ApplicationSettings;e.instance=new e(r.DownloadTokenRefreshMinutes,r.DownloadUrlBase,n,r.FirstDownloadToken)}return e.instance},e.resetInstanceForTesting=function(){e.instance=null},e.prototype.getDownloadToken=function(){return this.downloadToken},e.prototype.getUseDownloadUrlBase=function(){return this.useDownloadUrlBase},e.prototype.getDownloadUrlBase=function(){return this.downloadUrlBase},e}();function m(){return h.getInstance().getDownloadToken()}function b(){return h.getInstance().getUseDownloadUrlBase()}function g(){return h.getInstance().getDownloadUrlBase()}},390:function(e,t,n){"use strict";var r=n(939);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b});var a=n(389);n.d(t,"c",function(){return a.a})},394:function(e,t,n){"use strict";var r=n(27),a=n(4);t.a=Object(a.action)("setShowListPane")(function(e){r.a.mailModule.showListPane=e})},402:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(0),a=n(1),i=n(1844),o=n(1846),c=n(372),s=n(1845),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._root=Object(i.a)(),t._onFocusCapture=function(e){t.props.onFocusCapture&&t.props.onFocusCapture(e),e.target!==e.currentTarget&&(t._previouslyFocusedElementInTrapZone=e.target)},t._onKeyboardHandler=function(e){if(t.props.onKeyDown&&t.props.onKeyDown(e),!e.isDefaultPrevented()&&9===e.which&&t._root.current){var n=Object(o.e)(t._root.current,t._root.current.firstChild,!0),r=Object(o.g)(t._root.current,t._root.current.lastChild,!0);e.shiftKey&&n===e.target?(Object(o.b)(r),e.preventDefault(),e.stopPropagation()):e.shiftKey||r!==e.target||(Object(o.b)(n),e.preventDefault(),e.stopPropagation())}},t}return r.__extends(t,e),t.prototype.componentWillMount=function(){t._focusStack.push(this)},t.prototype.componentDidMount=function(){var e=this.props,t=e.isClickableOutsideFocusTrap,n=void 0!==t&&t,r=e.forceFocusInsideTrap,a=void 0===r||r,i=e.elementToFocusOnDismiss,o=e.disableFirstFocus,s=void 0!==o&&o;this._previouslyFocusedElementOutsideTrapZone=i||document.activeElement,Object(c.a)(this._root.current,this._previouslyFocusedElementOutsideTrapZone)||s||this.focus(),a&&this._events.on(window,"focus",this._forceFocusInTrap,!0),n||this._events.on(window,"click",this._forceClickInTrap,!0)},t.prototype.componentWillReceiveProps=function(e){var t=e.elementToFocusOnDismiss;t&&this._previouslyFocusedElementOutsideTrapZone!==t&&(this._previouslyFocusedElementOutsideTrapZone=t)},t.prototype.componentWillUnmount=function(){var e=this,n=this.props.ignoreExternalFocusing;this._events.dispose(),t._focusStack=t._focusStack.filter(function(t){return e!==t});var r=document.activeElement;n||!this._previouslyFocusedElementOutsideTrapZone||"function"!=typeof this._previouslyFocusedElementOutsideTrapZone.focus||!Object(c.a)(this._root.value,r)&&r!==document.body||Object(o.b)(this._previouslyFocusedElementOutsideTrapZone)},t.prototype.render=function(){var e=this.props,t=e.className,n=e.ariaLabelledBy,i=Object(s.f)(this.props,s.e);return a.createElement("div",r.__assign({},i,{className:t,ref:this._root,"aria-labelledby":n,onKeyDown:this._onKeyboardHandler,onFocusCapture:this._onFocusCapture}),this.props.children)},t.prototype.focus=function(){var e=this.props,t=e.focusPreviouslyFocusedInnerElement,n=e.firstFocusableSelector;if(t&&this._previouslyFocusedElementInTrapZone&&Object(c.a)(this._root.value,this._previouslyFocusedElementInTrapZone))Object(o.b)(this._previouslyFocusedElementInTrapZone);else{var r,a="string"==typeof n?n:n&&n();this._root.current&&(r=a?this._root.current.querySelector("."+a):Object(o.h)(this._root.current,this._root.current.firstChild,!0,!1,!1,!0)),r&&Object(o.b)(r)}},t.prototype._forceFocusInTrap=function(e){if(t._focusStack.length&&this===t._focusStack[t._focusStack.length-1]){var n=document.activeElement;Object(c.a)(this._root.current,n)||(this.focus(),e.preventDefault(),e.stopPropagation())}},t.prototype._forceClickInTrap=function(e){if(t._focusStack.length&&this===t._focusStack[t._focusStack.length-1]){var n=e.target;n&&!Object(c.a)(this._root.current,n)&&(this.focus(),e.preventDefault(),e.stopPropagation())}},t._focusStack=[],t}(n(1825).a)},497:function(e,t,n){"use strict";n.d(t,"b",function(){return a});var r=n(3),a=Object(r.createStore)("mruFolderCache",{mruFolders:[],isInitialized:!1}),i=a();t.a=i},509:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(244);function a(e,t){return e.map(function(e){return Object(r.getInstrumentationContext)(e,t)}).filter(function(e){return e})}},520:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"e",function(){return s}),n.d(t,"f",function(){return l}),n.d(t,"g",function(){return u}),n.d(t,"h",function(){return d}),n.d(t,"i",function(){return p}),n.d(t,"j",function(){return f}),n.d(t,"d",function(){return h});var r=n(1210);n.d(t,"b",function(){return r.a});var a=n(2),i=n(34);n.d(t,"a",function(){return i.h});var o=new a.c(function(){return Promise.all([n.e(6),n.e(7),n.e(25),n.e(34),n.e(57)]).then(n.bind(null,1739))}),c=new a.a(o,function(e){return e.clickAttachment}).importAndExecute,s=new a.a(o,function(e){return e.previewAttachment}),l=new a.a(o,function(e){return e.previewAttachmentInNewSxS}),u=new a.a(o,function(e){return e.previewAttachmentInSxS}),d=new a.a(o,function(e){return e.previewImageInNewSxS}),p=new a.a(o,function(e){return e.previewImageInSxS}),f=new a.a(o,function(e){return e.previewLinkInNewSxS}),h=new a.b(o,function(e){return e.downloadAttachment})},532:function(e,t,n){"use strict";var r=n(1842),a=n(1207),i=n(41),o={root:"ms-Link"};n.d(t,"a",function(){return c});var c=Object(r.a)(a.a,function(e){var t,n,r=e.className,a=e.isButton,c=e.isDisabled,s=e.theme,l=s.semanticColors,u=Object(i.getGlobalClassNames)(o,s);return{root:[u.root,Object(i.getFocusStyle)(s,-2),{color:l.link},a&&{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",display:"inline",fontSize:"inherit",margin:0,overflow:"inherit",padding:0,textAlign:"left",textOverflow:"inherit",userSelect:"text",borderBottom:"1px solid transparent",selectors:(t={},t[i.HighContrastSelectorBlack]={color:"#FFFF00"},t[i.HighContrastSelectorWhite]={color:"#00009F"},t["@media screen and (-ms-high-contrast: active), (-ms-high-contrast: none)"]={borderBottom:"none"},t)},!a&&{textDecoration:"none"},c&&["is-disabled",{color:l.disabledText,cursor:"default"},{selectors:{"&:link, &:visited":{pointerEvents:"none"}}}],!c&&{selectors:{"&:active, &:hover, &:active:hover":{color:l.linkHovered,selectors:(n={},n[i.HighContrastSelector]={textDecoration:"underline"},n)},"&:focus":{color:l.link}}},u.root,r]}},void 0,{scope:"Link"})},5598:function(e,t,n){"use strict";n.r(t);var r=n(258),a=n(117),i=n(32),o=n(26),c=n(3),s=n(12),l=(Object(c.orchestrator)(r.a,function(e){"PrimaryMailbox"==e.searchScopeKind?Object(r.f)(Object(i.D)({folderId:Object(o.a)(s.i),kind:"PrimaryMailbox"})):"ArchiveMailbox"==e.searchScopeKind&&Object(r.f)(Object(i.b)({folderId:Object(o.a)(s.d),kind:"ArchiveMailbox"})),e.shouldStartSearch&&Object(a.V)(e.actionSource,a.c.Mail,!1)}),n(0)),u=n(1267),d=n(93),p=n(657),f=n(144),h=(Object(c.orchestrator)(a.i,function(e){return l.__awaiter(void 0,void 0,void 0,function(){var t,n;return l.__generator(this,function(r){return t="",e.attachmentType.__type===f.a.attachmentTypes.FILE_ATTACHMENT_TYPE&&(n={Id:e.attachmentId,mailboxInfo:Object(d.b)()},t=Object(p.b)(n,e.attachmentType,0,!1,!1)),Object(u.a)(t,!1),Object(a.k)("CommandExecuted",e.scenarioId),[2]})})}),n(217));function m(){return Object(h.c)().includeAttachments}function b(){return null!==Object(h.c)().fromDate||null!==Object(h.c)().toDate}var g=n(51),v={Autosuggestion3S:{datapoint:{name:"TnS_Autosuggestion3S"}},LoadMessageSuggestionDatapoint:{datapoint:{name:"Search_LoadMessageSuggestion",customData:function(e){return[e]}}},RefinerClicked:{datapoint:{name:"Search_RefinerClicked",customData:function(e,t){switch(t){case 1:return[e,!0,!1,!1];case 2:return[e,!1,!0,!1];case 3:return[e,!1,!1,!0]}}}},RefinerFolderScopeChanged:{datapoint:{name:"Search_RefinerFolderScopeChanged",customData:function(e,t,n){return[Object(g.a)(e),Object(g.a)(t),n]}}},SearchEndToEnd:{datapoint:{name:"SearchEndToEnd",options:{isQos:!0,isCore:!0}}},searchProcessKeywordSuggestionsDatapoint:{datapoint:{name:"TnS_ProcessKeywordSuggestionsTime"}},searchProcessPeopleSuggestionsDatapoint:{datapoint:{name:"TnS_ProcessPeopleSuggestionsTime"}},StartSearch:{datapoint:{name:"StartSearch",customData:function(e,t){var n=0;return m()&&n++,b()&&n++,[!!e,t,n]}}},CommandSuggestionSelected:{datapoint:{name:"CommandSuggestionSelected",customData:function(e,t){return[e,t]}}},SuggestionSelected:{datapoint:{name:"Search_SuggestionSelected",customData:function(e,t,n,r){return[(a=e,i=a.length,i>10?"11+":i>5?"6-10":i.toString()),t,n,r];var a,i}}},ExecuteCommand:{datapoint:{name:"Search_ExecuteCommand",customData:function(e){return[e]}}}};function S(e){return e===a.c.Mail}var y=n(142);function T(e,t,n,r){return l.__awaiter(this,void 0,void 0,function(){var a,i,o;return l.__generator(this,function(c){switch(c.label){case 0:return(a=window.LPC)&&(i=document.getElementById("lpc__immersive__container"))?(o=y.f.tryImportSync())&&o.isLivePersonaCardInitialized?[3,2]:[4,y.e.import().then(function(e){return e()})]:[2];case 1:c.sent(),o=y.f.tryImportSync(),c.label=2;case 2:return o&&o.isLivePersonaCardInitialized&&a.openCard(i,{personaInfo:{identifiers:{PersonaType:"User",Smtp:e},displayName:t},behavior:{disableHover:r,locationToOpen:n}}),[2]}})})}var O=n(9),w=n(7);Object(c.orchestrator)(a.j,function(e){return l.__awaiter(void 0,void 0,void 0,function(){var t,n,r,o,c,s;return l.__generator(this,function(l){switch(l.label){case 0:return S(e.scenarioId)&&Object(a.o)(a.c.Mail)?(t=Object(a.l)(a.c.Mail),[4,a.s.import()]):[2];case 1:if(n=l.sent(),!(r=n(a.c.Mail)))return[2];switch(o=r.Name,u=o,d=v.ExecuteCommand.datapoint,p=d.name,f=d.customData,Object(O.n)(p,f(u)),c=t.suggestionPillIds[1],s=t.suggestionPills.get(c),o){case"/whois":if(s.kind!=i.a.People)return w.c.error("Attempted to execute /whois with a suggestion that is not a PeopleSuggestion"),[2];T(s.EmailAddresses[0],s.DisplayName,"ExpandedView",!0),Object(a.k)("CommandExecuted",a.c.Mail);break;case"/download":if(s.kind!==i.a.Files)return w.c.error("Attempted to execute /download with a suggestion that is not a FileSuggestion."),[2];Object(a.i)(s.AttachmentId,s.Attachment,a.c.Mail);break;case"/org":if(s.kind!=i.a.People)return w.c.error("Attempted to execute /whois with a suggestion that is not a PeopleSuggestion"),[2];T(s.EmailAddresses[0],s.DisplayName,"ExpandedViewOrganizationSection",!0),Object(a.k)("CommandExecuted",a.c.Mail);break;case"/share":if(s.kind!==i.a.Files)return w.c.error("Attempted to execute /share with a suggestion that is not a FileSuggestion."),[2];Object(a.U)(s.AttachmentId,s.Attachment,a.c.Mail)}return[2]}var u,d,p,f})})});var x=n(250),A=n(27),C=n(6),_=n(74),I=(Object(c.orchestrator)(a.k,function(e){return l.__awaiter(void 0,void 0,void 0,function(){var t;return l.__generator(this,function(n){return S(e.scenarioId)?(Object(C.a)().UserOptions.GlobalReadingPanePositionReact===_.a.Off&&A.a.mailModule.showReadingPane?x.c.importAndExecute():(t=e.actionSource,Object(r.e)(t)),[2]):[2]})})}),n(105)),P=n(16),j=" AND ",D="category:",E="From:({0})",k=/[\ue000\ue001]/g,M=/(category:)/gi,F=/((To:)|(From:))/gi,R=1,L=3,N=" OR ",B=3,U=" ",W="To:({0})";function V(e){for(var t=[],n=0,r=function(){var e=[];Object(P.b)("sea-categoryClientSuggestions")&&e.push({maxSuggestionsToGet:R,suggestionKind:i.a.Category,getSuggestions:H});return e}();n<r.length;n++){var a=r[n];t.push.apply(t,a.getSuggestions(e,a.maxSuggestionsToGet))}return t}function H(e,t){for(var n=Object(I.k)(e,Object(I.l)()),r=[],a=0;a<n.suggestions.length&&r.length<t;a++){var o=n.suggestions[a];(e.length>=B||e.length==o.Name.length)&&r.push({kind:i.a.Category,Name:o.Name,ReferenceId:o.Id})}return r}var z=new Map([["/download",{description:"Download a file to your PC.",icon:"Download",referenceId:"download"}],["/org",{description:"Look at a person's organizational chart.",icon:"Org",referenceId:"organization"}],["/share",{description:"Share a file by email.",icon:"Share",referenceId:"share"}],["/whois",{description:"See contact information, emails, files, and more about a person.",icon:"ContactCard",referenceId:"whois"}]]);function G(e){switch(e){case"/whois":case"/org":return"Person";case"/download":case"/share":return"File";default:throw new Error("Parameter suggestions for the command ${command} are not supported")}}var q=n(8),K=n(110),Y=n(18);function X(e){var t=[];return z.forEach(function(n,r){(function(e){switch(e){case"/whois":return Object(q.c)("rp-livePersonaCard");case"/org":return Object(q.c)("rp-livePersonaCard")&&!Object(K.a)();case"/share":case"/download":return Object(P.b)("sea-fileCommands");default:return!0}})(r)&&0===r.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())&&t.push({kind:i.a.Command,Name:r,Icon:n.icon,Description:n.description,ReferenceId:n.referenceId,ParameterPlaceholder:G(r)})}),t.push({kind:i.a.Keywords,DisplayText:Object(Y.format)('Search for "{0}"',e),QueryText:e,ReferenceId:"Search for",Attributes:{IsHistory:!1,IsAutoCompleteHighConfidence:!1}}),t}var Z=n(2958),Q=n.n(Z),J=n(2647),$=n.n(J);function ee(e){if(!e||!e.Groups)throw new Error('Substrate suggestions response "Groups" should not be null.');for(var t=[],n=0,r=0,a=0,i=e.Groups;a<i.length;a++){var o=i[a];switch(o.Type){case"Text":var c=L-n,s=o.Suggestions.map(te).slice(0,c>0?c:0);t.push.apply(t,s),n+=s.length;break;case"People":c=L-r;var l=o.Suggestions.map(ne).slice(0,c>0?c:0);t.push.apply(t,l),r+=l.length;break;case"Message":if(Object(P.a)("sea-emailSuggestions")){var u=o.Suggestions.map(re);t.push.apply(t,u)}break;case"Attachments":case"Attachment":if(Object(P.a)("sea-filesSuggestions")){var d=o.Suggestions.map(ae);t.push.apply(t,d)}}}return{Suggestions:t,IsComplete:void 0,TraceId:e.Instrumentation.TraceId}}function te(e){return{kind:i.a.Keywords,DisplayText:e.Text,QueryText:e.QueryText,ReferenceId:e.ReferenceId,Attributes:e.Attributes,Segments:e.Segments}}function ne(e){return{kind:i.a.People,DisplayName:e.DisplayName,HighlightedDisplayName:e.Text,EmailAddresses:e.EmailAddresses.map(function(e){return e.replace(k,"")}),ReferenceId:e.ReferenceId,Attributes:e.Attributes,Source:"qf"}}function re(e){return{kind:i.a.Message,Subject:e.Subject,DisplayName:e.From&&e.From.EmailAddress?e.From.EmailAddress.Name:"",ReferenceId:e.ReferenceId,ItemId:e.ItemId,ConversationId:e.ConversationId,DateTimeReceived:e.DateTimeReceived}}function ae(e){var t=e.From&&e.From.EmailAddress?e.From.EmailAddress.Name:"";return{kind:i.a.Files,Name:e.FileName,Subject:e.Subject,Sender:t,Attachment:function(e){if("ClassicAttachment"===e.FileSourceType)return Q()({__type:f.a.attachmentTypes.FILE_ATTACHMENT_TYPE,Name:e.FileName,IsInline:!1,AttachmentId:{Id:e.AttachmentId?e.AttachmentId.Id:null}});return $()({__type:f.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE,Name:e.FileName,AttachmentIsFolder:!1,IsInline:!1,ProviderType:f.a.providers.ONE_DRIVE_PRO,AttachLongPathName:e.AccessUrl,AttachmentId:{Id:e.AttachmentId?e.AttachmentId.Id:null}})}(e),ReferenceId:e.ReferenceId,ItemId:e.ItemId.Id,ConversationId:e.ConversationId.Id,AttachmentId:e.AttachmentId?e.AttachmentId.Id:null,Extension:e.FileExtension,HighlightedDisplayText:e.Text,DateTimeReceived:e.DateCreated}}var ie=Object(c.action)("CLEAR_REFINERS"),oe=Object(c.action)("DELETE_CACHED_SUGGESTION_SET",function(e){return{searchText:e}}),ce=Object(c.action)("loadMessageSuggestion",function(e){return{suggestion:e,datapointConfig:{name:v.LoadMessageSuggestionDatapoint.datapoint.name,customData:{isOpenedInTab:Object(P.a)("sea-emailSuggestionsInTab")}}}}),se=Object(c.action)("ON_CLEAR_REFINERS_BUTTON_CLICKED"),le=Object(c.action)("ON_REFINER_CHANGED",function(e){return{refinerType:e}}),ue=Object(c.action)("ON_SCOPE_REFINER_CHANGED",function(e){return{scopeOption:e}}),de=Object(c.action)("REGISTER_SEARCH_STORE_ORCHESTRATORS"),pe=Object(c.action)("SET_FROM_DATE",function(e){return{fromDate:e}}),fe=Object(c.action)("SET_INCLUDE_ATTACHMENTS",function(e){return{includeAttachments:e}}),he=Object(c.action)("SET_REFINERS_VISIBILITY",function(e){return{isVisible:e}}),me=Object(c.action)("SET_TO_DATE",function(e){return{toDate:e}}),be=Object(c.action)("showSxSForFileSuggestion",function(e){return{suggestion:e}}),ge=Object(c.action)("UPDATE_CACHED_SUGGESTION_SET",function(e,t){return{searchText:e,suggestions:t}}),ve=Object(c.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE",function(e,t){return{searchText:e,isComplete:t}});function Se(e,t){var n,r="none";switch("PrimaryMailbox"==t.kind&&(r=Object(g.a)(t.folderId)),r){case"sentitems":case"drafts":n=W;break;default:n=E}var a=[];return a.push(Object(Y.format)(n,e.DisplayName)),e.EmailAddresses.forEach(function(e){a.push(Object(Y.format)(n,e))}),a.join(N)}function ye(){return[function(){var e=Object(a.l)(a.c.Mail).suggestionPills;if(0===e.size)return null;return e.values().slice().map(function(e){switch(e.kind){case i.a.People:return Object(P.b)("sea-sendPillDisplayText")?e.DisplayName:Object(P.b)("sea-sendPillQueryText")?Se(e,Object(h.c)().staticSearchScope):null;default:return null}}).filter(function(e){return e}).join(" ")}(),function(){var e=Object(a.l)(a.c.Mail).suggestionSegments;if(0===e.size)return null;return e.values().slice().map(function(e){switch(e.Type){case"Text":return e.Text;case"Person":return e.DisplayName;default:return null}}).filter(function(e){return e}).join(" ")}(),Object(a.l)(a.c.Mail).searchTextForSuggestion].filter(function(e){return e&&e.length>0}).join(" ")}var Te=n(668),Oe=n.n(Te),we=n(891),xe=n.n(we),Ae=n(257),Ce=n.n(Ae),_e=n(870),Ie=n.n(_e),Pe=n(889),je=n.n(Pe),De=n(30),Ee={BaseShape:"Default"};function ke(e,t,n){return je()(Oe()({Header:Object(De.getJsonRequestHeader)(),Body:xe()({IndexedPageItemView:Ce()({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:n}),PersonaShape:Ie()(Ee),QuerySources:["Mailbox","Directory"],QueryString:e,SearchPeopleSuggestionIndex:!0,ShouldResolveOneOffEmailAddress:!1})})).then(function(e){return e&&e.Body&&"Success"==e.Body.ResponseClass&&e.Body.ResultSet?e.Body.ResultSet:[]},function(e){return[]})}var Me=n(1542);function Fe(e,t){return Re(Object(Me.a)(e,t),"localCache")}function Re(e,t){var n=[];return e.forEach(function(e){n.push({kind:i.a.People,DisplayName:e.DisplayName,HighlightedDisplayName:e.DisplayName,EmailAddresses:e.EmailAddresses.map(function(e){return e.EmailAddress}),ReferenceId:e.PersonaId.Id,Attributes:void 0,Source:t,MailboxType:e.EmailAddress.MailboxType}),0===e.EmailAddresses.length&&w.c.info("Received persona with no email address.")}),n}function Le(e,t){return l.__awaiter(this,void 0,void 0,function(){var n,r,o,c,s,u,d,p,f;return l.__generator(this,function(h){switch(h.label){case 0:return Object(K.a)()?[2,e]:(n=t?e.filter(function(e){return e.kind==i.a.People}):e,Object(P.b)("sea-galSuggestions")&&n.length<L?(r=e.slice(0),[4,function(){return l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(e){switch(e.label){case 0:return[4,ke(ye(),Object(a.l)(a.c.Mail).searchSessionGuid,L)];case 1:return[2,Re(e.sent(),"gal")]}})})}()]):[3,2]);case 1:for(o=h.sent(),c=[],s=0;s<o.length;s++)if(u=o[s],d=!1,(p=u).EmailAddresses&&p.EmailAddresses[0]&&(d=!0),d){for(f=0;f<n.length;f++)if(Ne(n[f],p)){d=!1;break}d&&c.push(u)}return r.push.apply(r,c.splice(0,L-n.length)),[2,r];case 2:return[2,e]}})})}function Ne(e,t){if(!e.EmailAddresses||!t.EmailAddresses)return!1;if(e.EmailAddresses[0])for(var n=e.EmailAddresses[0].toLocaleLowerCase(),r=0;r<t.EmailAddresses.length;r++)if(n===t.EmailAddresses[r].toLocaleLowerCase())return!0;return!1}function Be(e,t){return l.__awaiter(this,void 0,void 0,function(){var n;return l.__generator(this,function(r){switch(r.label){case 0:switch(n=[],e){case"/whois":case"/org":return[3,1];case"/download":case"/share":return[3,4]}return[3,6];case 1:return[4,function(e){return l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(t){switch(t.label){case 0:return[4,Ue(e,"People")];case 1:return[2,t.sent()]}})})}(t)];case 2:return[4,Le(n=r.sent(),!1)];case 3:return n=r.sent(),[3,7];case 4:return[4,function(e){return l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(t){switch(t.label){case 0:return[4,Ue(e,"Attachment")];case 1:return[2,t.sent()]}})})}(t)];case 5:return n=(n=r.sent()).filter(function(e){return e.kind==i.a.Files&&e.Attachment.__type==f.a.attachmentTypes.FILE_ATTACHMENT_TYPE}),[3,7];case 6:throw new Error("Parameter suggestions for the command ${command} are not supported");case 7:return[2,n]}})})}function Ue(e,t){return l.__awaiter(this,void 0,void 0,function(){var n,r,o,c,s;return l.__generator(this,function(l){switch(l.label){case 0:return n=Object(a.l)(a.c.Mail),r={"client-session-id":n.searchSessionGuid,"x-client-localtime":Object(i.j)(),"client-request-id":n.latestQFRequestId},[4,Object(i.H)(e,n.searchSessionGuid,n.nextSearchQueryId,t,"",r)];case 1:o=l.sent(),l.label=2;case 2:return l.trys.push([2,4,,5]),[4,o.json()];case 3:return c=l.sent(),s=c.Groups?ee(c):null,[2,s?s.Suggestions:[]];case 4:return l.sent(),[2,[]];case 5:return[2]}})})}var We=n(2959),Ve=n.n(We);var He=n(39),ze=n(695);function Ge(e,t,n){return l.__awaiter(this,void 0,void 0,function(){var r,a,i;return l.__generator(this,function(o){switch(o.label){case 0:return[4,(c=e,s=t,l=n,Ve()({Header:Object(De.getJsonRequestHeader)(),Body:{Query:c,SearchSessionId:s,MaxSuggestionsCountPerSuggestionType:l,SuggestionTypes:1,SuggestionsPrimer:!1}}).then(function(e){return e&&e.Body&&e.Body.SearchSuggestions?e.Body.SearchSuggestions.Suggestions.slice(0,l):[]}))];case 1:return r=o.sent(),a=new O.c(v.searchProcessKeywordSuggestionsDatapoint.datapoint.name),i=r.map(function(e){return Ke(e.DisplayText,e.SuggestedQuery,e.TDSuggestionId.toString(),!1)}),ge(e,i),a.end(),[2,i]}var c,s,l})})}function qe(e){var t=function(e){for(var t=Object(He.h)().ViewStateConfiguration.SearchHistory||[],n=[],r=0;r<t.length&&n.length<e;r++){var a=t[r];a.match(F)||a.match(M)||n.push(a)}return n.map(function(e,t){return Ke(e,e,t.toString(),!0)})}(e);return Object(P.a)("sea-qf")||ge("",t),t}function Ke(e,t,n,r){return{kind:ze.a.Keywords,DisplayText:e,QueryText:t,ReferenceId:n,Attributes:{IsHistory:r,IsAutoCompleteHighConfidence:void 0}}}function Ye(){return l.__awaiter(this,void 0,void 0,function(){var e,t,n,r;return l.__generator(this,function(i){switch(i.label){case 0:return e=Object(a.l)(a.c.Mail),[4,Ge(t=ye(),e.searchSessionGuid,L)];case 1:return n=i.sent(),[4,function(e,t,n,r){return l.__awaiter(this,void 0,void 0,function(){var t,a,i,o;return l.__generator(this,function(c){switch(c.label){case 0:return t=Fe(e,n),0==n-t.length?[2,Promise.resolve(t)]:[4,ke(e,0,n)];case 1:return a=c.sent(),i=new O.c(v.searchProcessPeopleSuggestionsDatapoint.datapoint.name),o=Re(a,r),ge(e,o),i.end(),[2,o]}})})}(t,e.searchSessionGuid,L,"gal")];case 2:return r=i.sent(),[2,Promise.all([n,r]).then(function(e){return e.reduce(function(e,t){return e.concat(t)})})]}})})}var Xe=n(42);function Ze(){return l.__awaiter(this,void 0,void 0,function(){var e,t,n,r,o,c,s,u,d,p;return l.__generator(this,function(l){switch(l.label){case 0:return e=Object(a.l)(a.c.Mail),t=new Date,n={"client-session-id":e.searchSessionGuid,"x-client-localtime":Object(i.j)(),"client-request-id":e.latestQFRequestId},(r=function(e){if(e)switch(e.kind){case"PrimaryMailbox":case"ArchiveMailbox":var t=e.folderId,n=Object(g.a)(t);return"none"!==n?"DistinguishedFolderName="+n+";FolderId="+t:"FolderId="+t;default:return null}return null}(Object(h.c)().staticSearchScope))&&(n["x-user-context"]=r),o=new O.c(v.Autosuggestion3S.datapoint.name),[4,Object(i.H)(ye(),e.searchSessionGuid,e.nextSearchQueryId,function(){var e=["Text","People"];Object(P.a)("sea-emailSuggestions")&&e.push("Message");Object(P.a)("sea-filesSuggestions")&&e.push("Attachment");return e.join(",")}(),function(){var e=[];Object(q.c)("sea-gf")&&e.push("text","person");return e.join(",")}(),n)];case 1:if(c=l.sent(),o.end(),!c)return[2,[]];i.w.importAndExecute(c.headers.get("request-id"),o.getData(Xe.c.e2eTimeElapsed),c.status,new Date),l.label=2;case 2:return l.trys.push([2,5,,6]),[4,c.json()];case 3:return s=l.sent(),[4,a.K.import()];case 4:return l.sent()(s.Instrumentation.TraceId,a.c.Mail,!0),u=s.Groups?ee(s):null,d=u?u.Suggestions:[],(!(p=e.displayedQFRequestTime)||t.getTime()>p.getTime())&&ye()?(Object(a.T)(t,a.c.Mail),[2,d]):(i.v.importAndExecute(u.TraceId),[2,e.currentSuggestions&&e.currentSuggestions.Suggestions||[]]);case 5:return l.sent(),[2,[]];case 6:return[2]}})})}function Qe(){Object(P.a)("sea-qf")||oe("");var e,t=qe(L)||[],n=(e=Fe("",L),Object(P.a)("sea-qf")||ge("",e),e||[]),r=Object(q.c)("sea-slashCommands")?function(){var e=[];Object(q.c)("rp-livePersonaCard")&&e.push(Object(K.a)()?"/whois":"/org");Object(P.b)("sea-fileCommands")&&e.push("/share");for(var t=[],n=0,r=e;n<r.length;n++){var a=r[n],i=z.get(a);t.push({kind:ze.a.Command,Name:a,Icon:i.icon,Description:i.description,ReferenceId:i.referenceId,ParameterPlaceholder:G(a)})}return t}():[];return Promise.resolve([t,n,r]).then(function(e){return e.reduce(function(e,t){return e.concat(t)})})}var Je,$e,et=n(104),tt=function(e,t,n){if(!Je){var r=new O.c("WarmupSearchRequest");Je=Object(i.g)(Object(i.l)(0),e,t,Object(et.getGuid)(),n,-1,"MailConversations",r,"SuggestionsWarmUp","SubstrateSearch",3,!0,null,null,null,null,"Hybrid").then(function(){r.end(),Je=null,$e!=e&&tt($e,t,n)})}},nt=function(e,t,n){Object(P.a)("sea-substrateQuery")&&Object(P.b)("sea-warmupQueries")&&e&&"PrimaryMailbox"==n.kind&&($e=e,tt(e,t,n))},rt=n(5);function at(){var e=Object(rt.v)().tableQuery;if(e.searchScope)return"SharedFolders"===e.searchScope.kind;var t=e.folderId;return t&&Object(s.D)(t,s.j)}Object(c.orchestrator)(a.m,function(e){return l.__awaiter(void 0,void 0,void 0,function(){var t,n,r,i,o;return l.__generator(this,function(c){switch(c.label){case 0:return S(e.scenarioId)?(t=Object(a.l)(a.c.Mail),n=t.searchTextForSuggestion,r=ye(),i=null,r&&Object(P.a)("sea-qf")?(i=Object(et.getGuid)(),[4,a.J.import()]):[3,2]):[2];case 1:c.sent()(i,a.c.Mail),c.label=2;case 2:return e.isInCommandMode?(function(e){l.__awaiter(this,void 0,void 0,function(){var t,n,r;return l.__generator(this,function(i){switch(i.label){case 0:return Object(a.n)(a.c.Mail)?[3,1]:(t=X(e),[3,4]);case 1:return[4,a.s.import()];case 2:return n=i.sent(),null==(r=n(a.c.Mail))?[2]:[4,Be(r.Name,e)];case 3:t=i.sent(),i.label=4;case 4:return[4,a.w.import()];case 5:return i.sent()(a.c.Mail)||Object(a.S)({Suggestions:t,IsComplete:!0},a.c.Mail),[4,a.I.import()];case 6:return i.sent()(!0,a.c.Mail),[2]}})})}(n),[2]):(nt(r,t.searchSessionGuid,Object(h.c)().staticSearchScope),Object(P.b)("sea-qFDebounceOff")?(it(r),[3,5]):[3,3]);case 3:return[4,a.v.import()];case 4:o=c.sent(),setTimeout(function(){n===t.searchTextForSuggestion&&o(i,a.c.Mail)&&it(r)},150),c.label=5;case 5:return[2]}})})});function it(e){return l.__awaiter(this,void 0,void 0,function(){var t,n,r,o,c;return l.__generator(this,function(s){switch(s.label){case 0:return e?[3,3]:[4,a.K.import()];case 1:return s.sent()(Object(a.h)().latestTraceId,a.c.Mail,!0),[4,Qe()];case 2:return t=s.sent(),Object(a.S)({Suggestions:t,IsComplete:!0},a.c.Mail),[2];case 3:return n=function(){return l.__awaiter(this,void 0,void 0,function(){var e;return l.__generator(this,function(t){switch(t.label){case 0:return Object(P.a)("sea-qf")?[4,Ze()]:[2,Ye()];case 1:return e=t.sent(),Object(K.a)()?[2,e]:[4,Le(e,!0)];case 2:return[2,t.sent()]}})})}(),r=V(e)||[],[4,n];case 4:return o=s.sent()||[],at()&&(r=r.filter(function(e){return ot(e)}),o=o.filter(function(e){return ot(e)})),u=o.concat(r),d=u.filter(function(e){return e.kind===i.a.Keywords||e.kind===i.a.People}),p=u.filter(function(e){return e.kind===i.a.Category}),f=u.filter(function(e){return e.kind===i.a.Message}),h=u.filter(function(e){return e.kind===i.a.Files}),c=[].concat(d,p,f,h),ye()&&Object(a.S)({Suggestions:c,IsComplete:!0},a.c.Mail),Object(P.a)("sea-qf")?[4,a.O.import()]:[3,6];case 5:return s.sent()(!0,a.c.Mail),[3,7];case 6:ve(e,!0),s.label=7;case 7:return[2]}var u,d,p,f,h})})}function ot(e){return e.kind===i.a.Keywords||e.kind===i.a.People}var ct=n(672),st=n(48),lt=n(54),ut=n(121);function dt(e,t,n){var i=Object(h.c)(),o=Object(a.l)(a.c.Mail),c={folderId:null,type:1,listViewType:Object(rt.v)().tableQuery.listViewType,searchNumber:i.searchNumber,queryString:o.searchTextForSuggestion,searchScope:i.staticSearchScope,pillSuggestions:o.suggestionPills.values().slice(),includeAttachments:i.includeAttachments,fromDate:i.fromDate,toDate:i.toDate,scenarioType:"messageSuggestion"};Object(r.b)("SearchBoxSuggestionDropDown",e,c,t,o.latestTraceId,n)}function pt(e){var t=new RegExp(ut.j,"g"),n=new RegExp(ut.c,"g");return e.replace(t,"").replace(n,"")}function ft(e){var t=Object(A.c)().conversations.get(e),n=[];return(t?t.conversationNodeIds:[]).forEach(function(e){var t=Object(A.c)().conversationNodes.get(e);(t?t.itemIds:[]).forEach(function(e){n.push({Id:e})})}),n}function ht(){return l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(e){switch(e.label){case 0:return[4,a.w.import()];case 1:return e.sent()(a.c.Mail)||Object(a.V)("SearchScopeRefiner",a.c.Mail,!1),[2]}})})}Object(c.orchestrator)(ce,function(e){return l.__awaiter(void 0,void 0,void 0,function(){var t,n,r,a,i,o,c;return l.__generator(this,function(s){switch(s.label){case 0:return t=e.suggestion,0!=Object(rt.v)().tableQuery.listViewType?[3,3]:(n=t.ConversationId.Id,Object(A.c)().conversations.get(n)?[3,2]:(r={Id:n,mailboxInfo:Object(st.a)()},[4,Object(lt.j)(r,"LoadSearchSuggestionConversation")]));case 1:s.sent(),s.label=2;case 2:return a=ft(n),dt({ConversationId:{Id:n},ConversationTopic:pt(t.Subject),GlobalUnreadCount:0,UnreadCount:0,GlobalItemIds:a,ItemIds:a,UniqueSenders:[pt(t.DisplayName)],LastDeliveryTime:t.DateTimeReceived,LastDeliveryOrRenewTime:t.DateTimeReceived,LastModifiedTime:t.DateTimeReceived,InstanceKey:"0"},t.ReferenceId,t.ItemId.Id),[3,8];case 3:return(i=Object(A.c)().items.get(t.ItemId.Id))&&i.NormalizedBody?(dt(i,t.ReferenceId),[3,8]):[3,4];case 4:return o={Id:t.ItemId.Id,mailboxInfo:Object(st.a)()},[4,Object(lt.k)(o,"LoadSearchSuggestionItem")];case 5:return(c=s.sent())?[3,7]:[4,function(e){return l.__awaiter(this,void 0,void 0,function(){var t,n,r;return l.__generator(this,function(a){switch(a.label){case 0:return t=Object(A.c)().conversations.get(e),n={Id:e,mailboxInfo:Object(st.a)()},t?[3,2]:[4,Object(lt.j)(n,"LoadSearchSuggestionConversation")];case 1:a.sent(),a.label=2;case 2:return o=ft((i=n).Id),c=Object(ct.a)()?o.length-1:0,r={mailboxInfo:i.mailboxInfo,Id:o[c].Id},[4,Object(lt.k)(r,"LoadSearchSuggestionItem")];case 3:return[2,a.sent()]}var i,o,c})})}(t.ConversationId.Id)];case 6:c=s.sent(),s.label=7;case 7:dt(c,t.ReferenceId),s.label=8;case 8:return[2]}})})});Object(c.orchestrator)(se,function(){ie(),ht()}),Object(c.orchestrator)(le,function(e){return l.__awaiter(void 0,void 0,void 0,function(){var t,n,r,i,o;return l.__generator(this,function(c){switch(c.label){case 0:return t=e.refinerType,n=v.RefinerClicked.datapoint,r=n.name,i=n.customData,[4,a.w.import()];case 1:return o=c.sent(),Object(O.n)(r,i(o(a.c.Mail),t)),ht(),[2]}})})}),Object(c.orchestrator)(ue,function(e){return l.__awaiter(void 0,void 0,void 0,function(){var t,n,a,i,o,c;return l.__generator(this,function(s){return t=e.scopeOption,n=Object(h.c)().staticSearchScope,Object(r.f)(t.searchScope),a=Object(h.c)().staticSearchScope,("PrimaryMailbox"===n.kind&&"PrimaryMailbox"===a.kind||"ArchiveMailbox"===n.kind&&"ArchiveMailbox"===a.kind)&&(i=v.RefinerFolderScopeChanged.datapoint,o=i.name,c=i.customData,Object(O.n)(o,c(n.folderId,a.folderId,a.kind))),ht(),[2]})})});function mt(e,t){var n=t.suggestionReferenceId,r=void 0===n?"N/A":n,o=t.suggestionKind,c=void 0===o?"N/A":o,s=t.interactionType,l=void 0===s?"N/A":s,u=t.referenceKey,d=void 0===u?"N/A":u,p=Object(a.l)(a.c.Mail),f=p.searchSessionGuid,h=p.nextSearchQueryId;w.c.error("1439c246-8be2-46a2-95a9-6e4eaeb15412: event => "+e+", sessionId => "+f+", cvid => "+h+", suggestionKind => "+c+", suggestionReferenceId => "+r+", interactionType => "+l+", referenceKey => "+d+", isCategorySearch => "+function(){var e=Object(a.l)(a.c.Mail),t=e.suggestionPills;if(e.searchText)return!1;if(1!==t.size)return!1;return t.values()[0].kind===i.a.Category}())}var bt=n(47);Object(c.orchestrator)(bt.l,function(e){return l.__awaiter(void 0,void 0,void 0,function(){return l.__generator(this,function(t){return Object(P.a)("sea-qf")&&Object(P.a)("sea-resultInstrumentation")&&Object(P.b)("sea-commonSearchBox")&&e.instrumentationContexts&&e.instrumentationContexts.forEach(function(t){t?(i.A.importAndExecute(t.traceId,e.interactionType,t.referenceKey||(t.index+1).toString(),new Date),t.traceId||mt("resultinteraction",{interactionType:e.interactionType,referenceKey:t.referenceKey||(t.index+1).toString()})):Object(rt.n)()&&"ReadingPaneDisplayEnd"!==e.interactionType&&mt("resultinteraction",{interactionType:e.interactionType})}),[2]})})});var gt=n(133);Object(c.orchestrator)(a.P,function(e){return l.__awaiter(void 0,void 0,void 0,function(){var t;return l.__generator(this,function(n){switch(n.label){case 0:return S(e.scenarioId)?[4,a.w.import()]:[2];case 1:return t=n.sent(),Object(a.l)(a.c.Mail).searchSessionGuid&&t(a.c.Mail)&&!Object(rt.n)()?[4,a.r.import()]:[3,3];case 2:n.sent()(a.c.Mail),Object(gt.a)(),n.label=3;case 3:return[2]}})})});Object(c.orchestrator)(he,function(e){return l.__awaiter(void 0,void 0,void 0,function(){return l.__generator(this,function(t){switch(t.label){case 0:return e.isVisible&&Object(a.l)(a.c.Mail).isSuggestionsDropdownVisible?[4,a.I.import()]:[3,2];case 1:t.sent()(!1,a.c.Mail),t.label=2;case 2:return[2]}})})});var vt=Object(c.mutatorAction)("setIsSearchHistoryDirty",function(e){h.a.isSearchHistoryDirty=e}),St=Object(c.mutatorAction)("setPreviousNode",function(e){h.a.previousNode=e}),yt=n(92),Tt=Object(c.mutatorAction)("setStaticSearchScopeData",function(e){if(e)return h.a.initialSearchScope=h.b.initialSearchScope,h.a.staticSearchScope=h.b.staticSearchScope,void(h.a.staticSearchScopeList=h.b.staticSearchScopeList);var t=yt.a.selectedNode,n=t.id;if(!n)throw new Error("selectedNodeId should not be null when setting the search scope for search.");n!=Object(o.a)("inbox")&&1!=t.type&&5!=t.type&&4!=t.type&&3!=t.type||(n=Object(o.a)(s.i)),2==t.type?h.a.staticSearchScope=Object(i.F)({groupId:n,kind:"Group"}):t.treeType==s.c?h.a.staticSearchScope=Object(i.b)({folderId:n,kind:"ArchiveMailbox"}):t.treeType==s.j?h.a.staticSearchScope=Object(i.E)({folderId:n,kind:"SharedFolders"}):h.a.staticSearchScope=Object(i.D)({folderId:n,kind:"PrimaryMailbox"}),h.a.initialSearchScope=h.a.staticSearchScope,h.a.staticSearchScopeList=Object(i.o)(h.a.initialSearchScope)}),Ot=n(106),wt=n.n(Ot),xt=n(60),At=n.n(xt),Ct=n(134),_t=n(4),It=Object(_t.action)("addToLocalSearchHistory")(Object(_t.select)({viewStateConfiguration:function(){return Object(He.h)().ViewStateConfiguration},searchStore:function(){return h.a}})(function(e,t){var n=t.viewStateConfiguration;if(n.SearchHistory||(n.SearchHistory=[]),n.SearchHistory.length>0){for(var r=e.toLocaleLowerCase().trim(),a=-1,i=0;i<n.SearchHistory.length;i++){if(n.SearchHistory[i].trim().toLocaleLowerCase()==r){a=i;break}}a>-1&&n.SearchHistory.splice(a,1)}n.SearchHistory.unshift(e),n.SearchHistory.splice(100),t.searchStore.isSearchHistoryDirty=!0}));var Pt=n(2),jt=new Pt.c(function(){return n.e(166).then(n.bind(null,5661))}),Dt=new Pt.b(jt,function(e){return e.logFloodgateActivity});Object(c.orchestrator)(a.Q,function(e){return l.__awaiter(void 0,void 0,void 0,function(){return l.__generator(this,function(t){switch(t.label){case 0:return S(e.scenarioId)?(Object(P.a)("sea-substrateQuery")||Object(i.f)(e.searchSessionGuid),h.a.isSearchHistoryDirty&&(n=Object(He.h)().ViewStateConfiguration.SearchHistory,Object(Ct.a)("OWA.ViewStateConfiguration",[wt()({DictionaryKey:At()({Type:"String",Value:["SearchHistory"]}),DictionaryValue:At()({Type:"StringArray",Value:n})})])),pe(h.b.fromDate),fe(h.b.includeAttachments),vt(h.b.isSearchHistoryDirty),St(h.b.previousNode),Tt(!0),me(h.b.toDate),he(!1),Object(P.b)("sea-floodgateSurvey")&&0!==h.a.searchNumber?[4,Dt.import()]:[3,2]):[2];case 1:t.sent()("SearchExecuted",e.latestTraceId),t.label=2;case 2:return[2]}var n})})});Object(c.orchestrator)(a.R,function(e){return l.__awaiter(void 0,void 0,void 0,function(){var t,n,r,o;return l.__generator(this,function(c){return S(e.scenarioId)?(t=e.actionSource,n=e.shouldStartSearch,r=Object(a.l)(a.c.Mail),Tt(),o=function(){var e=yt.a.selectedNode;switch(e.type){case 1:var t=e;return{DisplayName:t.displayName,EmailAddresses:t.allEmailAddresses,kind:i.a.People,ReferenceId:t.id};case 4:var n=e.id;return{Name:Object(I.j)(n,Object(I.l)()),kind:i.a.Category,ReferenceId:n};default:return null}}(),Object(a.e)(o,!0,a.c.Mail),Object(P.a)("sea-substrateQuery")||Object(i.h)(r.searchSessionGuid,h.a.staticSearchScope),n?Object(a.V)(t,a.c.Mail):Object(a.m)(a.c.Mail,!1),[2]):[2]})})});var Et=n(195),kt=n(1303),Mt=n(75),Ft=(Object(c.orchestrator)(a.U,function(e){return l.__awaiter(void 0,void 0,void 0,function(){var t,n;return l.__generator(this,function(r){switch(r.label){case 0:return[4,Et.b.import()];case 1:return t=r.sent(),e.attachmentType.Size=0,n=t(e.attachmentType),Object(P.b)("rp-tabView")?Object(kt.a)([n],Mt.a.SecondaryTab):Object(kt.a)([n],Mt.a.Popout),Object(a.k)("CommandExecuted",e.scenarioId),[2]}})})}),n(85)),Rt=n(2555),Lt=n(1254),Nt=n(2302),Bt=n(2648),Ut=n(149),Wt=n(2794),Vt=n(136),Ht=n(73),zt=n(520),Gt=n(34);function qt(e,t,n,r,i){return void 0===i&&(i=!0),l.__awaiter(this,void 0,void 0,function(){var o;return l.__generator(this,function(c){switch(c.label){case 0:return[4,Gt.u.importAndExecute(Gt.y,t,n,[])];case 1:return c.sent(),o={referenceKey:r,index:-1,traceId:Object(a.l)(a.c.Mail).latestQFTraceId},i?[4,Ht.g.importAndExecute(t,o,n,[],e.Id)]:[3,3];case 2:c.sent(),c.label=3;case 3:return[2]}})})}function Kt(e){switch(e.kind){case"PrimaryMailbox":case"ArchiveMailbox":case"SharedFolders":return t=e,Object(rt.q)(t.folderId);case"Group":return 0;default:throw new Error("Unregistered search scope")}var t}Object(c.orchestrator)(be,function(e){return l.__awaiter(void 0,void 0,void 0,function(){var t,n,r;return l.__generator(this,function(i){switch(i.label){case 0:return t=e.suggestion,n={Id:t.ConversationId,mailboxInfo:Object(d.b)()},r={Id:t.ItemId,mailboxInfo:Object(d.b)()},t.AttachmentId||t.Attachment.__type!==f.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE?[3,2]:[4,function(e,t,n){return l.__awaiter(this,void 0,void 0,function(){var r,i,o,c=this;return l.__generator(this,function(s){switch(s.label){case 0:return Object(Vt.b)("doc-SxS-refactor")?[3,3]:(r={downloadUrl:null,isDownloadDisabled:!0,size:0,attachmentId:null,name:e.Attachment.Name,itemId:t,isDraft:!1,mode:Gt.g.View,savingAttachmentId:null,editAllowed:!1,saveToCloudStatus:Gt.l.disabled,addToCalendarStatus:0,isCloudy:!0,type:Ft.a.Wac,errorMessage:null,perfDatapoint:null},i=l.__assign({},r,{clickTime:(new Date).getTime(),mode:Gt.g.PendingUrl,wacUrl:null,wacEditUrl:null}),[4,qt(t,n,e.Subject,e.ReferenceId)]);case 1:return s.sent(),[4,Gt.w.import()];case 2:return s.sent()(i),Object(Nt.a)(Gt.k.Initial),function(e){l.__awaiter(this,void 0,void 0,function(){var t,n;return l.__generator(this,function(r){switch(r.label){case 0:return[4,Object(Rt.a)(e.AttachLongPathName,0)];case 1:return t=r.sent(),n=0===t.Status?l.__assign({},Gt.y.state,{clickTime:(new Date).getTime(),mode:Gt.g.View,wacUrl:[t.WacUrl,t.Token],wacEditUrl:null}):l.__assign({},Gt.y.state,{clickTime:(new Date).getTime(),mode:Gt.g.Error,errorMessage:Object(Wt.a)(t.Status)}),Object(Bt.a)(n),[2]}})})}(e.Attachment),[3,4];case 3:o={referenceKey:e.ReferenceId,index:-1,traceId:Object(a.l)(a.c.Mail).latestQFTraceId},zt.j.importAndExecute(function(){return l.__awaiter(c,void 0,void 0,function(){var t;return l.__generator(this,function(n){switch(n.label){case 0:return[4,Object(Rt.a)(e.Attachment.AttachLongPathName,0)];case 1:if(0===(t=n.sent()).Status)return[2,[t.WacUrl,t.Token]];throw new Error(Object(Wt.a)(t.Status))}})})},t,zt.a.FilesHub,{method:zt.b.LoadConversationReadingPane,conversationId:n,conversationSubject:e.Subject,conversationCategories:[],itemIdToScrollTo:t.Id},o),s.label=4;case 4:return[2]}})})}(t,r,n)];case 1:return i.sent(),[3,4];case 2:return[4,function(e,t,n){return l.__awaiter(this,void 0,void 0,function(){var r,i,o,c,s,u;return l.__generator(this,function(l){switch(l.label){case 0:return r={Id:e.AttachmentId,mailboxInfo:Object(d.b)()},[4,Et.d.import()];case 1:return i=l.sent(),[4,f.e.import()];case 2:return o=l.sent(),[4,f.c.import()];case 3:return l.sent()([{attachmentId:r,attachment:e.Attachment}],!0),c=o(r),s=i(r,!0,!0,1===c.type),Object(Lt.a)(s,c,s.strategy.supportedMenuActions),u={referenceKey:e.ReferenceId,index:-1,traceId:Object(a.l)(a.c.Mail).latestQFTraceId},Object(Vt.b)("doc-SxS-refactor")?[3,5]:[4,qt(t,n,e.Subject,e.ReferenceId,Object(Ut.e)(s.strategy)===Ut.a.Preview)];case 4:return l.sent(),Object(zt.c)(s,zt.a.FilesHub,u,t,!1,null,null),[3,6];case 5:zt.f.importAndExecute(s,t,!1,zt.a.FilesHub,null,{method:zt.b.LoadConversationReadingPane,conversationId:n,conversationSubject:e.Subject,conversationCategories:[],itemIdToScrollTo:t.Id},u),l.label=6;case 6:return[2]}})})}(t,r,n)];case 3:i.sent(),i.label=4;case 4:return[2]}})})});var Yt=Object(c.mutatorAction)("setSearchNumber",function(e){h.a.searchNumber=e});Object(c.orchestrator)(a.V,function(e){return l.__awaiter(void 0,void 0,void 0,function(){var t,n,o,c,s,u,d,p,f,m,b,y,T,w,x;return l.__generator(this,function(l){switch(l.label){case 0:return S(e.scenarioId)?(t=e.actionSource,n=e.explicitSearch,[4,a.w.import()]):[2];case 1:if(o=l.sent(),c=Object(a.l)(a.c.Mail),o(a.c.Mail))throw new Error("startSearch should not be dispatched without anything to search for.");return c.searchSessionGuid?[3,3]:[4,a.N.import()];case 2:return l.sent()(t,!0,a.c.Mail),[2];case 3:return s=new O.c(v.SearchEndToEnd.datapoint.name,v.SearchEndToEnd.datapoint.options),n&&Object(P.a)("sea-qf")?(u=c.selectedSuggestionIndex)>-1?[4,a.t.import()]:[3,5]:[3,6];case 4:return d=l.sent(),p=d(u,a.c.Mail),f=Object(a.l)(a.c.Mail).latestTraceId,(p.kind===i.a.People?"qf"===p.Source:f)&&i.t.importAndExecute(f,p.ReferenceId,new Date),[3,6];case 5:m="00000000-0000-0000-0000-000000000000",b=c.latestQFTraceId||c.latestQFRequestId||m,i.z.importAndExecute(b,new Date),b===m&&mt("searchdone"),l.label=6;case 6:return R=v.StartSearch.datapoint,L=R.name,B=R.customData,W=Object(a.l)(a.c.Mail),Object(O.n)(L,B(W.searchText,W.suggestionPillIds.length)),y=function(){for(var e=Object(a.l)(a.c.Mail),t=[],n=0;n<e.suggestionPillIds.length;n++){var r=e.suggestionPills.get(e.suggestionPillIds[n]);switch(r.kind){case i.a.People:t.push(Se(r,h.a.staticSearchScope));break;case i.a.Category:t.push(D+'"'+r.Name+'"')}}var o="";t.length>0&&(o=t.join(N));var c="";return e.suggestionSegments.size>0&&(c=e.suggestionSegments.values().slice().map(function(e){return e.QueryText}).join(j)),[o,c,e.searchText].map(function(e){return e&&e.trim()}).filter(function(e){return e.length>0}).join(U)}(),Yt(h.a.searchNumber+1),It(y),T=Kt(h.a.staticSearchScope),A=h.a.searchNumber,C=y,_=h.a.staticSearchScope,I=c.suggestionPills,E=T,k=h.a.includeAttachments,M=h.a.fromDate,F=h.a.toDate,w={folderId:null,type:1,listViewType:E,searchNumber:A,queryString:C,searchScope:_,pillSuggestions:I.values().slice(),includeAttachments:k,fromDate:M,toDate:F,scenarioType:"mail"},x=function(e){var t=null;switch(e.kind){case"PrimaryMailbox":case"ArchiveMailbox":t=Object(g.a)(e.folderId);break;case"Group":t=null;break;default:t=Object(i.i)(e)}return t}(h.a.staticSearchScope),s.addCustomData({actionSource:t,searchTextLength:c.searchText.length,suggestionPillsLength:c.suggestionPillIds.length,folderName:x,listViewType:Object(rt.r)(T),searchScope:h.a.staticSearchScope.kind}),Object(r.c)(w,s,t),[2]}var A,C,_,I,E,k,M,F,R,L,B,W})})});Object(c.orchestrator)(r.g,function(e){return l.__awaiter(void 0,void 0,void 0,function(){var t,n,r;return l.__generator(this,function(o){switch(o.label){case 0:return t=e.actionSource,n=e.categoryName,[4,a.p.import()];case 1:return o.sent()(a.c.Mail),r={kind:i.a.Category,Name:n,ReferenceId:Object(I.h)(n,Object(I.l)())||Object(et.getGuid)()},Object(a.e)(r,!0,a.c.Mail),Object(a.V)(t,a.c.Mail),[2]}})})}),Object(c.orchestrator)(a.W,function(e){return l.__awaiter(void 0,void 0,void 0,function(){var t,n,r;return l.__generator(this,function(o){switch(o.label){case 0:return S(e.scenarioId)?(t=e.suggestion,n=e.actionSource,r=e.isInCommandMode,u=t,d=n,p=r,f=v.SuggestionSelected.datapoint,h=f.name,m=f.customData,Object(O.n)(h,m(Object(a.l)(a.c.Mail).searchText,i.a[u.kind],d,p)),u.kind===i.a.Command&&(b=u.Name,g=p,y=v.CommandSuggestionSelected.datapoint,T=y.name,w=y.customData,Object(O.n)(T,w(b,g))),Object(a.g)(a.c.Mail),t.kind===i.a.Command?[3,2]:[4,a.I.import()]):[2];case 1:o.sent()(!1,a.c.Mail),o.label=2;case 2:switch(t.kind){case i.a.Keywords:!function(e,t){l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(n){switch(n.label){case 0:return Object(q.c)("sea-gf")&&e.Segments&&e.Segments.length>0?[4,a.M.import()]:[3,2];case 1:return n.sent()(e.Segments,!0,a.c.Mail),[3,4];case 2:return[4,a.D.import()];case 3:n.sent()(e.QueryText,a.c.Mail),n.label=4;case 4:return t?[3,5]:(Xt(e),[3,7]);case 5:return[4,a.H.import()];case 6:n.sent()(a.c.Mail,!1),n.label=7;case 7:return Object(a.V)("SearchBoxSuggestionDropDown",a.c.Mail,!1),[2]}})})}(t,r);break;case i.a.Command:!function(e){l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(t){return Object(a.S)({Suggestions:[],IsComplete:!0},a.c.Mail),Object(a.e)(e,!0,a.c.Mail),[2]})})}(t);break;case i.a.People:c=t,s=r,Object(a.e)(c,!0,a.c.Mail),s?Object(a.j)(a.c.Mail):(Xt(c),Object(a.V)("SearchBoxSuggestionDropDown",a.c.Mail,!1));break;case i.a.Category:!function(e){l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(t){return Object(a.e)(e,!0,a.c.Mail),Object(a.V)("SearchBoxSuggestionDropDown",a.c.Mail,!1),[2]})})}(t);break;case i.a.Message:!function(e){l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(t){switch(t.label){case 0:return[4,a.D.import()];case 1:return t.sent()(Object(a.l)(a.c.Mail).searchTextForSuggestion,a.c.Mail),Xt(e),ce(e),[2]}})})}(t);break;case i.a.Files:!function(e,t){l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(n){return t?(Object(a.e)(e,!0,a.c.Mail),Object(a.j)(a.c.Mail)):(Xt(e),be(e),Object(a.k)("SearchBoxSuggestionDropDown",a.c.Mail)),[2]})})}(t,r)}return[2]}var c,s,u,d,p,f,h,m,b,g,y,T,w})})});function Xt(e){return l.__awaiter(this,void 0,void 0,function(){var t;return l.__generator(this,function(n){switch(n.label){case 0:return[4,a.w.import()];case 1:if(n.sent()(a.c.Mail))return[2];if(t=Object(a.l)(a.c.Mail).latestQFTraceId,Object(P.a)("sea-qf")&&(e.kind==i.a.People?"qf"==e.Source:t)&&i.t.importAndExecute(t,e.ReferenceId,new Date),Object(P.a)("sea-qf")&&!t){if(e.kind===i.a.People&&"qf"!==e.Source)return[2];mt("entityclicked",{suggestionReferenceId:e.ReferenceId,suggestionKind:i.a[e.kind]})}return[2]}})})}Object(c.mutator)(oe,function(e){Object(h.c)().legacySuggestions.delete(e.searchText)});Object(c.mutator)(he,function(e){Object(h.c)().refinersVisible=e.isVisible}),Object(c.mutator)(ie,function(){var e=Object(h.c)();e.fromDate=h.b.fromDate,e.toDate=h.b.toDate,e.includeAttachments=h.b.includeAttachments,e.staticSearchScope=Object(h.c)().initialSearchScope}),Object(c.mutator)(pe,function(e){Object(h.c)().fromDate=e.fromDate}),Object(c.mutator)(me,function(e){Object(h.c)().toDate=e.toDate}),Object(c.mutator)(fe,function(e){Object(h.c)().includeAttachments=e.includeAttachments});Object(c.mutator)(r.f,function(e){var t=e.searchScope;Object(h.c)().staticSearchScope=t}),Object(c.mutator)(ge,function(e){var t,n=Object(h.c)().legacySuggestions,r=e.searchText,a=e.suggestions;if(n.has(r)){var o=n.get(r),c=a.filter(function(e){switch(e.kind){case i.a.Keywords:return 0===o.Suggestions.filter(function(t){return t.kind===i.a.Keywords&&t.DisplayText===e.DisplayText}).length;case i.a.People:return 0===o.Suggestions.filter(function(t){return t.kind===i.a.People&&t.EmailAddresses.filter(function(t){return e.EmailAddresses.indexOf(t)>-1}).length>0}).length;default:return!1}}),s=(t=o.Suggestions).concat.apply(t,c),l=s.filter(function(e){return e.kind===i.a.Keywords}),u=s.filter(function(e){return e.kind===i.a.People}),d=l.concat.apply(l,u);o.Suggestions=d}else{var p={Suggestions:a,IsComplete:!1};n.set(r,p)}}),Object(c.mutator)(ve,function(e){var t=Object(h.c)().legacySuggestions;t.has(e.searchText)&&(t.get(e.searchText).IsComplete=e.isComplete)});var Zt=n(2557),Qt=n(14),Jt=n(1885),$t=n(402),en=n(1848),tn=n(1826),nn=n(532),rn=n(1912),an=n(1822),on=n(2480),cn=n(11),sn=n.n(cn),ln=n(1),un=n(3801),dn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSearchRefinersCalloutClick=function(e){e.stopPropagation()},t.onSearchRefinersKeyDown=function(e){e.stopPropagation()},t.renderScopeOption=function(e){var t=e.key===Object(i.i)(Object(h.c)().staticSearchScope);return ln.createElement("button",{className:un.folderOption+" "+(t?un.isSelected:un.isNotSelected),onClick:function(){return ue(e)},"data-is-focusable":!0},t&&ln.createElement(tn.a,{className:un.selectedFolderCheckMark,iconName:"CheckMark"}),ln.createElement("span",null,e.text))},t.onClearFiltersClicked=function(e){e.stopPropagation(),se()},t.onFromDateChanged=function(e){pe(e),le(2)},t.onToDateChanged=function(e){me(e),le(3)},t.onAttachmentsToggleToggled=function(e){fe(e),le(1)},t.onCalloutDismiss=function(e){e.stopPropagation(),"focus"!==e.type&&he(!1)},t}return l.__extends(t,e),t.prototype.render=function(){var e=Object(h.c)(),t=e.toDate,n=e.fromDate,r=e.includeAttachments,a=new Date;return ln.createElement("div",{onClick:this.onSearchRefinersCalloutClick,onKeyDown:this.onSearchRefinersKeyDown},ln.createElement(Jt.a,{directionalHint:6,directionalHintFixed:!0,gapSpace:1,isBeakVisible:!1,onDismiss:this.onCalloutDismiss,setInitialFocus:!0,target:this.props.target},ln.createElement($t.a,{isClickableOutsideFocusTrap:!0},ln.createElement(en.a,null,ln.createElement(rn.a,{className:un.folderOptions,items:this.getScopeOptions(),onRenderCell:this.renderScopeOption})),this.props.showAttachmentRefiner&&ln.createElement("div",{className:un.attachmentsRefinerContainer},ln.createElement(an.a,{label:sn.a.attachmentsLabel,checked:r,onChanged:this.onAttachmentsToggleToggled,styles:{root:{alignItems:"center",display:"flex",justifyContent:"space-between",marginBottom:"0",width:"100%"}}})),ln.createElement("div",{className:un.dateRefinersContainer},ln.createElement("div",{className:un.dateRefinerContainer},ln.createElement(on.a,{className:un.datePicker,disableAutoFocus:!0,formatDate:this.formatDate,isMonthPickerVisible:!1,label:sn.a.fromDateLabel,maxDate:t||a,onSelectDate:this.onFromDateChanged,placeholder:sn.a.datePlaceholder,value:n})),ln.createElement("div",{className:un.dateRefinerContainer},ln.createElement(on.a,{className:un.datePicker,disableAutoFocus:!0,formatDate:this.formatDate,isMonthPickerVisible:!1,label:sn.a.toDateLabel,maxDate:a,minDate:n,onSelectDate:this.onToDateChanged,placeholder:sn.a.datePlaceholder,value:t}))),ln.createElement(nn.a,{className:un.clearFiltersButton,onClick:this.onClearFiltersClicked},sn.a.clearFiltersButtonText))))},t.prototype.getScopeOptions=function(){var e=Object(h.c)(),t=e.staticSearchScope,n=e.staticSearchScopeList.slice(),r=n.filter(function(e){return Object(i.d)(e,t)});r.length<=0&&n.push(t);var a=e.initialSearchScope;(r=n.filter(function(e){return Object(i.d)(e,a)})).length<=0&&n.push(a);for(var o=[],c=0,s=n;c<s.length;c++){var l=s[c];o.push({key:Object(i.i)(l),text:Object(Zt.a)(l),searchScope:l})}return o},t.prototype.formatDate=function(e){return e.toLocaleDateString()},t=l.__decorate([Qt.observer],t)}(ln.Component);var pn=n(76),fn=n(3803),hn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){e.stopPropagation();var t=Object(h.c)().refinersVisible;he(!t)},t}return l.__extends(t,e),t.prototype.render=function(){var e=this,t=Object(h.c)().refinersVisible,n={role:pn.a.button,hasPopup:!0,label:sn.a.searchRefinersAriaLabel,expanded:t},r=!at();return ln.createElement(ln.Fragment,null,ln.createElement("button",l.__assign({className:fn.refinersButton,onClick:this.onClick,ref:function(t){return e.refinersButton=t}},Object(pn.b)(n)),ln.createElement("span",{className:fn.refinersButtonText},function(){var e=Object(h.c)().staticSearchScope;if(!e)return"";var t=Object(Zt.a)(e),n=0;return m()&&n++,b()&&n++,0===n?t:Object(Y.format)(sn.a.refinersLabel,t,n)}()),ln.createElement(tn.a,{iconName:"Filter",className:fn.refinersButtonIcon})),t&&ln.createElement(dn,{target:this.refinersButton,showAttachmentRefiner:r}))},t=l.__decorate([Qt.observer],t)}(ln.Component),mn=n(2213),bn=n(148);n.d(t,"registerSearchStoreOrchestrators",function(){return de}),n.d(t,"startSearchWithCategory",function(){return r.g}),n.d(t,"setStaticSearchScopeData",function(){return Tt}),n.d(t,"SearchRefiners",function(){return hn}),n.d(t,"initializeLivePersonaCard",function(){return mn.a}),n.d(t,"personaControlStore",function(){return bn.a})},597:function(e,t,n){"use strict";var r,a;(a=r||(r={}))[a.Base64InlineImage=0]="Base64InlineImage",a[a.Cloud=1]="Cloud",a[a.Local=2]="Local",a[a.MailItem=3]="MailItem",a[a.Uri=4]="Uri",a[a.AttachmentItem=5]="AttachmentItem";var i={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function o(e){switch(e?e.toLowerCase():null){case i.ONE_DRIVE_PRO.toLowerCase():return 0;case i.GDRIVE.toLowerCase():return 5;case i.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case i.DROPBOX.toLowerCase():return 2;case i.BOX.toLowerCase():return 3;case i.WOPI_BOX.toLowerCase():return 7;case i.WOPI_EGNYTE.toLowerCase():return 8;case i.MAILBOX.toLowerCase():return 4;case i.FACEBOOK.toLowerCase():return 6;default:return null}}function c(e){return null==e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}function s(e){return null==e?null:{fileType:r.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:e.Thumbnail?e.Thumbnail.Url:"",previewUrl:e.Preview?e.Preview.Url:"",type:e.MimeType}}function l(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var a=e[n],i={fileType:r.Local,name:a.name,size:a.size,type:a.type,fileObject:a};t.push(i)}return t}var u=n(7);function d(e,t){if(e.length!=t.length)return u.c.error("The sizes of subjects and latestItemIds are different"),null;for(var n=[],a=0;a<e.length;a++){var i={fileType:r.MailItem,name:e[a],size:0,itemId:t[a]};n.push(i)}return n}var p=n(191);function f(e){return e.map(function(e){return{fileType:r.Uri,name:e.name,type:Object(p.a)(e.url),size:0,uri:e.url}})}n.d(t,"b",function(){return o}),n.d(t,"e",function(){return l}),n.d(t,"f",function(){return d}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return s}),n.d(t,"g",function(){return f}),n.d(t,"a",function(){return r})},599:function(e,t,n){"use strict";var r=n(11),a=n.n(r),i=null;function o(e){var t;if(i||(i=Object.freeze(((t={})[0]=function(){return a.a.attachmentPolicyInformation},t))),!i[e])throw new Error("Issue message is not defined");return i[e]()}var c=n(82),s=n(335);function l(e){switch(e){case 0:return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,messageParts:[o(e),{text:Object(r.getOwaMailStrings)().attachmentPolicyHyperLinkText,action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}],color:s.a.Red};default:return Object(c.a)(e)}}var u=n(6);function d(){var e=Object(u.a)().AttachmentPolicy;return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked||e.ConditionalAccessPrintWithoutDownloadBlocked||e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked}function p(){var e=[];return d()&&e.push(0),e}function f(e){switch(e){case 0:return d();default:return Object(c.a)(e)}}var h,m,b=n(191);(m=h||(h={}))[m.Undefined=0]="Undefined",m[m.Block=1]="Block",m[m.ForceSave=2]="ForceSave",m[m.Allow=3]="Allow";var g=function(){function e(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=h[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes]}return e.prototype.getPolicyInfo=function(e,t,n,r){e&&(e=e.toLowerCase());var a=this.getFileAccessLevel(e,t),i=!1,o=!1,c=!1,s="ReferenceAttachment:#Exchange"===r;return a!==h.Block&&n&&(this.isWacViewingEnabled(e)&&(i=!0),!this.directFileAccessEnabled&&s&&(i=!1),o=this.isForceBrowserViewingFirst(i),i&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(c="FileAttachment:#Exchange"===r?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),i||this.directFileAccessEnabled||(a=h.Block)),{directFileAccessEnabled:this.directFileAccessEnabled,level:a,useWac:i,forceBrowserViewingFirst:o,wacEdit:c}},e.prototype.getFileAccessLevel=function(e,t){var n=this.fileTypeToPolicyMap[e];if(n||(n=h.Undefined),n==h.Block)return h.Block;var r=this.mimeTypeToPolicyMap[t];return r==h.Block?h.Block:n==h.ForceSave||r==h.ForceSave?h.ForceSave:n==h.Allow||r==h.Allow?h.Allow:this.policyForUnknownTypes},e.prototype.isWacViewingEnabled=function(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0},e.prototype.isForceBrowserViewingFirst=function(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},e.prototype.addPolicyIntoMap=function(e,t,n){t&&t.forEach(function(t){e[t]=n})},e.prototype.createPolicyMap=function(e,t,n){var r={};return this.addPolicyIntoMap(r,n,h.Allow),this.addPolicyIntoMap(r,t,h.ForceSave),this.addPolicyIntoMap(r,e,h.Block),r},e}(),v=null;function S(){if(!v){var e=Object(u.a)(),t=e.AttachmentPolicy,n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;v=new g(t,n)}return v}function y(e,t){var n=Object(b.a)(e.Name),r=e.ContentType;return S().getPolicyInfo(n,r,t,e.__type)}function T(e,t,n){var r=y(e,!0),a=S();return r.level!==h.Block&&a.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"d",function(){return l}),n.d(t,"b",function(){return p}),n.d(t,"g",function(){return f}),n.d(t,"e",function(){return T}),n.d(t,"a",function(){return h}),n.d(t,"c",function(){return y}),n.d(t,"f",function(){return S})},600:function(e,t,n){"use strict";var r,a;n.d(t,"a",function(){return r}),n.d(t,"b",function(){return c}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return l}),(a=r||(r={}))[a.MailCompose=0]="MailCompose",a[a.MailList=1]="MailList",a[a.ReadingPane=2]="ReadingPane";var i=[r.MailCompose,r.MailList,r.ReadingPane],o={};function c(e,t){var n=u(e);if(o[n]&&e!==r.ReadingPane)throw new Error("Component has already registered a focus manager callback");o[n]=t}function s(e){o[u(e)]=null}function l(){return new Promise(function(e,t){window.requestAnimationFrame(function(){for(var t=0,n=i;t<n.length;t++){var r=n[t],a=o[u(r)];if(a&&a())return e()}return e()})})}function u(e){return r[e]}},617:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=n(1234);function a(e){return o(e.type)}function i(e){return o(Object(r.a)(e))}function o(e){return 1===e}},655:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(11),a=n.n(r),i=n(18);function o(e){var t;return e>=1073741824?(e/=1073741824,t=a.a.sizeWithGigabyteAbbreviationText):e>=1048576?(e/=1048576,t=a.a.sizeWithMegabyteAbbreviationText):e>=1024?(e/=1024,t=a.a.sizeWithKilobyteAbbreviationText):t=a.a.sizeWithByteAbbreviationText,Object(i.format)(t,Math.round(e))}},657:function(e,t,n){"use strict";var r=n(82),a=n(8),i=n(390),o=n(192);function c(e,t,n,a){void 0===a&&(a=!0);var o=e,c=o.AttachmentId,s=o.Name,l=o.OriginalPermissionType,u=o.PermissionType,d=o.AttachLongPathName;switch(t){case 0:case 3:return i.b(c,d,t,n,u,l,a,s);case 1:return e.AttachmentPreviewUrl?e.AttachmentPreviewUrl:i.b(c,d,1,n,u,l,a,s);case 2:return e.AttachmentThumbnailUrl;default:return Object(r.a)(t)}}function s(e,t,n,r,o){return void 0===n&&(n=!1),void 0===r&&(r=Object(a.c)("doc-consumerUrl")),void 0===o&&(o=!0),i.a(e.mailboxInfo&&e.mailboxInfo.mailboxId,e,t,n,r,o)}function l(e,t,n,r,l,u){void 0===l&&(l=!1),void 0===u&&(u=Object(a.c)("doc-consumerUrl"));var d=n?c(t,1,r,!1):s(e,1,l,u,!1);if(n)return{url:d,init:{credentials:"include"}};var p=Object(i.c)(),f=new Headers;return f.set("X-Token",p),f.set("X-OWA-CANARY",Object(o.getOwaCanaryCookie)()),{url:d,init:{headers:f}}}function u(e,t,n,r,i,o,l){return void 0===o&&(o=!1),void 0===l&&(l=Object(a.c)("doc-consumerUrl")),r?c(t,n,i):s(e,n,o,l)}n.d(t,"b",function(){return u}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return l}),n.d(t,"a",function(){return"/owa/"})},666:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),a=["doneText","addRemoveTimezonesText","timezonesSearchHintText","localTimeText","timeZoneText","todayStringLowerCaseText","allDayDurationText","cancelLowerCaseText","previousMonthText","nextMonthText","selectDateAriaLabelText","cancelMeetingText","closeText","deleteEventConfirmationTitleText","deleteSeriesConfirmationTitleText","deleteEventConfirmationSubText","deleteGroupEventConfirmationSubText","deleteThisEventForwardTitleText","deleteThisEventForwardSubText","deleteThisGroupEventForwardSubText","deleteEventSeriesConfirmationSubText","deleteGroupEventSeriesConfirmationSubText","deleteCalendarConfirmationTitleText","deleteCalendarConfirmationSubText","deleteCalendarGroupConfirmationTitleText","deleteCalendarGroupConfirmationSubText","confirmDiscardEventTitleText","confirmDiscardEventSubText","confirmDiscardChangesTitleText","confirmDiscardChangesSubText","confirmAttachmentsChangedTitleText","confirmAttachmentsChangedSubText","calendarModuleNameText","newCalendarEventText","calendarEllipsisAriaLabelText","calendarsAreNotAvailable","tryAgainByRefreshingBrowser","calendarLoadingEvents","calendarErrorItemNoLongerExist","calendarText","myCalendarsText","otherCalendarsText","peoplesCalendarsText","groupCalendarsText","selectedCalendarText","notSelectedCalendarText","failedCreateCalendarGroupText","failedDeleteCalendarGroupText","failedCreateCalendarText","failedDeleteCalendarText","failedRenameCalendarText","failedRenameCalendarGroupText","failedSetCalendarColorText","failedUpdateCalendarText","shareCalendarDialogTitle","shareLabel","removeTooltip","notSharedPermission","notSharedPermissionTooltip","canViewPermission","canViewPermissionTooltip","canViewBusyPermission","canViewBusyPermissionTooltip","canViewTitlesPermission","canViewTitlesPermissionTooltip","canViewAllDetailsPermission","canViewAllDetailsPermissionTooltip","canEditPermission","canEditPermissionTooltip","delegatePermission","delegatePermissionTooltip","privateEventCheckbox","delegateSectionTitle","delegateSectionDescription","delegateSectionLabel","delegateAndSendMeCopyPermission","delegateAndSendMeCopyPermissionTooltip","delegateOnlyPermission","delegateOnlyPermissionTooltip","delegateAndMePermission","delegateAndMePermissionTooltip","sharedUsersForConsumersListSectionLabel","sharedUsersInOrganizationListSection","sharedUsersOutsideOrganizationListSection","notSharedWithAnyoneText","shareInvitationInfoText","peoplePickerPlaceHolderText","learnMoreLinkText","myOrganizationLabel","retrievingSharingInvitationsText","validatingSharingPermissionsMessage","doNotHavePermissionsMessage","searchPeopleLabel","noResultsFoundLabel","loadingLabel","suggestedContactsAriaLabel","peoplePickerAriaLabel","sharingPermissionsNotLoaded","sharingPermissionDeleteFailed","sharingPermissionUpdateFailed","sharingInviteSendFailed","emailAddressValidationFailed","globalDelegateSettingUpdateFailed","sharingPermissionsNotLoadedIllustrationMessage","tryAgainLabel","alreadySharedAriaLabel","shareSuccessAriaLabel","updatePermissionSuccessAriaLabel","removePermissionSuccessAriaLabel","open","openOccurrence","openSeries","charm","freeBusyItemSelectedScreenReaderText","freeBusyItemNotSelectedScreenReaderText","categoryMenuItemMenuText","addToMyCalendar","addToMyCalendarSubMenuAddOccurrenceText","addToMyCalendarSubMenuAddSeriesText","lightBlueCalendarColorText","lightGreenCalendarColorText","redCalendarColorText","darkBlueCalendarColorText","yellowCalendarColorText","tealCalendarColorText","lightPinkCalendarColorText","brownCalendarColorText","darkPinkCalendarColorText","blueCalendarColorText","greenCalendarColorText","indigoCalendarColorText","grayCalendarColorText","pinkCalendarColorText","orangeCalendarColorText","violetCalendarColorText","charmsCatAriaText","charmsDogAriaText","charmsPlaneAriaText","charmsCalculatorAriaText","charmsMedicalAriaText","charmsTrophyAriaText","charmsHouseAriaText","charmsMedicineAriaText","charmsBriefcaseAriaText","charmsCoffeeAriaText","charmsPeopleAriaText","charmsStopwatchAriaText","charmsMusicAriaText","charmsShoppingAriaText","charmsCarAriaText","charmsStarAriaText","charmsNoteAriaText","charmsPersonAriaText","charmsBalloonsAriaText","charmsForkAndKnifeAriaText","charmsHeartAriaText","charmsSoccerBallAriaText","charmsFilmAriaText","charmsChartAriaText","charmsBooksAriaText","charmsCakeAriaText","charmsTvPanelAriaText","charmsTravelAriaText","charmsPackageDeliveryAriaText","charmsPromotionAriaText","charmsEventAriaText","charmsHotelAriaText","everyoneAvailable","singleAttendeeUnavailable","multipleAttendeesUnavailable","singleAttendeeAndOrganizerUnavailable","multipleAttendeesAndOrganizerUnavailable","organizerUnavailable","singleLocationAndSingleAttendeeUnavailable","singleLocationAndMultipleAttendeesUnavailable","singleLocationSingleAttendeeAndOrganizerUnavailable","singleLocationMultipleAttendeesAndOrganizerUnavailable","singleLocationAndOrganizerUnavailable","multipleLocationsAndSingleAttendeeUnavailable","multipleLocationsAndMultipleAttendeesUnavailable","multipleLocationsSingleAttendeeAndOrganizerUnavailable","multipleLocationsMultipleAttendeesAndOrganizerUnavailable","multipleLocationsAndOrganizerUnavailable","singleLocationUnavailable","multipleLocationsUnavailable","saveButtonLabel","sendButtonLabel","attachButtonLabel","attachFromMenuHeaderText","attachFromComputerButtonLabel","attachFromCloudButtonLabel","discardButtonLabel","deleteButtonLabel","cancelButtonLabel","bodyPlaceholderText","private","peoplePickerAddPeoplePlaceHolder","peoplePickerAddRequiredPeoplePlaceHolder","peoplePickerAddOptionalPeoplePlaceHolder","optionalAttendeesPickerPlaceHolder","organizerAvailableTitle","organizerFreeBusyTitle","attendeeStatusTitle","attendeeAvailableStatusTitle","attendeeStatusUnknownTitle","attendeeConflictOverflowTooltip","openSchedulingAssistantTitle","availableFreeBusy","unknownFreeBusy","addroomText","roomListTitle","roomsTitle","tracking","insertPicturesInlineTooltip","emojiTooltip","formattingOptionsTooltipHide","formattingOptionsTooltip","ReplyAllMenuItem","ReplyMenuItem","ForwardMenuItem","expressionsHeader","fullComposeTitlePlaceholderText","recurrenceUntilAriaPlaceholder","roomFiltersTitle","roomCapacityTitle","roomFeaturesTitle","roomVideoFeatureTitle","roomAudioFeatureTitle","roomProjectorFeatureTitle","roomAdaCompliantFeatureTitle","roomTypeTitle","roomTypeReservedTitle","roomTypeUnreservedTitle","groupMemberWillReceiveInvite","groupMemberWillContinueToReceiveUpdates","browsePlacesTitle","searchRoomsPlaceholder","browseMorePlacesTitle","anyRoomListName","missingTitleTitle","missingTitleMeetingDescription","missingTitleAppointmentDescription","dontSaveButtonLabel","dontSendButtonLabel","showStartEndTimeZoneOption","showTimeConversionsOption","removeTimeZoneTooltip","addTimeZoneButton","timeZonesHeader","timeConversionsTitle","timezoneInsightsInfobar","showTimeZoneInsightsInfobarAction","hideTimeZoneInsightsInfobarAction","nextDay","previousDay","invalidRecipientsDialogTitle","invalidRecipientsDialogDescription","suggestedRoomListsHeader","allRoomListsHeader","showOnlyAvailableRoomsToggleLabel","noRoomsFoundMessageLineOne","noRoomsFoundMessageLineTwo","findingRoomsSearchState","checkingAvailabilitySearchState","showingResultsFromSearchState","roomRichConferencingFeatureTitle","quickAddIntroHeader","quickAddIntroBody1","quickAddIntroBody2","quickAddIntroBody3","quickAddIntroCTA","sundayAbbreviated","mondayAbbreviated","tuesdayAbbreviated","wednesdayAbbreviated","thursdayAbbreviated","fridayAbbreviated","saturdayAbbreviated","organizerInvitedPrincipal","organizerInvitedYou","youAreOrganizer","principalIsOrganizer","eventPartOfSeries","noResponseReceivedAttendeesLabelAndCount","declinedAttendeesLabelAndCount","tentativelyAcceptedAttendeesLabelAndCount","acceptedAttendeesLabelAndCount","twoAttendeeResponsesConcatenationFormat","threeAttendeeResponsesConcatenationFormat","fourAttendeeResponsesConcatenationFormat","acceptedTime","tenativelyAcceptedTime","cancelledTime","edit","cancel","cancelError","thisEvent","thisAndAllFollowingEvents","allEventsInSeries","editorPlaceholderText","cancelEdit","cancelSendNow","cancelEditorText","cancelThisEventForwardEditorText","cancelOccurrenceEditorText","cancelSeriesEditorText","delete","createError","deleteError","updateError","removeFromCalendar","removeSeriesFromCalendar","respondWithMessage","sendResponseNow","noSendResponse","cancelWithMessage","cancelNow","responseEditorWatermark","sendButtonString","discardButtonString","openItemButtonAriaLabel","acceptButtonText","acceptButtonAriaLabel","tentativeButtonText","tentativeButtonAriaLabel","declineButtonText","declineButtonAriaLabel","itemDeleteConfirmationDescriptionText","itemCancelConfirmationDescriptionText","itemDeleteConfirmationBackText","forwardButtonLabel","acceptedButtonLabel","tentativeButtonLabel","declineButtonLabel","discardChangesConfirmationLabel","dontDiscardLabel","requestResponsesItem","allowForwardingItem","responseOptionsButtonLabel","addSkypeMeetingLabel","addTeamsMeetingLabel","removeSkypeMeetingLabel","removeTeamsMeetingLabel","addedSkypeMeetingToast","addedTeamsMeetingToast","onlineSkypeMeetingLocationLabel","joinSkypeMeetingButton","onlineTeamsMeetingLocationLabel","joinTeamsMeetingButton","genericOnlineMeetingButton","singleEmailReminderSummary","multipleEmailRemindersSummary","addEmailReminderDropdownOption","emailReminderHeader","emailReminderInfoHeader","emailReminderMessagePlaceholder","addAnotherEmailReminderButtonLabel","dayOfEventOptionEmailReminder","oneDayBeforeEventOptionEmailReminder","twoDaysBeforeEventOptionEmailReminder","oneWeekBeforeEventOptionEmailReminder","twoWeeksBeforeEventOptionEmailReminder","oneMonthBeforeEventOptionEmailReminder","invalidRecurrenceDialogTitle","invalidRecurrenceDialogDescription","acceptEvent","tentativelyAcceptEvent","declineEvent","proposeNewTime","acceptEventAndAddMessage","tentativelyAcceptEventAndAddMessage","declineEventAndAddMessage","acceptOccurrenceAndAddMessage","tentativelyAcceptOccurrenceAndAddMessage","declineOccurrenceAndAddMessage","proposeNewTimeAndAddMessage","acceptSeriesAndAddMessage","tentativelyAcceptSeriesAndAddMessage","declineSeriesAndAddMessage","notifyOrganiserLabel","taskPPFAriaLabel","goalPPFAriaLabel","fitnessPPFAriaLabel","cakePPFAriaLabel","examPPFAriaLabel","pastClarificationPPFC","pastTentativePPFC","pastNoPPFC","pastYesPPFC","popoutsOpenInNewWindow","addLocationText","addLocationTextConsumer","addToCalendarText","durationDay","durationFirstPluralDays","durationSecondGenitivePluralDays","durationHour","durationFirstPluralHours","durationSecondGenitivePluralHours","reminderDay","reminderSingularHour","reminderSingularWeek","reminderFirstPluralHours","reminderSecondGenitivePluralHours","reminderFirstPluralMin","reminderSecondGenitiveMin","reminderBefore","reminderAfter","reminderDayOfEvent","reminderDayBeforeEvent","reminderWeekBeforeEvent","addToCalendar","allDay","atTimeOfEvent","custom","remindMe","repeat","customRecurrenceModalTitle","start","noReminder","repeatNever","repeatNeverAriaText","repeatDaily","repeatWeekly","repeatMonthly","repeatYearly","recurrenceDropdownAriaText","recurrenceHeaderAriaLabel","repeatsWithEndAriaPlaceHolder","repeatsWithoutEndPlaceHolder","occursPlaceHolder","occursAriaPlaceHolder","occursUntilPlaceHolder","occursMonthlyUntilPlaceHolder","occursUntilAriaPlaceHolder","chooseEndDateLabel","save","discard","undo","eventDeleted","moreDetails","durationLabel","startTimeLabel","endTimeLabel","timeOptionsLabel","startDateLabel","endDateLabel","subjectDetailsLabel","selectEventCharmLabel","selectEventCalendarLabel","infoMessageEditOccurrence","infoMessageEditSeries","toText","changeRecurrenceConfirmationTitleText","changeRecurrenceSubText","titlePlaceholderText","repeatEvery","day","days","month","months","week","weeks","year","years","removeEndDate","createEventOnGroupCalendar","invitationWontBeSentToGroup","sendEventToAllGroupMembers","forwardingMasterInfoMessage","forwardingInstanceInfoMessage","forwardingSingleEventInfoMessage","requiredAttendees","addRequiredAttendee","optionalAttendees","addOptionalAttendee","resourceAttendees","addRoom","showOnlyWorkHours","expandHeader","collapseHeader","schedulingAssistantAriaLabel","schedulingAssistantAriaDateAndStatus","removeAttendee","attendeeStatusFree","attendeeStatusTentative","attendeeStatusBusy","attendeeStatusOOF","attendeeStatusWorkingElsewhere","attendeeStatusNoData","attendeeStatusLoading","goToTodayStringLowerCaseText","switchToDayText","switchToWeekText","switchToWorkWeekText","switchToMonthText","goToPreviousDayStringLowerCaseText","goToNextDayStringLowerCaseText","goToPreviousWeekStringLowerCaseText","goToNextWeekStringLowerCaseText","goToPreviousMonthStringLowerCaseText","goToNextMonthStringLowerCaseText","goToPreviousYearStringLowerCaseText","goToNextYearStringLowerCaseText","am","pm","moreTooltip","newCalendarString","newCalendarGroupString","newGroupString","discoverGroupsString","renameCalendarGroupString","deleteCalendarGroupString","renameCalendarString","removeCalendarString","changeCalendarColorString","automaticColorString","addToFavorites","removeFromFavorites","toggleLeftPaneAriaLabel","eventLocationAriaText","eventOrganizerAriaText","eventDescriptionAriaText","allDayEventDescriptionAriaText","singleDayEventDescriptionAriaText","whenStartEndsSameDayLongAriaText","whenStartEndsDifferentDayLongAriaText","whenStartEndsDifferentDayDateOnlyLongAriaText","surfaceItemRecurrenceIconTitle","surfaceItemRecurrenceExceptionIconTitle","surfaceItemAttachmentIconTitle","surfaceItemPrivateIconTitle","calendarMeetingDndModalTitle","calendarMeetingDndModalEditButtonText","calendarMeetingDndModalEditButtonDesc","calendarMeetingDndModalDiscardButtonText","calendarMeetingDndModalDiscardButtonDesc","commandBarEllipsisAriaLabel","toggleSplitViewText","toggleSplitViewDisabledTooltip","showMoreCalendarsString","showLessCalendarsString","bookingPageButtonText","leftRailRegionName","commandBarRegionName","newEventSkipLinkName","miniMonthRegionName","calendarPickerRegionName","surfaceCommandBarRegionName","timestripRegionName","calendarSurfaceRegionName","eventsLoadedLiveNotification","firstName","lastName","birthday","birthdaysTitle","neverRemind","happyBirthdayGreeting","editEventButton","deleteEventButton","viewBirthdayEvent","editBirthdayEvent","deleteBirthdayEvent","discardChangesButton","saveChangesButton","remindLabel","newBirthdayEvent","DiscoverCalendarsText","AddAndDiscoverCalendarsText","PoweredByText","BingText","PopularCalendarsText","PopularText","AddCalendarErrorText","RemoveCalendarErrorText","GetInterestingCalendarsErrorText","DataFromText","HolidaysText","AddCalendarText","FromFileText","FromWebText","ICErrorText","HolidaysErrorText","CancelText","ImportFromFileText","ImportFromWebText","ImportEventsText","ChooseICSFileText","ImportToText","BrowseText","ImportText","ImportingText","NoFileSelectedText","ICSFileTooLargeText","ICSFileErrorText","ImportedText","SubscribeOnlineText","LinkToCalendarText","LinkToCalendarPlaceholderText","CalendarNameText","CalendarNamePlaceholderText","WebcalSuccessText","WebcalSubscriptionExistsText","WebcalUrlErrorText","ICS_SingleFile_MutipleEvents_NotificationMessage","locationCardDetailsLabel","openInMaps","call","directions","address","phoneNumber","addAddress","addALocationText","suggestedLocationsText","useThisLocationText","findLocationInfo_Searching","findLocationInfo_NoMatchFound","findLocationInfo_Loading","resolvedLocationAriaLabel","multipleLocationsFoundAriaLabel","locationSelectedAriaLabel","locationCardInformationLabel","locationCardMapLabel","editCommandBarAccesibility","respondYesAccesibility","respondMaybeAccesibility","respondNoAccesibility","respondedYesAccesibility","respondedMaybeAccesibility","respondedNoAccesibility","moreReplyOptionsAccesibility","showAsAccesibility","categorizeAccesibility","deleteAccesibility","cancelAccesibility","ellipsisAccesibility","notifyOrganizerToggleOnAccesibility","editorAriaLabel","sendResponseArialabel","saveResponseArialabel","discardResponseArialabel","sendArialabel","discardArialabel","sendCancelledResponseArialabel","discardCancelledResponseArialabel","notifyOrganizerToggleOffAccesibility","charmSelectedAccesibility","noCharmSelectedAccesibility","titleLabelAccesibility","privateAccesibility","eventDateAccesibility","viewSeriesAccesibility","locationAccesibility","reminderAccesibility","recurrenceAccesibility","notesAccesibility","organizerCardAccesibility","respondedAttendeeCardAccesibility","openInNewWindowAccesibility","closeEventAccesibility","respondYesPeekAria","respondMaybePeekAria","respondedYesPeekAria","respondedMaybePeekAria","respondNoPeekAria","editPeekAria","cancelPeekAria","deletePeekAria","viewPeekAria","getMoreDetailsPeekAria","eventTitlePeekAria","privateMarkerPeekAria","eventDatePeekAria","eventRecurringInfoAria","eventLocationPeekAria","organizerRowOrganizerPeekAria","organizerRowAttendeePeekAria","attendeeSummaryPeekAria","eventNotesPeekAria","respondFormGroupEditorLabelAria","forwardFormGroupEditorLabelAria","cancelFormGroupEditorLabelAria","attendeeWellTitle","sortByString","sortByDisplayName","sortByStatus","sortByOrderAdded","organizer","noResponseStatus","acceptedStatus","declinedStatus","tentativeStatus","showAsDropDownTitle","showAsFree","showAsWorkingElsewhere","showAsTentative","showAsBusy","showAsAway","showAsNoInformation","showAsOutsideWorkingHours","reminderDropDownTitle","meetingFormEllipsisAriaLabelText","privateControlAltText","privateControlHoverTextForPrivate","privateControlHoverTextForNonPrivate","insightsInfoString","meetingInsightsButton","relatedEmailString","relatedFilesString","viewFilesOnLeft","viewFilesOnRight","seeMoreString","infobarCannotEditPublicMeeting","infobarCancelledMeeting","infobarEventInPast","infobarNoResponseRequested","infobarNoResponseReuqestedOrganizer","infobarAcceptedByUser","infobarAcceptedByDelegate","infobarTentativelyAcceptedByUser","infobarTentativelyAcceptedByDelegate","infobarDeclinedByUser","infobarDeclinedByDelegate","infobarViewSeries","joinByPhone","conferenceId","calendarPrintPanelPrintLabel","calendarPrintPanelCancelLabel","calendarPrintPreviewLabel","calendarPrintPreviewCalendarViewButton","calendarPrintPreviewAgendaViewButton","calendarPrintSettingsCalendarLabel","calendarPrintSettingsLayoutLabel","calendarPrintSettingsLayoutStandard","calendarPrintSettingsLayoutHorizontal","calendarPrintSettingsLayoutVertical","calendarPrintSettingsViewLabel","calendarPrintSettingsViewDay","calendarPrintSettingsViewWeek","calendarPrintSettingsViewWorkWeek","calendarPrintSettingsViewMonth","calendarPrintSettingsPrintFromLabel","calendarPrintSettingsPrintToLabel","calendarPrintSettingsPrintAgenda","calendarPrintSettingsLeaveRoomForNotes","ErrorCalendarEventCanNotBeCreated","ErrorCannotCreatePublicFolderMeetings","InfoEditingMasterOfSeries","InfoEditingThisAndAllFollowingEvents","InfoEditingOccurrenceOfSeries","InfoAttendeeTentativeAndProposedNewTime","InfoAttendeeDeclinedAndProposedNewTime","InfoMultipleAttendeesHaveProposedNewTime","InfoTimeProposalViewInSchedulingAssistant","InfoTimeProposalEditEvent","InfoTimeProposalCurrentMeetingTime","ErrorInvalidRecipientsMeetingCanNotExecuteOperation","InfoComposeSkypeMeetingDetails","InfoComposeTeamsMeetingDetails","InfoEventOccursInThePast","InfoDoesNotRequireResponseOrganizer","InfoDoesNotRequireResponseAttendee","InfoMeetingAttendeeDoNotForward","InfoMeetingInvitationNotSent","InfoMeetingUpdatesNotSent","WarningCannotEditPublicFolderMeetings","WarningNoResponseTrackingForMeetingOnSecondaryCalendar","WarningContentUnblock","infoLinkClickHere"];t.OwaCalendarStringsStringModule=r.registerStringPackage("owa-calendar-strings",null,a);var i={};a.forEach(function(e){Object.defineProperty(i,e,{get:function(){return t.OwaCalendarStringsStringModule.strings.get(e)}})}),t.getOwaCalendarStrings=function(){return i},t.default=i},668:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindPeopleJsonRequest:#Exchange"},e)}},669:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"c",function(){return p});var r=n(0),a=n(1236),i=n(116),o=n(12),c=n(497),s=n(4),l=8;function u(e){var t=[];return function e(t,n){var a,i;var c=o.n.folderTable;try{for(var s=r.__values(n),l=s.next();!l.done;l=s.next()){var u=l.value,d=c.get(u);if(Object(o.W)(d)){var p=c.get(d.FolderId.Id),f=p.ParentFolderId.Id;t.push({folderId:p.FolderId.Id,displayName:p.DisplayName,parentFolderId:f,parentFolderDisplayName:f?c.get(f).DisplayName:null}),d.childFolderIds&&e(t,d.childFolderIds)}}}catch(e){a={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(a)throw a.error}}}(t,Object(o.w)(e)),{folders:t,hasExactMatch:!1}}var d=Object(s.select)({folderTable:function(){return o.n.folderTable}})(function(e,t,n,i,s){var u,d;t=(t||"").trim().toLocaleLowerCase(),n=n||l;var p=!1,f=t.length>0,h=f?function(e,t,n){for(var a,i,c,s=Object(o.w)(e),l=[];c=s.pop();){var u=n.get(c);if(u&&Object(o.W)(u)&&(u.DisplayName.toLocaleLowerCase().indexOf(t)>=0&&l.push(c),u.childFolderIds))try{for(var d=r.__values(u.childFolderIds),p=d.next();!p.done;p=d.next()){var f=p.value;s.push(f)}}catch(e){a={error:e}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}}return l}(e,t,s.folderTable):Object(c.b)().mruFolders;i&&(h=h.filter(i)),h=function(e){for(var t={},n=0,r=e.length;n<r;n++){var a=e[n];a&&(t[a]=0)}return Object.keys(t)}(h);var m,b=[],g=Object(a.b)(e);try{for(var v=r.__values(h),S=v.next();!S.done;S=v.next()){var y=S.value,T=s.folderTable.get(y);if(T){var O=T.DisplayName,w=T.ParentFolderId?T.ParentFolderId.Id:null,x=w?s.folderTable.get(w):null;f&&w==g&&O.toLocaleLowerCase()==t&&(p=!0),b.push({folderId:T.FolderId.Id,displayName:O,parentFolderId:w,parentFolderDisplayName:x?x.DisplayName:null})}}}catch(e){u={error:e}}finally{try{S&&!S.done&&(d=v.return)&&d.call(v)}finally{if(u)throw u.error}}return t&&(b.sort(function(e,t){return e.displayName.localeCompare(t.displayName)}),m=t,b.sort(function(e,t){var n=e.displayName.toLocaleLowerCase(),r=t.displayName.toLocaleLowerCase(),a=0==n.indexOf(m),i=0==r.indexOf(m);return a&&!i?-1:!a&&i?1:0})),{folders:b.slice(0,n),hasExactMatch:p}});function p(e,t){return Object(i.b)().shouldShowAllFolders&&!t?u(e):d(e,t,l)}t.a=d},870:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"PersonaResponseShape:#Exchange"},e)}},889:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),a=n(668);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("FindPeople",e,t)}},891:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindPeopleRequest:#Exchange"},e)}},896:function(e,t,n){"use strict";function r(e){window.open(e,"_blank")}n.d(t,"a",function(){return r})},937:function(e,t,n){"use strict";var r=n(3),a=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{}})();t.a=a},939:function(e,t,n){"use strict";var r=n(389),a=n(18),i=n(192),o="/owa/",c="service.svc/s/GetFileAttachment?id={0}",s="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",l="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",d="service.svc/s/GetAttachmentThumbnail?id={0}",p="pdfprint.aspx?id={0}",f="pdfprint.aspx?id={0}&location={1}";var h=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var m=n(82),b=n(8);function g(e,t,n,r,c,l,d,p){var b;switch(void 0===c&&(c=0),void 0===l&&(l=0),void 0===d&&(d=!0),void 0===p&&(p=null),n){case 0:b=s;break;case 3:b=f;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&h.indexOf(t.toLowerCase())>=0}(p))return null;b=u;break;default:Object(m.a)(n)}var g=r?l:c;!g&&c&&(g=c);var v=Object(a.format)("{0}{1}&permissionLevel={2}",o,Object(a.format)(b,encodeURIComponent(e.Id),encodeURIComponent(t)),g);d&&(v=v+"&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)());return v}function v(e,t,n,s,u,f){var h;switch(void 0===s&&(s=!1),void 0===u&&(u=Object(b.c)("doc-consumerUrl")),void 0===f&&(f=!0),n){case 0:h=c;break;case 1:h=l;break;case 2:h=d;break;case 3:h=p;break;default:return Object(m.a)(n)}return Object(a.isStringNullOrWhiteSpace)(h)?null:Object(a.format)("{0}{1}{2}",function(e,t,n,c,s,l){if(void 0===l&&(l=!1),!t||!t.Id)return null;var u=Object(a.format)(n,encodeURIComponent(t.Id));if(!Object(r.c)()||l)return o+u+"&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)();var d="{0}{1}/{2}&owa={3}&scriptVer={4}";c&&(d+="&isc=1");var p="unofficial";window.bootstrapDiagnostics&&!Object(a.isStringNullOrWhiteSpace)(window.bootstrapDiagnostics.scriptVer)&&(p=window.bootstrapDiagnostics.scriptVer);var f=Object(a.format)(d,Object(r.b)(),e,u,window.location.hostname,p);return s&&(f+="&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)(),f+="&token="+Object(r.a)()),f}(e,t,h,u,f,3===n),s?"&isDownload=true":"","&animation=true")}n.d(t,"b",function(){return g}),n.d(t,"a",function(){return v})},943:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38);t.default=function(e){return r.makeServiceRequest("GetAttachmentDownloadToken",{},e)}},974:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetPersonaJsonRequest:#Exchange"},e)}},979:function(e,t,n){"use strict";var r=n(2),a=n(147),i=n(116),o=n(3);Object(o.mutator)(a.b,function(e){Object(i.b)().findText=i.c.findText}),Object(o.mutator)(a.e,function(e){Object(i.b)().findText=e.searchText}),Object(o.mutator)(a.f,function(e){Object(i.b)().findText=i.c.findText}),Object(o.mutator)(a.i,function(e){Object(i.b)().isFocusInSearchBox=e.isFocusInSearchBox}),Object(o.mutator)(a.a,function(e){Object(i.b)().moveToMailboxContext=e.moveToMailboxContext}),Object(o.mutator)(a.d,function(){Object(i.b)().newFolderViewState.isInvalid=!0}),Object(o.mutator)(a.b,function(e){Object(i.b)().newFolderViewState={folderText:"",isInvalid:!1}}),Object(o.mutator)(a.c,function(e){e.folderText.trim().length>0?Object(i.b)().newFolderViewState={folderText:e.folderText,isInvalid:!1}:Object(i.b)().newFolderViewState={folderText:"",isInvalid:!1}}),Object(o.mutator)(a.e,function(e){Object(i.b)().newFolderViewState=i.c.newFolderViewState}),Object(o.mutator)(a.f,function(e){Object(i.b)().newFolderViewState=i.c.newFolderViewState}),Object(o.mutator)(a.h,function(){Object(i.b)().newFolderViewState=i.c.newFolderViewState}),Object(o.mutator)(a.f,function(e){Object(i.b)().shouldShowAllFolders=!0}),Object(o.mutator)(a.e,function(e){var t=Object(i.b)();"primary"===t.moveToMailboxContext&&(t.shouldShowAllFolders=e.searchText.length>0)}),Object(o.mutator)(a.g,function(){var e=Object(i.b)();Object.keys(e).forEach(function(t){e[t]=i.c[t]})});var c=n(0),s=n(12);Object(o.orchestrator)(a.f,function(e){return c.__awaiter(void 0,void 0,void 0,function(){return c.__generator(this,function(t){switch(t.label){case 0:return Object(a.a)(e.moveToMailboxContext),"archive"!=e.moveToMailboxContext?[3,2]:[4,s.K.import()];case 1:t.sent()("VIEW_ALL_MOVE_TO_MENU"),t.label=2;case 2:return[2]}})})});var l=n(1),u=n(1447);function d(e){var t=[];return t.push({key:"MoveToMenuItemDiv",onRender:function(){return l.createElement(b,{actionSource:e.actionSource,createNewFolder:e.createNewFolder,dismissMenu:e.dismissMenu,shouldShowSearchBox:e.shouldShowSearchBox,supportedMoveToMailboxContexts:e.supportedMoveToMailboxContexts,onFolderClick:e.onFolderClick,getFocusedOtherMenuItems:e.getFocusedOtherMenuItems,getCustomIcon:e.getCustomIcon,customMenuItemsToAppend:e.customMenuItemsToAppend})}}),{className:u.moveToMenu,styles:{title:{},container:{},root:{width:e.width?e.width+"px":null},header:{},list:{}},coverTarget:e.coverTarget,directionalHint:e.directionalHint?e.directionalHint:4,directionalHintFixed:!0,items:t,onMenuDismissed:p,shouldFocusOnMount:!e.shouldShowSearchBox,useTargetWidth:e.useTargetWidth,focusZoneProps:{shouldInputLoseFocusOnArrowKey:function(e){return!0}},calloutProps:{className:"customScrollBar",styles:function(e){return{root:{animation:"none",animationDuration:"0s"}}}}}}function p(){Object(a.g)()}n(1220);var f=n(669),h=n(1221);n.d(t,"a",function(){return b}),n.d(t,"c",function(){return d}),n.d(t,"b",function(){return f.a}),n.d(t,"d",function(){return h.a});var m=new r.c(function(){return Promise.all([n.e(4),n.e(242)]).then(n.bind(null,5647))}),b=Object(r.d)(m,function(e){return e.MoveToFolder})},984:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("setShouldShowImageOverlay")(function(e,t){e.shouldShowImageOverlay=t})}},0,[6,7,25,34,57,0,3,4,9,52,2,75,1,51,201,223,56,242,218,225,79,166,76]]);
//# sourceMappingURL=owa.MailSearch.js.map
window.scriptsLoaded['owa.MailSearch.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.MailSearch.js'] = (new Date()).getTime();