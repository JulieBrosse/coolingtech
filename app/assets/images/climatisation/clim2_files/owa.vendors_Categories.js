window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.vendors~Categories.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[213],{1886:function(e,t,o){"use strict";var r=o(1842),a=o(0),n=o(1),i=o(1843),l=o(1844),c=o(563),s=o(1825),u=o(524),d=o(1826),p=Object(i.a)(),g=function(e){function t(t){var o=e.call(this,t)||this;return o._rootElement=Object(l.a)(),o._inputElement=Object(l.a)(),o._onClickFocus=function(){var e=o._inputElement.value;e&&(o.focus(),e.selectionStart=e.selectionEnd=0)},o._onFocusCapture=function(e){o.setState({hasFocus:!0}),o._events.on(o._rootElement.current,"blur",o._onBlur,!0),o.props.onFocus&&o.props.onFocus(e)},o._onClearClick=function(e){var t=o.props.clearButtonProps;t&&t.onClick&&t.onClick(e),e.defaultPrevented||o._onClear(e)},o._onKeyDown=function(e){switch(e.which){case 27:o.props.onEscape&&o.props.onEscape(e),e.defaultPrevented||o._onClear(e);break;case 13:o.props.onSearch&&o.props.onSearch(o.state.value);break;default:if(o.props.onKeyDown&&o.props.onKeyDown(e),!e.defaultPrevented)return}e.preventDefault(),e.stopPropagation()},o._onBlur=function(e){o._events.off(o._rootElement.current,"blur"),o.setState({hasFocus:!1}),o.props.onBlur&&o.props.onBlur(e)},o._onInputChange=function(e){var t=e.target.value;t!==o._latestValue&&(o._latestValue=t,o.setState({value:t}),o._callOnChange(t))},o._warnDeprecations({labelText:"placeholder",defaultValue:"value"}),o._latestValue=t.value||"",o.state={value:o._latestValue,hasFocus:!1,id:Object(c.c)("SearchBox")},o}return a.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){void 0!==e.value&&(this._latestValue=e.value,this.setState({value:e.value}))},t.prototype.render=function(){var e=this.props,t=e.ariaLabel,o=e.placeholder,r=e.className,i=e.disabled,l=e.underlined,c=e.styles,s=e.labelText,g=e.theme,h=e.clearButtonProps,C=e.disableAnimation,m=this.state,y=m.value,f=m.hasFocus,b=m.id,v=void 0===s?o:s,_=p(c,{theme:g,className:r,underlined:l,hasFocus:f,disabled:i,hasInput:y.length>0,disableAnimation:C});return n.createElement("div",{ref:this._rootElement,className:_.root,onFocusCapture:this._onFocusCapture},n.createElement("div",{className:_.iconContainer,onClick:this._onClickFocus,"aria-hidden":!0},n.createElement(d.a,{className:_.icon,iconName:"Search"})),n.createElement("input",{id:b,className:_.field,placeholder:v,onChange:this._onInputChange,onInput:this._onInputChange,onKeyDown:this._onKeyDown,value:y,disabled:this.props.disabled,"aria-label":t||o,ref:this._inputElement}),y.length>0&&n.createElement("div",{className:_.clearButton},n.createElement(u.IconButton,a.__assign({styles:{root:{height:"auto"},icon:{fontSize:"12px"}},iconProps:{iconName:"Clear"}},h,{onClick:this._onClearClick}))))},t.prototype.focus=function(){this._inputElement.current&&this._inputElement.current.focus()},t.prototype.hasFocus=function(){return!!this.state.hasFocus},t.prototype._onClear=function(e){this.props.onClear&&this.props.onClear(e),e.defaultPrevented||(this._latestValue="",this.setState({value:""}),this._callOnChange(""),e.stopPropagation(),e.preventDefault(),this.focus())},t.prototype._callOnChange=function(e){var t=this.props,o=t.onChange,r=t.onChanged;r&&r(e),o&&o(e)},t.defaultProps={disableAnimation:!1,clearButtonProps:{ariaLabel:"Clear text"}},t}(s.a),h=o(41);o.d(t,"a",function(){return C});var C=Object(r.a)(g,function(e){var t,o,r,a=e.theme,n=e.underlined,i=e.disabled,l=e.hasFocus,c=e.className,s=e.hasInput,u=e.disableAnimation,d=a.palette,p=a.fonts,g=a.semanticColors;return{root:["ms-SearchBox",p.medium,h.normalize,{color:d.neutralPrimary,backgroundColor:g.inputBackground,display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"stretch",padding:"1px 0 1px 4px",border:"1px solid "+d.neutralTertiary,height:32,selectors:(t={},t[h.HighContrastSelector]={border:"1px solid WindowText"},t[":hover"]={borderColor:d.neutralDark,selectors:(o={},o[h.HighContrastSelector]={borderColor:"Highlight"},o)},t[":hover $iconContainer"]={color:d.themeDark},t)},l&&["is-active",{borderColor:d.themePrimary,selectors:(r={":hover":{borderColor:d.themePrimary}},r[h.HighContrastSelector]={borderColor:"Highlight"},r)}],i&&["is-disabled",{borderColor:d.neutralLighter,backgroundColor:d.neutralLighter,pointerEvents:"none",cursor:"default"}],n&&["is-underlined",{borderWidth:"0 0 1px 0",padding:"1px 0 1px 8px"}],n&&i&&{backgroundColor:"transparent"},s&&"can-clear",c],iconContainer:["ms-SearchBox-iconContainer",{display:"flex",flexDirection:"column",justifyContent:"center",flexShrink:0,fontSize:16,width:32,textAlign:"center",color:d.themePrimary,cursor:"text"},l&&{width:4},i&&{color:d.neutralTertiary},!u&&{transition:"width "+h.AnimationVariables.durationValue1}],icon:["ms-SearchBox-icon",{opacity:1},l&&{opacity:0},!u&&{transition:"opacity "+h.AnimationVariables.durationValue1+" 0s"}],clearButton:["ms-SearchBox-clearButton",{display:"flex",flexDirection:"row",alignItems:"stretch",cursor:"pointer",flexBasis:"32px",flexShrink:0,padding:1,color:d.themePrimary}],field:["ms-SearchBox-field",h.normalize,{backgroundColor:"transparent",border:"none",outline:"none",fontWeight:"inherit",fontFamily:"inherit",fontSize:"inherit",color:d.neutralPrimary,flex:"1 1 0px",overflow:"hidden",textOverflow:"ellipsis",paddingBottom:.5,selectors:{"::-ms-clear":{display:"none"},"::placeholder":{color:g.inputPlaceholderText,opacity:1},":-ms-input-placeholder":{color:g.inputPlaceholderText}}},i&&{color:d.neutralTertiary}]}},void 0,{scope:"SearchBox"})},3773:function(e,t,o){var r=o(3774),a=o(33);"string"==typeof r&&(r=[[e.i,r]]);for(var n=0;n<r.length;n++)a.loadStyles(r[n][1],!1);r.locals&&(e.exports=r.locals)},3774:function(e,t,o){(t=e.exports=o(35)(!1)).push([e.i,"._1r9laS8VPBA9nuSQS_w6j-,._3ijMHZEWxbN4kivowf7MK4,._3mZJZGf795p95NsdV-Rm_w{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;height:18px;max-width:120px;white-space:nowrap}html[dir] ._1r9laS8VPBA9nuSQS_w6j-,html[dir] ._3ijMHZEWxbN4kivowf7MK4,html[dir] ._3mZJZGf795p95NsdV-Rm_w{border-radius:2px;border-style:solid;border-width:1px}html[dir=ltr] ._1r9laS8VPBA9nuSQS_w6j-{margin-right:4px}html[dir=rtl] ._1r9laS8VPBA9nuSQS_w6j-{margin-left:4px}html[dir=ltr] ._3mZJZGf795p95NsdV-Rm_w{margin-right:0}html[dir=rtl] ._3mZJZGf795p95NsdV-Rm_w{margin-left:0}._1FxZ72lhgjm677kctDYRxb{font-size:12px;font-weight:400;max-width:120px;overflow:hidden;text-overflow:ellipsis}html[dir] ._1FxZ72lhgjm677kctDYRxb{padding-bottom:2px}html[dir=ltr] ._1FxZ72lhgjm677kctDYRxb,html[dir=rtl] ._1FxZ72lhgjm677kctDYRxb{padding-right:4px;padding-left:4px}",""]),t.locals={categoryContainerCommon:"_3ijMHZEWxbN4kivowf7MK4",categoryContainer:"_1r9laS8VPBA9nuSQS_w6j-",lastCategoryContainer:"_3mZJZGf795p95NsdV-Rm_w",categoryName:"_1FxZ72lhgjm677kctDYRxb"}},3775:function(e,t,o){var r=o(3776),a=o(33);"string"==typeof r&&(r=[[e.i,r]]);for(var n=0;n<r.length;n++)a.loadStyles(r[n][1],!1);r.locals&&(e.exports=r.locals)},3776:function(e,t,o){(t=e.exports=o(35)(!1)).push([e.i,"._25dd-UUJgD6On6jr5WjniL{height:32px}._1E01I2gag5aa1C2XVidLOl{width:176px;height:176px}",""]),t.locals={colorCellClass:"_25dd-UUJgD6On6jr5WjniL",categoryColorPickerMenu:"_1E01I2gag5aa1C2XVidLOl"}},3777:function(e,t,o){var r=o(3778),a=o(33);"string"==typeof r&&(r=[[e.i,r]]);for(var n=0;n<r.length;n++)a.loadStyles(r[n][1],!1);r.locals&&(e.exports=r.locals)},3778:function(e,t,o){(t=e.exports=o(35)(!1)).push([e.i,'._2lr1DOc8GvAzt7e9ejMjfM,._2mO0r88vjS4EQ8QNh-02iY{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}html[dir] ._2mO0r88vjS4EQ8QNh-02iY{text-shadow:0 0 "[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir] ._2Tyu1VZl2q6rzenKtLGI6r._32Q5Vlh2RzhZ2fqygIeAdX,html[dir] ._18rvaIMedS1kGr7Hlm11-A{background:"[theme:neutralLighter, default:#f4f4f4]";border-radius:2px}._3hERCqpP7kbZ1JPOYHDPWG{-ms-flex-align:center;cursor:pointer;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}._2Tyu1VZl2q6rzenKtLGI6r,._3hERCqpP7kbZ1JPOYHDPWG{-webkit-box-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}._2Tyu1VZl2q6rzenKtLGI6r{-ms-flex-align:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;height:24px;width:24px}',""]),t.locals={iconCommon:"_2lr1DOc8GvAzt7e9ejMjfM",categoryIcon:"_2mO0r88vjS4EQ8QNh-02iY",colorPickerContainerDiscoverable:"_18rvaIMedS1kGr7Hlm11-A",colorPickerTagIcon:"_2Tyu1VZl2q6rzenKtLGI6r",colorPickerShown:"_32Q5Vlh2RzhZ2fqygIeAdX",colorPickerIconContainer:"_3hERCqpP7kbZ1JPOYHDPWG"}},3779:function(e,t,o){var r=o(3780),a=o(33);"string"==typeof r&&(r=[[e.i,r]]);for(var n=0;n<r.length;n++)a.loadStyles(r[n][1],!1);r.locals&&(e.exports=r.locals)},3780:function(e,t,o){(t=e.exports=o(35)(!1)).push([e.i,'._1An9A2AWPo5lLOtCqNdInJ,._2ypsx7kWh57k8k9ROoL7as,._22wC_pSOZts2oTaDRzsREm,.q1MKpFwU_3skxabvf0RrH{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}html[dir] ._1An9A2AWPo5lLOtCqNdInJ,html[dir] .q1MKpFwU_3skxabvf0RrH{text-shadow:0 0 "[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir] ._3lYDH95-cWsGKgmspwmef9,html[dir] ._3r_RbX3YIGNSshNB_iwBgr{background:"[theme:neutralLighter, default:#f4f4f4]";border-radius:2px}._15Y9KAkxoCPq5J5zZBbCDF{max-height:436px}._3HFMsnCKYfYV3vfXFkl0Ue{height:1px}html[dir] ._3HFMsnCKYfYV3vfXFkl0Ue{background-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1M1R5kjv-vBG8zf2KstvXY,._2PbaCbI-b8AdRH3Zx5UEoM,._2W_kds5jieAcDdN3lJ5Ut8,._3BOokh1zmvpuFJDZ9yu3eU{-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;display:-webkit-box;display:-ms-flexbox;display:flex;height:36px;line-height:36px}html[dir=ltr] ._1M1R5kjv-vBG8zf2KstvXY,html[dir=ltr] ._2W_kds5jieAcDdN3lJ5Ut8,html[dir=ltr] ._3BOokh1zmvpuFJDZ9yu3eU{padding-right:12px}html[dir=rtl] ._1M1R5kjv-vBG8zf2KstvXY,html[dir=rtl] ._2W_kds5jieAcDdN3lJ5Ut8,html[dir=rtl] ._3BOokh1zmvpuFJDZ9yu3eU{padding-left:12px}html[dir] ._2W_kds5jieAcDdN3lJ5Ut8:focus,html[dir] ._2W_kds5jieAcDdN3lJ5Ut8:hover,html[dir] ._39Qe9NMF7Sny4Tj4Ddtchn{background-color:"[theme:neutralLight, default:#eaeaea]"}._3AbUAmja3wHMk1mUBvDzmc{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}._3E7d49Xpn6qB9UBtb9WuR8,.POccfLRSlQ4i8KuLSBS7g{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;white-space:pre}.POccfLRSlQ4i8KuLSBS7g{font-weight:600;color:"[theme:black, default:#000000]"}html[dir] ._1An9A2AWPo5lLOtCqNdInJ{margin:0 8px}._1WGnQiIPE-54NIMFCb6IG5{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:100%}html[dir=ltr] ._1WGnQiIPE-54NIMFCb6IG5{padding-left:30px}html[dir=rtl] ._1WGnQiIPE-54NIMFCb6IG5{padding-right:30px}._2juc6qP6dqNqB_PTM1aG_1{color:"[theme:neutralTertiary, default:#a6a6a6]";cursor:default}html[dir=ltr] ._3BOokh1zmvpuFJDZ9yu3eU{padding-right:4px}html[dir=rtl] ._3BOokh1zmvpuFJDZ9yu3eU{padding-left:4px}._2ruisOs8q6X1LTnuIb1Aro{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%}html[dir] ._2ruisOs8q6X1LTnuIb1Aro{margin:2px 0;border:1px solid "[theme:white, default:#ffffff]"}html[dir] ._2ruisOs8q6X1LTnuIb1Aro._12hpEsn1qYDImCo_JgVjl{border-color:"[theme:redDark, default:#a80000]"}._10KDdEUgFRxut768hcDr4_{-webkit-box-flex:0;-ms-flex:0 1 100%;flex:0 1 100%}html[dir] .aNUtEFu2LEgUteUeLzUWJ{padding:0}.aNUtEFu2LEgUteUeLzUWJ::-ms-clear{display:none}._1nh5rpiYXiOpoxhB9R8Jw-{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;overflow:hidden}._36GWhDAt2r3_i0G12V6Wra{font-weight:600}._11rI0eu8RYWBbslun5G-Fr,._36GWhDAt2r3_i0G12V6Wra{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}._11rI0eu8RYWBbslun5G-Fr{-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;display:-webkit-box;display:-ms-flexbox;display:flex}html[dir=ltr] ._3r_RbX3YIGNSshNB_iwBgr{margin:auto 4px auto 2px}html[dir=rtl] ._3r_RbX3YIGNSshNB_iwBgr{margin:auto 2px auto 4px}',""]),t.locals={iconCommon:"_22wC_pSOZts2oTaDRzsREm",categoryIcon:"q1MKpFwU_3skxabvf0RrH",categoryIconInMenu:"_1An9A2AWPo5lLOtCqNdInJ",checkMarkIcon:"_2ypsx7kWh57k8k9ROoL7as",colorPickerContainerDiscoverable:"_3lYDH95-cWsGKgmspwmef9",colorPickerTagIconClass:"_3r_RbX3YIGNSshNB_iwBgr",categoryMenu:"_15Y9KAkxoCPq5J5zZBbCDF",categoryMenuDivider:"_3HFMsnCKYfYV3vfXFkl0Ue",categoryMenuItemContainerCommon:"_2PbaCbI-b8AdRH3Zx5UEoM",categoryMenuItemContainerCommonWithRightPadding:"_1M1R5kjv-vBG8zf2KstvXY",categoryMenuItemContainer:"_2W_kds5jieAcDdN3lJ5Ut8",newCategoryMenuItemContainer:"_3BOokh1zmvpuFJDZ9yu3eU",highlightItem:"_39Qe9NMF7Sny4Tj4Ddtchn",categoryName:"_3AbUAmja3wHMk1mUBvDzmc",categorySuggestion:"_3E7d49Xpn6qB9UBtb9WuR8",categoryMatchSuggestion:"POccfLRSlQ4i8KuLSBS7g",extendedMenuItems:"_1WGnQiIPE-54NIMFCb6IG5",disabled:"_2juc6qP6dqNqB_PTM1aG_1",newCategoryMenuItemContainerInternal:"_2ruisOs8q6X1LTnuIb1Aro",isInvalid:"_12hpEsn1qYDImCo_JgVjl",newCategoryTextField:"_10KDdEUgFRxut768hcDr4_",newCategoryTextInput:"aNUtEFu2LEgUteUeLzUWJ",createNewTextContainer:"_1nh5rpiYXiOpoxhB9R8Jw-",createNewCategoryMatchText:"_36GWhDAt2r3_i0G12V6Wra",createNewCategoryText:"_11rI0eu8RYWBbslun5G-Fr"}},541:function(e,t,o){"use strict";o.d(t,"a",function(){return r});var r=o(96).ActionButton},5609:function(e,t,o){"use strict";o.r(t);var r=o(694),a=o(0),n=o(1),i=o(571),l=o(294),c=o(20),s=o(9),u=o(14),d=o(105),p=o(3773),g=o(90).bind(p),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCategoryClicked=function(e){t.props.onCategoryClicked&&(Object(s.n)(i.a.CategoryClickedInCategoryWell.datapoint.name,i.a.CategoryClickedInCategoryWell.datapoint.customData(t.props.actionSource)),t.props.onCategoryClicked(e,t.props.category,t.props.actionSource))},t.onMouseEnterCategory=function(){t.categoryContainerElement.style.borderColor=t.categoryColor.textColor},t.onMouseLeaveCategory=function(){t.categoryContainerElement.style.borderColor=t.categoryColor.secondaryColor},t}return a.__extends(t,e),Object.defineProperty(t.prototype,"categoryColor",{get:function(){return Object(l.a)(this.props.category,this.props.categoryList?this.props.categoryList:Object(d.l)())},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this,t={backgroundColor:this.categoryColor.primaryColor,borderColor:this.categoryColor.secondaryColor,color:this.categoryColor.textColor,cursor:this.props.onCategoryClicked?"pointer":"initial"},o=this.props.category,r=g(this.props.containerClassName,this.props.isLastInWell?p.lastCategoryContainer:p.categoryContainer);return n.createElement("div",{ref:function(t){return e.categoryContainerElement=t},key:o,className:r,style:t,title:o,onMouseEnter:this.onMouseEnterCategory,onMouseLeave:this.onMouseLeaveCategory,onClick:this.onCategoryClicked},n.createElement("span",{className:p.categoryName},o))},a.__decorate([c.computed],t.prototype,"categoryColor",null),t=a.__decorate([u.observer],t)}(n.Component),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.componentDidMount=function(){this.logNumberOfCategories(this.props.categories)},t.prototype.componentWillReceiveProps=function(e){this.props.categories.length!=e.categories.length&&this.logNumberOfCategories(e.categories)},t.prototype.logNumberOfCategories=function(e){Object(s.n)(i.a.CategoriesInCategoryWell.datapoint.name,i.a.CategoriesInCategoryWell.datapoint.customData(e.length))},t.prototype.render=function(){return n.createElement("div",{className:this.props.categoryWellContainerClass},this.renderCategories(this.props.categories,this.props.categoryContainerClass))},t.prototype.renderCategories=function(e,t){for(var o=[],r=e.length-1;r>=0;r--){var a=e[r];o.push(n.createElement(h,{key:a,actionSource:"CategoryWell",category:a,containerClassName:t,isLastInWell:0==r,onCategoryClicked:this.props.onCategoryClicked,categoryList:this.props.categoryList}))}return o},t=a.__decorate([u.observer],t)}(n.Component),m=o(685),y=o(118),f=o(4),b=Object(f.action)("setColorPickerTarget")(function(e){y.a.categoryColorPickerViewState.colorPickerTarget=e}),v=Object(f.action)("setShouldShowColorPicker")(function(e){y.a.categoryColorPickerViewState.shouldShowColorPicker=e}),_=o(53),k=o(10),x=o.n(k),w=o(7);function S(e){switch(e){case _.a.Red:return x.a.red_Category_ColorPicker_Text;case _.a.Orange:return x.a.orange_Category_ColorPicker_Text;case _.a.Peach:return x.a.peach_Category_ColorPicker_Text;case _.a.YellowLight:return x.a.yellow_Category_ColorPicker_Text;case _.a.GreenLight:return x.a.green_Category_ColorPicker_Text;case _.a.TealLight:return x.a.tealLight_Category_ColorPicker_Text;case _.a.Olive:return x.a.olive_Category_ColorPicker_Text;case _.a.BlueSky:return x.a.blue_Category_ColorPicker_Text;case _.a.PurpleLight:return x.a.purple_Category_ColorPicker_Text;case _.a.Pink:return x.a.pink_Category_ColorPicker_Text;case _.a.SteelLight:return x.a.steelLight_Category_ColorPicker_Text;case _.a.SteelGrey:return x.a.steelGray_Category_ColorPicker_Text;case _.a.GreyLight:return x.a.grayLight_Category_ColorPicker_Text;case _.a.GreyDark:return x.a.gray_Category_ColorPicker_Text;case _.a.Black:return x.a.black_Category_ColorPicker_Text;case _.a.RedDark:return x.a.redDark_Category_ColorPicker_Text;case _.a.OrangeDark:return x.a.orangeDark_Category_ColorPicker_Text;case _.a.BrownMedium:return x.a.brown_Category_ColorPicker_Text;case _.a.YellowDark:return x.a.yellowDark_Category_ColorPicker_Text;case _.a.GreenDark:return x.a.greenDark_Category_ColorPicker_Text;case _.a.TealDark:return x.a.tealDark_Category_ColorPicker_Text;case _.a.OliveDark:return x.a.oliveDark_Category_ColorPicker_Text;case _.a.BlueDark:return x.a.blueDark_Category_ColorPicker_Text;case _.a.PurpleDark:return x.a.purpleDark_Category_ColorPicker_Text;case _.a.MagentaDark:return x.a.magentaDark_Category_ColorPicker_Text;case _.a.None:return"";default:return w.c.info("getColorCodeString should be called with a know colorCode"),x.a.gray_Category_ColorPicker_Text}}var M=o(1647),N=o(1842),I=o(1843),P=o(563),O=o(560),E=o(1849),D=o(1825),T=o(1845),B=o(1848),j=Object(I.a)(),F=function(e){function t(t){var o=e.call(this,t)||this;return o._id=Object(P.c)(),o}return a.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,o=t.items,r=t.columnCount,i=t.onRenderItem,l=t.positionInSet,c=t.setSize,s=t.styles,u=Object(T.f)(this.props,T.g,["onBlur, aria-posinset, aria-setsize"]),d=j(s,{theme:this.props.theme}),p=Object(E.i)(o,r),g=n.createElement("table",a.__assign({},u,{"aria-posinset":l,"aria-setsize":c,id:this._id,role:"grid",className:d.root}),n.createElement("tbody",null,p.map(function(t,o){return n.createElement("tr",{role:"row",key:e._id+"-"+o+"-row"},t.map(function(t,o){return n.createElement("td",{role:"presentation",key:e._id+"-"+o+"-cell",className:d.tableCell},i(t,o))}))})));return this.props.doNotContainWithinFocusZone?g:n.createElement(B.a,{isCircularNavigation:this.props.shouldFocusCircularNavigate,className:d.focusedContainer,onBlur:this.props.onBlur},g)},t}(D.a),L=Object(N.a)(F,function(e){return{root:{padding:2,outline:"none"},tableCell:{padding:0}}}),A={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},V=255;function W(e){return function(e){var t=A[e.toLowerCase()];if(t)return{r:t[0],g:t[1],b:t[2],a:100}}(e)||function(e){if("#"===e[0]&&4===e.length)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:100}}(e)||function(e){if("#"===e[0]&&7===e.length)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:100}}(e)||function(e){if(0===e.indexOf("rgb(")){var t=(e=e.match(/rgb\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:100}}}(e)||function(e){if(0===e.indexOf("rgba(")){var t=(e=e.match(/rgba\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:100*t[3]}}}(e)||function(e){if(0===e.indexOf("hsl(")){var t=(e=e.match(/hsl\(([^)]+)\)/)[1]).split(/ *, */),o=parseInt(t[0],10),r=parseInt(t[1],10),a=parseInt(t[2],10),n=H(o,r,a);return n.a=100,n}}(e)||function(e){if(0===e.indexOf("hsla(")){var t=(e=e.match(/hsla\(([^)]+)\)/)[1]).split(/ *, */),o=parseInt(t[0],10),r=parseInt(t[1],10),a=parseInt(t[2],10),n=100*parseInt(t[3],10),i=H(o,r,a);return i.a=n,i}}(e)}function R(e,t,o){return[K(e),K(t),K(o)].join("")}function G(e,t,o){var r=NaN,a=Math.max(e,t,o),n=a-Math.min(e,t,o);return 0===n?r=0:e===a?r=(t-o)/n%6:t===a?r=(o-e)/n+2:o===a&&(r=(e-t)/n+4),(r=Math.round(60*r))<0&&(r+=360),{h:r,s:Math.round(100*(0===a?0:n/a)),v:Math.round(a/255*100)}}function H(e,t,o){var r,a,n=(r=t,{h:e,s:2*(r*=((a=o)<50?a:100-a)/100)/(a+r)*100,v:a+r});return U(n.h,n.s,n.v)}function U(e,t,o){var r=[],a=(o/=100)*(t/=100),n=e/60,i=a*(1-Math.abs(n%2-1)),l=o-a;switch(Math.floor(n)){case 0:r=[a,i,0];break;case 1:r=[i,a,0];break;case 2:r=[0,a,i];break;case 3:r=[0,i,a];break;case 4:r=[i,0,a];break;case 5:r=[a,0,i]}return{r:Math.round(V*(r[0]+l)),g:Math.round(V*(r[1]+l)),b:Math.round(V*(r[2]+l))}}function K(e){var t=e.toString(16);return 1===t.length?"0"+t:t}var q=o(530),Z=o(541),z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onClick=function(){var e=t.props,o=e.onClick,r=e.disabled,a=e.item;o&&!r&&o(a)},t._onMouseEnter=function(e){var o=t.props,r=o.onHover,a=o.disabled,n=o.item,i=o.onMouseEnter;i&&i(e)||!r||a||r(n)},t._onMouseMove=function(e){var o=t.props,r=o.onHover,a=o.disabled,n=o.item,i=o.onMouseMove;i&&i(e)||!r||a||r(n)},t._onMouseLeave=function(e){var o=t.props,r=o.onHover,a=o.disabled,n=o.onMouseLeave;n&&n(e)||!r||a||r()},t._onFocus=function(){var e=t.props,o=e.onFocus,r=e.disabled,a=e.item;o&&!r&&o(a)},t}return a.__extends(t,e),t.prototype.render=function(){var e,t=this.props,o=t.item,r=t.id,a=t.className,i=t.role,l=t.selected,c=t.disabled,s=t.onRenderItem,u=t.cellDisabledStyle,d=t.cellIsSelectedStyle,p=t.index,g=t.label,h=t.getClassNames;return n.createElement(Z.a,{id:r,"data-index":p,"data-is-focusable":!0,disabled:c,className:Object(q.css)(a,(e={},e[""+d]=l,e[""+u]=c,e)),onClick:this._onClick,onMouseEnter:this._onMouseEnter,onMouseMove:this._onMouseMove,onMouseLeave:this._onMouseLeave,onFocus:this._onFocus,role:i,"aria-selected":l,ariaLabel:g,title:g,getClassNames:h},s(o))},t.defaultProps={disabled:!1,id:Object(P.c)("gridCell")},t}(n.Component),Y=o(934),J=o(41),Q=Object(I.a)(),$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t}(z),X=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderColorOption=function(e){return n.createElement("svg",{className:t._classNames.svg,viewBox:"0 0 20 20",fill:function(e){var t=W(e);if(t){var o=t.a,r=t.b,a=t.g,n=t.r,i=G(n,a,r),l=i.h,c=i.s,s=i.v;return{a:o,b:r,g:a,h:l,hex:R(n,a,r),r:n,s:c,str:e,v:s}}}(e.color).str},t.props.circle?n.createElement("circle",{cx:"50%",cy:"50%",r:"50%"}):n.createElement("rect",{width:"100%",height:"100%"}))},t._getClassNames=function(e,o,r,a,n,i,l,c,s){var u=Object(Y.a)(e);return Object(J.mergeStyleSets)(t._classNames,{root:["ms-Button",u.root,r,o,l&&["is-checked",u.rootChecked],i&&["is-disabled",u.rootDisabled],!i&&!l&&{selectors:{":hover":u.rootHovered,":focus":u.rootFocused,":active":u.rootPressed}},i&&l&&[u.rootCheckedDisabled],!i&&l&&{selectors:{":hover":u.rootCheckedHovered,":active":u.rootCheckedPressed}}],flexContainer:["ms-Button-flexContainer",u.flexContainer]})},t}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.item,o=e.id,r=e.selected,a=e.disabled,i=e.styles,l=e.theme,c=e.circle,s=e.color,u=e.onClick,d=e.onHover,p=e.onFocus,g=e.onMouseEnter,h=e.onMouseMove,C=e.onMouseLeave,m=e.onWheel,y=e.onKeyDown;return this._classNames=Q(i,{theme:l,disabled:a,selected:r,circle:c,isWhite:this._isWhiteCell(s)}),n.createElement($,{item:t,id:o+"-"+t.id+"-"+t.index,key:t.id,disabled:a,role:"gridcell",onRenderItem:this._onRenderColorOption,selected:r,onClick:u,onHover:d,onFocus:p,label:t.label,className:this._classNames.colorCell,getClassNames:this._getClassNames,index:t.index,onMouseEnter:g,onMouseMove:h,onMouseLeave:C,onWheel:m,onKeyDown:y})},t.prototype._isWhiteCell=function(e){return"#ffffff"===e.toLocaleLowerCase()},t.defaultProps={circle:!0,disabled:!1,selected:!1},t}(n.Component),ee=o(1633);function te(e,t){return{width:12,height:12,border:"4px solid",borderColor:e,boxShadow:t?"none":"0 0 0 1px #969696",padding:4,margin:0}}var oe=Object(N.a)(X,function(e){var t,o=e.theme,r=e.disabled,a=e.selected,n=e.circle,i=e.isWhite,l=o.semanticColors;return{colorCell:[{backgroundColor:"transparent",padding:0,overflow:"visible",position:"relative",boxSizing:"border-box",display:"inline-block",border:"1px solid transparent",background:"transparent",cursor:"pointer",textAlign:"center",verticalAlign:"top",userSelect:"none",height:40,selectors:(t={},t[J.HighContrastSelector]={border:"none"},t["."+ee.a+" &:focus, ."+ee.a+" &:focus::after"]={border:"none"},t["."+ee.a+" &:focus $svg"]=te(o.palette.neutralQuaternaryAlt,!1),t[":hover $svg"]=te(o.palette.neutralQuaternaryAlt,!0),t[":focus $svg"]=te(o.palette.neutralQuaternaryAlt,!1),t[":active $svg"]=te("#969696",!1),t)},i&&{selectors:{$svg:{padding:0,border:"1px solid",borderColor:o.palette.neutralTertiary,margin:4}}},n&&{selectors:{$svg:{borderRadius:"100%"}}},a&&{selectors:{$svg:{boxShadow:"0 0 0 1px #969696",border:"4px solid",borderColor:o.palette.neutralTertiaryAlt,width:12,height:12},":hover $svg":{boxShadow:"0 0 0 1px #969696"},":focus $svg":{boxShadow:"0 0 0 1px #969696"},":active $svg":{boxShadow:"0 0 0 1px #969696",borderColor:"#969696"}}},a&&i&&{selectors:{$svg:{padding:4,margin:0}}},r&&{color:l.disabledBodyText,cursor:"default",pointerEvents:"none",opacity:.3}],svg:[{width:20,height:20,padding:4,boxSizing:"content-box"}]}},void 0,{scope:"ColorPickerGridCell"}),re=Object(I.a)(),ae=function(e){function t(t){var o,r=e.call(this,t)||this;return r.navigationIdleDelay=250,r._onSwatchColorPickerBlur=function(){r.props.onCellFocused&&(r._cellFocused=!1,r.props.onCellFocused())},r._renderOption=function(e){var t=r._id;return n.createElement(oe,{item:e,id:t,color:e.color,styles:r.props.getColorGridCellStyles,disabled:r.props.disabled,onClick:r._onCellClick,onHover:r._onGridCellHovered,onFocus:r._onGridCellFocused,selected:void 0!==r.state.selectedIndex&&r.state.selectedIndex===e.index,circle:"circle"===r.props.cellShape,label:e.label,onMouseEnter:r._onMouseEnter,onMouseMove:r._onMouseMove,onMouseLeave:r._onMouseLeave,onWheel:r._onWheel,onKeyDown:r._onKeyDown})},r._onMouseEnter=function(e){return r.props.focusOnHover?(r.isNavigationIdle&&!r.props.disabled&&e.currentTarget.focus(),!0):!(r.isNavigationIdle&&!r.props.disabled)},r._onMouseMove=function(e){if(!r.props.focusOnHover)return!(r.isNavigationIdle&&!r.props.disabled);var t=e.currentTarget;return!r.isNavigationIdle||document&&t===document.activeElement||t.focus(),!0},r._onMouseLeave=function(e){var t=r.props.mouseLeaveParentSelector;if(r.props.focusOnHover&&t&&r.isNavigationIdle&&!r.props.disabled)for(var o=document.querySelectorAll(t),a=0;a<o.length;a+=1)if(o[a].contains(e.currentTarget)){if(o[a].setActive)try{o[a].setActive()}catch(e){}else o[a].focus();break}},r._onWheel=function(){r.setNavigationTimeout()},r._onKeyDown=function(e){38!==e.which&&40!==e.which&&37!==e.which&&39!==e.which||r.setNavigationTimeout()},r.setNavigationTimeout=function(){r.isNavigationIdle||void 0===r.navigationIdleTimeoutId?r.isNavigationIdle=!1:(r.async.clearTimeout(r.navigationIdleTimeoutId),r.navigationIdleTimeoutId=void 0),r.navigationIdleTimeoutId=r.async.setTimeout(function(){r.isNavigationIdle=!0},r.navigationIdleDelay)},r._onGridCellHovered=function(e){var t=r.props.onCellHovered;if(t)return e?t(e.id,e.color):t()},r._onGridCellFocused=function(e){var t=r.props.onCellFocused;if(t)return e?(r._cellFocused=!0,t(e.id,e.color)):(r._cellFocused=!1,t())},r._onCellClick=function(e){if(!r.props.disabled){var t=e.index;t>=0&&t!==r.state.selectedIndex&&(r.props.onCellFocused&&r._cellFocused&&(r._cellFocused=!1,r.props.onCellFocused()),r.props.onColorChanged&&r.props.onColorChanged(e.id,e.color),r.setState({selectedIndex:t}))}},r._id=t.id||Object(P.c)("swatchColorPicker"),r._warnMutuallyExclusive({focusOnHover:"onHover"}),r._warnConditionallyRequiredProps(["focusOnHover"],"mouseLeaveParentSelector",!!r.props.mouseLeaveParentSelector),r.isNavigationIdle=!0,r.async=new O.Async(r),t.selectedId&&(o=r._getSelectedIndex(t.colorCells,t.selectedId)),r.state={selectedIndex:o},r}return a.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){var t;e.selectedId&&(t=this._getSelectedIndex(e.colorCells,e.selectedId)),t!==this.state.selectedIndex&&this.setState({selectedIndex:t})},t.prototype.componentWillUnmount=function(){this.props.onCellFocused&&this._cellFocused&&(this._cellFocused=!1,this.props.onCellFocused())},t.prototype.render=function(){var e=this.props,t=e.colorCells,o=e.columnCount,r=e.positionInSet,i=e.setSize,l=e.shouldFocusCircularNavigate,c=e.className,s=e.doNotContainWithinFocusZone,u=e.styles,d=re(u,{theme:this.props.theme,className:c});return t.length<1||o<1?null:n.createElement(L,a.__assign({},this.props,{items:t.map(function(e,t){return a.__assign({},e,{index:t})}),columnCount:o,onRenderItem:this._renderOption,positionInSet:r&&r,setSize:i&&i,shouldFocusCircularNavigate:l,doNotContainWithinFocusZone:s,onBlur:this._onSwatchColorPickerBlur,theme:this.props.theme,styles:function(e){return{root:d.root,tableCell:d.tableCell,focusedContainer:d.focusedContainer}}}))},t.prototype._getSelectedIndex=function(e,t){var o=Object(E.e)(e,function(e){return e.id===t});return o>=0?o:void 0},t.defaultProps={cellShape:"circle",disabled:!1,shouldFocusCircularNavigate:!0},t}(D.a),ne={focusedContainer:"ms-swatchColorPickerBodyContainer"},ie=Object(N.a)(ae,function(e){var t=e.className,o=e.theme;return{root:{padding:2,outline:"none"},tableCell:{padding:0},focusedContainer:[Object(J.getGlobalClassNames)(ne,o).focusedContainer,{clear:"both",display:"block",minWidth:"180px"},t]}},void 0,{scope:"SwatchColorPicker"}),le=o(3775),ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=this;return n.createElement(M.a,{className:le.categoryColorPickerMenu,items:[{key:"category_color_picker",onRender:function(){return n.createElement(ie,{key:"category_color_picker",cellShape:"circle",colorCells:e.getColorCellMenuItems(),columnCount:5,getColorGridCellStyles:e.getColorGridCellStyles,onColorChanged:e.props.onColorSelected,selectedId:e.props.selectedColorId,shouldFocusCircularNavigate:!0})}}],calloutProps:{styles:function(e){return{root:{animation:"none",animationDuration:"0s"}}}},onDismiss:this.props.onDismissColorPicker,shouldFocusOnMount:!0,target:this.props.targetElement})},t.prototype.getColorCellMenuItems=function(){for(var e=[],t=[_.a.Red,_.a.Orange,_.a.Peach,_.a.YellowLight,_.a.GreenLight,_.a.TealLight,_.a.Olive,_.a.BlueSky,_.a.PurpleLight,_.a.Pink,_.a.SteelLight,_.a.SteelGrey,_.a.GreyLight,_.a.GreyDark,_.a.Black,_.a.RedDark,_.a.OrangeDark,_.a.BrownMedium,_.a.YellowDark,_.a.GreenDark,_.a.TealDark,_.a.OliveDark,_.a.BlueDark,_.a.PurpleDark,_.a.MagentaDark],o=0;o<t.length;o++){var r=y.a.colorCodeColorValueMap[t[o]];e.push({id:t[o].toString(),color:r.iconColor,label:S(t[o])})}return e},t.prototype.getColorGridCellStyles=function(e){var t=e.theme,o=e.selected;return{colorCell:[{padding:0,display:"flex",justifyContent:"center",alignItems:"center",overflow:"visible",width:32,height:32,selectors:{$svg:{alignItems:"center",boxShadow:"none",display:"flex",height:20,width:20,justifyContent:"center",padding:3},"&:hover $svg, &:active $svg, &:focus $svg":{padding:2,border:"4px solid",width:16,height:16,minWidth:16},"&:hover $svg, &:focus $svg":{borderColor:t.palette.neutralQuaternaryAlt,width:16,height:16,boxShadow:"none"},"&:active $svg":{borderColor:t.palette.themeLight+"!important",boxShadow:"none"},".ms-Fabric.is-focusVisible &:focus $svg":{boxShadow:"none",padding:2,border:"4px solid",borderColor:t.palette.neutralQuaternaryAlt,width:20,height:20,minWidth:20,selectors:{"&:focus::after":{width:20,height:20,outline:"transparent!important",boxShadow:"0 0 0 1px "+t.palette.neutralSecondary,border:"none"}}},"&:focus $svg":{boxShadow:"none",selectors:{"&:focus::after":{width:20,height:20,marginTop:6,marginLeft:6}}}}},o&&{selectors:{$svg:{border:"4px solid",borderColor:t.palette.themeLight+"!important",borderRadius:"100%",padding:2,width:20,height:20,minWidth:20,boxShadow:"none"}}}]}},t=a.__decorate([u.observer],t)}(n.Component),se=o(11),ue=o.n(se),de=o(3777),pe=o(90).bind(de),ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onBlur=function(e){t.props.onBlur&&!y.a.categoryColorPickerViewState.shouldShowColorPicker&&t.props.onBlur()},t.onNewCategoryColorSelected=function(e){t.hideColorPicker(),t.props.onNewCategoryColorSelected&&t.props.onNewCategoryColorSelected(e)},t.dismissColorPicker=function(){t.hideColorPicker(),t.props.onBlur&&t.props.onBlur()},t.hideColorPicker=function(){b(null),v(!1)},t.onKeyDownOnColorPickerIcon=function(e){switch(e.which){case 13:case 32:e.stopPropagation(),t.setTargetAndShowColorPicker()}},t.onColorPickerIconClicked=function(e){e.stopPropagation(),t.setTargetAndShowColorPicker()},t.setTargetAndShowColorPicker=function(){b(t.colorPickerDiv),v(!0)},t}return a.__extends(t,e),t.prototype.render=function(){var e=this,t=y.a.categoryColorPickerViewState,o=t.shouldShowColorPicker,r=t.colorPickerTarget,a=this.props,i=a.colorPickerIconContainerClass,l=a.categoryColorId,c=a.categoryColorPickerSource,s=o&&this.colorPickerDiv==r,u=pe(this.props.colorPickerTagIconClass,{colorPickerShown:s},de.colorPickerTagIcon);return n.createElement("div",{ref:function(t){return e.colorPickerDiv=t},role:"button","aria-label":ue.a.categoryMenuColorPickerTooltip,onBlur:this.onBlur,onKeyDown:this.onKeyDownOnColorPickerIcon,onClick:this.onColorPickerIconClicked,"data-click-source":c,className:pe(i,de.colorPickerIconContainer),tabIndex:0,title:ue.a.categoryMenuColorPickerTooltip},n.createElement(m.a,{categoryColorId:l,iconClassName:u,categoryList:this.props.categoryList}),s&&this.renderColorPicker(l,r))},t.prototype.renderColorPicker=function(e,t){return n.createElement(ce,{onColorSelected:this.onNewCategoryColorSelected,onDismissColorPicker:this.dismissColorPicker,selectedColorId:e,targetElement:t})},t=a.__decorate([u.observer],t)}(n.Component),he=o(791),Ce=Object(f.action)("setColorPickerSelectedColorId")(function(e){y.a.categoryMenuViewState.newCategoryViewState.selectedColorId=e}),me=Object(f.action)("setNewCategoryInvalidState")(function(e){y.a.categoryMenuViewState.newCategoryViewState.isInvalid=e}),ye=Object(f.action)("setNewCategoryText")(function(e){y.a.categoryMenuViewState.newCategoryViewState.categoryText=e,me(!1)}),fe=o(223),be=o(405),ve=o(1824),_e=o(1887),ke=o(18),xe=o(225),we=o(3779),Se=o(90).bind(we),Me=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderCreateNewMenu=function(){var e=y.a.categoryMenuViewState.findText,o=fe.a.toString(),r=Object(ke.format)(ue.a.categoryMenuCreateNewAriaLabel,e);return n.createElement("div",{"aria-label":r,className:Se(we.categoryMenuItemContainer,t.props.containerClass),"data-is-focusable":!0,onKeyDown:function(r){return t.onKeyDownOnCreateNewCategory(r,e,o)},onClick:function(r){return t.onCreateNewCategoryClicked(r,e,o)},role:"menuitem"},t.renderCreateNewIcon(o),t.renderCreateNew(o))},t.renderNewCategoryEditMenu=function(){var e=y.a.categoryMenuViewState.newCategoryViewState,o=Se(we.newCategoryMenuItemContainerInternal,{isInvalid:e.isInvalid});return n.createElement("div",{className:we.newCategoryMenuItemContainer,"data-is-focusable":!0,role:"menuitem"},n.createElement("div",{className:o},t.renderColorPickerControl(e.selectedColorId),t.renderNewCategoryTextField()))},t.renderCreateNewIcon=function(e){return n.createElement(m.a,{categoryColorId:e,iconClassName:we.categoryIconInMenu,categoryList:Object(xe.a)()})},t.renderColorPickerControl=function(e){return n.createElement(ge,{onNewCategoryColorSelected:t.onNewCategoryColorSelected,categoryColorId:e,colorPickerTagIconClass:we.colorPickerTagIconClass,categoryList:Object(xe.a)()})},t.onNewCategoryColorSelected=function(e){Ce(e),t.textField.focus()},t.renderNewCategoryTextField=function(){return n.createElement(ve.a,{autoFocus:!0,borderless:!0,componentRef:function(e){return t.textField=e},className:we.newCategoryTextField,inputClassName:we.newCategoryTextInput,multiline:!1,onChanged:t.onNewCategoryTextChanged,onKeyDown:t.onKeyDownOnNewTextField,placeholder:ue.a.categoryMenuAddCategoryNameText,value:y.a.categoryMenuViewState.newCategoryViewState.categoryText})},t.onNewCategoryTextChanged=function(e){ye(e.trim())},t.onKeyDownOnNewTextField=function(e){switch(e.keyCode){case 37:!Object(_e.a)()&&t.textField.value&&e.stopPropagation();break;case 39:Object(_e.a)()&&t.textField.value&&e.stopPropagation();break;case 13:t.commitNewCategory(t.textField.value,+y.a.categoryMenuViewState.newCategoryViewState.selectedColorId);break;case 27:e.stopPropagation(),Object(he.a)()}},t.onKeyDownOnCreateNewCategory=function(e,o,r){13==e.keyCode&&(e.stopPropagation(),t.commitNewCategory(o,+r),Object(s.n)(i.a.createNewCategory.datapoint.name))},t.onCreateNewCategoryClicked=function(e,o,r){e.stopPropagation(),t.commitNewCategory(o,+r),Object(s.n)(i.a.createNewCategory.datapoint.name)},t.commitNewCategory=function(e,o){Object(be.a)(e,Object(xe.a)())?t.props.createNew(e,o,t.props.actionSource):me(!0)},t}return a.__extends(t,e),t.prototype.render=function(){var e=y.a.categoryMenuViewState.newCategoryViewState;return this.props.isEditMode?e?this.renderNewCategoryEditMenu():null:this.renderCreateNewMenu()},t.prototype.renderCreateNew=function(e){var t=y.a.categoryMenuViewState.findText;return n.createElement("div",{className:we.createNewTextContainer},n.createElement("div",{className:we.createNewCategoryMatchText},'"'+t+'"'),n.createElement("div",{className:we.createNewCategoryText}," ",ue.a.categoryMenuCreateNewText))},t=a.__decorate([u.observer],t)}(n.Component),Ne=o(714),Ie=Object(f.action)("addMasterCategories",i.a.addMasterCategories)(function(e,t){if(!e||0===e.length)return w.c.error("No categories to add"),Promise.resolve(!1);var o=Object(xe.a)();return e.forEach(function(e){o.push(e),Object(y.b)().pendingNewCategoriesNameMap[e.Name]=e}),Object(Ne.a)(e,void 0,void 0).then(function(t){return t.WasSuccessful?(o=e,r=t.MasterList,o.forEach(function(e){var t=r.filter(function(t){return t.Name===e.Name})[0];e.Id=t.Id,delete Object(y.b)().pendingNewCategoriesNameMap[e.Name]}),!0):(Ee(e,t.ErrorCode.toString()),!1);var o,r}).catch(function(){return Ee(e),!1})}),Pe=Object(f.action)("removeMasterCategories",i.a.removeMasterCategories)(function(e,t){if(e&&0!==e.length){var o=Object(xe.a)(),r=!1;e.forEach(function(e){for(var t=0;t<o.length;t++)if(e===o[t].Name){o.splice(t,1),r=!0;break}}),Te(r,"remove"),Object(Ne.a)(void 0,e,void 0).then(function(e){e.WasSuccessful||De("remove",e.ErrorCode.toString())}).catch(function(){De("remove")})}else w.c.error("No categories to remove")}),Oe=Object(f.action)("changeMasterCategories",i.a.changeMasterCategories)(function(e,t){if(e&&0!==e.length){var o=Object(xe.a)(),r=!1;e.forEach(function(e){for(var t=0;t<o.length;t++)if(o[t].Id===e.Id){o[t]=e,r=!0;break}}),Te(r,"change"),Object(Ne.a)(void 0,void 0,e).then(function(e){e.WasSuccessful||De("change",e.ErrorCode.toString())}).catch(function(){De("change")})}else w.c.error("No categories to change")});function Ee(e,t){e.forEach(function(e){var t=Object(xe.a)().indexOf(e);Object(xe.a)().splice(t,1),delete Object(y.b)().pendingNewCategoriesNameMap[e.Name]}),De("add",t)}function De(e,t){Object(s.n)(i.a.errorUpdatingMasterCategories.datapoint.name,i.a.errorUpdatingMasterCategories.datapoint.customData(e,t))}function Te(e,t){e||w.c.error("No matching category found. operation: "+t)}var Be=Object(f.action)("setInitialNewCategoryViewState")(function(){y.a.categoryMenuViewState.newCategoryViewState={categoryText:"",selectedColorId:fe.b.toString(),isInvalid:!1}}),je=o(818),Fe=Object(f.action)("setIsFocusInSearchBox")(function(e){y.a.categoryMenuViewState.isFocusInSearchBox=e}),Le=o(819),Ae=o(715),Ve=o(1636),We=o(1826),Re=o(104),Ge=o(1886),He=o(998),Ue=o(90).bind(He),Ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dismissMenu=function(){t.props.dismissMenu()},t.onSearchInputChange=function(e){Object(je.a)(e),Object(Le.a)(!1),Object(he.a)()},t.onSearchBoxRender=function(){return n.createElement(Ge.a,{key:"searchCategoryMenu",className:He.categoryMenuItemContainerCommon,componentRef:function(e){t.searchBoxRef=e},placeholder:ue.a.categoryMenuSearchBoxPlaceholderText,onEscape:t.onEscapeOnSearchBox,onSearch:t.onEnterOnSearchBox,onChange:t.onSearchInputChange,onBlur:t.onBlurOnSearchBox,onFocus:t.onFocusOnSearchBox,styles:t.getSearchBoxStyles,value:y.a.categoryMenuViewState.findText})},t.onFocusOnSearchBox=function(e){Fe(!0)},t.onBlurOnSearchBox=function(e){Fe(!1),t.onSearchBoxEnterCallback=null},t.onEscapeOnSearchBox=function(e){t.dismissMenu()},t.onEnterOnSearchBox=function(e){t.onSearchBoxEnterCallback&&t.onSearchBoxEnterCallback(),Object(s.n)(i.a.categoryMenuSearchBoxEnterClicked.datapoint.name,i.a.categoryMenuSearchBoxEnterClicked.datapoint.customData(t.props.actionSource))},t.focusOnSearchBox=function(){t.searchBoxRef&&t.searchBoxRef.focus()},t.onCategoryClicked=function(e,o,r){t.dismissMenu(),o?t.props.onCheckedCategoryClicked(e):t.props.onUncheckedCategoryClicked(e),Object(s.n)(i.a.categoryMenuSelectCategory.datapoint.name,i.a.categoryMenuSelectCategory.datapoint.customData(r,t.props.actionSource))},t.onNewCategoryClicked=function(e){e.stopPropagation(),Object(je.a)(""),Be(),Object(s.n)(i.a.categoryMenuNewCategoryClicked.datapoint.name,i.a.categoryMenuNewCategoryClicked.datapoint.customData(t.props.actionSource))},t.onViewAllClicked=function(e){e.stopPropagation(),e.preventDefault(),Object(je.a)(""),Object(he.a)(),Object(Le.a)(!0),Object(s.n)(i.a.categoryMenuViewAllCategoriesClicked.datapoint.name,i.a.categoryMenuViewAllCategoriesClicked.datapoint.customData(t.props.actionSource)),t.focusOnSearchBox()},t.onManageCategoryClicked=function(e){t.dismissMenu(),t.props.onManageCategoryClicked(),Object(s.n)(i.a.categoryMenuEditCategoriesClicked.datapoint.name,i.a.categoryMenuEditCategoriesClicked.datapoint.customData(t.props.actionSource))},t.onClearCategoriesClicked=function(e){t.dismissMenu(),t.props.onClearCategoriesClicked(),Object(s.n)(i.a.categoryMenuClearCategoriesClicked.datapoint.name,i.a.categoryMenuClearCategoriesClicked.datapoint.customData(t.props.actionSource))},t.shouldHighlightTopItem=function(){return y.a.categoryMenuViewState.isFocusInSearchBox&&y.a.categoryMenuViewState.findText.length>0},t.addCreateNewMenu=function(e,o){var r;!o&&t.shouldHighlightTopItem()&&(r=He.highlightItem,t.onSearchBoxEnterCallback=function(){t.createNewCategoryOnEnterOnSearch()}),e.push(n.createElement(Me,{key:"createNewCategory",actionSource:"CommandBarCreateNew",containerClass:r,isEditMode:!1,createNew:t.createNewAndClickCategory}))},t.createNewCategoryOnEnterOnSearch=function(){t.createNewAndClickCategory(y.a.categoryMenuViewState.findText,fe.a,"SearchBoxMenu")},t.addViewAllMenu=function(e){e.push(n.createElement("div",{key:"categoriesViewAll",className:He.categoryMenuItemContainer,"data-is-focusable":!0,role:"menuitem",onClick:t.onViewAllClicked},n.createElement("div",{title:ue.a.categoryMenuAllCategoriesTooltip,className:He.extendedMenuItems},ue.a.categoryMenuAllCategoriesText)))},t.onCategoryIconClicked=function(){Object(s.n)(i.a.categoryMenuCategoryIconClickedOnFilteredCategory.datapoint.name,i.a.categoryMenuCategoryIconClickedOnFilteredCategory.datapoint.customData(t.props.actionSource))},t.createNewAndClickCategory=function(e,o,r){t.dismissMenu();var a=[{Id:Object(Re.getGuid)(),Name:e,Color:o}],n=Ie(a,r);t.props.onAfterCreateNewCategory(e,n)},t.addClearCategoryMenu=function(e){e.push(n.createElement("div",{key:"clearCategories",className:He.categoryMenuItemContainer,"data-is-focusable":!0,role:"menuitem",onClick:t.onClearCategoriesClicked},n.createElement("div",{title:ue.a.categoryMenuClearCategoriesText,className:He.extendedMenuItems},ue.a.categoryMenuClearCategoriesTooltipText)))},t.addDividerMenu=function(e,t){e.push(n.createElement("div",{className:He.categoryMenuDivider}))},t.getSearchBoxStyles=function(e){return{root:[{paddingLeft:0}],icon:[{opacity:1,transition:"none"}],iconContainer:[{width:30,color:e.theme.palette.neutralPrimary}]}},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){this.focusOnSearchBox()},t.prototype.render=function(){return n.createElement(B.a,{direction:Ve.a.bidirectional,handleTabKey:1,shouldInputLoseFocusOnArrowKey:function(e){return!0}},this.renderCategoryMenu())},t.prototype.renderCategoryMenu=function(){var e=[],t=!1,o=!1,r=y.a.categoryMenuViewState,n=r.findText,i=r.shouldShowAllCategories,l=this.getAllCategoryNames(),c=n.trim().length>0;if(this.onSearchBoxEnterCallback=null,i)e=l.sort(function(e,t){return e.localeCompare(t)});else{if(c){var s=Object(Ae.a)(n,this.props.categoryList);s.suggestions.map(function(t){e.push(t.Name)}),t=!s.hasExactMatch}else e=new(Array.bind.apply(Array,a.__spread([void 0],l))),this.props.categoriesToCheck.forEach(function(t){var o=e.indexOf(t);-1!=o&&e.splice(o,1),e.unshift(t)});var u=this.props.shouldShowClearCategories?7:8;e.splice(u),o=e.length<l.length}var d=[];this.props.shouldShowSearchBox&&this.addSearchBox(d);var p=this.addCategories(d,e,c,n,this.props.categoryList);return d.length>1&&this.addDividerMenu(d,"categoryMenu_extendedMenu_divider"),(t=t&&!this.props.createNewCategoryDisabled)?(this.addCreateNewMenu(d,p),this.addDividerMenu(d,"categoryMenu_createNewCategory_divider")):(this.addNewCategoryMenu(d),this.addDividerMenu(d,"categoryMenu_newCategory_divider")),o&&this.addViewAllMenu(d),this.props.shouldShowClearCategories&&this.addClearCategoryMenu(d),this.props.shouldShowManageCategories&&this.addManageCategoryMenu(d),d},t.prototype.getAllCategoryNames=function(){for(var e=this.props.categoryList,t=[],o=e.length-1;o>=0;o--)t.push(e[o].Name);return t},t.prototype.addSearchBox=function(e){e.push(this.onSearchBoxRender())},t.prototype.addCategories=function(e,t,o,r,a){for(var i=this,l=!1,c=function(c){var u=t[c],d=s.props.categoriesToCheck.indexOf(u)>-1,p=void 0;0==c&&s.shouldHighlightTopItem()?(p=Ue(He.highlightItem,He.categoryMenuItemContainer),s.onSearchBoxEnterCallback=function(){i.onCategoryClicked(u,d,o)},l=!0):p=He.categoryMenuItemContainer;var g="",h=u;r&&0==u.toLocaleLowerCase().indexOf(r.toLocaleLowerCase())&&(g=u.substr(0,r.length),h=u.substr(r.length,u.length-1)),e.push(n.createElement("div",{key:"categoryMenu_"+u,role:"menuitemcheckbox","aria-checked":d,"data-is-focusable":!0,className:p,onClick:function(e){return i.onCategoryClicked(u,d,o)},title:u},n.createElement("div",{onClick:s.onCategoryIconClicked},n.createElement(m.a,{categoryName:u,iconClassName:He.categoryIconInMenu,categoryList:a})),n.createElement("div",{className:He.categoryName},n.createElement("span",{className:He.categoryMatchSuggestion},g),n.createElement("span",{className:He.categorySuggestion},h)),d&&n.createElement(We.a,{iconName:"CheckMark",className:He.checkMarkIcon})))},s=this,u=0;u<t.length;u++)c(u);return l},t.prototype.addNewCategoryMenu=function(e){if(y.a.categoryMenuViewState.newCategoryViewState)e.push(n.createElement(Me,{key:"newCategory_Edit",actionSource:"CommandBarNewCategory",isEditMode:!0,createNew:this.createNewAndClickCategory}));else{var t=Ue(He.extendedMenuItems,this.props.createNewCategoryDisabled&&He.disabled),o=this.props.createNewCategoryDisabled?void 0:this.onNewCategoryClicked;e.push(n.createElement("div",{key:"newCategory",className:He.categoryMenuItemContainer,"data-is-focusable":!0,role:"menuitem",onClick:o},n.createElement("div",{title:ue.a.categoryMenuNewCategoryTooltipText,className:t},ue.a.categoryMenuNewCategoryText)))}},t.prototype.addManageCategoryMenu=function(e){var t=Ue(He.extendedMenuItems,this.props.manageCategoriesDisabled&&He.disabled),o=this.props.manageCategoriesDisabled?void 0:this.onManageCategoryClicked;e.push(n.createElement("div",{key:"categoriesEdit",className:He.categoryMenuItemContainer,"data-is-focusable":!0,role:"menuitem",onClick:o},n.createElement("div",{title:ue.a.categoryMenuManageCategoriesTooltipText,className:t},ue.a.categoryMenuManageCategoriesText)))},t=a.__decorate([u.observer],t)}(n.Component);o.d(t,"logMasterCategoryListData",function(){return r.a}),o.d(t,"CategoryWell",function(){return C}),o.d(t,"Category",function(){return h}),o.d(t,"CategoryMenu",function(){return Ke}),o.d(t,"CategoryColorPickerHost",function(){return ge}),o.d(t,"addMasterCategories",function(){return Ie}),o.d(t,"removeMasterCategories",function(){return Pe}),o.d(t,"changeMasterCategories",function(){return Oe})},934:function(e,t,o){"use strict";o.d(t,"a",function(){return i});var r=o(41),a=o(1839),n=o(212),i=Object(a.b)(function(e,t){var o,a=Object(n.a)(e),i={root:{padding:"0 4px",height:"40px",color:e.palette.neutralPrimary,backgroundColor:"transparent",border:"none"},rootHovered:{color:e.palette.themePrimary,selectors:(o={},o[r.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},o)},iconHovered:{color:e.palette.themePrimary},rootPressed:{color:e.palette.black},rootExpanded:{color:e.palette.themePrimary},iconPressed:{color:e.palette.themeDarker},rootDisabled:{color:e.palette.neutralTertiary,backgroundColor:"transparent"},rootChecked:{color:e.palette.black},iconChecked:{color:e.palette.themeDarker},flexContainer:{justifyContent:"flex-start"},icon:{color:e.palette.themeDarkAlt},iconDisabled:{color:"inherit"},menuIcon:{color:e.palette.neutralSecondary},textContainer:{flexGrow:0}};return Object(r.concatStyleSets)(a,i,t)})},96:function(e,t,o){"use strict";o.r(t),o.d(t,"ActionButton",function(){return s});var r=o(0),a=o(1),n=o(95),i=o(1825),l=o(1634),c=o(934),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._skipComponentRefResolution=!0,t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,o=e.theme;return a.createElement(n.a,r.__assign({},this.props,{variantClassName:"ms-Button--action ms-Button--command",styles:Object(c.a)(o,t),onRenderDescription:i.b}))},t=r.__decorate([Object(l.b)("ActionButton",["theme","styles"],!0)],t)}(i.a)}},0,[218]]);
//# sourceMappingURL=owa.vendors~Categories.js.map
window.scriptsLoaded['owa.vendors~Categories.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.vendors~Categories.js'] = (new Date()).getTime();