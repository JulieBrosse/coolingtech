window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.BulkActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[59],{1893:function(e,t,o){"use strict";var r=o(1842),n=o(2417),a=o(41),i=o(1887),s={root:"ms-ProgressIndicator",itemName:"ms-ProgressIndicator-itemName",itemDescription:"ms-ProgressIndicator-itemDescription",itemProgress:"ms-ProgressIndicator-itemProgress",progressTrack:"ms-ProgressIndicator-progressTrack",progressBar:"ms-ProgressIndicator-progressBar"},l=Object(a.keyframes)({"0%":{left:"-30%"},"100%":{left:"100%"}}),c=Object(a.keyframes)({"100%":{right:"-30%"},"0%":{right:"100%"}});o.d(t,"a",function(){return u});var u=Object(r.a)(n.a,function(e){var t,o,r=Object(i.a)(),n=e.className,u=e.indeterminate,d=e.theme,m=e.barHeight,p=void 0===m?2:m,f=d.palette,h=d.semanticColors,g=Object(a.getGlobalClassNames)(s,d);return{root:[g.root,{fontWeight:a.FontWeights.regular},n],itemName:[g.itemName,a.noWrap,{color:h.bodyText,fontSize:a.FontSizes.medium,paddingTop:4,lineHeight:20}],itemDescription:[g.itemDescription,{color:h.bodySubtext,fontSize:a.FontSizes.xSmall,lineHeight:18}],itemProgress:[g.itemProgress,{position:"relative",overflow:"hidden",height:p,padding:"8px 0"}],progressTrack:[g.progressTrack,{position:"absolute",width:"100%",height:p,backgroundColor:f.neutralLight,selectors:(t={},t[a.HighContrastSelector]={borderBottom:"1px solid WindowText"},t)}],progressBar:[{backgroundColor:f.themePrimary,height:p,position:"absolute",transition:"width .3s ease",width:0,selectors:(o={},o[a.HighContrastSelector]={backgroundColor:"WindowText"},o)},u?{position:"absolute",minWidth:"33%",background:"linear-gradient(to right, transparent 0%, "+f.themePrimary+" 50%, transparent 100%)",animation:(r?c:l)+" 3s infinite"}:{transition:"width .15s linear"},g.progressBar]}},void 0,{scope:"ProgressIndicator"})},2417:function(e,t,o){"use strict";o.d(t,"a",function(){return c});var r=o(0),n=o(1),a=o(1843),i=o(1825),s=Object(a.a)(),l=.01,c=function(e){function t(t){var o=e.call(this,t)||this;return o._onRenderProgress=function(e){var t=o.props,r=t.ariaValueText,a=t.barHeight,i=t.className,c=t.styles,u=t.theme,d="number"==typeof o.props.percentComplete?Math.min(100,Math.max(0,100*o.props.percentComplete)):void 0,m=s(c,{theme:u,className:i,barHeight:a,indeterminate:void 0===d}),p={width:void 0!==d?d+"%":void 0,transition:void 0!==d&&d<l?"none":void 0},f=void 0!==d?0:void 0,h=void 0!==d?100:void 0,g=void 0!==d?Math.floor(d):void 0;return n.createElement("div",{className:m.itemProgress},n.createElement("div",{className:m.progressTrack}),n.createElement("div",{className:m.progressBar,style:p,role:"progressbar","aria-valuemin":f,"aria-valuemax":h,"aria-valuenow":g,"aria-valuetext":r}))},o._warnDeprecations({title:"label"}),o}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.barHeight,o=e.className,a=e.label,i=void 0===a?this.props.title:a,l=e.description,c=e.styles,u=e.theme,d=e.progressHidden,m=e.onRenderProgress,p=void 0===m?this._onRenderProgress:m,f="number"==typeof this.props.percentComplete?Math.min(100,Math.max(0,100*this.props.percentComplete)):void 0,h=s(c,{theme:u,className:o,barHeight:t,indeterminate:void 0===f});return n.createElement("div",{className:h.root},i?n.createElement("div",{className:h.itemName},i):null,d?null:p(r.__assign({},this.props,{percentComplete:f}),this._onRenderProgress),l?n.createElement("div",{className:h.itemDescription},l):null)},t.defaultProps={label:"",description:"",width:180},t}(i.a)},3014:function(e,t,o){"use strict";var r=o(4);t.a=Object(r.action)("clearTableViewLastEmptiedTime")(function(e){e.lastEmptiedTime=null})},4419:function(e,t,o){var r=o(4420),n=o(33);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)n.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},4420:function(e,t,o){(t=e.exports=o(35)(!1)).push([e.i,'.q7ZI1zT7ScZhGSsNPz8Wd{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap}html[dir] .q7ZI1zT7ScZhGSsNPz8Wd{background-color:"[theme:white, default:#ffffff]"}._2_AMWk25GMxjIOA1ZRAnFk{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}._15VmHkCqvqgfEeqZSAsjrd{justify-self:flex-end;width:100%}._1umihe4TeRioXUiHYZAzzT{font-size:14px;font-weight:400;color:"[theme:neutralPrimary, default:#333333]";-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}html[dir] ._1umihe4TeRioXUiHYZAzzT{padding-bottom:2px}html[dir=ltr] ._1umihe4TeRioXUiHYZAzzT{margin-right:16px}html[dir=rtl] ._1umihe4TeRioXUiHYZAzzT{margin-left:16px}._2lkceI3Z4LtI-njD8hagEd{font-weight:600;color:"[theme:themePrimary, default:#0078D7]";cursor:pointer;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}html[dir] ._2lkceI3Z4LtI-njD8hagEd{padding-bottom:2px}html[dir=ltr] ._2lkceI3Z4LtI-njD8hagEd{margin-right:-5px}html[dir=rtl] ._2lkceI3Z4LtI-njD8hagEd{margin-left:-5px}html[dir=ltr] .QksyY5InUN-nnb1OTObd5{margin-right:4px}html[dir=rtl] .QksyY5InUN-nnb1OTObd5{margin-left:4px}._1AcIXGihFBvT1INxj0HOfK,._1AqymQg5Ocm0aTa4uaSzJT,._3HQ7PFXhY4wh6yizkRfMtG{width:16px;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}html[dir=ltr] ._1AcIXGihFBvT1INxj0HOfK,html[dir=ltr] ._1AqymQg5Ocm0aTa4uaSzJT,html[dir=ltr] ._3HQ7PFXhY4wh6yizkRfMtG{margin-right:17px}html[dir=rtl] ._1AcIXGihFBvT1INxj0HOfK,html[dir=rtl] ._1AqymQg5Ocm0aTa4uaSzJT,html[dir=rtl] ._3HQ7PFXhY4wh6yizkRfMtG{margin-left:17px}._1AqymQg5Ocm0aTa4uaSzJT{color:#107c10}._1AcIXGihFBvT1INxj0HOfK{color:#e81123}html[dir=ltr] ._2nkmcjptMrYJMGlPFRmVaN{margin-left:7px}html[dir=rtl] ._2nkmcjptMrYJMGlPFRmVaN{margin-right:7px}html[dir=ltr] .-tQswb5iApzcKHjMmagrH{margin-left:27px}html[dir=rtl] .-tQswb5iApzcKHjMmagrH{margin-right:27px}',""]),t.locals={bulkActionNotificationBarContainer:"q7ZI1zT7ScZhGSsNPz8Wd",progressDetailsContainer:"_2_AMWk25GMxjIOA1ZRAnFk",progressIndicator:"_15VmHkCqvqgfEeqZSAsjrd",contentText:"_1umihe4TeRioXUiHYZAzzT",cancelButton:"_2lkceI3Z4LtI-njD8hagEd",menuButton:"QksyY5InUN-nnb1OTObd5",statusIcon:"_3HQ7PFXhY4wh6yizkRfMtG",success:"_1AqymQg5Ocm0aTa4uaSzJT",failure:"_1AcIXGihFBvT1INxj0HOfK",iconReadingPane:"_2nkmcjptMrYJMGlPFRmVaN",iconNoReadingPane:"-tQswb5iApzcKHjMmagrH"}},5641:function(e,t,o){"use strict";o.r(t);var r=o(109),n=o(778),a=o.n(n),i=o(777),s=o.n(i),l=o(71),c=o.n(l),u=o(177),d=o.n(u),m=o(29),p=o.n(m),f=o(312),h=o.n(f),g=o(30);function b(e,t){return s()({ParentFolderIds:[c()({Id:e})],ItemShape:d()({BaseShape:"IdOnly"}),ShapeName:"BulkActionItem",Traversal:"Shallow",Paging:t,FocusedViewFilter:-1,ViewFilter:"All",SortOrder:[h()({Order:"Descending",Path:p()({FieldURI:"ItemLastModifiedTime"})})]})}var k=o(6),v=o(257),A=o.n(v),x=o(0),I=o(51),T=o(445),w=o(97),y=o(3),C=Object(y.mutatorAction)("setBulkActionInformation",function(e,t){w.a.bulkActionInformationMap.set(e,t)}),B=o(292);var _=o(7);function N(e,t){void 0===e&&(e=0),void 0===t&&(t=10);var o=Object(k.a)().SessionSettings,r=o.DefaultFolderNames.indexOf("bulkactions"),n=o.DefaultFolderIds[r];if(n){var i,s,l,c,u=A()({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:t});(i=u,s=n.Id,l=b(s,i),c=Object(g.getJsonRequestHeader)(),c.RequestServerVersion="V2018_01_18",a()({Header:c,Body:l})).then(function(e){var t=e.Body.ResponseMessages.Items[0];t&&"Success"==t.ResponseClass&&t.RootFolder.Items&&function(e){var t,o;try{for(var r=x.__values(e),n=r.next();!n.done;n=r.next()){var a=n.value;if(a.BulkActionState==B.a.Running){var i=a.BulkActionTargetFolderId.Id,s=a.BulkActionProcessedCount/Math.max(1,a.BulkActionTotalCount),l={id:a.ItemId.Id,targetFolderName:Object(I.a)(i),sendTime:a.BulkActionSendTime,startTime:a.BulkActionStartTime,customData:a.BulkActionCustomData,class:a.BulkActionClass,state:a.BulkActionState,progress:{processedCount:a.BulkActionProcessedCount,percentComplete:s,totalCount:a.BulkActionTotalCount}};Object(T.a)(l,i)||C(i,l)}}}catch(e){t={error:e}}finally{try{n&&!n.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}}(t.RootFolder.Items)}).catch(function(e){_.c.warn("Unable to update BulkActionStore via findBulkActionItemAction.")})}}var S,j=o(449);var O=((S={})[0]=B.a.Uninitialized,S[5]=B.a.Timeout,S[1]=B.a.Running,S[2]=B.a.Cancelled,S[3]=B.a.Complete,S[4]=B.a.Failed,S);function R(e){var t,o,r=e.BulkActionTargetFolderId,n=(t=r,(o=Object(w.b)().bulkActionInformationMap.get(t))?o.progress:null),a=n?n.processedCount:0,i=a<e.BulkActionProcessedCount?e.BulkActionProcessedCount:a,s={class:e.BulkActionClass,customData:e.BulkActionCustomData,id:e.BulkActionId,targetFolderName:Object(I.a)(r),sendTime:e.BulkActionSendTime,startTime:e.BulkActionStartTime,state:O[e.BulkActionState],progress:{percentComplete:i/e.BulkActionTotalCount,processedCount:i,totalCount:e.BulkActionTotalCount}};Object(T.a)(s,r)||(C(r,s),Object(j.a)("TnS_BulkActionDatapoint",s))}var P=o(477),F=o(279);function D(e){switch(e.EventType){case"RowAdded":case"RowModified":R(e);break;case"RowDeleted":Object(P.a)(e.BulkActionTargetFolderId,r.b.Complete);break;case"Reload":N();break;default:_.c.error("BulkActionNotification should only be fired on (RowAdded, RowModified, RowDeleted, Reload)")}}function H(){F.f.importAndExecute({subscriptionId:"BulkActionNotification",requiresExplicitSubscribe:!0,subscriptionParameters:{NotificationType:"BulkActionNotification"}},D)}function z(e,t,o,n){var a={id:"",targetFolderName:Object(I.a)(e),startTime:"",sendTime:"",class:t,customData:o?JSON.stringify(o):"",state:r.b.Uninitialized,progress:{percentComplete:0,processedCount:0,totalCount:n}};C(e,a)}o.d(t,"subscribeToBulkActionNotification",function(){return H}),o.d(t,"onBulkActionSubmitted",function(){return z}),o.d(t,"findBulkActionItemAction",function(){return N})},5683:function(e,t,o){"use strict";o.r(t);var r=o(0),n=o(1),a=o(3014),i=o(292),s=o(18),l=o(11),c=o.n(l),u=o(12);var d=o(6),m=o(74),p=o(452),f=o(96),h=o(1826),g=o(524),b=o(5),k=o(14),v=o(1893),A=o(7),x=o(4419),I=o(90),T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickDismiss=function(){Object(i.h)(t.folderId)},t.onClickStop=function(e){var o=b.F.tableViews.get(b.F.selectedTableViewId);Object(a.a)(o),Object(i.g)(t.folderId).then(function(t){t&&"EmptyFolder"==e&&Object(p.a)(o)})},t}return r.__extends(t,e),t.prototype.componentWillUnmount=function(){var e=i.j.bulkActionInformationMap.get(this.folderId);!e||e.state!==i.a.Complete&&e.state!==i.a.Cancelled||Object(i.h)(this.folderId)},t.prototype.render=function(){var e=this,t=b.F.tableViews.get(b.F.selectedTableViewId);this.folderId=t.tableQuery.folderId;var o=i.j.bulkActionInformationMap.get(this.folderId),r=this.getCustomData(o),a=r?r.Scenario:o.class,l=function(e,t,o){switch(e.state){case i.a.Complete:switch(t){case"EmptyFolder":return c.a.bulkAction_emptyFolderSuccess;case"Sweep":var r=o,n=u.n.folderTable.get(r.destinationFolderId);return Object(s.format)(c.a.bulkAction_moveFromToSuccess,r.senderSMTPs.join(", "),n.DisplayName);case"RunRuleNow":var a=o;return Object(s.format)(c.a.bulkAction_runRuleSuccess,a.ruleName)}break;case i.a.Failed:case i.a.Timeout:var l=e.progress.totalCount-e.progress.processedCount;switch(t){case"EmptyFolder":return Object(s.format)(c.a.emptyFolderFailStatus,l);case"Sweep":return Object(s.format)(c.a.bulkAction_moveFromToFail,l);case"RunRuleNow":return Object(s.format)(c.a.bulkAction_runRuleNowFail,l)}break;case i.a.Cancelled:return c.a.bulkAction_canceled;case i.a.Cancelling:return c.a.bulkAction_canceling;case i.a.Uninitialized:case i.a.Running:var d=Object(s.format)(c.a.bulkAction_NofM,e.progress.processedCount,e.progress.totalCount);switch(t){case"EmptyFolder":return c.a.bulkAction_emptyingFolder+" "+d;case"Sweep":return r=o,n=u.n.folderTable.get(r.destinationFolderId),Object(s.format)(c.a.bulkAction_movingFromTo,r.senderSMTPs.join(", "),n.DisplayName);case"RunRuleNow":return a=o,Object(s.format)(c.a.bulkAction_runningRule,a.ruleName);default:throw new Error("Invalid bulk action scenario type")}}return c.a.bulkAction_genericStatus}(o,a,r),d=o.state===i.a.Running,m="RunRuleNow"==a||"Sweep"==a;return n.createElement("div",{className:x.bulkActionNotificationBarContainer},n.createElement("div",{className:x.progressDetailsContainer},this.getBulkActionStatusIcon(o,a),n.createElement("span",{className:x.contentText,title:l},l),d?n.createElement(f.ActionButton,{className:x.cancelButton,text:c.a.bulkAction_cancel,onClick:function(t){return e.onClickStop(a)}}):n.createElement(g.IconButton,{className:x.menuButton,onClick:function(t){return e.onClickDismiss()},iconProps:{iconName:"Cancel"}})),d&&!m&&n.createElement(v.a,{className:x.progressIndicator,percentComplete:o.progress.percentComplete}))},t.prototype.getCustomData=function(e){var t;try{t=e.customData&&JSON.parse(e.customData)}catch(e){A.c.warn("Invalid BulkAction custom data"+e),t=null}finally{return t}},t.prototype.getBulkActionStatusIcon=function(e,t){var o=Object(d.a)().UserOptions.GlobalReadingPanePositionReact==m.a.Right?x.iconReadingPane:x.iconNoReadingPane,r=null,a=x.statusIcon;switch(e.state){case i.a.Complete:r="CheckMark",a=x.success;break;case i.a.Failed:r="Error",a=x.failure;break;case i.a.Cancelled:r="Error";break;case i.a.Cancelling:default:r=this.getBulkActionSpecificIcon(t)}return n.createElement(h.a,{className:I(a,o),iconName:r})},t.prototype.getBulkActionSpecificIcon=function(e){switch(e){case"EmptyFolder":return"Delete";case"Sweep":return"Broom";case"RunRuleNow":return"Play";default:return"Help"}},t=r.__decorate([k.observer],t)}(n.Component);o.d(t,"BulkActionProgressBar",function(){return T})},934:function(e,t,o){"use strict";o.d(t,"a",function(){return i});var r=o(41),n=o(1839),a=o(212),i=Object(n.b)(function(e,t){var o,n=Object(a.a)(e),i={root:{padding:"0 4px",height:"40px",color:e.palette.neutralPrimary,backgroundColor:"transparent",border:"none"},rootHovered:{color:e.palette.themePrimary,selectors:(o={},o[r.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},o)},iconHovered:{color:e.palette.themePrimary},rootPressed:{color:e.palette.black},rootExpanded:{color:e.palette.themePrimary},iconPressed:{color:e.palette.themeDarker},rootDisabled:{color:e.palette.neutralTertiary,backgroundColor:"transparent"},rootChecked:{color:e.palette.black},iconChecked:{color:e.palette.themeDarker},flexContainer:{justifyContent:"flex-start"},icon:{color:e.palette.themeDarkAlt},iconDisabled:{color:"inherit"},menuIcon:{color:e.palette.neutralSecondary},textContainer:{flexGrow:0}};return Object(r.concatStyleSets)(n,i,t)})},96:function(e,t,o){"use strict";o.r(t),o.d(t,"ActionButton",function(){return c});var r=o(0),n=o(1),a=o(95),i=o(1825),s=o(1634),l=o(934),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._skipComponentRefResolution=!0,t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,o=e.theme;return n.createElement(a.a,r.__assign({},this.props,{variantClassName:"ms-Button--action ms-Button--command",styles:Object(l.a)(o,t),onRenderDescription:i.b}))},t=r.__decorate([Object(s.b)("ActionButton",["theme","styles"],!0)],t)}(i.a)}},0,[6,7,25,34,57,223,56,218,225,232]]);
//# sourceMappingURL=owa.BulkActions.js.map
window.scriptsLoaded['owa.BulkActions.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.BulkActions.js'] = (new Date()).getTime();