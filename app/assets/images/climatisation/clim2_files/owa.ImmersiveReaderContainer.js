window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.ImmersiveReaderContainer.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[133],{1404:function(e,r,t){"use strict";var i=t(3);r.a=Object(i.action)("SHOW_IN_IMMERSIVE_READER",function(e){return{itemId:e}})},1690:function(e,r,t){"use strict";var i=t(0),a=t(3),n=t(1404),s=function(e){return new Promise(function(r){return setTimeout(function(){r()},e)})},o=t(1691),d=t.n(o);var m,c,l=t(9),u=t(141),v=t(152),R=t.n(v),p=t(11),f=t.n(p),g=(Object(a.orchestrator)(n.a,function(e){return i.__awaiter(void 0,void 0,void 0,function(){var r,t,a,n,o,m,c,v,p,b,S,_,w;return i.__generator(this,function(i){switch(i.label){case 0:if(r=e.itemId,t=C(),!r||t.isLoading||0!==t.immersiveReaderFrameState)return[2];(a=new l.c("ShowInImmersiveReader")).addCustomData({sessionId:t.sessionId}),g(!0),h(!0),n=(new Date).getUTCMilliseconds(),o=!0,m=null,c=null,i.label=1;case 1:return i.trys.push([1,7,8,9]),[4,(F=R()({Id:r.Id}),y=t.sessionId,M="1.1",E=r.mailboxInfo&&r.mailboxInfo.requestOptions,d()({itemId:F,sessionId:y,version:M},E))];case 2:if(v=i.sent(),a.addCheckmark("ImmersiveReaderProcessText_Done"),v&&v.ReaderModelJson?m=JSON.parse(v.ReaderModelJson):(o=!1,c="Response from service call was null or did not contain a ReaderModelJson"),!o)return[3,6];p=(new Date).getUTCMilliseconds(),b={messageType:"ReaderModel2",messageValue:{launchToPostMessageSentDurationInMs:(p-n).toString(),readerModel:m}},I(b),S=120,_=0,i.label=3;case 3:return _<S&&1===C().immersiveReaderFrameState?[4,s(500)]:[3,5];case 4:return i.sent(),_++,[3,3];case 5:1===C().immersiveReaderFrameState&&(o=!1,c="Frame never got to Ready state"),i.label=6;case 6:return[3,9];case 7:return w=i.sent(),o=!1,a.addCheckmark("CaughtException"),c=w.toString(),[3,9];case 8:return g(!1),[7];case 9:return o?a.end():(h(!1),a.endWithError(l.a.ServerError,new Error(c)),Object(u.b)(f.a.immersiveReaderErrorTitle,f.a.immersiveReaderErrorText,!1,{hideCancelButton:!0})),[2]}var F,y,M,E})})}),Object(a.mutatorAction)("toggleImmersiveReaderLoadingState",function(e){C().isLoading=e})),h=Object(a.mutatorAction)("toggleImmersiveReaderShowingState",function(e){C().immersiveReaderFrameState=e?1:0}),I=Object(a.mutatorAction)("setImmersiveReaderApiResponse",function(e){C().apiResponse=e}),b=t(104),S={sessionId:Object(b.getGuid)(),isLoading:!1,immersiveReaderFrameState:0,apiResponse:null},C=Object(a.createStore)("immersivereader",S),_=C(),w=Object(a.mutatorAction)("setImmersiveReaderFrameReady",function(){C().immersiveReaderFrameState=2}),F=Object(a.mutatorAction)("closeImmersiveReader",function(){var e=C();e.immersiveReaderFrameState=0,e.apiResponse=null});(c=m||(m={}))[c.Closed=0]="Closed",c[c.Showing=1]="Showing",c[c.Ready=2]="Ready";t.d(r,"e",function(){return _}),t.d(r,"b",function(){return C}),t.d(r,"c",function(){return w}),t.d(r,"a",function(){return F}),t.d(r,"d",function(){return n.a})},1691:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t(38),a=t(152);r.default=function(e,r){return void 0===e.itemId||e.itemId.__type||(e.itemId=a.default(e.itemId)),i.makeServiceRequest("ImmersiveReaderProcessText",e,r)}},1941:function(e,r,t){"use strict";t.r(r);var i=t(0),a=t(20),n=t(14),s=t(1),o=t(9),d=t(11),m=t.n(d),c=t(16),l=t(6),u=t(1690),v=t(4599),R="https://learningtools.edog.onenote.com/learningtoolsapp/reader",p="https://learningtools.onenote.com/learningtoolsapp/reader",f=function(e){function r(r){var t=e.call(this,r)||this;return t.onReceivePostMessage=function(e){e&&0!==u.e.immersiveReaderFrameState&&0===t.immersiveReaderUrl.toLowerCase().indexOf(e.origin.toLowerCase())&&("ImmersiveReader-ReadyForContent"===e.data?(t.dp&&t.dp.addCheckmark("ReceivedReadyForContent"),Object(u.c)(),t.immersiveReaderFrame.focus()):"CloseImmersiveReader"===e.data&&(t.dp&&t.dp.addCheckmark("ReceivedCloseReader"),t.receivedCloseCallback=!0,Object(u.a)()))},t.getImmersiveReaderUrl=function(){var e=p;Object(c.b)("rp-immersiveReaderDogfood")&&(e=R);var r=Object(l.a)().SessionSettings.UserCulture;return e+"?exitCallback=CloseImmersiveReader&appId=OWA&sessionId="+u.e.sessionId+"&ui="+r+"&appSubId=React"},t.immersiveReaderUrl=t.getImmersiveReaderUrl(),t}return i.__extends(r,e),r.prototype.componentDidMount=function(){var e=this;window.addEventListener("message",this.onReceivePostMessage,!1),this.autorunDisposer=Object(a.autorun)(function(){u.e.apiResponse&&2===u.e.immersiveReaderFrameState&&e.immersiveReaderFrame&&(e.dp&&e.dp.addCheckmark("SendingPostMessageToFrame"),e.immersiveReaderFrame.contentWindow.postMessage(JSON.stringify(u.e.apiResponse),"*"))})},r.prototype.componentWillUnmount=function(){window.removeEventListener("message",this.onReceivePostMessage,!1),this.autorunDisposer()},r.prototype.render=function(){var e=this;return 0===u.e.immersiveReaderFrameState||this.dp?0===u.e.immersiveReaderFrameState&&this.dp&&(this.receivedCloseCallback?this.dp.end():this.dp.endWithError(o.a.ServerError,new Error("Did not receive close callback")),this.dp=null):(this.dp=new o.c("ImmersiveReaderContainer"),this.dp.addCustomData({sessionId:u.e.sessionId}),this.receivedCloseCallback=!1),0!==u.e.immersiveReaderFrameState?s.createElement("div",{className:v.immersiveReaderContainer},s.createElement("iframe",{id:"immersive-reader-iframe",className:v.immersiveReaderIframe,title:m.a.immersiveReaderIframeTitle,allowFullScreen:!0,src:this.immersiveReaderUrl,ref:function(r){e.dp&&e.dp.addCheckmark("GotFrameRef"),e.immersiveReaderFrame=r}})):null},r=i.__decorate([n.observer],r)}(s.Component);t.d(r,"ImmersiveReaderContainer",function(){return f})},4599:function(e,r,t){var i=t(4600),a=t(33);"string"==typeof i&&(i=[[e.i,i]]);for(var n=0;n<i.length;n++)a.loadStyles(i[n][1],!1);i.locals&&(e.exports=i.locals)},4600:function(e,r,t){(r=e.exports=t(35)(!1)).push([e.i,"._1fgMDSRYKv_YFobNf4_0M8{top:0;bottom:0;position:absolute;z-index:3001}html[dir=ltr] ._1fgMDSRYKv_YFobNf4_0M8,html[dir=rtl] ._1fgMDSRYKv_YFobNf4_0M8{left:0;right:0}._3RaydzKAEtJy0pINPtcLuT{position:fixed;top:0;bottom:0;width:100%;height:100%}html[dir] ._3RaydzKAEtJy0pINPtcLuT{border:0;margin:0;padding:0}html[dir=ltr] ._3RaydzKAEtJy0pINPtcLuT,html[dir=rtl] ._3RaydzKAEtJy0pINPtcLuT{left:0;right:0}",""]),r.locals={immersiveReaderContainer:"_1fgMDSRYKv_YFobNf4_0M8",immersiveReaderIframe:"_3RaydzKAEtJy0pINPtcLuT"}}},0,[218,225]]);
//# sourceMappingURL=owa.ImmersiveReaderContainer.js.map
window.scriptsLoaded['owa.ImmersiveReaderContainer.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.ImmersiveReaderContainer.js'] = (new Date()).getTime();