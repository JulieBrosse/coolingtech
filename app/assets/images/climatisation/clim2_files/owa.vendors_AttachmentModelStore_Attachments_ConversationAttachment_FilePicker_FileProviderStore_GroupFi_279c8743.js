window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.vendors~AttachmentModelStore~Attachments~ConversationAttachment~FilePicker~FileProviderStore~GroupFi~279c8743.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[7],{2095:function(e,t,r){"use strict";var n=r(0),o={GetAccessToken:{datapoint:{name:"getAccessToken",customData:function(e){return{actionSource:e}}}}},s=r(3783),i=r.n(s),a=r(3354),u=r.n(a);var c=r(2190),d=r(9),l=r(203),f=function(e,t,r){return n.__assign({resultCode:t,isAdalException:r,_typeSpec:"TokenRetrievalError"},e)},v=function(e){return"TokenRetrievalError"===e._typeSpec},p={},h=1,_=30,m="",w="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function k(e){p[e]=null}function g(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var s,a,l,v;return n.__generator(this,function(h){switch(h.label){case 0:s=o.GetAccessToken.datapoint,(a=new d.c(s.name)).addCustomData(s.customData(r)),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var o,s,a;return n.__generator(this,function(n){switch(n.label){case 0:return o=u()({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1}),s={headers:{"X-OWA-ActionName":r?"getAccessTokenForDataProvider_"+r:"getAccessTokenForDataProvider"},returnFullResponseOnSuccess:!0},[4,i()(o,s)];case 1:return[4,(a=n.sent()).json()];case 2:return[2,{token:n.sent(),response:a}]}})})}(e,t,r)];case 2:return l=h.sent(),a.addCheckmark("receivedResponse"),a.addCustomData({tokenStatus:l.token.TokenResultCode.toString()}),0!==l.token.TokenResultCode&&(Object(c.c)(a,l.response),_=l.response.headers,a.addCustomData({tokenResultDetails:_.get("x-tokenresult")}),a.endWithError(d.a.ServerError)),function(e,t,r){var n=r.token;if(0!==n.TokenResultCode||!n.AccessToken||""===n.AccessToken){var o="Access token request failed for token key "+e+" with response code "+n.TokenResultCode,s=r.response.headers.get("x-tokenresult"),i=null!=s&&s.indexOf(w)>0;throw f(new Error(o),n.TokenResultCode,i)}var a=p[e]||{};a[t]=n,p[e]=a}(e,t,l),a.end(),[2,l.token];case 3:throw v=h.sent(),Object(c.a)(v)&&Object(c.c)(a,v.response),Object(c.d)(a,v.toString()),a.endWithError(d.a.ServerError),v;case 4:return[2]}var _})})}function b(e,t){return void 0===t&&(t=!1),n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(r){return[2,y(e,m,t)]})})}function R(e,t,r){return void 0===t&&(t=!1),n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,y(0,e,t,r)]})})}function y(e,t,r,o){return void 0===r&&(r=!1),n.__awaiter(this,void 0,void 0,function(){var s,i;return n.__generator(this,function(n){switch(n.label){case 0:return r||!function(e,t){var r=p[e];if(!r)return!1;var n=r[t];if(!n||!n.AccessTokenExpiry)return!1;var o=new Date(n.AccessTokenExpiry),s=l(new Date(Date.now()),h);return null!=o&&s<o}(e,t)?[3,1]:(s=p[e],i=s[t],l(new Date(Date.now()),_)>new Date(i.AccessTokenExpiry)&&g(e,t,o),[2,i.AccessToken]);case 1:return[4,g(e,t,o)];case 2:return[2,(i=n.sent()).AccessToken]}})})}var T="https://www.googleapis.com/drive/v3/files";function S(e,t,r){return void 0===r&&(r={forceTokenRefresh:!1,requestInit:{}}),n.__awaiter(this,void 0,void 0,function(){var o,s,i;return n.__generator(this,function(a){switch(a.label){case 0:return o=r.forceTokenRefresh,s=r.requestInit||{},[4,function(e,t){return void 0===t&&(t=!1),n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(r){switch(r.label){case 0:return[4,b(e,t)];case 1:return[2,"Bearer "+r.sent()]}})})}(t,o)];case 1:return i=a.sent(),s.headers||(s.headers=new Headers),s.headers.set("Authorization",i),[4,fetch(e,s)];case 2:return[2,a.sent()]}})})}function x(e,t){return void 0===t&&(t=!1),n.__awaiter(this,void 0,void 0,function(){var r,o;return n.__generator(this,function(n){switch(n.label){case 0:return[4,S(T+"?"+e,5,{forceTokenRefresh:t})];case 1:return(r=n.sent()).ok?[4,r.text()]:[3,3];case 2:return o=n.sent(),[2,{errorResponse:null,result:JSON.parse(o)}];case 3:return[2,{errorResponse:r,result:null}]}})})}function D(e){return n.__awaiter(this,void 0,void 0,function(){var t,r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,S(T+"/"+e+"?fields=id,mimeType,name,size,modifiedTime,createdTime,thumbnailLink,webViewLink,webContentLink,fileExtension",5)];case 1:return(t=n.sent()).ok?[4,t.text()]:[3,3];case 2:return r=n.sent(),[2,{errorResponse:null,result:JSON.parse(r)}];case 3:return[2,{errorResponse:t,result:null}]}})})}var O="_api/v2.0/drive/items",A=r(82),j=Object.freeze({name:"name",size:"size",lastModifiedBy:"lastModifiedBy",lastModifiedDateTime:"lastModifiedDateTime",file:"file",folder:"folder",id:"id",webDavUrl:"webDavUrl",package:"package"});function C(e,t,r,o,s){return n.__awaiter(this,void 0,void 0,function(){var i,a,u,c,d;return n.__generator(this,function(n){switch(n.label){case 0:return s=s||"root",i=function(e){switch(e){case 0:return j.name;case 1:return j.size;default:return j.lastModifiedDateTime}}(r),a=function(e){switch(e){case 0:return"asc";case 1:return"desc";default:return Object(A.a)(e)}}(o),u="expand=thumbnails(select=medium)&orderby="+i+" "+a+"&select="+Object.values(j).join(","),[4,S(e+"/"+O+"/"+s+"/children?"+u,t,{requestInit:{headers:new Headers({Prefer:"HonorNonIndexedQueriesWarningMayFailRandomly"})}})];case 1:return(c=n.sent()).ok?[4,c.text()]:[3,3];case 2:return d=n.sent(),[2,{errorResponse:null,result:JSON.parse(d).value}];case 3:return[2,{errorResponse:c,result:null}]}})})}function E(e){return"file"===e[".tag"]}function I(e){return"folder"===e[".tag"]}function M(e){return"deleted"===e[".tag"]}function P(e){return"folder"===e.type}var q="https://api.dropboxapi.com/2/files";function F(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,o,s;return n.__generator(this,function(n){switch(n.label){case 0:return e.path=e.path||"",t=q+"/list_folder",r={method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(e)},[4,S(t,2,{requestInit:r})];case 1:return(o=n.sent()).ok?[4,o.text()]:[3,3];case 2:return s=n.sent(),[2,{errorResponse:null,result:JSON.parse(s).entries}];case 3:return[2,{errorResponse:o,result:null}]}})})}var N,B,J="https://api.box.com/2.0",z=2e3;function H(e,t){return void 0===t&&(t=z),n.__awaiter(this,void 0,void 0,function(){var r,o;return n.__generator(this,function(n){switch(n.label){case 0:return[4,S(J+"/folders/"+(e=e||"0")+"/items?fields=id,size,name,type,path_collection,modified_at,modified_by&limit="+t+"&offset=0",3)];case 1:return(r=n.sent()).ok?[4,r.text()]:[3,3];case 2:return o=n.sent(),[2,{errorResponse:null,result:JSON.parse(o).entries}];case 3:return[2,{errorResponse:r,result:null}]}})})}(B=N||(N={})).Uploaded="uploaded",B.Tagged="tagged";var G=N,U="https://graph.facebook.com/v2.7",L=200;function V(e,t){return void 0===t&&(t=L),n.__awaiter(this,void 0,void 0,function(){var r,o;return n.__generator(this,function(n){switch(n.label){case 0:return[4,S(U+"/me/photos/?fields=id,name,images,from,link,album,place,created_time&type="+e.toString()+"&limit="+t,6)];case 1:return(r=n.sent()).ok?[4,r.text()]:[3,3];case 2:return o=n.sent(),[2,{errorResponse:null,result:JSON.parse(o).data}];case 3:return[2,{errorResponse:r,result:null}]}})})}var W=r(778),$=r.n(W),Q=r(777),X=r.n(Q),K=r(71),Y=r.n(K),Z=r(26),ee=r(257),te=r.n(ee),re=r(177),ne=r.n(re),oe=r(30),se=r(7);function ie(e,t){var r,n,o=(r=e,n=t,X()({ParentFolderIds:[Y()({Id:r})],ItemShape:ne()({BaseShape:"IdOnly"}),ShapeName:"MailListItem",Traversal:"Shallow",Paging:n,FocusedViewFilter:-1,ViewFilter:"All",SortOrder:null}));return $()({Header:Object(oe.getJsonRequestHeader)(),Body:o})}function ae(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,o,s;return n.__generator(this,function(n){switch(n.label){case 0:return r=te()({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100}),[4,ie(e=e||Object(Z.a)("inbox"),r)];case 1:return o=n.sent(),(s=o.Body.ResponseMessages.Items[0])&&"Success"===s.ResponseClass&&s.RootFolder.Items?[2,{errorResponse:null,result:s.RootFolder.Items}]:(se.c.warn("Find Item Response of get mail messages failed with "+s),[2,{errorResponse:{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},result:null}])}})})}r.d(t,"g",function(){return b}),r.d(t,"l",function(){return R}),r.d(t,"c",function(){return k}),r.d(t,"q",function(){return v}),r.d(t,"i",function(){return x}),r.d(t,"h",function(){return D}),r.d(t,"k",function(){return C}),r.d(t,"b",function(){return"https://s2s-api.onedrive.com"}),r.d(t,"o",function(){return E}),r.d(t,"p",function(){return I}),r.d(t,"n",function(){return M}),r.d(t,"e",function(){return F}),r.d(t,"m",function(){return P}),r.d(t,"d",function(){return H}),r.d(t,"a",function(){return G}),r.d(t,"f",function(){return V}),r.d(t,"j",function(){return ae})},2190:function(e,t,r){"use strict";function n(e,t){var r,n;t&&e&&(e.addCustomData({httpStatusCode:t.status}),r=e,(n=t.headers)&&r&&r.addCustomData({frontendServer:n.get("x-feserver"),requestId:n.get("request-id"),backendServer:n.get("x-beserver"),backendHttpStatus:n.get("x-backendhttpstatus"),serverVersion:n.get("x-owa-version")}))}function o(e){return e&&void 0!==e.fetchErrorType}function s(e,t){e.addCustomProperty("ErrorInformation",t)}function i(e,t){s(e,t?"Empty response from server":"Null response from server")}r.d(t,"c",function(){return n}),r.d(t,"a",function(){return o}),r.d(t,"d",function(){return s}),r.d(t,"b",function(){return i})},3354:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.default=function(e){return n.__assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}},3783:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(38),o=r(3354);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),n.makeServiceRequest("GetAccessTokenforDataProvider",e,t)}}}]);
//# sourceMappingURL=owa.vendors~AttachmentModelStore~Attachments~ConversationAttachment~FilePicker~FileProviderStore~GroupFi~279c8743.js.map
window.scriptsLoaded['owa.vendors~AttachmentModelStore~Attachments~ConversationAttachment~FilePicker~FileProviderStore~GroupFi~279c8743.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.vendors~AttachmentModelStore~Attachments~ConversationAttachment~FilePicker~FileProviderStore~GroupFi~279c8743.js'] = (new Date()).getTime();