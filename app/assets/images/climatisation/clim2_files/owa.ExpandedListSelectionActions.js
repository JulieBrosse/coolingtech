window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.ExpandedListSelectionActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[89],{1397:function(e,t,n){"use strict";var a=n(0),o=n(1550),i=n(1442),r=n(1571),s=n(111),d=n(1552),c=n(47),u=n(92),l=n(54),f=n(27),m=n(4);var I=Object(m.action)("updateLoadedItemState",i.a.RPPerfRenderItemReadingPane)(function(e,t,n,i,s){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(a){switch(a.label){case 0:return e.itemId!=t.Id?[2]:(e.itemViewState={itemId:t.Id,isContextMenuShown:!1,isConversationItemPart:!1,attachmentWell:null,meetingRequestViewState:null,infoBarIds:Object(r.a)(),loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showToggleBodyButton:!1},undoDarkMode:!1},e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!n,e.instrumentationContext=s,n?Object(d.d)(n)?(e.isUnsupportedItem=!0,[3,3]):[3,1]:[3,3]);case 1:return[4,Object(o.a)(e.itemViewState,!1,{item:n})];case 2:a.sent(),a.label=3;case 3:return[2]}})})});t.a=Object(m.action)("loadItemReadingPane",i.a.RPPerfLoadItem)(function(e,t,n,a,o,i){var r,d,m=Promise.resolve(),v=(d=a,{itemId:e.Id,itemViewState:null,isPrint:d,loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(u.b)(),isUnsupportedItem:!1,isSubjectExpanded:!1,instrumentationContext:null});r=o?Object(s.b)().itemPreviewPaneViewState:Object(s.b)().itemReadingPaneViewState,n(v);var b=Object(f.c)().items.get(e.Id);b&&b.NormalizedBody?I(v,e,b,o,t):m=(i?i(e):Object(l.k)(e,o?"LoadItemPreviewPane":"LoadItemReadingPane")).then(function(n){return I(v,e,n,o,t)}).catch(function(e){return v.loadingState.isLoading=!1,v.loadingState.hasLoadFailed=!0,Promise.reject(e)});return r&&Object(c.l)("ReadingPaneDisplayEnd",[r.instrumentationContext]),Object(c.l)("ReadingPaneDisplayStart",[t]),m})},1442:function(e,t,n){"use strict";function a(e){return Math.min(Math.floor(e/5)+1,5)}n.d(t,"b",function(){return a}),t.a={RPPerfRenderConversationReadingPane:{datapoint:{name:"RPPerfRenderConversationReadingPane"}},RPPerfRenderItemReadingPane:{datapoint:{name:"RPPerfRenderItemReadingPane",customData:function(e,t,n,a){return[a]}}},RPPerfLoadConversation:{datapoint:{name:"RPPerfLoadConversation"}},RPPerfLoadItem:{datapoint:{name:"RPPerfLoadItem"}},RPCountExpCollQuotedText:{datapoint:{name:"RPCountExpCollQuotedText",customData:function(e,t,n){return[n?1:0,!e.isExpanded]}}},RPCountExpCollItemPart:{datapoint:{name:"RPCountExpCollItemPart",customData:function(e){return e.isSelected?["SC"]:e.isExpanded?["ES"]:["CS"]}}},RPCountExpCollSubject:{datapoint:{name:"RPCountExpCollSubject",customData:function(e){return[e&&!e.isSubjectExpanded]}}},markItemJunkDatapoint:{datapoint:{name:"TnS_JunkItem",customData:function(e,t){return[t,e]}}},markItemNotJunkDatapoint:{datapoint:{name:"TnS_NotJunkItem",customData:function(e,t){return[t,null]}}},RPCountLoadMore:{datapoint:{name:"RPCountLoadMore"}},RPCountConversationCacheState:{datapoint:{name:"RPCountConversationCacheState",customData:function(e){return[e]}}},RPCountReParentingEvent:{datapoint:{name:"RPCountReParentingEvent",customData:function(e,t,n,a){return[e,t,n,a]}}},RPCountInfoBar:{datapoint:{name:"RPCountInfoBar",customData:function(e){return[e]}}},deleteMailDatapoint:{datapoint:{name:"TnS_DeleteItem"}},agendaMailFeedbackDatapoint:{datapoint:{name:"AgendaMailFeedback",customData:function(e){return[e]}}},RPCountContinuousCollapsedItems:{datapoint:{name:"RPCountContinuousCollapsedItems",customData:function(e,t){return[e,t]}}},RPCountExpCollItemsRollUp:{datapoint:{name:"RPCountExpCollItemsRollUp",customData:function(e,t,n,o){return[a(n),o]}}},RPCountRenderCollItemsRollUp:{datapoint:{name:"RPCountRenderCollItemsRollUp",customData:function(e){return[e]}}},RPCountExpCollAllItemParts:{datapoint:{name:"RPCountExpCollAllItemParts",customData:function(e,t){return[e,t]}}}}},1546:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(4),o="deleteMeetingMessage";t.b=Object(a.action)(o)(function(e,t){})},1550:function(e,t,n){"use strict";var a=n(0),o=n(1570),i=n(27),r=n(1563),s=n(4);t.a=Object(s.select)({item:function(e){return i.a.items.get(e.itemId)}})(Object(s.action)("initializeExtendedStateForItemViewState")(function(e,t,n){return void 0===t&&(t=!1),a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(a){switch(a.label){case 0:return[4,Object(o.a)(e,n.item,t)];case 1:return a.sent(),r.f.importAndExecute(e,n.item),[2]}})})}))},1551:function(e,t,n){"use strict";function a(e){return e.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}n.d(t,"a",function(){return a})},1552:function(e,t,n){"use strict";n.d(t,"d",function(){return I}),n.d(t,"c",function(){return v}),n.d(t,"a",function(){return b}),n.d(t,"b",function(){return p});var a=n(12),o=n(27),i=n(26),r="IPM.Appointment",s="IPM.Contact",d="IPM.DistList",c="IPM.Task",u="calendar",l="contacts",f="tasks",m="inbox";function I(e){return e&&(g(e.ItemClass)||C(e.ItemClass)||S(e.ItemClass)||O(e.ItemClass))}function v(e){var t=o.a.conversations.get(e),n=o.a.conversationNodes.get(t&&t.conversationNodeIds[0]);if(n){var a=n.itemIds[0];if(I(o.a.items.get(a)))return a}return null}function b(e){var t=o.a.items.get(e);return g(t.ItemClass)?Object(i.a)(u):C(t.ItemClass)||S(t.ItemClass)?Object(i.a)(l):O(t.ItemClass)?Object(i.a)(f):Object(i.a)(m)}function p(e){var t="",n=a.n.folderTable.get(e);return n&&(t=n.DisplayName),t}function g(e){return 0==e.indexOf(r)}function C(e){return 0==e.indexOf(s)}function S(e){return 0==e.indexOf(d)}function O(e){return 0==e.indexOf(c)}},1563:function(e,t,n){"use strict";n.d(t,"f",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return u});var a=n(2),o=n(1546);n.d(t,"a",function(){return o.a});var i=n(1551);n.d(t,"e",function(){return i.a});var r=new a.c(function(){return Promise.all([n.e(3),n.e(10),n.e(13),n.e(23),n.e(148)]).then(n.bind(null,2022))}),s=new a.a(r,function(e){return e.initializeMeetingRequestViewStateAction}),d=Object(a.d)(r,function(e){return e.MeetingMessageInfo}),c=(Object(a.d)(r,function(e){return e.MeetingRequestActions}),Object(a.d)(r,function(e){return e.MeetingRequestResponseEditor})),u=Object(a.d)(r,function(e){return e.MeetingDetails})},1570:function(e,t,n){"use strict";var a=n(0),o=n(1578),i=n(195),r=n(4);t.a=Object(r.action)("initializeAttachmentsForItem")(function(e,t,n){return void 0===n&&(n=!1),a.__awaiter(this,void 0,void 0,function(){var r;return a.__generator(this,function(a){switch(a.label){case 0:return Object(o.a)(t)?[2]:e.attachmentWell?[3,2]:[4,i.h.import()];case 1:r=a.sent(),e.attachmentWell=r(!0,!1),a.label=2;case 2:return t?n?[4,i.p.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0)]:[3,4]:[3,6];case 3:return a.sent(),[3,6];case 4:return[4,i.m.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0)];case 5:a.sent(),a.label=6;case 6:return[2]}})})})},1571:function(e,t,n){"use strict";function a(){return["unsubscribeInfoBar","safetyBar","infoImportance","infoSensitivity","infoFlagStatus","irmInfoBar","infoMessageSubmitted","agendaMailFeedback","unauthenticatedSender","infoDelegate","infoMeetingAttendeeDoNotForward","infoSMIME","infoRestrictedAccess"]}n.d(t,"a",function(){return a})},1578:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a="IPM.Note.SMIME";function o(e){return e&&0==e.ItemClass.indexOf(a)}},2123:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"b",function(){return f});var a=n(27),o=n(6),i=n(174),r=n(7),s=n(92),d=n(674);function c(e){var t=e&&e.itemIds?e.itemIds.length:0;if(0==t)return[null,!1,!1];var n=null,o=2==Object(s.c)().type||!Object(s.b)();if(1==t){if(n=a.a.items.get(e.itemIds[0]),!u(e.itemIds[0],n))return[null,!1,!1];o=o||n.ParentFolderId&&n.ParentFolderId.Id==Object(s.b)()}else{for(var r=null,c=0,l=e.itemIds;c<l.length;c++){var f=l[c],m=a.a.items.get(f);if(!u(f,m))return[null,!1,!1];if(m.ParentFolderId&&m.ParentFolderId.Id==Object(s.b)()){n=m,o=!0;break}Object(i.a)(m.ParentFolderId.Id,"sentitems")&&(r=m)}n||(n=r||a.a.items.get(e.itemIds[0]))}return[n,o,Object(d.a)(n.ParentFolderId.Id)]}function u(e,t){return e?!!t||(r.c.error("Item should be in mailStore but does not exist."),!1):(r.c.error("ItemId in conversationNode.itemIds should not be:"+e),!1)}function l(e,t,n){var a=Object(o.a)().UserOptions.HideDeletedItems;return e&&!((e.IsDraft||a)&&t&&!n)}function f(e){var t=c(a.a.conversationNodes.get(e)),n=t[0],o=t[1];return l(n,t[2],o)?n:null}},2172:function(e,t,n){"use strict";var a=n(2482),o=n(1442),i=n(1571),r=n(111),s=n(1223),d=n(2242),c=n(21),u=n(9),l=n(47),f=n(24),m=n(27),I=n(7);function v(e){var t=f.a.conversationItems.get(e);if(t){var n=function(e){for(var t={unreadItemCount:0,totalItemCount:0},n=0,a=m.a.conversations.get(e).conversationNodeIds;n<a.length;n++){var o=a[n],i=m.a.conversationNodes.get(o);if(!i){I.c.error("conversationNode should be in mailStore but does not exist.");break}t.totalItemCount+=i.itemIds.length;for(var r=0,s=i.itemIds;r<s.length;r++){var d=s[r],c=m.a.items.get(d);if(!c){I.c.error("ItemId in conversationNode.itemIds should not be:"+d);break}t.unreadItemCount+=c.IsRead?0:1}}return t}(e);return t.globalItemIds.length!=n.totalItemCount||t.globalUnreadCount!=n.unreadItemCount}return!1}var b=n(92),p=n(54),g=n(4),C=n(2123);function S(e,t,n){return!e.IsRead&&t||e.IsDraft&&!n}n.d(t,"c",function(){return S}),n.d(t,"a",function(){return O});var O=Object(g.select)({conversationNodes:function(){return m.a.conversationNodes}})(function(e,t){var n,a=t.conversationNodes.get(e.Id),o=(n=Object(C.a)(a))[0],r=n[1],s=n[2];if(!Object(C.c)(o,s,r))return[null,null];var c={isExpanded:!1,loadingState:{isLoading:!1,hasLoadFailed:!1}},u=S(o,r,s),l={mailboxInfo:e.mailboxInfo,Id:o.ItemId.Id};return[{conversationNodeId:e.Id,itemId:l.Id,isConversationItemPart:!0,isExpanded:u,isSelected:!1,isLocal:r,isDeleted:s,isContextMenuShown:!1,isOofItem:d.a.test(o.ItemClass),oofReplyNodeIds:[],attachmentWell:null,quotedBodyViewState:c,isFossilizedTextExpanded:u,hideSmartReplyFeedbackDialog:!0,meetingRequestViewState:null,infoBarIds:Object(i.a)(),loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showToggleBodyButton:!1},undoDarkMode:!1,isInCollapsedItemsRollUp:!1,conversationNodeIdsInCollapsedItemsRollUp:null,isOofRollUpExpanded:!1},o]});t.b=Object(g.select)({readingPaneStore:function(){return r.a},conversationNodes:function(){return m.a.conversationNodes}})(Object(g.action)("loadConversationReadingPane",o.a.RPPerfLoadConversation)(function(e,t,n,i,r,d){var f,m,I=Promise.resolve(),g=d.readingPaneStore.conversationReadingPaneViewState;g&&Object(l.l)("ReadingPaneDisplayEnd",[g.instrumentationContext]),d.readingPaneStore.conversationReadingPaneViewState=(m=t,{conversationId:e,conversationSubject:n,conversationCategories:i,initiallySelectedItemId:null,itemIdToScrollTo:r,itemPartsMap:new c.a({}),loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(b.b)(),isSubjectExpanded:!1,unsupportedItemId:null,instrumentationContext:m,attachmentWell:null,calendarInlineComposeViewState:null});var C=Object(s.a)(e.Id);C&&(f="Valid",Object(a.a)(e.Id)),C&&!v(e.Id)||(f=C?"Stale":"Not",I=Object(p.j)(e,"LoadConversationReadingPane"));var S=o.a.RPCountConversationCacheState.datapoint,O=S.name,h=S.customData;return Object(u.n)(O,h(f)),Object(l.l)("ReadingPaneDisplayStart",[t]),I}))},2242:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"d",function(){return i}),n.d(t,"c",function(){return r}),n.d(t,"b",function(){return s});var a=n(2123),o=/ipm.note.rules.ooftemplate.microsoft/i;function i(e,t){if(e.has(t))return!0;var n=!1;return e.values().slice().some(function(e){return!!e.oofReplyNodeIds.includes(t)&&(n=!0,!0)}),n}function r(e,t,n){var a=n.get(e);if(a)return t.get(a.parentInternetMessageId);var o=null;return t.values().slice().some(function(t){return!!t.oofReplyNodeIds.includes(e)&&(o=t,!0)}),o}function s(e,t,n){return t.conversationNodeIds.filter(function(t){if(n.get(t).parentInternetMessageId==e){var i=Object(a.b)(t);if(i&&o.test(i.ItemClass))return!0}return!1})}},2440:function(e,t,n){"use strict";var a=n(0),o=n(1570),i=n(672),r=n(195),s=n(155),d=n(27),c=n(4);t.a=Object(c.action)("initializeAttachmentsForConversationWell")(Object(c.select)({mailStoreItems:function(){return d.a.items}})(function(e,t){return a.__awaiter(this,void 0,void 0,function(){var n,d,c,u,l,f,m,I,v;return a.__generator(this,function(b){switch(b.label){case 0:return e.itemPartsMap.size>1?e.attachmentWell?[3,4]:[4,s.a.getAttachmentsForConversationWell(e.conversationId)]:[3,11];case 1:return n=b.sent(),d=n[0],c=n[1],u=n[2],[4,r.j.import()];case 2:return l=b.sent(),e.attachmentWell=l(c,u),[4,r.m.importAndExecute(d,e.conversationId.mailboxInfo,e.attachmentWell,!0)];case 3:b.sent(),b.label=4;case 4:f=e.itemPartsMap.keys().slice(),m=0,b.label=5;case 5:return m<f.length?(I=e.itemPartsMap.get(f[m]))&&(v=t.mailStoreItems.get(I.itemId))?[4,Object(o.a)(I,v,!1)]:[3,8]:[3,9];case 6:return b.sent(),[4,r.n.importAndExecute(I.attachmentWell,e.attachmentWell,a.__assign({},v.ItemId,{mailboxInfo:v.MailboxInfo}),v.DateTimeReceived)];case 7:b.sent(),b.label=8;case 8:return m++,[3,5];case 9:return[4,r.r.importAndExecute(e.attachmentWell,Object(i.a)())];case 10:b.sent(),b.label=11;case 11:return[2]}})})}))},2482:function(e,t,n){"use strict";var a=n(2440),o=n(1550),i=n(2172),r=n(1442),s=n(9),d=n(16),c=n(4),u=Object(c.action)("markConversationCollapsedItemsRollUp")(function(e){if(!(e.length<5)){for(var t=0,n=0,a=0,o=0;o<=e.length;o++)o==e.length||e[o].isExpanded?(t>=4&&(a++,n+=t-2,l(e,o-2,t-2)),t=0):t++;if(a>0){var i=r.a.RPCountContinuousCollapsedItems.datapoint,d=i.name,c=i.customData;Object(s.n)(d,c(Object(r.b)(n),a))}}});function l(e,t,n){if(Object(d.b)("rp-collapsedItemsRollUp")){var a=r.a.RPCountRenderCollItemsRollUp.datapoint,o=a.name,i=a.customData;Object(s.n)(o,i(Object(r.b)(n)));var c=t-n+1,u=e[c];u.conversationNodeIdsInCollapsedItemsRollUp=[];for(var l=c;l<=t;l++){var f=e[l];u.conversationNodeIdsInCollapsedItemsRollUp.push(f.conversationNodeId),f.isInCollapsedItemsRollUp=!0}}}var f=n(111),m=n(2242),I=n(1552),v=n(136),b=n(27);t.a=Object(c.select)({loadedConversation:function(e){return b.a.conversations.get(e)},conversationNodes:function(){return b.a.conversationNodes},conversationReadingPaneState:function(){return f.a.conversationReadingPaneViewState}})(Object(c.action)("firstLoadConversationReadingPane",r.a.RPPerfRenderConversationReadingPane)(function(e,t){if(t.conversationReadingPaneState.conversationId.Id==e){var n=t.conversationReadingPaneState;if(n.loadingState.isLoading=!1,n.loadingState.hasLoadFailed=t.loadedConversation.loadingState.hasLoadFailed,!n.loadingState.hasLoadFailed){var r=Object(I.c)(e);if(n.unsupportedItemId=r,!r){var s=function(e,t,n,a){var r=[],s=null;if(e.conversationNodeIds){var c=!1;e.conversationNodeIds.forEach(function(n){var a=Object(i.a)({mailboxInfo:e.conversationId.mailboxInfo,Id:n}),o=a[0],s=a[1];o&&(r.push(o),t.set(n,o),c=c||o.isExpanded&&!s.IsDraft)}),Object(d.b)("rp-oofRollup")&&t.forEach(function(e){if(e.isOofItem){var a=e.conversationNodeId,o=Object(m.c)(a,t,n);if(o){var i=r.indexOf(e);r.splice(i,1),t.delete(a),o.oofReplyNodeIds.push(a)}}}),function(e,t,n){var a=n.length;if(0!=a&&!t){for(var o="ChronologicalNewestOnBottom"==e,i=null,r=o?a-1:0,s=r,d=o?-1:1;s>=0&&s<a;){var c=n[s];if(c.isLocal&&!c.isExpanded){i=c;break}s+=d}i||(i=n[r]),i.isExpanded=!0,i.isFossilizedTextExpanded=!0}}(e.conversationSortOrder,c,r),s=function(e,t){for(var n=e.length,a=0;a<n;a++){var o=e[a],i=o.itemId;if(t){if(i==t)return o.isExpanded=!0,o.isSelected=!0,t}else if(o.isExpanded)return o.isSelected=!0,i}return null}(r,a),r.forEach(function(e){e.isExpanded&&Object(o.a)(e)}),u(r)}return s}(t.loadedConversation,n.itemPartsMap,t.conversationNodes,n.itemIdToScrollTo);n.initiallySelectedItemId=s,Object(v.b)("doc-attachment-convoWell")&&Object(a.a)(n)}}}}))},2783:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("UPDATE_LOADED_CONVERSATION_READING_PANE",function(e,t){return{conversationId:e,nodeIdCollectionChanged:t}})},2785:function(e,t,n){"use strict";var a=n(2172),o=n(1397),i=n(624),r=n(75),s=n(509),d=n(4),c=n(5);t.a=Object(d.select)({composeViewState:function(){return r.b.defaultViewState},conversationItems:function(){return c.F.conversationItems}})(Object(d.action)("reloadReadingPane")(function(e){var t=Object(c.v)(),n=t?t.selectedRowKeys.keys().slice():[];if(1==n.length){var d=c.b.getRowClientItemId(n[0],t),u=Object(s.a)(n,t)[0];switch(t.tableQuery.listViewType){case 0:var l=e.conversationItems.get(d.Id);e.composeViewState&&e.composeViewState.isInlineCompose?r.t.importAndExecute(e.composeViewState).then(function(){Object(a.b)(d,u,l.subject)}):Object(a.b)(d,u,l.subject);break;case 1:e.composeViewState&&e.composeViewState.isInlineCompose?r.t.importAndExecute(e.composeViewState).then(function(){Object(o.a)(d,u,i.a)}):Object(o.a)(d,u,i.a)}}}))},3037:function(e,t,n){"use strict";var a=n(3),o=Object(a.action)("ON_CONVERSATION_OPTION_SAVED");t.a=o},5664:function(e,t,n){"use strict";n.r(t);var a=n(27),o=n(7),i=n(18),r=n(5),s=n(21);function d(e,t){var n,d,c,u=function(e){var t={},n=a.a.conversationNodes.get(e);for(;n;){if(t[n.internetMessageId]){o.c.error("Invalid loop found in ParentInternetMessageId pointers");break}if(t[n.internetMessageId]=!0,Object(i.isStringNullOrWhiteSpace)(n.parentInternetMessageId))break;n=a.a.conversationNodes.get(n.parentInternetMessageId)}return t}(e);if(1===Object.keys(u).length)return n=e,d=t,c=new s.a({}),d.forEach(function(e){var t=a.a.conversationNodes.get(e),o=e===n?r.a.CheckMark:r.a.None;c.set(t.internetMessageId,o)}),c;for(var l=new s.a({}),f=!1,m=!1,I=0,v=0;v<t.length;v++){var b=a.a.conversationNodes.get(t[v]);u[b.internetMessageId]?(f?I+1===Object.keys(u).length?(l.set(b.internetMessageId,r.a.BusEnd),m=!0):l.set(b.internetMessageId,r.a.BusStop):(l.set(b.internetMessageId,r.a.BusStart),f=!0),I++):!f||m?l.set(b.internetMessageId,r.a.None):l.set(b.internetMessageId,r.a.NoStop)}return l}var c=n(68),u=n(24),l=n(2783),f=n(13),m=n(3);function I(){u.a.expandedConversationViewState.expandedRowKey=null,u.a.expandedConversationViewState.selectedNodeIds=[],u.a.expandedConversationViewState.shouldBeExpanded=!1,u.a.expandedConversationViewState.busStopStateMap=new s.a({})}Object(m.mutator)(c.t,function(e){var t=e.nodeId,n=e.allNodeIds,a=u.a.expandedConversationViewState.selectedNodeIds;a.indexOf(t)>-1?(a.splice(a.indexOf(t),1),1===a.length&&(u.a.expandedConversationViewState.busStopStateMap=d(a[0],n))):a.push(t)}),Object(m.mutator)(c.g,function(e){u.a.expandedConversationViewState.busStopStateMap=new s.a({})}),Object(m.mutator)(c.q,function(e){var t=e.rowKey,n=e.nodeIdToSelect,a=e.allNodeIds;u.a.expandedConversationViewState.expandedRowKey=t,u.a.expandedConversationViewState.selectedNodeIds=[n],u.a.expandedConversationViewState.busStopStateMap=d(n,a)}),Object(m.mutator)(c.u,function(e){var t=u.a.expandedConversationViewState;e.mailListItemSelectionSource==f.c.MailListItemCheckbox&&t.expandedRowKey!=e.rowKey&&I()}),Object(m.mutator)(c.p,function(e){var t=u.a.expandedConversationViewState;e.shouldSelect||t.expandedRowKey!=e.rowKey||I()}),Object(m.mutator)(c.h,function(e){I()}),Object(m.mutator)(c.j,function(e){I()}),Object(m.mutator)(c.r,function(e){var t=u.a.expandedConversationViewState;e.mailListItemSelectionSource==f.c.MailListItemTwisty&&t.expandedRowKey!=e.rowKey&&(t.expandedRowKey=e.rowKey,t.shouldBeExpanded=!0)}),Object(m.mutator)(c.o,function(e){u.a.expandedConversationViewState.shouldBeExpanded=e.shouldBeExpanded}),Object(m.mutator)(l.a,function(e){if(1===u.a.expandedConversationViewState.selectedNodeIds.length){var t=u.a.expandedConversationViewState.selectedNodeIds[0],n=f.w.conversations.get(e.conversationId).conversationNodeIds;u.a.expandedConversationViewState.busStopStateMap=d(t,n)}});var v=n(16),b=n(968),p=n(479),g=n(250),C=n(73),S=n(2123);Object(m.orchestrator)(c.a,function(e){Object(g.i)(e.tableView,!0,f.c.MailListItemExpansion),C.n.importAndExecute(e.itemId),Object(v.b)("tri-superConversationExpansion")&&(p.d.import().then(function(t){t([e.nodeId],e.tableView.id,!0,!0,"ItemPartClicked")}),c.q(r.F.expandedConversationViewState.expandedRowKey,e.nodeId,e.allNodeIds))}),Object(m.orchestrator)(c.d,function(e){if(e.mailListItemSelectionSource==f.c.MailListItemTwisty){if(1==e.listViewType)throw new Error("Toggle expansion action cannot be called from message view");if(Object(b.a)(e.rowKey))c.h();else{var t=r.b.getConversationId(e.rowKey,e.tableView),n=f.w.conversations.get(t);if(c.o(!1),!Object(v.b)("tri-superConversationExpansion"))return;for(var a=0,o=n.conversationNodeIds;a<o.length;a++){var i=o[a];if(Object(S.b)(i)){c.q(e.rowKey,i,n.conversationNodeIds);break}}}}}),Object(m.orchestrator)(c.k,function(e){if(Object(v.b)("tri-superConversationExpansion"))for(var t=r.b.getConversationId(e.rowKey,e.tableView),n=f.w.conversations.get(t),a=0,o=n.conversationNodeIds;a<o.length;a++){var i=o[a],s=Object(S.b)(i);if(s){c.a(i,s.ItemId.Id,n.conversationNodeIds,e.tableView);break}}}),Object(m.orchestrator)(c.l,function(e){if(Object(v.b)("tri-superConversationExpansion")){for(var t=r.b.getConversationId(e.rowKey,e.tableView),n=f.w.conversations.get(t),a=null,o=n.conversationNodeIds.indexOf(r.F.expandedConversationViewState.selectedNodeIds[0])+1;o<n.conversationNodeIds.length;o++){var i=n.conversationNodeIds[o];if(Object(S.b)(i)){a=i;break}}a?c.a(a,Object(S.b)(a).ItemId.Id,n.conversationNodeIds,e.tableView):c.k(e.rowKey,e.tableView)}});var O=n(2785),h=n(3037);Object(m.orchestrator)(h.a,function(e){Object(O.a)(),1===Object(r.x)().expandedConversationViewState.selectedNodeIds.length&&c.g()})}},0,[3,10,13,23,148,6,7,25,34,57,0,4,9,52,2,75,1,51,223,56,218,225,90,79,76]]);
//# sourceMappingURL=owa.ExpandedListSelectionActions.js.map
window.scriptsLoaded['owa.ExpandedListSelectionActions.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.ExpandedListSelectionActions.js'] = (new Date()).getTime();